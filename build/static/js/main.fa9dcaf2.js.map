{"version":3,"sources":["webpack:///static/js/main.fa9dcaf2.js","webpack:///webpack/bootstrap 9b28139110d784bedd41","webpack:///./~/react/index.js","webpack:///./src/app-data.js","webpack:///./src/socialcalc/AppGeneral.js","webpack:///./~/object-assign/index.js","webpack:///./src/storage/LocalStorage.js","webpack:///./~/promise/lib/core.js","webpack:///./~/asap/browser-raw.js","webpack:///./src/App/App.js","webpack:///./src/Files/Files.js","webpack:///./src/Login/Login.js","webpack:///./src/Menu/Menu.js","webpack:///./src/index.js","webpack:///./src/socialcalc/aspiring/SocialCalc.js","webpack:///./src/storage/CloudStorage.js","webpack:///./~/promise/lib/es6-extensions.js","webpack:///./~/promise/lib/rejection-tracking.js","webpack:///./~/react-dom/cjs/react-dom.production.min.js","webpack:///./~/react-dom/index.js","webpack:///./~/react-scripts/config/polyfills.js","webpack:///./~/react-scripts/~/whatwg-fetch/fetch.js","webpack:///./~/react/cjs/react.production.min.js","webpack:///./~/scheduler/cjs/scheduler.production.min.js","webpack:///./~/scheduler/index.js","webpack:///./~/whatwg-fetch/fetch.js"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","id","loaded","call","m","c","p","i","Object","prototype","hasOwnProperty","_m","args","slice","fn","a","b","apply","this","concat","defineProperty","value","APP_NAME","DATA","ledger","iPad","msc","numsheets","currentid","currentname","sheetArr","sheet1","sheetstr","savestr","name","hidden","sheet2","sheet3","sheet4","EditableCells","allow","cells","typei!C10","typei!B2","typei!C11","typei!C12","typei!C13","typei!D9","typei!D4","typei!D6","typei!E10","typei!E11","typei!E12","typei!E13","typei!F9","typei!C16","typei!C17","typei!C18","typei!C19","typei!C20","typei!C21","typei!C22","typei!C23","typei!C24","typei!C25","typei!C26","typei!C27","typei!C28","typei!F16","typei!F17","typei!F18","typei!F19","typei!F20","typei!F21","typei!F22","typei!F23","typei!F24","typei!F25","typei!F26","typei!F27","typei!F28","typei!E35","typeii!B2","typeii!D4","typeii!C10","typeii!C11","typeii!C12","typeii!C13","typeii!D9","typeii!E10","typeii!E11","typeii!E12","typeii!E13","typeii!F9","typeii!C16","typeii!C17","typeii!C18","typeii!C19","typeii!C20","typeii!C21","typeii!C22","typeii!C23","typeii!C24","typeii!C25","typeii!C26","typeii!C27","typeii!C28","typeii!F16","typeii!F17","typeii!F18","typeii!F19","typeii!F20","typeii!F21","typeii!F22","typeii!F23","typeii!F24","typeii!F25","typeii!F26","typeii!F27","typeii!F28","typeii!G16","typeii!G17","typeii!G18","typeii!G19","typeii!G20","typeii!G21","typeii!G22","typeii!G23","typeii!G24","typeii!G25","typeii!G26","typeii!G27","typeii!G28","typeii!E35","typeiii!G9","typeiii!G10","typeiii!B2","typeiii!B3","typeiii!B4","typeiii!B5","typeiii!B6","typeiii!B7","typeiii!B8","typeiii!B9","typeiii!B11","typeiii!B12","typeiii!B13","typeiii!B14","typeiii!B15","typeiii!B18","typeiii!B19","typeiii!B20","typeiii!B21","typeiii!B22","typeiii!B23","typeiii!B24","typeiii!B25","typeiii!B26","typeiii!B27","typeiii!B28","typeiii!B29","typeiii!G18","typeiii!G19","typeiii!G20","typeiii!G21","typeiii!G22","typeiii!G23","typeiii!G24","typeiii!G25","typeiii!G26","typeiii!G27","typeiii!G28","typeiii!G29","typeiii!B32","typeiii!B33","typeiii!B34","typeiii!G31","typeiii!G33","typeiii!B37","typeiv!G9","typeiv!G10","typeiv!B2","typeiv!B3","typeiv!B4","typeiv!B5","typeiv!B6","typeiv!B7","typeiv!B8","typeiv!B11","typeiv!B12","typeiv!B13","typeiv!B14","typeiv!B15","typeiv!B16","typeiv!B18","typeiv!B19","typeiv!B20","typeiv!B21","typeiv!B22","typeiv!B23","typeiv!B24","typeiv!B25","typeiv!B26","typeiv!B27","typeiv!B28","typeiv!B29","typeiv!E18","typeiv!E19","typeiv!E20","typeiv!E21","typeiv!E22","typeiv!E23","typeiv!E24","typeiv!E25","typeiv!E26","typeiv!E27","typeiv!E28","typeiv!E29","typeiv!F18","typeiv!F19","typeiv!F2","typeiv!F20","typeiv!F21","typeiv!F22","typeiv!F23","typeiv!F24","typeiv!F25","typeiv!F26","typeiv!F27","typeiv!F28","typeiv!F29","typeiv!B32","typeiv!B33","typeiv!B34","typeiv!G31","typeiv!G33","typeiv!B37","typeii!F15","typeii!G15","typeiv!E17","typeiv!F17","typeii!D6","typeiv!G11","typei!C4","typeii!C4","typeiii!F10","typeiv!F11","typeiv!F10","typeiii!F9","typeii!C6","typei!C6","typei!F4","typeii!F4","typeiii!F4","typeiii!F2","typeiv!F4","typei!F29","typeii!H29","typeiii!G30","typeiii!G34","typeiv!G30","typeiv!G34","constraints","footers","index","isActive","default","iPhone","sheet5","inv1!B2","inv1!C5","inv1!C6","inv1!C7","inv1!C8","inv1!C9","inv1!C11","inv1!C12","inv1!C13","inv1!C14","inv1!C15","inv1!C16","inv1!C18","inv1!C20","inv1!D20","inv1!C23","inv1!C24","inv1!C25","inv1!C26","inv1!C27","inv1!C28","inv1!C29","inv1!C30","inv1!C31","inv1!C32","inv1!C33","inv1!C34","inv1!C35","inv1!F23","inv1!F24","inv1!F25","inv1!F26","inv1!F27","inv1!F28","inv1!F29","inv1!F30","inv1!F31","inv1!F32","inv1!F33","inv1!F34","inv1!F35","inv2!B2","inv2!F4","inv2!G4","inv2!B5","inv2!B7","inv2!B8","inv2!B9","inv2!B10","inv2!B11","inv2!B12","inv2!B14","inv2!B15","inv2!B16","inv2!B17","inv2!B18","inv2!B19","inv2!B20","inv2!B23","inv2!B24","inv2!B25","inv2!B26","inv2!B27","inv2!B28","inv2!B29","inv2!B30","inv2!B31","inv2!B32","inv2!B33","inv2!B34","inv2!B35","inv2!G23","inv2!G24","inv2!G25","inv2!G26","inv2!G27","inv2!G28","inv2!G29","inv2!G30","inv2!G31","inv2!G32","inv2!G33","inv2!G34","inv2!G35","inv2!B38","inv2!B39","inv2!B40","inv2!F36","inv2!G37","inv2!F37","inv2!F39","inv2!G39","inv2!F38","sheet6!B2","sheet6!F4","sheet6!G4","sheet6!B5","sheet6!B7","sheet6!B8","sheet6!B9","sheet6!B10","sheet6!B11","sheet6!B12","sheet6!B14","sheet6!B15","sheet6!B16","sheet6!B17","sheet6!B18","sheet6!B19","sheet6!B20","sheet6!B38","sheet6!B39","sheet6!B40","sheet6!F36","sheet6!G37","sheet6!F37","sheet6!F39","sheet6!G39","sheet6!F38","inv3!B2","inv3!B6","inv3!B7","inv3!B8","inv3!B9","inv3!B10","inv3!B11","inv3!B12","inv3!B13","inv3!B14","inv3!B15","inv3!B16","inv3!B17","inv3!B18","inv3!E6","inv3!E7","inv3!E8","inv3!E9","inv3!E10","inv3!E11","inv3!E12","inv3!E13","inv3!E14","inv3!E15","inv3!E16","inv3!E17","inv3!E18","inv3!F6","inv3!F7","inv3!F8","inv3!F9","inv3!F10","inv3!F11","inv3!F12","inv3!F13","inv3!F14","inv3!F15","inv3!F16","inv3!F17","inv3!F18","sheet7!F6","sheet7!F7","sheet7!F8","sheet7!F9","sheet7!F10","sheet7!F11","sheet7!F12","sheet7!F13","sheet7!F14","sheet7!F15","sheet7!F16","sheet7!F17","sheet7!F18","sheet7!E6","sheet7!E7","sheet7!E8","sheet7!E9","sheet7!E10","sheet7!E11","sheet7!E12","sheet7!E13","sheet7!E14","sheet7!E15","sheet7!E16","sheet7!E17","sheet7!E18","sheet7!B6","sheet7!B2","sheet7!B7","sheet7!B8","sheet7!B9","sheet7!B10","sheet7!B11","sheet7!B12","sheet7!B13","sheet7!B14","sheet7!B15","sheet7!B16","sheet7!B17","sheet7!B18","inv1!D8","inv1!D15","inv1!D18","inv2!C5","sheet6!C5","iPod","home","getDeviceType","device","navigator","userAgent","match","console","log","initializeApp","data","tableeditor","document","getElementById","spreadsheet","SocialCalc","SpreadsheetControl","workbook","WorkBook","InitializeWorkBook","InitializeSpreadsheetControl","ExecuteCommand","workbookcontrol","WorkBookControl","InitializeWorkBookControl","WorkBookControlLoad","ele","style","height","DoOnResize","activateFooterButton","oldBtnActive","control","GetCurrentWorkBookControl","sheets","key","sheetButtonArr","push","formulabarDiv","ToggleInputLineButtons","input","firstChild","display","editor","state","WorkBookControlActivateSheet","viewFile","filename","WorkBookControlInsertWorkbook","window","setTimeout","ScrollRelativeBoth","getCSVContent","val","WorkBookControlSaveSheet","workBookObject","JSON","parse","currentSheetButton","savestrr","res","ConvertSaveToOtherFormat","mustshowprompt","coord","cellname","workingvalues","currentsheet","ecell","getinputtype","prompttype","showprompt","onPrompt","results","buttonIndex","onConfirm","onFontConfirm","fontIndex","EditorChangefontFromWidget","notification","confirm","onColorConfirm","colorIndex","EditorChangecolorFromWidget","context","sheetobj","SheetUndo","SheetRedo","EditorCut","okfn","input1","constraint","highlights","wval","eccord","ecoord","text","GetCellContents","Constants","SCNoQuoteInInputBox","substring","cell","GetEditorCellElement","row","col","callbackfn","EditorSaveEdit","UpdateCellCSS","celltext","title","options","prompt","getSpreadsheetContent","getCurrentHTMLContent","CreateSheetHTML","getAllHTMLContent","sheetdata","appsheets","WorkbookControlCreateSheetHTML","saveAs","Promise","resolve","reject","getAllOldFiles","files","localStorage","length","filedata","decodeURIComponent","getItem","deleteAllOldFiles","removeItem","addLogo","url","currsheet","cmd","sheetname","cmdtype","cmdstr","saveundo","ExecuteWorkBookControlCommand","removeLogo","undo","redo","getCurrentSheet","changeSheetColor","toLowerCase","EditorChangeSheetcolor","changeFontSheet","cmdline","EditorScheduleSheetCommands","executeCommand","toObject","undefined","TypeError","shouldUseNative","assign","test1","String","getOwnPropertyNames","test2","fromCharCode","order2","map","n","join","test3","split","forEach","letter","keys","err","getOwnPropertySymbols","propIsEnumerable","propertyIsEnumerable","target","source","from","symbols","to","s","arguments","_classCallCheck","instance","Constructor","_createClass","defineProperties","props","descriptor","enumerable","configurable","writable","protoProps","staticProps","storage","File","created","modified","content","password","Local","token","file","setItem","stringify","rawData","arr","fname","_getFile","noop","getThen","obj","then","ex","LAST_ERROR","IS_ERROR","tryCallOne","tryCallTwo","_45","_81","_65","_54","doResolve","safeThen","self","onFulfilled","onRejected","constructor","handle","Handler","deferred","_10","handleResolved","asap","cb","promise","ret","newValue","finale","bind","_97","done","reason","_61","global","rawAsap","task","queue","requestFlush","flushing","flush","currentIndex","capacity","scan","newLength","makeRequestCallFromMutationObserver","callback","toggle","observer","BrowserMutationObserver","node","createTextNode","observe","characterData","makeRequestCallFromTimer","handleTimer","clearTimeout","timeoutHandle","clearInterval","intervalHandle","setInterval","scope","MutationObserver","WebKitMutationObserver","_interopRequireWildcard","__esModule","newObj","_interopRequireDefault","_possibleConstructorReturn","ReferenceError","_inherits","subClass","superClass","create","setPrototypeOf","__proto__","_react","_react2","_AppGeneral","AppGeneral","_appData","_Menu","_Menu2","_Files","_Files2","App","_Component","_this","getPrototypeOf","selectedFile","listFiles","updateSelectedFile","toggleListFiles","setState","prevState","footer","_this2","footersList","footerArray","createElement","className","onClick","activateFooter","Component","_LocalStorage","Files","store","_getAllFiles","event","preventDefault","result","_deleteFile","loadDefault","fileList","_formatDate","editFile","deleteFile","date","Date","toLocaleString","_CloudStorage","Login","email","cloud","Cloud","e","appname","_auth","type","onChange","updateEmail","placeholder","updatePassword","doAuth","_Login","_Login2","Menu","login","openLogin","printWindow","open","write","print","close","alert","encodeURIComponent","toString","_saveFile","_validateName","loggedIn","doSave","doSaveAs","doPrint","sendEmail","newFile","auth","trim","test","indexOf","replace","_reactDom","_reactDom2","_App","_App2","ReactDOM","render","__WEBPACK_AMD_DEFINE_FACTORY__","__WEBPACK_AMD_DEFINE_ARRAY__","__WEBPACK_AMD_DEFINE_RESULT__","_typeof","Symbol","iterator","root","factory","textdatadefaulttype","s_BrowserNotSupported","s_InternalError","s_pssUnknownColType","s_pssUnknownRowType","s_pssUnknownLineType","s_cfspUnknownCellType","doCanonicalizeSheet","s_escUnknownSheetCmd","s_escUnknownSetCoordCmd","s_escUnknownCmd","s_caccCircRef","defaultRowNameWidth","defaultAssumedRowHeight","defaultCellIDPrefix","defaultCellLayout","defaultCellFontStyle","defaultCellFontSize","defaultCellFontFamily","defaultPaneDividerWidth","defaultPaneDividerHeight","defaultGridCSS","defaultCommentClass","defaultCommentStyle","defaultCommentNoGridClass","defaultCommentNoGridStyle","defaultColWidth","defaultMinimumColWidth","defaultHighlightTypeCursorClass","defaultHighlightTypeCursorStyle","defaultHighlightTypeRangeClass","defaultHighlightTypeRangeStyle","defaultColnameClass","defaultColnameStyle","defaultSelectedColnameClass","defaultSelectedColnameStyle","defaultRownameClass","defaultRownameStyle","defaultSelectedRownameClass","defaultSelectedRownameStyle","defaultUpperLeftClass","defaultUpperLeftStyle","defaultSkippedCellClass","defaultSkippedCellStyle","defaultPaneDividerClass","defaultPaneDividerStyle","s_rcMissingSheet","defaultLinkFormatString","defaultPageLinkFormatString","defaultFormatdt","defaultFormatd","defaultFormatt","defaultDisplayTRUE","defaultDisplayFALSE","defaultImagePrefix","defaultTableEditorIDPrefix","defaultPageUpDnAmount","AllowCtrlS","defaultTableControlThickness","cteGriddivClass","s_statusline_executing","s_statusline_displaying","s_statusline_ordering","s_statusline_calculating","s_statusline_calculatingls","s_statusline_doingserverfunc","s_statusline_incell","s_statusline_calcstart","s_statusline_sum","s_statusline_recalcneeded","s_statusline_circref","s_inputboxdisplaymultilinetext","defaultInputEchoClass","defaultInputEchoStyle","defaultInputEchoPromptClass","defaultInputEchoPromptStyle","ietUnknownFunction","CH_radius1","CH_radius2","s_CHfillAllTooltip","s_CHfillContentsTooltip","s_CHmovePasteAllTooltip","s_CHmovePasteContentsTooltip","s_CHmoveInsertAllTooltip","s_CHmoveInsertContentsTooltip","s_CHindicatorOperationLookup","Fill","FillC","Move","MoveI","MoveC","MoveIC","s_CHindicatorDirectionLookup","Down","Right","Horizontal","Vertical","defaultTCSliderThickness","defaultTCButtonThickness","defaultTCThumbThickness","TCmainStyle","TCmainClass","TCendcapStyle","TCendcapClass","TCpanesliderStyle","TCpanesliderClass","s_panesliderTooltiph","s_panesliderTooltipv","TClessbuttonStyle","TClessbuttonClass","TClessbuttonRepeatWait","TClessbuttonRepeatInterval","TCmorebuttonStyle","TCmorebuttonClass","TCmorebuttonRepeatWait","TCmorebuttonRepeatInterval","TCscrollareaStyle","TCscrollareaClass","TCscrollareaRepeatWait","TCscrollareaRepeatInterval","TCthumbClass","TCthumbStyle","TCPStrackinglineClass","TCPStrackinglineStyle","TCPStrackinglineThickness","TCTDFSthumbstatusvClass","TCTDFSthumbstatusvStyle","TCTDFSthumbstatushClass","TCTDFSthumbstatushStyle","TCTDFSthumbstatusrownumClass","TCTDFSthumbstatusrownumStyle","TCTDFStopOffsetv","TCTDFSleftOffsetv","s_TCTDFthumbstatusPrefixv","TCTDFStopOffseth","TCTDFSleftOffseth","s_TCTDFthumbstatusPrefixh","TooltipOffsetX","TooltipOffsetY","TDpopupElementClass","TDpopupElementStyle","SCToolbarbackground","SCTabbackground","SCTabselectedCSS","SCTabplainCSS","SCToolbartext","SCFormulabarheight","SCStatuslineheight","SCStatuslineCSS","doWorkBook","SCSheetBarHeight","SCSheetBarBackground","SCSheetBarCSS","SCSheetBarWidth","SCCellHandlesDisable","SCNoInputEcho","s_inputboxdisplaynoteditable","SCNoRowName","SCNoRanging","SCFormatNumberFormats","SCFormatTextFormats","SCFormatPadsizes","SCFormatFontsizes","SCFormatFontfamilies","SCFormatFontlook","SCFormatTextAlignhoriz","SCFormatNumberAlignhoriz","SCFormatAlignVertical","SCFormatColwidth","SCFormatRecalc","ISCButtonBorderNormal","ISCButtonBorderHover","ISCButtonBorderDown","ISCButtonDownBackground","s_PopupListCancel","s_PopupListCustom","s_loc_align_center","s_loc_align_left","s_loc_align_right","s_loc_alignment","s_loc_audit","s_loc_audit_trail_this_session","s_loc_auto","s_loc_auto_sum","s_loc_auto_wX_commas","s_loc_automatic","s_loc_background","s_loc_bold","s_loc_bold_XampX_italics","s_loc_bold_italic","s_loc_borders","s_loc_borders_off","s_loc_borders_on","s_loc_bottom","s_loc_bottom_border","s_loc_cell_settings","s_loc_csv_format","s_loc_cancel","s_loc_category","s_loc_center","s_loc_clear","s_loc_clear_socialcalc_clipboard","s_loc_clipboard","s_loc_color","s_loc_column_","s_loc_comment","s_loc_copy","s_loc_custom","s_loc_cut","s_loc_default","s_loc_default_alignment","s_loc_default_column_width","s_loc_default_font","s_loc_default_format","s_loc_default_padding","s_loc_delete","s_loc_delete_column","s_loc_delete_contents","s_loc_delete_row","s_loc_description","s_loc_display_clipboard_in","s_loc_down","s_loc_edit","s_loc_existing_names","s_loc_family","s_loc_fill_down","s_loc_fill_right","s_loc_font","s_loc_format","s_loc_formula","s_loc_function_list","s_loc_functions","s_loc_grid","s_loc_hidden","s_loc_horizontal","s_loc_insert_column","s_loc_insert_row","s_loc_italic","s_loc_last_sort","s_loc_left","s_loc_left_border","s_loc_link","s_loc_link_input_box","s_loc_list","s_loc_load_socialcalc_clipboard_with_this","s_loc_major_sort","s_loc_manual","s_loc_merge_cells","s_loc_middle","s_loc_minor_sort","s_loc_move_insert","s_loc_move_paste","s_loc_multiXline_input_box","s_loc_name","s_loc_names","s_loc_no_padding","s_loc_normal","s_loc_number","s_loc_number_horizontal","s_loc_ok","s_loc_padding","s_loc_page_name","s_loc_paste","s_loc_paste_formats","s_loc_plain_text","s_loc_recalc","s_loc_recalculation","s_loc_redo","s_loc_right","s_loc_right_border","s_loc_sheet_settings","s_loc_save","s_loc_save_to","s_loc_set_cell_contents","s_loc_set_cells_to_sort","s_loc_set_value_to","s_loc_set_to_link_format","s_loc_setXclear_move_from","s_loc_show_cell_settings","s_loc_show_sheet_settings","s_loc_show_in_new_browser_window","s_loc_size","s_loc_socialcalcXsave_format","s_loc_sort","s_loc_sort_","s_loc_sort_cells","s_loc_swap_colors","s_loc_tabXdelimited_format","s_loc_text","s_loc_text_horizontal","s_loc_this_is_aXbrXsample","s_loc_top","s_loc_top_border","s_loc_undone_steps","s_loc_url","s_loc_undo","s_loc_unmerge_cells","s_loc_up","s_loc_value","s_loc_vertical","s_loc_wikitext","s_loc_workspace","s_loc_XnewX","s_loc_XnoneX","s_loc_Xselect_rangeX","SVStatuslineheight","SVStatuslineCSS","FormatNumber_separatorchar","FormatNumber_decimalchar","FormatNumber_defaultCurrency","s_FormatNumber_daynames","s_FormatNumber_daynames3","s_FormatNumber_monthnames","s_FormatNumber_monthnames3","s_FormatNumber_am","s_FormatNumber_am1","s_FormatNumber_pm","s_FormatNumber_pm1","s_parseerrexponent","s_parseerrchar","s_parseerrstring","s_parseerrspecialvalue","s_parseerrtwoops","s_parseerrmissingopenparen","s_parseerrcloseparennoopen","s_parseerrmissingcloseparen","s_parseerrmissingoperand","s_parseerrerrorinformula","s_calcerrerrorvalueinformula","s_parseerrerrorinformulabadval","s_formularangeresult","s_calcerrnumericnan","s_calcerrnumericoverflow","s_sheetunavailable","s_calcerrcellrefmissing","s_calcerrsheetnamemissing","s_circularnameref","s_calcerrunknownname","s_calcerrincorrectargstofunction","s_sheetfuncunknownfunction","s_sheetfunclnarg","s_sheetfunclog10arg","s_sheetfunclogsecondarg","s_sheetfunclogfirstarg","s_sheetfuncroundsecondarg","s_sheetfuncddblife","s_sheetfuncslnlife","s_fdef_ABS","s_fdef_ACOS","s_fdef_AND","s_fdef_ASIN","s_fdef_ATAN","s_fdef_ATAN2","s_fdef_AVERAGE","s_fdef_CHOOSE","s_fdef_COLUMNS","s_fdef_COS","s_fdef_COUNT","s_fdef_COUNTA","s_fdef_COUNTBLANK","s_fdef_COUNTIF","s_fdef_DATE","s_fdef_DAVERAGE","s_fdef_DAY","s_fdef_DCOUNT","s_fdef_DCOUNTA","s_fdef_DDB","s_fdef_DEGREES","s_fdef_DGET","s_fdef_DMAX","s_fdef_DMIN","s_fdef_DPRODUCT","s_fdef_DSTDEV","s_fdef_DSTDEVP","s_fdef_DSUM","s_fdef_DVAR","s_fdef_DVARP","s_fdef_EVEN","s_fdef_EXACT","s_fdef_EXP","s_fdef_FACT","s_fdef_FALSE","s_fdef_FIND","s_fdef_FV","s_fdef_HLOOKUP","s_fdef_HOUR","s_fdef_IF","s_fdef_INDEX","s_fdef_INT","s_fdef_IRR","s_fdef_ISBLANK","s_fdef_ISERR","s_fdef_ISERROR","s_fdef_ISLOGICAL","s_fdef_ISNA","s_fdef_ISNONTEXT","s_fdef_ISNUMBER","s_fdef_ISTEXT","s_fdef_LEFT","s_fdef_LEN","s_fdef_LN","s_fdef_LOG","s_fdef_LOG10","s_fdef_LOWER","s_fdef_MATCH","s_fdef_MAX","s_fdef_MID","s_fdef_MIN","s_fdef_MINUTE","s_fdef_MOD","s_fdef_MONTH","s_fdef_N","s_fdef_NA","s_fdef_NOT","s_fdef_NOW","s_fdef_NPER","s_fdef_NPV","s_fdef_ODD","s_fdef_OR","s_fdef_PI","s_fdef_PMT","s_fdef_POWER","s_fdef_PRODUCT","s_fdef_PROPER","s_fdef_PV","s_fdef_RADIANS","s_fdef_RATE","s_fdef_REPLACE","s_fdef_REPT","s_fdef_RIGHT","s_fdef_ROUND","s_fdef_ROWS","s_fdef_SECOND","s_fdef_SIN","s_fdef_SLN","s_fdef_SQRT","s_fdef_STDEV","s_fdef_STDEVP","s_fdef_SUBSTITUTE","s_fdef_SUM","s_fdef_SUMIF","s_fdef_SYD","s_fdef_T","s_fdef_TAN","s_fdef_TIME","s_fdef_TODAY","s_fdef_TRIM","s_fdef_TRUE","s_fdef_TRUNC","s_fdef_UPPER","s_fdef_VALUE","s_fdef_VAR","s_fdef_VARP","s_fdef_VLOOKUP","s_fdef_WEEKDAY","s_fdef_YEAR","s_farg_v","s_farg_vn","s_farg_xy","s_farg_choose","s_farg_range","s_farg_rangec","s_farg_date","s_farg_dfunc","s_farg_ddb","s_farg_find","s_farg_fv","s_farg_hlookup","s_farg_iffunc","s_farg_index","s_farg_irr","s_farg_tc","s_farg_log","s_farg_match","s_farg_mid","s_farg_nper","s_farg_npv","s_farg_pmt","s_farg_pv","s_farg_rate","s_farg_replace","s_farg_vp","s_farg_valpre","s_farg_csl","s_farg_cslp","s_farg_subs","s_farg_sumif","s_farg_hms","s_farg_txt","s_farg_vlookup","s_farg_weekday","s_farg_dt","function_classlist","s_fclass_all","s_fclass_stat","s_fclass_lookup","s_fclass_datetime","s_fclass_financial","s_fclass_test","s_fclass_math","s_fclass_text","lastone","ConstantsDefaultClasses","defaultComment","defaultCommentNoGrid","defaultHighlightTypeCursor","defaultHighlightTypeRange","defaultColname","defaultSelectedColname","defaultRowname","defaultSelectedRowname","defaultUpperLeft","defaultSkippedCell","defaultPaneDivider","cteGriddiv","defaultInputEcho","classname","TCmain","TCendcap","TCpaneslider","TClessbutton","TCmorebutton","TCscrollarea","TCthumb","TCPStrackingline","TCTDFSthumbstatus","TDpopupElement","ConstantsSetClasses","prefix","item","defaults","scc","Callbacks","expand_wiki","expand_markup","displayvalue","linkstyle","default_expand_markup","MakePageLink","NormalizeSheetName","Cell","datavalue","datatype","formula","valuetype","CellProperties","errors","comment","bt","br","bb","bl","layout","font","color","bgcolor","cellformat","nontextvalueformat","textvalueformat","colspan","rowspan","cssc","csss","mod","displaystring","parseinfo","hcolspan","hrowspan","CellPropertiesTable","Sheet","ResetSheet","statuscallback","statuscallbackparams","sheet","reload","attribs","lastcol","lastrow","defaultlayout","rowattribs","hide","colattribs","width","names","layouts","layouthash","fonts","fonthash","colors","colorhash","borderstyles","borderstylehash","cellformats","cellformathash","valueformats","valueformathash","copiedfrom","changes","UndoStack","renderneeded","changedrendervalues","recalcchangedavalue","AddCell","newcell","GetAssuredCell","ParseSheetSave","savedsheet","CellFromStringParts","parts","j","CreateSheetSave","range","canonicalize","CellToString","CanonicalizeSheet","full","EncodeCellAttributes","EncodeSheetAttributes","DecodeCellAttributes","DecodeSheetAttributes","ScheduleSheetCommands","isRemote","CreateAuditString","GetStyleNum","atype","GetStyleString","num","RecalcSheet","line","t","v","lines","defaultcolwidth","defaultrowheight","defaulttextformat","defaultnontextformat","defaultfont","defaulttextvalueformat","defaultnontextvalueformat","defaultcolor","defaultbgcolor","circularreferencecell","recalc","needsrecalc","decodeFromSave","toUpperCase","desc","definition","charAt","sheetfields","sheetfieldsshort","sheetfieldsxlat","sheetfieldsxlatshort","sheetfieldsxlatxlt","cr1","cr2","prange","xlt","ParseRange","maxrow","maxcol","crToCoord","rcColname","encodeForSave","newborderstyles","newcellformats","newcolors","newfonts","newlayouts","newvalueformats","namesorder","r","l","borderstylesxlat","layoutsxlat","fontsxlat","colorsxlat","cellformatsxlat","valueformatsxlat","cr","filled","an","newa","newxlat","used","ahash","alist","sort","Array","colorsUsed","borderstylesUsed","fontsUsed","layoutsUsed","cellformatsUsed","valueformatsUsed","coordToCr","unshift","InitAttrib","def","InitAttribs","namelist","SetAttrib","SetAttribStar","rowheight","newattribs","changed","CheckChanges","attribname","oldval","cmdname","DoCmd","str","alignvert","padtop","padright","padbottom","padleft","fontlook","fontsize","fontfamily","SheetCommandInfo","parseobj","timerobj","firsttimerdelay","timerdelay","maxtimeslice","CmdExtensionCallbacks","cmdextensionbusy","broadcast","sheetid","sci","Parse","PushChange","SheetCommandsTimerRoutine","errortext","starttime","EOF","ExecuteSheetCommand","NextLine","ResumeFromCmdExtension","cmd1","rest","what","attrib","pos","pos2","undostart","fillright","rowstart","colstart","crbase","rowoffset","coloffset","basecell","clipsheet","cliprange","numcols","numrows","attribtable","colend","rowend","newcolstart","newrowstart","newcolend","newrowend","rownext","colnext","colthis","rowbefore","colbefore","oldformula","oldcr","cols","dirs","lastsortcol","sortlist","sortcells","sortvalues","sorttypes","sortfunction","valtype","originalrow","sortedcr","v1","v2","cmdextension","cellProperties","RestOfStringNoMove","AddDo","NextToken","RestOfString","AddUndo","celldisplayneeded","Clipboard","clipboard","OffsetFormulaCoords","slast","a1","b1","ta","cresult","tb","AdjustFormulaCoords","movingcells","dest","destcr","inserthoriz","insertvert","pushamount","movedto","ReplaceFormulaCoords","recalconce","func","tos","TOS","Undo","didredo","Redo","command","stack","ttext","ttype","newcr","updatedformula","scf","Formula","tokentype","TokenType","token_op","op","token_string","string","token_coord","tokenOpExpansion","TokenOpExpansion","ParseFormulaIntoTokens","sheetref","RecalcInfo","currentState","start_calc","order","calc","start_wait","done_wait","recalctimer","timeslicedelay","LoadSheet","RecalcData","inrecalc","celllist","celllistitem","calclist","calclistlength","firstcalc","lastcalc","nextcalc","count","checkinfo","RecalcCheckInfo","oldcoord","parsepos","inrange","inrangestart","c1","c2","r1","r2","scri","FreshnessInfoReset","RecalcClearTimeout","RecalcSetTimeout","RecalcTimerRoutine","RecalcLoadedSheet","recalcneeded","AddSheetToCache","SheetCache","waitingForLoading","previousrecalcsheet","eresult","status","recalcdata","do_statuscallback","arg","RecalcCheckCell","total","evaluate_parsed_formula","RemoteFunctionInfo","waitingForServer","funcname","error","FreshnessInfo","recalc_completed","startcoord","rangecoord","coordvals","token_name","mainloop","LookupName","delimiter","lineEnd","pos1","oldpos","maxRedo","maxUndo","pop","shift","RenderContext","hideRowsCols","showGrid","showRCHeaders","rownamewidth","pixelsPerRow","cellskip","coordToCR","colwidth","totalwidth","rowpanes","colpanes","cursorsuffix","highlightTypes","cursor","cursorinsertup","cursorinsertleft","range2","cellIDprefix","defaultlinkstyle","defaultHTMLlinkstyle","defaultfontstyle","defaultfontsize","defaultfontfamily","defaultpanedividerwidth","defaultpanedividerheight","gridCSS","commentClassName","commentCSS","commentNoGridClassName","commentNoGridCSS","classnames","colname","rowname","selectedcolname","selectedrowname","upperleft","skippedcell","panedivider","explicitStyles","needcellskip","needprecompute","first","last","PrecomputeSheetFontsAndLayouts","CalculateCellSkipData","CalculateColWidthData","SetRowPaneFirstLast","panenum","SetColPaneFirstLast","CoordInPane","rowpane","colpane","CellInPane","InitializeTable","tableobj","RenderSheet","oldtable","RenderColGroup","RenderColHeaders","RenderSizingRow","RenderRow","rownum","RenderSpacingRow","RenderCell","colnum","noElement","layoutre","dparts","sparts","weight","size","family","skiprow","skipcol","skipcoord","borderCollapse","cellSpacing","cellPadding","newrow","colgroupobj","tbodyobj","parentnode","appendChild","parentNode","replaceChild","EvalUserScripts","newcol","newdiv","cssText","verticalAlign","innerHTML","overflow","w","SCNoColNames","span","sheetattribs","stylestr","CreatePseudoElement","colSpan","rowSpan","FormatValueForDisplay","CallOutOnRenderCell","IsCoordEditable","setStyles","panerowlimits","panecollimits","collow","colhigh","Math","floor","letters","coordToCol","coordToRow","ch","charCodeAt","decodeFromAjax","special_chars","Lookup","list","element","part","GetViewportInfo","innerWidth","innerHeight","horizontalScroll","pageXOffset","verticalScroll","pageYOffset","documentElement","clientWidth","clientHeight","scrollLeft","scrollTop","body","GetElementPosition","offsetLeft","offsetTop","offsetParent","left","top","GetElementPositionWithScroll","offsetElement","tagName","LookupElement","array","AssignID","idPrefix","cellobj","valueformat","valuesubtype","format_text_for_display","ScriptCheck","format_number_for_display","rawvalue","dvsc","dvue","textval","encodeURI","expand_text_link","u","FormatNumber","formatNumberWithFormat","DetermineValueType","tvalue","matches","year","hour","minute","second","denom","intgr","constr","isNaN","convert_date_gregorian_to_julian","InputConstants","TRUE","FALSE","#N/A","#NULL!","#NUM!","#DIV/0!","#VALUE!","#REF!","#NAME?","ParseCellLinkText","pagename","newwin","workspacename","workspace","pageform","urlend","descstart","lastlt","lastIndexOf","lastbrkt","lastbrace","descend","wsend","outputformat","dorecalc","clipextents","div","ConvertOtherFormatToSave","inputstr","inputformat","inquote","maxc","SetConvertedCell","HasTouch","agent","TouchInfo","registeredElements","threshold_x","threshold_y","orig_coord_x","orig_coord_y","final_coord_x","final_coord_y","px_to_rows","px_to_cols","touch_start","ranging","ranging_threshold","move_start","last_touch","timeout_handle","doubletap_threshold","TouchRegister","functionobj","touchinfo","addEventListener","ProcessTouchStart","ProcessTouchMove","ProcessTouchEnd","ProcessTouchCancel","FindTouchElement","srcElement","wobj","targetTouches","pageX","pageY","getTime","TouchGetSimulatedMouseEvent","mouse_evt_name","touches","changedTouches","simulatedEvent","createEvent","initMouseEvent","screenX","screenY","clientX","clientY","mouseDn","fullgrid","dispatchEvent","mouseMv","changeX","changeY","mouseUp","abs","amount_y","amount_x","Swipe","now","lasttouch","delta","DoubleTap","timeoutFn","SingleTap","EditorProcessSwipe","swipevert","swipehoriz","busy","EditorProcessSingleTap","EditorProcessDoubleTap","mouseDblClick","ProcessOrientationChange","TableEditor","toplevel","noEdit","tablewidth","tableheight","inputBox","inputEcho","verticaltablecontrol","horizontaltablecontrol","logo","cellhandles","timeout","ensureecell","deferredCommands","gridposition","headposition","firstscrollingrow","firstscrollingrowtop","lastnonscrollingrow","lastvisiblerow","firstscrollingcol","firstscrollingcolleft","lastnonscrollingcol","lastvisiblecol","rowpositions","colpositions","imageprefix","pageUpDnAmount","recalcFunction","EditorSheetStatusCallback","ctrlkeyFunction","charname","ha","position","sel","cliptext","pasteTextarea","hasrange","right","bottom","IsCellEditable","focus","select","GetSpreadsheetControlObject","blur","KeyboardFocus","showPasteTextArea","pasteHTMLarea","visibility","isPasteSameAsClipboard","_ObjectReplacementCharacter_","html","search","innerText","RegExp","clipstr","ntvf","newntvf","CtrlSEditor","StatusCallback","MoveECellCallback","RangeChangeCallback","SettingsCallbacks","CreateTableEditor","ResizeTableEditor","SaveEditorSettings","LoadEditorSettings","flags","EditorRenderSheet","ignorebusy","EditorStepSet","GetStatuslineString","params","EditorGetStatuslineString","EditorMouseRegister","EditorMouseUnregister","EditorMouseRange","EditorProcessKey","EditorAddToInput","DisplayCellContents","EditorDisplayCellContents","EditorApplySetCommandsToRange","MoveECellWithKey","MoveECell","ReplaceCell","SetECellHeaders","selected","EnsureECellVisible","RangeAnchor","RangeExtend","RangeRemove","Range2Remove","FitToEditTable","CalculateEditorPositions","ScheduleRender","DoRenderStep","SchedulePositionCalculations","DoPositionCalculations","CalculateRowPositions","positions","sizes","CalculateColPositions","ScrollRelative","vertical","amount","vamount","hamount","PageRelative","direction","LimitLastPanes","ScrollTableUpOneRow","ScrollTableDownOneRow","ScrollTableLeftOneCol","ScrollTableRightOneCol","EditorChangecontact","phone","street","city","company","EditorChangeSheetfont","no_of_cells","EditorClearSheet","cell_to_clear","griddiv","max","TableControl","CreateTableControl","main","table","tbody","tr","td","layouttable","TooltipRegister","InputEcho","CellHandles","removeEventListener","SafariPasteFunction","nodeType","contentEditable","MouseWheelRegister","WheelMove","EditorProcessMouseWheel","KeyboardSetFocus","setting","anchorcoord","save","anchorrow","anchorcol","load","f","dcmd","signalstatus","addmsg","EditorStepInfo","sstr","progress","circ","sum","calculating","EditorMouseInfo","ignore","mousedowncoord","mouselastcoord","mouseresizecol","mouseresizeclientx","mouseresizedisplay","mouseinfo","ProcessEditorMouseDown","ProcessEditorDblClick","attachEvent","oldelement","detachEvent","splice","mobj","viewport","GridMousePosition","rowheader","colheader","coltoresize","ProcessEditorColsizeMouseDown","shiftKey","ToggleCell","ProcessEditorMouseMove","ProcessEditorMouseUp","setCapture","stopPropagation","cancelBubble","returnValue","inputtext","GetText","partialexpr","sheetpref","startsheet","SetText","Blur","ShowInputBox","ShowCellHandles","SetDragAutoRepeat","releaseCapture","mouseresizecolnum","mousedownclientx","sizedisplay","zIndex","lastChild","childNodes","ProcessEditorColsizeMouseMove","ProcessEditorColsizeMouseUp","newsize","FinishColsize","removeChild","AutoRepeatInfo","timer","repeatinterval","repeatcallback","repeatinfo","rowfooter","colfooter","distance","DragAutoRepeat","EditorOpenCellEdit","disabled","Focus","Select","erow","ecol","startsheetid","currentsheetid","substr","skipOne","valueinfo","fch","oldvalue","mousewheelinfo","controlborder","rowindex","colindex","shifted","original","newelement","headercell","totalrows","needed","ComputeTableControlPositions","ok","PositionTableControlElements","$","trigger","toprow","offset","trowobj","cellposition","offsetHeight","leftcol","offsetWidth","vplen","vlimit","hplen","hlimit","IsScrollPossible","newfirst","totalsize","current","panes","lastpane","lastvisible","sizearray","defaultsize","plen","oldrownum","newbottomrow","oldchild","bottomrownum","rowneedsrefresh","maxrowspan","newrownum","insertBefore","InputBox","onmousedown","InputBoxOnMouseDown","formulabar","InputBoxDisplayCellContents","show","ShowInputEcho","newtext","InputBoxFocus","selection","createRange","duplicate","moveToElementText","collapse","selectionStart","selectionEnd","CoordForColorChange","editCoord","inputbox","spreadsheetDiv","fontSize","borderBottomColor","borderBottomLeftRadius","borderBottomRightRadius","borderBottomStyle","borderBottomWidth","borderLeftColor","borderLeftStyle","borderLeftWidth","borderRightColor","borderRightStyle","borderRightWidth","borderTopColor","borderTopLeftRadius","borderTopRightRadius","borderTopStyle","borderTopWidth","Keyboard","focusTable","interval","container","functionbox","topprompt","DragRegister","MouseDown","DragFunctionStart","MouseMove","DragFunctionPosition","MouseUp","Disabled","positionobj","SetInputEchoText","inputecho","InputEchoHeartbeat","fstr","newstr","FunctionList","FillFunctionInfo","FunctionArgString","promptstr","InputEchoMouseDown","noCursorSuffix","movedmouse","draghandle","imagetype","dragpalette","dragtooltip","fillinghandle","CellHandlesMouseMoveOnHandle","CellHandlesMouseDown","moveshow","doshow","mouseDown","whichhandle","SegmentDivHit","CellHandlesHoverTimeout","tooltipstimer","tooltipswhichhandle","CellHandlesTooltipsTimeout","segtable","divWithMouseHit","x","y","len","sqrt","pow","quadrant","dragtype","filltype","startingcoord","startingX","startingY","CellHandlesMouseMove","CellHandlesMouseUp","crstart","crend","CellHandlesDragAutoRepeat","newcoord","vscroll","hscroll","cstr","cmdtype2","sizec","sizer","deltac","deltar","endcap","paneslider","lessbutton","morebutton","scrollarea","thumb","endcapstart","panesliderstart","lessbuttonstart","morebuttonstart","scrollareastart","scrollareaend","scrollareasize","thumbpos","controlthickness","sliderthickness","buttonthickness","thumbthickness","minscrollingpanesize","functions","etype","vh","backgroundImage","TCPSDragFunctionStart","TCPSDragFunctionMove","TCPSDragFunctionStop","repeatwait","normalstyle","downstyle","hoverstyle","Repeat","ButtonRegister","ScrollAreaClick","TCTDragFunctionStart","TCTDragFunctionMove","TCTDragFunctionStop","buttoninfo","bobj","clickpos","border","realend","draginfo","dobj","trackingline","min","offsetY","offsetX","thumbstatus","rowmsgele","rowpreviewele","thumbcontext","pane","TCTDragFunctionRowSetStatus","msg","thumbrowshown","DragInfo","draggingElement","startX","startY","startZ","horizontal","DragMouseDown","DragUnregister","viewportinfo","DragMouseMove","DragMouseUp","TooltipInfo","registered","tooltipElement","popupElement","tiptext","tooltipinfo","TooltipMouseMove","tobj","TooltipHide","ButtonInfo","buttonDown","TooltipWaitDone","TooltipMouseDown","TooltipDisplay","offsetx","offsety","buttonElement","doingHover","paramobj","ButtonMouseDown","ButtonMouseOver","ButtonMouseOut","MouseOver","MouseOut","ButtonMouseUp","ButtonRepeat","MouseWheelInfo","ProcessMouseWheel","passThru","wheelDelta","detail","keyboardTables","specialKeysCommon","8","9","13","25","27","33","34","35","36","37","38","39","40","45","46","113","specialKeysIE","controlKeysIE","67","83","86","88","90","specialKeysOpera","controlKeysOpera","specialKeysSafari","63232","63233","63234","63235","63272","63273","63275","63276","63277","63237","controlKeysSafari","99","115","118","120","122","ignoreKeysSafari","63236","63238","63239","63240","63241","63242","63243","63244","63245","63246","63247","63289","specialKeysFirefox","controlKeysFirefox","ignoreKeysFirefox","16","17","18","20","19","44","91","92","112","114","116","117","119","121","123","144","145","224","areListener","didProcessKey","statusFromProcessKey","repeatingKeyPress","chForProcessKey","onkeydown","ProcessKeyDown","onkeypress","ProcessKeyPress","kt","which","keyIdentifier","keyCode","ctrlKey","ProcessKey","metaKey","charCode","ft","contactname","contactphoneNumber","contactemail","contactStreet","contactcity","contactcompany","format_definitions","separatorchar","decimalchar","daynames","daynames3","monthnames3","monthnames","allowedcolors","BLACK","BLUE","CYAN","GREEN","MAGENTA","RED","WHITE","YELLOW","alloweddates","H","M","MM","S","SS","commands","copy","integer_placeholder","fraction_placeholder","decimal","currency","general","separator","comparison","section","datevalues","julian_offset","seconds_in_a_day","seconds_in_an_hour","format_string","currency_char","operandstr","fromend","cval","operandstrlc","startval","estartval","hrs","mins","secs","ehrs","emins","esecs","ampmstr","ymd","minOK","thisformat","gotcomparison","compop","compval","cpos","oppos","sectioninfo","decimalscale","scaledvalue","strvalue","strparts","integervalue","fractionvalue","integerdigits2","integerpos","fractionpos","textcolor","textstyle","scfn","isFinite","negativevalue","zerovalue","FormatNumber_DefaultCurrency","parse_format_string","hascomparison","operators","operands","commas","percent","fractiondigits","integerdigits","hasdate","convert_date_julian_to_gregorian","mspos","sectionstart","thousandssep","factor","LOG10E","day","month","format_defs","lastwasinteger","lastwasslash","lastwasasterisk","lastwasunderscore","quotestr","inbracket","bracketstr","bracketdata","ingeneral","indate","chpos","integerpart","parse_format_bracket","operator","operand","ampstr","juliandate","intFunc","L","N","I","J","K","ParseState","alpha","stringquote","numexp1","numexp2","alphanumeric","specialvalue","space","CharClass","numstart","eof","incoord","quote","specialstart","CharClassTable"," ","!","\"","#","%","&","(",")","*","+",",","-",".","/","0","1","2","3","4","5","6","7",":","<","=",">","A","B","C","D","E","F","G","O","P","Q","R","T","U","V","W","X","Y","Z","^","_","d","g","h","k","o","q","z","UpperCaseTable","SpecialConstants","TokenPrecedence","TypeLookupTable","unaryminus","n*","e*","t*","unaryplus","unarypercent","plus","n%","nd","nt","ndt","n$","nl","th","tw","tl","oneargnumeric","twoargnumeric","propagateerror","haddecimal","last_token","last_token_type","last_token_text","parsestate","charclass","charclasstable","uppercasetable","pushtoken","ParsePushToken","coordregex","cclass","topcode","opcode","allowrangereturn","revpolish","ConvertInfixToPolish","EvaluatePolish","pii","tprecedence","tstackprecedence","token_precedence","parsestack","function_start","rii","prii","value1","value2","tostype","tostype2","resulttype","cond","vmatch","smatch","lookup_result_type","LookupResultType","typelookup","operand_as_number","OperandAsNumber","operand_as_text","OperandAsText","operand_value_and_type","OperandValueAndType","operands_as_coord_on_sheet","OperandsAsCoordOnSheet","missingOperandError","PushOperand","OperandsAsRangeOnSheet","CalculateFunction","type1","type2","table1","TopOfStackValueAndType","stacklen","operandinfo","cellvtype","coordsheet","StepThroughRangeDown","FindInSheetCache","PlainCoord","OperandAsCoord","othersheet","OperandAsSheetName","nvalue","specialc","startedwalk","checknamecirc","rangevalue","sequence","rp","OrderRangeParts","DecodeRangeParts","coordsheetdata","col1num","ncols","row1num","nrows","FunctionClasses","FunctionArgDefs","fobj","foperand","ffunc","argnum","CopyFunctionArgs","FunctionArgsError","FunctionSpecificError","errortype","CheckForErrorValue","classes","cname","items","nargs","fdata","adef","SeriesFunctions","maxval","minval","mk","sk","mk1","sk1","typelookupplus","resulttypesum","counta","countblank","product","DSeriesFunctions","dbrange","fieldname","criteriarange","dbinfo","criteriainfo","fieldasnum","targetcol","criteriafieldnums","testok","criteriacr","criteria","testcol","testcr","FieldToColnum","criterianum","CRITERIAROW","TestCriteria","fieldtype","LookupFunctions","lookupvalue","rangelookup","offsetvalue","rangeinfo","cincr","rincr","previousOK","csave","rsave","IndexFunction","indexinfo","CountifSumifFunctions","sumrange","f2operand","IfFunction","DateFunction","TimeFunction","hours","minutes","seconds","DMYFunctions","dtype","doffset","datevalue","HMSFunctions","fraction","datetime","ExactFunction","v1type","v2type","ArgList","FIND","LEFT","LEN","LOWER","MID","PROPER","REPLACE","REPT","RIGHT","SUBSTITUTE","TRIM","UPPER","StringFunctions","start","numargs","argdef","operand_value","operand_type","word","fulltext","oldtext","IsFunctions","NTVFunctions","Math1Functions","acos","asin","atan","cos","PI","exp","sin","tan","Math2Functions","xval","yval","quotient","atan2","LogFunction","RoundFunction","round","AndOrFunctions","NotFunction","ChooseFunction","cindex","ColumnsRowsFunctions","ZeroArgFunctions","tzoffset","start_1_1_1970","nowdays","getTimezoneOffset","volatile","NOW","TODAY","DDBFunction","method","depreciation","accumulateddepreciation","cost","salvage","lifetime","period","SLNFunction","SYDFunction","sumperiods","InterestFunctions","dval","evalue","fval","pv","fv","rate","payment","paytype","guess","part1","part2","part3","part4","part5","olddelta","maxloop","tries","oldrate","aval","bval","eval","epsilon","NPVFunction","resulttypenpv","IRRFunction","oldsum","rangeoperand","cashflows","constants","asloaded","recalcing","recalcdone","loadsheet","sfsc","nsheetname","newsheet","sfscc","newsheetname","recalcstate","scffi","coord1","coord2","comparitor","basestring","basevalue","testvalue","Popup","Types","Controls","Current","imagePrefix","LocalizeString","Create","pt","SetValue","sp","spt","spc","spcdata","changedcallback","SetDisabled","Hide","GetValue","Initialize","Reset","CClick","Show","Close","Cancel","CreatePopupDiv","mainele","backgroundColor","moveable","dragregistered","EnsurePosition","GetLayoutValues","popup","popupele","DestroyPopupDiv","RGBToHex","rgbvals","ToHex","HexDigits","FromHex","HexToRGB","makeRGB","splitRGB","rgb","List","spcid","inputWidth","custom","skip","cancel","MakeCustom","customele","listdiv","contentele","MakeList","ensureWithin","bg","SPLoc","ItemClicked","oele","nele","CustomToList","CustomOK","rowele","ColorChooser","spca","sampleWidth","sampleHeight","img","backgroundImageDefault","backgroundPosition","backgroundImageDisabled","CreateGrid","padding","grid","borderRight","backgroundRepeat","marginTop","defaultbox","onclick","DefaultClicked","CustomClicked","CloseOK","GridMouseDown","DetermineColors","SetColors","gridToG","sptc","steps","commonrgb","mousedown","gpos","newrgb","oldrgb","ControlClicked","cid","CustomToGrid","CurrentSpreadsheetControlObject","requestedHeight","requestedWidth","requestedSpaceBelow","viewheight","tabs","tabnums","tabreplacements","currentTab","views","editorDiv","sortrange","moverange","multipartBoundary","toolbarbackground","tabbackground","tabselectedCSS","tabplainCSS","toolbartext","formulabarheight","sheetbarheight","sheetbarCSS","statuslineheight","statuslineCSS","ExportCallback","statusline","SpreadsheetControlStatuslineCallback","statuslineid","recalcid1","recalcid2","movefrom","formulabuttons","formulafunctions","image","tooltip","DoFunctionList","multilineinput","DoMultiline","link","DoLink","DoSum","edit","oncreate","settings","view","SettingsControls","SettingControlReset","cellattribs","SettingsControlLoadPanel","values","sheetspanel","cellspanel","SpreadsheetControlSettingsSwitch","onclickFocus","viewobj","colorchooser","formatnumber","initialdata","formattext","textalignhoriz","numberalignhoriz","cformatnumber","cformattext","cfontfamily","cfontlook","cfontsize","calignhoriz","calignvert","ctextcolor","cbgcolor","cbt","cbr","cbb","cbl","cpadtop","cpadright","cpadbottom","cpadleft","SettingsControlInitializePanel","replacements","itemtitle","regex","replacement","sectiontitle","parttitle","itembody","bodypart","divStyle","SpreadsheetControlSortOnclick","SpreadsheetControlSortSave","SpreadsheetControlSortLoad","audit","SCLoc","CmdGotFocus","SpreadsheetControlCommentOnclick","onunclick","SpreadsheetControlCommentOnunclick","SpreadsheetControlNamesOnclick","SpreadsheetControlNamesOnunclick","SpreadsheetControlClipboardOnclick","spacebelow","SizeSSDiv","combostr","SpreadsheetControlExecuteCommand","SpreadsheetControlCreateSheetHTML","CreateSpreadsheetSave","otherparts","SpreadsheetControlCreateSpreadsheetSave","DecodeSpreadsheetSave","SpreadsheetControlDecodeSpreadsheetSave","CreateCellHTML","SpreadsheetControlCreateCellHTML","CreateCellHTMLSave","SpreadsheetControlCreateCellHTMLSave","child","vname","button","bele","SCLocSS","LocalizeSubstrings","Buttons","button_undo","button_redo","button_copy","button_cut","button_paste","button_pasteformats","button_delete","button_filldown","button_fillright","button_movefrom","button_movepaste","button_moveinsert","button_alignleft","button_aligncenter","button_alignright","button_borderon","button_borderoff","button_swapcolors","button_merge","button_unmerge","button_insertrow","button_insertcol","button_deleterow","button_deletecol","button_recalc","DoButtonCmd","dummyFormulaDiv","src","InputLineClearText","nonviewheight","CreateSheetStatusBar","statuslineDiv","paddingTop","paddingBottom","sheetstatusbarDiv","sheetbarDiv","sheetstatusbartable","LocalizeStringList","csco","needresize","resized","nodestyle","newval","fudgefactorX","fudgefactorY","marginBottom","marginLeft","marginRight","SetTab","newtab","tname","newtabnum","newview","menutabs","tools","needsresize","onresize","rele1","rele2","UpdateSortRangeProposal","LoadColumnChoosers","nrange","rparts","sele","oldindex","selectedIndex","Option","cl","clele","slist","slistele","rele","lele","SpreadsheetCmdTable","slists","checked","SpreadsheetCmdLookup","SpreadsheetCmdSLookup","cut","paste","pasteformats","delete","filldown","erase","borderon","borderoff","merge","unmerge","align-left","align-center","align-right","align-default","insertrow","insertcol","deleterow","deletecol","eobj","cellHTML","fcl","idp","GetFunctionNamesStr","GetFunctionInfoStr","vp","FillFunctionNames","scsc","FunctionClassChosen","FunctionChosen","HideFunctions","DoFunctionPaste","mele","HideMultiline","DoMultilineClear","DoMultilinePaste","setformat","HideLink","DoLinkClear","DoLinkPaste","ltsym","gtsym","obsym","cbsym","descele","urlele","pagenameele","workspaceele","formatele","foundvalue","SpreadsheetControlCommentMoveECell","SpreadsheetControlCommentDisplay","SpreadsheetControlCommentSet","SpreadsheetControlNamesRangeChange","SpreadsheetControlNamesFillNameList","SpreadsheetControlNamesChangedName","SpreadsheetControlNamesSetValue","SpreadsheetControlNamesSave","SpreadsheetControlNamesDelete","clipele","SpreadsheetControlClipboardFormat","SpreadsheetControlClipboardLoad","savetype","SpreadsheetControlClipboardClear","SpreadsheetControlClipboardExport","sheettable","celltable","sheettoolbar","celltoolbar","SettingsControlSetCurrentPanel","SettingsControlSave","sc","panelobj","CurrentPanel","SettingsControlUnloadPanel","partname","extranl","otherpartsstr","otherpartsnames","mpregex","searchinfo","boundary","boundaryregex","blanklineregex","ending","partlist","lastIndex","exec","pnum","end","PopupChangeCallback","ctrlname","ctrl","str1","str2","cv","fontFamily","paddingRight","paddingLeft","borderTop","borderBottom","borderLeft","BorderSideGetValue","textAlign","fontStyle","fontWeight","PopupListSetValue","PopupListGetValue","ctl","PopupListInitialize","otext","InitialData","optionvals","PopupListReset","PopupList","OnReset","ChangedCallback","ColorChooserSetValue","ColorChooserGetValue","ColorChooserInitialize","ColorChooserReset","BorderSideSetValue","idname","idstart","BorderSideInitialize","SettingsControlOnchangeBorder","nameparts","ctrlidsuffix","ctrltype","BorderSide","OnClick","ColorComboOnClick","thickness","OtherSaveParts","whichpart","strtoedit","editbox","ebta","CtrlSEditorDone","idprefix","edittextarea","spread","defaultsheetname","defaultsheet","AddNewWorkBookSheetNoSwitch","AddNewWorkBookSheet","oldsheetname","fromclip","ActivateWorkBookSheet","DeleteWorkBookSheet","cursheetname","SaveWorkBookSheet","LoadRenameWorkBookSheet","newname","RenameWorkBookSheet","oldname","CopyWorkBookSheet","PasteWorkBookSheet","newid","oldid","RenderWorkBookSheet","SheetNameExistsInWorkBook","WorkbookScheduleCommand","isremote","WorkbookScheduleSheetCommand","editorprop","oldsheetid","sheetnamestr","oldsheetnamestr","curname","RenameWorkBookSheetCell","oldsheet","newsheetid","CurrentWorkbookControlObject","TestWorkBookSaveStr","book","divid","sheetCnt","numSheets","renameDialogId","deleteDialogId","hideDialogId","unhideDialogId","sheetshtml","sheetbar","SheetBar","WorkBookControlAddSheetRemote","WorkBookControlDelSheetRemote","WorkBookControlRenameSheetRemote","foo","WorkBookControlAddSheet","WorkBookControlDelSheet","deletedbutton","did","dname","sheetbarbutton","WorkBookControlDeleteSheetHide","WorkBookControlDeleteSheetSubmit","setAttribute","SheetBarButtonActivate","WorkBookControlHideSheet","WorkBookControlHideSheetHide","WorkBookControlHideSheetSubmit","WorkBookControlUnhideSheet","unhiddencount","WorkBookControlUnhideSheetHide","WorkBookControlUnhideSheetSubmit","old","WorkBookControlAddSheetButton","fnname","SheetBarSheetButton","SheetBarSheetButtonPress","addworksheet","WorkBookControlHttpRequest","WorkBookControlAlertContents","loadedstr","http_request","readyState","responseText","WorkBookControlAjaxCall","contents","XMLHttpRequest","ActiveXObject","onreadystatechange","URL","setRequestHeader","send","sheetsave","WorkBookControlCreateNewBook","firstrun","newbuttons","SheetBarButtonSetName","WorkBookControlRenameSheet","WorkBookControlRenameSheetHide","WorkBookControlRenameSheetSubmit","smallname","renbutton","WorkBookControlNewBook","WorkBookControlMove","newSheetArr","curr_button","curr_sb_button","sib_button","sib_sb_button","previousSibling","nextSibling","currid","sibid","parent","sb_parent","cloned","clonedsb","WorkBookControlMoveLeft","WorkBookControlMoveRight","WorkBookControlCopySheet","WorkBookControlPasteSheet","baseDiv","prebuttonsDiv","buttonsDiv","buttonActionsDiv","parentdiv","imgele","active","sbbutton","isactive","menu","clickedsheetid","SheetBarSheetButtonMenuPosition","SheetBarSheetButtonMenu","SheetBarSheetButtonMenuItem","SheetBarMenuItemPress","ele1","hlessbutton","ScriptInfo","scripts","commentstart","commentend","script","EvalUserScript","head","getElementsByTagName","GetCellDataValue","bindex","GetCellDataArray","coordstr","vals","coords","UserScriptData","WorkBookRecalculateInfo","calcorder","pass","WorkBookRecalculateAll","WorkBookRecalculateStep","SpinnerWaitHide","SpinnerWaitCreate","sheetcoord","curr_vpos","curr_hpos","cellinner","sheetlist","pageBreakAfter","escapable","meta","holder","partial","mind","gap","toJSON","rep","indent","valueOf","getUTCFullYear","getUTCMonth","getUTCDate","getUTCHours","getUTCMinutes","getUTCSeconds","Number","Boolean","cx","\b","\t","\n","\f","\r","\\","replacer","Error","","reviver","walk","SyntaxError","thread","ms","nextTick","BASE_URL","fetch","headers","Content-Type","response","statusText","json","valuePromise","NULL","UNDEFINED","ZERO","EMPTYSTRING","all","remaining","race","disable","enabled","enable","onUnhandled","allRejections","matchWhitelist","rejections","whitelist","DEFAULT_WHITELIST","displayId","logged","logError","onHandled","warn","_72","errStr","some","cls","RangeError","ba","onError","ja","da","ea","ia","ka","fa","oa","currentTarget","na","ra","pa","qa","sa","extractEvents","eventTypes","phasedRegistrationNames","ua","registrationName","va","wa","dependencies","xa","Ca","ma","za","stateNode","la","Da","Aa","Ba","Ea","Fa","Ga","Ha","La","Ma","Ka","Ia","Ra","Oa","Qa","Pa","Na","Sa","acceptsBooleans","Ta","attributeName","attributeNamespace","mustUseProperty","propertyName","sanitizeURL","Va","Xa","removeAttribute","setAttributeNS","nb","mb","ob","_status","_ctor","_result","pb","displayName","ab","$a","hb","ib","$$typeof","eb","db","gb","jb","lb","kb","qb","tag","_debugOwner","_debugSource","fileName","Ya","lineNumber","return","rb","sb","nodeName","getOwnPropertyDescriptor","get","set","getValue","setValue","stopTracking","_valueTracker","xb","yb","zb","defaultChecked","defaultValue","_wrapperState","initialChecked","Ab","initialValue","controlled","Bb","Cb","Db","Eb","ownerDocument","activeElement","Fb","aa","Children","Gb","children","Hb","defaultSelected","Ib","dangerouslySetInnerHTML","Jb","isArray","Kb","Lb","textContent","Nb","Ob","Rb","nodeValue","Sb","Wb","Ub","Tb","Vb","cc","bc","Map","dc","alternate","effectTag","ec","memoizedState","dehydrated","fc","gc","sibling","hc","ic","jc","lc","_dispatchListeners","_dispatchInstances","isPropagationStopped","isPersistent","release","mc","kc","nc","correspondingUseElement","oc","ya","qc","topLevelType","nativeEvent","targetInst","ancestors","pc","rc","eventSystemFlags","containerInfo","tc","uc","has","vc","ac","Jc","Hc","Ic","Kc","blockedOn","Lc","Bc","Cc","Dc","Ec","pointerId","Fc","Mc","Nc","xc","Oc","Pc","unstable_runWithPriority","priority","yc","hydrate","Qc","Rc","Sc","Tc","zc","Ac","wc","Uc","unstable_scheduleCallback","unstable_NormalPriority","Vc","Gc","ad","bubbled","captured","eventPriority","Zc","Yc","Wc","gd","hd","Ja","ed","dd","fd","ld","jd","md","setProperty","od","pd","is","rd","sd","ud","vd","wd","contains","compareDocumentPosition","xd","HTMLIFrameElement","contentWindow","location","href","yd","Fd","autoFocus","Gd","__html","Jd","Kd","zd","Cd","Bd","Ad","Md","Od","Pd","Qd","Nd","Rd","Sd","Td","dispatchConfig","Ud","_targetInst","Vd","Wd","Xd","ae","$d","Zd","Yd","be","ce","Interface","isDefaultPrevented","defaultPrevented","ee","eventPool","fe","destructor","de","getPooled","qe","ie","re","te","pe","ne","ue","se","je","altKey","char","me","locale","xe","we","ze","ye","change","Ce","De","Ee","Ge","Ae","He","Be","Ie","Je","Ke","Le","Pe","getModifierState","Oe","Qe","Ze","bf","$e","af","jf","hf","ef","defaultView","getSelection","anchorNode","anchorOffset","focusNode","focusOffset","gf","df","ff","of","zf","yf","Cf","contextTypes","Af","__reactInternalMemoizedUnmaskedChildContext","__reactInternalMemoizedMaskedChildContext","childContextTypes","Df","Ef","Ff","getChildContext","Gf","__reactInternalMemoizedMergedChildContext","Bf","Hf","ag","Nf","Of","Pf","Qf","Rf","Sf","cg","If","dg","Jf","eg","Wf","Xf","fg","Tf","gg","Kf","Yf","hg","ig","defaultProps","ng","mg","lg","kg","og","jg","_context","_currentValue","pg","childExpirationTime","qg","firstContext","expirationTime","rg","sg","observedBits","next","responders","ug","updateQueue","baseState","baseQueue","shared","pending","effects","vg","wg","suspenseConfig","payload","xg","yg","zg","tg","ca","Ag","Bg","Cg","Fg","Kg","shouldComponentUpdate","isPureReactComponent","Lg","contextType","updater","Jg","_reactInternalFiber","Mg","componentWillReceiveProps","UNSAFE_componentWillReceiveProps","enqueueReplaceState","Ng","refs","Eg","getDerivedStateFromProps","getSnapshotBeforeUpdate","UNSAFE_componentWillMount","componentWillMount","componentDidMount","Pg","ref","_owner","_stringRef","Qg","Rg","lastEffect","nextEffect","firstEffect","Sg","Tg","mode","elementType","Ug","implementation","Vg","Wg","Za","Og","Zg","dh","bh","ah","$g","namespaceURI","eh","fh","gh","hh","memoizedProps","revealOrder","ih","responder","nh","oh","lh","jh","ph","qh","rh","sh","mh","uh","wh","lastRenderedReducer","action","eagerReducer","eagerState","lastRenderedState","dispatch","xh","yh","zh","Ah","destroy","deps","Bh","Ch","Dh","Eh","Fh","Gh","Hh","Ih","Jh","Kh","Lh","Mh","Nh","kh","suspense","Gg","Dg","Hg","Ig","Rh","Sh","Th","pendingProps","Uh","Qh","Ph","Oh","Vh","Wh","Xh","Yg","Xg","Zh","$h","ai","bi","compare","ci","di","ei","fi","UNSAFE_componentWillUpdate","componentWillUpdate","componentDidUpdate","gi","Yh","getDerivedStateFromError","hi","pendingContext","ji","fallback","unstable_avoidThisFallback","ii","ki","li","isBackwards","rendering","renderingStartTime","tail","tailExpiration","tailMode","mi","ri","si","oi","pi","wasMultiple","multiple","qd","createElementNS","ni","Qb","qi","ti","ui","vi","wi","xi","yi","$f","zi","Ai","Ci","Di","componentWillUnmount","Ei","Fi","Gi","__reactInternalSnapshotBeforeUpdate","Hi","Ii","Ji","Ki","Li","Mi","Ni","Oi","Pi","Qi","Ri","_reactRootContainer","Si","Ti","Ui","Bi","Vi","add","Xi","Yi","Zi","$i","componentDidCatch","aj","Set","componentStack","fj","gj","wj","timeoutMs","uj","vj","xj","ej","yj","tj","zj","lastExpiredTime","firstPendingTime","Aj","lastPingedTime","nextKnownPendingLevel","callbackExpirationTime","callbackPriority","callbackNode","Bj","Cj","Dj","Ej","Fj","Gj","Hj","cj","hj","kj","finishedWork","finishedExpirationTime","ij","lastSuspendedTime","Ij","lj","pj","oj","Hd","Jj","mj","bj","jj","nj","busyMinDurationMs","busyDelayMs","Kj","Lj","Mj","Nj","Id","pingCache","Wi","Oj","ub","vb","Pj","Xc","Qj","Uf","Rj","dj","Sj","rj","firstSuspendedTime","Dd","rangeCount","wb","Ed","activeElementDetached","focusedElem","selectionRange","Tj","extend","setStart","removeAllRanges","addRange","setEnd","Vf","qj","sj","Uj","Vj","Wj","Yj","__REACT_DEVTOOLS_GLOBAL_HOOK__","isDisabled","supportsFiber","inject","onCommitFiberRoot","onCommitFiberUnmount","Zj","isReactComponent","Xj","fb","pendingChildren","ak","bk","ck","dk","retryTime","ek","fk","_internalRoot","gk","hk","hasAttribute","ik","jk","kk","Ua","xlinkHref","Wa","__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED","ReactCurrentDispatcher","ReactCurrentBatchConfig","Pb","for","Mb","mathml","svg","MSApp","execUnsafeLocalFunction","animationend","animationiteration","animationstart","transitionend","animation","transition","Xb","Yb","Zb","$b","WeakMap","$c","bd","cd","unstable_UserBlockingPriority","animationIterationCount","borderImageOutset","borderImageSlice","borderImageWidth","boxFlex","boxFlexGroup","boxOrdinalGroup","columnCount","columns","flex","flexGrow","flexPositive","flexShrink","flexNegative","flexOrder","gridArea","gridRow","gridRowEnd","gridRowSpan","gridRowStart","gridColumn","gridColumnEnd","gridColumnSpan","gridColumnStart","lineClamp","lineHeight","opacity","orphans","tabSize","widows","zoom","fillOpacity","floodOpacity","stopOpacity","strokeDasharray","strokeDashoffset","strokeMiterlimit","strokeOpacity","strokeWidth","kd","menuitem","area","base","embed","hr","keygen","param","track","wbr","Ld","random","persist","eventPhase","bubbles","cancelable","timeStamp","isTrusted","ge","he","ke","documentMode","le","oe","beforeInput","compositionEnd","compositionStart","compositionUpdate","ve","datetime-local","number","tel","time","week","Fe","Me","_isInputEventSupported","Ne","Alt","Control","Meta","Shift","Re","Se","Te","Ue","Ve","buttons","relatedTarget","fromElement","toElement","movementX","movementY","We","pressure","tangentialPressure","tiltX","tiltY","twist","pointerType","isPrimary","Xe","mouseEnter","mouseLeave","pointerEnter","pointerLeave","Ye","parentWindow","cf","kf","onSelect","lf","animationName","elapsedTime","pseudoElement","mf","clipboardData","nf","pf","Esc","Spacebar","Left","Up","Del","Win","Apps","Scroll","MozPrintableKey","qf","12","32","rf","repeat","sf","dataTransfer","tf","uf","vf","deltaX","wheelDeltaX","deltaY","wheelDeltaY","deltaZ","deltaMode","wf","xf","SimpleEventPlugin","EnterLeaveEventPlugin","ChangeEventPlugin","SelectEventPlugin","BeforeInputEventPlugin","unstable_cancelCallback","Lf","unstable_requestPaint","Mf","unstable_now","unstable_getCurrentPriorityLevel","unstable_ImmediatePriority","unstable_LowPriority","unstable_IdlePriority","unstable_shouldYield","Zf","isMounted","enqueueSetState","enqueueForceUpdate","readContext","useCallback","useContext","useEffect","useImperativeHandle","useLayoutEffect","useMemo","useReducer","useRef","useState","useDebugValue","useResponder","useDeferredValue","useTransition","ReactCurrentOwner","WeakSet","ceil","_calculateChangedBits","unstable_observedBits","unmount","querySelectorAll","form","lk","Events","findFiberByHostInstance","overrideHookState","overrideProps","setSuspenseHandler","scheduleUpdate","currentDispatcherRef","findHostInstanceByFiber","findHostInstancesForRefresh","scheduleRefresh","scheduleRoot","setRefreshHandler","getCurrentFiber","bundleType","version","rendererPackageName","createPortal","findDOMNode","flushSync","unmountComponentAtNode","unstable_batchedUpdates","unstable_createPortal","unstable_renderSubtreeIntoContainer","checkDCE","normalizeName","normalizeValue","iteratorFor","support","iterable","Headers","append","consumed","bodyUsed","fileReaderReady","reader","onload","onerror","readBlobAsArrayBuffer","blob","FileReader","readAsArrayBuffer","readBlobAsText","readAsText","readArrayBufferAsText","buf","Uint8Array","chars","bufferClone","byteLength","buffer","Body","_initBody","_bodyInit","_bodyText","Blob","isPrototypeOf","_bodyBlob","formData","FormData","_bodyFormData","searchParams","URLSearchParams","arrayBuffer","isDataView","_bodyArrayBuffer","ArrayBuffer","isArrayBufferView","rejected","decode","normalizeMethod","upcased","methods","Request","credentials","referrer","bytes","parseHeaders","rawHeaders","Response","bodyInit","viewClasses","DataView","isView","oldValue","thisArg","entries","clone","redirectStatuses","redirect","init","request","xhr","getAllResponseHeaders","responseURL","ontimeout","withCredentials","responseType","polyfill","escape","keyPrefix","forceUpdate","__self","__source","IsSomeRendererActing","toArray","only","Fragment","Profiler","PureComponent","StrictMode","Suspense","cloneElement","createContext","_currentValue2","_threadCount","Provider","Consumer","createFactory","createRef","forwardRef","isValidElement","lazy","memo","sortIndex","startTime","priorityLevel","MessageChannel","unstable_forceFrameRate","performance","cancelAnimationFrame","requestAnimationFrame","port2","port1","onmessage","postMessage","unstable_Profiling","unstable_continueExecution","unstable_getFirstCallbackNode","unstable_next","unstable_pauseExecution","delay","unstable_wrapCallback","header","preProcessedHeaders"],"mappings":"CAAS,SAAUA,GCInB,QAAAC,GAAAC,GAGA,GAAAC,EAAAD,GACA,MAAAC,GAAAD,GAAAE,OAGA,IAAAC,GAAAF,EAAAD,IACAE,WACAE,GAAAJ,EACAK,QAAA,EAUA,OANAP,GAAAE,GAAAM,KAAAH,EAAAD,QAAAC,IAAAD,QAAAH,GAGAI,EAAAE,QAAA,EAGAF,EAAAD,QAvBA,GAAAD,KAqCA,OATAF,GAAAQ,EAAAT,EAGAC,EAAAS,EAAAP,EAGAF,EAAAU,EAAA,IAGAV,EAAA,IDIW,SAASD,GAEnB,IAAI,GAAIY,KAAKZ,GACZ,GAAGa,OAAOC,UAAUC,eAAeP,KAAKR,EAASY,GAChD,aAAcZ,GAAQY,IACtB,IAAK,WAAY,KACjB,KAAK,SAEJZ,EAAQY,GAAM,SAASI,GACtB,GAAIC,GAAOD,EAAGE,MAAM,GAAIC,EAAKnB,EAAQgB,EAAG,GACxC,OAAO,UAAUI,EAAEC,EAAEX,GACpBS,EAAGG,MAAMC,MAAOH,EAAEC,EAAEX,GAAGc,OAAOP,MAE9BjB,EAAQY,GACV,MACD,SAECZ,EAAQY,GAAKZ,EAAQA,EAAQY,IAKhC,MAAOZ,KAGF,SAASK,EAAQD,EAASH,GAE/BA,EAAoB,IACpBI,EAAOD,QAAUH,EAAoB,KAKhC,SAASI,EAAQD,EAASH,GE3EhC,YAGAI,GAAAD,QAAAH,EAAA,KFqFM,SAASI,EAAQD,GAEtB,YAEAS,QAAOY,eAAerB,EAAS,cACfsB,OAAO,GG7FbC,YAAW,gBAEXC,QAEPC,QACIC,MACCC,KAAQC,UAAY,EAAEC,UAAY,SAASC,YAAc,QAAQC,UAAYC,QAAUC,UAAYC,QAAU,iuNAAiuNC,KAAO,QAAQC,OAAS,KAAKC,QAAUJ,UAAYC,QAAU,m5QAA66QC,KAAO,SAASC,OAAS,KAAKE,QAAUL,UAAYC,QAAU,4lLAA4lLC,KAAO,UAAUC,OAAS,KAAKG,QAAUN,UAAYC,QAAU,y3MAAi5MC,KAAO,SAASC,OAAS,MAAMI,eAAiBC,OAAQ,EAAKC,OAASC,aAAY,EAAKC,YAAW,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,YAAW,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,aAAY,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,aAAY,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,eAAc,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC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AKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,eAAc,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,aAAY,EAAKC,cAAa,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,aAAY,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,aAAY,EAAKC,cAAa,EAAKC,YAAW,EAAKC,aAAY,EAAKC,eAAc,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,aAAY,EAAKC,YAAW,EAAKC,YAAW,EAAKC,aAAY,EAAKC,cAAa,EAAKC,cAAa,EAAKC,aAAY,EAAKC,aAAY,EAAKC,cAAa,EAAKC,eAAc,EAAKC,eAAc,EAAKC,cAAa,EAAKC,cAAa,GAAMC,iBACl0+BC,UAAarO,KAAM,YAAcsO,MAAO,EAAGC,UAAU,IAASvO,KAAM,YAAcsO,MAAO;AAAGC,UAAU,IACtFvO,KAAM,oBAAsBsO,MAAO,EAAGC,UAAU,IAASvO,KAAM,oBAAsBsO,MAAO,EAAGC,UAAU,KAE1HE,QACCjP,KAAQC,UAAY,EAAEC,UAAY,SAASC,YAAc,OAAOC,UAAYC,QAAUC,UAAYC,QAAU,uyQAAuyQC,KAAO,OAAOC,OAAS,KAAKC,QAAUJ,UAAYC,QAAU,m9MAAm9MC,KAAO,OAAOC,OAAS,KAAKE,QAAUL,UAAYC,QAAU,m0SAAu3SC,KAAO,SAASC,OAAS,KAAKG,QAAUN,UAAYC,QAAU,irJAAirJC,KAAO,OAAOC,OAAS,KAAKyO,QAAU5O,UAAYC,QAAU;EAAirJC,KAAO,SAASC,OAAS,MAAMI,eAAiBC,OAAQ,EAAKC,OAASoO,WAAU,EAAKC,WAAU,EAAKC,WAAU,EAAKC,WAAU,EAAKC,WAAU,EAAKC,WAAU,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,WAAU,EAAKC,WAAU,EAAKC,WAAU,EAAKC,WAAU,EAAKC,WAAU,EAAKC,WAAU,EAAKC,WAAU,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,WAAU,EAAKC,WAAU,EAAKC,WAAU,EAAKC,WAAU,EAAKC,WAAU,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,WAAU,EAAKC,WAAU,EAAKC,WAAU,EAAKC,WAAU,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC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AW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,WAAU,EAAKC,WAAU,EAAKC,WAAU,EAAKC,WAAU,EAAKC,WAAU,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,WAAU,EAAKC,WAAU,EAAKC,WAAU,EAAKC,WAAU,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,WAAU,EAAKC,WAAU,EAAKC,WAAU,EAAKC,WAAU,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAA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KC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,eAAc,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,aAAY,EAAKC,cAAa,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,aAAY,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,aAAY,EAAKC,cAAa,EAAKC,YAAW,EAAKC,aAAY,EAAKC,eAAc,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,aAAY,EAAKC,YAAW,EAAKC,YAAW,EAAKC,aAAY,EAAKC,cAAa,EAAKC,cAAa,EAAKC,aAAY,EAAKC,aAAY,EAAKC,cAAa,EAAKC,eAAc,EAAKC,eAAc,EAAKC,cAAa,EAAKC,cAAa,GAAMC,iBACl0+BC,UAAarO,KAAM,YAAcsO,MAAO,EAAGC,UAAU,IAASvO,KAAM,YAAcsO,MAAO,EAAGC,UAAU,IACtFvO,KAAM,oBAAsBsO,MAAO,EAAGC,UAAU,IAASvO,KAAM,oBAAsBsO,MAAO,EAAGC,UAAU,KAE1HC,SACChP,KAAQC,UAAY,EAAEC,UAAY,SAASC,YAAc,QAAQC,UAAYC,QAAUC,UAAYC,QAAU,iuNAAiuNC,KAAO,QAAQC,OAAS,KAAKC,QAAUJ,UAAYC,QAAU,m5QAA66QC,KAAO,SAASC,OAAS,KAAKE,QAAUL,UAAYC,QAAU;EAA4lLC,KAAO,UAAUC,OAAS,KAAKG,QAAUN,UAAYC,QAAU,y3MAAi5MC,KAAO,SAASC,OAAS,MAAMI,eAAiBC,OAAQ,EAAKC,OAASC,aAAY,EAAKC,YAAW,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,YAAW,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,aAAY,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,aAAY,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,eAAc,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,eAAc,EAAKC,aAAY,EAAKC,cAAa,EAAKC,aAAY,EAA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,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,WAAU,EAAKC,WAAU,EAAKC,WAAU,EAAKC,WAAU,EAAKC,WAAU,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,WAAU,EAAKC,WAAU,EAAKC,WAAU,EAAKC,WAAU,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,WAAU,EAAKC,WAAU,EAAKC,WAAU,EAAKC,WAAU,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,WAAU,EAAKC,YAAW,EAAKC,YAAW,EAAKC,WAAU,EAAKC,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AU,EAAKC,WAAU,EAAKC,WAAU,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,WAAU,EAAKC,WAAU,EAAKC,WAAU,EAAKC,WAAU,EAAKC,WAAU,EAAKC,WAAU,EAAKC,WAAU,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,YAAW,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,aAAY,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAAa,EAAKC,cAA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","file":"static/js/main.fa9dcaf2.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"/\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ((function(modules) {\n\t// Check all modules for deduplicated modules\n\tfor(var i in modules) {\n\t\tif(Object.prototype.hasOwnProperty.call(modules, i)) {\n\t\t\tswitch(typeof modules[i]) {\n\t\t\tcase \"function\": break;\n\t\t\tcase \"object\":\n\t\t\t\t// Module can be created from a template\n\t\t\t\tmodules[i] = (function(_m) {\n\t\t\t\t\tvar args = _m.slice(1), fn = modules[_m[0]];\n\t\t\t\t\treturn function (a,b,c) {\n\t\t\t\t\t\tfn.apply(this, [a,b,c].concat(args));\n\t\t\t\t\t};\n\t\t\t\t}(modules[i]));\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\t// Module is a copy of another module\n\t\t\t\tmodules[i] = modules[modules[i]];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\treturn modules;\n}([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t__webpack_require__(24);\n\tmodule.exports = __webpack_require__(12);\n\n\n/***/ },\n/* 1 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tif (true) {\n\t  module.exports = __webpack_require__(26);\n\t} else {\n\t  module.exports = require('./cjs/react.development.js');\n\t}\n\n\n/***/ },\n/* 2 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t                value: true\n\t});\n\tvar APP_NAME = exports.APP_NAME = \"Invoice Suite\";\n\t\n\tvar DATA = exports.DATA = {\n\t                \"ledger\": {\n\t                                \"iPad\": {\n\t                                                \"msc\": { \"numsheets\": 4, \"currentid\": \"sheet1\", \"currentname\": \"typei\", \"sheetArr\": { \"sheet1\": { \"sheetstr\": { \"savestr\": \"version:1.5\\ncell:A2:b::2:::l:1:f:7\\ncell:B2:t:INVOICE:b:1:1:1:1:f:6:cf:1:colspan:6\\ncell:C2:t::b:2::2::l:1:f:7\\ncell:D2:t::b:2::2::l:1:f:7\\ncell:E2:t::b:2::2::l:1:f:7\\ncell:F2:t::b:2::2::l:1:f:7\\ncell:G2:t::b:2::2::l:1:f:7\\ncell:A3:b::2:::l:3:f:7\\ncell:B3:b:2:::2:l:3:f:7\\ncell:C3:b:2::::l:1:f:7\\ncell:D3:b:2::::l:1:f:7\\ncell:E3:b:2::::l:1:f:7\\ncell:F3:b:2::::l:1:f:7\\ncell:G3:b:2:2:::l:3:f:7\\ncell:A4:b::2:::l:3:f:7\\ncell:B4:b::::2:l:3:f:3\\ncell:C4:t:INVOICE # \\\\c:f:2:cf:2\\ncell:D4:v:1:f:2:cf:2\\ncell:F4:tvf:4:rowspan:4\\ncell:G4:b::2:::l:3:f:7\\ncell:A5:b::2:::l:3:f:7\\ncell:B5:b::::2:l:3:f:4\\ncell:F5:t::l:2:f:7\\ncell:G5:t::b::1:::l:2:f:7\\ncell:A6:b::2:::l:3:f:7\\ncell:B6:b::::2:l:3:f:4\\ncell:C6:t:INVOICE DATE\\\\c:f:2:cf:2\\ncell:D6:f:2:cf:2:ntvf:3\\ncell:F6:l:2:f:7\\ncell:G6:b::1:::l:2:f:7\\ncell:A7:b::2:::l:3:f:7\\ncell:B7:b::::2:l:3:f:4\\ncell:G7:b::2:::l:3:f:7\\ncell:A8:b::2:::l:3:f:7\\ncell:B8:b::::2:l:3:f:4\\ncell:G8:b::2:::l:3:f:7\\ncell:A9:b::2:::l:3:f:7\\ncell:B9:b::::2:l:3:f:4\\ncell:C9:t:BILL TO\\\\c:l:3:f:2\\ncell:E9:t:FROM\\\\c:f:2:cf:2\\ncell:G9:b::2:::l:3:f:7\\ncell:A10:b::2:::l:3:f:7\\ncell:B10:b::::2:l:3:f:3\\ncell:C10:t:[Name]:f:1:cf:2:colspan:2\\ncell:E10:t:[Name]:f:1:cf:2:colspan:2\\ncell:G10:b::2:::l:3:f:7\\ncell:A11:b::2:::l:3:f:7\\ncell:B11:b::::2:l:3:f:7\\ncell:C11:t:[Street Address]:f:1:cf:2:colspan:2\\ncell:E11:t:[Street Address]:f:1:cf:2:colspan:2\\ncell:G11:b::2:::l:3:f:7\\ncell:A12:b::2:::l:3:f:7\\ncell:B12:b::::2:l:3:f:7\\ncell:C12:t:[City, State, Zip]:f:1:cf:2:colspan:2\\ncell:E12:t:[City, State, Zip]:f:1:cf:2:colspan:2\\ncell:G12:b::2:::l:3:f:7\\ncell:A13:b::2:::l:3:f:7\\ncell:B13:b::::2:l:3:f:7\\ncell:C13:t:Phone\\\\c:f:1:cf:2:colspan:2\\ncell:E13:t:Phone\\\\c:f:1:cf:2:colspan:2\\ncell:G13:b::2:::l:3:f:7\\ncell:A14:b::2:::l:3:f:7\\ncell:B14:b::::2:l:3:f:3:cf:2\\ncell:C14:b:::2::l:1:f:7\\ncell:D14:b:::2::l:3:f:3:cf:2\\ncell:E14:b:::2::l:1:f:7\\ncell:F14:b:::2::l:1:f:7\\ncell:G14:b::2:::l:3:f:7\\ncell:A15:b::2:::l:3:f:7\\ncell:B15:b::2::2:l:3:f:7\\ncell:C15:t:Description:b:1::1:1:f:2:cf:1:colspan:3\\ncell:D15:t:Description:b:1::1::l:3:f:3:cf:2:colspan:2:rowspan:1\\ncell:E15:t::b:2:2:2::l:1:f:7\\ncell:F15:t:Amount:b:1:1:1:1:f:2:cf:1\\ncell:G15:b::2::2:l:3:f:7\\ncell:A16:b::2:::l:3:f:7\\ncell:B16:b::2::2:l:3:f:7\\ncell:C16:b:1:1::1:f:1:cf:2:colspan:3\\ncell:D16:b:1:1:::l:3:f:7:cf:2:colspan:2:rowspan:1\\ncell:E16:t::b:2:2:2::l:1:f:7\\ncell:F16:b:1:1:::f:1:ntvf:1\\ncell:G16:b::2::2:l:3:f:7\\ncell:A17:b::2:::l:3:f:7\\ncell:B17:b::2::2:l:3:f:7:cf:2\\ncell:C17:b::1::1:f:1:cf:2:colspan:3\\ncell:D17:b::1:::l:1:f:7:colspan:2\\ncell:E17:l:1:f:7\\ncell:F17:b::1:::f:1:ntvf:1\\ncell:G17:b::2::2:l:3:f:7\\ncell:A18:b::2:::l:3:f:7\\ncell:B18:b::2::2:l:3:f:7:cf:2:ntvf:2\\ncell:C18:b::1::1:f:1:cf:2:colspan:3\\ncell:D18:b::1:::colspan:2\\ncell:F18:b::1:::f:1:ntvf:1\\ncell:G18:b::2::2:l:3:f:7\\ncell:A19:b::2:::l:3:f:7\\ncell:B19:b::2::2:l:3:f:7:cf:2:ntvf:2\\ncell:C19:b::1::1:f:1:cf:2:colspan:3\\ncell:D19:b::1:::colspan:2\\ncell:F19:b::1:::f:1:ntvf:1\\ncell:G19:b::2::2:l:3:f:7\\ncell:A20:b::2:::l:3:f:7\\ncell:B20:b::2::2:l:3:f:7:cf:2:ntvf:2\\ncell:C20:b::1::1:f:1:cf:2:colspan:3\\ncell:D20:b::1:::colspan:2\\ncell:F20:b::1:::f:1:ntvf:1\\ncell:G20:b::2::2:l:3:f:7\\ncell:A21:b::2:::l:3:f:7\\ncell:B21:b::2::2:l:3:f:7:cf:2:ntvf:2\\ncell:C21:b::1::1:f:1:cf:2:colspan:3\\ncell:D21:b::1:::colspan:2\\ncell:F21:b::1:::f:1:ntvf:1\\ncell:G21:b::2::2:l:3:f:7\\ncell:A22:b::2:::l:3:f:7\\ncell:B22:b::2::2:l:3:f:7:cf:2:ntvf:2\\ncell:C22:b::1::1:f:1:cf:2:colspan:3\\ncell:D22:b::1:::colspan:2\\ncell:F22:b::1:::f:1:ntvf:1\\ncell:G22:b::2::2:l:3:f:7\\ncell:A23:b::2:::l:3:f:7\\ncell:B23:b::2::2:l:3:f:7:cf:2\\ncell:C23:b::1::1:f:1:cf:2:colspan:3\\ncell:D23:b::1:::colspan:2\\ncell:F23:b::1:::f:1:ntvf:1\\ncell:G23:b::2::2:l:3:f:7\\ncell:A24:b::2:::l:3:f:7\\ncell:B24:b::2::2:l:3:f:7:cf:2\\ncell:C24:b::1::1:f:1:cf:2:colspan:3\\ncell:D24:b::1:::colspan:2\\ncell:F24:b::1:::f:1:ntvf:1\\ncell:G24:b::2::2:l:3:f:7\\ncell:A25:b::2:::l:3:f:7\\ncell:B25:b::2::2:l:3:f:7:cf:2\\ncell:C25:b::1::1:f:1:cf:2:colspan:3\\ncell:D25:b::1:::colspan:2\\ncell:F25:b::1:::f:1:ntvf:1\\ncell:G25:b::2::2:l:3:f:7\\ncell:A26:b::2:::l:3:f:7\\ncell:B26:b::2::2:l:3:f:7:cf:2\\ncell:C26:b::1::1:f:1:cf:2:colspan:3\\ncell:D26:b::1:::colspan:2\\ncell:F26:b::1:::f:1:ntvf:1\\ncell:G26:b::2::2:l:3:f:7\\ncell:A27:b::2:::l:3:f:7\\ncell:B27:b::2::2:l:3:f:7:cf:2\\ncell:C27:b::1::1:f:1:cf:2:colspan:3\\ncell:D27:b::1:::colspan:2\\ncell:F27:b::1:::f:1:ntvf:1\\ncell:G27:b::2::2:l:3:f:7\\ncell:A28:b::2:::l:3:f:4\\ncell:B28:b::2::2:l:3:f:7:cf:2\\ncell:C28:b::1:1:1:f:1:cf:2:colspan:3\\ncell:D28:b::1:1::l:3:f:7:cf:2:colspan:2\\ncell:E28:b:::2::l:3:f:7:cf:2\\ncell:F28:b::1:1::f:1:ntvf:1\\ncell:G28:b::2::2:l:3:f:7\\ncell:A29:b::2:::l:3:f:3\\ncell:B29:b::2::2:l:3:f:3\\ncell:C29:t:TOTAL:b:1:1:1:1:f:5:cf:2:colspan:3\\ncell:D29:b:2::2::l:3:f:8:cf:2\\ncell:E29:b:2:2:2::l:3:f:8:cf:2\\ncell:F29:vtf:n:0:SUM(F16\\\\cF28):b:1:1:1::f:5:ntvf:1\\ncell:G29:b::2::2:l:3:f:4\\ncell:A30:b::2:::l:3:f:7\\ncell:B30:b::::2:l:3:f:3:cf:2\\ncell:C30:b:2::::l:1:f:7\\ncell:D30:b:2::::l:1:f:7\\ncell:E30:b:2::::l:1:f:7\\ncell:F30:b:2::::l:1:f:7\\ncell:G30:b::2:::l:3:f:3\\ncell:A31:b::2:::l:3:f:7\\ncell:B31:b::::2:l:3:f:7\\ncell:D31:tvf:4:rowspan:4\\ncell:G31:b::2:::l:3:f:7\\ncell:A32:b::2:::l:3:f:7\\ncell:B32:b::::2:l:3:f:7\\ncell:G32:b::2:::l:3:f:7\\ncell:A33:b::2:::l:3:f:7\\ncell:B33:b::::2:l:3:f:7\\ncell:G33:b::2:::l:3:f:7\\ncell:A34:b::2:::l:3:f:7\\ncell:B34:b::::2:l:3:f:7\\ncell:G34:b::2:::l:3:f:7\\ncell:A35:b::2:::l:3:f:7\\ncell:B35:b:::2:2:l:3:f:7\\ncell:C35:b:::2::l:3:f:7\\ncell:D35:b:::2::l:3:f:7\\ncell:E35:b:::2::l:3:f:7\\ncell:F35:b:::2::l:3:f:7\\ncell:G35:b::2:2::l:3:f:7\\ncell:B36:b:1:::\\ncell:C36:b:1:::\\ncell:D36:b:1:::\\ncell:E36:b:1:::\\ncell:F36:b:1:::\\ncell:G36:b:1:::\\ncol:A:w:10\\ncol:B:w:42\\ncol:C:w:105\\ncol:D:w:182\\ncol:E:w:110\\ncol:F:w:115\\ncol:G:w:65\\nrow:1:h:14.25\\nrow:2:h:18.75\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:15.75\\nrow:6:h:15.75\\nrow:7:h:15.75\\nrow:8:h:15.75\\nrow:9:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:13:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:16:h:14.25\\nrow:17:h:14.25\\nrow:18:h:14.25\\nrow:19:h:14.25\\nrow:20:h:14.25\\nrow:21:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nrow:24:h:14.25\\nrow:25:h:14.25\\nrow:26:h:14.25\\nrow:27:h:14.25\\nrow:28:h:15.75\\nrow:29:h:15.75\\nrow:30:h:14.25\\nrow:31:h:14.25\\nrow:32:h:14.25\\nrow:33:h:14.25\\nrow:34:h:14.25\\nrow:35:h:14.25\\nsheet:c:7:r:36:h:12.75\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\nfont:1:* * Trebuchet MS\\nfont:2:normal bold * Trebuchet MS\\nfont:3:normal bold 10pt Arial\\nfont:4:normal bold 12pt Arial\\nfont:5:normal bold 12pt Trebuchet MS\\nfont:6:normal bold 14pt Trebuchet MS\\nfont:7:normal normal 10pt Arial\\nfont:8:normal normal 12pt Arial\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nlayout:3:padding:* * * *;vertical-align:top;\\nvalueformat:1:#,##0.00\\nvalueformat:2:d-mmm\\nvalueformat:3:m/d/yy\\nvalueformat:4:text-html\\n\" }, \"name\": \"typei\", \"hidden\": \"0\" }, \"sheet2\": { \"sheetstr\": { \"savestr\": \"version:1.5\\ncell:A2:b::2:::l:1:f:7\\ncell:B2:t:INVOICE:b:1:1:1:1:l:3:f:6:cf:1:colspan:8\\ncell:C2:t::b:2::2::l:1:f:7\\ncell:D2:t::b:2::2::l:1:f:7\\ncell:E2:t::b:2::2::l:1:f:7\\ncell:F2:t::b:2::2::l:1:f:7\\ncell:G2:b:2::2::l:1:f:7\\ncell:H2:b:2::2::l:1:f:7\\ncell:I2:t::b:2::2::l:1:f:7\\ncell:A3:b::2:::l:3:f:7\\ncell:B3:b:2:::2:l:3:f:7\\ncell:E3:b:2::::l:1:f:7\\ncell:F3:b:2::::l:1:f:7\\ncell:G3:b:2::::l:1:f:7\\ncell:H3:b:2::::l:1:f:7\\ncell:I3:b:2:2:::l:3:f:7\\ncell:A4:b::2:::l:3:f:7\\ncell:B4:b::::2:l:3:f:3\\ncell:C4:t:INVOICE # \\\\c:f:2:cf:2\\ncell:D4:v:1:f:2:cf:2\\ncell:F4:tvf:5:colspan:2:rowspan:4\\ncell:I4:b::2:::l:3:f:7\\ncell:A5:b::2:::l:3:f:7\\ncell:B5:b::::2:l:3:f:4\\ncell:F5:t::l:2:f:7\\ncell:G5:l:2:f:7\\ncell:H5:l:2:f:7\\ncell:I5:t::b::1:::l:2:f:7\\ncell:A6:b::2:::l:3:f:7\\ncell:B6:b::::2:l:3:f:4\\ncell:C6:t:INVOICE DATE\\\\c:f:2:cf:2\\ncell:D6:f:2:cf:2:ntvf:4\\ncell:F6:l:2:f:7\\ncell:G6:l:2:f:7\\ncell:H6:l:2:f:7\\ncell:I6:b::1:::l:2:f:7\\ncell:A7:b::2:::l:3:f:7\\ncell:B7:b::::2:l:3:f:4\\ncell:I7:b::2:::l:3:f:7\\ncell:A8:b::2:::l:3:f:7\\ncell:B8:b::::2:l:3:f:4\\ncell:I8:b::2:::l:3:f:7\\ncell:A9:b::2:::l:3:f:7\\ncell:B9:b::::2:l:3:f:4\\ncell:C9:t:BILL TO\\\\c:f:2\\ncell:E9:t:FROM\\\\c:f:2:cf:2\\ncell:F9:colspan:3\\ncell:I9:b::2:::l:3:f:7\\ncell:A10:b::2:::l:3:f:7\\ncell:B10:b::::2:l:3:f:3\\ncell:C10:t:[Name]:f:1:cf:2:colspan:2\\ncell:E10:t:[Name]:f:1:cf:2:colspan:4\\ncell:I10:b::2:::l:3:f:7\\ncell:A11:b::2:::l:3:f:7\\ncell:B11:b::::2:l:3:f:7\\ncell:C11:t:[Street Address]:f:1:cf:2:colspan:2\\ncell:E11:t:[Street Address]:f:1:colspan:4\\ncell:I11:b::2:::l:3:f:7\\ncell:A12:b::2:::l:3:f:7\\ncell:B12:b::::2:l:3:f:7\\ncell:C12:t:[City, State, Zip]:f:1:cf:2:colspan:2\\ncell:E12:t:[City, State, Zip]:f:1:cf:2:colspan:4\\ncell:I12:b::2:::l:3:f:7\\ncell:A13:b::2:::l:3:f:7\\ncell:B13:b::::2:l:3:f:7\\ncell:C13:t:Phone\\\\c :f:1:cf:2:colspan:2\\ncell:E13:t:Phone\\\\c :f:1:cf:2:colspan:4\\ncell:I13:b::2:::l:3:f:7\\ncell:A14:b::2:::l:3:f:7\\ncell:B14:b::::2:l:3:f:3:cf:2\\ncell:C14:b:::2::l:1:f:7\\ncell:D14:b:::2::l:3:f:3:cf:2\\ncell:E14:b:::2::l:1:f:7\\ncell:F14:b:::2::l:1:f:7\\ncell:G14:b:::2::l:1:f:7\\ncell:H14:b:::2::l:1:f:7\\ncell:I14:b::2:::l:3:f:7\\ncell:A15:b::2:::l:3:f:7\\ncell:B15:b::2::2:l:3:f:7\\ncell:C15:t:Description:b:1:1:1:1:f:2:cf:1:colspan:3\\ncell:D15:t:Description:b:2::2:2:l:3:f:3:cf:2:colspan:2:rowspan:1\\ncell:E15:t::b:2:2:2::l:1:f:7\\ncell:F15:t:Hours:b:1:1:1:1:f:2:cf:1\\ncell:G15:t:Rate:b:1:1:1:1:f:2:cf:1\\ncell:H15:t:Amount:b:1:1:1:1:f:2:cf:1\\ncell:I15:b::2::2:l:3:f:7\\ncell:A16:b::2:::l:3:f:7\\ncell:B16:b::2::2:l:3:f:7\\ncell:C16:b:1:1::1:f:1:cf:2:colspan:3\\ncell:D16:b:1:1::1:l:3:f:7:cf:2:colspan:2:rowspan:1\\ncell:E16:t::b:2:2:2::l:1:f:7\\ncell:F16:b:1:1:::f:1:ntvf:1\\ncell:G16:b:1:1:::f:1:ntvf:1\\ncell:H16:vtf:t::IF(F16*G16>0,F16*G16,\\\"\\\"):b:1:1:::f:1:ntvf:1\\ncell:I16:b::2::2:l:3:f:7\\ncell:A17:b::2:::l:3:f:7\\ncell:B17:b::2::2:l:3:f:7:cf:2\\ncell:C17:b::1::1:f:1:cf:2:colspan:3\\ncell:D17:b::1::1:l:1:f:7:colspan:2\\ncell:E17:l:1:f:7\\ncell:F17:b::1:::f:1:ntvf:1\\ncell:G17:b::1:::f:1:ntvf:1\\ncell:H17:vtf:t::IF(F17*G17>0,F17*G17,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I17:b::2::2:l:3:f:7\\ncell:A18:b::2:::l:3:f:7\\ncell:B18:b::2::2:l:3:f:7:cf:2:ntvf:3\\ncell:C18:b::1::1:f:1:cf:2:colspan:3\\ncell:D18:b::1::1:colspan:2\\ncell:F18:b::1:::f:1:ntvf:1\\ncell:G18:b::1:::f:1:ntvf:1\\ncell:H18:vtf:t::IF(F18*G18>0,F18*G18,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I18:b::2::2:l:3:f:7\\ncell:A19:b::2:::l:3:f:7\\ncell:B19:b::2::2:l:3:f:7:cf:2:ntvf:3\\ncell:C19:b::1::1:f:1:cf:2:colspan:3\\ncell:D19:b::1::1:colspan:2\\ncell:F19:b::1:::f:1:ntvf:1\\ncell:G19:b::1:::f:1:ntvf:1\\ncell:H19:vtf:t::IF(F19*G19>0,F19*G19,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I19:b::2::2:l:3:f:7\\ncell:A20:b::2:::l:3:f:7\\ncell:B20:b::2::2:l:3:f:7:cf:2:ntvf:3\\ncell:C20:b::1::1:f:1:cf:2:colspan:3\\ncell:D20:b::1::1:colspan:2\\ncell:F20:b::1:::f:1:ntvf:1\\ncell:G20:b::1:::f:1:ntvf:1\\ncell:H20:vtf:t::IF(F20*G20>0,F20*G20,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I20:b::2::2:l:3:f:7\\ncell:A21:b::2:::l:3:f:7\\ncell:B21:b::2::2:l:3:f:7:cf:2:ntvf:3\\ncell:C21:b::1::1:f:1:cf:2:colspan:3\\ncell:D21:b::1::1:colspan:2\\ncell:F21:b::1:::f:1:ntvf:1\\ncell:G21:b::1:::f:1:ntvf:1\\ncell:H21:vtf:t::IF(F21*G21>0,F21*G21,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I21:b::2::2:l:3:f:7\\ncell:A22:b::2:::l:3:f:7\\ncell:B22:b::2::2:l:3:f:7:cf:2:ntvf:3\\ncell:C22:b::1::1:f:1:cf:2:colspan:3\\ncell:D22:b::1::1:colspan:2\\ncell:F22:b::1:::f:1:ntvf:1\\ncell:G22:b::1:::f:1:ntvf:1\\ncell:H22:vtf:t::IF(F22*G22>0,F22*G22,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I22:b::2::2:l:3:f:7\\ncell:A23:b::2:::l:3:f:7\\ncell:B23:b::2::2:l:3:f:7:cf:2\\ncell:C23:b::1::1:f:1:cf:2:colspan:3\\ncell:D23:b::1::1:colspan:2\\ncell:F23:b::1:::f:1:ntvf:1\\ncell:G23:b::1:::f:1:ntvf:1\\ncell:H23:vtf:t::IF(F23*G23>0,F23*G23,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I23:b::2::2:l:3:f:7\\ncell:A24:b::2:::l:3:f:7\\ncell:B24:b::2::2:l:3:f:7:cf:2\\ncell:C24:b::1::1:f:1:cf:2:colspan:3\\ncell:D24:b::1::1:colspan:2\\ncell:F24:b::1:::f:1:ntvf:1\\ncell:G24:b::1:::f:1:ntvf:1\\ncell:H24:vtf:t::IF(F24*G24>0,F24*G24,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I24:b::2::2:l:3:f:7\\ncell:A25:b::2:::l:3:f:7\\ncell:B25:b::2::2:l:3:f:7:cf:2\\ncell:C25:b::1::1:f:1:cf:2:colspan:3\\ncell:D25:b::1::1:colspan:2\\ncell:F25:b::1:::f:1:ntvf:1\\ncell:G25:b::1:::f:1:ntvf:1\\ncell:H25:vtf:t::IF(F25*G25>0,F25*G25,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I25:b::2::2:l:3:f:7\\ncell:A26:b::2:::l:3:f:7\\ncell:B26:b::2::2:l:3:f:7:cf:2\\ncell:C26:b::1::1:f:1:cf:2:colspan:3\\ncell:D26:b::1::1:colspan:2\\ncell:F26:b::1:::f:1:ntvf:1\\ncell:G26:b::1:::f:1:ntvf:1\\ncell:H26:vtf:t::IF(F26*G26>0,F26*G26,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I26:b::2::2:l:3:f:7\\ncell:A27:b::2:::l:3:f:7\\ncell:B27:b::2::2:l:3:f:7:cf:2\\ncell:C27:b::1::1:f:1:cf:2:colspan:3\\ncell:D27:b::1::1:colspan:2\\ncell:F27:b::1:::f:1:ntvf:1\\ncell:G27:b::1:::f:1:ntvf:1\\ncell:H27:vtf:t::IF(F27*G27>0,F27*G27,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I27:b::2::2:l:3:f:7\\ncell:A28:b::2:::l:3:f:4\\ncell:B28:b::2::2:l:3:f:7:cf:2\\ncell:C28:b::1:1:1:f:1:cf:2:colspan:3\\ncell:D28:b::1:1:1:l:3:f:7:cf:2:colspan:2\\ncell:E28:b:::2::l:3:f:7:cf:2\\ncell:F28:b::1:1::f:1:ntvf:1\\ncell:G28:b::1:1::f:1:ntvf:1\\ncell:H28:vtf:t::IF(F28*G28>0,F28*G28,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I28:b::2::2:l:3:f:7\\ncell:A29:b::2:::l:3:f:3\\ncell:B29:b::2::2:l:3:f:3\\ncell:C29:t:TOTAL:b:1:1:1:1:l:3:f:5:cf:2:colspan:5\\ncell:D29:b:2::2::l:3:f:8:cf:2\\ncell:E29:b:2:2:2::l:3:f:8:cf:2\\ncell:F29:vtf:n:0:SUM(F16\\\\cF28):b:2:2:2::l:3:f:4:ntvf:2\\ncell:G29:b:2:2:2::l:3:f:4:ntvf:2\\ncell:H29:vtf:n:0:SUM(H16\\\\cH28):b:1:1:1::f:5:ntvf:1\\ncell:I29:b::2::2:l:3:f:4\\ncell:A30:b::2:::l:3:f:7\\ncell:B30:b::::2:l:3:f:3:cf:2\\ncell:C30:b:2::::l:1:f:7\\ncell:D30:b:2::::l:1:f:7\\ncell:E30:b:2::::l:1:f:7\\ncell:F30:b:2::::l:1:f:7\\ncell:G30:b:2::::l:1:f:7\\ncell:H30:b:2::::l:1:f:7\\ncell:I30:b::2:::l:3:f:3\\ncell:A31:b::2:::l:3:f:7\\ncell:B31:b::::2:l:3:f:7\\ncell:D31:tvf:5:rowspan:4\\ncell:I31:b::2:::l:3:f:7\\ncell:A32:b::2:::l:3:f:7\\ncell:B32:b::::2:l:3:f:7\\ncell:I32:b::2:::l:3:f:7\\ncell:A33:b::2:::l:3:f:7\\ncell:B33:b::::2:l:3:f:7\\ncell:I33:b::2:::l:3:f:7\\ncell:A34:b::2:::l:3:f:7\\ncell:B34:b::::2:l:3:f:7\\ncell:I34:b::2:::l:3:f:7\\ncell:A35:b::2:::l:3:f:7\\ncell:B35:b:::2:2:l:3:f:7\\ncell:C35:b:::2::l:3:f:7\\ncell:D35:b:::2::l:3:f:7\\ncell:E35:b:::2::l:3:f:7\\ncell:F35:b:::2::l:3:f:7\\ncell:G35:b:::2::l:3:f:7\\ncell:H35:b:::2::l:3:f:7\\ncell:I35:b::2:2::l:3:f:7\\ncell:B36:b:1:::\\ncell:C36:b:1:::\\ncell:D36:b:1:::\\ncell:E36:b:1:::\\ncell:F36:b:1:::\\ncell:G36:b:1:::\\ncell:H36:b:1:::\\ncell:I36:b:1:::\\ncol:A:w:26\\ncol:B:w:28\\ncol:C:w:96\\ncol:D:w:203\\ncol:E:w:51\\ncol:F:w:50\\ncol:G:w:58\\ncol:H:w:80\\ncol:I:w:28\\nrow:1:h:14.25\\nrow:2:h:18.75\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:15.75\\nrow:6:h:15.75\\nrow:7:h:15.75\\nrow:8:h:15.75\\nrow:9:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:13:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:16:h:14.25\\nrow:17:h:14.25\\nrow:18:h:14.25\\nrow:19:h:14.25\\nrow:20:h:14.25\\nrow:21:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nrow:24:h:14.25\\nrow:25:h:14.25\\nrow:26:h:14.25\\nrow:27:h:14.25\\nrow:28:h:15.75\\nrow:29:h:15.75\\nrow:30:h:14.25\\nrow:31:h:14.25\\nrow:32:h:14.25\\nrow:33:h:14.25\\nrow:34:h:14.25\\nrow:35:h:14.25\\nsheet:c:9:r:36:h:12.75\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\nfont:1:* * Trebuchet MS\\nfont:2:normal bold * Trebuchet MS\\nfont:3:normal bold 10pt Arial\\nfont:4:normal bold 12pt Arial\\nfont:5:normal bold 12pt Trebuchet MS\\nfont:6:normal bold 14pt Trebuchet MS\\nfont:7:normal normal 10pt Arial\\nfont:8:normal normal 12pt Arial\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nlayout:3:padding:* * * *;vertical-align:top;\\nvalueformat:1:#,##0.00\\nvalueformat:2:#,##0.00;(#,##0.00)\\nvalueformat:3:d-mmm\\nvalueformat:4:m/d/yy\\nvalueformat:5:text-html\\n\" }, \"name\": \"typeii\", \"hidden\": \"0\" }, \"sheet3\": { \"sheetstr\": { \"savestr\": \"version:1.5\\ncell:A1:l:3\\ncell:B2:t:[Company Name]:l:1:f:3:cf:2:colspan:3\\ncell:C2:t::l:2:f:9\\ncell:D2:t::l:2:f:9\\ncell:E2:l:1:f:7:c:2:cf:3\\ncell:F2:t:INVOICE:l:1:f:7:c:2:cf:2:colspan:2\\ncell:G2:t::l:2:f:9\\ncell:B3:t:[Company Slogan]:f:4:cf:2:colspan:3\\ncell:C3:t::l:2:f:9\\ncell:D3:t::l:2:f:9\\ncell:B4:f:2:colspan:2\\ncell:F4:tvf:4:rowspan:4\\ncell:B5:t:[Street Address]:f:1:cf:2:colspan:2\\ncell:F5:l:1:f:6\\ncell:G5:l:1:f:10:cf:1\\ncell:B6:t:[City, State,  Zip]:f:1:cf:2:colspan:2\\ncell:G6:l:1:f:9\\ncell:B7:t:Phone\\\\c :f:1:cf:2:colspan:2\\ncell:B8:t:Email\\\\c:f:1:cf:2:colspan:2\\ncell:B9:colspan:2\\ncell:F9:t:DATE \\\\c:l:1:f:6:cf:2\\ncell:G9:l:1:f:10:cf:2:ntvf:3\\ncell:B10:t:BILL TO\\\\c:f:5:c:1:bg:3:cf:2:colspan:2\\ncell:F10:t:INVOICE # \\\\c:l:1:f:6:cf:2\\ncell:G10:v:1:l:1:f:10:cf:2\\ncell:B11:t:[Name]:f:1:cf:2:colspan:2\\ncell:B12:t:[Company Name]:f:1:cf:2:colspan:2\\ncell:F12:t:  \\ncell:B13:t:[Street Address]:f:1:cf:2:colspan:2\\ncell:B14:t:[City, State,  Zip]:f:1:cf:2:colspan:2\\ncell:B15:t:Phone\\\\c :f:1:cf:2:colspan:2\\ncell:A17:b::1::\\ncell:B17:t:DESCRIPTION:b:1:1:1:1:l:1:f:6:c:1:bg:3:cf:1:colspan:5:rowspan:1\\ncell:C17:t::l:2:f:9\\ncell:D17:t::l:2:f:9\\ncell:E17:t::l:2:f:9\\ncell:F17:t::l:2:f:9\\ncell:G17:t:AMOUNT:b:1:1:1::l:1:f:6:c:1:bg:3:cf:1\\ncell:A18:b::1::\\ncell:B18:b:1:1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C18:t::l:2:f:9\\ncell:D18:t::l:2:f:9\\ncell:E18:t::l:2:f:9\\ncell:F18:t::b::2:::l:1:f:9\\ncell:G18:b::1::1:f:1:ntvf:1\\ncell:A19:b::1::\\ncell:B19:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C19:t::l:2:f:9\\ncell:D19:t::l:2:f:9\\ncell:E19:t::l:2:f:9\\ncell:F19:t::b::2:::l:1:f:9\\ncell:G19:b::1::1:f:1:ntvf:1\\ncell:A20:b::1::\\ncell:B20:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C20:t::l:2:f:9\\ncell:D20:t::l:2:f:9\\ncell:E20:t::l:2:f:9\\ncell:F20:t::b::2:::l:1:f:9\\ncell:G20:b::1::1:f:1:ntvf:1\\ncell:A21:b::1::\\ncell:B21:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C21:t::l:2:f:9\\ncell:D21:t::l:2:f:9\\ncell:E21:t::l:2:f:9\\ncell:F21:t::b::2:::l:1:f:9\\ncell:G21:b::1::1:f:1:ntvf:1\\ncell:A22:b::1::\\ncell:B22:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C22:t::l:2:f:9\\ncell:D22:t::l:2:f:9\\ncell:E22:t::l:2:f:9\\ncell:F22:t::b::2:::l:1:f:9\\ncell:G22:b::1::1:f:1:ntvf:1\\ncell:A23:b::1::\\ncell:B23:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C23:t::l:2:f:9\\ncell:D23:t::l:2:f:9\\ncell:E23:t::l:2:f:9\\ncell:F23:t::b::2:::l:1:f:9\\ncell:G23:b::1::1:f:1:ntvf:1\\ncell:A24:b::1::\\ncell:B24:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C24:t::l:2:f:9\\ncell:D24:t::l:2:f:9\\ncell:E24:t::l:2:f:9\\ncell:F24:t::b::2:::l:1:f:9\\ncell:G24:b::1::1:f:1:ntvf:1\\ncell:A25:b::1::\\ncell:B25:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C25:t::l:2:f:9\\ncell:D25:t::l:2:f:9\\ncell:E25:t::l:2:f:9\\ncell:F25:t::b::2:::l:1:f:9\\ncell:G25:b::1::1:f:1:ntvf:1\\ncell:A26:b::1::\\ncell:B26:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C26:t::l:2:f:9\\ncell:D26:t::l:2:f:9\\ncell:E26:t::l:2:f:9\\ncell:F26:t::b::2:::l:1:f:9\\ncell:G26:b::1::1:f:1:ntvf:1\\ncell:A27:b::1::\\ncell:B27:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C27:t::l:2:f:9\\ncell:D27:t::l:2:f:9\\ncell:E27:t::l:2:f:9\\ncell:F27:t::b::2:::l:1:f:9\\ncell:G27:b::1::1:f:1:ntvf:1\\ncell:A28:b::1::\\ncell:B28:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C28:t::l:2:f:9\\ncell:D28:t::l:2:f:9\\ncell:E28:t::l:2:f:9\\ncell:F28:t::b::2:::l:1:f:9\\ncell:G28:b::1::1:f:1:ntvf:1\\ncell:A29:b::1::\\ncell:B29:b::1:1:1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C29:t::b:::2::l:1:f:9\\ncell:D29:t::b:::2::l:1:f:9\\ncell:E29:t::b:::2::l:1:f:9\\ncell:F29:t::b::2:2::l:1:f:9\\ncell:G29:b::1:1:1:f:1:ntvf:1\\ncell:B30:b:2::::l:1:f:9\\ncell:C30:b:2::::l:1:f:9\\ncell:D30:b:2::::l:1:f:9\\ncell:E30:b:2::::l:1:f:10\\ncell:F30:t:Subtotal:b:2::::l:1:f:10\\ncell:G30:vtf:n:0:SUM(G18\\\\cG29):b:1::::f:8:ntvf:1\\ncell:B31:t:NOTES:b:::2::l:1:f:6:cf:2:colspan:3:rowspan:1\\ncell:C31:t::b:::2::l:1:f:9\\ncell:D31:t::b:::2::l:1:f:9\\ncell:F31:t:Tax Rate:l:1:f:1\\ncell:G31:v:0:f:1:ntvf:2\\ncell:B32:b:1::::f:1:cf:2:colspan:3\\ncell:C32:t::b:2::::l:1:f:9\\ncell:D32:t::b:2::::l:1:f:9\\ncell:F32:t:Tax:l:1:f:1\\ncell:G32:vtf:n:0:G31*G30:f:1:ntvf:1\\ncell:B33:f:1:cf:2:colspan:3\\ncell:C33:t::l:2:f:9\\ncell:D33:t::l:2:f:9\\ncell:F33:t:Other:b:::1::l:1:f:1\\ncell:G33:v:0:b:::1::f:1:ntvf:1\\ncell:B34:b:::1::f:1:cf:2:colspan:3:rowspan:1\\ncell:C34:t::l:2:f:9\\ncell:D34:t::l:2:f:9\\ncell:F34:t:TOTAL:b:2::::l:1:f:6\\ncell:G34:vtf:n:0:(G30+G32)+G33:b:1::::f:5:ntvf:1\\ncell:C36:tvf:4:colspan:5:rowspan:7\\ncol:A:w:40\\ncol:B:w:232\\ncol:C:w:53\\ncol:D:w:90\\ncol:E:w:54\\ncol:F:w:91\\ncol:G:w:99\\nrow:1:h:34.5\\nrow:2:h:34.5\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:14.25\\nrow:6:h:14.25\\nrow:7:h:14.25\\nrow:8:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:13:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:17:h:14.25\\nrow:18:h:14.25\\nrow:19:h:14.25\\nrow:20:h:14.25\\nrow:21:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nrow:24:h:14.25\\nrow:25:h:14.25\\nrow:26:h:14.25\\nrow:27:h:14.25\\nrow:28:h:14.25\\nrow:29:h:14.25\\nrow:30:h:14.25\\nrow:31:h:14.25\\nrow:32:h:14.25\\nrow:33:h:14.25\\nrow:34:h:14.25\\nsheet:c:7:r:36:h:12.75:needsrecalc:yes\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\ncellformat:3:right\\ncolor:1:rgb(0, 0, 0)\\ncolor:2:rgb(0,0,0)\\ncolor:3:rgb(221, 221, 221)\\nfont:1:* * Trebuchet MS\\nfont:2:* 10pt *\\nfont:3:* 16pt Trebuchet MS\\nfont:4:italic normal * Trebuchet MS\\nfont:5:normal bold * Trebuchet MS\\nfont:6:normal bold 10pt Trebuchet MS\\nfont:7:normal bold 28pt Trebuchet MS\\nfont:8:normal normal * Trebuchet MS\\nfont:9:normal normal 10pt Arial\\nfont:10:normal normal 10pt Trebuchet MS\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nlayout:3:padding:36px * 28px *;vertical-align:*;\\nvalueformat:1:#,##0.00\\nvalueformat:2:#,##0.00%\\nvalueformat:3:m/d/yy\\nvalueformat:4:text-html\\n\" }, \"name\": \"typeiii\", \"hidden\": \"0\" }, \"sheet4\": { \"sheetstr\": { \"savestr\": \"version:1.5\\ncell:A1:l:3\\ncell:B2:t:[Company Name]:l:1:f:2:cf:2:colspan:3:rowspan:1\\ncell:C2:t::l:2:f:7\\ncell:D2:t::l:2:f:7\\ncell:F2:t:INVOICE:l:1:f:6:c:1:cf:2:colspan:2\\ncell:G2:t::l:2:f:7\\ncell:B3:t:[Company slogan]:f:3:cf:2:colspan:3:rowspan:1\\ncell:C3:t::l:2:f:7\\ncell:D3:t::l:2:f:7\\ncell:B4:cf:2:colspan:3:rowspan:1\\ncell:F4:tvf:4:rowspan:4\\ncell:B5:t:[Street Address]:f:1:cf:2:colspan:3:rowspan:1\\ncell:F5:l:1:f:5\\ncell:G5:l:1:f:8:cf:1\\ncell:B6:t:[City, State,  Zip]:f:1:cf:2:colspan:3:rowspan:1\\ncell:G6:l:1:f:7\\ncell:B7:t:Phone\\\\c :f:1:cf:2:colspan:3:rowspan:1\\ncell:B8:t:Email\\\\c:f:1:cf:2:colspan:3:rowspan:1\\ncell:B9:cf:2:colspan:3:rowspan:1\\ncell:B10:t:BILL TO\\\\c:l:1:f:5:bg:2:cf:2:colspan:2\\ncell:F10:t:DATE\\\\c:l:1:f:5:cf:2\\ncell:G10:l:1:f:8:cf:2:ntvf:3\\ncell:B11:t:[Name]:f:1:cf:2:colspan:3:rowspan:1\\ncell:F11:t:INVOICE # \\\\c:l:1:f:5:cf:2\\ncell:G11:v:1:l:1:f:8:cf:2\\ncell:B12:t:[Company Name]:f:1:cf:2:colspan:3:rowspan:1\\ncell:J12:tvf:4\\ncell:B13:t:[Street Address]:f:1:cf:2:colspan:3:rowspan:1\\ncell:B14:t:[City, State,  Zip]:f:1:cf:2:colspan:3:rowspan:1\\ncell:B15:t:Phone\\\\c :f:1:cf:2:colspan:3:rowspan:1\\ncell:B16:cf:2:colspan:3:rowspan:1\\ncell:A17:b::1::\\ncell:B17:t:DESCRIPTION:b:1:1:1:1:l:1:f:5:bg:2:cf:1:colspan:3:rowspan:1\\ncell:C17:t::b:1::1::l:1:f:7:bg:2\\ncell:D17:t::b:1::1::l:1:f:7:bg:2\\ncell:E17:t:HOURS:b:1:1:1::l:1:f:5:bg:2:cf:1\\ncell:F17:t:RATE:b:1:1:1::l:1:f:5:bg:2:cf:1\\ncell:G17:t:AMOUNT:b:1:1:1::l:1:f:5:bg:2:cf:1\\ncell:A18:b::1::\\ncell:B18:b:1:1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C18:t::b:2::::l:1:f:7\\ncell:D18:t::b:2:2:::l:1:f:7\\ncell:E18:b:1:1::1:f:1:ntvf:1\\ncell:F18:b:1:1::1:f:1:ntvf:1\\ncell:G18:vtf:t::IF(E18*F18>0,E18*F18,\\\"\\\"):b:1:1:::f:1:ntvf:1\\ncell:A19:b::1::\\ncell:B19:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C19:t::l:2:f:7\\ncell:D19:t::b::2:::l:1:f:7\\ncell:E19:b::1::1:f:1:ntvf:1\\ncell:F19:b::1::1:f:1:ntvf:1\\ncell:G19:vtf:t::IF(E19*F19>0,E19*F19,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A20:b::1::\\ncell:B20:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C20:t::l:2:f:7\\ncell:D20:t::b::2:::l:1:f:7\\ncell:E20:b::1::1:f:1:ntvf:1\\ncell:F20:b::1::1:f:1:ntvf:1\\ncell:G20:vtf:t::IF(E20*F20>0,E20*F20,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A21:b::1::\\ncell:B21:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C21:t::l:2:f:7\\ncell:D21:t::b::2:::l:1:f:7\\ncell:E21:b::1::1:f:1:ntvf:1\\ncell:F21:b::1::1:f:1:ntvf:1\\ncell:G21:vtf:t::IF(E21*F21>0,E21*F21,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A22:b::1::\\ncell:B22:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C22:t::l:2:f:7\\ncell:D22:t::b::2:::l:1:f:7\\ncell:E22:b::1::1:f:1:ntvf:1\\ncell:F22:b::1::1:f:1:ntvf:1\\ncell:G22:vtf:t::IF(E22*F22>0,E22*F22,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A23:b::1::\\ncell:B23:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C23:t::l:2:f:7\\ncell:D23:t::b::2:::l:1:f:7\\ncell:E23:b::1::1:f:1:ntvf:1\\ncell:F23:b::1::1:f:1:ntvf:1\\ncell:G23:vtf:t::IF(E23*F23>0,E23*F23,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A24:b::1::\\ncell:B24:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C24:t::l:2:f:7\\ncell:D24:t::b::2:::l:1:f:7\\ncell:E24:b::1::1:f:1:ntvf:1\\ncell:F24:b::1::1:f:1:ntvf:1\\ncell:G24:vtf:t::IF(E24*F24>0,E24*F24,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A25:b::1::\\ncell:B25:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C25:t::l:2:f:7\\ncell:D25:t::b::2:::l:1:f:7\\ncell:E25:b::1::1:f:1:ntvf:1\\ncell:F25:b::1::1:f:1:ntvf:1\\ncell:G25:vtf:t::IF(E25*F25>0,E25*F25,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A26:b::1::\\ncell:B26:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C26:t::l:2:f:7\\ncell:D26:t::b::2:::l:1:f:7\\ncell:E26:b::1::1:f:1:ntvf:1\\ncell:F26:b::1::1:f:1:ntvf:1\\ncell:G26:vtf:t::IF(E26*F26>0,E26*F26,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A27:b::1::\\ncell:B27:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C27:t::l:2:f:7\\ncell:D27:t::b::2:::l:1:f:7\\ncell:E27:b::1::1:f:1:ntvf:1\\ncell:F27:b::1::1:f:1:ntvf:1\\ncell:G27:vtf:t::IF(E27*F27>0,E27*F27,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A28:b::1::\\ncell:B28:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C28:t::l:2:f:7\\ncell:D28:t::b::2:::l:1:f:7\\ncell:E28:b::1::1:f:1:ntvf:1\\ncell:F28:b::1::1:f:1:ntvf:1\\ncell:G28:vtf:t::IF(E28*F28>0,E28*F28,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A29:b::1::\\ncell:B29:b::1:1:1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C29:t::b:::2::l:1:f:7\\ncell:D29:t::b::2:2::l:1:f:7\\ncell:E29:b::1:1:1:f:1:ntvf:1\\ncell:F29:b::1:1:1:f:1:ntvf:1\\ncell:G29:vtf:t::IF(E29*F29>0,E29*F29,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:B30:b:2::::l:1:f:8:cf:1:colspan:3:rowspan:1\\ncell:C30:t::b:2::::l:1:f:7\\ncell:D30:t::b:2::::l:1:f:7\\ncell:E30:b:2::::l:1:f:8\\ncell:F30:t:Subtotal:b:1::::f:1\\ncell:G30:vtf:n:0:SUM(G18\\\\cG29):b:1::::f:1:ntvf:1\\ncell:B31:t:NOTES:b:::2::l:1:f:5:cf:2:colspan:3:rowspan:1\\ncell:C31:t::b:::2::l:1:f:7\\ncell:D31:t::b:::2::l:1:f:7\\ncell:F31:t:Tax Rate:f:1\\ncell:G31:v:0:f:1:ntvf:2\\ncell:B32:b:1::::f:1:cf:2:colspan:3:rowspan:1\\ncell:C32:t::b:2::::l:1:f:7\\ncell:D32:t::b:2::::l:1:f:7\\ncell:F32:t:Tax:f:1\\ncell:G32:vtf:n:0:G31*G30:f:1:ntvf:1\\ncell:B33:f:1:cf:2:colspan:3:rowspan:1\\ncell:C33:t::l:2:f:7\\ncell:D33:t::l:2:f:7\\ncell:F33:t:Other:b:::1::l:1:f:1\\ncell:G33:v:0:b:::1::f:1:ntvf:1\\ncell:B34:f:1:cf:2:colspan:3:rowspan:1\\ncell:C34:t::l:2:f:7\\ncell:D34:t::l:2:f:7\\ncell:F34:t:TOTAL:b:1::::l:1:f:4\\ncell:G34:vtf:n:0:(G30+G32)+G33:b:1::::f:4:ntvf:1\\ncell:B35:b:2::::l:1:f:7\\ncell:C35:b:2::::l:1:f:7\\ncell:D35:b:2::::l:1:f:7\\ncell:C36:tvf:4:colspan:5:rowspan:7\\ncol:A:w:40\\ncol:B:w:194\\ncol:C:w:128\\ncol:D:w:60\\ncol:E:w:65\\ncol:F:w:95\\ncol:G:w:90\\nrow:1:h:34.5\\nrow:2:h:34.5\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:14.25\\nrow:6:h:14.25\\nrow:7:h:14.25\\nrow:8:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:13:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:17:h:14.25\\nrow:18:h:14.25\\nrow:19:h:14.25\\nrow:20:h:14.25\\nrow:21:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nrow:24:h:14.25\\nrow:25:h:14.25\\nrow:26:h:14.25\\nrow:27:h:14.25\\nrow:28:h:14.25\\nrow:29:h:14.25\\nrow:30:h:14.25\\nrow:31:h:14.25\\nrow:32:h:14.25\\nrow:33:h:14.25\\nrow:34:h:14.25\\nrow:35:h:14.25\\nsheet:c:10:r:36:h:12.75:needsrecalc:yes\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\ncolor:1:rgb(0,0,0)\\ncolor:2:rgb(221, 221, 221)\\nfont:1:* * Trebuchet MS\\nfont:2:* 16pt Trebuchet MS\\nfont:3:italic normal * Trebuchet MS\\nfont:4:normal bold * Trebuchet MS\\nfont:5:normal bold 10pt Trebuchet MS\\nfont:6:normal bold 28pt Trebuchet MS\\nfont:7:normal normal 10pt Arial\\nfont:8:normal normal 10pt Trebuchet MS\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nlayout:3:padding:36px * 28px *;vertical-align:*;\\nvalueformat:1:#,##0.00\\nvalueformat:2:#,##0.00%\\nvalueformat:3:m/d/yy\\nvalueformat:4:text-html\\n\" }, \"name\": \"typeiv\", \"hidden\": \"0\" } }, \"EditableCells\": { \"allow\": true, \"cells\": { \"typei!C10\": true, \"typei!B2\": true, \"typei!C11\": true, \"typei!C12\": true, \"typei!C13\": true, \"typei!D9\": true, \"typei!D4\": true, \"typei!D6\": true, \"typei!E10\": true, \"typei!E11\": true, \"typei!E12\": true, \"typei!E13\": true, \"typei!F9\": true, \"typei!C16\": true, \"typei!C17\": true, \"typei!C18\": true, \"typei!C19\": true, \"typei!C20\": true, \"typei!C21\": true, \"typei!C22\": true, \"typei!C23\": true, \"typei!C24\": true, \"typei!C25\": true, \"typei!C26\": true, \"typei!C27\": true, \"typei!C28\": true, \"typei!F16\": true, \"typei!F17\": true, \"typei!F18\": true, \"typei!F19\": true, \"typei!F20\": true, \"typei!F21\": true, \"typei!F22\": true, \"typei!F23\": true, \"typei!F24\": true, \"typei!F25\": true, \"typei!F26\": true, \"typei!F27\": true, \"typei!F28\": true, \"typei!E35\": true, \"typeii!B2\": true, \"typeii!D4\": true, \"typeii!C10\": true, \"typeii!C11\": true, \"typeii!C12\": true, \"typeii!C13\": true, \"typeii!D9\": true, \"typeii!E10\": true, \"typeii!E11\": true, \"typeii!E12\": true, \"typeii!E13\": true, \"typeii!F9\": true, \"typeii!C16\": true, \"typeii!C17\": true, \"typeii!C18\": true, \"typeii!C19\": true, \"typeii!C20\": true, \"typeii!C21\": true, \"typeii!C22\": true, \"typeii!C23\": true, \"typeii!C24\": true, \"typeii!C25\": true, \"typeii!C26\": true, \"typeii!C27\": true, \"typeii!C28\": true, \"typeii!F16\": true, \"typeii!F17\": true, \"typeii!F18\": true, \"typeii!F19\": true, \"typeii!F20\": true, \"typeii!F21\": true, \"typeii!F22\": true, \"typeii!F23\": true, \"typeii!F24\": true, \"typeii!F25\": true, \"typeii!F26\": true, \"typeii!F27\": true, \"typeii!F28\": true, \"typeii!G16\": true, \"typeii!G17\": true, \"typeii!G18\": true, \"typeii!G19\": true, \"typeii!G20\": true, \"typeii!G21\": true, \"typeii!G22\": true, \"typeii!G23\": true, \"typeii!G24\": true, \"typeii!G25\": true, \"typeii!G26\": true, \"typeii!G27\": true, \"typeii!G28\": true, \"typeii!E35\": true, \"typeiii!G9\": true, \"typeiii!G10\": true, \"typeiii!B2\": true, \"typeiii!B3\": true, \"typeiii!B4\": true, \"typeiii!B5\": true, \"typeiii!B6\": true, \"typeiii!B7\": true, \"typeiii!B8\": true, \"typeiii!B9\": true, \"typeiii!B11\": true, \"typeiii!B12\": true, \"typeiii!B13\": true, \"typeiii!B14\": true, \"typeiii!B15\": true, \"typeiii!B18\": true, \"typeiii!B19\": true, \"typeiii!B20\": true, \"typeiii!B21\": true, \"typeiii!B22\": true, \"typeiii!B23\": true, \"typeiii!B24\": true, \"typeiii!B25\": true, \"typeiii!B26\": true, \"typeiii!B27\": true, \"typeiii!B28\": true, \"typeiii!B29\": true, \"typeiii!G18\": true, \"typeiii!G19\": true, \"typeiii!G20\": true, \"typeiii!G21\": true, \"typeiii!G22\": true, \"typeiii!G23\": true, \"typeiii!G24\": true, \"typeiii!G25\": true, \"typeiii!G26\": true, \"typeiii!G27\": true, \"typeiii!G28\": true, \"typeiii!G29\": true, \"typeiii!B32\": true, \"typeiii!B33\": true, \"typeiii!B34\": true, \"typeiii!G31\": true, \"typeiii!G33\": true, \"typeiii!B37\": true, \"typeiv!G9\": true, \"typeiv!G10\": true, \"typeiv!B2\": true, \"typeiv!B3\": true, \"typeiv!B4\": true, \"typeiv!B5\": true, \"typeiv!B6\": true, \"typeiv!B7\": true, \"typeiv!B8\": true, \"typeiv!B11\": true, \"typeiv!B12\": true, \"typeiv!B13\": true, \"typeiv!B14\": true, \"typeiv!B15\": true, \"typeiv!B16\": true, \"typeiv!B18\": true, \"typeiv!B19\": true, \"typeiv!B20\": true, \"typeiv!B21\": true, \"typeiv!B22\": true, \"typeiv!B23\": true, \"typeiv!B24\": true, \"typeiv!B25\": true, \"typeiv!B26\": true, \"typeiv!B27\": true, \"typeiv!B28\": true, \"typeiv!B29\": true, \"typeiv!E18\": true, \"typeiv!E19\": true, \"typeiv!E20\": true, \"typeiv!E21\": true, \"typeiv!E22\": true, \"typeiv!E23\": true, \"typeiv!E24\": true, \"typeiv!E25\": true, \"typeiv!E26\": true, \"typeiv!E27\": true, \"typeiv!E28\": true, \"typeiv!E29\": true, \"typeiv!F18\": true, \"typeiv!F19\": true, \"typeiv!F2\": true, \"typeiv!F20\": true, \"typeiv!F21\": true, \"typeiv!F22\": true, \"typeiv!F23\": true, \"typeiv!F24\": true, \"typeiv!F25\": true, \"typeiv!F26\": true, \"typeiv!F27\": true, \"typeiv!F28\": true, \"typeiv!F29\": true, \"typeiv!B32\": true, \"typeiv!B33\": true, \"typeiv!B34\": true, \"typeiv!G31\": true, \"typeiv!G33\": true, \"typeiv!B37\": true, \"typeii!F15\": true, \"typeii!G15\": true, \"typeiv!E17\": true, \"typeiv!F17\": true, \"typeii!D6\": true, \"typeiv!G11\": true, \"typei!C4\": true, \"typeii!C4\": true, \"typeiii!F10\": true, \"typeiv!F11\": true, \"typeiv!F10\": true, \"typeiii!F9\": true, \"typeii!C6\": true, \"typei!C6\": true, \"typei!F4\": true, \"typeii!F4\": true, \"typeiii!F4\": true, \"typeiii!F2\": true, \"typeiv!F4\": true, \"typei!F29\": true, \"typeii!H29\": true, \"typeiii!G30\": true, \"typeiii!G34\": true, \"typeiv!G30\": true, \"typeiv!G34\": true }, \"constraints\": {} } },\n\t                                                \"footers\": [{ name: 'Invoice 1', index: 1, isActive: true }, { name: 'Invoice 2', index: 2, isActive: false }, { name: 'Company Invoice 1', index: 3, isActive: false }, { name: 'Company Invoice 2', index: 4, isActive: false }]\n\t                                },\n\t                                \"default\": {\n\t                                                \"msc\": { \"numsheets\": 4, \"currentid\": \"sheet1\", \"currentname\": \"typei\", \"sheetArr\": { \"sheet1\": { \"sheetstr\": { \"savestr\": \"version:1.5\\ncell:A2:b::2:::l:1:f:7\\ncell:B2:t:INVOICE:b:1:1:1:1:f:6:cf:1:colspan:6\\ncell:C2:t::b:2::2::l:1:f:7\\ncell:D2:t::b:2::2::l:1:f:7\\ncell:E2:t::b:2::2::l:1:f:7\\ncell:F2:t::b:2::2::l:1:f:7\\ncell:G2:t::b:2::2::l:1:f:7\\ncell:A3:b::2:::l:3:f:7\\ncell:B3:b:2:::2:l:3:f:7\\ncell:C3:b:2::::l:1:f:7\\ncell:D3:b:2::::l:1:f:7\\ncell:E3:b:2::::l:1:f:7\\ncell:F3:b:2::::l:1:f:7\\ncell:G3:b:2:2:::l:3:f:7\\ncell:A4:b::2:::l:3:f:7\\ncell:B4:b::::2:l:3:f:3\\ncell:C4:t:INVOICE # \\\\c:f:2:cf:2\\ncell:D4:v:1:f:2:cf:2\\ncell:F4:tvf:4:rowspan:4\\ncell:G4:b::2:::l:3:f:7\\ncell:A5:b::2:::l:3:f:7\\ncell:B5:b::::2:l:3:f:4\\ncell:F5:t::l:2:f:7\\ncell:G5:t::b::1:::l:2:f:7\\ncell:A6:b::2:::l:3:f:7\\ncell:B6:b::::2:l:3:f:4\\ncell:C6:t:INVOICE DATE\\\\c:f:2:cf:2\\ncell:D6:f:2:cf:2:ntvf:3\\ncell:F6:l:2:f:7\\ncell:G6:b::1:::l:2:f:7\\ncell:A7:b::2:::l:3:f:7\\ncell:B7:b::::2:l:3:f:4\\ncell:G7:b::2:::l:3:f:7\\ncell:A8:b::2:::l:3:f:7\\ncell:B8:b::::2:l:3:f:4\\ncell:G8:b::2:::l:3:f:7\\ncell:A9:b::2:::l:3:f:7\\ncell:B9:b::::2:l:3:f:4\\ncell:C9:t:BILL TO\\\\c:l:3:f:2\\ncell:E9:t:FROM\\\\c:f:2:cf:2\\ncell:G9:b::2:::l:3:f:7\\ncell:A10:b::2:::l:3:f:7\\ncell:B10:b::::2:l:3:f:3\\ncell:C10:t:[Name]:f:1:cf:2:colspan:2\\ncell:E10:t:[Name]:f:1:cf:2:colspan:2\\ncell:G10:b::2:::l:3:f:7\\ncell:A11:b::2:::l:3:f:7\\ncell:B11:b::::2:l:3:f:7\\ncell:C11:t:[Street Address]:f:1:cf:2:colspan:2\\ncell:E11:t:[Street Address]:f:1:cf:2:colspan:2\\ncell:G11:b::2:::l:3:f:7\\ncell:A12:b::2:::l:3:f:7\\ncell:B12:b::::2:l:3:f:7\\ncell:C12:t:[City, State, Zip]:f:1:cf:2:colspan:2\\ncell:E12:t:[City, State, Zip]:f:1:cf:2:colspan:2\\ncell:G12:b::2:::l:3:f:7\\ncell:A13:b::2:::l:3:f:7\\ncell:B13:b::::2:l:3:f:7\\ncell:C13:t:Phone\\\\c:f:1:cf:2:colspan:2\\ncell:E13:t:Phone\\\\c:f:1:cf:2:colspan:2\\ncell:G13:b::2:::l:3:f:7\\ncell:A14:b::2:::l:3:f:7\\ncell:B14:b::::2:l:3:f:3:cf:2\\ncell:C14:b:::2::l:1:f:7\\ncell:D14:b:::2::l:3:f:3:cf:2\\ncell:E14:b:::2::l:1:f:7\\ncell:F14:b:::2::l:1:f:7\\ncell:G14:b::2:::l:3:f:7\\ncell:A15:b::2:::l:3:f:7\\ncell:B15:b::2::2:l:3:f:7\\ncell:C15:t:Description:b:1::1:1:f:2:cf:1:colspan:3\\ncell:D15:t:Description:b:1::1::l:3:f:3:cf:2:colspan:2:rowspan:1\\ncell:E15:t::b:2:2:2::l:1:f:7\\ncell:F15:t:Amount:b:1:1:1:1:f:2:cf:1\\ncell:G15:b::2::2:l:3:f:7\\ncell:A16:b::2:::l:3:f:7\\ncell:B16:b::2::2:l:3:f:7\\ncell:C16:b:1:1::1:f:1:cf:2:colspan:3\\ncell:D16:b:1:1:::l:3:f:7:cf:2:colspan:2:rowspan:1\\ncell:E16:t::b:2:2:2::l:1:f:7\\ncell:F16:b:1:1:::f:1:ntvf:1\\ncell:G16:b::2::2:l:3:f:7\\ncell:A17:b::2:::l:3:f:7\\ncell:B17:b::2::2:l:3:f:7:cf:2\\ncell:C17:b::1::1:f:1:cf:2:colspan:3\\ncell:D17:b::1:::l:1:f:7:colspan:2\\ncell:E17:l:1:f:7\\ncell:F17:b::1:::f:1:ntvf:1\\ncell:G17:b::2::2:l:3:f:7\\ncell:A18:b::2:::l:3:f:7\\ncell:B18:b::2::2:l:3:f:7:cf:2:ntvf:2\\ncell:C18:b::1::1:f:1:cf:2:colspan:3\\ncell:D18:b::1:::colspan:2\\ncell:F18:b::1:::f:1:ntvf:1\\ncell:G18:b::2::2:l:3:f:7\\ncell:A19:b::2:::l:3:f:7\\ncell:B19:b::2::2:l:3:f:7:cf:2:ntvf:2\\ncell:C19:b::1::1:f:1:cf:2:colspan:3\\ncell:D19:b::1:::colspan:2\\ncell:F19:b::1:::f:1:ntvf:1\\ncell:G19:b::2::2:l:3:f:7\\ncell:A20:b::2:::l:3:f:7\\ncell:B20:b::2::2:l:3:f:7:cf:2:ntvf:2\\ncell:C20:b::1::1:f:1:cf:2:colspan:3\\ncell:D20:b::1:::colspan:2\\ncell:F20:b::1:::f:1:ntvf:1\\ncell:G20:b::2::2:l:3:f:7\\ncell:A21:b::2:::l:3:f:7\\ncell:B21:b::2::2:l:3:f:7:cf:2:ntvf:2\\ncell:C21:b::1::1:f:1:cf:2:colspan:3\\ncell:D21:b::1:::colspan:2\\ncell:F21:b::1:::f:1:ntvf:1\\ncell:G21:b::2::2:l:3:f:7\\ncell:A22:b::2:::l:3:f:7\\ncell:B22:b::2::2:l:3:f:7:cf:2:ntvf:2\\ncell:C22:b::1::1:f:1:cf:2:colspan:3\\ncell:D22:b::1:::colspan:2\\ncell:F22:b::1:::f:1:ntvf:1\\ncell:G22:b::2::2:l:3:f:7\\ncell:A23:b::2:::l:3:f:7\\ncell:B23:b::2::2:l:3:f:7:cf:2\\ncell:C23:b::1::1:f:1:cf:2:colspan:3\\ncell:D23:b::1:::colspan:2\\ncell:F23:b::1:::f:1:ntvf:1\\ncell:G23:b::2::2:l:3:f:7\\ncell:A24:b::2:::l:3:f:7\\ncell:B24:b::2::2:l:3:f:7:cf:2\\ncell:C24:b::1::1:f:1:cf:2:colspan:3\\ncell:D24:b::1:::colspan:2\\ncell:F24:b::1:::f:1:ntvf:1\\ncell:G24:b::2::2:l:3:f:7\\ncell:A25:b::2:::l:3:f:7\\ncell:B25:b::2::2:l:3:f:7:cf:2\\ncell:C25:b::1::1:f:1:cf:2:colspan:3\\ncell:D25:b::1:::colspan:2\\ncell:F25:b::1:::f:1:ntvf:1\\ncell:G25:b::2::2:l:3:f:7\\ncell:A26:b::2:::l:3:f:7\\ncell:B26:b::2::2:l:3:f:7:cf:2\\ncell:C26:b::1::1:f:1:cf:2:colspan:3\\ncell:D26:b::1:::colspan:2\\ncell:F26:b::1:::f:1:ntvf:1\\ncell:G26:b::2::2:l:3:f:7\\ncell:A27:b::2:::l:3:f:7\\ncell:B27:b::2::2:l:3:f:7:cf:2\\ncell:C27:b::1::1:f:1:cf:2:colspan:3\\ncell:D27:b::1:::colspan:2\\ncell:F27:b::1:::f:1:ntvf:1\\ncell:G27:b::2::2:l:3:f:7\\ncell:A28:b::2:::l:3:f:4\\ncell:B28:b::2::2:l:3:f:7:cf:2\\ncell:C28:b::1:1:1:f:1:cf:2:colspan:3\\ncell:D28:b::1:1::l:3:f:7:cf:2:colspan:2\\ncell:E28:b:::2::l:3:f:7:cf:2\\ncell:F28:b::1:1::f:1:ntvf:1\\ncell:G28:b::2::2:l:3:f:7\\ncell:A29:b::2:::l:3:f:3\\ncell:B29:b::2::2:l:3:f:3\\ncell:C29:t:TOTAL:b:1:1:1:1:f:5:cf:2:colspan:3\\ncell:D29:b:2::2::l:3:f:8:cf:2\\ncell:E29:b:2:2:2::l:3:f:8:cf:2\\ncell:F29:vtf:n:0:SUM(F16\\\\cF28):b:1:1:1::f:5:ntvf:1\\ncell:G29:b::2::2:l:3:f:4\\ncell:A30:b::2:::l:3:f:7\\ncell:B30:b::::2:l:3:f:3:cf:2\\ncell:C30:b:2::::l:1:f:7\\ncell:D30:b:2::::l:1:f:7\\ncell:E30:b:2::::l:1:f:7\\ncell:F30:b:2::::l:1:f:7\\ncell:G30:b::2:::l:3:f:3\\ncell:A31:b::2:::l:3:f:7\\ncell:B31:b::::2:l:3:f:7\\ncell:D31:tvf:4:rowspan:4\\ncell:G31:b::2:::l:3:f:7\\ncell:A32:b::2:::l:3:f:7\\ncell:B32:b::::2:l:3:f:7\\ncell:G32:b::2:::l:3:f:7\\ncell:A33:b::2:::l:3:f:7\\ncell:B33:b::::2:l:3:f:7\\ncell:G33:b::2:::l:3:f:7\\ncell:A34:b::2:::l:3:f:7\\ncell:B34:b::::2:l:3:f:7\\ncell:G34:b::2:::l:3:f:7\\ncell:A35:b::2:::l:3:f:7\\ncell:B35:b:::2:2:l:3:f:7\\ncell:C35:b:::2::l:3:f:7\\ncell:D35:b:::2::l:3:f:7\\ncell:E35:b:::2::l:3:f:7\\ncell:F35:b:::2::l:3:f:7\\ncell:G35:b::2:2::l:3:f:7\\ncell:B36:b:1:::\\ncell:C36:b:1:::\\ncell:D36:b:1:::\\ncell:E36:b:1:::\\ncell:F36:b:1:::\\ncell:G36:b:1:::\\ncol:A:w:10\\ncol:B:w:42\\ncol:C:w:105\\ncol:D:w:182\\ncol:E:w:110\\ncol:F:w:115\\ncol:G:w:65\\nrow:1:h:14.25\\nrow:2:h:18.75\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:15.75\\nrow:6:h:15.75\\nrow:7:h:15.75\\nrow:8:h:15.75\\nrow:9:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:13:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:16:h:14.25\\nrow:17:h:14.25\\nrow:18:h:14.25\\nrow:19:h:14.25\\nrow:20:h:14.25\\nrow:21:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nrow:24:h:14.25\\nrow:25:h:14.25\\nrow:26:h:14.25\\nrow:27:h:14.25\\nrow:28:h:15.75\\nrow:29:h:15.75\\nrow:30:h:14.25\\nrow:31:h:14.25\\nrow:32:h:14.25\\nrow:33:h:14.25\\nrow:34:h:14.25\\nrow:35:h:14.25\\nsheet:c:7:r:36:h:12.75\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\nfont:1:* * Trebuchet MS\\nfont:2:normal bold * Trebuchet MS\\nfont:3:normal bold 10pt Arial\\nfont:4:normal bold 12pt Arial\\nfont:5:normal bold 12pt Trebuchet MS\\nfont:6:normal bold 14pt Trebuchet MS\\nfont:7:normal normal 10pt Arial\\nfont:8:normal normal 12pt Arial\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nlayout:3:padding:* * * *;vertical-align:top;\\nvalueformat:1:#,##0.00\\nvalueformat:2:d-mmm\\nvalueformat:3:m/d/yy\\nvalueformat:4:text-html\\n\" }, \"name\": \"typei\", \"hidden\": \"0\" }, \"sheet2\": { \"sheetstr\": { \"savestr\": \"version:1.5\\ncell:A2:b::2:::l:1:f:7\\ncell:B2:t:INVOICE:b:1:1:1:1:l:3:f:6:cf:1:colspan:8\\ncell:C2:t::b:2::2::l:1:f:7\\ncell:D2:t::b:2::2::l:1:f:7\\ncell:E2:t::b:2::2::l:1:f:7\\ncell:F2:t::b:2::2::l:1:f:7\\ncell:G2:b:2::2::l:1:f:7\\ncell:H2:b:2::2::l:1:f:7\\ncell:I2:t::b:2::2::l:1:f:7\\ncell:A3:b::2:::l:3:f:7\\ncell:B3:b:2:::2:l:3:f:7\\ncell:E3:b:2::::l:1:f:7\\ncell:F3:b:2::::l:1:f:7\\ncell:G3:b:2::::l:1:f:7\\ncell:H3:b:2::::l:1:f:7\\ncell:I3:b:2:2:::l:3:f:7\\ncell:A4:b::2:::l:3:f:7\\ncell:B4:b::::2:l:3:f:3\\ncell:C4:t:INVOICE # \\\\c:f:2:cf:2\\ncell:D4:v:1:f:2:cf:2\\ncell:F4:tvf:5:colspan:2:rowspan:4\\ncell:I4:b::2:::l:3:f:7\\ncell:A5:b::2:::l:3:f:7\\ncell:B5:b::::2:l:3:f:4\\ncell:F5:t::l:2:f:7\\ncell:G5:l:2:f:7\\ncell:H5:l:2:f:7\\ncell:I5:t::b::1:::l:2:f:7\\ncell:A6:b::2:::l:3:f:7\\ncell:B6:b::::2:l:3:f:4\\ncell:C6:t:INVOICE DATE\\\\c:f:2:cf:2\\ncell:D6:f:2:cf:2:ntvf:4\\ncell:F6:l:2:f:7\\ncell:G6:l:2:f:7\\ncell:H6:l:2:f:7\\ncell:I6:b::1:::l:2:f:7\\ncell:A7:b::2:::l:3:f:7\\ncell:B7:b::::2:l:3:f:4\\ncell:I7:b::2:::l:3:f:7\\ncell:A8:b::2:::l:3:f:7\\ncell:B8:b::::2:l:3:f:4\\ncell:I8:b::2:::l:3:f:7\\ncell:A9:b::2:::l:3:f:7\\ncell:B9:b::::2:l:3:f:4\\ncell:C9:t:BILL TO\\\\c:f:2\\ncell:E9:t:FROM\\\\c:f:2:cf:2\\ncell:F9:colspan:3\\ncell:I9:b::2:::l:3:f:7\\ncell:A10:b::2:::l:3:f:7\\ncell:B10:b::::2:l:3:f:3\\ncell:C10:t:[Name]:f:1:cf:2:colspan:2\\ncell:E10:t:[Name]:f:1:cf:2:colspan:4\\ncell:I10:b::2:::l:3:f:7\\ncell:A11:b::2:::l:3:f:7\\ncell:B11:b::::2:l:3:f:7\\ncell:C11:t:[Street Address]:f:1:cf:2:colspan:2\\ncell:E11:t:[Street Address]:f:1:colspan:4\\ncell:I11:b::2:::l:3:f:7\\ncell:A12:b::2:::l:3:f:7\\ncell:B12:b::::2:l:3:f:7\\ncell:C12:t:[City, State, Zip]:f:1:cf:2:colspan:2\\ncell:E12:t:[City, State, Zip]:f:1:cf:2:colspan:4\\ncell:I12:b::2:::l:3:f:7\\ncell:A13:b::2:::l:3:f:7\\ncell:B13:b::::2:l:3:f:7\\ncell:C13:t:Phone\\\\c :f:1:cf:2:colspan:2\\ncell:E13:t:Phone\\\\c :f:1:cf:2:colspan:4\\ncell:I13:b::2:::l:3:f:7\\ncell:A14:b::2:::l:3:f:7\\ncell:B14:b::::2:l:3:f:3:cf:2\\ncell:C14:b:::2::l:1:f:7\\ncell:D14:b:::2::l:3:f:3:cf:2\\ncell:E14:b:::2::l:1:f:7\\ncell:F14:b:::2::l:1:f:7\\ncell:G14:b:::2::l:1:f:7\\ncell:H14:b:::2::l:1:f:7\\ncell:I14:b::2:::l:3:f:7\\ncell:A15:b::2:::l:3:f:7\\ncell:B15:b::2::2:l:3:f:7\\ncell:C15:t:Description:b:1:1:1:1:f:2:cf:1:colspan:3\\ncell:D15:t:Description:b:2::2:2:l:3:f:3:cf:2:colspan:2:rowspan:1\\ncell:E15:t::b:2:2:2::l:1:f:7\\ncell:F15:t:Hours:b:1:1:1:1:f:2:cf:1\\ncell:G15:t:Rate:b:1:1:1:1:f:2:cf:1\\ncell:H15:t:Amount:b:1:1:1:1:f:2:cf:1\\ncell:I15:b::2::2:l:3:f:7\\ncell:A16:b::2:::l:3:f:7\\ncell:B16:b::2::2:l:3:f:7\\ncell:C16:b:1:1::1:f:1:cf:2:colspan:3\\ncell:D16:b:1:1::1:l:3:f:7:cf:2:colspan:2:rowspan:1\\ncell:E16:t::b:2:2:2::l:1:f:7\\ncell:F16:b:1:1:::f:1:ntvf:1\\ncell:G16:b:1:1:::f:1:ntvf:1\\ncell:H16:vtf:t::IF(F16*G16>0,F16*G16,\\\"\\\"):b:1:1:::f:1:ntvf:1\\ncell:I16:b::2::2:l:3:f:7\\ncell:A17:b::2:::l:3:f:7\\ncell:B17:b::2::2:l:3:f:7:cf:2\\ncell:C17:b::1::1:f:1:cf:2:colspan:3\\ncell:D17:b::1::1:l:1:f:7:colspan:2\\ncell:E17:l:1:f:7\\ncell:F17:b::1:::f:1:ntvf:1\\ncell:G17:b::1:::f:1:ntvf:1\\ncell:H17:vtf:t::IF(F17*G17>0,F17*G17,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I17:b::2::2:l:3:f:7\\ncell:A18:b::2:::l:3:f:7\\ncell:B18:b::2::2:l:3:f:7:cf:2:ntvf:3\\ncell:C18:b::1::1:f:1:cf:2:colspan:3\\ncell:D18:b::1::1:colspan:2\\ncell:F18:b::1:::f:1:ntvf:1\\ncell:G18:b::1:::f:1:ntvf:1\\ncell:H18:vtf:t::IF(F18*G18>0,F18*G18,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I18:b::2::2:l:3:f:7\\ncell:A19:b::2:::l:3:f:7\\ncell:B19:b::2::2:l:3:f:7:cf:2:ntvf:3\\ncell:C19:b::1::1:f:1:cf:2:colspan:3\\ncell:D19:b::1::1:colspan:2\\ncell:F19:b::1:::f:1:ntvf:1\\ncell:G19:b::1:::f:1:ntvf:1\\ncell:H19:vtf:t::IF(F19*G19>0,F19*G19,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I19:b::2::2:l:3:f:7\\ncell:A20:b::2:::l:3:f:7\\ncell:B20:b::2::2:l:3:f:7:cf:2:ntvf:3\\ncell:C20:b::1::1:f:1:cf:2:colspan:3\\ncell:D20:b::1::1:colspan:2\\ncell:F20:b::1:::f:1:ntvf:1\\ncell:G20:b::1:::f:1:ntvf:1\\ncell:H20:vtf:t::IF(F20*G20>0,F20*G20,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I20:b::2::2:l:3:f:7\\ncell:A21:b::2:::l:3:f:7\\ncell:B21:b::2::2:l:3:f:7:cf:2:ntvf:3\\ncell:C21:b::1::1:f:1:cf:2:colspan:3\\ncell:D21:b::1::1:colspan:2\\ncell:F21:b::1:::f:1:ntvf:1\\ncell:G21:b::1:::f:1:ntvf:1\\ncell:H21:vtf:t::IF(F21*G21>0,F21*G21,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I21:b::2::2:l:3:f:7\\ncell:A22:b::2:::l:3:f:7\\ncell:B22:b::2::2:l:3:f:7:cf:2:ntvf:3\\ncell:C22:b::1::1:f:1:cf:2:colspan:3\\ncell:D22:b::1::1:colspan:2\\ncell:F22:b::1:::f:1:ntvf:1\\ncell:G22:b::1:::f:1:ntvf:1\\ncell:H22:vtf:t::IF(F22*G22>0,F22*G22,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I22:b::2::2:l:3:f:7\\ncell:A23:b::2:::l:3:f:7\\ncell:B23:b::2::2:l:3:f:7:cf:2\\ncell:C23:b::1::1:f:1:cf:2:colspan:3\\ncell:D23:b::1::1:colspan:2\\ncell:F23:b::1:::f:1:ntvf:1\\ncell:G23:b::1:::f:1:ntvf:1\\ncell:H23:vtf:t::IF(F23*G23>0,F23*G23,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I23:b::2::2:l:3:f:7\\ncell:A24:b::2:::l:3:f:7\\ncell:B24:b::2::2:l:3:f:7:cf:2\\ncell:C24:b::1::1:f:1:cf:2:colspan:3\\ncell:D24:b::1::1:colspan:2\\ncell:F24:b::1:::f:1:ntvf:1\\ncell:G24:b::1:::f:1:ntvf:1\\ncell:H24:vtf:t::IF(F24*G24>0,F24*G24,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I24:b::2::2:l:3:f:7\\ncell:A25:b::2:::l:3:f:7\\ncell:B25:b::2::2:l:3:f:7:cf:2\\ncell:C25:b::1::1:f:1:cf:2:colspan:3\\ncell:D25:b::1::1:colspan:2\\ncell:F25:b::1:::f:1:ntvf:1\\ncell:G25:b::1:::f:1:ntvf:1\\ncell:H25:vtf:t::IF(F25*G25>0,F25*G25,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I25:b::2::2:l:3:f:7\\ncell:A26:b::2:::l:3:f:7\\ncell:B26:b::2::2:l:3:f:7:cf:2\\ncell:C26:b::1::1:f:1:cf:2:colspan:3\\ncell:D26:b::1::1:colspan:2\\ncell:F26:b::1:::f:1:ntvf:1\\ncell:G26:b::1:::f:1:ntvf:1\\ncell:H26:vtf:t::IF(F26*G26>0,F26*G26,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I26:b::2::2:l:3:f:7\\ncell:A27:b::2:::l:3:f:7\\ncell:B27:b::2::2:l:3:f:7:cf:2\\ncell:C27:b::1::1:f:1:cf:2:colspan:3\\ncell:D27:b::1::1:colspan:2\\ncell:F27:b::1:::f:1:ntvf:1\\ncell:G27:b::1:::f:1:ntvf:1\\ncell:H27:vtf:t::IF(F27*G27>0,F27*G27,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I27:b::2::2:l:3:f:7\\ncell:A28:b::2:::l:3:f:4\\ncell:B28:b::2::2:l:3:f:7:cf:2\\ncell:C28:b::1:1:1:f:1:cf:2:colspan:3\\ncell:D28:b::1:1:1:l:3:f:7:cf:2:colspan:2\\ncell:E28:b:::2::l:3:f:7:cf:2\\ncell:F28:b::1:1::f:1:ntvf:1\\ncell:G28:b::1:1::f:1:ntvf:1\\ncell:H28:vtf:t::IF(F28*G28>0,F28*G28,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I28:b::2::2:l:3:f:7\\ncell:A29:b::2:::l:3:f:3\\ncell:B29:b::2::2:l:3:f:3\\ncell:C29:t:TOTAL:b:1:1:1:1:l:3:f:5:cf:2:colspan:5\\ncell:D29:b:2::2::l:3:f:8:cf:2\\ncell:E29:b:2:2:2::l:3:f:8:cf:2\\ncell:F29:vtf:n:0:SUM(F16\\\\cF28):b:2:2:2::l:3:f:4:ntvf:2\\ncell:G29:b:2:2:2::l:3:f:4:ntvf:2\\ncell:H29:vtf:n:0:SUM(H16\\\\cH28):b:1:1:1::f:5:ntvf:1\\ncell:I29:b::2::2:l:3:f:4\\ncell:A30:b::2:::l:3:f:7\\ncell:B30:b::::2:l:3:f:3:cf:2\\ncell:C30:b:2::::l:1:f:7\\ncell:D30:b:2::::l:1:f:7\\ncell:E30:b:2::::l:1:f:7\\ncell:F30:b:2::::l:1:f:7\\ncell:G30:b:2::::l:1:f:7\\ncell:H30:b:2::::l:1:f:7\\ncell:I30:b::2:::l:3:f:3\\ncell:A31:b::2:::l:3:f:7\\ncell:B31:b::::2:l:3:f:7\\ncell:D31:tvf:5:rowspan:4\\ncell:I31:b::2:::l:3:f:7\\ncell:A32:b::2:::l:3:f:7\\ncell:B32:b::::2:l:3:f:7\\ncell:I32:b::2:::l:3:f:7\\ncell:A33:b::2:::l:3:f:7\\ncell:B33:b::::2:l:3:f:7\\ncell:I33:b::2:::l:3:f:7\\ncell:A34:b::2:::l:3:f:7\\ncell:B34:b::::2:l:3:f:7\\ncell:I34:b::2:::l:3:f:7\\ncell:A35:b::2:::l:3:f:7\\ncell:B35:b:::2:2:l:3:f:7\\ncell:C35:b:::2::l:3:f:7\\ncell:D35:b:::2::l:3:f:7\\ncell:E35:b:::2::l:3:f:7\\ncell:F35:b:::2::l:3:f:7\\ncell:G35:b:::2::l:3:f:7\\ncell:H35:b:::2::l:3:f:7\\ncell:I35:b::2:2::l:3:f:7\\ncell:B36:b:1:::\\ncell:C36:b:1:::\\ncell:D36:b:1:::\\ncell:E36:b:1:::\\ncell:F36:b:1:::\\ncell:G36:b:1:::\\ncell:H36:b:1:::\\ncell:I36:b:1:::\\ncol:A:w:26\\ncol:B:w:28\\ncol:C:w:96\\ncol:D:w:203\\ncol:E:w:51\\ncol:F:w:50\\ncol:G:w:58\\ncol:H:w:80\\ncol:I:w:28\\nrow:1:h:14.25\\nrow:2:h:18.75\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:15.75\\nrow:6:h:15.75\\nrow:7:h:15.75\\nrow:8:h:15.75\\nrow:9:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:13:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:16:h:14.25\\nrow:17:h:14.25\\nrow:18:h:14.25\\nrow:19:h:14.25\\nrow:20:h:14.25\\nrow:21:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nrow:24:h:14.25\\nrow:25:h:14.25\\nrow:26:h:14.25\\nrow:27:h:14.25\\nrow:28:h:15.75\\nrow:29:h:15.75\\nrow:30:h:14.25\\nrow:31:h:14.25\\nrow:32:h:14.25\\nrow:33:h:14.25\\nrow:34:h:14.25\\nrow:35:h:14.25\\nsheet:c:9:r:36:h:12.75\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\nfont:1:* * Trebuchet MS\\nfont:2:normal bold * Trebuchet MS\\nfont:3:normal bold 10pt Arial\\nfont:4:normal bold 12pt Arial\\nfont:5:normal bold 12pt Trebuchet MS\\nfont:6:normal bold 14pt Trebuchet MS\\nfont:7:normal normal 10pt Arial\\nfont:8:normal normal 12pt Arial\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nlayout:3:padding:* * * *;vertical-align:top;\\nvalueformat:1:#,##0.00\\nvalueformat:2:#,##0.00;(#,##0.00)\\nvalueformat:3:d-mmm\\nvalueformat:4:m/d/yy\\nvalueformat:5:text-html\\n\" }, \"name\": \"typeii\", \"hidden\": \"0\" }, \"sheet3\": { \"sheetstr\": { \"savestr\": \"version:1.5\\ncell:A1:l:3\\ncell:B2:t:[Company Name]:l:1:f:3:cf:2:colspan:3\\ncell:C2:t::l:2:f:9\\ncell:D2:t::l:2:f:9\\ncell:E2:l:1:f:7:c:2:cf:3\\ncell:F2:t:INVOICE:l:1:f:7:c:2:cf:2:colspan:2\\ncell:G2:t::l:2:f:9\\ncell:B3:t:[Company Slogan]:f:4:cf:2:colspan:3\\ncell:C3:t::l:2:f:9\\ncell:D3:t::l:2:f:9\\ncell:B4:f:2:colspan:2\\ncell:F4:tvf:4:rowspan:4\\ncell:B5:t:[Street Address]:f:1:cf:2:colspan:2\\ncell:F5:l:1:f:6\\ncell:G5:l:1:f:10:cf:1\\ncell:B6:t:[City, State,  Zip]:f:1:cf:2:colspan:2\\ncell:G6:l:1:f:9\\ncell:B7:t:Phone\\\\c :f:1:cf:2:colspan:2\\ncell:B8:t:Email\\\\c:f:1:cf:2:colspan:2\\ncell:B9:colspan:2\\ncell:F9:t:DATE \\\\c:l:1:f:6:cf:2\\ncell:G9:l:1:f:10:cf:2:ntvf:3\\ncell:B10:t:BILL TO\\\\c:f:5:c:1:bg:3:cf:2:colspan:2\\ncell:F10:t:INVOICE # \\\\c:l:1:f:6:cf:2\\ncell:G10:v:1:l:1:f:10:cf:2\\ncell:B11:t:[Name]:f:1:cf:2:colspan:2\\ncell:B12:t:[Company Name]:f:1:cf:2:colspan:2\\ncell:F12:t:  \\ncell:B13:t:[Street Address]:f:1:cf:2:colspan:2\\ncell:B14:t:[City, State,  Zip]:f:1:cf:2:colspan:2\\ncell:B15:t:Phone\\\\c :f:1:cf:2:colspan:2\\ncell:A17:b::1::\\ncell:B17:t:DESCRIPTION:b:1:1:1:1:l:1:f:6:c:1:bg:3:cf:1:colspan:5:rowspan:1\\ncell:C17:t::l:2:f:9\\ncell:D17:t::l:2:f:9\\ncell:E17:t::l:2:f:9\\ncell:F17:t::l:2:f:9\\ncell:G17:t:AMOUNT:b:1:1:1::l:1:f:6:c:1:bg:3:cf:1\\ncell:A18:b::1::\\ncell:B18:b:1:1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C18:t::l:2:f:9\\ncell:D18:t::l:2:f:9\\ncell:E18:t::l:2:f:9\\ncell:F18:t::b::2:::l:1:f:9\\ncell:G18:b::1::1:f:1:ntvf:1\\ncell:A19:b::1::\\ncell:B19:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C19:t::l:2:f:9\\ncell:D19:t::l:2:f:9\\ncell:E19:t::l:2:f:9\\ncell:F19:t::b::2:::l:1:f:9\\ncell:G19:b::1::1:f:1:ntvf:1\\ncell:A20:b::1::\\ncell:B20:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C20:t::l:2:f:9\\ncell:D20:t::l:2:f:9\\ncell:E20:t::l:2:f:9\\ncell:F20:t::b::2:::l:1:f:9\\ncell:G20:b::1::1:f:1:ntvf:1\\ncell:A21:b::1::\\ncell:B21:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C21:t::l:2:f:9\\ncell:D21:t::l:2:f:9\\ncell:E21:t::l:2:f:9\\ncell:F21:t::b::2:::l:1:f:9\\ncell:G21:b::1::1:f:1:ntvf:1\\ncell:A22:b::1::\\ncell:B22:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C22:t::l:2:f:9\\ncell:D22:t::l:2:f:9\\ncell:E22:t::l:2:f:9\\ncell:F22:t::b::2:::l:1:f:9\\ncell:G22:b::1::1:f:1:ntvf:1\\ncell:A23:b::1::\\ncell:B23:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C23:t::l:2:f:9\\ncell:D23:t::l:2:f:9\\ncell:E23:t::l:2:f:9\\ncell:F23:t::b::2:::l:1:f:9\\ncell:G23:b::1::1:f:1:ntvf:1\\ncell:A24:b::1::\\ncell:B24:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C24:t::l:2:f:9\\ncell:D24:t::l:2:f:9\\ncell:E24:t::l:2:f:9\\ncell:F24:t::b::2:::l:1:f:9\\ncell:G24:b::1::1:f:1:ntvf:1\\ncell:A25:b::1::\\ncell:B25:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C25:t::l:2:f:9\\ncell:D25:t::l:2:f:9\\ncell:E25:t::l:2:f:9\\ncell:F25:t::b::2:::l:1:f:9\\ncell:G25:b::1::1:f:1:ntvf:1\\ncell:A26:b::1::\\ncell:B26:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C26:t::l:2:f:9\\ncell:D26:t::l:2:f:9\\ncell:E26:t::l:2:f:9\\ncell:F26:t::b::2:::l:1:f:9\\ncell:G26:b::1::1:f:1:ntvf:1\\ncell:A27:b::1::\\ncell:B27:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C27:t::l:2:f:9\\ncell:D27:t::l:2:f:9\\ncell:E27:t::l:2:f:9\\ncell:F27:t::b::2:::l:1:f:9\\ncell:G27:b::1::1:f:1:ntvf:1\\ncell:A28:b::1::\\ncell:B28:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C28:t::l:2:f:9\\ncell:D28:t::l:2:f:9\\ncell:E28:t::l:2:f:9\\ncell:F28:t::b::2:::l:1:f:9\\ncell:G28:b::1::1:f:1:ntvf:1\\ncell:A29:b::1::\\ncell:B29:b::1:1:1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C29:t::b:::2::l:1:f:9\\ncell:D29:t::b:::2::l:1:f:9\\ncell:E29:t::b:::2::l:1:f:9\\ncell:F29:t::b::2:2::l:1:f:9\\ncell:G29:b::1:1:1:f:1:ntvf:1\\ncell:B30:b:2::::l:1:f:9\\ncell:C30:b:2::::l:1:f:9\\ncell:D30:b:2::::l:1:f:9\\ncell:E30:b:2::::l:1:f:10\\ncell:F30:t:Subtotal:b:2::::l:1:f:10\\ncell:G30:vtf:n:0:SUM(G18\\\\cG29):b:1::::f:8:ntvf:1\\ncell:B31:t:NOTES:b:::2::l:1:f:6:cf:2:colspan:3:rowspan:1\\ncell:C31:t::b:::2::l:1:f:9\\ncell:D31:t::b:::2::l:1:f:9\\ncell:F31:t:Tax Rate:l:1:f:1\\ncell:G31:v:0:f:1:ntvf:2\\ncell:B32:b:1::::f:1:cf:2:colspan:3\\ncell:C32:t::b:2::::l:1:f:9\\ncell:D32:t::b:2::::l:1:f:9\\ncell:F32:t:Tax:l:1:f:1\\ncell:G32:vtf:n:0:G31*G30:f:1:ntvf:1\\ncell:B33:f:1:cf:2:colspan:3\\ncell:C33:t::l:2:f:9\\ncell:D33:t::l:2:f:9\\ncell:F33:t:Other:b:::1::l:1:f:1\\ncell:G33:v:0:b:::1::f:1:ntvf:1\\ncell:B34:b:::1::f:1:cf:2:colspan:3:rowspan:1\\ncell:C34:t::l:2:f:9\\ncell:D34:t::l:2:f:9\\ncell:F34:t:TOTAL:b:2::::l:1:f:6\\ncell:G34:vtf:n:0:(G30+G32)+G33:b:1::::f:5:ntvf:1\\ncell:C36:tvf:4:colspan:5:rowspan:7\\ncol:A:w:40\\ncol:B:w:232\\ncol:C:w:53\\ncol:D:w:90\\ncol:E:w:54\\ncol:F:w:91\\ncol:G:w:99\\nrow:1:h:34.5\\nrow:2:h:34.5\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:14.25\\nrow:6:h:14.25\\nrow:7:h:14.25\\nrow:8:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:13:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:17:h:14.25\\nrow:18:h:14.25\\nrow:19:h:14.25\\nrow:20:h:14.25\\nrow:21:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nrow:24:h:14.25\\nrow:25:h:14.25\\nrow:26:h:14.25\\nrow:27:h:14.25\\nrow:28:h:14.25\\nrow:29:h:14.25\\nrow:30:h:14.25\\nrow:31:h:14.25\\nrow:32:h:14.25\\nrow:33:h:14.25\\nrow:34:h:14.25\\nsheet:c:7:r:36:h:12.75:needsrecalc:yes\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\ncellformat:3:right\\ncolor:1:rgb(0, 0, 0)\\ncolor:2:rgb(0,0,0)\\ncolor:3:rgb(221, 221, 221)\\nfont:1:* * Trebuchet MS\\nfont:2:* 10pt *\\nfont:3:* 16pt Trebuchet MS\\nfont:4:italic normal * Trebuchet MS\\nfont:5:normal bold * Trebuchet MS\\nfont:6:normal bold 10pt Trebuchet MS\\nfont:7:normal bold 28pt Trebuchet MS\\nfont:8:normal normal * Trebuchet MS\\nfont:9:normal normal 10pt Arial\\nfont:10:normal normal 10pt Trebuchet MS\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nlayout:3:padding:36px * 28px *;vertical-align:*;\\nvalueformat:1:#,##0.00\\nvalueformat:2:#,##0.00%\\nvalueformat:3:m/d/yy\\nvalueformat:4:text-html\\n\" }, \"name\": \"typeiii\", \"hidden\": \"0\" }, \"sheet4\": { \"sheetstr\": { \"savestr\": \"version:1.5\\ncell:A1:l:3\\ncell:B2:t:[Company Name]:l:1:f:2:cf:2:colspan:3:rowspan:1\\ncell:C2:t::l:2:f:7\\ncell:D2:t::l:2:f:7\\ncell:F2:t:INVOICE:l:1:f:6:c:1:cf:2:colspan:2\\ncell:G2:t::l:2:f:7\\ncell:B3:t:[Company slogan]:f:3:cf:2:colspan:3:rowspan:1\\ncell:C3:t::l:2:f:7\\ncell:D3:t::l:2:f:7\\ncell:B4:cf:2:colspan:3:rowspan:1\\ncell:F4:tvf:4:rowspan:4\\ncell:B5:t:[Street Address]:f:1:cf:2:colspan:3:rowspan:1\\ncell:F5:l:1:f:5\\ncell:G5:l:1:f:8:cf:1\\ncell:B6:t:[City, State,  Zip]:f:1:cf:2:colspan:3:rowspan:1\\ncell:G6:l:1:f:7\\ncell:B7:t:Phone\\\\c :f:1:cf:2:colspan:3:rowspan:1\\ncell:B8:t:Email\\\\c:f:1:cf:2:colspan:3:rowspan:1\\ncell:B9:cf:2:colspan:3:rowspan:1\\ncell:B10:t:BILL TO\\\\c:l:1:f:5:bg:2:cf:2:colspan:2\\ncell:F10:t:DATE\\\\c:l:1:f:5:cf:2\\ncell:G10:l:1:f:8:cf:2:ntvf:3\\ncell:B11:t:[Name]:f:1:cf:2:colspan:3:rowspan:1\\ncell:F11:t:INVOICE # \\\\c:l:1:f:5:cf:2\\ncell:G11:v:1:l:1:f:8:cf:2\\ncell:B12:t:[Company Name]:f:1:cf:2:colspan:3:rowspan:1\\ncell:J12:tvf:4\\ncell:B13:t:[Street Address]:f:1:cf:2:colspan:3:rowspan:1\\ncell:B14:t:[City, State,  Zip]:f:1:cf:2:colspan:3:rowspan:1\\ncell:B15:t:Phone\\\\c :f:1:cf:2:colspan:3:rowspan:1\\ncell:B16:cf:2:colspan:3:rowspan:1\\ncell:A17:b::1::\\ncell:B17:t:DESCRIPTION:b:1:1:1:1:l:1:f:5:bg:2:cf:1:colspan:3:rowspan:1\\ncell:C17:t::b:1::1::l:1:f:7:bg:2\\ncell:D17:t::b:1::1::l:1:f:7:bg:2\\ncell:E17:t:HOURS:b:1:1:1::l:1:f:5:bg:2:cf:1\\ncell:F17:t:RATE:b:1:1:1::l:1:f:5:bg:2:cf:1\\ncell:G17:t:AMOUNT:b:1:1:1::l:1:f:5:bg:2:cf:1\\ncell:A18:b::1::\\ncell:B18:b:1:1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C18:t::b:2::::l:1:f:7\\ncell:D18:t::b:2:2:::l:1:f:7\\ncell:E18:b:1:1::1:f:1:ntvf:1\\ncell:F18:b:1:1::1:f:1:ntvf:1\\ncell:G18:vtf:t::IF(E18*F18>0,E18*F18,\\\"\\\"):b:1:1:::f:1:ntvf:1\\ncell:A19:b::1::\\ncell:B19:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C19:t::l:2:f:7\\ncell:D19:t::b::2:::l:1:f:7\\ncell:E19:b::1::1:f:1:ntvf:1\\ncell:F19:b::1::1:f:1:ntvf:1\\ncell:G19:vtf:t::IF(E19*F19>0,E19*F19,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A20:b::1::\\ncell:B20:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C20:t::l:2:f:7\\ncell:D20:t::b::2:::l:1:f:7\\ncell:E20:b::1::1:f:1:ntvf:1\\ncell:F20:b::1::1:f:1:ntvf:1\\ncell:G20:vtf:t::IF(E20*F20>0,E20*F20,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A21:b::1::\\ncell:B21:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C21:t::l:2:f:7\\ncell:D21:t::b::2:::l:1:f:7\\ncell:E21:b::1::1:f:1:ntvf:1\\ncell:F21:b::1::1:f:1:ntvf:1\\ncell:G21:vtf:t::IF(E21*F21>0,E21*F21,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A22:b::1::\\ncell:B22:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C22:t::l:2:f:7\\ncell:D22:t::b::2:::l:1:f:7\\ncell:E22:b::1::1:f:1:ntvf:1\\ncell:F22:b::1::1:f:1:ntvf:1\\ncell:G22:vtf:t::IF(E22*F22>0,E22*F22,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A23:b::1::\\ncell:B23:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C23:t::l:2:f:7\\ncell:D23:t::b::2:::l:1:f:7\\ncell:E23:b::1::1:f:1:ntvf:1\\ncell:F23:b::1::1:f:1:ntvf:1\\ncell:G23:vtf:t::IF(E23*F23>0,E23*F23,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A24:b::1::\\ncell:B24:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C24:t::l:2:f:7\\ncell:D24:t::b::2:::l:1:f:7\\ncell:E24:b::1::1:f:1:ntvf:1\\ncell:F24:b::1::1:f:1:ntvf:1\\ncell:G24:vtf:t::IF(E24*F24>0,E24*F24,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A25:b::1::\\ncell:B25:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C25:t::l:2:f:7\\ncell:D25:t::b::2:::l:1:f:7\\ncell:E25:b::1::1:f:1:ntvf:1\\ncell:F25:b::1::1:f:1:ntvf:1\\ncell:G25:vtf:t::IF(E25*F25>0,E25*F25,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A26:b::1::\\ncell:B26:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C26:t::l:2:f:7\\ncell:D26:t::b::2:::l:1:f:7\\ncell:E26:b::1::1:f:1:ntvf:1\\ncell:F26:b::1::1:f:1:ntvf:1\\ncell:G26:vtf:t::IF(E26*F26>0,E26*F26,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A27:b::1::\\ncell:B27:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C27:t::l:2:f:7\\ncell:D27:t::b::2:::l:1:f:7\\ncell:E27:b::1::1:f:1:ntvf:1\\ncell:F27:b::1::1:f:1:ntvf:1\\ncell:G27:vtf:t::IF(E27*F27>0,E27*F27,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A28:b::1::\\ncell:B28:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C28:t::l:2:f:7\\ncell:D28:t::b::2:::l:1:f:7\\ncell:E28:b::1::1:f:1:ntvf:1\\ncell:F28:b::1::1:f:1:ntvf:1\\ncell:G28:vtf:t::IF(E28*F28>0,E28*F28,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A29:b::1::\\ncell:B29:b::1:1:1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C29:t::b:::2::l:1:f:7\\ncell:D29:t::b::2:2::l:1:f:7\\ncell:E29:b::1:1:1:f:1:ntvf:1\\ncell:F29:b::1:1:1:f:1:ntvf:1\\ncell:G29:vtf:t::IF(E29*F29>0,E29*F29,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:B30:b:2::::l:1:f:8:cf:1:colspan:3:rowspan:1\\ncell:C30:t::b:2::::l:1:f:7\\ncell:D30:t::b:2::::l:1:f:7\\ncell:E30:b:2::::l:1:f:8\\ncell:F30:t:Subtotal:b:1::::f:1\\ncell:G30:vtf:n:0:SUM(G18\\\\cG29):b:1::::f:1:ntvf:1\\ncell:B31:t:NOTES:b:::2::l:1:f:5:cf:2:colspan:3:rowspan:1\\ncell:C31:t::b:::2::l:1:f:7\\ncell:D31:t::b:::2::l:1:f:7\\ncell:F31:t:Tax Rate:f:1\\ncell:G31:v:0:f:1:ntvf:2\\ncell:B32:b:1::::f:1:cf:2:colspan:3:rowspan:1\\ncell:C32:t::b:2::::l:1:f:7\\ncell:D32:t::b:2::::l:1:f:7\\ncell:F32:t:Tax:f:1\\ncell:G32:vtf:n:0:G31*G30:f:1:ntvf:1\\ncell:B33:f:1:cf:2:colspan:3:rowspan:1\\ncell:C33:t::l:2:f:7\\ncell:D33:t::l:2:f:7\\ncell:F33:t:Other:b:::1::l:1:f:1\\ncell:G33:v:0:b:::1::f:1:ntvf:1\\ncell:B34:f:1:cf:2:colspan:3:rowspan:1\\ncell:C34:t::l:2:f:7\\ncell:D34:t::l:2:f:7\\ncell:F34:t:TOTAL:b:1::::l:1:f:4\\ncell:G34:vtf:n:0:(G30+G32)+G33:b:1::::f:4:ntvf:1\\ncell:B35:b:2::::l:1:f:7\\ncell:C35:b:2::::l:1:f:7\\ncell:D35:b:2::::l:1:f:7\\ncell:C36:tvf:4:colspan:5:rowspan:7\\ncol:A:w:40\\ncol:B:w:194\\ncol:C:w:128\\ncol:D:w:60\\ncol:E:w:65\\ncol:F:w:95\\ncol:G:w:90\\nrow:1:h:34.5\\nrow:2:h:34.5\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:14.25\\nrow:6:h:14.25\\nrow:7:h:14.25\\nrow:8:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:13:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:17:h:14.25\\nrow:18:h:14.25\\nrow:19:h:14.25\\nrow:20:h:14.25\\nrow:21:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nrow:24:h:14.25\\nrow:25:h:14.25\\nrow:26:h:14.25\\nrow:27:h:14.25\\nrow:28:h:14.25\\nrow:29:h:14.25\\nrow:30:h:14.25\\nrow:31:h:14.25\\nrow:32:h:14.25\\nrow:33:h:14.25\\nrow:34:h:14.25\\nrow:35:h:14.25\\nsheet:c:10:r:36:h:12.75:needsrecalc:yes\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\ncolor:1:rgb(0,0,0)\\ncolor:2:rgb(221, 221, 221)\\nfont:1:* * Trebuchet MS\\nfont:2:* 16pt Trebuchet MS\\nfont:3:italic normal * Trebuchet MS\\nfont:4:normal bold * Trebuchet MS\\nfont:5:normal bold 10pt Trebuchet MS\\nfont:6:normal bold 28pt Trebuchet MS\\nfont:7:normal normal 10pt Arial\\nfont:8:normal normal 10pt Trebuchet MS\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nlayout:3:padding:36px * 28px *;vertical-align:*;\\nvalueformat:1:#,##0.00\\nvalueformat:2:#,##0.00%\\nvalueformat:3:m/d/yy\\nvalueformat:4:text-html\\n\" }, \"name\": \"typeiv\", \"hidden\": \"0\" } }, \"EditableCells\": { \"allow\": true, \"cells\": { \"typei!C10\": true, \"typei!B2\": true, \"typei!C11\": true, \"typei!C12\": true, \"typei!C13\": true, \"typei!D9\": true, \"typei!D4\": true, \"typei!D6\": true, \"typei!E10\": true, \"typei!E11\": true, \"typei!E12\": true, \"typei!E13\": true, \"typei!F9\": true, \"typei!C16\": true, \"typei!C17\": true, \"typei!C18\": true, \"typei!C19\": true, \"typei!C20\": true, \"typei!C21\": true, \"typei!C22\": true, \"typei!C23\": true, \"typei!C24\": true, \"typei!C25\": true, \"typei!C26\": true, \"typei!C27\": true, \"typei!C28\": true, \"typei!F16\": true, \"typei!F17\": true, \"typei!F18\": true, \"typei!F19\": true, \"typei!F20\": true, \"typei!F21\": true, \"typei!F22\": true, \"typei!F23\": true, \"typei!F24\": true, \"typei!F25\": true, \"typei!F26\": true, \"typei!F27\": true, \"typei!F28\": true, \"typei!E35\": true, \"typeii!B2\": true, \"typeii!D4\": true, \"typeii!C10\": true, \"typeii!C11\": true, \"typeii!C12\": true, \"typeii!C13\": true, \"typeii!D9\": true, \"typeii!E10\": true, \"typeii!E11\": true, \"typeii!E12\": true, \"typeii!E13\": true, \"typeii!F9\": true, \"typeii!C16\": true, \"typeii!C17\": true, \"typeii!C18\": true, \"typeii!C19\": true, \"typeii!C20\": true, \"typeii!C21\": true, \"typeii!C22\": true, \"typeii!C23\": true, \"typeii!C24\": true, \"typeii!C25\": true, \"typeii!C26\": true, \"typeii!C27\": true, \"typeii!C28\": true, \"typeii!F16\": true, \"typeii!F17\": true, \"typeii!F18\": true, \"typeii!F19\": true, \"typeii!F20\": true, \"typeii!F21\": true, \"typeii!F22\": true, \"typeii!F23\": true, \"typeii!F24\": true, \"typeii!F25\": true, \"typeii!F26\": true, \"typeii!F27\": true, \"typeii!F28\": true, \"typeii!G16\": true, \"typeii!G17\": true, \"typeii!G18\": true, \"typeii!G19\": true, \"typeii!G20\": true, \"typeii!G21\": true, \"typeii!G22\": true, \"typeii!G23\": true, \"typeii!G24\": true, \"typeii!G25\": true, \"typeii!G26\": true, \"typeii!G27\": true, \"typeii!G28\": true, \"typeii!E35\": true, \"typeiii!G9\": true, \"typeiii!G10\": true, \"typeiii!B2\": true, \"typeiii!B3\": true, \"typeiii!B4\": true, \"typeiii!B5\": true, \"typeiii!B6\": true, \"typeiii!B7\": true, \"typeiii!B8\": true, \"typeiii!B9\": true, \"typeiii!B11\": true, \"typeiii!B12\": true, \"typeiii!B13\": true, \"typeiii!B14\": true, \"typeiii!B15\": true, \"typeiii!B18\": true, \"typeiii!B19\": true, \"typeiii!B20\": true, \"typeiii!B21\": true, \"typeiii!B22\": true, \"typeiii!B23\": true, \"typeiii!B24\": true, \"typeiii!B25\": true, \"typeiii!B26\": true, \"typeiii!B27\": true, \"typeiii!B28\": true, \"typeiii!B29\": true, \"typeiii!G18\": true, \"typeiii!G19\": true, \"typeiii!G20\": true, \"typeiii!G21\": true, \"typeiii!G22\": true, \"typeiii!G23\": true, \"typeiii!G24\": true, \"typeiii!G25\": true, \"typeiii!G26\": true, \"typeiii!G27\": true, \"typeiii!G28\": true, \"typeiii!G29\": true, \"typeiii!B32\": true, \"typeiii!B33\": true, \"typeiii!B34\": true, \"typeiii!G31\": true, \"typeiii!G33\": true, \"typeiii!B37\": true, \"typeiv!G9\": true, \"typeiv!G10\": true, \"typeiv!B2\": true, \"typeiv!B3\": true, \"typeiv!B4\": true, \"typeiv!B5\": true, \"typeiv!B6\": true, \"typeiv!B7\": true, \"typeiv!B8\": true, \"typeiv!B11\": true, \"typeiv!B12\": true, \"typeiv!B13\": true, \"typeiv!B14\": true, \"typeiv!B15\": true, \"typeiv!B16\": true, \"typeiv!B18\": true, \"typeiv!B19\": true, \"typeiv!B20\": true, \"typeiv!B21\": true, \"typeiv!B22\": true, \"typeiv!B23\": true, \"typeiv!B24\": true, \"typeiv!B25\": true, \"typeiv!B26\": true, \"typeiv!B27\": true, \"typeiv!B28\": true, \"typeiv!B29\": true, \"typeiv!E18\": true, \"typeiv!E19\": true, \"typeiv!E20\": true, \"typeiv!E21\": true, \"typeiv!E22\": true, \"typeiv!E23\": true, \"typeiv!E24\": true, \"typeiv!E25\": true, \"typeiv!E26\": true, \"typeiv!E27\": true, \"typeiv!E28\": true, \"typeiv!E29\": true, \"typeiv!F18\": true, \"typeiv!F19\": true, \"typeiv!F2\": true, \"typeiv!F20\": true, \"typeiv!F21\": true, \"typeiv!F22\": true, \"typeiv!F23\": true, \"typeiv!F24\": true, \"typeiv!F25\": true, \"typeiv!F26\": true, \"typeiv!F27\": true, \"typeiv!F28\": true, \"typeiv!F29\": true, \"typeiv!B32\": true, \"typeiv!B33\": true, \"typeiv!B34\": true, \"typeiv!G31\": true, \"typeiv!G33\": true, \"typeiv!B37\": true, \"typeii!F15\": true, \"typeii!G15\": true, \"typeiv!E17\": true, \"typeiv!F17\": true, \"typeii!D6\": true, \"typeiv!G11\": true, \"typei!C4\": true, \"typeii!C4\": true, \"typeiii!F10\": true, \"typeiv!F11\": true, \"typeiv!F10\": true, \"typeiii!F9\": true, \"typeii!C6\": true, \"typei!C6\": true, \"typei!F4\": true, \"typeii!F4\": true, \"typeiii!F4\": true, \"typeiii!F2\": true, \"typeiv!F4\": true, \"typei!F29\": true, \"typeii!H29\": true, \"typeiii!G30\": true, \"typeiii!G34\": true, \"typeiv!G30\": true, \"typeiv!G34\": true }, \"constraints\": {} } },\n\t                                                \"footers\": [{ name: 'Invoice 1', index: 1, isActive: true }, { name: 'Invoice 2', index: 2, isActive: false }, { name: 'Company Invoice 1', index: 3, isActive: false }, { name: 'Company Invoice 2', index: 4, isActive: false }]\n\t                                },\n\t                                \"iPhone\": {\n\t                                                \"msc\": { \"numsheets\": 5, \"currentid\": \"sheet1\", \"currentname\": \"inv1\", \"sheetArr\": { \"sheet1\": { \"sheetstr\": { \"savestr\": \"version:1.5\\ncell:B1:b:::2::l:1:f:10\\ncell:C1:b:::2::l:1:f:10\\ncell:D1:b:::2::l:1:f:10\\ncell:E1:b:::2::l:1:f:10\\ncell:F1:b:::2::l:1:f:10\\ncell:G1:b:::2::l:1:f:10\\ncell:A2:b::2:::l:1:f:10\\ncell:B2:t:INVOICE:b:1:1:1:1:f:13:cf:1:colspan:6\\ncell:C2:t::b:2::2::l:1:f:10\\ncell:D2:t::b:2::2::l:1:f:10\\ncell:E2:t::b:2::2::l:1:f:10\\ncell:F2:t::b:2::2::l:1:f:10\\ncell:G2:t::b:2::2::l:1:f:10\\ncell:A3:b::2:::l:3:f:10\\ncell:B3:b:2:::2:l:3:f:10\\ncell:C3:b:2::::l:1:f:10\\ncell:D3:b:2::::l:1:f:10\\ncell:E3:b:2::::l:1:f:10\\ncell:F3:b:2::::l:1:f:10\\ncell:G3:b:2:2:::l:3:f:10\\ncell:A4:b::2:::l:3:f:10\\ncell:B4:b::::2:l:3:f:6\\ncell:C4:t:BILL TO\\\\c:f:9:colspan:2\\ncell:E4:f:5:cf:2\\ncell:G4:b::2:::l:3:f:10\\ncell:A5:b::2:::l:3:f:10\\ncell:B5:b::::2:l:3:f:7\\ncell:C5:t:[Name]:f:9:cf:2:colspan:3\\ncell:E5:f:1:cf:2\\ncell:F5:t::l:2:f:10:tvf:4:rowspan:6\\ncell:G5:t::b::1:::l:2:f:10\\ncell:A6:b::2:::l:3:f:10\\ncell:B6:b::::2:l:3:f:7\\ncell:C6:t:[Street Address]:f:9:cf:2:colspan:3\\ncell:E6:f:1:cf:2\\ncell:F6:l:2:f:10\\ncell:G6:b::1:::l:2:f:10\\ncell:A7:b::2:::l:3:f:10\\ncell:B7:b::::2:l:3:f:7\\ncell:C7:t:[City, State, Zip]:f:9:cf:2:colspan:3\\ncell:E7:f:1:cf:2\\ncell:G7:b::2:::l:3:f:10\\ncell:A8:b::2:::l:3:f:10\\ncell:B8:b::::2:l:3:f:7\\ncell:C8:t:Phone\\\\c:f:9:cf:2:colspan:3\\ncell:D8:f:8:cf:2\\ncell:E8:f:1:cf:2\\ncell:G8:b::2:::l:3:f:10\\ncell:A9:b::2:::l:3:f:10\\ncell:B9:b::::2:l:3:f:7\\ncell:C9:t:Email\\\\c:f:9:cf:2:colspan:3\\ncell:E9:f:1:cf:2\\ncell:G9:b::2:::l:3:f:10\\ncell:A10:b::2:::l:3:f:10\\ncell:B10:b::::2:l:3:f:7\\ncell:C10:colspan:2\\ncell:G10:b::2:::l:3:f:10\\ncell:A11:b::2:::l:3:f:10\\ncell:B11:b::::2:l:3:f:7\\ncell:C11:t:FROM\\\\c:f:9:colspan:2\\ncell:E11:f:8:colspan:2\\ncell:G11:b::2:::l:3:f:10\\ncell:A12:b::2:::l:3:f:10\\ncell:B12:b::::2:l:3:f:7\\ncell:C12:t:[Name]:f:9:colspan:4\\ncell:E12:colspan:2\\ncell:G12:b::2:::l:3:f:10\\ncell:A13:b::2:::l:3:f:10\\ncell:B13:b::::2:l:3:f:7\\ncell:C13:t:[Street Address]:f:9:colspan:4\\ncell:E13:colspan:2\\ncell:G13:b::2:::l:3:f:10\\ncell:A14:b::2:::l:3:f:10\\ncell:B14:b::::2:l:3:f:7\\ncell:C14:t:[City, State, Zip]:f:9:colspan:4\\ncell:E14:colspan:2\\ncell:G14:b::2:::l:3:f:10\\ncell:A15:b::2:::l:3:f:10\\ncell:B15:b::::2:l:3:f:7\\ncell:C15:t:Phone\\\\c:f:9:colspan:4\\ncell:D15:f:8:cf:2:colspan:3\\ncell:E15:colspan:2\\ncell:G15:b::2:::l:3:f:10\\ncell:A16:b::2:::l:3:f:10\\ncell:B16:b::::2:l:3:f:7\\ncell:C16:t:Email\\\\c:f:9:colspan:4\\ncell:E16:colspan:2\\ncell:G16:b::2:::l:3:f:10\\ncell:A17:b::2:::l:3:f:10\\ncell:B17:b::::2:l:3:f:6\\ncell:G17:b::2:::l:3:f:10\\ncell:A18:b::2:::l:3:f:10\\ncell:B18:b::::2:l:3:f:10\\ncell:C18:t:INVOICE #\\\\c:f:9:cf:2:colspan:4\\ncell:D18:v:1:l:4:f:9:cf:2:colspan:3\\ncell:G18:b::2:::l:3:f:10\\ncell:A19:b::2:::l:3:f:10\\ncell:B19:b::::2:l:3:f:10\\ncell:G19:b::2:::l:3:f:10\\ncell:A20:b::2:::l:3:f:10\\ncell:B20:b::::2:l:3:f:10\\ncell:C20:t:DATE\\\\c:f:9:cf:2\\ncell:D20:vtf:nd:42081:TODAY():f:9:cf:2:ntvf:3:colspan:2\\ncell:G20:b::2:::l:3:f:10\\ncell:A21:b::2:::l:3:f:10\\ncell:B21:b::::2:l:3:f:6:cf:2\\ncell:C21:b:::2::l:1:f:10\\ncell:D21:b:::2::l:3:f:6:cf:2\\ncell:E21:b:::2::l:1:f:10\\ncell:F21:b:::2::l:1:f:10\\ncell:G21:b::2:::l:3:f:10\\ncell:A22:b::2:::l:3:f:10\\ncell:B22:b::2::2:l:3:f:10\\ncell:C22:t:Description:b:1::1:1:f:9:cf:1:colspan:3\\ncell:D22:t:Description:b:1::1::l:3:f:6:cf:2:colspan:2:rowspan:1\\ncell:E22:t::b:2:2:2::l:1:f:10\\ncell:F22:t:Amount:b:1:1:1:1:f:9:cf:1\\ncell:G22:b::2::2:l:3:f:10\\ncell:A23:b::2:::l:3:f:10\\ncell:B23:b::2::2:l:3:f:10\\ncell:C23:b:1:1::1:f:2:cf:2:colspan:3\\ncell:D23:b:1:1:::l:3:f:10:cf:2:colspan:2:rowspan:1\\ncell:E23:t::b:2:2:2::l:1:f:10\\ncell:F23:b:1:1:::f:2:ntvf:1\\ncell:G23:b::2::2:l:3:f:10\\ncell:A24:b::2:::l:3:f:10\\ncell:B24:b::2::2:l:3:f:10:cf:2\\ncell:C24:b::1::1:f:2:cf:2:colspan:3\\ncell:D24:b::1:::l:1:f:10:colspan:2\\ncell:E24:l:1:f:10\\ncell:F24:b::1:::f:2:ntvf:1\\ncell:G24:b::2::2:l:3:f:10\\ncell:A25:b::2:::l:3:f:10\\ncell:B25:b::2::2:l:3:f:10:cf:2:ntvf:2\\ncell:C25:b::1::1:f:2:cf:2:colspan:3\\ncell:D25:b::1:::colspan:2\\ncell:F25:b::1:::f:2:ntvf:1\\ncell:G25:b::2::2:l:3:f:10\\ncell:A26:b::2:::l:3:f:10\\ncell:B26:b::2::2:l:3:f:10:cf:2:ntvf:2\\ncell:C26:b::1::1:f:2:cf:2:colspan:3\\ncell:D26:b::1:::colspan:2\\ncell:F26:b::1:::f:2:ntvf:1\\ncell:G26:b::2::2:l:3:f:10\\ncell:A27:b::2:::l:3:f:10\\ncell:B27:b::2::2:l:3:f:10:cf:2:ntvf:2\\ncell:C27:b::1::1:f:2:cf:2:colspan:3\\ncell:D27:b::1:::colspan:2\\ncell:F27:b::1:::f:2:ntvf:1\\ncell:G27:b::2::2:l:3:f:10\\ncell:A28:b::2:::l:3:f:10\\ncell:B28:b::2::2:l:3:f:10:cf:2:ntvf:2\\ncell:C28:b::1::1:f:2:cf:2:colspan:3\\ncell:D28:b::1:::colspan:2\\ncell:F28:b::1:::f:2:ntvf:1\\ncell:G28:b::2::2:l:3:f:10\\ncell:A29:b::2:::l:3:f:10\\ncell:B29:b::2::2:l:3:f:10:cf:2:ntvf:2\\ncell:C29:b::1::1:f:2:cf:2:colspan:3\\ncell:D29:b::1:::colspan:2\\ncell:F29:b::1:::f:2:ntvf:1\\ncell:G29:b::2::2:l:3:f:10\\ncell:A30:b::2:::l:3:f:10\\ncell:B30:b::2::2:l:3:f:10:cf:2\\ncell:C30:b::1::1:f:2:cf:2:colspan:3\\ncell:D30:b::1:::colspan:2\\ncell:F30:b::1:::f:2:ntvf:1\\ncell:G30:b::2::2:l:3:f:10\\ncell:A31:b::2:::l:3:f:10\\ncell:B31:b::2::2:l:3:f:10:cf:2\\ncell:C31:b::1::1:f:2:cf:2:colspan:3\\ncell:D31:b::1:::colspan:2\\ncell:F31:b::1:::f:2:ntvf:1\\ncell:G31:b::2::2:l:3:f:10\\ncell:A32:b::2:::l:3:f:10\\ncell:B32:b::2::2:l:3:f:10:cf:2\\ncell:C32:b::1::1:f:2:cf:2:colspan:3\\ncell:D32:b::1:::colspan:2\\ncell:F32:b::1:::f:2:ntvf:1\\ncell:G32:b::2::2:l:3:f:10\\ncell:A33:b::2:::l:3:f:10\\ncell:B33:b::2::2:l:3:f:10:cf:2\\ncell:C33:b::1::1:f:2:cf:2:colspan:3\\ncell:D33:b::1:::colspan:2\\ncell:F33:b::1:::f:2:ntvf:1\\ncell:G33:b::2::2:l:3:f:10\\ncell:A34:b::2:::l:3:f:10\\ncell:B34:b::2::2:l:3:f:10:cf:2\\ncell:C34:b::1::1:f:2:cf:2:colspan:3\\ncell:D34:b::1:::colspan:2\\ncell:F34:b::1:::f:2:ntvf:1\\ncell:G34:b::2::2:l:3:f:10\\ncell:A35:b::2:::l:3:f:7\\ncell:B35:b::2::2:l:3:f:10:cf:2\\ncell:C35:b::1:1:1:f:2:cf:2:colspan:3\\ncell:D35:b::1:1::l:3:f:10:cf:2:colspan:2\\ncell:E35:b:::2::l:3:f:10:cf:2\\ncell:F35:b::1:1::f:2:ntvf:1\\ncell:G35:b::2::2:l:3:f:10\\ncell:A36:b::2:::l:3:f:6\\ncell:B36:b::2::2:l:3:f:6\\ncell:C36:t:TOTAL:b:1:1:1:1:f:11:cf:2:colspan:3\\ncell:D36:b:2::2::l:3:f:12:cf:2\\ncell:E36:b:2:2:2::l:3:f:12:cf:2\\ncell:F36:vtf:n:0:SUM(F23\\\\cF35):b:1:1:1::f:11:ntvf:1\\ncell:G36:b::2::2:l:3:f:7\\ncell:A37:b::2:::l:3:f:10\\ncell:B37:b::::2:l:3:f:6:cf:2\\ncell:C37:b:2::::l:1:f:10\\ncell:D37:b:2::::l:1:f:10\\ncell:E37:b:2::::l:1:f:10\\ncell:F37:b:2::::l:1:f:10\\ncell:G37:b::2:::l:3:f:6\\ncell:A38:b::2:::l:3:f:10\\ncell:B38:b::::2:l:3:f:10\\ncell:G38:b::2:::l:3:f:10\\ncell:A39:b::2:::l:3:f:10\\ncell:B39:b::::2:l:3:f:10:cf:2\\ncell:C39:t:Thank you for your business:f:4:cf:1:colspan:4\\ncell:D39:t:Thank you for your business:colspan:3\\ncell:E39:t:Thank you for your business:f:3:colspan:2\\ncell:F39:t::l:2:f:10\\ncell:G39:b::2:::l:3:f:10\\ncell:A40:b::2:::l:3:f:10\\ncell:B40:b::::2:l:3:f:10\\ncell:G40:b::2:::l:3:f:10\\ncell:A41:b::2:::l:3:f:10\\ncell:B41:b:::2:2:l:3:f:10\\ncell:C41:b:::2::l:3:f:10\\ncell:D41:b:::2::l:3:f:10\\ncell:E41:b:::2::l:3:f:10\\ncell:F41:b:::2::l:3:f:10\\ncell:G41:b::2:2::l:3:f:10\\ncell:B42:b:1:::\\ncell:C42:b:1:::\\ncell:D42:b:1:::\\ncell:E42:b:1:::\\ncell:F42:b:1:::\\ncell:G42:b:1:::\\ncol:A:w:10\\ncol:B:w:10\\ncol:C:w:62\\ncol:D:w:73\\ncol:E:w:15\\ncol:F:w:68\\ncol:G:w:10\\nrow:1:h:14.25\\nrow:2:h:18.75\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:15.75\\nrow:6:h:15.75\\nrow:7:h:15.75\\nrow:8:h:15.75\\nrow:9:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:13:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:16:h:14.25\\nrow:17:h:14.25\\nrow:18:h:14.25\\nrow:19:h:14.25\\nrow:20:h:14.25\\nrow:21:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nrow:24:h:14.25\\nrow:25:h:14.25\\nrow:26:h:14.25\\nrow:27:h:14.25\\nrow:28:h:14.25\\nrow:29:h:14.25\\nrow:30:h:14.25\\nrow:31:h:14.25\\nrow:32:h:14.25\\nrow:33:h:14.25\\nrow:34:h:14.25\\nrow:35:h:15.75\\nrow:36:h:15.75\\nrow:37:h:14.25\\nrow:38:h:14.25\\nrow:39:h:14.25\\nrow:40:h:14.25\\nrow:41:h:14.25\\nsheet:c:7:r:42:h:12.75\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\nfont:1:* * Trebuchet MS\\nfont:2:* 9pt Trebuchet MS\\nfont:3:italic bold * Trebuchet MS\\nfont:4:italic bold 10pt Trebuchet MS\\nfont:5:normal bold * Trebuchet MS\\nfont:6:normal bold 10pt Arial\\nfont:7:normal bold 12pt Arial\\nfont:8:normal normal * *\\nfont:9:normal normal * Trebuchet MS\\nfont:10:normal normal 10pt Arial\\nfont:11:normal normal 11pt Trebuchet MS\\nfont:12:normal normal 12pt Arial\\nfont:13:normal normal 16pt Trebuchet MS\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nlayout:3:padding:* * * *;vertical-align:top;\\nlayout:4:padding:* * * 4px;vertical-align:*;\\nvalueformat:1:#,##0.00\\nvalueformat:2:d-mmm\\nvalueformat:3:m/d/yy\\nvalueformat:4:text-html\\n\" }, \"name\": \"inv1\", \"hidden\": \"0\" }, \"sheet2\": { \"sheetstr\": { \"savestr\": \"version:1.5\\ncell:B2:t:INVOICE:l:1:f:9:cf:1:colspan:6\\ncell:C2:t::l:2:f:13\\ncell:D2:t::l:2:f:13\\ncell:E2:l:1:f:10:c:2:cf:3\\ncell:F2:t:INVOICE:l:1:f:8:c:2:cf:2:colspan:2\\ncell:G2:t::l:2:f:13\\ncell:B3:f:6:cf:2:colspan:4\\ncell:C3:t::l:2:f:13\\ncell:D3:t::l:2:f:13\\ncell:F3:l:1:f:7:cf:2\\ncell:G3:l:1:f:14:cf:2:ntvf:3\\ncell:B4:f:2:colspan:2\\ncell:F4:t:DATE\\\\c:l:1:f:14:cf:2\\ncell:G4:vtf:nd:42081:TODAY():l:1:f:14:cf:2:ntvf:3\\ncell:B5:t:INVOICE #\\\\c:f:3:colspan:6\\ncell:C5:cf:2:colspan:5\\ncell:F5:l:1:f:7:cf:2:colspan:2\\ncell:G5:l:1:f:14:cf:2\\ncell:B6:f:2:colspan:2\\ncell:F6:l:1:f:7:cf:2:colspan:2\\ncell:G6:l:1:f:14:cf:2\\ncell:B7:t:FROM\\\\c:f:12\\ncell:F7:l:1:f:7:cf:2:tvf:4:colspan:2:rowspan:6\\ncell:G7:l:1:f:14:cf:2\\ncell:B8:t:[Company Name]:f:3:colspan:4\\ncell:F8:l:1:f:7:cf:2:colspan:2\\ncell:G8:l:1:f:14:cf:2\\ncell:B9:t:[Street Address]:f:1:cf:2:colspan:4\\ncell:F9:l:1:f:7\\ncell:G9:l:1:f:14:cf:1\\ncell:B10:t:[City, State,  Zip]:f:1:cf:2:colspan:4\\ncell:G10:l:1:f:13\\ncell:B11:t:Phone\\\\c :f:1:cf:2:colspan:4\\ncell:B12:t:Email\\\\c:f:1:cf:2:colspan:4\\ncell:B13:colspan:2\\ncell:B14:t:BILL TO\\\\c:f:11:cf:2\\ncell:B15:t:[Name]:f:1:cf:2:colspan:6\\ncell:B16:t:[Company Name]:f:1:cf:2:colspan:6\\ncell:F16:t:  \\ncell:B17:t:[Street Address]:f:1:cf:2:colspan:6\\ncell:B18:t:[City, State,  Zip]:f:1:cf:2:colspan:6\\ncell:B19:t:Phone\\\\c :f:1:cf:2:colspan:6\\ncell:B20:t:Email\\\\c:f:1:cf:2:colspan:6\\ncell:A22:b::1::\\ncell:B22:t:DESCRIPTION:b:1:1:1:1:l:1:f:14:c:1:bg:3:cf:1:colspan:5:rowspan:1\\ncell:C22:t::l:2:f:13\\ncell:D22:t::l:2:f:13\\ncell:E22:t::l:2:f:13\\ncell:F22:t::l:2:f:13\\ncell:G22:t:AMOUNT:b:1:1:1::l:1:f:14:c:1:bg:3:cf:1\\ncell:A23:b::1::\\ncell:B23:b:1:1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C23:t::l:2:f:4\\ncell:D23:t::l:2:f:4\\ncell:E23:t::l:2:f:4\\ncell:F23:t::b::2:::l:1:f:4\\ncell:G23:b::1::1:f:4:ntvf:1\\ncell:A24:b::1::\\ncell:B24:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C24:t::l:2:f:4\\ncell:D24:t::l:2:f:4\\ncell:E24:t::l:2:f:4\\ncell:F24:t::b::2:::l:1:f:4\\ncell:G24:b::1::1:f:4:ntvf:1\\ncell:A25:b::1::\\ncell:B25:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C25:t::l:2:f:4\\ncell:D25:t::l:2:f:4\\ncell:E25:t::l:2:f:4\\ncell:F25:t::b::2:::l:1:f:4\\ncell:G25:b::1::1:f:4:ntvf:1\\ncell:A26:b::1::\\ncell:B26:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C26:t::l:2:f:4\\ncell:D26:t::l:2:f:4\\ncell:E26:t::l:2:f:4\\ncell:F26:t::b::2:::l:1:f:4\\ncell:G26:b::1::1:f:4:ntvf:1\\ncell:A27:b::1::\\ncell:B27:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C27:t::l:2:f:4\\ncell:D27:t::l:2:f:4\\ncell:E27:t::l:2:f:4\\ncell:F27:t::b::2:::l:1:f:4\\ncell:G27:b::1::1:f:4:ntvf:1\\ncell:A28:b::1::\\ncell:B28:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C28:t::l:2:f:4\\ncell:D28:t::l:2:f:4\\ncell:E28:t::l:2:f:4\\ncell:F28:t::b::2:::l:1:f:4\\ncell:G28:b::1::1:f:4:ntvf:1\\ncell:A29:b::1::\\ncell:B29:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C29:t::l:2:f:4\\ncell:D29:t::l:2:f:4\\ncell:E29:t::l:2:f:4\\ncell:F29:t::b::2:::l:1:f:4\\ncell:G29:b::1::1:f:4:ntvf:1\\ncell:A30:b::1::\\ncell:B30:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C30:t::l:2:f:4\\ncell:D30:t::l:2:f:4\\ncell:E30:t::l:2:f:4\\ncell:F30:t::b::2:::l:1:f:4\\ncell:G30:b::1::1:f:4:ntvf:1\\ncell:A31:b::1::\\ncell:B31:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C31:t::l:2:f:4\\ncell:D31:t::l:2:f:4\\ncell:E31:t::l:2:f:4\\ncell:F31:t::b::2:::l:1:f:4\\ncell:G31:b::1::1:f:4:ntvf:1\\ncell:A32:b::1::\\ncell:B32:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C32:t::l:2:f:4\\ncell:D32:t::l:2:f:4\\ncell:E32:t::l:2:f:4\\ncell:F32:t::b::2:::l:1:f:4\\ncell:G32:b::1::1:f:4:ntvf:1\\ncell:A33:b::1::\\ncell:B33:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C33:t::l:2:f:4\\ncell:D33:t::l:2:f:4\\ncell:E33:t::l:2:f:4\\ncell:F33:t::b::2:::l:1:f:4\\ncell:G33:b::1::1:f:4:ntvf:1\\ncell:A34:b::1::\\ncell:B34:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C34:l:2:f:4\\ncell:D34:l:2:f:4\\ncell:E34:l:2:f:4\\ncell:F34:b::2:::l:1:f:4\\ncell:G34:b::1::1:f:4:ntvf:1\\ncell:A35:b::1::\\ncell:B35:b::1:1:1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C35:t::b:::2::l:1:f:4\\ncell:D35:t::b:::2::l:1:f:4\\ncell:E35:t::b:::2::l:1:f:4\\ncell:F35:t::b::2:2::l:1:f:4\\ncell:G35:b::1:1:1:f:4:ntvf:1\\ncell:B36:b:2::::l:1:f:13\\ncell:C36:b:2::::l:1:f:13\\ncell:D36:b:2::::l:1:f:13\\ncell:E36:b:2::::l:1:f:14\\ncell:F36:t:Subtotal:b:2::::l:1:f:11\\ncell:G36:vtf:n:0:SUM(G23\\\\cG35):b:1::::f:11:ntvf:1\\ncell:B37:t:NOTES:b:::1::l:1:f:14:cf:2:colspan:3:rowspan:1\\ncell:C37:t::b:::2::l:1:f:13\\ncell:D37:t::b:::2::l:1:f:13\\ncell:F37:t:Tax Rate:l:1:f:11\\ncell:G37:v:0:f:1:ntvf:2\\ncell:B38:b:1::::f:1:cf:2:colspan:3\\ncell:C38:t::b:2::::l:1:f:13\\ncell:D38:t::b:2::::l:1:f:13\\ncell:F38:t:Tax:l:1:f:11\\ncell:G38:vtf:n:0:G37*G36:f:1:ntvf:1\\ncell:B39:f:1:cf:2:colspan:3\\ncell:C39:t::l:2:f:13\\ncell:D39:t::l:2:f:13\\ncell:F39:t:Other:b:::1::l:1:f:11\\ncell:G39:v:0:b:::1::f:1:ntvf:1\\ncell:B40:b:::1::f:1:cf:2:colspan:3:rowspan:1\\ncell:C40:t::l:2:f:13\\ncell:D40:t::l:2:f:13\\ncell:F40:t:TOTAL:b:1::::l:1:f:14\\ncell:G40:vtf:n:0:(G36+G38)+G39:b:1::::f:11:ntvf:1\\ncell:B43:t:Thank you for your business:l:1:f:5:cf:1:colspan:6:rowspan:1\\ncell:C43:t::l:2:f:13\\ncell:D43:t::l:2:f:13\\ncell:E43:t::l:2:f:13\\ncell:F43:t::l:2:f:13\\ncell:G43:t::l:2:f:13\\ncol:A:w:10\\ncol:B:w:90\\ncol:C:w:19\\ncol:D:w:10\\ncol:E:w:16\\ncol:F:w:45\\ncol:G:w:64\\nrow:1:h:34.5\\nrow:2:h:34.5\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:14.25\\nrow:6:h:14.25\\nrow:7:h:14.25\\nrow:8:h:14.25\\nrow:9:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:16:h:14.25\\nrow:17:h:14.25\\nrow:18:h:14.25\\nrow:19:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nrow:24:h:14.25\\nrow:25:h:14.25\\nrow:26:h:14.25\\nrow:27:h:14.25\\nrow:28:h:14.25\\nrow:29:h:14.25\\nrow:30:h:14.25\\nrow:31:h:14.25\\nrow:32:h:14.25\\nrow:33:h:14.25\\nrow:34:h:14.25\\nrow:35:h:14.25\\nrow:36:h:14.25\\nrow:37:h:14.25\\nrow:38:h:14.25\\nrow:39:h:14.25\\nrow:40:h:14.25\\nrow:43:h:15.75\\nsheet:c:7:r:43:h:12.75:needsrecalc:yes\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\ncellformat:3:right\\ncolor:1:rgb(0, 0, 0)\\ncolor:2:rgb(0,0,0)\\ncolor:3:rgb(221, 221, 221)\\nfont:1:* * Trebuchet MS\\nfont:2:* 10pt *\\nfont:3:* 10pt Trebuchet MS\\nfont:4:* 9pt Trebuchet MS\\nfont:5:italic bold 10pt Trebuchet MS\\nfont:6:italic normal * Trebuchet MS\\nfont:7:normal bold 10pt Trebuchet MS\\nfont:8:normal bold 14pt Trebuchet MS\\nfont:9:normal bold 16pt Trebuchet MS\\nfont:10:normal bold 28pt Trebuchet MS\\nfont:11:normal normal * Trebuchet MS\\nfont:12:normal normal 10pt *\\nfont:13:normal normal 10pt Arial\\nfont:14:normal normal 10pt Trebuchet MS\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nvalueformat:1:#,##0.00\\nvalueformat:2:#,##0.00%\\nvalueformat:3:m/d/yy\\nvalueformat:4:text-html\\n\" }, \"name\": \"inv2\", \"hidden\": \"0\" }, \"sheet3\": { \"sheetstr\": { \"savestr\": \"version:1.5\\ncell:B2:t:INVOICE:l:1:f:12:cf:1:colspan:6\\ncell:C2:t::l:2:f:10\\ncell:D2:t::l:2:f:10\\ncell:E2:l:1:f:8:c:2:cf:3\\ncell:F2:t:INVOICE:l:1:f:7:c:2:cf:2:colspan:2\\ncell:G2:t::l:2:f:10\\ncell:B3:f:5:cf:2:colspan:4\\ncell:C3:t::l:2:f:10\\ncell:D3:t::l:2:f:10\\ncell:F3:l:1:f:6:cf:2\\ncell:G3:l:1:f:11:cf:2:ntvf:3\\ncell:B4:f:2:colspan:2\\ncell:F4:t:DATE\\\\c:l:1:f:11:cf:2\\ncell:G4:vtf:nd:42081:TODAY():l:1:f:11:cf:2:ntvf:3\\ncell:B5:t:INVOICE #\\\\c:f:9:colspan:6\\ncell:C5:cf:2:colspan:5\\ncell:F5:l:1:f:6:cf:2:colspan:2\\ncell:G5:l:1:f:11:cf:2\\ncell:B6:f:2:colspan:2\\ncell:F6:l:1:f:6:cf:2:colspan:2\\ncell:G6:l:1:f:11:cf:2\\ncell:B7:t:FROM\\\\c:f:11\\ncell:F7:l:1:f:6:cf:2:colspan:2\\ncell:G7:l:1:f:11:cf:2\\ncell:B8:t:[Company Name]:f:9:colspan:4\\ncell:F8:l:1:f:6:cf:2:tvf:4:colspan:2:rowspan:5\\ncell:G8:l:1:f:11:cf:2\\ncell:B9:t:[Street Address]:f:9:cf:2:colspan:4\\ncell:F9:l:1:f:6\\ncell:G9:l:1:f:11:cf:1\\ncell:B10:t:[City, State,  Zip]:f:9:cf:2:colspan:4\\ncell:G10:l:1:f:10\\ncell:B11:t:Phone\\\\c :f:9:cf:2:colspan:4\\ncell:B12:t:Email\\\\c:f:9:cf:2:colspan:4\\ncell:B13:colspan:2\\ncell:B14:t:BILL TO\\\\c:f:9:cf:2\\ncell:B15:t:[Name]:f:9:cf:2:colspan:6\\ncell:B16:t:[Company Name]:f:9:cf:2:colspan:6\\ncell:F16:t:  \\ncell:B17:t:[Street Address]:f:9:cf:2:colspan:6\\ncell:B18:t:[City, State,  Zip]:f:9:cf:2:colspan:6\\ncell:B19:t:Phone\\\\c :f:9:cf:2:colspan:6\\ncell:B20:t:Email\\\\c:f:9:cf:2:colspan:6\\ncell:A22:b::1::\\ncell:B22:t:DESCRIPTION:b:1:1:1:1:l:1:f:11:c:1:bg:3:cf:1:colspan:5:rowspan:1\\ncell:C22:t::l:2:f:10\\ncell:D22:t::l:2:f:10\\ncell:E22:t::l:2:f:10\\ncell:F22:t::l:2:f:10\\ncell:G22:t:AMOUNT:b:1:1:1::l:1:f:11:c:1:bg:3:cf:1\\ncell:A23:b::1::\\ncell:B23:vtf:t: :IF(AND(ISBLANK(inv3!B6),ISBLANK(sheet7!B6)), \\\" \\\", IF(ISBLANK(inv3!B6), sheet7!B6, inv3!B6)):b:1:1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C23:t::l:2:f:3\\ncell:D23:t::l:2:f:3\\ncell:E23:t::l:2:f:3\\ncell:F23:t::b::2:::l:1:f:3\\ncell:G23:vtf:t: :IF(AND(ISBLANK(inv3!B6),ISBLANK(sheet7!B6)), \\\" \\\", IF(ISBLANK(inv3!B6), (sheet7!E6*sheet7!F6), (inv3!E6*inv3!F6))):b::1::1:f:3:ntvf:1\\ncell:A24:b::1::\\ncell:B24:vtf:t: :IF(AND(ISBLANK(INV3!B7),ISBLANK(SHEET7!B7)), \\\" \\\", IF(ISBLANK(INV3!B7), SHEET7!B7, INV3!B7)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C24:t::l:2:f:3\\ncell:D24:t::l:2:f:3\\ncell:E24:t::l:2:f:3\\ncell:F24:t::b::2:::l:1:f:3\\ncell:G24:vtf:t: :IF(AND(ISBLANK(INV3!B7),ISBLANK(SHEET7!B7)), \\\" \\\", IF(ISBLANK(INV3!B7), (SHEET7!E7*SHEET7!F7), (INV3!E7*INV3!F7))):b::1::1:f:3:ntvf:1\\ncell:A25:b::1::\\ncell:B25:vtf:t: :IF(AND(ISBLANK(INV3!B8),ISBLANK(SHEET7!B8)), \\\" \\\", IF(ISBLANK(INV3!B8), SHEET7!B8, INV3!B8)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C25:t::l:2:f:3\\ncell:D25:t::l:2:f:3\\ncell:E25:t::l:2:f:3\\ncell:F25:t::b::2:::l:1:f:3\\ncell:G25:vtf:t: :IF(AND(ISBLANK(INV3!B8),ISBLANK(SHEET7!B8)), \\\" \\\", IF(ISBLANK(INV3!B8), (SHEET7!E8*SHEET7!F8), (INV3!E8*INV3!F8))):b::1::1:f:3:ntvf:1\\ncell:A26:b::1::\\ncell:B26:vtf:t: :IF(AND(ISBLANK(INV3!B9),ISBLANK(SHEET7!B9)), \\\" \\\", IF(ISBLANK(INV3!B9), SHEET7!B9, INV3!B9)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C26:t::l:2:f:3\\ncell:D26:t::l:2:f:3\\ncell:E26:t::l:2:f:3\\ncell:F26:t::b::2:::l:1:f:3\\ncell:G26:vtf:t: :IF(AND(ISBLANK(INV3!B9),ISBLANK(SHEET7!B9)), \\\" \\\", IF(ISBLANK(INV3!B9), (SHEET7!E9*SHEET7!F9), (INV3!E9*INV3!F9))):b::1::1:f:3:ntvf:1\\ncell:A27:b::1::\\ncell:B27:vtf:t: :IF(AND(ISBLANK(INV3!B10),ISBLANK(SHEET7!B10)), \\\" \\\", IF(ISBLANK(INV3!B10), SHEET7!B10, INV3!B10)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C27:t::l:2:f:3\\ncell:D27:t::l:2:f:3\\ncell:E27:t::l:2:f:3\\ncell:F27:t::b::2:::l:1:f:3\\ncell:G27:vtf:t: :IF(AND(ISBLANK(INV3!B10),ISBLANK(SHEET7!B10)), \\\" \\\", IF(ISBLANK(INV3!B10), (SHEET7!E10*SHEET7!F10), (INV3!E10*INV3!F10))):b::1::1:f:3:ntvf:1\\ncell:A28:b::1::\\ncell:B28:vtf:t: :IF(AND(ISBLANK(INV3!B11),ISBLANK(SHEET7!B11)), \\\" \\\", IF(ISBLANK(INV3!B11), SHEET7!B11, INV3!B11)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C28:t::l:2:f:3\\ncell:D28:t::l:2:f:3\\ncell:E28:t::l:2:f:3\\ncell:F28:t::b::2:::l:1:f:3\\ncell:G28:vtf:t: :IF(AND(ISBLANK(INV3!B11),ISBLANK(SHEET7!B11)), \\\" \\\", IF(ISBLANK(INV3!B11), (SHEET7!E11*SHEET7!F11), (INV3!E11*INV3!F11))):b::1::1:f:3:ntvf:1\\ncell:A29:b::1::\\ncell:B29:vtf:t: :IF(AND(ISBLANK(INV3!B12),ISBLANK(SHEET7!B12)), \\\" \\\", IF(ISBLANK(INV3!B12), SHEET7!B12, INV3!B12)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C29:t::l:2:f:3\\ncell:D29:t::l:2:f:3\\ncell:E29:t::l:2:f:3\\ncell:F29:t::b::2:::l:1:f:3\\ncell:G29:vtf:t: :IF(AND(ISBLANK(INV3!B12),ISBLANK(SHEET7!B12)), \\\" \\\", IF(ISBLANK(INV3!B12), (SHEET7!E12*SHEET7!F12), (INV3!E12*INV3!F12))):b::1::1:f:3:ntvf:1\\ncell:A30:b::1::\\ncell:B30:vtf:t: :IF(AND(ISBLANK(INV3!B13),ISBLANK(SHEET7!B13)), \\\" \\\", IF(ISBLANK(INV3!B13), SHEET7!B13, INV3!B13)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C30:t::l:2:f:3\\ncell:D30:t::l:2:f:3\\ncell:E30:t::l:2:f:3\\ncell:F30:t::b::2:::l:1:f:3\\ncell:G30:vtf:t: :IF(AND(ISBLANK(INV3!B13),ISBLANK(SHEET7!B13)), \\\" \\\", IF(ISBLANK(INV3!B13), (SHEET7!E13*SHEET7!F13), (INV3!E13*INV3!F13))):b::1::1:f:3:ntvf:1\\ncell:A31:b::1::\\ncell:B31:vtf:t: :IF(AND(ISBLANK(INV3!B14),ISBLANK(SHEET7!B14)), \\\" \\\", IF(ISBLANK(INV3!B14), SHEET7!B14, INV3!B14)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C31:t::l:2:f:3\\ncell:D31:t::l:2:f:3\\ncell:E31:t::l:2:f:3\\ncell:F31:t::b::2:::l:1:f:3\\ncell:G31:vtf:t: :IF(AND(ISBLANK(INV3!B14),ISBLANK(SHEET7!B14)), \\\" \\\", IF(ISBLANK(INV3!B14), (SHEET7!E14*SHEET7!F14), (INV3!E14*INV3!F14))):b::1::1:f:3:ntvf:1\\ncell:A32:b::1::\\ncell:B32:vtf:t: :IF(AND(ISBLANK(INV3!B15),ISBLANK(SHEET7!B15)), \\\" \\\", IF(ISBLANK(INV3!B15), SHEET7!B15, INV3!B15)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C32:t::l:2:f:3\\ncell:D32:t::l:2:f:3\\ncell:E32:t::l:2:f:3\\ncell:F32:t::b::2:::l:1:f:3\\ncell:G32:vtf:t: :IF(AND(ISBLANK(INV3!B15),ISBLANK(SHEET7!B15)), \\\" \\\", IF(ISBLANK(INV3!B15), (SHEET7!E15*SHEET7!F15), (INV3!E15*INV3!F15))):b::1::1:f:3:ntvf:1\\ncell:A33:b::1::\\ncell:B33:vtf:t: :IF(AND(ISBLANK(INV3!B16),ISBLANK(SHEET7!B16)), \\\" \\\", IF(ISBLANK(INV3!B16), SHEET7!B16, INV3!B16)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C33:l:2:f:3\\ncell:D33:l:2:f:3\\ncell:E33:l:2:f:3\\ncell:F33:b::2:::l:1:f:3\\ncell:G33:vtf:t: :IF(AND(ISBLANK(INV3!B16),ISBLANK(SHEET7!B16)), \\\" \\\", IF(ISBLANK(INV3!B16), (SHEET7!E16*SHEET7!F16), (INV3!E16*INV3!F16))):b::1::1:f:3:ntvf:1\\ncell:A34:b::1::\\ncell:B34:vtf:t: :IF(AND(ISBLANK(INV3!B17),ISBLANK(SHEET7!B17)), \\\" \\\", IF(ISBLANK(INV3!B17), SHEET7!B17, INV3!B17)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C34:t::l:2:f:3\\ncell:D34:t::l:2:f:3\\ncell:E34:t::l:2:f:3\\ncell:F34:t::b::2:::l:1:f:3\\ncell:G34:vtf:t: :IF(AND(ISBLANK(INV3!B17),ISBLANK(SHEET7!B17)), \\\" \\\", IF(ISBLANK(INV3!B17), (SHEET7!E17*SHEET7!F17), (INV3!E17*INV3!F17))):b::1::1:f:3:ntvf:1\\ncell:A35:b::1::\\ncell:B35:vtf:t: :IF(AND(ISBLANK(INV3!B18),ISBLANK(SHEET7!B18)), \\\" \\\", IF(ISBLANK(INV3!B18), SHEET7!B18, INV3!B18)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C35:t::b:::2::l:1:f:3\\ncell:D35:t::b:::2::l:1:f:3\\ncell:E35:t::b:::2::l:1:f:3\\ncell:F35:t::b::2:2::l:1:f:3\\ncell:G35:vtf:t: :IF(AND(ISBLANK(INV3!B18),ISBLANK(SHEET7!B18)), \\\" \\\", IF(ISBLANK(INV3!B18), (SHEET7!E18*SHEET7!F18), (INV3!E18*INV3!F18))):b::1::1:f:3:ntvf:1\\ncell:B36:b:2::::l:1:f:10\\ncell:C36:b:2::::l:1:f:10\\ncell:D36:b:2::::l:1:f:10\\ncell:E36:b:2::::l:1:f:11\\ncell:F36:t:Subtotal:b:2::::l:1:f:9\\ncell:G36:vtf:n:0:SUM(G23\\\\cG35):b:1::::f:9:ntvf:1\\ncell:B37:t:NOTES:b:::1::l:1:f:11:cf:2:colspan:3:rowspan:1\\ncell:C37:t::b:::2::l:1:f:10\\ncell:D37:t::b:::2::l:1:f:10\\ncell:F37:t:Tax Rate:l:1:f:9\\ncell:G37:v:0:f:1:ntvf:2\\ncell:B38:b:1::::f:1:cf:2:colspan:3\\ncell:C38:t::b:2::::l:1:f:10\\ncell:D38:t::b:2::::l:1:f:10\\ncell:F38:t:Tax:l:1:f:9\\ncell:G38:vtf:n:0:G37*G36:f:1:ntvf:1\\ncell:B39:f:1:cf:2:colspan:3\\ncell:C39:t::l:2:f:10\\ncell:D39:t::l:2:f:10\\ncell:F39:t:Other:b:::1::l:1:f:9\\ncell:G39:v:0:b:::1::f:1:ntvf:1\\ncell:B40:b:::1::f:1:cf:2:colspan:3:rowspan:1\\ncell:C40:t::l:2:f:10\\ncell:D40:t::l:2:f:10\\ncell:F40:t:TOTAL:b:1::::l:1:f:11\\ncell:G40:vtf:n:0:(G36+G38)+G39:b:1::::f:9:ntvf:1\\ncell:B43:t:Thank you for your business:l:1:f:4:cf:1:colspan:6:rowspan:1\\ncell:C43:t::l:2:f:10\\ncell:D43:t::l:2:f:10\\ncell:E43:t::l:2:f:10\\ncell:F43:t::l:2:f:10\\ncell:G43:t::l:2:f:10\\ncol:A:w:10\\ncol:B:w:65\\ncol:C:w:19\\ncol:D:w:10\\ncol:E:w:16\\ncol:F:w:53\\ncol:G:w:64\\nrow:1:h:34.5\\nrow:2:h:34.5\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:14.25\\nrow:6:h:14.25\\nrow:7:h:14.25\\nrow:8:h:14.25\\nrow:9:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:16:h:14.25\\nrow:17:h:14.25\\nrow:18:h:14.25\\nrow:19:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nrow:24:h:14.25\\nrow:25:h:14.25\\nrow:26:h:14.25\\nrow:27:h:14.25\\nrow:28:h:14.25\\nrow:29:h:14.25\\nrow:30:h:14.25\\nrow:31:h:14.25\\nrow:32:h:14.25\\nrow:33:h:14.25\\nrow:34:h:14.25\\nrow:35:h:14.25\\nrow:36:h:14.25\\nrow:37:h:14.25\\nrow:38:h:14.25\\nrow:39:h:14.25\\nrow:40:h:14.25\\nrow:43:h:15.75\\nsheet:c:7:r:43:h:12.75:needsrecalc:yes\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\ncellformat:3:right\\ncolor:1:rgb(0, 0, 0)\\ncolor:2:rgb(0,0,0)\\ncolor:3:rgb(221, 221, 221)\\nfont:1:* * Trebuchet MS\\nfont:2:* 10pt *\\nfont:3:* 9pt Trebuchet MS\\nfont:4:italic bold 10pt Trebuchet MS\\nfont:5:italic normal * Trebuchet MS\\nfont:6:normal bold 10pt Trebuchet MS\\nfont:7:normal bold 14pt Trebuchet MS\\nfont:8:normal bold 28pt Trebuchet MS\\nfont:9:normal normal * Trebuchet MS\\nfont:10:normal normal 10pt Arial\\nfont:11:normal normal 10pt Trebuchet MS\\nfont:12:normal normal 16pt Trebuchet MS\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nvalueformat:1:#,##0.00\\nvalueformat:2:#,##0.00%\\nvalueformat:3:m/d/yy\\nvalueformat:4:text-html\\n\" }, \"name\": \"sheet6\", \"hidden\": \"0\" }, \"sheet4\": { \"sheetstr\": { \"savestr\": \"version:1.5\\ncell:B1:b:::2::l:1:f:7\\ncell:C1:b:::2::l:1:f:7\\ncell:D1:b:::2::l:1:f:7\\ncell:E1:b:::2::l:1:f:7\\ncell:F1:b:::2::l:1:f:7\\ncell:A2:b::2:::l:1:f:7\\ncell:B2:t:INVOICE DETAILS:b:1:1:1:1:l:1:f:8:cf:1:colspan:5\\ncell:C2:t::b:2::2::l:1:f:7\\ncell:D2:t::b:2::2::l:1:f:7\\ncell:E2:t::b:2::2::l:1:f:7\\ncell:F2:b:2:1:1::l:1:f:7\\ncell:G2:b::::1\\ncell:A3:b::2:::l:3:f:7\\ncell:B3:b:2::::l:1:f:7\\ncell:C3:b:2::::l:1:f:7\\ncell:D3:b:2::::l:1:f:7\\ncell:E3:b:2::::l:1:f:7\\ncell:F3:b:1:1:::l:1:f:7\\ncell:G3:b::::1\\ncell:A4:b::2:::l:3:f:7\\ncell:B4:b:::2::l:1:f:7\\ncell:C4:b:::2::l:3:f:4:cf:2\\ncell:D4:b:::2::l:1:f:7\\ncell:E4:b:::2::l:1:f:7\\ncell:F4:b::1:1::l:1:f:7\\ncell:G4:b::::1\\ncell:A5:b::2:::l:3:f:7\\ncell:B5:t:Description:b:1:1:1:1:f:6:cf:1:colspan:3\\ncell:C5:t:Description:b:2::2:2:l:3:f:4:cf:2:colspan:2:rowspan:1\\ncell:D5:t::b:2:2:2::l:1:f:7\\ncell:E5:t:Hours:b:1:1:1:1:f:6:cf:1\\ncell:F5:t:Rate:b:1:1:1:1:f:6:cf:1\\ncell:G5:b::::1\\ncell:A6:b::2:::l:3:f:7\\ncell:B6:b:1:1::1:f:1:cf:2:colspan:3\\ncell:C6:b:1:1::1:l:3:f:7:cf:2:colspan:2:rowspan:1\\ncell:D6:t::b:2:2:2::l:1:f:7\\ncell:E6:b:1:1:::f:1:ntvf:1\\ncell:F6:b:1:1:::f:1:ntvf:1\\ncell:G6:b::::1\\ncell:A7:b::2:::l:3:f:7\\ncell:B7:b::1::1:f:1:cf:2:colspan:3\\ncell:C7:b::1::1:l:1:f:7:colspan:2\\ncell:D7:l:1:f:7\\ncell:E7:b::1:::f:1:ntvf:1\\ncell:F7:b::1:::f:1:ntvf:1\\ncell:G7:b::::1\\ncell:A8:b::2:::l:3:f:7\\ncell:B8:b::1::1:f:1:cf:2:colspan:3\\ncell:C8:b::1::1:colspan:2\\ncell:E8:b::1:::f:1:ntvf:1\\ncell:F8:b::1:::f:1:ntvf:1\\ncell:G8:b::::1\\ncell:A9:b::2:::l:3:f:7\\ncell:B9:b::1::1:f:1:cf:2:colspan:3\\ncell:C9:b::1::1:colspan:2\\ncell:E9:b::1:::f:1:ntvf:1\\ncell:F9:b::1:::f:1:ntvf:1\\ncell:G9:b::::1\\ncell:A10:b::2:::l:3:f:7\\ncell:B10:b::1::1:f:1:cf:2:colspan:3\\ncell:C10:b::1::1:colspan:2\\ncell:E10:b::1:::f:1:ntvf:1\\ncell:F10:b::1:::f:1:ntvf:1\\ncell:G10:b::::1\\ncell:A11:b::2:::l:3:f:7\\ncell:B11:b::1::1:f:1:cf:2:colspan:3\\ncell:C11:b::1::1:colspan:2\\ncell:E11:b::1:::f:1:ntvf:1\\ncell:F11:b::1:::f:1:ntvf:1\\ncell:G11:b::::1\\ncell:A12:b::2:::l:3:f:7\\ncell:B12:b::1::1:f:1:cf:2:colspan:3\\ncell:C12:b::1::1:colspan:2\\ncell:E12:b::1:::f:1:ntvf:1\\ncell:F12:b::1:::f:1:ntvf:1\\ncell:G12:b::::1\\ncell:A13:b::2:::l:3:f:7\\ncell:B13:b::1::1:f:1:cf:2:colspan:3\\ncell:C13:b::1::1:colspan:2\\ncell:E13:b::1:::f:1:ntvf:1\\ncell:F13:b::1:::f:1:ntvf:1\\ncell:G13:b::::1\\ncell:A14:b::2:::l:3:f:7\\ncell:B14:b::1::1:f:1:cf:2:colspan:3\\ncell:C14:b::1::1:colspan:2\\ncell:E14:b::1:::f:1:ntvf:1\\ncell:F14:b::1:::f:1:ntvf:1\\ncell:G14:b::::1\\ncell:A15:b::2:::l:3:f:7\\ncell:B15:b::1::1:f:1:cf:2:colspan:3\\ncell:C15:b::1::1:colspan:2\\ncell:E15:b::1:::f:1:ntvf:1\\ncell:F15:b::1:::f:1:ntvf:1\\ncell:G15:b::::1\\ncell:A16:b::2:::l:3:f:7\\ncell:B16:b::1::1:f:1:cf:2:colspan:3\\ncell:C16:b::1::1:colspan:2\\ncell:E16:b::1:::f:1:ntvf:1\\ncell:F16:b::1:::f:1:ntvf:1\\ncell:G16:b::::1\\ncell:A17:b::2:::l:3:f:7\\ncell:B17:b::1::1:f:1:cf:2:colspan:3\\ncell:C17:b::1::1:colspan:2\\ncell:E17:b::1:::f:1:ntvf:1\\ncell:F17:b::1:::f:1:ntvf:1\\ncell:G17:b::::1\\ncell:A18:b::2:::l:3:f:5\\ncell:B18:b::1:1:1:f:1:cf:2:colspan:3\\ncell:C18:b::1:1:1:l:3:f:7:cf:2:colspan:2\\ncell:D18:b:::2::l:3:f:7:cf:2\\ncell:E18:b::1:1::f:1:ntvf:1\\ncell:F18:b::1:1::f:1:ntvf:1\\ncell:G18:b::::1\\ncell:A19:b::2:::l:3:f:7\\ncell:F19:b::1::\\ncell:G19:b::::1\\ncell:A20:b::2:::l:3:f:7\\ncell:F20:b::1::\\ncell:G20:b::::1\\ncell:A21:b::2:::l:3:f:7\\ncell:C21:t:Thank you for your business:b::1:::f:3:colspan:4\\ncell:D21:t:Thank you for your business:f:2:colspan:4\\ncell:E21:t::l:2:f:7\\ncell:F21:l:2:f:7\\ncell:G21:b::::1\\ncell:A22:b::2:::l:3:f:7\\ncell:F22:b::1::\\ncell:G22:b::::1\\ncell:A23:b::2:::l:3:f:7\\ncell:B23:b:::2::l:3:f:7\\ncell:C23:b:::2::l:3:f:7\\ncell:D23:b:::2::l:3:f:7\\ncell:E23:b:::2::l:3:f:7\\ncell:F23:b::1:1::l:3:f:7\\ncell:G23:b::::1\\ncell:B24:b:1:::\\ncell:C24:b:1:::\\ncell:D24:b:1:::\\ncell:E24:b:1:::\\ncell:F24:b:1:::\\ncol:A:w:10\\ncol:B:w:42\\ncol:C:w:56\\ncol:D:w:39\\ncol:E:w:48\\ncol:F:w:57\\nrow:1:h:14.25\\nrow:2:h:18.75\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:14.25\\nrow:6:h:14.25\\nrow:7:h:14.25\\nrow:8:h:14.25\\nrow:9:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:13:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:16:h:14.25\\nrow:17:h:14.25\\nrow:18:h:15.75\\nrow:19:h:14.25\\nrow:20:h:14.25\\nrow:21:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nsheet:c:7:r:24:h:12.75:needsrecalc:yes\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\nfont:1:* * Trebuchet MS\\nfont:2:italic bold * Trebuchet MS\\nfont:3:italic bold 10pt Trebuchet MS\\nfont:4:normal bold 10pt Arial\\nfont:5:normal bold 12pt Arial\\nfont:6:normal normal * Trebuchet MS\\nfont:7:normal normal 10pt Arial\\nfont:8:normal normal 16pt Arial\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nlayout:3:padding:* * * *;vertical-align:top;\\nvalueformat:1:#,##0.00\\n\" }, \"name\": \"inv3\", \"hidden\": \"0\" }, \"sheet5\": { \"sheetstr\": { \"savestr\": \"version:1.5\\ncell:B1:b:::2::l:1:f:7\\ncell:C1:b:::2::l:1:f:7\\ncell:D1:b:::2::l:1:f:7\\ncell:E1:b:::2::l:1:f:7\\ncell:F1:b:::2::l:1:f:7\\ncell:A2:b::2:::l:1:f:7\\ncell:B2:t:INVOICE DETAILS:b:1:1:1:1:l:1:f:8:cf:1:colspan:5\\ncell:C2:t::b:2::2::l:1:f:7\\ncell:D2:t::b:2::2::l:1:f:7\\ncell:E2:t::b:2::2::l:1:f:7\\ncell:F2:b:2:1:1::l:1:f:7\\ncell:G2:b::::1\\ncell:A3:b::2:::l:3:f:7\\ncell:B3:b:2::::l:1:f:7\\ncell:C3:b:2::::l:1:f:7\\ncell:D3:b:2::::l:1:f:7\\ncell:E3:b:2::::l:1:f:7\\ncell:F3:b:1:1:::l:1:f:7\\ncell:G3:b::::1\\ncell:A4:b::2:::l:3:f:7\\ncell:B4:b:::2::l:1:f:7\\ncell:C4:b:::2::l:3:f:4:cf:2\\ncell:D4:b:::2::l:1:f:7\\ncell:E4:b:::2::l:1:f:7\\ncell:F4:b::1:1::l:1:f:7\\ncell:G4:b::::1\\ncell:A5:b::2:::l:3:f:7\\ncell:B5:t:Description:b:1:1:1:1:f:6:cf:1:colspan:3\\ncell:C5:t:Description:b:2::2:2:l:3:f:4:cf:2:colspan:2:rowspan:1\\ncell:D5:t::b:2:2:2::l:1:f:7\\ncell:E5:t:Qty.:b:1:1:1:1:f:6:cf:1\\ncell:F5:t:Price:b:1:1:1:1:f:6:cf:1\\ncell:G5:b::::1\\ncell:A6:b::2:::l:3:f:7\\ncell:B6:b:1:1::1:f:1:cf:2:colspan:3\\ncell:C6:b:1:1::1:l:3:f:7:cf:2:colspan:2:rowspan:1\\ncell:D6:t::b:2:2:2::l:1:f:7\\ncell:E6:b:1:1:::f:1:ntvf:1\\ncell:F6:b:1:1:::f:1:ntvf:1\\ncell:G6:b::::1\\ncell:A7:b::2:::l:3:f:7\\ncell:B7:b::1::1:f:1:cf:2:colspan:3\\ncell:C7:b::1::1:l:1:f:7:colspan:2\\ncell:D7:l:1:f:7\\ncell:E7:b::1:::f:1:ntvf:1\\ncell:F7:b::1:::f:1:ntvf:1\\ncell:G7:b::::1\\ncell:A8:b::2:::l:3:f:7\\ncell:B8:b::1::1:f:1:cf:2:colspan:3\\ncell:C8:b::1::1:colspan:2\\ncell:E8:b::1:::f:1:ntvf:1\\ncell:F8:b::1:::f:1:ntvf:1\\ncell:G8:b::::1\\ncell:A9:b::2:::l:3:f:7\\ncell:B9:b::1::1:f:1:cf:2:colspan:3\\ncell:C9:b::1::1:colspan:2\\ncell:E9:b::1:::f:1:ntvf:1\\ncell:F9:b::1:::f:1:ntvf:1\\ncell:G9:b::::1\\ncell:A10:b::2:::l:3:f:7\\ncell:B10:b::1::1:f:1:cf:2:colspan:3\\ncell:C10:b::1::1:colspan:2\\ncell:E10:b::1:::f:1:ntvf:1\\ncell:F10:b::1:::f:1:ntvf:1\\ncell:G10:b::::1\\ncell:A11:b::2:::l:3:f:7\\ncell:B11:b::1::1:f:1:cf:2:colspan:3\\ncell:C11:b::1::1:colspan:2\\ncell:E11:b::1:::f:1:ntvf:1\\ncell:F11:b::1:::f:1:ntvf:1\\ncell:G11:b::::1\\ncell:A12:b::2:::l:3:f:7\\ncell:B12:b::1::1:f:1:cf:2:colspan:3\\ncell:C12:b::1::1:colspan:2\\ncell:E12:b::1:::f:1:ntvf:1\\ncell:F12:b::1:::f:1:ntvf:1\\ncell:G12:b::::1\\ncell:A13:b::2:::l:3:f:7\\ncell:B13:b::1::1:f:1:cf:2:colspan:3\\ncell:C13:b::1::1:colspan:2\\ncell:E13:b::1:::f:1:ntvf:1\\ncell:F13:b::1:::f:1:ntvf:1\\ncell:G13:b::::1\\ncell:A14:b::2:::l:3:f:7\\ncell:B14:b::1::1:f:1:cf:2:colspan:3\\ncell:C14:b::1::1:colspan:2\\ncell:E14:b::1:::f:1:ntvf:1\\ncell:F14:b::1:::f:1:ntvf:1\\ncell:G14:b::::1\\ncell:A15:b::2:::l:3:f:7\\ncell:B15:b::1::1:f:1:cf:2:colspan:3\\ncell:C15:b::1::1:colspan:2\\ncell:E15:b::1:::f:1:ntvf:1\\ncell:F15:b::1:::f:1:ntvf:1\\ncell:G15:b::::1\\ncell:A16:b::2:::l:3:f:7\\ncell:B16:b::1::1:f:1:cf:2:colspan:3\\ncell:C16:b::1::1:colspan:2\\ncell:E16:b::1:::f:1:ntvf:1\\ncell:F16:b::1:::f:1:ntvf:1\\ncell:G16:b::::1\\ncell:A17:b::2:::l:3:f:7\\ncell:B17:b::1::1:f:1:cf:2:colspan:3\\ncell:C17:b::1::1:colspan:2\\ncell:E17:b::1:::f:1:ntvf:1\\ncell:F17:b::1:::f:1:ntvf:1\\ncell:G17:b::::1\\ncell:A18:b::2:::l:3:f:5\\ncell:B18:b::1:1:1:f:1:cf:2:colspan:3\\ncell:C18:b::1:1:1:l:3:f:7:cf:2:colspan:2\\ncell:D18:b:::2::l:3:f:7:cf:2\\ncell:E18:b::1:1::f:1:ntvf:1\\ncell:F18:b::1:1::f:1:ntvf:1\\ncell:G18:b::::1\\ncell:A19:b::2:::l:3:f:7\\ncell:F19:b::1::\\ncell:G19:b::::1\\ncell:A20:b::2:::l:3:f:7\\ncell:F20:b::1::\\ncell:G20:b::::1\\ncell:A21:b::2:::l:3:f:7\\ncell:C21:t:Thank you for your business:b::1:::f:3:colspan:4\\ncell:D21:t:Thank you for your business:f:2:colspan:4\\ncell:E21:t::l:2:f:7\\ncell:F21:l:2:f:7\\ncell:G21:b::::1\\ncell:A22:b::2:::l:3:f:7\\ncell:F22:b::1::\\ncell:G22:b::::1\\ncell:A23:b::2:::l:3:f:7\\ncell:B23:b:::2::l:3:f:7\\ncell:C23:b:::2::l:3:f:7\\ncell:D23:b:::2::l:3:f:7\\ncell:E23:b:::2::l:3:f:7\\ncell:F23:b::1:1::l:3:f:7\\ncell:G23:b::::1\\ncell:B24:b:1:::\\ncell:C24:b:1:::\\ncell:D24:b:1:::\\ncell:E24:b:1:::\\ncell:F24:b:1:::\\ncol:A:w:10\\ncol:B:w:42\\ncol:C:w:56\\ncol:D:w:39\\ncol:E:w:48\\ncol:F:w:57\\nrow:1:h:14.25\\nrow:2:h:18.75\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:14.25\\nrow:6:h:14.25\\nrow:7:h:14.25\\nrow:8:h:14.25\\nrow:9:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:13:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:16:h:14.25\\nrow:17:h:14.25\\nrow:18:h:15.75\\nrow:19:h:14.25\\nrow:20:h:14.25\\nrow:21:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nsheet:c:7:r:24:h:12.75:needsrecalc:yes\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\nfont:1:* * Trebuchet MS\\nfont:2:italic bold * Trebuchet MS\\nfont:3:italic bold 10pt Trebuchet MS\\nfont:4:normal bold 10pt Arial\\nfont:5:normal bold 12pt Arial\\nfont:6:normal normal * Trebuchet MS\\nfont:7:normal normal 10pt Arial\\nfont:8:normal normal 16pt Arial\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nlayout:3:padding:* * * *;vertical-align:top;\\nvalueformat:1:#,##0.00\\n\" }, \"name\": \"sheet7\", \"hidden\": \"0\" } }, \"EditableCells\": { \"allow\": true, \"cells\": { \"inv1!B2\": true, \"inv1!C5\": true, \"inv1!C6\": true, \"inv1!C7\": true, \"inv1!C8\": true, \"inv1!C9\": true, \"inv1!C11\": true, \"inv1!C12\": true, \"inv1!C13\": true, \"inv1!C14\": true, \"inv1!C15\": true, \"inv1!C16\": true, \"inv1!C18\": true, \"inv1!C20\": true, \"inv1!D20\": true, \"inv1!C23\": true, \"inv1!C24\": true, \"inv1!C25\": true, \"inv1!C26\": true, \"inv1!C27\": true, \"inv1!C28\": true, \"inv1!C29\": true, \"inv1!C30\": true, \"inv1!C31\": true, \"inv1!C32\": true, \"inv1!C33\": true, \"inv1!C34\": true, \"inv1!C35\": true, \"inv1!F23\": true, \"inv1!F24\": true, \"inv1!F25\": true, \"inv1!F26\": true, \"inv1!F27\": true, \"inv1!F28\": true, \"inv1!F29\": true, \"inv1!F30\": true, \"inv1!F31\": true, \"inv1!F32\": true, \"inv1!F33\": true, \"inv1!F34\": true, \"inv1!F35\": true, \"inv2!B2\": true, \"inv2!F4\": true, \"inv2!G4\": true, \"inv2!B5\": true, \"inv2!B7\": true, \"inv2!B8\": true, \"inv2!B9\": true, \"inv2!B10\": true, \"inv2!B11\": true, \"inv2!B12\": true, \"inv2!B14\": true, \"inv2!B15\": true, \"inv2!B16\": true, \"inv2!B17\": true, \"inv2!B18\": true, \"inv2!B19\": true, \"inv2!B20\": true, \"inv2!B23\": true, \"inv2!B24\": true, \"inv2!B25\": true, \"inv2!B26\": true, \"inv2!B27\": true, \"inv2!B28\": true, \"inv2!B29\": true, \"inv2!B30\": true, \"inv2!B31\": true, \"inv2!B32\": true, \"inv2!B33\": true, \"inv2!B34\": true, \"inv2!B35\": true, \"inv2!G23\": true, \"inv2!G24\": true, \"inv2!G25\": true, \"inv2!G26\": true, \"inv2!G27\": true, \"inv2!G28\": true, \"inv2!G29\": true, \"inv2!G30\": true, \"inv2!G31\": true, \"inv2!G32\": true, \"inv2!G33\": true, \"inv2!G34\": true, \"inv2!G35\": true, \"inv2!B38\": true, \"inv2!B39\": true, \"inv2!B40\": true, \"inv2!F36\": true, \"inv2!G37\": true, \"inv2!F37\": true, \"inv2!F39\": true, \"inv2!G39\": true, \"inv2!F38\": true, \"sheet6!B2\": true, \"sheet6!F4\": true, \"sheet6!G4\": true, \"sheet6!B5\": true, \"sheet6!B7\": true, \"sheet6!B8\": true, \"sheet6!B9\": true, \"sheet6!B10\": true, \"sheet6!B11\": true, \"sheet6!B12\": true, \"sheet6!B14\": true, \"sheet6!B15\": true, \"sheet6!B16\": true, \"sheet6!B17\": true, \"sheet6!B18\": true, \"sheet6!B19\": true, \"sheet6!B20\": true, \"sheet6!B38\": true, \"sheet6!B39\": true, \"sheet6!B40\": true, \"sheet6!F36\": true, \"sheet6!G37\": true, \"sheet6!F37\": true, \"sheet6!F39\": true, \"sheet6!G39\": true, \"sheet6!F38\": true, \"inv3!B2\": true, \"inv3!B6\": true, \"inv3!B7\": true, \"inv3!B8\": true, \"inv3!B9\": true, \"inv3!B10\": true, \"inv3!B11\": true, \"inv3!B12\": true, \"inv3!B13\": true, \"inv3!B14\": true, \"inv3!B15\": true, \"inv3!B16\": true, \"inv3!B17\": true, \"inv3!B18\": true, \"inv3!E6\": true, \"inv3!E7\": true, \"inv3!E8\": true, \"inv3!E9\": true, \"inv3!E10\": true, \"inv3!E11\": true, \"inv3!E12\": true, \"inv3!E13\": true, \"inv3!E14\": true, \"inv3!E15\": true, \"inv3!E16\": true, \"inv3!E17\": true, \"inv3!E18\": true, \"inv3!F6\": true, \"inv3!F7\": true, \"inv3!F8\": true, \"inv3!F9\": true, \"inv3!F10\": true, \"inv3!F11\": true, \"inv3!F12\": true, \"inv3!F13\": true, \"inv3!F14\": true, \"inv3!F15\": true, \"inv3!F16\": true, \"inv3!F17\": true, \"inv3!F18\": true, \"sheet7!F6\": true, \"sheet7!F7\": true, \"sheet7!F8\": true, \"sheet7!F9\": true, \"sheet7!F10\": true, \"sheet7!F11\": true, \"sheet7!F12\": true, \"sheet7!F13\": true, \"sheet7!F14\": true, \"sheet7!F15\": true, \"sheet7!F16\": true, \"sheet7!F17\": true, \"sheet7!F18\": true, \"sheet7!E6\": true, \"sheet7!E7\": true, \"sheet7!E8\": true, \"sheet7!E9\": true, \"sheet7!E10\": true, \"sheet7!E11\": true, \"sheet7!E12\": true, \"sheet7!E13\": true, \"sheet7!E14\": true, \"sheet7!E15\": true, \"sheet7!E16\": true, \"sheet7!E17\": true, \"sheet7!E18\": true, \"sheet7!B6\": true, \"sheet7!B2\": true, \"sheet7!B7\": true, \"sheet7!B8\": true, \"sheet7!B9\": true, \"sheet7!B10\": true, \"sheet7!B11\": true, \"sheet7!B12\": true, \"sheet7!B13\": true, \"sheet7!B14\": true, \"sheet7!B15\": true, \"sheet7!B16\": true, \"sheet7!B17\": true, \"sheet7!B18\": true, \"inv1!D8\": true, \"inv1!D15\": true, \"inv1!D18\": true, \"inv2!C5\": true, \"sheet6!C5\": true }, \"constraints\": { \"inv1!C5\": [\"prompttext\", \"0\", \"1e10\", \"Name\"], \"inv1!C6\": [\"prompttext\", \"0\", \"1e10\", \"Street Address\"], \"inv1!C7\": [\"prompttext\", \"0\", \"1e10\", \"City, State, Zip\"], \"inv1!C8\": [\"prompttext\", \"0\", \"1e10\", \"Phone\"], \"inv1!C9\": [\"promptemail\", \"0\", \"1e10\", \"Email\"], \"inv1!C11\": [\"prompttext\", \"0\", \"1e10\", \"From\"], \"inv1!C12\": [\"prompttext\", \"0\", \"1e10\", \"Name\"], \"inv1!C13\": [\"prompttext\", \"0\", \"1e10\", \"Street Address\"], \"inv1!C14\": [\"prompttext\", \"0\", \"1e10\", \"City, State, Zip\"], \"inv1!C15\": [\"prompttext\", \"0\", \"1e10\", \"Phone\"], \"inv1!C16\": [\"promptemail\", \"0\", \"1e10\", \"Email\"], \"inv1!C18\": [\"prompttext\", \"0\", \"1e10\", \"Invoice #\"], \"inv1!C20\": [\"prompttext\", \"0\", \"1e10\", \"Date\"], \"inv1!D20\": [\"prompttext\", \"0\", \"1e10\", \"Date\"], \"inv1!C23\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv1!C24\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv1!C25\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv1!C26\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv1!C27\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv1!C28\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv1!C29\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv1!C30\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv1!C31\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv1!C32\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv1!C33\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv1!C34\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv1!C35\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv1!F23\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv1!F24\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv1!F25\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv1!F26\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv1!F27\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv1!F28\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv1!F29\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv1!F30\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv1!F31\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv1!F32\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv1!F33\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv1!F34\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv1!F35\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv2!B2\": [\"prompttext\", \"0\", \"1e10\", \"Invoice\"], \"inv2!F4\": [\"prompttext\", \"0\", \"1e10\", \"Date\"], \"inv2!G4\": [\"prompttext\", \"0\", \"1e10\", \"Date\"], \"inv2!B5\": [\"prompttext\", \"0\", \"1e10\", \"Invoice #\"], \"inv2!B7\": [\"prompttext\", \"0\", \"1e10\", \"From\"], \"inv2!B8\": [\"prompttext\", \"0\", \"1e10\", \"Company Name\"], \"inv2!B9\": [\"prompttext\", \"0\", \"1e10\", \"Street Address\"], \"inv2!B10\": [\"prompttext\", \"0\", \"1e10\", \"City, State, Zip\"], \"inv2!B11\": [\"prompttext\", \"0\", \"1e10\", \"Phone\"], \"inv2!B12\": [\"promptemail\", \"0\", \"1e10\", \"Email\"], \"inv2!B14\": [\"prompttext\", \"0\", \"1e10\", \"Bill To\"], \"inv2!B15\": [\"prompttext\", \"0\", \"1e10\", \"Name\"], \"inv2!B16\": [\"prompttext\", \"0\", \"1e10\", \"Company Name\"], \"inv2!B17\": [\"prompttext\", \"0\", \"1e10\", \"Street Address\"], \"inv2!B18\": [\"prompttext\", \"0\", \"1e10\", \"City, State, Zip\"], \"inv2!B19\": [\"prompttext\", \"0\", \"1e10\", \"Phone\"], \"inv2!B20\": [\"promptemail\", \"0\", \"1e10\", \"Email\"], \"inv2!B23\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv2!B24\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv2!B25\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv2!B26\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv2!B27\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv2!B28\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv2!B29\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv2!B30\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv2!B31\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv2!B32\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv2!B33\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv2!B34\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv2!B35\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv2!G23\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv2!G24\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv2!G25\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv2!G26\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv2!G27\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv2!G28\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv2!G29\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv2!G30\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv2!G31\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv2!G32\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv2!G33\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv2!G34\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv2!G35\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv2!B38\": [\"prompttext\", \"0\", \"1e10\", \"Notes\"], \"inv2!B39\": [\"prompttext\", \"0\", \"1e10\", \"Notes\"], \"inv2!B40\": [\"prompttext\", \"0\", \"1e10\", \"Notes\"], \"inv2!F36\": [\"prompttext\", \"0\", \"1e10\", \"Subtotal\"], \"inv2!G37\": [\"promptdecimal\", \"0\", \"1e10\", \"Tax Rate (0.00)\"], \"inv2!F37\": [\"prompttext\", \"0\", \"1e10\", \"Tax Rate\"], \"inv2!F39\": [\"prompttext\", \"0\", \"1e10\", \"Other\"], \"inv2!G39\": [\"promptdecimal\", \"0\", \"1e10\", \"Other\"], \"inv2!F38\": [\"prompttext\", \"0\", \"1e10\", \"Tax\"], \"sheet6!B2\": [\"prompttext\", \"0\", \"1e10\", \"Invoice\"], \"sheet6!F4\": [\"prompttext\", \"0\", \"1e10\", \"Date\"], \"sheet6!G4\": [\"prompttext\", \"0\", \"1e10\", \"Date\"], \"sheet6!B5\": [\"prompttext\", \"0\", \"1e10\", \"Invoice #\"], \"sheet6!B7\": [\"prompttext\", \"0\", \"1e10\", \"From\"], \"sheet6!B8\": [\"prompttext\", \"0\", \"1e10\", \"Company Name\"], \"sheet6!B9\": [\"prompttext\", \"0\", \"1e10\", \"Street Address\"], \"sheet6!B10\": [\"prompttext\", \"0\", \"1e10\", \"City, State, Zip\"], \"sheet6!B11\": [\"prompttext\", \"0\", \"1e10\", \"Phone\"], \"sheet6!B12\": [\"promptemail\", \"0\", \"1e10\", \"Email\"], \"sheet6!B14\": [\"prompttext\", \"0\", \"1e10\", \"Bill To\"], \"sheet6!B15\": [\"prompttext\", \"0\", \"1e10\", \"Name\"], \"sheet6!B16\": [\"prompttext\", \"0\", \"1e10\", \"Company Name\"], \"sheet6!B17\": [\"prompttext\", \"0\", \"1e10\", \"Street Address\"], \"sheet6!B18\": [\"prompttext\", \"0\", \"1e10\", \"City, State, Zip\"], \"sheet6!B19\": [\"prompttext\", \"0\", \"1e10\", \"Phone\"], \"sheet6!B20\": [\"promptemail\", \"0\", \"1e10\", \"Email\"], \"sheet6!B38\": [\"prompttext\", \"0\", \"1e10\", \"Notes\"], \"sheet6!B39\": [\"prompttext\", \"0\", \"1e10\", \"Notes\"], \"sheet6!B40\": [\"prompttext\", \"0\", \"1e10\", \"Notes\"], \"sheet6!F36\": [\"prompttext\", \"0\", \"1e10\", \"Subtotal\"], \"sheet6!G37\": [\"promptdecimal\", \"0\", \"1e10\", \"Tax Rate (0.00)\"], \"sheet6!F37\": [\"prompttext\", \"0\", \"1e10\", \"Tax Rate\"], \"sheet6!F39\": [\"prompttext\", \"0\", \"1e10\", \"Other\"], \"sheet6!G39\": [\"promptdecimal\", \"0\", \"1e10\", \"Other\"], \"sheet6!F38\": [\"prompttext\", \"0\", \"1e10\", \"Tax\"], \"inv3!B6\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv3!B7\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv3!B8\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv3!B9\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv3!B10\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv3!B11\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv3!B12\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv3!B13\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv3!B14\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv3!B15\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv3!B16\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv3!B17\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv3!B18\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"sheet7!B6\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"sheet7!B7\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"sheet7!B8\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"sheet7!B9\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"sheet7!B10\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"sheet7!B11\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"sheet7!B12\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"sheet7!B13\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"sheet7!B14\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"sheet7!B15\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"sheet7!B16\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"sheet7!B17\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"sheet7!B18\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv1!D8\": [\"prompttext\", \"0\", \"1e10\", \"Phone\"], \"inv1!D15\": [\"prompttext\", \"0\", \"1e10\", \"Phone\"], \"inv1!D18\": [\"promptnumeric\", \"0\", \"1e10\", \"Invoice#\"], \"inv2!C5\": [\"promptnumeric\", \"0\", \"1e10\", \"Invoice#\"], \"sheet6!C5\": [\"promptnumeric\", \"0\", \"1e10\", \"Invoice#\"], \"sheet7!E6\": [\"promptdecimal\", \"0\", \"1e10\", \"Quantity\"], \"sheet7!E7\": [\"promptdecimal\", \"0\", \"1e10\", \"Quantity\"], \"sheet7!E8\": [\"promptdecimal\", \"0\", \"1e10\", \"Quantity\"], \"sheet7!E9\": [\"promptdecimal\", \"0\", \"1e10\", \"Quantity\"], \"sheet7!E10\": [\"promptdecimal\", \"0\", \"1e10\", \"Quantity\"], \"sheet7!E11\": [\"promptdecimal\", \"0\", \"1e10\", \"Quantity\"], \"sheet7!E12\": [\"promptdecimal\", \"0\", \"1e10\", \"Quantity\"], \"sheet7!E13\": [\"promptdecimal\", \"0\", \"1e10\", \"Quantity\"], \"sheet7!E14\": [\"promptdecimal\", \"0\", \"1e10\", \"Quantity\"], \"sheet7!E15\": [\"promptdecimal\", \"0\", \"1e10\", \"Quantity\"], \"sheet7!E16\": [\"promptdecimal\", \"0\", \"1e10\", \"Quantity\"], \"sheet7!E17\": [\"promptdecimal\", \"0\", \"1e10\", \"Quantity\"], \"sheet7!E18\": [\"promptdecimal\", \"0\", \"1e10\", \"Quantity\"], \"sheet7!F6\": [\"promptdecimal\", \"0\", \"1e10\", \"Price\"], \"sheet7!F7\": [\"promptdecimal\", \"0\", \"1e10\", \"Price\"], \"sheet7!F8\": [\"promptdecimal\", \"0\", \"1e10\", \"Price\"], \"sheet7!F9\": [\"promptdecimal\", \"0\", \"1e10\", \"Price\"], \"sheet7!F10\": [\"promptdecimal\", \"0\", \"1e10\", \"Price\"], \"sheet7!F11\": [\"promptdecimal\", \"0\", \"1e10\", \"Price\"], \"sheet7!F12\": [\"promptdecimal\", \"0\", \"1e10\", \"Price\"], \"sheet7!F13\": [\"promptdecimal\", \"0\", \"1e10\", \"Price\"], \"sheet7!F14\": [\"promptdecimal\", \"0\", \"1e10\", \"Price\"], \"sheet7!F15\": [\"promptdecimal\", \"0\", \"1e10\", \"Price\"], \"sheet7!F16\": [\"promptdecimal\", \"0\", \"1e10\", \"Price\"], \"sheet7!F17\": [\"promptdecimal\", \"0\", \"1e10\", \"Price\"], \"sheet7!F18\": [\"promptdecimal\", \"0\", \"1e10\", \"Price\"], \"inv3!E6\": [\"promptdecimal\", \"0\", \"1e10\", \"Hours\"], \"inv3!E7\": [\"promptdecimal\", \"0\", \"1e10\", \"Hours\"], \"inv3!E8\": [\"promptdecimal\", \"0\", \"1e10\", \"Hours\"], \"inv3!E9\": [\"promptdecimal\", \"0\", \"1e10\", \"Hours\"], \"inv3!E10\": [\"promptdecimal\", \"0\", \"1e10\", \"Hours\"], \"inv3!E11\": [\"promptdecimal\", \"0\", \"1e10\", \"Hours\"], \"inv3!E12\": [\"promptdecimal\", \"0\", \"1e10\", \"Hours\"], \"inv3!E13\": [\"promptdecimal\", \"0\", \"1e10\", \"Hours\"], \"inv3!E14\": [\"promptdecimal\", \"0\", \"1e10\", \"Hours\"], \"inv3!E15\": [\"promptdecimal\", \"0\", \"1e10\", \"Hours\"], \"inv3!E16\": [\"promptdecimal\", \"0\", \"1e10\", \"Hours\"], \"inv3!E17\": [\"promptdecimal\", \"0\", \"1e10\", \"Hours\"], \"inv3!E18\": [\"promptdecimal\", \"0\", \"1e10\", \"Hours\"], \"inv3!F6\": [\"promptdecimal\", \"0\", \"1e10\", \"Rate\"], \"inv3!F7\": [\"promptdecimal\", \"0\", \"1e10\", \"Rate\"], \"inv3!F8\": [\"promptdecimal\", \"0\", \"1e10\", \"Rate\"], \"inv3!F9\": [\"promptdecimal\", \"0\", \"1e10\", \"Rate\"], \"inv3!F10\": [\"promptdecimal\", \"0\", \"1e10\", \"Rate\"], \"inv3!F11\": [\"promptdecimal\", \"0\", \"1e10\", \"Rate\"], \"inv3!F12\": [\"promptdecimal\", \"0\", \"1e10\", \"Rate\"], \"inv3!F13\": [\"promptdecimal\", \"0\", \"1e10\", \"Rate\"], \"inv3!F14\": [\"promptdecimal\", \"0\", \"1e10\", \"Rate\"], \"inv3!F15\": [\"promptdecimal\", \"0\", \"1e10\", \"Rate\"], \"inv3!F16\": [\"promptdecimal\", \"0\", \"1e10\", \"Rate\"], \"inv3!F17\": [\"promptdecimal\", \"0\", \"1e10\", \"Rate\"], \"inv3!F18\": [\"promptdecimal\", \"0\", \"1e10\", \"Rate\"] } } },\n\t                                                \"footers\": [{ name: 'Type1', index: 1, isActive: true }, { name: 'Type2', index: 2, isActive: false }, { name: 'Type3', index: 3, isActive: false }, { name: 'Detail1', index: 4, isActive: false }, { name: 'Detail2', index: 5, isActive: false }]\n\t                                },\n\t                                \"iPod\": {\n\t                                                \"msc\": { \"numsheets\": 5, \"currentid\": \"sheet1\", \"currentname\": \"inv1\", \"sheetArr\": { \"sheet1\": { \"sheetstr\": { \"savestr\": \"version:1.5\\ncell:B1:b:::2::l:1:f:10\\ncell:C1:b:::2::l:1:f:10\\ncell:D1:b:::2::l:1:f:10\\ncell:E1:b:::2::l:1:f:10\\ncell:F1:b:::2::l:1:f:10\\ncell:G1:b:::2::l:1:f:10\\ncell:A2:b::2:::l:1:f:10\\ncell:B2:t:INVOICE:b:1:1:1:1:f:13:cf:1:colspan:6\\ncell:C2:t::b:2::2::l:1:f:10\\ncell:D2:t::b:2::2::l:1:f:10\\ncell:E2:t::b:2::2::l:1:f:10\\ncell:F2:t::b:2::2::l:1:f:10\\ncell:G2:t::b:2::2::l:1:f:10\\ncell:A3:b::2:::l:3:f:10\\ncell:B3:b:2:::2:l:3:f:10\\ncell:C3:b:2::::l:1:f:10\\ncell:D3:b:2::::l:1:f:10\\ncell:E3:b:2::::l:1:f:10\\ncell:F3:b:2::::l:1:f:10\\ncell:G3:b:2:2:::l:3:f:10\\ncell:A4:b::2:::l:3:f:10\\ncell:B4:b::::2:l:3:f:6\\ncell:C4:t:BILL TO\\\\c:f:9:colspan:2\\ncell:E4:f:5:cf:2\\ncell:G4:b::2:::l:3:f:10\\ncell:A5:b::2:::l:3:f:10\\ncell:B5:b::::2:l:3:f:7\\ncell:C5:t:[Name]:f:9:cf:2:colspan:3\\ncell:E5:f:1:cf:2\\ncell:F5:t::l:2:f:10:tvf:4:rowspan:6\\ncell:G5:t::b::1:::l:2:f:10\\ncell:A6:b::2:::l:3:f:10\\ncell:B6:b::::2:l:3:f:7\\ncell:C6:t:[Street Address]:f:9:cf:2:colspan:3\\ncell:E6:f:1:cf:2\\ncell:F6:l:2:f:10\\ncell:G6:b::1:::l:2:f:10\\ncell:A7:b::2:::l:3:f:10\\ncell:B7:b::::2:l:3:f:7\\ncell:C7:t:[City, State, Zip]:f:9:cf:2:colspan:3\\ncell:E7:f:1:cf:2\\ncell:G7:b::2:::l:3:f:10\\ncell:A8:b::2:::l:3:f:10\\ncell:B8:b::::2:l:3:f:7\\ncell:C8:t:Phone\\\\c:f:9:cf:2:colspan:3\\ncell:D8:f:8:cf:2\\ncell:E8:f:1:cf:2\\ncell:G8:b::2:::l:3:f:10\\ncell:A9:b::2:::l:3:f:10\\ncell:B9:b::::2:l:3:f:7\\ncell:C9:t:Email\\\\c:f:9:cf:2:colspan:3\\ncell:E9:f:1:cf:2\\ncell:G9:b::2:::l:3:f:10\\ncell:A10:b::2:::l:3:f:10\\ncell:B10:b::::2:l:3:f:7\\ncell:C10:colspan:2\\ncell:G10:b::2:::l:3:f:10\\ncell:A11:b::2:::l:3:f:10\\ncell:B11:b::::2:l:3:f:7\\ncell:C11:t:FROM\\\\c:f:9:colspan:2\\ncell:E11:f:8:colspan:2\\ncell:G11:b::2:::l:3:f:10\\ncell:A12:b::2:::l:3:f:10\\ncell:B12:b::::2:l:3:f:7\\ncell:C12:t:[Name]:f:9:colspan:4\\ncell:E12:colspan:2\\ncell:G12:b::2:::l:3:f:10\\ncell:A13:b::2:::l:3:f:10\\ncell:B13:b::::2:l:3:f:7\\ncell:C13:t:[Street Address]:f:9:colspan:4\\ncell:E13:colspan:2\\ncell:G13:b::2:::l:3:f:10\\ncell:A14:b::2:::l:3:f:10\\ncell:B14:b::::2:l:3:f:7\\ncell:C14:t:[City, State, Zip]:f:9:colspan:4\\ncell:E14:colspan:2\\ncell:G14:b::2:::l:3:f:10\\ncell:A15:b::2:::l:3:f:10\\ncell:B15:b::::2:l:3:f:7\\ncell:C15:t:Phone\\\\c:f:9:colspan:4\\ncell:D15:f:8:cf:2:colspan:3\\ncell:E15:colspan:2\\ncell:G15:b::2:::l:3:f:10\\ncell:A16:b::2:::l:3:f:10\\ncell:B16:b::::2:l:3:f:7\\ncell:C16:t:Email\\\\c:f:9:colspan:4\\ncell:E16:colspan:2\\ncell:G16:b::2:::l:3:f:10\\ncell:A17:b::2:::l:3:f:10\\ncell:B17:b::::2:l:3:f:6\\ncell:G17:b::2:::l:3:f:10\\ncell:A18:b::2:::l:3:f:10\\ncell:B18:b::::2:l:3:f:10\\ncell:C18:t:INVOICE #\\\\c:f:9:cf:2:colspan:4\\ncell:D18:v:1:l:4:f:9:cf:2:colspan:3\\ncell:G18:b::2:::l:3:f:10\\ncell:A19:b::2:::l:3:f:10\\ncell:B19:b::::2:l:3:f:10\\ncell:G19:b::2:::l:3:f:10\\ncell:A20:b::2:::l:3:f:10\\ncell:B20:b::::2:l:3:f:10\\ncell:C20:t:DATE\\\\c:f:9:cf:2\\ncell:D20:vtf:nd:42081:TODAY():f:9:cf:2:ntvf:3:colspan:2\\ncell:G20:b::2:::l:3:f:10\\ncell:A21:b::2:::l:3:f:10\\ncell:B21:b::::2:l:3:f:6:cf:2\\ncell:C21:b:::2::l:1:f:10\\ncell:D21:b:::2::l:3:f:6:cf:2\\ncell:E21:b:::2::l:1:f:10\\ncell:F21:b:::2::l:1:f:10\\ncell:G21:b::2:::l:3:f:10\\ncell:A22:b::2:::l:3:f:10\\ncell:B22:b::2::2:l:3:f:10\\ncell:C22:t:Description:b:1::1:1:f:9:cf:1:colspan:3\\ncell:D22:t:Description:b:1::1::l:3:f:6:cf:2:colspan:2:rowspan:1\\ncell:E22:t::b:2:2:2::l:1:f:10\\ncell:F22:t:Amount:b:1:1:1:1:f:9:cf:1\\ncell:G22:b::2::2:l:3:f:10\\ncell:A23:b::2:::l:3:f:10\\ncell:B23:b::2::2:l:3:f:10\\ncell:C23:b:1:1::1:f:2:cf:2:colspan:3\\ncell:D23:b:1:1:::l:3:f:10:cf:2:colspan:2:rowspan:1\\ncell:E23:t::b:2:2:2::l:1:f:10\\ncell:F23:b:1:1:::f:2:ntvf:1\\ncell:G23:b::2::2:l:3:f:10\\ncell:A24:b::2:::l:3:f:10\\ncell:B24:b::2::2:l:3:f:10:cf:2\\ncell:C24:b::1::1:f:2:cf:2:colspan:3\\ncell:D24:b::1:::l:1:f:10:colspan:2\\ncell:E24:l:1:f:10\\ncell:F24:b::1:::f:2:ntvf:1\\ncell:G24:b::2::2:l:3:f:10\\ncell:A25:b::2:::l:3:f:10\\ncell:B25:b::2::2:l:3:f:10:cf:2:ntvf:2\\ncell:C25:b::1::1:f:2:cf:2:colspan:3\\ncell:D25:b::1:::colspan:2\\ncell:F25:b::1:::f:2:ntvf:1\\ncell:G25:b::2::2:l:3:f:10\\ncell:A26:b::2:::l:3:f:10\\ncell:B26:b::2::2:l:3:f:10:cf:2:ntvf:2\\ncell:C26:b::1::1:f:2:cf:2:colspan:3\\ncell:D26:b::1:::colspan:2\\ncell:F26:b::1:::f:2:ntvf:1\\ncell:G26:b::2::2:l:3:f:10\\ncell:A27:b::2:::l:3:f:10\\ncell:B27:b::2::2:l:3:f:10:cf:2:ntvf:2\\ncell:C27:b::1::1:f:2:cf:2:colspan:3\\ncell:D27:b::1:::colspan:2\\ncell:F27:b::1:::f:2:ntvf:1\\ncell:G27:b::2::2:l:3:f:10\\ncell:A28:b::2:::l:3:f:10\\ncell:B28:b::2::2:l:3:f:10:cf:2:ntvf:2\\ncell:C28:b::1::1:f:2:cf:2:colspan:3\\ncell:D28:b::1:::colspan:2\\ncell:F28:b::1:::f:2:ntvf:1\\ncell:G28:b::2::2:l:3:f:10\\ncell:A29:b::2:::l:3:f:10\\ncell:B29:b::2::2:l:3:f:10:cf:2:ntvf:2\\ncell:C29:b::1::1:f:2:cf:2:colspan:3\\ncell:D29:b::1:::colspan:2\\ncell:F29:b::1:::f:2:ntvf:1\\ncell:G29:b::2::2:l:3:f:10\\ncell:A30:b::2:::l:3:f:10\\ncell:B30:b::2::2:l:3:f:10:cf:2\\ncell:C30:b::1::1:f:2:cf:2:colspan:3\\ncell:D30:b::1:::colspan:2\\ncell:F30:b::1:::f:2:ntvf:1\\ncell:G30:b::2::2:l:3:f:10\\ncell:A31:b::2:::l:3:f:10\\ncell:B31:b::2::2:l:3:f:10:cf:2\\ncell:C31:b::1::1:f:2:cf:2:colspan:3\\ncell:D31:b::1:::colspan:2\\ncell:F31:b::1:::f:2:ntvf:1\\ncell:G31:b::2::2:l:3:f:10\\ncell:A32:b::2:::l:3:f:10\\ncell:B32:b::2::2:l:3:f:10:cf:2\\ncell:C32:b::1::1:f:2:cf:2:colspan:3\\ncell:D32:b::1:::colspan:2\\ncell:F32:b::1:::f:2:ntvf:1\\ncell:G32:b::2::2:l:3:f:10\\ncell:A33:b::2:::l:3:f:10\\ncell:B33:b::2::2:l:3:f:10:cf:2\\ncell:C33:b::1::1:f:2:cf:2:colspan:3\\ncell:D33:b::1:::colspan:2\\ncell:F33:b::1:::f:2:ntvf:1\\ncell:G33:b::2::2:l:3:f:10\\ncell:A34:b::2:::l:3:f:10\\ncell:B34:b::2::2:l:3:f:10:cf:2\\ncell:C34:b::1::1:f:2:cf:2:colspan:3\\ncell:D34:b::1:::colspan:2\\ncell:F34:b::1:::f:2:ntvf:1\\ncell:G34:b::2::2:l:3:f:10\\ncell:A35:b::2:::l:3:f:7\\ncell:B35:b::2::2:l:3:f:10:cf:2\\ncell:C35:b::1:1:1:f:2:cf:2:colspan:3\\ncell:D35:b::1:1::l:3:f:10:cf:2:colspan:2\\ncell:E35:b:::2::l:3:f:10:cf:2\\ncell:F35:b::1:1::f:2:ntvf:1\\ncell:G35:b::2::2:l:3:f:10\\ncell:A36:b::2:::l:3:f:6\\ncell:B36:b::2::2:l:3:f:6\\ncell:C36:t:TOTAL:b:1:1:1:1:f:11:cf:2:colspan:3\\ncell:D36:b:2::2::l:3:f:12:cf:2\\ncell:E36:b:2:2:2::l:3:f:12:cf:2\\ncell:F36:vtf:n:0:SUM(F23\\\\cF35):b:1:1:1::f:11:ntvf:1\\ncell:G36:b::2::2:l:3:f:7\\ncell:A37:b::2:::l:3:f:10\\ncell:B37:b::::2:l:3:f:6:cf:2\\ncell:C37:b:2::::l:1:f:10\\ncell:D37:b:2::::l:1:f:10\\ncell:E37:b:2::::l:1:f:10\\ncell:F37:b:2::::l:1:f:10\\ncell:G37:b::2:::l:3:f:6\\ncell:A38:b::2:::l:3:f:10\\ncell:B38:b::::2:l:3:f:10\\ncell:G38:b::2:::l:3:f:10\\ncell:A39:b::2:::l:3:f:10\\ncell:B39:b::::2:l:3:f:10:cf:2\\ncell:C39:t:Thank you for your business:f:4:cf:1:colspan:4\\ncell:D39:t:Thank you for your business:colspan:3\\ncell:E39:t:Thank you for your business:f:3:colspan:2\\ncell:F39:t::l:2:f:10\\ncell:G39:b::2:::l:3:f:10\\ncell:A40:b::2:::l:3:f:10\\ncell:B40:b::::2:l:3:f:10\\ncell:G40:b::2:::l:3:f:10\\ncell:A41:b::2:::l:3:f:10\\ncell:B41:b:::2:2:l:3:f:10\\ncell:C41:b:::2::l:3:f:10\\ncell:D41:b:::2::l:3:f:10\\ncell:E41:b:::2::l:3:f:10\\ncell:F41:b:::2::l:3:f:10\\ncell:G41:b::2:2::l:3:f:10\\ncell:B42:b:1:::\\ncell:C42:b:1:::\\ncell:D42:b:1:::\\ncell:E42:b:1:::\\ncell:F42:b:1:::\\ncell:G42:b:1:::\\ncol:A:w:10\\ncol:B:w:10\\ncol:C:w:62\\ncol:D:w:73\\ncol:E:w:15\\ncol:F:w:68\\ncol:G:w:10\\nrow:1:h:14.25\\nrow:2:h:18.75\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:15.75\\nrow:6:h:15.75\\nrow:7:h:15.75\\nrow:8:h:15.75\\nrow:9:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:13:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:16:h:14.25\\nrow:17:h:14.25\\nrow:18:h:14.25\\nrow:19:h:14.25\\nrow:20:h:14.25\\nrow:21:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nrow:24:h:14.25\\nrow:25:h:14.25\\nrow:26:h:14.25\\nrow:27:h:14.25\\nrow:28:h:14.25\\nrow:29:h:14.25\\nrow:30:h:14.25\\nrow:31:h:14.25\\nrow:32:h:14.25\\nrow:33:h:14.25\\nrow:34:h:14.25\\nrow:35:h:15.75\\nrow:36:h:15.75\\nrow:37:h:14.25\\nrow:38:h:14.25\\nrow:39:h:14.25\\nrow:40:h:14.25\\nrow:41:h:14.25\\nsheet:c:7:r:42:h:12.75\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\nfont:1:* * Trebuchet MS\\nfont:2:* 9pt Trebuchet MS\\nfont:3:italic bold * Trebuchet MS\\nfont:4:italic bold 10pt Trebuchet MS\\nfont:5:normal bold * Trebuchet MS\\nfont:6:normal bold 10pt Arial\\nfont:7:normal bold 12pt Arial\\nfont:8:normal normal * *\\nfont:9:normal normal * Trebuchet MS\\nfont:10:normal normal 10pt Arial\\nfont:11:normal normal 11pt Trebuchet MS\\nfont:12:normal normal 12pt Arial\\nfont:13:normal normal 16pt Trebuchet MS\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nlayout:3:padding:* * * *;vertical-align:top;\\nlayout:4:padding:* * * 4px;vertical-align:*;\\nvalueformat:1:#,##0.00\\nvalueformat:2:d-mmm\\nvalueformat:3:m/d/yy\\nvalueformat:4:text-html\\n\" }, \"name\": \"inv1\", \"hidden\": \"0\" }, \"sheet2\": { \"sheetstr\": { \"savestr\": \"version:1.5\\ncell:B2:t:INVOICE:l:1:f:9:cf:1:colspan:6\\ncell:C2:t::l:2:f:13\\ncell:D2:t::l:2:f:13\\ncell:E2:l:1:f:10:c:2:cf:3\\ncell:F2:t:INVOICE:l:1:f:8:c:2:cf:2:colspan:2\\ncell:G2:t::l:2:f:13\\ncell:B3:f:6:cf:2:colspan:4\\ncell:C3:t::l:2:f:13\\ncell:D3:t::l:2:f:13\\ncell:F3:l:1:f:7:cf:2\\ncell:G3:l:1:f:14:cf:2:ntvf:3\\ncell:B4:f:2:colspan:2\\ncell:F4:t:DATE\\\\c:l:1:f:14:cf:2\\ncell:G4:vtf:nd:42081:TODAY():l:1:f:14:cf:2:ntvf:3\\ncell:B5:t:INVOICE #\\\\c:f:3:colspan:6\\ncell:C5:cf:2:colspan:5\\ncell:F5:l:1:f:7:cf:2:colspan:2\\ncell:G5:l:1:f:14:cf:2\\ncell:B6:f:2:colspan:2\\ncell:F6:l:1:f:7:cf:2:colspan:2\\ncell:G6:l:1:f:14:cf:2\\ncell:B7:t:FROM\\\\c:f:12\\ncell:F7:l:1:f:7:cf:2:tvf:4:colspan:2:rowspan:6\\ncell:G7:l:1:f:14:cf:2\\ncell:B8:t:[Company Name]:f:3:colspan:4\\ncell:F8:l:1:f:7:cf:2:colspan:2\\ncell:G8:l:1:f:14:cf:2\\ncell:B9:t:[Street Address]:f:1:cf:2:colspan:4\\ncell:F9:l:1:f:7\\ncell:G9:l:1:f:14:cf:1\\ncell:B10:t:[City, State,  Zip]:f:1:cf:2:colspan:4\\ncell:G10:l:1:f:13\\ncell:B11:t:Phone\\\\c :f:1:cf:2:colspan:4\\ncell:B12:t:Email\\\\c:f:1:cf:2:colspan:4\\ncell:B13:colspan:2\\ncell:B14:t:BILL TO\\\\c:f:11:cf:2\\ncell:B15:t:[Name]:f:1:cf:2:colspan:6\\ncell:B16:t:[Company Name]:f:1:cf:2:colspan:6\\ncell:F16:t:  \\ncell:B17:t:[Street Address]:f:1:cf:2:colspan:6\\ncell:B18:t:[City, State,  Zip]:f:1:cf:2:colspan:6\\ncell:B19:t:Phone\\\\c :f:1:cf:2:colspan:6\\ncell:B20:t:Email\\\\c:f:1:cf:2:colspan:6\\ncell:A22:b::1::\\ncell:B22:t:DESCRIPTION:b:1:1:1:1:l:1:f:14:c:1:bg:3:cf:1:colspan:5:rowspan:1\\ncell:C22:t::l:2:f:13\\ncell:D22:t::l:2:f:13\\ncell:E22:t::l:2:f:13\\ncell:F22:t::l:2:f:13\\ncell:G22:t:AMOUNT:b:1:1:1::l:1:f:14:c:1:bg:3:cf:1\\ncell:A23:b::1::\\ncell:B23:b:1:1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C23:t::l:2:f:4\\ncell:D23:t::l:2:f:4\\ncell:E23:t::l:2:f:4\\ncell:F23:t::b::2:::l:1:f:4\\ncell:G23:b::1::1:f:4:ntvf:1\\ncell:A24:b::1::\\ncell:B24:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C24:t::l:2:f:4\\ncell:D24:t::l:2:f:4\\ncell:E24:t::l:2:f:4\\ncell:F24:t::b::2:::l:1:f:4\\ncell:G24:b::1::1:f:4:ntvf:1\\ncell:A25:b::1::\\ncell:B25:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C25:t::l:2:f:4\\ncell:D25:t::l:2:f:4\\ncell:E25:t::l:2:f:4\\ncell:F25:t::b::2:::l:1:f:4\\ncell:G25:b::1::1:f:4:ntvf:1\\ncell:A26:b::1::\\ncell:B26:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C26:t::l:2:f:4\\ncell:D26:t::l:2:f:4\\ncell:E26:t::l:2:f:4\\ncell:F26:t::b::2:::l:1:f:4\\ncell:G26:b::1::1:f:4:ntvf:1\\ncell:A27:b::1::\\ncell:B27:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C27:t::l:2:f:4\\ncell:D27:t::l:2:f:4\\ncell:E27:t::l:2:f:4\\ncell:F27:t::b::2:::l:1:f:4\\ncell:G27:b::1::1:f:4:ntvf:1\\ncell:A28:b::1::\\ncell:B28:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C28:t::l:2:f:4\\ncell:D28:t::l:2:f:4\\ncell:E28:t::l:2:f:4\\ncell:F28:t::b::2:::l:1:f:4\\ncell:G28:b::1::1:f:4:ntvf:1\\ncell:A29:b::1::\\ncell:B29:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C29:t::l:2:f:4\\ncell:D29:t::l:2:f:4\\ncell:E29:t::l:2:f:4\\ncell:F29:t::b::2:::l:1:f:4\\ncell:G29:b::1::1:f:4:ntvf:1\\ncell:A30:b::1::\\ncell:B30:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C30:t::l:2:f:4\\ncell:D30:t::l:2:f:4\\ncell:E30:t::l:2:f:4\\ncell:F30:t::b::2:::l:1:f:4\\ncell:G30:b::1::1:f:4:ntvf:1\\ncell:A31:b::1::\\ncell:B31:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C31:t::l:2:f:4\\ncell:D31:t::l:2:f:4\\ncell:E31:t::l:2:f:4\\ncell:F31:t::b::2:::l:1:f:4\\ncell:G31:b::1::1:f:4:ntvf:1\\ncell:A32:b::1::\\ncell:B32:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C32:t::l:2:f:4\\ncell:D32:t::l:2:f:4\\ncell:E32:t::l:2:f:4\\ncell:F32:t::b::2:::l:1:f:4\\ncell:G32:b::1::1:f:4:ntvf:1\\ncell:A33:b::1::\\ncell:B33:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C33:t::l:2:f:4\\ncell:D33:t::l:2:f:4\\ncell:E33:t::l:2:f:4\\ncell:F33:t::b::2:::l:1:f:4\\ncell:G33:b::1::1:f:4:ntvf:1\\ncell:A34:b::1::\\ncell:B34:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C34:l:2:f:4\\ncell:D34:l:2:f:4\\ncell:E34:l:2:f:4\\ncell:F34:b::2:::l:1:f:4\\ncell:G34:b::1::1:f:4:ntvf:1\\ncell:A35:b::1::\\ncell:B35:b::1:1:1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C35:t::b:::2::l:1:f:4\\ncell:D35:t::b:::2::l:1:f:4\\ncell:E35:t::b:::2::l:1:f:4\\ncell:F35:t::b::2:2::l:1:f:4\\ncell:G35:b::1:1:1:f:4:ntvf:1\\ncell:B36:b:2::::l:1:f:13\\ncell:C36:b:2::::l:1:f:13\\ncell:D36:b:2::::l:1:f:13\\ncell:E36:b:2::::l:1:f:14\\ncell:F36:t:Subtotal:b:2::::l:1:f:11\\ncell:G36:vtf:n:0:SUM(G23\\\\cG35):b:1::::f:11:ntvf:1\\ncell:B37:t:NOTES:b:::1::l:1:f:14:cf:2:colspan:3:rowspan:1\\ncell:C37:t::b:::2::l:1:f:13\\ncell:D37:t::b:::2::l:1:f:13\\ncell:F37:t:Tax Rate:l:1:f:11\\ncell:G37:v:0:f:1:ntvf:2\\ncell:B38:b:1::::f:1:cf:2:colspan:3\\ncell:C38:t::b:2::::l:1:f:13\\ncell:D38:t::b:2::::l:1:f:13\\ncell:F38:t:Tax:l:1:f:11\\ncell:G38:vtf:n:0:G37*G36:f:1:ntvf:1\\ncell:B39:f:1:cf:2:colspan:3\\ncell:C39:t::l:2:f:13\\ncell:D39:t::l:2:f:13\\ncell:F39:t:Other:b:::1::l:1:f:11\\ncell:G39:v:0:b:::1::f:1:ntvf:1\\ncell:B40:b:::1::f:1:cf:2:colspan:3:rowspan:1\\ncell:C40:t::l:2:f:13\\ncell:D40:t::l:2:f:13\\ncell:F40:t:TOTAL:b:1::::l:1:f:14\\ncell:G40:vtf:n:0:(G36+G38)+G39:b:1::::f:11:ntvf:1\\ncell:B43:t:Thank you for your business:l:1:f:5:cf:1:colspan:6:rowspan:1\\ncell:C43:t::l:2:f:13\\ncell:D43:t::l:2:f:13\\ncell:E43:t::l:2:f:13\\ncell:F43:t::l:2:f:13\\ncell:G43:t::l:2:f:13\\ncol:A:w:10\\ncol:B:w:90\\ncol:C:w:19\\ncol:D:w:10\\ncol:E:w:16\\ncol:F:w:45\\ncol:G:w:64\\nrow:1:h:34.5\\nrow:2:h:34.5\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:14.25\\nrow:6:h:14.25\\nrow:7:h:14.25\\nrow:8:h:14.25\\nrow:9:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:16:h:14.25\\nrow:17:h:14.25\\nrow:18:h:14.25\\nrow:19:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nrow:24:h:14.25\\nrow:25:h:14.25\\nrow:26:h:14.25\\nrow:27:h:14.25\\nrow:28:h:14.25\\nrow:29:h:14.25\\nrow:30:h:14.25\\nrow:31:h:14.25\\nrow:32:h:14.25\\nrow:33:h:14.25\\nrow:34:h:14.25\\nrow:35:h:14.25\\nrow:36:h:14.25\\nrow:37:h:14.25\\nrow:38:h:14.25\\nrow:39:h:14.25\\nrow:40:h:14.25\\nrow:43:h:15.75\\nsheet:c:7:r:43:h:12.75:needsrecalc:yes\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\ncellformat:3:right\\ncolor:1:rgb(0, 0, 0)\\ncolor:2:rgb(0,0,0)\\ncolor:3:rgb(221, 221, 221)\\nfont:1:* * Trebuchet MS\\nfont:2:* 10pt *\\nfont:3:* 10pt Trebuchet MS\\nfont:4:* 9pt Trebuchet MS\\nfont:5:italic bold 10pt Trebuchet MS\\nfont:6:italic normal * Trebuchet MS\\nfont:7:normal bold 10pt Trebuchet MS\\nfont:8:normal bold 14pt Trebuchet MS\\nfont:9:normal bold 16pt Trebuchet MS\\nfont:10:normal bold 28pt Trebuchet MS\\nfont:11:normal normal * Trebuchet MS\\nfont:12:normal normal 10pt *\\nfont:13:normal normal 10pt Arial\\nfont:14:normal normal 10pt Trebuchet MS\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nvalueformat:1:#,##0.00\\nvalueformat:2:#,##0.00%\\nvalueformat:3:m/d/yy\\nvalueformat:4:text-html\\n\" }, \"name\": \"inv2\", \"hidden\": \"0\" }, \"sheet3\": { \"sheetstr\": { \"savestr\": \"version:1.5\\ncell:B2:t:INVOICE:l:1:f:12:cf:1:colspan:6\\ncell:C2:t::l:2:f:10\\ncell:D2:t::l:2:f:10\\ncell:E2:l:1:f:8:c:2:cf:3\\ncell:F2:t:INVOICE:l:1:f:7:c:2:cf:2:colspan:2\\ncell:G2:t::l:2:f:10\\ncell:B3:f:5:cf:2:colspan:4\\ncell:C3:t::l:2:f:10\\ncell:D3:t::l:2:f:10\\ncell:F3:l:1:f:6:cf:2\\ncell:G3:l:1:f:11:cf:2:ntvf:3\\ncell:B4:f:2:colspan:2\\ncell:F4:t:DATE\\\\c:l:1:f:11:cf:2\\ncell:G4:vtf:nd:42081:TODAY():l:1:f:11:cf:2:ntvf:3\\ncell:B5:t:INVOICE #\\\\c:f:9:colspan:6\\ncell:C5:cf:2:colspan:5\\ncell:F5:l:1:f:6:cf:2:colspan:2\\ncell:G5:l:1:f:11:cf:2\\ncell:B6:f:2:colspan:2\\ncell:F6:l:1:f:6:cf:2:colspan:2\\ncell:G6:l:1:f:11:cf:2\\ncell:B7:t:FROM\\\\c:f:11\\ncell:F7:l:1:f:6:cf:2:colspan:2\\ncell:G7:l:1:f:11:cf:2\\ncell:B8:t:[Company Name]:f:9:colspan:4\\ncell:F8:l:1:f:6:cf:2:tvf:4:colspan:2:rowspan:5\\ncell:G8:l:1:f:11:cf:2\\ncell:B9:t:[Street Address]:f:9:cf:2:colspan:4\\ncell:F9:l:1:f:6\\ncell:G9:l:1:f:11:cf:1\\ncell:B10:t:[City, State,  Zip]:f:9:cf:2:colspan:4\\ncell:G10:l:1:f:10\\ncell:B11:t:Phone\\\\c :f:9:cf:2:colspan:4\\ncell:B12:t:Email\\\\c:f:9:cf:2:colspan:4\\ncell:B13:colspan:2\\ncell:B14:t:BILL TO\\\\c:f:9:cf:2\\ncell:B15:t:[Name]:f:9:cf:2:colspan:6\\ncell:B16:t:[Company Name]:f:9:cf:2:colspan:6\\ncell:F16:t:  \\ncell:B17:t:[Street Address]:f:9:cf:2:colspan:6\\ncell:B18:t:[City, State,  Zip]:f:9:cf:2:colspan:6\\ncell:B19:t:Phone\\\\c :f:9:cf:2:colspan:6\\ncell:B20:t:Email\\\\c:f:9:cf:2:colspan:6\\ncell:A22:b::1::\\ncell:B22:t:DESCRIPTION:b:1:1:1:1:l:1:f:11:c:1:bg:3:cf:1:colspan:5:rowspan:1\\ncell:C22:t::l:2:f:10\\ncell:D22:t::l:2:f:10\\ncell:E22:t::l:2:f:10\\ncell:F22:t::l:2:f:10\\ncell:G22:t:AMOUNT:b:1:1:1::l:1:f:11:c:1:bg:3:cf:1\\ncell:A23:b::1::\\ncell:B23:vtf:t: :IF(AND(ISBLANK(inv3!B6),ISBLANK(sheet7!B6)), \\\" \\\", IF(ISBLANK(inv3!B6), sheet7!B6, inv3!B6)):b:1:1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C23:t::l:2:f:3\\ncell:D23:t::l:2:f:3\\ncell:E23:t::l:2:f:3\\ncell:F23:t::b::2:::l:1:f:3\\ncell:G23:vtf:t: :IF(AND(ISBLANK(inv3!B6),ISBLANK(sheet7!B6)), \\\" \\\", IF(ISBLANK(inv3!B6), (sheet7!E6*sheet7!F6), (inv3!E6*inv3!F6))):b::1::1:f:3:ntvf:1\\ncell:A24:b::1::\\ncell:B24:vtf:t: :IF(AND(ISBLANK(INV3!B7),ISBLANK(SHEET7!B7)), \\\" \\\", IF(ISBLANK(INV3!B7), SHEET7!B7, INV3!B7)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C24:t::l:2:f:3\\ncell:D24:t::l:2:f:3\\ncell:E24:t::l:2:f:3\\ncell:F24:t::b::2:::l:1:f:3\\ncell:G24:vtf:t: :IF(AND(ISBLANK(INV3!B7),ISBLANK(SHEET7!B7)), \\\" \\\", IF(ISBLANK(INV3!B7), (SHEET7!E7*SHEET7!F7), (INV3!E7*INV3!F7))):b::1::1:f:3:ntvf:1\\ncell:A25:b::1::\\ncell:B25:vtf:t: :IF(AND(ISBLANK(INV3!B8),ISBLANK(SHEET7!B8)), \\\" \\\", IF(ISBLANK(INV3!B8), SHEET7!B8, INV3!B8)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C25:t::l:2:f:3\\ncell:D25:t::l:2:f:3\\ncell:E25:t::l:2:f:3\\ncell:F25:t::b::2:::l:1:f:3\\ncell:G25:vtf:t: :IF(AND(ISBLANK(INV3!B8),ISBLANK(SHEET7!B8)), \\\" \\\", IF(ISBLANK(INV3!B8), (SHEET7!E8*SHEET7!F8), (INV3!E8*INV3!F8))):b::1::1:f:3:ntvf:1\\ncell:A26:b::1::\\ncell:B26:vtf:t: :IF(AND(ISBLANK(INV3!B9),ISBLANK(SHEET7!B9)), \\\" \\\", IF(ISBLANK(INV3!B9), SHEET7!B9, INV3!B9)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C26:t::l:2:f:3\\ncell:D26:t::l:2:f:3\\ncell:E26:t::l:2:f:3\\ncell:F26:t::b::2:::l:1:f:3\\ncell:G26:vtf:t: :IF(AND(ISBLANK(INV3!B9),ISBLANK(SHEET7!B9)), \\\" \\\", IF(ISBLANK(INV3!B9), (SHEET7!E9*SHEET7!F9), (INV3!E9*INV3!F9))):b::1::1:f:3:ntvf:1\\ncell:A27:b::1::\\ncell:B27:vtf:t: :IF(AND(ISBLANK(INV3!B10),ISBLANK(SHEET7!B10)), \\\" \\\", IF(ISBLANK(INV3!B10), SHEET7!B10, INV3!B10)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C27:t::l:2:f:3\\ncell:D27:t::l:2:f:3\\ncell:E27:t::l:2:f:3\\ncell:F27:t::b::2:::l:1:f:3\\ncell:G27:vtf:t: :IF(AND(ISBLANK(INV3!B10),ISBLANK(SHEET7!B10)), \\\" \\\", IF(ISBLANK(INV3!B10), (SHEET7!E10*SHEET7!F10), (INV3!E10*INV3!F10))):b::1::1:f:3:ntvf:1\\ncell:A28:b::1::\\ncell:B28:vtf:t: :IF(AND(ISBLANK(INV3!B11),ISBLANK(SHEET7!B11)), \\\" \\\", IF(ISBLANK(INV3!B11), SHEET7!B11, INV3!B11)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C28:t::l:2:f:3\\ncell:D28:t::l:2:f:3\\ncell:E28:t::l:2:f:3\\ncell:F28:t::b::2:::l:1:f:3\\ncell:G28:vtf:t: :IF(AND(ISBLANK(INV3!B11),ISBLANK(SHEET7!B11)), \\\" \\\", IF(ISBLANK(INV3!B11), (SHEET7!E11*SHEET7!F11), (INV3!E11*INV3!F11))):b::1::1:f:3:ntvf:1\\ncell:A29:b::1::\\ncell:B29:vtf:t: :IF(AND(ISBLANK(INV3!B12),ISBLANK(SHEET7!B12)), \\\" \\\", IF(ISBLANK(INV3!B12), SHEET7!B12, INV3!B12)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C29:t::l:2:f:3\\ncell:D29:t::l:2:f:3\\ncell:E29:t::l:2:f:3\\ncell:F29:t::b::2:::l:1:f:3\\ncell:G29:vtf:t: :IF(AND(ISBLANK(INV3!B12),ISBLANK(SHEET7!B12)), \\\" \\\", IF(ISBLANK(INV3!B12), (SHEET7!E12*SHEET7!F12), (INV3!E12*INV3!F12))):b::1::1:f:3:ntvf:1\\ncell:A30:b::1::\\ncell:B30:vtf:t: :IF(AND(ISBLANK(INV3!B13),ISBLANK(SHEET7!B13)), \\\" \\\", IF(ISBLANK(INV3!B13), SHEET7!B13, INV3!B13)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C30:t::l:2:f:3\\ncell:D30:t::l:2:f:3\\ncell:E30:t::l:2:f:3\\ncell:F30:t::b::2:::l:1:f:3\\ncell:G30:vtf:t: :IF(AND(ISBLANK(INV3!B13),ISBLANK(SHEET7!B13)), \\\" \\\", IF(ISBLANK(INV3!B13), (SHEET7!E13*SHEET7!F13), (INV3!E13*INV3!F13))):b::1::1:f:3:ntvf:1\\ncell:A31:b::1::\\ncell:B31:vtf:t: :IF(AND(ISBLANK(INV3!B14),ISBLANK(SHEET7!B14)), \\\" \\\", IF(ISBLANK(INV3!B14), SHEET7!B14, INV3!B14)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C31:t::l:2:f:3\\ncell:D31:t::l:2:f:3\\ncell:E31:t::l:2:f:3\\ncell:F31:t::b::2:::l:1:f:3\\ncell:G31:vtf:t: :IF(AND(ISBLANK(INV3!B14),ISBLANK(SHEET7!B14)), \\\" \\\", IF(ISBLANK(INV3!B14), (SHEET7!E14*SHEET7!F14), (INV3!E14*INV3!F14))):b::1::1:f:3:ntvf:1\\ncell:A32:b::1::\\ncell:B32:vtf:t: :IF(AND(ISBLANK(INV3!B15),ISBLANK(SHEET7!B15)), \\\" \\\", IF(ISBLANK(INV3!B15), SHEET7!B15, INV3!B15)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C32:t::l:2:f:3\\ncell:D32:t::l:2:f:3\\ncell:E32:t::l:2:f:3\\ncell:F32:t::b::2:::l:1:f:3\\ncell:G32:vtf:t: :IF(AND(ISBLANK(INV3!B15),ISBLANK(SHEET7!B15)), \\\" \\\", IF(ISBLANK(INV3!B15), (SHEET7!E15*SHEET7!F15), (INV3!E15*INV3!F15))):b::1::1:f:3:ntvf:1\\ncell:A33:b::1::\\ncell:B33:vtf:t: :IF(AND(ISBLANK(INV3!B16),ISBLANK(SHEET7!B16)), \\\" \\\", IF(ISBLANK(INV3!B16), SHEET7!B16, INV3!B16)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C33:l:2:f:3\\ncell:D33:l:2:f:3\\ncell:E33:l:2:f:3\\ncell:F33:b::2:::l:1:f:3\\ncell:G33:vtf:t: :IF(AND(ISBLANK(INV3!B16),ISBLANK(SHEET7!B16)), \\\" \\\", IF(ISBLANK(INV3!B16), (SHEET7!E16*SHEET7!F16), (INV3!E16*INV3!F16))):b::1::1:f:3:ntvf:1\\ncell:A34:b::1::\\ncell:B34:vtf:t: :IF(AND(ISBLANK(INV3!B17),ISBLANK(SHEET7!B17)), \\\" \\\", IF(ISBLANK(INV3!B17), SHEET7!B17, INV3!B17)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C34:t::l:2:f:3\\ncell:D34:t::l:2:f:3\\ncell:E34:t::l:2:f:3\\ncell:F34:t::b::2:::l:1:f:3\\ncell:G34:vtf:t: :IF(AND(ISBLANK(INV3!B17),ISBLANK(SHEET7!B17)), \\\" \\\", IF(ISBLANK(INV3!B17), (SHEET7!E17*SHEET7!F17), (INV3!E17*INV3!F17))):b::1::1:f:3:ntvf:1\\ncell:A35:b::1::\\ncell:B35:vtf:t: :IF(AND(ISBLANK(INV3!B18),ISBLANK(SHEET7!B18)), \\\" \\\", IF(ISBLANK(INV3!B18), SHEET7!B18, INV3!B18)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C35:t::b:::2::l:1:f:3\\ncell:D35:t::b:::2::l:1:f:3\\ncell:E35:t::b:::2::l:1:f:3\\ncell:F35:t::b::2:2::l:1:f:3\\ncell:G35:vtf:t: :IF(AND(ISBLANK(INV3!B18),ISBLANK(SHEET7!B18)), \\\" \\\", IF(ISBLANK(INV3!B18), (SHEET7!E18*SHEET7!F18), (INV3!E18*INV3!F18))):b::1::1:f:3:ntvf:1\\ncell:B36:b:2::::l:1:f:10\\ncell:C36:b:2::::l:1:f:10\\ncell:D36:b:2::::l:1:f:10\\ncell:E36:b:2::::l:1:f:11\\ncell:F36:t:Subtotal:b:2::::l:1:f:9\\ncell:G36:vtf:n:0:SUM(G23\\\\cG35):b:1::::f:9:ntvf:1\\ncell:B37:t:NOTES:b:::1::l:1:f:11:cf:2:colspan:3:rowspan:1\\ncell:C37:t::b:::2::l:1:f:10\\ncell:D37:t::b:::2::l:1:f:10\\ncell:F37:t:Tax Rate:l:1:f:9\\ncell:G37:v:0:f:1:ntvf:2\\ncell:B38:b:1::::f:1:cf:2:colspan:3\\ncell:C38:t::b:2::::l:1:f:10\\ncell:D38:t::b:2::::l:1:f:10\\ncell:F38:t:Tax:l:1:f:9\\ncell:G38:vtf:n:0:G37*G36:f:1:ntvf:1\\ncell:B39:f:1:cf:2:colspan:3\\ncell:C39:t::l:2:f:10\\ncell:D39:t::l:2:f:10\\ncell:F39:t:Other:b:::1::l:1:f:9\\ncell:G39:v:0:b:::1::f:1:ntvf:1\\ncell:B40:b:::1::f:1:cf:2:colspan:3:rowspan:1\\ncell:C40:t::l:2:f:10\\ncell:D40:t::l:2:f:10\\ncell:F40:t:TOTAL:b:1::::l:1:f:11\\ncell:G40:vtf:n:0:(G36+G38)+G39:b:1::::f:9:ntvf:1\\ncell:B43:t:Thank you for your business:l:1:f:4:cf:1:colspan:6:rowspan:1\\ncell:C43:t::l:2:f:10\\ncell:D43:t::l:2:f:10\\ncell:E43:t::l:2:f:10\\ncell:F43:t::l:2:f:10\\ncell:G43:t::l:2:f:10\\ncol:A:w:10\\ncol:B:w:65\\ncol:C:w:19\\ncol:D:w:10\\ncol:E:w:16\\ncol:F:w:53\\ncol:G:w:64\\nrow:1:h:34.5\\nrow:2:h:34.5\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:14.25\\nrow:6:h:14.25\\nrow:7:h:14.25\\nrow:8:h:14.25\\nrow:9:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:16:h:14.25\\nrow:17:h:14.25\\nrow:18:h:14.25\\nrow:19:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nrow:24:h:14.25\\nrow:25:h:14.25\\nrow:26:h:14.25\\nrow:27:h:14.25\\nrow:28:h:14.25\\nrow:29:h:14.25\\nrow:30:h:14.25\\nrow:31:h:14.25\\nrow:32:h:14.25\\nrow:33:h:14.25\\nrow:34:h:14.25\\nrow:35:h:14.25\\nrow:36:h:14.25\\nrow:37:h:14.25\\nrow:38:h:14.25\\nrow:39:h:14.25\\nrow:40:h:14.25\\nrow:43:h:15.75\\nsheet:c:7:r:43:h:12.75:needsrecalc:yes\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\ncellformat:3:right\\ncolor:1:rgb(0, 0, 0)\\ncolor:2:rgb(0,0,0)\\ncolor:3:rgb(221, 221, 221)\\nfont:1:* * Trebuchet MS\\nfont:2:* 10pt *\\nfont:3:* 9pt Trebuchet MS\\nfont:4:italic bold 10pt Trebuchet MS\\nfont:5:italic normal * Trebuchet MS\\nfont:6:normal bold 10pt Trebuchet MS\\nfont:7:normal bold 14pt Trebuchet MS\\nfont:8:normal bold 28pt Trebuchet MS\\nfont:9:normal normal * Trebuchet MS\\nfont:10:normal normal 10pt Arial\\nfont:11:normal normal 10pt Trebuchet MS\\nfont:12:normal normal 16pt Trebuchet MS\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nvalueformat:1:#,##0.00\\nvalueformat:2:#,##0.00%\\nvalueformat:3:m/d/yy\\nvalueformat:4:text-html\\n\" }, \"name\": \"sheet6\", \"hidden\": \"0\" }, \"sheet4\": { \"sheetstr\": { \"savestr\": \"version:1.5\\ncell:B1:b:::2::l:1:f:7\\ncell:C1:b:::2::l:1:f:7\\ncell:D1:b:::2::l:1:f:7\\ncell:E1:b:::2::l:1:f:7\\ncell:F1:b:::2::l:1:f:7\\ncell:A2:b::2:::l:1:f:7\\ncell:B2:t:INVOICE DETAILS:b:1:1:1:1:l:1:f:8:cf:1:colspan:5\\ncell:C2:t::b:2::2::l:1:f:7\\ncell:D2:t::b:2::2::l:1:f:7\\ncell:E2:t::b:2::2::l:1:f:7\\ncell:F2:b:2:1:1::l:1:f:7\\ncell:G2:b::::1\\ncell:A3:b::2:::l:3:f:7\\ncell:B3:b:2::::l:1:f:7\\ncell:C3:b:2::::l:1:f:7\\ncell:D3:b:2::::l:1:f:7\\ncell:E3:b:2::::l:1:f:7\\ncell:F3:b:1:1:::l:1:f:7\\ncell:G3:b::::1\\ncell:A4:b::2:::l:3:f:7\\ncell:B4:b:::2::l:1:f:7\\ncell:C4:b:::2::l:3:f:4:cf:2\\ncell:D4:b:::2::l:1:f:7\\ncell:E4:b:::2::l:1:f:7\\ncell:F4:b::1:1::l:1:f:7\\ncell:G4:b::::1\\ncell:A5:b::2:::l:3:f:7\\ncell:B5:t:Description:b:1:1:1:1:f:6:cf:1:colspan:3\\ncell:C5:t:Description:b:2::2:2:l:3:f:4:cf:2:colspan:2:rowspan:1\\ncell:D5:t::b:2:2:2::l:1:f:7\\ncell:E5:t:Hours:b:1:1:1:1:f:6:cf:1\\ncell:F5:t:Rate:b:1:1:1:1:f:6:cf:1\\ncell:G5:b::::1\\ncell:A6:b::2:::l:3:f:7\\ncell:B6:b:1:1::1:f:1:cf:2:colspan:3\\ncell:C6:b:1:1::1:l:3:f:7:cf:2:colspan:2:rowspan:1\\ncell:D6:t::b:2:2:2::l:1:f:7\\ncell:E6:b:1:1:::f:1:ntvf:1\\ncell:F6:b:1:1:::f:1:ntvf:1\\ncell:G6:b::::1\\ncell:A7:b::2:::l:3:f:7\\ncell:B7:b::1::1:f:1:cf:2:colspan:3\\ncell:C7:b::1::1:l:1:f:7:colspan:2\\ncell:D7:l:1:f:7\\ncell:E7:b::1:::f:1:ntvf:1\\ncell:F7:b::1:::f:1:ntvf:1\\ncell:G7:b::::1\\ncell:A8:b::2:::l:3:f:7\\ncell:B8:b::1::1:f:1:cf:2:colspan:3\\ncell:C8:b::1::1:colspan:2\\ncell:E8:b::1:::f:1:ntvf:1\\ncell:F8:b::1:::f:1:ntvf:1\\ncell:G8:b::::1\\ncell:A9:b::2:::l:3:f:7\\ncell:B9:b::1::1:f:1:cf:2:colspan:3\\ncell:C9:b::1::1:colspan:2\\ncell:E9:b::1:::f:1:ntvf:1\\ncell:F9:b::1:::f:1:ntvf:1\\ncell:G9:b::::1\\ncell:A10:b::2:::l:3:f:7\\ncell:B10:b::1::1:f:1:cf:2:colspan:3\\ncell:C10:b::1::1:colspan:2\\ncell:E10:b::1:::f:1:ntvf:1\\ncell:F10:b::1:::f:1:ntvf:1\\ncell:G10:b::::1\\ncell:A11:b::2:::l:3:f:7\\ncell:B11:b::1::1:f:1:cf:2:colspan:3\\ncell:C11:b::1::1:colspan:2\\ncell:E11:b::1:::f:1:ntvf:1\\ncell:F11:b::1:::f:1:ntvf:1\\ncell:G11:b::::1\\ncell:A12:b::2:::l:3:f:7\\ncell:B12:b::1::1:f:1:cf:2:colspan:3\\ncell:C12:b::1::1:colspan:2\\ncell:E12:b::1:::f:1:ntvf:1\\ncell:F12:b::1:::f:1:ntvf:1\\ncell:G12:b::::1\\ncell:A13:b::2:::l:3:f:7\\ncell:B13:b::1::1:f:1:cf:2:colspan:3\\ncell:C13:b::1::1:colspan:2\\ncell:E13:b::1:::f:1:ntvf:1\\ncell:F13:b::1:::f:1:ntvf:1\\ncell:G13:b::::1\\ncell:A14:b::2:::l:3:f:7\\ncell:B14:b::1::1:f:1:cf:2:colspan:3\\ncell:C14:b::1::1:colspan:2\\ncell:E14:b::1:::f:1:ntvf:1\\ncell:F14:b::1:::f:1:ntvf:1\\ncell:G14:b::::1\\ncell:A15:b::2:::l:3:f:7\\ncell:B15:b::1::1:f:1:cf:2:colspan:3\\ncell:C15:b::1::1:colspan:2\\ncell:E15:b::1:::f:1:ntvf:1\\ncell:F15:b::1:::f:1:ntvf:1\\ncell:G15:b::::1\\ncell:A16:b::2:::l:3:f:7\\ncell:B16:b::1::1:f:1:cf:2:colspan:3\\ncell:C16:b::1::1:colspan:2\\ncell:E16:b::1:::f:1:ntvf:1\\ncell:F16:b::1:::f:1:ntvf:1\\ncell:G16:b::::1\\ncell:A17:b::2:::l:3:f:7\\ncell:B17:b::1::1:f:1:cf:2:colspan:3\\ncell:C17:b::1::1:colspan:2\\ncell:E17:b::1:::f:1:ntvf:1\\ncell:F17:b::1:::f:1:ntvf:1\\ncell:G17:b::::1\\ncell:A18:b::2:::l:3:f:5\\ncell:B18:b::1:1:1:f:1:cf:2:colspan:3\\ncell:C18:b::1:1:1:l:3:f:7:cf:2:colspan:2\\ncell:D18:b:::2::l:3:f:7:cf:2\\ncell:E18:b::1:1::f:1:ntvf:1\\ncell:F18:b::1:1::f:1:ntvf:1\\ncell:G18:b::::1\\ncell:A19:b::2:::l:3:f:7\\ncell:F19:b::1::\\ncell:G19:b::::1\\ncell:A20:b::2:::l:3:f:7\\ncell:F20:b::1::\\ncell:G20:b::::1\\ncell:A21:b::2:::l:3:f:7\\ncell:C21:t:Thank you for your business:b::1:::f:3:colspan:4\\ncell:D21:t:Thank you for your business:f:2:colspan:4\\ncell:E21:t::l:2:f:7\\ncell:F21:l:2:f:7\\ncell:G21:b::::1\\ncell:A22:b::2:::l:3:f:7\\ncell:F22:b::1::\\ncell:G22:b::::1\\ncell:A23:b::2:::l:3:f:7\\ncell:B23:b:::2::l:3:f:7\\ncell:C23:b:::2::l:3:f:7\\ncell:D23:b:::2::l:3:f:7\\ncell:E23:b:::2::l:3:f:7\\ncell:F23:b::1:1::l:3:f:7\\ncell:G23:b::::1\\ncell:B24:b:1:::\\ncell:C24:b:1:::\\ncell:D24:b:1:::\\ncell:E24:b:1:::\\ncell:F24:b:1:::\\ncol:A:w:10\\ncol:B:w:42\\ncol:C:w:56\\ncol:D:w:39\\ncol:E:w:48\\ncol:F:w:57\\nrow:1:h:14.25\\nrow:2:h:18.75\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:14.25\\nrow:6:h:14.25\\nrow:7:h:14.25\\nrow:8:h:14.25\\nrow:9:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:13:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:16:h:14.25\\nrow:17:h:14.25\\nrow:18:h:15.75\\nrow:19:h:14.25\\nrow:20:h:14.25\\nrow:21:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nsheet:c:7:r:24:h:12.75:needsrecalc:yes\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\nfont:1:* * Trebuchet MS\\nfont:2:italic bold * Trebuchet MS\\nfont:3:italic bold 10pt Trebuchet MS\\nfont:4:normal bold 10pt Arial\\nfont:5:normal bold 12pt Arial\\nfont:6:normal normal * Trebuchet MS\\nfont:7:normal normal 10pt Arial\\nfont:8:normal normal 16pt Arial\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nlayout:3:padding:* * * *;vertical-align:top;\\nvalueformat:1:#,##0.00\\n\" }, \"name\": \"inv3\", \"hidden\": \"0\" }, \"sheet5\": { \"sheetstr\": { \"savestr\": \"version:1.5\\ncell:B1:b:::2::l:1:f:7\\ncell:C1:b:::2::l:1:f:7\\ncell:D1:b:::2::l:1:f:7\\ncell:E1:b:::2::l:1:f:7\\ncell:F1:b:::2::l:1:f:7\\ncell:A2:b::2:::l:1:f:7\\ncell:B2:t:INVOICE DETAILS:b:1:1:1:1:l:1:f:8:cf:1:colspan:5\\ncell:C2:t::b:2::2::l:1:f:7\\ncell:D2:t::b:2::2::l:1:f:7\\ncell:E2:t::b:2::2::l:1:f:7\\ncell:F2:b:2:1:1::l:1:f:7\\ncell:G2:b::::1\\ncell:A3:b::2:::l:3:f:7\\ncell:B3:b:2::::l:1:f:7\\ncell:C3:b:2::::l:1:f:7\\ncell:D3:b:2::::l:1:f:7\\ncell:E3:b:2::::l:1:f:7\\ncell:F3:b:1:1:::l:1:f:7\\ncell:G3:b::::1\\ncell:A4:b::2:::l:3:f:7\\ncell:B4:b:::2::l:1:f:7\\ncell:C4:b:::2::l:3:f:4:cf:2\\ncell:D4:b:::2::l:1:f:7\\ncell:E4:b:::2::l:1:f:7\\ncell:F4:b::1:1::l:1:f:7\\ncell:G4:b::::1\\ncell:A5:b::2:::l:3:f:7\\ncell:B5:t:Description:b:1:1:1:1:f:6:cf:1:colspan:3\\ncell:C5:t:Description:b:2::2:2:l:3:f:4:cf:2:colspan:2:rowspan:1\\ncell:D5:t::b:2:2:2::l:1:f:7\\ncell:E5:t:Qty.:b:1:1:1:1:f:6:cf:1\\ncell:F5:t:Price:b:1:1:1:1:f:6:cf:1\\ncell:G5:b::::1\\ncell:A6:b::2:::l:3:f:7\\ncell:B6:b:1:1::1:f:1:cf:2:colspan:3\\ncell:C6:b:1:1::1:l:3:f:7:cf:2:colspan:2:rowspan:1\\ncell:D6:t::b:2:2:2::l:1:f:7\\ncell:E6:b:1:1:::f:1:ntvf:1\\ncell:F6:b:1:1:::f:1:ntvf:1\\ncell:G6:b::::1\\ncell:A7:b::2:::l:3:f:7\\ncell:B7:b::1::1:f:1:cf:2:colspan:3\\ncell:C7:b::1::1:l:1:f:7:colspan:2\\ncell:D7:l:1:f:7\\ncell:E7:b::1:::f:1:ntvf:1\\ncell:F7:b::1:::f:1:ntvf:1\\ncell:G7:b::::1\\ncell:A8:b::2:::l:3:f:7\\ncell:B8:b::1::1:f:1:cf:2:colspan:3\\ncell:C8:b::1::1:colspan:2\\ncell:E8:b::1:::f:1:ntvf:1\\ncell:F8:b::1:::f:1:ntvf:1\\ncell:G8:b::::1\\ncell:A9:b::2:::l:3:f:7\\ncell:B9:b::1::1:f:1:cf:2:colspan:3\\ncell:C9:b::1::1:colspan:2\\ncell:E9:b::1:::f:1:ntvf:1\\ncell:F9:b::1:::f:1:ntvf:1\\ncell:G9:b::::1\\ncell:A10:b::2:::l:3:f:7\\ncell:B10:b::1::1:f:1:cf:2:colspan:3\\ncell:C10:b::1::1:colspan:2\\ncell:E10:b::1:::f:1:ntvf:1\\ncell:F10:b::1:::f:1:ntvf:1\\ncell:G10:b::::1\\ncell:A11:b::2:::l:3:f:7\\ncell:B11:b::1::1:f:1:cf:2:colspan:3\\ncell:C11:b::1::1:colspan:2\\ncell:E11:b::1:::f:1:ntvf:1\\ncell:F11:b::1:::f:1:ntvf:1\\ncell:G11:b::::1\\ncell:A12:b::2:::l:3:f:7\\ncell:B12:b::1::1:f:1:cf:2:colspan:3\\ncell:C12:b::1::1:colspan:2\\ncell:E12:b::1:::f:1:ntvf:1\\ncell:F12:b::1:::f:1:ntvf:1\\ncell:G12:b::::1\\ncell:A13:b::2:::l:3:f:7\\ncell:B13:b::1::1:f:1:cf:2:colspan:3\\ncell:C13:b::1::1:colspan:2\\ncell:E13:b::1:::f:1:ntvf:1\\ncell:F13:b::1:::f:1:ntvf:1\\ncell:G13:b::::1\\ncell:A14:b::2:::l:3:f:7\\ncell:B14:b::1::1:f:1:cf:2:colspan:3\\ncell:C14:b::1::1:colspan:2\\ncell:E14:b::1:::f:1:ntvf:1\\ncell:F14:b::1:::f:1:ntvf:1\\ncell:G14:b::::1\\ncell:A15:b::2:::l:3:f:7\\ncell:B15:b::1::1:f:1:cf:2:colspan:3\\ncell:C15:b::1::1:colspan:2\\ncell:E15:b::1:::f:1:ntvf:1\\ncell:F15:b::1:::f:1:ntvf:1\\ncell:G15:b::::1\\ncell:A16:b::2:::l:3:f:7\\ncell:B16:b::1::1:f:1:cf:2:colspan:3\\ncell:C16:b::1::1:colspan:2\\ncell:E16:b::1:::f:1:ntvf:1\\ncell:F16:b::1:::f:1:ntvf:1\\ncell:G16:b::::1\\ncell:A17:b::2:::l:3:f:7\\ncell:B17:b::1::1:f:1:cf:2:colspan:3\\ncell:C17:b::1::1:colspan:2\\ncell:E17:b::1:::f:1:ntvf:1\\ncell:F17:b::1:::f:1:ntvf:1\\ncell:G17:b::::1\\ncell:A18:b::2:::l:3:f:5\\ncell:B18:b::1:1:1:f:1:cf:2:colspan:3\\ncell:C18:b::1:1:1:l:3:f:7:cf:2:colspan:2\\ncell:D18:b:::2::l:3:f:7:cf:2\\ncell:E18:b::1:1::f:1:ntvf:1\\ncell:F18:b::1:1::f:1:ntvf:1\\ncell:G18:b::::1\\ncell:A19:b::2:::l:3:f:7\\ncell:F19:b::1::\\ncell:G19:b::::1\\ncell:A20:b::2:::l:3:f:7\\ncell:F20:b::1::\\ncell:G20:b::::1\\ncell:A21:b::2:::l:3:f:7\\ncell:C21:t:Thank you for your business:b::1:::f:3:colspan:4\\ncell:D21:t:Thank you for your business:f:2:colspan:4\\ncell:E21:t::l:2:f:7\\ncell:F21:l:2:f:7\\ncell:G21:b::::1\\ncell:A22:b::2:::l:3:f:7\\ncell:F22:b::1::\\ncell:G22:b::::1\\ncell:A23:b::2:::l:3:f:7\\ncell:B23:b:::2::l:3:f:7\\ncell:C23:b:::2::l:3:f:7\\ncell:D23:b:::2::l:3:f:7\\ncell:E23:b:::2::l:3:f:7\\ncell:F23:b::1:1::l:3:f:7\\ncell:G23:b::::1\\ncell:B24:b:1:::\\ncell:C24:b:1:::\\ncell:D24:b:1:::\\ncell:E24:b:1:::\\ncell:F24:b:1:::\\ncol:A:w:10\\ncol:B:w:42\\ncol:C:w:56\\ncol:D:w:39\\ncol:E:w:48\\ncol:F:w:57\\nrow:1:h:14.25\\nrow:2:h:18.75\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:14.25\\nrow:6:h:14.25\\nrow:7:h:14.25\\nrow:8:h:14.25\\nrow:9:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:13:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:16:h:14.25\\nrow:17:h:14.25\\nrow:18:h:15.75\\nrow:19:h:14.25\\nrow:20:h:14.25\\nrow:21:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nsheet:c:7:r:24:h:12.75:needsrecalc:yes\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\nfont:1:* * Trebuchet MS\\nfont:2:italic bold * Trebuchet MS\\nfont:3:italic bold 10pt Trebuchet MS\\nfont:4:normal bold 10pt Arial\\nfont:5:normal bold 12pt Arial\\nfont:6:normal normal * Trebuchet MS\\nfont:7:normal normal 10pt Arial\\nfont:8:normal normal 16pt Arial\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nlayout:3:padding:* * * *;vertical-align:top;\\nvalueformat:1:#,##0.00\\n\" }, \"name\": \"sheet7\", \"hidden\": \"0\" } }, \"EditableCells\": { \"allow\": true, \"cells\": { \"inv1!B2\": true, \"inv1!C5\": true, \"inv1!C6\": true, \"inv1!C7\": true, \"inv1!C8\": true, \"inv1!C9\": true, \"inv1!C11\": true, \"inv1!C12\": true, \"inv1!C13\": true, \"inv1!C14\": true, \"inv1!C15\": true, \"inv1!C16\": true, \"inv1!C18\": true, \"inv1!C20\": true, \"inv1!D20\": true, \"inv1!C23\": true, \"inv1!C24\": true, \"inv1!C25\": true, \"inv1!C26\": true, \"inv1!C27\": true, \"inv1!C28\": true, \"inv1!C29\": true, \"inv1!C30\": true, \"inv1!C31\": true, \"inv1!C32\": true, \"inv1!C33\": true, \"inv1!C34\": true, \"inv1!C35\": true, \"inv1!F23\": true, \"inv1!F24\": true, \"inv1!F25\": true, \"inv1!F26\": true, \"inv1!F27\": true, \"inv1!F28\": true, \"inv1!F29\": true, \"inv1!F30\": true, \"inv1!F31\": true, \"inv1!F32\": true, \"inv1!F33\": true, \"inv1!F34\": true, \"inv1!F35\": true, \"inv2!B2\": true, \"inv2!F4\": true, \"inv2!G4\": true, \"inv2!B5\": true, \"inv2!B7\": true, \"inv2!B8\": true, \"inv2!B9\": true, \"inv2!B10\": true, \"inv2!B11\": true, \"inv2!B12\": true, \"inv2!B14\": true, \"inv2!B15\": true, \"inv2!B16\": true, \"inv2!B17\": true, \"inv2!B18\": true, \"inv2!B19\": true, \"inv2!B20\": true, \"inv2!B23\": true, \"inv2!B24\": true, \"inv2!B25\": true, \"inv2!B26\": true, \"inv2!B27\": true, \"inv2!B28\": true, \"inv2!B29\": true, \"inv2!B30\": true, \"inv2!B31\": true, \"inv2!B32\": true, \"inv2!B33\": true, \"inv2!B34\": true, \"inv2!B35\": true, \"inv2!G23\": true, \"inv2!G24\": true, \"inv2!G25\": true, \"inv2!G26\": true, \"inv2!G27\": true, \"inv2!G28\": true, \"inv2!G29\": true, \"inv2!G30\": true, \"inv2!G31\": true, \"inv2!G32\": true, \"inv2!G33\": true, \"inv2!G34\": true, \"inv2!G35\": true, \"inv2!B38\": true, \"inv2!B39\": true, \"inv2!B40\": true, \"inv2!F36\": true, \"inv2!G37\": true, \"inv2!F37\": true, \"inv2!F39\": true, \"inv2!G39\": true, \"inv2!F38\": true, \"sheet6!B2\": true, \"sheet6!F4\": true, \"sheet6!G4\": true, \"sheet6!B5\": true, \"sheet6!B7\": true, \"sheet6!B8\": true, \"sheet6!B9\": true, \"sheet6!B10\": true, \"sheet6!B11\": true, \"sheet6!B12\": true, \"sheet6!B14\": true, \"sheet6!B15\": true, \"sheet6!B16\": true, \"sheet6!B17\": true, \"sheet6!B18\": true, \"sheet6!B19\": true, \"sheet6!B20\": true, \"sheet6!B38\": true, \"sheet6!B39\": true, \"sheet6!B40\": true, \"sheet6!F36\": true, \"sheet6!G37\": true, \"sheet6!F37\": true, \"sheet6!F39\": true, \"sheet6!G39\": true, \"sheet6!F38\": true, \"inv3!B2\": true, \"inv3!B6\": true, \"inv3!B7\": true, \"inv3!B8\": true, \"inv3!B9\": true, \"inv3!B10\": true, \"inv3!B11\": true, \"inv3!B12\": true, \"inv3!B13\": true, \"inv3!B14\": true, \"inv3!B15\": true, \"inv3!B16\": true, \"inv3!B17\": true, \"inv3!B18\": true, \"inv3!E6\": true, \"inv3!E7\": true, \"inv3!E8\": true, \"inv3!E9\": true, \"inv3!E10\": true, \"inv3!E11\": true, \"inv3!E12\": true, \"inv3!E13\": true, \"inv3!E14\": true, \"inv3!E15\": true, \"inv3!E16\": true, \"inv3!E17\": true, \"inv3!E18\": true, \"inv3!F6\": true, \"inv3!F7\": true, \"inv3!F8\": true, \"inv3!F9\": true, \"inv3!F10\": true, \"inv3!F11\": true, \"inv3!F12\": true, \"inv3!F13\": true, \"inv3!F14\": true, \"inv3!F15\": true, \"inv3!F16\": true, \"inv3!F17\": true, \"inv3!F18\": true, \"sheet7!F6\": true, \"sheet7!F7\": true, \"sheet7!F8\": true, \"sheet7!F9\": true, \"sheet7!F10\": true, \"sheet7!F11\": true, \"sheet7!F12\": true, \"sheet7!F13\": true, \"sheet7!F14\": true, \"sheet7!F15\": true, \"sheet7!F16\": true, \"sheet7!F17\": true, \"sheet7!F18\": true, \"sheet7!E6\": true, \"sheet7!E7\": true, \"sheet7!E8\": true, \"sheet7!E9\": true, \"sheet7!E10\": true, \"sheet7!E11\": true, \"sheet7!E12\": true, \"sheet7!E13\": true, \"sheet7!E14\": true, \"sheet7!E15\": true, \"sheet7!E16\": true, \"sheet7!E17\": true, \"sheet7!E18\": true, \"sheet7!B6\": true, \"sheet7!B2\": true, \"sheet7!B7\": true, \"sheet7!B8\": true, \"sheet7!B9\": true, \"sheet7!B10\": true, \"sheet7!B11\": true, \"sheet7!B12\": true, \"sheet7!B13\": true, \"sheet7!B14\": true, \"sheet7!B15\": true, \"sheet7!B16\": true, \"sheet7!B17\": true, \"sheet7!B18\": true, \"inv1!D8\": true, \"inv1!D15\": true, \"inv1!D18\": true, \"inv2!C5\": true, \"sheet6!C5\": true }, \"constraints\": { \"inv1!C5\": [\"prompttext\", \"0\", \"1e10\", \"Name\"], \"inv1!C6\": [\"prompttext\", \"0\", \"1e10\", \"Street Address\"], \"inv1!C7\": [\"prompttext\", \"0\", \"1e10\", \"City, State, Zip\"], \"inv1!C8\": [\"prompttext\", \"0\", \"1e10\", \"Phone\"], \"inv1!C9\": [\"promptemail\", \"0\", \"1e10\", \"Email\"], \"inv1!C11\": [\"prompttext\", \"0\", \"1e10\", \"From\"], \"inv1!C12\": [\"prompttext\", \"0\", \"1e10\", \"Name\"], \"inv1!C13\": [\"prompttext\", \"0\", \"1e10\", \"Street Address\"], \"inv1!C14\": [\"prompttext\", \"0\", \"1e10\", \"City, State, Zip\"], \"inv1!C15\": [\"prompttext\", \"0\", \"1e10\", \"Phone\"], \"inv1!C16\": [\"promptemail\", \"0\", \"1e10\", \"Email\"], \"inv1!C18\": [\"prompttext\", \"0\", \"1e10\", \"Invoice #\"], \"inv1!C20\": [\"prompttext\", \"0\", \"1e10\", \"Date\"], \"inv1!D20\": [\"prompttext\", \"0\", \"1e10\", \"Date\"], \"inv1!C23\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv1!C24\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv1!C25\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv1!C26\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv1!C27\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv1!C28\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv1!C29\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv1!C30\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv1!C31\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv1!C32\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv1!C33\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv1!C34\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv1!C35\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv1!F23\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv1!F24\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv1!F25\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv1!F26\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv1!F27\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv1!F28\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv1!F29\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv1!F30\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv1!F31\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv1!F32\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv1!F33\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv1!F34\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv1!F35\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv2!B2\": [\"prompttext\", \"0\", \"1e10\", \"Invoice\"], \"inv2!F4\": [\"prompttext\", \"0\", \"1e10\", \"Date\"], \"inv2!G4\": [\"prompttext\", \"0\", \"1e10\", \"Date\"], \"inv2!B5\": [\"prompttext\", \"0\", \"1e10\", \"Invoice #\"], \"inv2!B7\": [\"prompttext\", \"0\", \"1e10\", \"From\"], \"inv2!B8\": [\"prompttext\", \"0\", \"1e10\", \"Company Name\"], \"inv2!B9\": [\"prompttext\", \"0\", \"1e10\", \"Street Address\"], \"inv2!B10\": [\"prompttext\", \"0\", \"1e10\", \"City, State, Zip\"], \"inv2!B11\": [\"prompttext\", \"0\", \"1e10\", \"Phone\"], \"inv2!B12\": [\"promptemail\", \"0\", \"1e10\", \"Email\"], \"inv2!B14\": [\"prompttext\", \"0\", \"1e10\", \"Bill To\"], \"inv2!B15\": [\"prompttext\", \"0\", \"1e10\", \"Name\"], \"inv2!B16\": [\"prompttext\", \"0\", \"1e10\", \"Company Name\"], \"inv2!B17\": [\"prompttext\", \"0\", \"1e10\", \"Street Address\"], \"inv2!B18\": [\"prompttext\", \"0\", \"1e10\", \"City, State, Zip\"], \"inv2!B19\": [\"prompttext\", \"0\", \"1e10\", \"Phone\"], \"inv2!B20\": [\"promptemail\", \"0\", \"1e10\", \"Email\"], \"inv2!B23\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv2!B24\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv2!B25\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv2!B26\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv2!B27\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv2!B28\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv2!B29\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv2!B30\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv2!B31\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv2!B32\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv2!B33\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv2!B34\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv2!B35\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv2!G23\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv2!G24\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv2!G25\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv2!G26\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv2!G27\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv2!G28\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv2!G29\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv2!G30\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv2!G31\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv2!G32\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv2!G33\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv2!G34\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv2!G35\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv2!B38\": [\"prompttext\", \"0\", \"1e10\", \"Notes\"], \"inv2!B39\": [\"prompttext\", \"0\", \"1e10\", \"Notes\"], \"inv2!B40\": [\"prompttext\", \"0\", \"1e10\", \"Notes\"], \"inv2!F36\": [\"prompttext\", \"0\", \"1e10\", \"Subtotal\"], \"inv2!G37\": [\"promptdecimal\", \"0\", \"1e10\", \"Tax Rate (0.00)\"], \"inv2!F37\": [\"prompttext\", \"0\", \"1e10\", \"Tax Rate\"], \"inv2!F39\": [\"prompttext\", \"0\", \"1e10\", \"Other\"], \"inv2!G39\": [\"promptdecimal\", \"0\", \"1e10\", \"Other\"], \"inv2!F38\": [\"prompttext\", \"0\", \"1e10\", \"Tax\"], \"sheet6!B2\": [\"prompttext\", \"0\", \"1e10\", \"Invoice\"], \"sheet6!F4\": [\"prompttext\", \"0\", \"1e10\", \"Date\"], \"sheet6!G4\": [\"prompttext\", \"0\", \"1e10\", \"Date\"], \"sheet6!B5\": [\"prompttext\", \"0\", \"1e10\", \"Invoice #\"], \"sheet6!B7\": [\"prompttext\", \"0\", \"1e10\", \"From\"], \"sheet6!B8\": [\"prompttext\", \"0\", \"1e10\", \"Company Name\"], \"sheet6!B9\": [\"prompttext\", \"0\", \"1e10\", \"Street Address\"], \"sheet6!B10\": [\"prompttext\", \"0\", \"1e10\", \"City, State, Zip\"], \"sheet6!B11\": [\"prompttext\", \"0\", \"1e10\", \"Phone\"], \"sheet6!B12\": [\"promptemail\", \"0\", \"1e10\", \"Email\"], \"sheet6!B14\": [\"prompttext\", \"0\", \"1e10\", \"Bill To\"], \"sheet6!B15\": [\"prompttext\", \"0\", \"1e10\", \"Name\"], \"sheet6!B16\": [\"prompttext\", \"0\", \"1e10\", \"Company Name\"], \"sheet6!B17\": [\"prompttext\", \"0\", \"1e10\", \"Street Address\"], \"sheet6!B18\": [\"prompttext\", \"0\", \"1e10\", \"City, State, Zip\"], \"sheet6!B19\": [\"prompttext\", \"0\", \"1e10\", \"Phone\"], \"sheet6!B20\": [\"promptemail\", \"0\", \"1e10\", \"Email\"], \"sheet6!B38\": [\"prompttext\", \"0\", \"1e10\", \"Notes\"], \"sheet6!B39\": [\"prompttext\", \"0\", \"1e10\", \"Notes\"], \"sheet6!B40\": [\"prompttext\", \"0\", \"1e10\", \"Notes\"], \"sheet6!F36\": [\"prompttext\", \"0\", \"1e10\", \"Subtotal\"], \"sheet6!G37\": [\"promptdecimal\", \"0\", \"1e10\", \"Tax Rate (0.00)\"], \"sheet6!F37\": [\"prompttext\", \"0\", \"1e10\", \"Tax Rate\"], \"sheet6!F39\": [\"prompttext\", \"0\", \"1e10\", \"Other\"], \"sheet6!G39\": [\"promptdecimal\", \"0\", \"1e10\", \"Other\"], \"sheet6!F38\": [\"prompttext\", \"0\", \"1e10\", \"Tax\"], \"inv3!B6\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv3!B7\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv3!B8\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv3!B9\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv3!B10\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv3!B11\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv3!B12\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv3!B13\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv3!B14\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv3!B15\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv3!B16\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv3!B17\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv3!B18\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"sheet7!B6\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"sheet7!B7\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"sheet7!B8\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"sheet7!B9\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"sheet7!B10\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"sheet7!B11\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"sheet7!B12\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"sheet7!B13\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"sheet7!B14\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"sheet7!B15\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"sheet7!B16\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"sheet7!B17\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"sheet7!B18\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv1!D8\": [\"prompttext\", \"0\", \"1e10\", \"Phone\"], \"inv1!D15\": [\"prompttext\", \"0\", \"1e10\", \"Phone\"], \"inv1!D18\": [\"promptnumeric\", \"0\", \"1e10\", \"Invoice#\"], \"inv2!C5\": [\"promptnumeric\", \"0\", \"1e10\", \"Invoice#\"], \"sheet6!C5\": [\"promptnumeric\", \"0\", \"1e10\", \"Invoice#\"], \"sheet7!E6\": [\"promptdecimal\", \"0\", \"1e10\", \"Quantity\"], \"sheet7!E7\": [\"promptdecimal\", \"0\", \"1e10\", \"Quantity\"], \"sheet7!E8\": [\"promptdecimal\", \"0\", \"1e10\", \"Quantity\"], \"sheet7!E9\": [\"promptdecimal\", \"0\", \"1e10\", \"Quantity\"], \"sheet7!E10\": [\"promptdecimal\", \"0\", \"1e10\", \"Quantity\"], \"sheet7!E11\": [\"promptdecimal\", \"0\", \"1e10\", \"Quantity\"], \"sheet7!E12\": [\"promptdecimal\", \"0\", \"1e10\", \"Quantity\"], \"sheet7!E13\": [\"promptdecimal\", \"0\", \"1e10\", \"Quantity\"], \"sheet7!E14\": [\"promptdecimal\", \"0\", \"1e10\", \"Quantity\"], \"sheet7!E15\": [\"promptdecimal\", \"0\", \"1e10\", \"Quantity\"], \"sheet7!E16\": [\"promptdecimal\", \"0\", \"1e10\", \"Quantity\"], \"sheet7!E17\": [\"promptdecimal\", \"0\", \"1e10\", \"Quantity\"], \"sheet7!E18\": [\"promptdecimal\", \"0\", \"1e10\", \"Quantity\"], \"sheet7!F6\": [\"promptdecimal\", \"0\", \"1e10\", \"Price\"], \"sheet7!F7\": [\"promptdecimal\", \"0\", \"1e10\", \"Price\"], \"sheet7!F8\": [\"promptdecimal\", \"0\", \"1e10\", \"Price\"], \"sheet7!F9\": [\"promptdecimal\", \"0\", \"1e10\", \"Price\"], \"sheet7!F10\": [\"promptdecimal\", \"0\", \"1e10\", \"Price\"], \"sheet7!F11\": [\"promptdecimal\", \"0\", \"1e10\", \"Price\"], \"sheet7!F12\": [\"promptdecimal\", \"0\", \"1e10\", \"Price\"], \"sheet7!F13\": [\"promptdecimal\", \"0\", \"1e10\", \"Price\"], \"sheet7!F14\": [\"promptdecimal\", \"0\", \"1e10\", \"Price\"], \"sheet7!F15\": [\"promptdecimal\", \"0\", \"1e10\", \"Price\"], \"sheet7!F16\": [\"promptdecimal\", \"0\", \"1e10\", \"Price\"], \"sheet7!F17\": [\"promptdecimal\", \"0\", \"1e10\", \"Price\"], \"sheet7!F18\": [\"promptdecimal\", \"0\", \"1e10\", \"Price\"], \"inv3!E6\": [\"promptdecimal\", \"0\", \"1e10\", \"Hours\"], \"inv3!E7\": [\"promptdecimal\", \"0\", \"1e10\", \"Hours\"], \"inv3!E8\": [\"promptdecimal\", \"0\", \"1e10\", \"Hours\"], \"inv3!E9\": [\"promptdecimal\", \"0\", \"1e10\", \"Hours\"], \"inv3!E10\": [\"promptdecimal\", \"0\", \"1e10\", \"Hours\"], \"inv3!E11\": [\"promptdecimal\", \"0\", \"1e10\", \"Hours\"], \"inv3!E12\": [\"promptdecimal\", \"0\", \"1e10\", \"Hours\"], \"inv3!E13\": [\"promptdecimal\", \"0\", \"1e10\", \"Hours\"], \"inv3!E14\": [\"promptdecimal\", \"0\", \"1e10\", \"Hours\"], \"inv3!E15\": [\"promptdecimal\", \"0\", \"1e10\", \"Hours\"], \"inv3!E16\": [\"promptdecimal\", \"0\", \"1e10\", \"Hours\"], \"inv3!E17\": [\"promptdecimal\", \"0\", \"1e10\", \"Hours\"], \"inv3!E18\": [\"promptdecimal\", \"0\", \"1e10\", \"Hours\"], \"inv3!F6\": [\"promptdecimal\", \"0\", \"1e10\", \"Rate\"], \"inv3!F7\": [\"promptdecimal\", \"0\", \"1e10\", \"Rate\"], \"inv3!F8\": [\"promptdecimal\", \"0\", \"1e10\", \"Rate\"], \"inv3!F9\": [\"promptdecimal\", \"0\", \"1e10\", \"Rate\"], \"inv3!F10\": [\"promptdecimal\", \"0\", \"1e10\", \"Rate\"], \"inv3!F11\": [\"promptdecimal\", \"0\", \"1e10\", \"Rate\"], \"inv3!F12\": [\"promptdecimal\", \"0\", \"1e10\", \"Rate\"], \"inv3!F13\": [\"promptdecimal\", \"0\", \"1e10\", \"Rate\"], \"inv3!F14\": [\"promptdecimal\", \"0\", \"1e10\", \"Rate\"], \"inv3!F15\": [\"promptdecimal\", \"0\", \"1e10\", \"Rate\"], \"inv3!F16\": [\"promptdecimal\", \"0\", \"1e10\", \"Rate\"], \"inv3!F17\": [\"promptdecimal\", \"0\", \"1e10\", \"Rate\"], \"inv3!F18\": [\"promptdecimal\", \"0\", \"1e10\", \"Rate\"] } } },\n\t                                                \"footers\": [{ name: 'Type1', index: 1, isActive: true }, { name: 'Type2', index: 2, isActive: false }, { name: 'Type3', index: 3, isActive: false }, { name: 'Detail1', index: 4, isActive: false }, { name: 'Detail2', index: 5, isActive: false }]\n\t                                }\n\t                },\n\t                \"home\": {\n\t                                \"iPad\": {\n\t                                                \"msc\": { \"numsheets\": 4, \"currentid\": \"sheet1\", \"currentname\": \"typei\", \"sheetArr\": { \"sheet1\": { \"sheetstr\": { \"savestr\": \"version:1.5\\ncell:A2:b::2:::l:1:f:7\\ncell:B2:t:INVOICE:b:1:1:1:1:f:6:cf:1:colspan:6\\ncell:C2:t::b:2::2::l:1:f:7\\ncell:D2:t::b:2::2::l:1:f:7\\ncell:E2:t::b:2::2::l:1:f:7\\ncell:F2:t::b:2::2::l:1:f:7\\ncell:G2:t::b:2::2::l:1:f:7\\ncell:A3:b::2:::l:3:f:7\\ncell:B3:b:2:::2:l:3:f:7\\ncell:C3:b:2::::l:1:f:7\\ncell:D3:b:2::::l:1:f:7\\ncell:E3:b:2::::l:1:f:7\\ncell:F3:b:2::::l:1:f:7\\ncell:G3:b:2:2:::l:3:f:7\\ncell:A4:b::2:::l:3:f:7\\ncell:B4:b::::2:l:3:f:3\\ncell:C4:t:INVOICE # \\\\c:f:2:cf:2\\ncell:D4:v:1:f:2:cf:2\\ncell:F4:tvf:4:rowspan:4\\ncell:G4:b::2:::l:3:f:7\\ncell:A5:b::2:::l:3:f:7\\ncell:B5:b::::2:l:3:f:4\\ncell:F5:t::l:2:f:7\\ncell:G5:t::b::1:::l:2:f:7\\ncell:A6:b::2:::l:3:f:7\\ncell:B6:b::::2:l:3:f:4\\ncell:C6:t:INVOICE DATE\\\\c:f:2:cf:2\\ncell:D6:f:2:cf:2:ntvf:3\\ncell:F6:l:2:f:7\\ncell:G6:b::1:::l:2:f:7\\ncell:A7:b::2:::l:3:f:7\\ncell:B7:b::::2:l:3:f:4\\ncell:G7:b::2:::l:3:f:7\\ncell:A8:b::2:::l:3:f:7\\ncell:B8:b::::2:l:3:f:4\\ncell:G8:b::2:::l:3:f:7\\ncell:A9:b::2:::l:3:f:7\\ncell:B9:b::::2:l:3:f:4\\ncell:C9:t:BILL TO\\\\c:l:3:f:2\\ncell:E9:t:FROM\\\\c:f:2:cf:2\\ncell:G9:b::2:::l:3:f:7\\ncell:A10:b::2:::l:3:f:7\\ncell:B10:b::::2:l:3:f:3\\ncell:C10:t:[Name]:f:1:cf:2:colspan:2\\ncell:E10:t:[Name]:f:1:cf:2:colspan:2\\ncell:G10:b::2:::l:3:f:7\\ncell:A11:b::2:::l:3:f:7\\ncell:B11:b::::2:l:3:f:7\\ncell:C11:t:[Street Address]:f:1:cf:2:colspan:2\\ncell:E11:t:[Street Address]:f:1:cf:2:colspan:2\\ncell:G11:b::2:::l:3:f:7\\ncell:A12:b::2:::l:3:f:7\\ncell:B12:b::::2:l:3:f:7\\ncell:C12:t:[City, State, Zip]:f:1:cf:2:colspan:2\\ncell:E12:t:[City, State, Zip]:f:1:cf:2:colspan:2\\ncell:G12:b::2:::l:3:f:7\\ncell:A13:b::2:::l:3:f:7\\ncell:B13:b::::2:l:3:f:7\\ncell:C13:t:Phone\\\\c:f:1:cf:2:colspan:2\\ncell:E13:t:Phone\\\\c:f:1:cf:2:colspan:2\\ncell:G13:b::2:::l:3:f:7\\ncell:A14:b::2:::l:3:f:7\\ncell:B14:b::::2:l:3:f:3:cf:2\\ncell:C14:b:::2::l:1:f:7\\ncell:D14:b:::2::l:3:f:3:cf:2\\ncell:E14:b:::2::l:1:f:7\\ncell:F14:b:::2::l:1:f:7\\ncell:G14:b::2:::l:3:f:7\\ncell:A15:b::2:::l:3:f:7\\ncell:B15:b::2::2:l:3:f:7\\ncell:C15:t:Description:b:1::1:1:f:2:cf:1:colspan:3\\ncell:D15:t:Description:b:1::1::l:3:f:3:cf:2:colspan:2:rowspan:1\\ncell:E15:t::b:2:2:2::l:1:f:7\\ncell:F15:t:Amount:b:1:1:1:1:f:2:cf:1\\ncell:G15:b::2::2:l:3:f:7\\ncell:A16:b::2:::l:3:f:7\\ncell:B16:b::2::2:l:3:f:7\\ncell:C16:b:1:1::1:f:1:cf:2:colspan:3\\ncell:D16:b:1:1:::l:3:f:7:cf:2:colspan:2:rowspan:1\\ncell:E16:t::b:2:2:2::l:1:f:7\\ncell:F16:b:1:1:::f:1:ntvf:1\\ncell:G16:b::2::2:l:3:f:7\\ncell:A17:b::2:::l:3:f:7\\ncell:B17:b::2::2:l:3:f:7:cf:2\\ncell:C17:b::1::1:f:1:cf:2:colspan:3\\ncell:D17:b::1:::l:1:f:7:colspan:2\\ncell:E17:l:1:f:7\\ncell:F17:b::1:::f:1:ntvf:1\\ncell:G17:b::2::2:l:3:f:7\\ncell:A18:b::2:::l:3:f:7\\ncell:B18:b::2::2:l:3:f:7:cf:2:ntvf:2\\ncell:C18:b::1::1:f:1:cf:2:colspan:3\\ncell:D18:b::1:::colspan:2\\ncell:F18:b::1:::f:1:ntvf:1\\ncell:G18:b::2::2:l:3:f:7\\ncell:A19:b::2:::l:3:f:7\\ncell:B19:b::2::2:l:3:f:7:cf:2:ntvf:2\\ncell:C19:b::1::1:f:1:cf:2:colspan:3\\ncell:D19:b::1:::colspan:2\\ncell:F19:b::1:::f:1:ntvf:1\\ncell:G19:b::2::2:l:3:f:7\\ncell:A20:b::2:::l:3:f:7\\ncell:B20:b::2::2:l:3:f:7:cf:2:ntvf:2\\ncell:C20:b::1::1:f:1:cf:2:colspan:3\\ncell:D20:b::1:::colspan:2\\ncell:F20:b::1:::f:1:ntvf:1\\ncell:G20:b::2::2:l:3:f:7\\ncell:A21:b::2:::l:3:f:7\\ncell:B21:b::2::2:l:3:f:7:cf:2:ntvf:2\\ncell:C21:b::1::1:f:1:cf:2:colspan:3\\ncell:D21:b::1:::colspan:2\\ncell:F21:b::1:::f:1:ntvf:1\\ncell:G21:b::2::2:l:3:f:7\\ncell:A22:b::2:::l:3:f:7\\ncell:B22:b::2::2:l:3:f:7:cf:2:ntvf:2\\ncell:C22:b::1::1:f:1:cf:2:colspan:3\\ncell:D22:b::1:::colspan:2\\ncell:F22:b::1:::f:1:ntvf:1\\ncell:G22:b::2::2:l:3:f:7\\ncell:A23:b::2:::l:3:f:7\\ncell:B23:b::2::2:l:3:f:7:cf:2\\ncell:C23:b::1::1:f:1:cf:2:colspan:3\\ncell:D23:b::1:::colspan:2\\ncell:F23:b::1:::f:1:ntvf:1\\ncell:G23:b::2::2:l:3:f:7\\ncell:A24:b::2:::l:3:f:7\\ncell:B24:b::2::2:l:3:f:7:cf:2\\ncell:C24:b::1::1:f:1:cf:2:colspan:3\\ncell:D24:b::1:::colspan:2\\ncell:F24:b::1:::f:1:ntvf:1\\ncell:G24:b::2::2:l:3:f:7\\ncell:A25:b::2:::l:3:f:7\\ncell:B25:b::2::2:l:3:f:7:cf:2\\ncell:C25:b::1::1:f:1:cf:2:colspan:3\\ncell:D25:b::1:::colspan:2\\ncell:F25:b::1:::f:1:ntvf:1\\ncell:G25:b::2::2:l:3:f:7\\ncell:A26:b::2:::l:3:f:7\\ncell:B26:b::2::2:l:3:f:7:cf:2\\ncell:C26:b::1::1:f:1:cf:2:colspan:3\\ncell:D26:b::1:::colspan:2\\ncell:F26:b::1:::f:1:ntvf:1\\ncell:G26:b::2::2:l:3:f:7\\ncell:A27:b::2:::l:3:f:7\\ncell:B27:b::2::2:l:3:f:7:cf:2\\ncell:C27:b::1::1:f:1:cf:2:colspan:3\\ncell:D27:b::1:::colspan:2\\ncell:F27:b::1:::f:1:ntvf:1\\ncell:G27:b::2::2:l:3:f:7\\ncell:A28:b::2:::l:3:f:4\\ncell:B28:b::2::2:l:3:f:7:cf:2\\ncell:C28:b::1:1:1:f:1:cf:2:colspan:3\\ncell:D28:b::1:1::l:3:f:7:cf:2:colspan:2\\ncell:E28:b:::2::l:3:f:7:cf:2\\ncell:F28:b::1:1::f:1:ntvf:1\\ncell:G28:b::2::2:l:3:f:7\\ncell:A29:b::2:::l:3:f:3\\ncell:B29:b::2::2:l:3:f:3\\ncell:C29:t:TOTAL:b:1:1:1:1:f:5:cf:2:colspan:3\\ncell:D29:b:2::2::l:3:f:8:cf:2\\ncell:E29:b:2:2:2::l:3:f:8:cf:2\\ncell:F29:vtf:n:0:SUM(F16\\\\cF28):b:1:1:1::f:5:ntvf:1\\ncell:G29:b::2::2:l:3:f:4\\ncell:A30:b::2:::l:3:f:7\\ncell:B30:b::::2:l:3:f:3:cf:2\\ncell:C30:b:2::::l:1:f:7\\ncell:D30:b:2::::l:1:f:7\\ncell:E30:b:2::::l:1:f:7\\ncell:F30:b:2::::l:1:f:7\\ncell:G30:b::2:::l:3:f:3\\ncell:A31:b::2:::l:3:f:7\\ncell:B31:b::::2:l:3:f:7\\ncell:D31:tvf:4:rowspan:4\\ncell:G31:b::2:::l:3:f:7\\ncell:A32:b::2:::l:3:f:7\\ncell:B32:b::::2:l:3:f:7\\ncell:G32:b::2:::l:3:f:7\\ncell:A33:b::2:::l:3:f:7\\ncell:B33:b::::2:l:3:f:7\\ncell:G33:b::2:::l:3:f:7\\ncell:A34:b::2:::l:3:f:7\\ncell:B34:b::::2:l:3:f:7\\ncell:G34:b::2:::l:3:f:7\\ncell:A35:b::2:::l:3:f:7\\ncell:B35:b:::2:2:l:3:f:7\\ncell:C35:b:::2::l:3:f:7\\ncell:D35:b:::2::l:3:f:7\\ncell:E35:b:::2::l:3:f:7\\ncell:F35:b:::2::l:3:f:7\\ncell:G35:b::2:2::l:3:f:7\\ncell:B36:b:1:::\\ncell:C36:b:1:::\\ncell:D36:b:1:::\\ncell:E36:b:1:::\\ncell:F36:b:1:::\\ncell:G36:b:1:::\\ncol:A:w:10\\ncol:B:w:42\\ncol:C:w:105\\ncol:D:w:182\\ncol:E:w:110\\ncol:F:w:115\\ncol:G:w:65\\nrow:1:h:14.25\\nrow:2:h:18.75\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:15.75\\nrow:6:h:15.75\\nrow:7:h:15.75\\nrow:8:h:15.75\\nrow:9:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:13:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:16:h:14.25\\nrow:17:h:14.25\\nrow:18:h:14.25\\nrow:19:h:14.25\\nrow:20:h:14.25\\nrow:21:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nrow:24:h:14.25\\nrow:25:h:14.25\\nrow:26:h:14.25\\nrow:27:h:14.25\\nrow:28:h:15.75\\nrow:29:h:15.75\\nrow:30:h:14.25\\nrow:31:h:14.25\\nrow:32:h:14.25\\nrow:33:h:14.25\\nrow:34:h:14.25\\nrow:35:h:14.25\\nsheet:c:7:r:36:h:12.75\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\nfont:1:* * Trebuchet MS\\nfont:2:normal bold * Trebuchet MS\\nfont:3:normal bold 10pt Arial\\nfont:4:normal bold 12pt Arial\\nfont:5:normal bold 12pt Trebuchet MS\\nfont:6:normal bold 14pt Trebuchet MS\\nfont:7:normal normal 10pt Arial\\nfont:8:normal normal 12pt Arial\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nlayout:3:padding:* * * *;vertical-align:top;\\nvalueformat:1:#,##0.00\\nvalueformat:2:d-mmm\\nvalueformat:3:m/d/yy\\nvalueformat:4:text-html\\n\" }, \"name\": \"typei\", \"hidden\": \"0\" }, \"sheet2\": { \"sheetstr\": { \"savestr\": \"version:1.5\\ncell:A2:b::2:::l:1:f:7\\ncell:B2:t:INVOICE:b:1:1:1:1:l:3:f:6:cf:1:colspan:8\\ncell:C2:t::b:2::2::l:1:f:7\\ncell:D2:t::b:2::2::l:1:f:7\\ncell:E2:t::b:2::2::l:1:f:7\\ncell:F2:t::b:2::2::l:1:f:7\\ncell:G2:b:2::2::l:1:f:7\\ncell:H2:b:2::2::l:1:f:7\\ncell:I2:t::b:2::2::l:1:f:7\\ncell:A3:b::2:::l:3:f:7\\ncell:B3:b:2:::2:l:3:f:7\\ncell:E3:b:2::::l:1:f:7\\ncell:F3:b:2::::l:1:f:7\\ncell:G3:b:2::::l:1:f:7\\ncell:H3:b:2::::l:1:f:7\\ncell:I3:b:2:2:::l:3:f:7\\ncell:A4:b::2:::l:3:f:7\\ncell:B4:b::::2:l:3:f:3\\ncell:C4:t:INVOICE # \\\\c:f:2:cf:2\\ncell:D4:v:1:f:2:cf:2\\ncell:F4:tvf:5:colspan:2:rowspan:4\\ncell:I4:b::2:::l:3:f:7\\ncell:A5:b::2:::l:3:f:7\\ncell:B5:b::::2:l:3:f:4\\ncell:F5:t::l:2:f:7\\ncell:G5:l:2:f:7\\ncell:H5:l:2:f:7\\ncell:I5:t::b::1:::l:2:f:7\\ncell:A6:b::2:::l:3:f:7\\ncell:B6:b::::2:l:3:f:4\\ncell:C6:t:INVOICE DATE\\\\c:f:2:cf:2\\ncell:D6:f:2:cf:2:ntvf:4\\ncell:F6:l:2:f:7\\ncell:G6:l:2:f:7\\ncell:H6:l:2:f:7\\ncell:I6:b::1:::l:2:f:7\\ncell:A7:b::2:::l:3:f:7\\ncell:B7:b::::2:l:3:f:4\\ncell:I7:b::2:::l:3:f:7\\ncell:A8:b::2:::l:3:f:7\\ncell:B8:b::::2:l:3:f:4\\ncell:I8:b::2:::l:3:f:7\\ncell:A9:b::2:::l:3:f:7\\ncell:B9:b::::2:l:3:f:4\\ncell:C9:t:BILL TO\\\\c:f:2\\ncell:E9:t:FROM\\\\c:f:2:cf:2\\ncell:F9:colspan:3\\ncell:I9:b::2:::l:3:f:7\\ncell:A10:b::2:::l:3:f:7\\ncell:B10:b::::2:l:3:f:3\\ncell:C10:t:[Name]:f:1:cf:2:colspan:2\\ncell:E10:t:[Name]:f:1:cf:2:colspan:4\\ncell:I10:b::2:::l:3:f:7\\ncell:A11:b::2:::l:3:f:7\\ncell:B11:b::::2:l:3:f:7\\ncell:C11:t:[Street Address]:f:1:cf:2:colspan:2\\ncell:E11:t:[Street Address]:f:1:colspan:4\\ncell:I11:b::2:::l:3:f:7\\ncell:A12:b::2:::l:3:f:7\\ncell:B12:b::::2:l:3:f:7\\ncell:C12:t:[City, State, Zip]:f:1:cf:2:colspan:2\\ncell:E12:t:[City, State, Zip]:f:1:cf:2:colspan:4\\ncell:I12:b::2:::l:3:f:7\\ncell:A13:b::2:::l:3:f:7\\ncell:B13:b::::2:l:3:f:7\\ncell:C13:t:Phone\\\\c :f:1:cf:2:colspan:2\\ncell:E13:t:Phone\\\\c :f:1:cf:2:colspan:4\\ncell:I13:b::2:::l:3:f:7\\ncell:A14:b::2:::l:3:f:7\\ncell:B14:b::::2:l:3:f:3:cf:2\\ncell:C14:b:::2::l:1:f:7\\ncell:D14:b:::2::l:3:f:3:cf:2\\ncell:E14:b:::2::l:1:f:7\\ncell:F14:b:::2::l:1:f:7\\ncell:G14:b:::2::l:1:f:7\\ncell:H14:b:::2::l:1:f:7\\ncell:I14:b::2:::l:3:f:7\\ncell:A15:b::2:::l:3:f:7\\ncell:B15:b::2::2:l:3:f:7\\ncell:C15:t:Description:b:1:1:1:1:f:2:cf:1:colspan:3\\ncell:D15:t:Description:b:2::2:2:l:3:f:3:cf:2:colspan:2:rowspan:1\\ncell:E15:t::b:2:2:2::l:1:f:7\\ncell:F15:t:Hours:b:1:1:1:1:f:2:cf:1\\ncell:G15:t:Rate:b:1:1:1:1:f:2:cf:1\\ncell:H15:t:Amount:b:1:1:1:1:f:2:cf:1\\ncell:I15:b::2::2:l:3:f:7\\ncell:A16:b::2:::l:3:f:7\\ncell:B16:b::2::2:l:3:f:7\\ncell:C16:b:1:1::1:f:1:cf:2:colspan:3\\ncell:D16:b:1:1::1:l:3:f:7:cf:2:colspan:2:rowspan:1\\ncell:E16:t::b:2:2:2::l:1:f:7\\ncell:F16:b:1:1:::f:1:ntvf:1\\ncell:G16:b:1:1:::f:1:ntvf:1\\ncell:H16:vtf:t::IF(F16*G16>0,F16*G16,\\\"\\\"):b:1:1:::f:1:ntvf:1\\ncell:I16:b::2::2:l:3:f:7\\ncell:A17:b::2:::l:3:f:7\\ncell:B17:b::2::2:l:3:f:7:cf:2\\ncell:C17:b::1::1:f:1:cf:2:colspan:3\\ncell:D17:b::1::1:l:1:f:7:colspan:2\\ncell:E17:l:1:f:7\\ncell:F17:b::1:::f:1:ntvf:1\\ncell:G17:b::1:::f:1:ntvf:1\\ncell:H17:vtf:t::IF(F17*G17>0,F17*G17,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I17:b::2::2:l:3:f:7\\ncell:A18:b::2:::l:3:f:7\\ncell:B18:b::2::2:l:3:f:7:cf:2:ntvf:3\\ncell:C18:b::1::1:f:1:cf:2:colspan:3\\ncell:D18:b::1::1:colspan:2\\ncell:F18:b::1:::f:1:ntvf:1\\ncell:G18:b::1:::f:1:ntvf:1\\ncell:H18:vtf:t::IF(F18*G18>0,F18*G18,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I18:b::2::2:l:3:f:7\\ncell:A19:b::2:::l:3:f:7\\ncell:B19:b::2::2:l:3:f:7:cf:2:ntvf:3\\ncell:C19:b::1::1:f:1:cf:2:colspan:3\\ncell:D19:b::1::1:colspan:2\\ncell:F19:b::1:::f:1:ntvf:1\\ncell:G19:b::1:::f:1:ntvf:1\\ncell:H19:vtf:t::IF(F19*G19>0,F19*G19,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I19:b::2::2:l:3:f:7\\ncell:A20:b::2:::l:3:f:7\\ncell:B20:b::2::2:l:3:f:7:cf:2:ntvf:3\\ncell:C20:b::1::1:f:1:cf:2:colspan:3\\ncell:D20:b::1::1:colspan:2\\ncell:F20:b::1:::f:1:ntvf:1\\ncell:G20:b::1:::f:1:ntvf:1\\ncell:H20:vtf:t::IF(F20*G20>0,F20*G20,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I20:b::2::2:l:3:f:7\\ncell:A21:b::2:::l:3:f:7\\ncell:B21:b::2::2:l:3:f:7:cf:2:ntvf:3\\ncell:C21:b::1::1:f:1:cf:2:colspan:3\\ncell:D21:b::1::1:colspan:2\\ncell:F21:b::1:::f:1:ntvf:1\\ncell:G21:b::1:::f:1:ntvf:1\\ncell:H21:vtf:t::IF(F21*G21>0,F21*G21,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I21:b::2::2:l:3:f:7\\ncell:A22:b::2:::l:3:f:7\\ncell:B22:b::2::2:l:3:f:7:cf:2:ntvf:3\\ncell:C22:b::1::1:f:1:cf:2:colspan:3\\ncell:D22:b::1::1:colspan:2\\ncell:F22:b::1:::f:1:ntvf:1\\ncell:G22:b::1:::f:1:ntvf:1\\ncell:H22:vtf:t::IF(F22*G22>0,F22*G22,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I22:b::2::2:l:3:f:7\\ncell:A23:b::2:::l:3:f:7\\ncell:B23:b::2::2:l:3:f:7:cf:2\\ncell:C23:b::1::1:f:1:cf:2:colspan:3\\ncell:D23:b::1::1:colspan:2\\ncell:F23:b::1:::f:1:ntvf:1\\ncell:G23:b::1:::f:1:ntvf:1\\ncell:H23:vtf:t::IF(F23*G23>0,F23*G23,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I23:b::2::2:l:3:f:7\\ncell:A24:b::2:::l:3:f:7\\ncell:B24:b::2::2:l:3:f:7:cf:2\\ncell:C24:b::1::1:f:1:cf:2:colspan:3\\ncell:D24:b::1::1:colspan:2\\ncell:F24:b::1:::f:1:ntvf:1\\ncell:G24:b::1:::f:1:ntvf:1\\ncell:H24:vtf:t::IF(F24*G24>0,F24*G24,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I24:b::2::2:l:3:f:7\\ncell:A25:b::2:::l:3:f:7\\ncell:B25:b::2::2:l:3:f:7:cf:2\\ncell:C25:b::1::1:f:1:cf:2:colspan:3\\ncell:D25:b::1::1:colspan:2\\ncell:F25:b::1:::f:1:ntvf:1\\ncell:G25:b::1:::f:1:ntvf:1\\ncell:H25:vtf:t::IF(F25*G25>0,F25*G25,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I25:b::2::2:l:3:f:7\\ncell:A26:b::2:::l:3:f:7\\ncell:B26:b::2::2:l:3:f:7:cf:2\\ncell:C26:b::1::1:f:1:cf:2:colspan:3\\ncell:D26:b::1::1:colspan:2\\ncell:F26:b::1:::f:1:ntvf:1\\ncell:G26:b::1:::f:1:ntvf:1\\ncell:H26:vtf:t::IF(F26*G26>0,F26*G26,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I26:b::2::2:l:3:f:7\\ncell:A27:b::2:::l:3:f:7\\ncell:B27:b::2::2:l:3:f:7:cf:2\\ncell:C27:b::1::1:f:1:cf:2:colspan:3\\ncell:D27:b::1::1:colspan:2\\ncell:F27:b::1:::f:1:ntvf:1\\ncell:G27:b::1:::f:1:ntvf:1\\ncell:H27:vtf:t::IF(F27*G27>0,F27*G27,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I27:b::2::2:l:3:f:7\\ncell:A28:b::2:::l:3:f:4\\ncell:B28:b::2::2:l:3:f:7:cf:2\\ncell:C28:b::1:1:1:f:1:cf:2:colspan:3\\ncell:D28:b::1:1:1:l:3:f:7:cf:2:colspan:2\\ncell:E28:b:::2::l:3:f:7:cf:2\\ncell:F28:b::1:1::f:1:ntvf:1\\ncell:G28:b::1:1::f:1:ntvf:1\\ncell:H28:vtf:t::IF(F28*G28>0,F28*G28,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I28:b::2::2:l:3:f:7\\ncell:A29:b::2:::l:3:f:3\\ncell:B29:b::2::2:l:3:f:3\\ncell:C29:t:TOTAL:b:1:1:1:1:l:3:f:5:cf:2:colspan:5\\ncell:D29:b:2::2::l:3:f:8:cf:2\\ncell:E29:b:2:2:2::l:3:f:8:cf:2\\ncell:F29:vtf:n:0:SUM(F16\\\\cF28):b:2:2:2::l:3:f:4:ntvf:2\\ncell:G29:b:2:2:2::l:3:f:4:ntvf:2\\ncell:H29:vtf:n:0:SUM(H16\\\\cH28):b:1:1:1::f:5:ntvf:1\\ncell:I29:b::2::2:l:3:f:4\\ncell:A30:b::2:::l:3:f:7\\ncell:B30:b::::2:l:3:f:3:cf:2\\ncell:C30:b:2::::l:1:f:7\\ncell:D30:b:2::::l:1:f:7\\ncell:E30:b:2::::l:1:f:7\\ncell:F30:b:2::::l:1:f:7\\ncell:G30:b:2::::l:1:f:7\\ncell:H30:b:2::::l:1:f:7\\ncell:I30:b::2:::l:3:f:3\\ncell:A31:b::2:::l:3:f:7\\ncell:B31:b::::2:l:3:f:7\\ncell:D31:tvf:5:rowspan:4\\ncell:I31:b::2:::l:3:f:7\\ncell:A32:b::2:::l:3:f:7\\ncell:B32:b::::2:l:3:f:7\\ncell:I32:b::2:::l:3:f:7\\ncell:A33:b::2:::l:3:f:7\\ncell:B33:b::::2:l:3:f:7\\ncell:I33:b::2:::l:3:f:7\\ncell:A34:b::2:::l:3:f:7\\ncell:B34:b::::2:l:3:f:7\\ncell:I34:b::2:::l:3:f:7\\ncell:A35:b::2:::l:3:f:7\\ncell:B35:b:::2:2:l:3:f:7\\ncell:C35:b:::2::l:3:f:7\\ncell:D35:b:::2::l:3:f:7\\ncell:E35:b:::2::l:3:f:7\\ncell:F35:b:::2::l:3:f:7\\ncell:G35:b:::2::l:3:f:7\\ncell:H35:b:::2::l:3:f:7\\ncell:I35:b::2:2::l:3:f:7\\ncell:B36:b:1:::\\ncell:C36:b:1:::\\ncell:D36:b:1:::\\ncell:E36:b:1:::\\ncell:F36:b:1:::\\ncell:G36:b:1:::\\ncell:H36:b:1:::\\ncell:I36:b:1:::\\ncol:A:w:26\\ncol:B:w:28\\ncol:C:w:96\\ncol:D:w:203\\ncol:E:w:51\\ncol:F:w:50\\ncol:G:w:58\\ncol:H:w:80\\ncol:I:w:28\\nrow:1:h:14.25\\nrow:2:h:18.75\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:15.75\\nrow:6:h:15.75\\nrow:7:h:15.75\\nrow:8:h:15.75\\nrow:9:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:13:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:16:h:14.25\\nrow:17:h:14.25\\nrow:18:h:14.25\\nrow:19:h:14.25\\nrow:20:h:14.25\\nrow:21:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nrow:24:h:14.25\\nrow:25:h:14.25\\nrow:26:h:14.25\\nrow:27:h:14.25\\nrow:28:h:15.75\\nrow:29:h:15.75\\nrow:30:h:14.25\\nrow:31:h:14.25\\nrow:32:h:14.25\\nrow:33:h:14.25\\nrow:34:h:14.25\\nrow:35:h:14.25\\nsheet:c:9:r:36:h:12.75\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\nfont:1:* * Trebuchet MS\\nfont:2:normal bold * Trebuchet MS\\nfont:3:normal bold 10pt Arial\\nfont:4:normal bold 12pt Arial\\nfont:5:normal bold 12pt Trebuchet MS\\nfont:6:normal bold 14pt Trebuchet MS\\nfont:7:normal normal 10pt Arial\\nfont:8:normal normal 12pt Arial\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nlayout:3:padding:* * * *;vertical-align:top;\\nvalueformat:1:#,##0.00\\nvalueformat:2:#,##0.00;(#,##0.00)\\nvalueformat:3:d-mmm\\nvalueformat:4:m/d/yy\\nvalueformat:5:text-html\\n\" }, \"name\": \"typeii\", \"hidden\": \"0\" }, \"sheet3\": { \"sheetstr\": { \"savestr\": \"version:1.5\\ncell:A1:l:3\\ncell:B2:t:[Company Name]:l:1:f:3:cf:2:colspan:3\\ncell:C2:t::l:2:f:9\\ncell:D2:t::l:2:f:9\\ncell:E2:l:1:f:7:c:2:cf:3\\ncell:F2:t:INVOICE:l:1:f:7:c:2:cf:2:colspan:2\\ncell:G2:t::l:2:f:9\\ncell:B3:t:[Company Slogan]:f:4:cf:2:colspan:3\\ncell:C3:t::l:2:f:9\\ncell:D3:t::l:2:f:9\\ncell:B4:f:2:colspan:2\\ncell:F4:tvf:4:rowspan:4\\ncell:B5:t:[Street Address]:f:1:cf:2:colspan:2\\ncell:F5:l:1:f:6\\ncell:G5:l:1:f:10:cf:1\\ncell:B6:t:[City, State,  Zip]:f:1:cf:2:colspan:2\\ncell:G6:l:1:f:9\\ncell:B7:t:Phone\\\\c :f:1:cf:2:colspan:2\\ncell:B8:t:Email\\\\c:f:1:cf:2:colspan:2\\ncell:B9:colspan:2\\ncell:F9:t:DATE \\\\c:l:1:f:6:cf:2\\ncell:G9:l:1:f:10:cf:2:ntvf:3\\ncell:B10:t:BILL TO\\\\c:f:5:c:1:bg:3:cf:2:colspan:2\\ncell:F10:t:INVOICE # \\\\c:l:1:f:6:cf:2\\ncell:G10:v:1:l:1:f:10:cf:2\\ncell:B11:t:[Name]:f:1:cf:2:colspan:2\\ncell:B12:t:[Company Name]:f:1:cf:2:colspan:2\\ncell:F12:t:  \\ncell:B13:t:[Street Address]:f:1:cf:2:colspan:2\\ncell:B14:t:[City, State,  Zip]:f:1:cf:2:colspan:2\\ncell:B15:t:Phone\\\\c :f:1:cf:2:colspan:2\\ncell:A17:b::1::\\ncell:B17:t:DESCRIPTION:b:1:1:1:1:l:1:f:6:c:1:bg:3:cf:1:colspan:5:rowspan:1\\ncell:C17:t::l:2:f:9\\ncell:D17:t::l:2:f:9\\ncell:E17:t::l:2:f:9\\ncell:F17:t::l:2:f:9\\ncell:G17:t:AMOUNT:b:1:1:1::l:1:f:6:c:1:bg:3:cf:1\\ncell:A18:b::1::\\ncell:B18:b:1:1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C18:t::l:2:f:9\\ncell:D18:t::l:2:f:9\\ncell:E18:t::l:2:f:9\\ncell:F18:t::b::2:::l:1:f:9\\ncell:G18:b::1::1:f:1:ntvf:1\\ncell:A19:b::1::\\ncell:B19:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C19:t::l:2:f:9\\ncell:D19:t::l:2:f:9\\ncell:E19:t::l:2:f:9\\ncell:F19:t::b::2:::l:1:f:9\\ncell:G19:b::1::1:f:1:ntvf:1\\ncell:A20:b::1::\\ncell:B20:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C20:t::l:2:f:9\\ncell:D20:t::l:2:f:9\\ncell:E20:t::l:2:f:9\\ncell:F20:t::b::2:::l:1:f:9\\ncell:G20:b::1::1:f:1:ntvf:1\\ncell:A21:b::1::\\ncell:B21:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C21:t::l:2:f:9\\ncell:D21:t::l:2:f:9\\ncell:E21:t::l:2:f:9\\ncell:F21:t::b::2:::l:1:f:9\\ncell:G21:b::1::1:f:1:ntvf:1\\ncell:A22:b::1::\\ncell:B22:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C22:t::l:2:f:9\\ncell:D22:t::l:2:f:9\\ncell:E22:t::l:2:f:9\\ncell:F22:t::b::2:::l:1:f:9\\ncell:G22:b::1::1:f:1:ntvf:1\\ncell:A23:b::1::\\ncell:B23:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C23:t::l:2:f:9\\ncell:D23:t::l:2:f:9\\ncell:E23:t::l:2:f:9\\ncell:F23:t::b::2:::l:1:f:9\\ncell:G23:b::1::1:f:1:ntvf:1\\ncell:A24:b::1::\\ncell:B24:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C24:t::l:2:f:9\\ncell:D24:t::l:2:f:9\\ncell:E24:t::l:2:f:9\\ncell:F24:t::b::2:::l:1:f:9\\ncell:G24:b::1::1:f:1:ntvf:1\\ncell:A25:b::1::\\ncell:B25:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C25:t::l:2:f:9\\ncell:D25:t::l:2:f:9\\ncell:E25:t::l:2:f:9\\ncell:F25:t::b::2:::l:1:f:9\\ncell:G25:b::1::1:f:1:ntvf:1\\ncell:A26:b::1::\\ncell:B26:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C26:t::l:2:f:9\\ncell:D26:t::l:2:f:9\\ncell:E26:t::l:2:f:9\\ncell:F26:t::b::2:::l:1:f:9\\ncell:G26:b::1::1:f:1:ntvf:1\\ncell:A27:b::1::\\ncell:B27:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C27:t::l:2:f:9\\ncell:D27:t::l:2:f:9\\ncell:E27:t::l:2:f:9\\ncell:F27:t::b::2:::l:1:f:9\\ncell:G27:b::1::1:f:1:ntvf:1\\ncell:A28:b::1::\\ncell:B28:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C28:t::l:2:f:9\\ncell:D28:t::l:2:f:9\\ncell:E28:t::l:2:f:9\\ncell:F28:t::b::2:::l:1:f:9\\ncell:G28:b::1::1:f:1:ntvf:1\\ncell:A29:b::1::\\ncell:B29:b::1:1:1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C29:t::b:::2::l:1:f:9\\ncell:D29:t::b:::2::l:1:f:9\\ncell:E29:t::b:::2::l:1:f:9\\ncell:F29:t::b::2:2::l:1:f:9\\ncell:G29:b::1:1:1:f:1:ntvf:1\\ncell:B30:b:2::::l:1:f:9\\ncell:C30:b:2::::l:1:f:9\\ncell:D30:b:2::::l:1:f:9\\ncell:E30:b:2::::l:1:f:10\\ncell:F30:t:Subtotal:b:2::::l:1:f:10\\ncell:G30:vtf:n:0:SUM(G18\\\\cG29):b:1::::f:8:ntvf:1\\ncell:B31:t:NOTES:b:::2::l:1:f:6:cf:2:colspan:3:rowspan:1\\ncell:C31:t::b:::2::l:1:f:9\\ncell:D31:t::b:::2::l:1:f:9\\ncell:F31:t:Tax Rate:l:1:f:1\\ncell:G31:v:0:f:1:ntvf:2\\ncell:B32:b:1::::f:1:cf:2:colspan:3\\ncell:C32:t::b:2::::l:1:f:9\\ncell:D32:t::b:2::::l:1:f:9\\ncell:F32:t:Tax:l:1:f:1\\ncell:G32:vtf:n:0:G31*G30:f:1:ntvf:1\\ncell:B33:f:1:cf:2:colspan:3\\ncell:C33:t::l:2:f:9\\ncell:D33:t::l:2:f:9\\ncell:F33:t:Other:b:::1::l:1:f:1\\ncell:G33:v:0:b:::1::f:1:ntvf:1\\ncell:B34:b:::1::f:1:cf:2:colspan:3:rowspan:1\\ncell:C34:t::l:2:f:9\\ncell:D34:t::l:2:f:9\\ncell:F34:t:TOTAL:b:2::::l:1:f:6\\ncell:G34:vtf:n:0:(G30+G32)+G33:b:1::::f:5:ntvf:1\\ncell:C36:tvf:4:colspan:5:rowspan:7\\ncol:A:w:40\\ncol:B:w:232\\ncol:C:w:53\\ncol:D:w:90\\ncol:E:w:54\\ncol:F:w:91\\ncol:G:w:99\\nrow:1:h:34.5\\nrow:2:h:34.5\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:14.25\\nrow:6:h:14.25\\nrow:7:h:14.25\\nrow:8:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:13:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:17:h:14.25\\nrow:18:h:14.25\\nrow:19:h:14.25\\nrow:20:h:14.25\\nrow:21:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nrow:24:h:14.25\\nrow:25:h:14.25\\nrow:26:h:14.25\\nrow:27:h:14.25\\nrow:28:h:14.25\\nrow:29:h:14.25\\nrow:30:h:14.25\\nrow:31:h:14.25\\nrow:32:h:14.25\\nrow:33:h:14.25\\nrow:34:h:14.25\\nsheet:c:7:r:36:h:12.75:needsrecalc:yes\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\ncellformat:3:right\\ncolor:1:rgb(0, 0, 0)\\ncolor:2:rgb(0,0,0)\\ncolor:3:rgb(221, 221, 221)\\nfont:1:* * Trebuchet MS\\nfont:2:* 10pt *\\nfont:3:* 16pt Trebuchet MS\\nfont:4:italic normal * Trebuchet MS\\nfont:5:normal bold * Trebuchet MS\\nfont:6:normal bold 10pt Trebuchet MS\\nfont:7:normal bold 28pt Trebuchet MS\\nfont:8:normal normal * Trebuchet MS\\nfont:9:normal normal 10pt Arial\\nfont:10:normal normal 10pt Trebuchet MS\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nlayout:3:padding:36px * 28px *;vertical-align:*;\\nvalueformat:1:#,##0.00\\nvalueformat:2:#,##0.00%\\nvalueformat:3:m/d/yy\\nvalueformat:4:text-html\\n\" }, \"name\": \"typeiii\", \"hidden\": \"0\" }, \"sheet4\": { \"sheetstr\": { \"savestr\": \"version:1.5\\ncell:A1:l:3\\ncell:B2:t:[Company Name]:l:1:f:2:cf:2:colspan:3:rowspan:1\\ncell:C2:t::l:2:f:7\\ncell:D2:t::l:2:f:7\\ncell:F2:t:INVOICE:l:1:f:6:c:1:cf:2:colspan:2\\ncell:G2:t::l:2:f:7\\ncell:B3:t:[Company slogan]:f:3:cf:2:colspan:3:rowspan:1\\ncell:C3:t::l:2:f:7\\ncell:D3:t::l:2:f:7\\ncell:B4:cf:2:colspan:3:rowspan:1\\ncell:F4:tvf:4:rowspan:4\\ncell:B5:t:[Street Address]:f:1:cf:2:colspan:3:rowspan:1\\ncell:F5:l:1:f:5\\ncell:G5:l:1:f:8:cf:1\\ncell:B6:t:[City, State,  Zip]:f:1:cf:2:colspan:3:rowspan:1\\ncell:G6:l:1:f:7\\ncell:B7:t:Phone\\\\c :f:1:cf:2:colspan:3:rowspan:1\\ncell:B8:t:Email\\\\c:f:1:cf:2:colspan:3:rowspan:1\\ncell:B9:cf:2:colspan:3:rowspan:1\\ncell:B10:t:BILL TO\\\\c:l:1:f:5:bg:2:cf:2:colspan:2\\ncell:F10:t:DATE\\\\c:l:1:f:5:cf:2\\ncell:G10:l:1:f:8:cf:2:ntvf:3\\ncell:B11:t:[Name]:f:1:cf:2:colspan:3:rowspan:1\\ncell:F11:t:INVOICE # \\\\c:l:1:f:5:cf:2\\ncell:G11:v:1:l:1:f:8:cf:2\\ncell:B12:t:[Company Name]:f:1:cf:2:colspan:3:rowspan:1\\ncell:J12:tvf:4\\ncell:B13:t:[Street Address]:f:1:cf:2:colspan:3:rowspan:1\\ncell:B14:t:[City, State,  Zip]:f:1:cf:2:colspan:3:rowspan:1\\ncell:B15:t:Phone\\\\c :f:1:cf:2:colspan:3:rowspan:1\\ncell:B16:cf:2:colspan:3:rowspan:1\\ncell:A17:b::1::\\ncell:B17:t:DESCRIPTION:b:1:1:1:1:l:1:f:5:bg:2:cf:1:colspan:3:rowspan:1\\ncell:C17:t::b:1::1::l:1:f:7:bg:2\\ncell:D17:t::b:1::1::l:1:f:7:bg:2\\ncell:E17:t:HOURS:b:1:1:1::l:1:f:5:bg:2:cf:1\\ncell:F17:t:RATE:b:1:1:1::l:1:f:5:bg:2:cf:1\\ncell:G17:t:AMOUNT:b:1:1:1::l:1:f:5:bg:2:cf:1\\ncell:A18:b::1::\\ncell:B18:b:1:1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C18:t::b:2::::l:1:f:7\\ncell:D18:t::b:2:2:::l:1:f:7\\ncell:E18:b:1:1::1:f:1:ntvf:1\\ncell:F18:b:1:1::1:f:1:ntvf:1\\ncell:G18:vtf:t::IF(E18*F18>0,E18*F18,\\\"\\\"):b:1:1:::f:1:ntvf:1\\ncell:A19:b::1::\\ncell:B19:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C19:t::l:2:f:7\\ncell:D19:t::b::2:::l:1:f:7\\ncell:E19:b::1::1:f:1:ntvf:1\\ncell:F19:b::1::1:f:1:ntvf:1\\ncell:G19:vtf:t::IF(E19*F19>0,E19*F19,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A20:b::1::\\ncell:B20:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C20:t::l:2:f:7\\ncell:D20:t::b::2:::l:1:f:7\\ncell:E20:b::1::1:f:1:ntvf:1\\ncell:F20:b::1::1:f:1:ntvf:1\\ncell:G20:vtf:t::IF(E20*F20>0,E20*F20,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A21:b::1::\\ncell:B21:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C21:t::l:2:f:7\\ncell:D21:t::b::2:::l:1:f:7\\ncell:E21:b::1::1:f:1:ntvf:1\\ncell:F21:b::1::1:f:1:ntvf:1\\ncell:G21:vtf:t::IF(E21*F21>0,E21*F21,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A22:b::1::\\ncell:B22:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C22:t::l:2:f:7\\ncell:D22:t::b::2:::l:1:f:7\\ncell:E22:b::1::1:f:1:ntvf:1\\ncell:F22:b::1::1:f:1:ntvf:1\\ncell:G22:vtf:t::IF(E22*F22>0,E22*F22,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A23:b::1::\\ncell:B23:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C23:t::l:2:f:7\\ncell:D23:t::b::2:::l:1:f:7\\ncell:E23:b::1::1:f:1:ntvf:1\\ncell:F23:b::1::1:f:1:ntvf:1\\ncell:G23:vtf:t::IF(E23*F23>0,E23*F23,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A24:b::1::\\ncell:B24:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C24:t::l:2:f:7\\ncell:D24:t::b::2:::l:1:f:7\\ncell:E24:b::1::1:f:1:ntvf:1\\ncell:F24:b::1::1:f:1:ntvf:1\\ncell:G24:vtf:t::IF(E24*F24>0,E24*F24,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A25:b::1::\\ncell:B25:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C25:t::l:2:f:7\\ncell:D25:t::b::2:::l:1:f:7\\ncell:E25:b::1::1:f:1:ntvf:1\\ncell:F25:b::1::1:f:1:ntvf:1\\ncell:G25:vtf:t::IF(E25*F25>0,E25*F25,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A26:b::1::\\ncell:B26:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C26:t::l:2:f:7\\ncell:D26:t::b::2:::l:1:f:7\\ncell:E26:b::1::1:f:1:ntvf:1\\ncell:F26:b::1::1:f:1:ntvf:1\\ncell:G26:vtf:t::IF(E26*F26>0,E26*F26,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A27:b::1::\\ncell:B27:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C27:t::l:2:f:7\\ncell:D27:t::b::2:::l:1:f:7\\ncell:E27:b::1::1:f:1:ntvf:1\\ncell:F27:b::1::1:f:1:ntvf:1\\ncell:G27:vtf:t::IF(E27*F27>0,E27*F27,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A28:b::1::\\ncell:B28:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C28:t::l:2:f:7\\ncell:D28:t::b::2:::l:1:f:7\\ncell:E28:b::1::1:f:1:ntvf:1\\ncell:F28:b::1::1:f:1:ntvf:1\\ncell:G28:vtf:t::IF(E28*F28>0,E28*F28,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A29:b::1::\\ncell:B29:b::1:1:1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C29:t::b:::2::l:1:f:7\\ncell:D29:t::b::2:2::l:1:f:7\\ncell:E29:b::1:1:1:f:1:ntvf:1\\ncell:F29:b::1:1:1:f:1:ntvf:1\\ncell:G29:vtf:t::IF(E29*F29>0,E29*F29,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:B30:b:2::::l:1:f:8:cf:1:colspan:3:rowspan:1\\ncell:C30:t::b:2::::l:1:f:7\\ncell:D30:t::b:2::::l:1:f:7\\ncell:E30:b:2::::l:1:f:8\\ncell:F30:t:Subtotal:b:1::::f:1\\ncell:G30:vtf:n:0:SUM(G18\\\\cG29):b:1::::f:1:ntvf:1\\ncell:B31:t:NOTES:b:::2::l:1:f:5:cf:2:colspan:3:rowspan:1\\ncell:C31:t::b:::2::l:1:f:7\\ncell:D31:t::b:::2::l:1:f:7\\ncell:F31:t:Tax Rate:f:1\\ncell:G31:v:0:f:1:ntvf:2\\ncell:B32:b:1::::f:1:cf:2:colspan:3:rowspan:1\\ncell:C32:t::b:2::::l:1:f:7\\ncell:D32:t::b:2::::l:1:f:7\\ncell:F32:t:Tax:f:1\\ncell:G32:vtf:n:0:G31*G30:f:1:ntvf:1\\ncell:B33:f:1:cf:2:colspan:3:rowspan:1\\ncell:C33:t::l:2:f:7\\ncell:D33:t::l:2:f:7\\ncell:F33:t:Other:b:::1::l:1:f:1\\ncell:G33:v:0:b:::1::f:1:ntvf:1\\ncell:B34:f:1:cf:2:colspan:3:rowspan:1\\ncell:C34:t::l:2:f:7\\ncell:D34:t::l:2:f:7\\ncell:F34:t:TOTAL:b:1::::l:1:f:4\\ncell:G34:vtf:n:0:(G30+G32)+G33:b:1::::f:4:ntvf:1\\ncell:B35:b:2::::l:1:f:7\\ncell:C35:b:2::::l:1:f:7\\ncell:D35:b:2::::l:1:f:7\\ncell:C36:tvf:4:colspan:5:rowspan:7\\ncol:A:w:40\\ncol:B:w:194\\ncol:C:w:128\\ncol:D:w:60\\ncol:E:w:65\\ncol:F:w:95\\ncol:G:w:90\\nrow:1:h:34.5\\nrow:2:h:34.5\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:14.25\\nrow:6:h:14.25\\nrow:7:h:14.25\\nrow:8:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:13:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:17:h:14.25\\nrow:18:h:14.25\\nrow:19:h:14.25\\nrow:20:h:14.25\\nrow:21:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nrow:24:h:14.25\\nrow:25:h:14.25\\nrow:26:h:14.25\\nrow:27:h:14.25\\nrow:28:h:14.25\\nrow:29:h:14.25\\nrow:30:h:14.25\\nrow:31:h:14.25\\nrow:32:h:14.25\\nrow:33:h:14.25\\nrow:34:h:14.25\\nrow:35:h:14.25\\nsheet:c:10:r:36:h:12.75:needsrecalc:yes\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\ncolor:1:rgb(0,0,0)\\ncolor:2:rgb(221, 221, 221)\\nfont:1:* * Trebuchet MS\\nfont:2:* 16pt Trebuchet MS\\nfont:3:italic normal * Trebuchet MS\\nfont:4:normal bold * Trebuchet MS\\nfont:5:normal bold 10pt Trebuchet MS\\nfont:6:normal bold 28pt Trebuchet MS\\nfont:7:normal normal 10pt Arial\\nfont:8:normal normal 10pt Trebuchet MS\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nlayout:3:padding:36px * 28px *;vertical-align:*;\\nvalueformat:1:#,##0.00\\nvalueformat:2:#,##0.00%\\nvalueformat:3:m/d/yy\\nvalueformat:4:text-html\\n\" }, \"name\": \"typeiv\", \"hidden\": \"0\" } }, \"EditableCells\": { \"allow\": true, \"cells\": { \"typei!C10\": true, \"typei!B2\": true, \"typei!C11\": true, \"typei!C12\": true, \"typei!C13\": true, \"typei!D9\": true, \"typei!D4\": true, \"typei!D6\": true, \"typei!E10\": true, \"typei!E11\": true, \"typei!E12\": true, \"typei!E13\": true, \"typei!F9\": true, \"typei!C16\": true, \"typei!C17\": true, \"typei!C18\": true, \"typei!C19\": true, \"typei!C20\": true, \"typei!C21\": true, \"typei!C22\": true, \"typei!C23\": true, \"typei!C24\": true, \"typei!C25\": true, \"typei!C26\": true, \"typei!C27\": true, \"typei!C28\": true, \"typei!F16\": true, \"typei!F17\": true, \"typei!F18\": true, \"typei!F19\": true, \"typei!F20\": true, \"typei!F21\": true, \"typei!F22\": true, \"typei!F23\": true, \"typei!F24\": true, \"typei!F25\": true, \"typei!F26\": true, \"typei!F27\": true, \"typei!F28\": true, \"typei!E35\": true, \"typeii!B2\": true, \"typeii!D4\": true, \"typeii!C10\": true, \"typeii!C11\": true, \"typeii!C12\": true, \"typeii!C13\": true, \"typeii!D9\": true, \"typeii!E10\": true, \"typeii!E11\": true, \"typeii!E12\": true, \"typeii!E13\": true, \"typeii!F9\": true, \"typeii!C16\": true, \"typeii!C17\": true, \"typeii!C18\": true, \"typeii!C19\": true, \"typeii!C20\": true, \"typeii!C21\": true, \"typeii!C22\": true, \"typeii!C23\": true, \"typeii!C24\": true, \"typeii!C25\": true, \"typeii!C26\": true, \"typeii!C27\": true, \"typeii!C28\": true, \"typeii!F16\": true, \"typeii!F17\": true, \"typeii!F18\": true, \"typeii!F19\": true, \"typeii!F20\": true, \"typeii!F21\": true, \"typeii!F22\": true, \"typeii!F23\": true, \"typeii!F24\": true, \"typeii!F25\": true, \"typeii!F26\": true, \"typeii!F27\": true, \"typeii!F28\": true, \"typeii!G16\": true, \"typeii!G17\": true, \"typeii!G18\": true, \"typeii!G19\": true, \"typeii!G20\": true, \"typeii!G21\": true, \"typeii!G22\": true, \"typeii!G23\": true, \"typeii!G24\": true, \"typeii!G25\": true, \"typeii!G26\": true, \"typeii!G27\": true, \"typeii!G28\": true, \"typeii!E35\": true, \"typeiii!G9\": true, \"typeiii!G10\": true, \"typeiii!B2\": true, \"typeiii!B3\": true, \"typeiii!B4\": true, \"typeiii!B5\": true, \"typeiii!B6\": true, \"typeiii!B7\": true, \"typeiii!B8\": true, \"typeiii!B9\": true, \"typeiii!B11\": true, \"typeiii!B12\": true, \"typeiii!B13\": true, \"typeiii!B14\": true, \"typeiii!B15\": true, \"typeiii!B18\": true, \"typeiii!B19\": true, \"typeiii!B20\": true, \"typeiii!B21\": true, \"typeiii!B22\": true, \"typeiii!B23\": true, \"typeiii!B24\": true, \"typeiii!B25\": true, \"typeiii!B26\": true, \"typeiii!B27\": true, \"typeiii!B28\": true, \"typeiii!B29\": true, \"typeiii!G18\": true, \"typeiii!G19\": true, \"typeiii!G20\": true, \"typeiii!G21\": true, \"typeiii!G22\": true, \"typeiii!G23\": true, \"typeiii!G24\": true, \"typeiii!G25\": true, \"typeiii!G26\": true, \"typeiii!G27\": true, \"typeiii!G28\": true, \"typeiii!G29\": true, \"typeiii!B32\": true, \"typeiii!B33\": true, \"typeiii!B34\": true, \"typeiii!G31\": true, \"typeiii!G33\": true, \"typeiii!B37\": true, \"typeiv!G9\": true, \"typeiv!G10\": true, \"typeiv!B2\": true, \"typeiv!B3\": true, \"typeiv!B4\": true, \"typeiv!B5\": true, \"typeiv!B6\": true, \"typeiv!B7\": true, \"typeiv!B8\": true, \"typeiv!B11\": true, \"typeiv!B12\": true, \"typeiv!B13\": true, \"typeiv!B14\": true, \"typeiv!B15\": true, \"typeiv!B16\": true, \"typeiv!B18\": true, \"typeiv!B19\": true, \"typeiv!B20\": true, \"typeiv!B21\": true, \"typeiv!B22\": true, \"typeiv!B23\": true, \"typeiv!B24\": true, \"typeiv!B25\": true, \"typeiv!B26\": true, \"typeiv!B27\": true, \"typeiv!B28\": true, \"typeiv!B29\": true, \"typeiv!E18\": true, \"typeiv!E19\": true, \"typeiv!E20\": true, \"typeiv!E21\": true, \"typeiv!E22\": true, \"typeiv!E23\": true, \"typeiv!E24\": true, \"typeiv!E25\": true, \"typeiv!E26\": true, \"typeiv!E27\": true, \"typeiv!E28\": true, \"typeiv!E29\": true, \"typeiv!F18\": true, \"typeiv!F19\": true, \"typeiv!F2\": true, \"typeiv!F20\": true, \"typeiv!F21\": true, \"typeiv!F22\": true, \"typeiv!F23\": true, \"typeiv!F24\": true, \"typeiv!F25\": true, \"typeiv!F26\": true, \"typeiv!F27\": true, \"typeiv!F28\": true, \"typeiv!F29\": true, \"typeiv!B32\": true, \"typeiv!B33\": true, \"typeiv!B34\": true, \"typeiv!G31\": true, \"typeiv!G33\": true, \"typeiv!B37\": true, \"typeii!F15\": true, \"typeii!G15\": true, \"typeiv!E17\": true, \"typeiv!F17\": true, \"typeii!D6\": true, \"typeiv!G11\": true, \"typei!C4\": true, \"typeii!C4\": true, \"typeiii!F10\": true, \"typeiv!F11\": true, \"typeiv!F10\": true, \"typeiii!F9\": true, \"typeii!C6\": true, \"typei!C6\": true, \"typei!F4\": true, \"typeii!F4\": true, \"typeiii!F4\": true, \"typeiii!F2\": true, \"typeiv!F4\": true, \"typei!F29\": true, \"typeii!H29\": true, \"typeiii!G30\": true, \"typeiii!G34\": true, \"typeiv!G30\": true, \"typeiv!G34\": true }, \"constraints\": {} } },\n\t                                                \"footers\": [{ name: 'Invoice 1', index: 1, isActive: true }, { name: 'Invoice 2', index: 2, isActive: false }, { name: 'Company Invoice 1', index: 3, isActive: false }, { name: 'Company Invoice 2', index: 4, isActive: false }]\n\t                                },\n\t                                \"default\": {\n\t                                                \"msc\": { \"numsheets\": 4, \"currentid\": \"sheet1\", \"currentname\": \"typei\", \"sheetArr\": { \"sheet1\": { \"sheetstr\": { \"savestr\": \"version:1.5\\ncell:A2:b::2:::l:1:f:7\\ncell:B2:t:INVOICE:b:1:1:1:1:f:6:cf:1:colspan:6\\ncell:C2:t::b:2::2::l:1:f:7\\ncell:D2:t::b:2::2::l:1:f:7\\ncell:E2:t::b:2::2::l:1:f:7\\ncell:F2:t::b:2::2::l:1:f:7\\ncell:G2:t::b:2::2::l:1:f:7\\ncell:A3:b::2:::l:3:f:7\\ncell:B3:b:2:::2:l:3:f:7\\ncell:C3:b:2::::l:1:f:7\\ncell:D3:b:2::::l:1:f:7\\ncell:E3:b:2::::l:1:f:7\\ncell:F3:b:2::::l:1:f:7\\ncell:G3:b:2:2:::l:3:f:7\\ncell:A4:b::2:::l:3:f:7\\ncell:B4:b::::2:l:3:f:3\\ncell:C4:t:INVOICE # \\\\c:f:2:cf:2\\ncell:D4:v:1:f:2:cf:2\\ncell:F4:tvf:4:rowspan:4\\ncell:G4:b::2:::l:3:f:7\\ncell:A5:b::2:::l:3:f:7\\ncell:B5:b::::2:l:3:f:4\\ncell:F5:t::l:2:f:7\\ncell:G5:t::b::1:::l:2:f:7\\ncell:A6:b::2:::l:3:f:7\\ncell:B6:b::::2:l:3:f:4\\ncell:C6:t:INVOICE DATE\\\\c:f:2:cf:2\\ncell:D6:f:2:cf:2:ntvf:3\\ncell:F6:l:2:f:7\\ncell:G6:b::1:::l:2:f:7\\ncell:A7:b::2:::l:3:f:7\\ncell:B7:b::::2:l:3:f:4\\ncell:G7:b::2:::l:3:f:7\\ncell:A8:b::2:::l:3:f:7\\ncell:B8:b::::2:l:3:f:4\\ncell:G8:b::2:::l:3:f:7\\ncell:A9:b::2:::l:3:f:7\\ncell:B9:b::::2:l:3:f:4\\ncell:C9:t:BILL TO\\\\c:l:3:f:2\\ncell:E9:t:FROM\\\\c:f:2:cf:2\\ncell:G9:b::2:::l:3:f:7\\ncell:A10:b::2:::l:3:f:7\\ncell:B10:b::::2:l:3:f:3\\ncell:C10:t:[Name]:f:1:cf:2:colspan:2\\ncell:E10:t:[Name]:f:1:cf:2:colspan:2\\ncell:G10:b::2:::l:3:f:7\\ncell:A11:b::2:::l:3:f:7\\ncell:B11:b::::2:l:3:f:7\\ncell:C11:t:[Street Address]:f:1:cf:2:colspan:2\\ncell:E11:t:[Street Address]:f:1:cf:2:colspan:2\\ncell:G11:b::2:::l:3:f:7\\ncell:A12:b::2:::l:3:f:7\\ncell:B12:b::::2:l:3:f:7\\ncell:C12:t:[City, State, Zip]:f:1:cf:2:colspan:2\\ncell:E12:t:[City, State, Zip]:f:1:cf:2:colspan:2\\ncell:G12:b::2:::l:3:f:7\\ncell:A13:b::2:::l:3:f:7\\ncell:B13:b::::2:l:3:f:7\\ncell:C13:t:Phone\\\\c:f:1:cf:2:colspan:2\\ncell:E13:t:Phone\\\\c:f:1:cf:2:colspan:2\\ncell:G13:b::2:::l:3:f:7\\ncell:A14:b::2:::l:3:f:7\\ncell:B14:b::::2:l:3:f:3:cf:2\\ncell:C14:b:::2::l:1:f:7\\ncell:D14:b:::2::l:3:f:3:cf:2\\ncell:E14:b:::2::l:1:f:7\\ncell:F14:b:::2::l:1:f:7\\ncell:G14:b::2:::l:3:f:7\\ncell:A15:b::2:::l:3:f:7\\ncell:B15:b::2::2:l:3:f:7\\ncell:C15:t:Description:b:1::1:1:f:2:cf:1:colspan:3\\ncell:D15:t:Description:b:1::1::l:3:f:3:cf:2:colspan:2:rowspan:1\\ncell:E15:t::b:2:2:2::l:1:f:7\\ncell:F15:t:Amount:b:1:1:1:1:f:2:cf:1\\ncell:G15:b::2::2:l:3:f:7\\ncell:A16:b::2:::l:3:f:7\\ncell:B16:b::2::2:l:3:f:7\\ncell:C16:b:1:1::1:f:1:cf:2:colspan:3\\ncell:D16:b:1:1:::l:3:f:7:cf:2:colspan:2:rowspan:1\\ncell:E16:t::b:2:2:2::l:1:f:7\\ncell:F16:b:1:1:::f:1:ntvf:1\\ncell:G16:b::2::2:l:3:f:7\\ncell:A17:b::2:::l:3:f:7\\ncell:B17:b::2::2:l:3:f:7:cf:2\\ncell:C17:b::1::1:f:1:cf:2:colspan:3\\ncell:D17:b::1:::l:1:f:7:colspan:2\\ncell:E17:l:1:f:7\\ncell:F17:b::1:::f:1:ntvf:1\\ncell:G17:b::2::2:l:3:f:7\\ncell:A18:b::2:::l:3:f:7\\ncell:B18:b::2::2:l:3:f:7:cf:2:ntvf:2\\ncell:C18:b::1::1:f:1:cf:2:colspan:3\\ncell:D18:b::1:::colspan:2\\ncell:F18:b::1:::f:1:ntvf:1\\ncell:G18:b::2::2:l:3:f:7\\ncell:A19:b::2:::l:3:f:7\\ncell:B19:b::2::2:l:3:f:7:cf:2:ntvf:2\\ncell:C19:b::1::1:f:1:cf:2:colspan:3\\ncell:D19:b::1:::colspan:2\\ncell:F19:b::1:::f:1:ntvf:1\\ncell:G19:b::2::2:l:3:f:7\\ncell:A20:b::2:::l:3:f:7\\ncell:B20:b::2::2:l:3:f:7:cf:2:ntvf:2\\ncell:C20:b::1::1:f:1:cf:2:colspan:3\\ncell:D20:b::1:::colspan:2\\ncell:F20:b::1:::f:1:ntvf:1\\ncell:G20:b::2::2:l:3:f:7\\ncell:A21:b::2:::l:3:f:7\\ncell:B21:b::2::2:l:3:f:7:cf:2:ntvf:2\\ncell:C21:b::1::1:f:1:cf:2:colspan:3\\ncell:D21:b::1:::colspan:2\\ncell:F21:b::1:::f:1:ntvf:1\\ncell:G21:b::2::2:l:3:f:7\\ncell:A22:b::2:::l:3:f:7\\ncell:B22:b::2::2:l:3:f:7:cf:2:ntvf:2\\ncell:C22:b::1::1:f:1:cf:2:colspan:3\\ncell:D22:b::1:::colspan:2\\ncell:F22:b::1:::f:1:ntvf:1\\ncell:G22:b::2::2:l:3:f:7\\ncell:A23:b::2:::l:3:f:7\\ncell:B23:b::2::2:l:3:f:7:cf:2\\ncell:C23:b::1::1:f:1:cf:2:colspan:3\\ncell:D23:b::1:::colspan:2\\ncell:F23:b::1:::f:1:ntvf:1\\ncell:G23:b::2::2:l:3:f:7\\ncell:A24:b::2:::l:3:f:7\\ncell:B24:b::2::2:l:3:f:7:cf:2\\ncell:C24:b::1::1:f:1:cf:2:colspan:3\\ncell:D24:b::1:::colspan:2\\ncell:F24:b::1:::f:1:ntvf:1\\ncell:G24:b::2::2:l:3:f:7\\ncell:A25:b::2:::l:3:f:7\\ncell:B25:b::2::2:l:3:f:7:cf:2\\ncell:C25:b::1::1:f:1:cf:2:colspan:3\\ncell:D25:b::1:::colspan:2\\ncell:F25:b::1:::f:1:ntvf:1\\ncell:G25:b::2::2:l:3:f:7\\ncell:A26:b::2:::l:3:f:7\\ncell:B26:b::2::2:l:3:f:7:cf:2\\ncell:C26:b::1::1:f:1:cf:2:colspan:3\\ncell:D26:b::1:::colspan:2\\ncell:F26:b::1:::f:1:ntvf:1\\ncell:G26:b::2::2:l:3:f:7\\ncell:A27:b::2:::l:3:f:7\\ncell:B27:b::2::2:l:3:f:7:cf:2\\ncell:C27:b::1::1:f:1:cf:2:colspan:3\\ncell:D27:b::1:::colspan:2\\ncell:F27:b::1:::f:1:ntvf:1\\ncell:G27:b::2::2:l:3:f:7\\ncell:A28:b::2:::l:3:f:4\\ncell:B28:b::2::2:l:3:f:7:cf:2\\ncell:C28:b::1:1:1:f:1:cf:2:colspan:3\\ncell:D28:b::1:1::l:3:f:7:cf:2:colspan:2\\ncell:E28:b:::2::l:3:f:7:cf:2\\ncell:F28:b::1:1::f:1:ntvf:1\\ncell:G28:b::2::2:l:3:f:7\\ncell:A29:b::2:::l:3:f:3\\ncell:B29:b::2::2:l:3:f:3\\ncell:C29:t:TOTAL:b:1:1:1:1:f:5:cf:2:colspan:3\\ncell:D29:b:2::2::l:3:f:8:cf:2\\ncell:E29:b:2:2:2::l:3:f:8:cf:2\\ncell:F29:vtf:n:0:SUM(F16\\\\cF28):b:1:1:1::f:5:ntvf:1\\ncell:G29:b::2::2:l:3:f:4\\ncell:A30:b::2:::l:3:f:7\\ncell:B30:b::::2:l:3:f:3:cf:2\\ncell:C30:b:2::::l:1:f:7\\ncell:D30:b:2::::l:1:f:7\\ncell:E30:b:2::::l:1:f:7\\ncell:F30:b:2::::l:1:f:7\\ncell:G30:b::2:::l:3:f:3\\ncell:A31:b::2:::l:3:f:7\\ncell:B31:b::::2:l:3:f:7\\ncell:D31:tvf:4:rowspan:4\\ncell:G31:b::2:::l:3:f:7\\ncell:A32:b::2:::l:3:f:7\\ncell:B32:b::::2:l:3:f:7\\ncell:G32:b::2:::l:3:f:7\\ncell:A33:b::2:::l:3:f:7\\ncell:B33:b::::2:l:3:f:7\\ncell:G33:b::2:::l:3:f:7\\ncell:A34:b::2:::l:3:f:7\\ncell:B34:b::::2:l:3:f:7\\ncell:G34:b::2:::l:3:f:7\\ncell:A35:b::2:::l:3:f:7\\ncell:B35:b:::2:2:l:3:f:7\\ncell:C35:b:::2::l:3:f:7\\ncell:D35:b:::2::l:3:f:7\\ncell:E35:b:::2::l:3:f:7\\ncell:F35:b:::2::l:3:f:7\\ncell:G35:b::2:2::l:3:f:7\\ncell:B36:b:1:::\\ncell:C36:b:1:::\\ncell:D36:b:1:::\\ncell:E36:b:1:::\\ncell:F36:b:1:::\\ncell:G36:b:1:::\\ncol:A:w:10\\ncol:B:w:42\\ncol:C:w:105\\ncol:D:w:182\\ncol:E:w:110\\ncol:F:w:115\\ncol:G:w:65\\nrow:1:h:14.25\\nrow:2:h:18.75\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:15.75\\nrow:6:h:15.75\\nrow:7:h:15.75\\nrow:8:h:15.75\\nrow:9:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:13:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:16:h:14.25\\nrow:17:h:14.25\\nrow:18:h:14.25\\nrow:19:h:14.25\\nrow:20:h:14.25\\nrow:21:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nrow:24:h:14.25\\nrow:25:h:14.25\\nrow:26:h:14.25\\nrow:27:h:14.25\\nrow:28:h:15.75\\nrow:29:h:15.75\\nrow:30:h:14.25\\nrow:31:h:14.25\\nrow:32:h:14.25\\nrow:33:h:14.25\\nrow:34:h:14.25\\nrow:35:h:14.25\\nsheet:c:7:r:36:h:12.75\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\nfont:1:* * Trebuchet MS\\nfont:2:normal bold * Trebuchet MS\\nfont:3:normal bold 10pt Arial\\nfont:4:normal bold 12pt Arial\\nfont:5:normal bold 12pt Trebuchet MS\\nfont:6:normal bold 14pt Trebuchet MS\\nfont:7:normal normal 10pt Arial\\nfont:8:normal normal 12pt Arial\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nlayout:3:padding:* * * *;vertical-align:top;\\nvalueformat:1:#,##0.00\\nvalueformat:2:d-mmm\\nvalueformat:3:m/d/yy\\nvalueformat:4:text-html\\n\" }, \"name\": \"typei\", \"hidden\": \"0\" }, \"sheet2\": { \"sheetstr\": { \"savestr\": \"version:1.5\\ncell:A2:b::2:::l:1:f:7\\ncell:B2:t:INVOICE:b:1:1:1:1:l:3:f:6:cf:1:colspan:8\\ncell:C2:t::b:2::2::l:1:f:7\\ncell:D2:t::b:2::2::l:1:f:7\\ncell:E2:t::b:2::2::l:1:f:7\\ncell:F2:t::b:2::2::l:1:f:7\\ncell:G2:b:2::2::l:1:f:7\\ncell:H2:b:2::2::l:1:f:7\\ncell:I2:t::b:2::2::l:1:f:7\\ncell:A3:b::2:::l:3:f:7\\ncell:B3:b:2:::2:l:3:f:7\\ncell:E3:b:2::::l:1:f:7\\ncell:F3:b:2::::l:1:f:7\\ncell:G3:b:2::::l:1:f:7\\ncell:H3:b:2::::l:1:f:7\\ncell:I3:b:2:2:::l:3:f:7\\ncell:A4:b::2:::l:3:f:7\\ncell:B4:b::::2:l:3:f:3\\ncell:C4:t:INVOICE # \\\\c:f:2:cf:2\\ncell:D4:v:1:f:2:cf:2\\ncell:F4:tvf:5:colspan:2:rowspan:4\\ncell:I4:b::2:::l:3:f:7\\ncell:A5:b::2:::l:3:f:7\\ncell:B5:b::::2:l:3:f:4\\ncell:F5:t::l:2:f:7\\ncell:G5:l:2:f:7\\ncell:H5:l:2:f:7\\ncell:I5:t::b::1:::l:2:f:7\\ncell:A6:b::2:::l:3:f:7\\ncell:B6:b::::2:l:3:f:4\\ncell:C6:t:INVOICE DATE\\\\c:f:2:cf:2\\ncell:D6:f:2:cf:2:ntvf:4\\ncell:F6:l:2:f:7\\ncell:G6:l:2:f:7\\ncell:H6:l:2:f:7\\ncell:I6:b::1:::l:2:f:7\\ncell:A7:b::2:::l:3:f:7\\ncell:B7:b::::2:l:3:f:4\\ncell:I7:b::2:::l:3:f:7\\ncell:A8:b::2:::l:3:f:7\\ncell:B8:b::::2:l:3:f:4\\ncell:I8:b::2:::l:3:f:7\\ncell:A9:b::2:::l:3:f:7\\ncell:B9:b::::2:l:3:f:4\\ncell:C9:t:BILL TO\\\\c:f:2\\ncell:E9:t:FROM\\\\c:f:2:cf:2\\ncell:F9:colspan:3\\ncell:I9:b::2:::l:3:f:7\\ncell:A10:b::2:::l:3:f:7\\ncell:B10:b::::2:l:3:f:3\\ncell:C10:t:[Name]:f:1:cf:2:colspan:2\\ncell:E10:t:[Name]:f:1:cf:2:colspan:4\\ncell:I10:b::2:::l:3:f:7\\ncell:A11:b::2:::l:3:f:7\\ncell:B11:b::::2:l:3:f:7\\ncell:C11:t:[Street Address]:f:1:cf:2:colspan:2\\ncell:E11:t:[Street Address]:f:1:colspan:4\\ncell:I11:b::2:::l:3:f:7\\ncell:A12:b::2:::l:3:f:7\\ncell:B12:b::::2:l:3:f:7\\ncell:C12:t:[City, State, Zip]:f:1:cf:2:colspan:2\\ncell:E12:t:[City, State, Zip]:f:1:cf:2:colspan:4\\ncell:I12:b::2:::l:3:f:7\\ncell:A13:b::2:::l:3:f:7\\ncell:B13:b::::2:l:3:f:7\\ncell:C13:t:Phone\\\\c :f:1:cf:2:colspan:2\\ncell:E13:t:Phone\\\\c :f:1:cf:2:colspan:4\\ncell:I13:b::2:::l:3:f:7\\ncell:A14:b::2:::l:3:f:7\\ncell:B14:b::::2:l:3:f:3:cf:2\\ncell:C14:b:::2::l:1:f:7\\ncell:D14:b:::2::l:3:f:3:cf:2\\ncell:E14:b:::2::l:1:f:7\\ncell:F14:b:::2::l:1:f:7\\ncell:G14:b:::2::l:1:f:7\\ncell:H14:b:::2::l:1:f:7\\ncell:I14:b::2:::l:3:f:7\\ncell:A15:b::2:::l:3:f:7\\ncell:B15:b::2::2:l:3:f:7\\ncell:C15:t:Description:b:1:1:1:1:f:2:cf:1:colspan:3\\ncell:D15:t:Description:b:2::2:2:l:3:f:3:cf:2:colspan:2:rowspan:1\\ncell:E15:t::b:2:2:2::l:1:f:7\\ncell:F15:t:Hours:b:1:1:1:1:f:2:cf:1\\ncell:G15:t:Rate:b:1:1:1:1:f:2:cf:1\\ncell:H15:t:Amount:b:1:1:1:1:f:2:cf:1\\ncell:I15:b::2::2:l:3:f:7\\ncell:A16:b::2:::l:3:f:7\\ncell:B16:b::2::2:l:3:f:7\\ncell:C16:b:1:1::1:f:1:cf:2:colspan:3\\ncell:D16:b:1:1::1:l:3:f:7:cf:2:colspan:2:rowspan:1\\ncell:E16:t::b:2:2:2::l:1:f:7\\ncell:F16:b:1:1:::f:1:ntvf:1\\ncell:G16:b:1:1:::f:1:ntvf:1\\ncell:H16:vtf:t::IF(F16*G16>0,F16*G16,\\\"\\\"):b:1:1:::f:1:ntvf:1\\ncell:I16:b::2::2:l:3:f:7\\ncell:A17:b::2:::l:3:f:7\\ncell:B17:b::2::2:l:3:f:7:cf:2\\ncell:C17:b::1::1:f:1:cf:2:colspan:3\\ncell:D17:b::1::1:l:1:f:7:colspan:2\\ncell:E17:l:1:f:7\\ncell:F17:b::1:::f:1:ntvf:1\\ncell:G17:b::1:::f:1:ntvf:1\\ncell:H17:vtf:t::IF(F17*G17>0,F17*G17,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I17:b::2::2:l:3:f:7\\ncell:A18:b::2:::l:3:f:7\\ncell:B18:b::2::2:l:3:f:7:cf:2:ntvf:3\\ncell:C18:b::1::1:f:1:cf:2:colspan:3\\ncell:D18:b::1::1:colspan:2\\ncell:F18:b::1:::f:1:ntvf:1\\ncell:G18:b::1:::f:1:ntvf:1\\ncell:H18:vtf:t::IF(F18*G18>0,F18*G18,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I18:b::2::2:l:3:f:7\\ncell:A19:b::2:::l:3:f:7\\ncell:B19:b::2::2:l:3:f:7:cf:2:ntvf:3\\ncell:C19:b::1::1:f:1:cf:2:colspan:3\\ncell:D19:b::1::1:colspan:2\\ncell:F19:b::1:::f:1:ntvf:1\\ncell:G19:b::1:::f:1:ntvf:1\\ncell:H19:vtf:t::IF(F19*G19>0,F19*G19,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I19:b::2::2:l:3:f:7\\ncell:A20:b::2:::l:3:f:7\\ncell:B20:b::2::2:l:3:f:7:cf:2:ntvf:3\\ncell:C20:b::1::1:f:1:cf:2:colspan:3\\ncell:D20:b::1::1:colspan:2\\ncell:F20:b::1:::f:1:ntvf:1\\ncell:G20:b::1:::f:1:ntvf:1\\ncell:H20:vtf:t::IF(F20*G20>0,F20*G20,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I20:b::2::2:l:3:f:7\\ncell:A21:b::2:::l:3:f:7\\ncell:B21:b::2::2:l:3:f:7:cf:2:ntvf:3\\ncell:C21:b::1::1:f:1:cf:2:colspan:3\\ncell:D21:b::1::1:colspan:2\\ncell:F21:b::1:::f:1:ntvf:1\\ncell:G21:b::1:::f:1:ntvf:1\\ncell:H21:vtf:t::IF(F21*G21>0,F21*G21,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I21:b::2::2:l:3:f:7\\ncell:A22:b::2:::l:3:f:7\\ncell:B22:b::2::2:l:3:f:7:cf:2:ntvf:3\\ncell:C22:b::1::1:f:1:cf:2:colspan:3\\ncell:D22:b::1::1:colspan:2\\ncell:F22:b::1:::f:1:ntvf:1\\ncell:G22:b::1:::f:1:ntvf:1\\ncell:H22:vtf:t::IF(F22*G22>0,F22*G22,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I22:b::2::2:l:3:f:7\\ncell:A23:b::2:::l:3:f:7\\ncell:B23:b::2::2:l:3:f:7:cf:2\\ncell:C23:b::1::1:f:1:cf:2:colspan:3\\ncell:D23:b::1::1:colspan:2\\ncell:F23:b::1:::f:1:ntvf:1\\ncell:G23:b::1:::f:1:ntvf:1\\ncell:H23:vtf:t::IF(F23*G23>0,F23*G23,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I23:b::2::2:l:3:f:7\\ncell:A24:b::2:::l:3:f:7\\ncell:B24:b::2::2:l:3:f:7:cf:2\\ncell:C24:b::1::1:f:1:cf:2:colspan:3\\ncell:D24:b::1::1:colspan:2\\ncell:F24:b::1:::f:1:ntvf:1\\ncell:G24:b::1:::f:1:ntvf:1\\ncell:H24:vtf:t::IF(F24*G24>0,F24*G24,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I24:b::2::2:l:3:f:7\\ncell:A25:b::2:::l:3:f:7\\ncell:B25:b::2::2:l:3:f:7:cf:2\\ncell:C25:b::1::1:f:1:cf:2:colspan:3\\ncell:D25:b::1::1:colspan:2\\ncell:F25:b::1:::f:1:ntvf:1\\ncell:G25:b::1:::f:1:ntvf:1\\ncell:H25:vtf:t::IF(F25*G25>0,F25*G25,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I25:b::2::2:l:3:f:7\\ncell:A26:b::2:::l:3:f:7\\ncell:B26:b::2::2:l:3:f:7:cf:2\\ncell:C26:b::1::1:f:1:cf:2:colspan:3\\ncell:D26:b::1::1:colspan:2\\ncell:F26:b::1:::f:1:ntvf:1\\ncell:G26:b::1:::f:1:ntvf:1\\ncell:H26:vtf:t::IF(F26*G26>0,F26*G26,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I26:b::2::2:l:3:f:7\\ncell:A27:b::2:::l:3:f:7\\ncell:B27:b::2::2:l:3:f:7:cf:2\\ncell:C27:b::1::1:f:1:cf:2:colspan:3\\ncell:D27:b::1::1:colspan:2\\ncell:F27:b::1:::f:1:ntvf:1\\ncell:G27:b::1:::f:1:ntvf:1\\ncell:H27:vtf:t::IF(F27*G27>0,F27*G27,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I27:b::2::2:l:3:f:7\\ncell:A28:b::2:::l:3:f:4\\ncell:B28:b::2::2:l:3:f:7:cf:2\\ncell:C28:b::1:1:1:f:1:cf:2:colspan:3\\ncell:D28:b::1:1:1:l:3:f:7:cf:2:colspan:2\\ncell:E28:b:::2::l:3:f:7:cf:2\\ncell:F28:b::1:1::f:1:ntvf:1\\ncell:G28:b::1:1::f:1:ntvf:1\\ncell:H28:vtf:t::IF(F28*G28>0,F28*G28,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I28:b::2::2:l:3:f:7\\ncell:A29:b::2:::l:3:f:3\\ncell:B29:b::2::2:l:3:f:3\\ncell:C29:t:TOTAL:b:1:1:1:1:l:3:f:5:cf:2:colspan:5\\ncell:D29:b:2::2::l:3:f:8:cf:2\\ncell:E29:b:2:2:2::l:3:f:8:cf:2\\ncell:F29:vtf:n:0:SUM(F16\\\\cF28):b:2:2:2::l:3:f:4:ntvf:2\\ncell:G29:b:2:2:2::l:3:f:4:ntvf:2\\ncell:H29:vtf:n:0:SUM(H16\\\\cH28):b:1:1:1::f:5:ntvf:1\\ncell:I29:b::2::2:l:3:f:4\\ncell:A30:b::2:::l:3:f:7\\ncell:B30:b::::2:l:3:f:3:cf:2\\ncell:C30:b:2::::l:1:f:7\\ncell:D30:b:2::::l:1:f:7\\ncell:E30:b:2::::l:1:f:7\\ncell:F30:b:2::::l:1:f:7\\ncell:G30:b:2::::l:1:f:7\\ncell:H30:b:2::::l:1:f:7\\ncell:I30:b::2:::l:3:f:3\\ncell:A31:b::2:::l:3:f:7\\ncell:B31:b::::2:l:3:f:7\\ncell:D31:tvf:5:rowspan:4\\ncell:I31:b::2:::l:3:f:7\\ncell:A32:b::2:::l:3:f:7\\ncell:B32:b::::2:l:3:f:7\\ncell:I32:b::2:::l:3:f:7\\ncell:A33:b::2:::l:3:f:7\\ncell:B33:b::::2:l:3:f:7\\ncell:I33:b::2:::l:3:f:7\\ncell:A34:b::2:::l:3:f:7\\ncell:B34:b::::2:l:3:f:7\\ncell:I34:b::2:::l:3:f:7\\ncell:A35:b::2:::l:3:f:7\\ncell:B35:b:::2:2:l:3:f:7\\ncell:C35:b:::2::l:3:f:7\\ncell:D35:b:::2::l:3:f:7\\ncell:E35:b:::2::l:3:f:7\\ncell:F35:b:::2::l:3:f:7\\ncell:G35:b:::2::l:3:f:7\\ncell:H35:b:::2::l:3:f:7\\ncell:I35:b::2:2::l:3:f:7\\ncell:B36:b:1:::\\ncell:C36:b:1:::\\ncell:D36:b:1:::\\ncell:E36:b:1:::\\ncell:F36:b:1:::\\ncell:G36:b:1:::\\ncell:H36:b:1:::\\ncell:I36:b:1:::\\ncol:A:w:26\\ncol:B:w:28\\ncol:C:w:96\\ncol:D:w:203\\ncol:E:w:51\\ncol:F:w:50\\ncol:G:w:58\\ncol:H:w:80\\ncol:I:w:28\\nrow:1:h:14.25\\nrow:2:h:18.75\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:15.75\\nrow:6:h:15.75\\nrow:7:h:15.75\\nrow:8:h:15.75\\nrow:9:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:13:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:16:h:14.25\\nrow:17:h:14.25\\nrow:18:h:14.25\\nrow:19:h:14.25\\nrow:20:h:14.25\\nrow:21:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nrow:24:h:14.25\\nrow:25:h:14.25\\nrow:26:h:14.25\\nrow:27:h:14.25\\nrow:28:h:15.75\\nrow:29:h:15.75\\nrow:30:h:14.25\\nrow:31:h:14.25\\nrow:32:h:14.25\\nrow:33:h:14.25\\nrow:34:h:14.25\\nrow:35:h:14.25\\nsheet:c:9:r:36:h:12.75\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\nfont:1:* * Trebuchet MS\\nfont:2:normal bold * Trebuchet MS\\nfont:3:normal bold 10pt Arial\\nfont:4:normal bold 12pt Arial\\nfont:5:normal bold 12pt Trebuchet MS\\nfont:6:normal bold 14pt Trebuchet MS\\nfont:7:normal normal 10pt Arial\\nfont:8:normal normal 12pt Arial\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nlayout:3:padding:* * * *;vertical-align:top;\\nvalueformat:1:#,##0.00\\nvalueformat:2:#,##0.00;(#,##0.00)\\nvalueformat:3:d-mmm\\nvalueformat:4:m/d/yy\\nvalueformat:5:text-html\\n\" }, \"name\": \"typeii\", \"hidden\": \"0\" }, \"sheet3\": { \"sheetstr\": { \"savestr\": \"version:1.5\\ncell:A1:l:3\\ncell:B2:t:[Company Name]:l:1:f:3:cf:2:colspan:3\\ncell:C2:t::l:2:f:9\\ncell:D2:t::l:2:f:9\\ncell:E2:l:1:f:7:c:2:cf:3\\ncell:F2:t:INVOICE:l:1:f:7:c:2:cf:2:colspan:2\\ncell:G2:t::l:2:f:9\\ncell:B3:t:[Company Slogan]:f:4:cf:2:colspan:3\\ncell:C3:t::l:2:f:9\\ncell:D3:t::l:2:f:9\\ncell:B4:f:2:colspan:2\\ncell:F4:tvf:4:rowspan:4\\ncell:B5:t:[Street Address]:f:1:cf:2:colspan:2\\ncell:F5:l:1:f:6\\ncell:G5:l:1:f:10:cf:1\\ncell:B6:t:[City, State,  Zip]:f:1:cf:2:colspan:2\\ncell:G6:l:1:f:9\\ncell:B7:t:Phone\\\\c :f:1:cf:2:colspan:2\\ncell:B8:t:Email\\\\c:f:1:cf:2:colspan:2\\ncell:B9:colspan:2\\ncell:F9:t:DATE \\\\c:l:1:f:6:cf:2\\ncell:G9:l:1:f:10:cf:2:ntvf:3\\ncell:B10:t:BILL TO\\\\c:f:5:c:1:bg:3:cf:2:colspan:2\\ncell:F10:t:INVOICE # \\\\c:l:1:f:6:cf:2\\ncell:G10:v:1:l:1:f:10:cf:2\\ncell:B11:t:[Name]:f:1:cf:2:colspan:2\\ncell:B12:t:[Company Name]:f:1:cf:2:colspan:2\\ncell:F12:t:  \\ncell:B13:t:[Street Address]:f:1:cf:2:colspan:2\\ncell:B14:t:[City, State,  Zip]:f:1:cf:2:colspan:2\\ncell:B15:t:Phone\\\\c :f:1:cf:2:colspan:2\\ncell:A17:b::1::\\ncell:B17:t:DESCRIPTION:b:1:1:1:1:l:1:f:6:c:1:bg:3:cf:1:colspan:5:rowspan:1\\ncell:C17:t::l:2:f:9\\ncell:D17:t::l:2:f:9\\ncell:E17:t::l:2:f:9\\ncell:F17:t::l:2:f:9\\ncell:G17:t:AMOUNT:b:1:1:1::l:1:f:6:c:1:bg:3:cf:1\\ncell:A18:b::1::\\ncell:B18:b:1:1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C18:t::l:2:f:9\\ncell:D18:t::l:2:f:9\\ncell:E18:t::l:2:f:9\\ncell:F18:t::b::2:::l:1:f:9\\ncell:G18:b::1::1:f:1:ntvf:1\\ncell:A19:b::1::\\ncell:B19:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C19:t::l:2:f:9\\ncell:D19:t::l:2:f:9\\ncell:E19:t::l:2:f:9\\ncell:F19:t::b::2:::l:1:f:9\\ncell:G19:b::1::1:f:1:ntvf:1\\ncell:A20:b::1::\\ncell:B20:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C20:t::l:2:f:9\\ncell:D20:t::l:2:f:9\\ncell:E20:t::l:2:f:9\\ncell:F20:t::b::2:::l:1:f:9\\ncell:G20:b::1::1:f:1:ntvf:1\\ncell:A21:b::1::\\ncell:B21:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C21:t::l:2:f:9\\ncell:D21:t::l:2:f:9\\ncell:E21:t::l:2:f:9\\ncell:F21:t::b::2:::l:1:f:9\\ncell:G21:b::1::1:f:1:ntvf:1\\ncell:A22:b::1::\\ncell:B22:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C22:t::l:2:f:9\\ncell:D22:t::l:2:f:9\\ncell:E22:t::l:2:f:9\\ncell:F22:t::b::2:::l:1:f:9\\ncell:G22:b::1::1:f:1:ntvf:1\\ncell:A23:b::1::\\ncell:B23:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C23:t::l:2:f:9\\ncell:D23:t::l:2:f:9\\ncell:E23:t::l:2:f:9\\ncell:F23:t::b::2:::l:1:f:9\\ncell:G23:b::1::1:f:1:ntvf:1\\ncell:A24:b::1::\\ncell:B24:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C24:t::l:2:f:9\\ncell:D24:t::l:2:f:9\\ncell:E24:t::l:2:f:9\\ncell:F24:t::b::2:::l:1:f:9\\ncell:G24:b::1::1:f:1:ntvf:1\\ncell:A25:b::1::\\ncell:B25:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C25:t::l:2:f:9\\ncell:D25:t::l:2:f:9\\ncell:E25:t::l:2:f:9\\ncell:F25:t::b::2:::l:1:f:9\\ncell:G25:b::1::1:f:1:ntvf:1\\ncell:A26:b::1::\\ncell:B26:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C26:t::l:2:f:9\\ncell:D26:t::l:2:f:9\\ncell:E26:t::l:2:f:9\\ncell:F26:t::b::2:::l:1:f:9\\ncell:G26:b::1::1:f:1:ntvf:1\\ncell:A27:b::1::\\ncell:B27:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C27:t::l:2:f:9\\ncell:D27:t::l:2:f:9\\ncell:E27:t::l:2:f:9\\ncell:F27:t::b::2:::l:1:f:9\\ncell:G27:b::1::1:f:1:ntvf:1\\ncell:A28:b::1::\\ncell:B28:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C28:t::l:2:f:9\\ncell:D28:t::l:2:f:9\\ncell:E28:t::l:2:f:9\\ncell:F28:t::b::2:::l:1:f:9\\ncell:G28:b::1::1:f:1:ntvf:1\\ncell:A29:b::1::\\ncell:B29:b::1:1:1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C29:t::b:::2::l:1:f:9\\ncell:D29:t::b:::2::l:1:f:9\\ncell:E29:t::b:::2::l:1:f:9\\ncell:F29:t::b::2:2::l:1:f:9\\ncell:G29:b::1:1:1:f:1:ntvf:1\\ncell:B30:b:2::::l:1:f:9\\ncell:C30:b:2::::l:1:f:9\\ncell:D30:b:2::::l:1:f:9\\ncell:E30:b:2::::l:1:f:10\\ncell:F30:t:Subtotal:b:2::::l:1:f:10\\ncell:G30:vtf:n:0:SUM(G18\\\\cG29):b:1::::f:8:ntvf:1\\ncell:B31:t:NOTES:b:::2::l:1:f:6:cf:2:colspan:3:rowspan:1\\ncell:C31:t::b:::2::l:1:f:9\\ncell:D31:t::b:::2::l:1:f:9\\ncell:F31:t:Tax Rate:l:1:f:1\\ncell:G31:v:0:f:1:ntvf:2\\ncell:B32:b:1::::f:1:cf:2:colspan:3\\ncell:C32:t::b:2::::l:1:f:9\\ncell:D32:t::b:2::::l:1:f:9\\ncell:F32:t:Tax:l:1:f:1\\ncell:G32:vtf:n:0:G31*G30:f:1:ntvf:1\\ncell:B33:f:1:cf:2:colspan:3\\ncell:C33:t::l:2:f:9\\ncell:D33:t::l:2:f:9\\ncell:F33:t:Other:b:::1::l:1:f:1\\ncell:G33:v:0:b:::1::f:1:ntvf:1\\ncell:B34:b:::1::f:1:cf:2:colspan:3:rowspan:1\\ncell:C34:t::l:2:f:9\\ncell:D34:t::l:2:f:9\\ncell:F34:t:TOTAL:b:2::::l:1:f:6\\ncell:G34:vtf:n:0:(G30+G32)+G33:b:1::::f:5:ntvf:1\\ncell:C36:tvf:4:colspan:5:rowspan:7\\ncol:A:w:40\\ncol:B:w:232\\ncol:C:w:53\\ncol:D:w:90\\ncol:E:w:54\\ncol:F:w:91\\ncol:G:w:99\\nrow:1:h:34.5\\nrow:2:h:34.5\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:14.25\\nrow:6:h:14.25\\nrow:7:h:14.25\\nrow:8:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:13:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:17:h:14.25\\nrow:18:h:14.25\\nrow:19:h:14.25\\nrow:20:h:14.25\\nrow:21:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nrow:24:h:14.25\\nrow:25:h:14.25\\nrow:26:h:14.25\\nrow:27:h:14.25\\nrow:28:h:14.25\\nrow:29:h:14.25\\nrow:30:h:14.25\\nrow:31:h:14.25\\nrow:32:h:14.25\\nrow:33:h:14.25\\nrow:34:h:14.25\\nsheet:c:7:r:36:h:12.75:needsrecalc:yes\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\ncellformat:3:right\\ncolor:1:rgb(0, 0, 0)\\ncolor:2:rgb(0,0,0)\\ncolor:3:rgb(221, 221, 221)\\nfont:1:* * Trebuchet MS\\nfont:2:* 10pt *\\nfont:3:* 16pt Trebuchet MS\\nfont:4:italic normal * Trebuchet MS\\nfont:5:normal bold * Trebuchet MS\\nfont:6:normal bold 10pt Trebuchet MS\\nfont:7:normal bold 28pt Trebuchet MS\\nfont:8:normal normal * Trebuchet MS\\nfont:9:normal normal 10pt Arial\\nfont:10:normal normal 10pt Trebuchet MS\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nlayout:3:padding:36px * 28px *;vertical-align:*;\\nvalueformat:1:#,##0.00\\nvalueformat:2:#,##0.00%\\nvalueformat:3:m/d/yy\\nvalueformat:4:text-html\\n\" }, \"name\": \"typeiii\", \"hidden\": \"0\" }, \"sheet4\": { \"sheetstr\": { \"savestr\": \"version:1.5\\ncell:A1:l:3\\ncell:B2:t:[Company Name]:l:1:f:2:cf:2:colspan:3:rowspan:1\\ncell:C2:t::l:2:f:7\\ncell:D2:t::l:2:f:7\\ncell:F2:t:INVOICE:l:1:f:6:c:1:cf:2:colspan:2\\ncell:G2:t::l:2:f:7\\ncell:B3:t:[Company slogan]:f:3:cf:2:colspan:3:rowspan:1\\ncell:C3:t::l:2:f:7\\ncell:D3:t::l:2:f:7\\ncell:B4:cf:2:colspan:3:rowspan:1\\ncell:F4:tvf:4:rowspan:4\\ncell:B5:t:[Street Address]:f:1:cf:2:colspan:3:rowspan:1\\ncell:F5:l:1:f:5\\ncell:G5:l:1:f:8:cf:1\\ncell:B6:t:[City, State,  Zip]:f:1:cf:2:colspan:3:rowspan:1\\ncell:G6:l:1:f:7\\ncell:B7:t:Phone\\\\c :f:1:cf:2:colspan:3:rowspan:1\\ncell:B8:t:Email\\\\c:f:1:cf:2:colspan:3:rowspan:1\\ncell:B9:cf:2:colspan:3:rowspan:1\\ncell:B10:t:BILL TO\\\\c:l:1:f:5:bg:2:cf:2:colspan:2\\ncell:F10:t:DATE\\\\c:l:1:f:5:cf:2\\ncell:G10:l:1:f:8:cf:2:ntvf:3\\ncell:B11:t:[Name]:f:1:cf:2:colspan:3:rowspan:1\\ncell:F11:t:INVOICE # \\\\c:l:1:f:5:cf:2\\ncell:G11:v:1:l:1:f:8:cf:2\\ncell:B12:t:[Company Name]:f:1:cf:2:colspan:3:rowspan:1\\ncell:J12:tvf:4\\ncell:B13:t:[Street Address]:f:1:cf:2:colspan:3:rowspan:1\\ncell:B14:t:[City, State,  Zip]:f:1:cf:2:colspan:3:rowspan:1\\ncell:B15:t:Phone\\\\c :f:1:cf:2:colspan:3:rowspan:1\\ncell:B16:cf:2:colspan:3:rowspan:1\\ncell:A17:b::1::\\ncell:B17:t:DESCRIPTION:b:1:1:1:1:l:1:f:5:bg:2:cf:1:colspan:3:rowspan:1\\ncell:C17:t::b:1::1::l:1:f:7:bg:2\\ncell:D17:t::b:1::1::l:1:f:7:bg:2\\ncell:E17:t:HOURS:b:1:1:1::l:1:f:5:bg:2:cf:1\\ncell:F17:t:RATE:b:1:1:1::l:1:f:5:bg:2:cf:1\\ncell:G17:t:AMOUNT:b:1:1:1::l:1:f:5:bg:2:cf:1\\ncell:A18:b::1::\\ncell:B18:b:1:1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C18:t::b:2::::l:1:f:7\\ncell:D18:t::b:2:2:::l:1:f:7\\ncell:E18:b:1:1::1:f:1:ntvf:1\\ncell:F18:b:1:1::1:f:1:ntvf:1\\ncell:G18:vtf:t::IF(E18*F18>0,E18*F18,\\\"\\\"):b:1:1:::f:1:ntvf:1\\ncell:A19:b::1::\\ncell:B19:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C19:t::l:2:f:7\\ncell:D19:t::b::2:::l:1:f:7\\ncell:E19:b::1::1:f:1:ntvf:1\\ncell:F19:b::1::1:f:1:ntvf:1\\ncell:G19:vtf:t::IF(E19*F19>0,E19*F19,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A20:b::1::\\ncell:B20:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C20:t::l:2:f:7\\ncell:D20:t::b::2:::l:1:f:7\\ncell:E20:b::1::1:f:1:ntvf:1\\ncell:F20:b::1::1:f:1:ntvf:1\\ncell:G20:vtf:t::IF(E20*F20>0,E20*F20,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A21:b::1::\\ncell:B21:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C21:t::l:2:f:7\\ncell:D21:t::b::2:::l:1:f:7\\ncell:E21:b::1::1:f:1:ntvf:1\\ncell:F21:b::1::1:f:1:ntvf:1\\ncell:G21:vtf:t::IF(E21*F21>0,E21*F21,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A22:b::1::\\ncell:B22:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C22:t::l:2:f:7\\ncell:D22:t::b::2:::l:1:f:7\\ncell:E22:b::1::1:f:1:ntvf:1\\ncell:F22:b::1::1:f:1:ntvf:1\\ncell:G22:vtf:t::IF(E22*F22>0,E22*F22,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A23:b::1::\\ncell:B23:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C23:t::l:2:f:7\\ncell:D23:t::b::2:::l:1:f:7\\ncell:E23:b::1::1:f:1:ntvf:1\\ncell:F23:b::1::1:f:1:ntvf:1\\ncell:G23:vtf:t::IF(E23*F23>0,E23*F23,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A24:b::1::\\ncell:B24:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C24:t::l:2:f:7\\ncell:D24:t::b::2:::l:1:f:7\\ncell:E24:b::1::1:f:1:ntvf:1\\ncell:F24:b::1::1:f:1:ntvf:1\\ncell:G24:vtf:t::IF(E24*F24>0,E24*F24,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A25:b::1::\\ncell:B25:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C25:t::l:2:f:7\\ncell:D25:t::b::2:::l:1:f:7\\ncell:E25:b::1::1:f:1:ntvf:1\\ncell:F25:b::1::1:f:1:ntvf:1\\ncell:G25:vtf:t::IF(E25*F25>0,E25*F25,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A26:b::1::\\ncell:B26:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C26:t::l:2:f:7\\ncell:D26:t::b::2:::l:1:f:7\\ncell:E26:b::1::1:f:1:ntvf:1\\ncell:F26:b::1::1:f:1:ntvf:1\\ncell:G26:vtf:t::IF(E26*F26>0,E26*F26,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A27:b::1::\\ncell:B27:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C27:t::l:2:f:7\\ncell:D27:t::b::2:::l:1:f:7\\ncell:E27:b::1::1:f:1:ntvf:1\\ncell:F27:b::1::1:f:1:ntvf:1\\ncell:G27:vtf:t::IF(E27*F27>0,E27*F27,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A28:b::1::\\ncell:B28:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C28:t::l:2:f:7\\ncell:D28:t::b::2:::l:1:f:7\\ncell:E28:b::1::1:f:1:ntvf:1\\ncell:F28:b::1::1:f:1:ntvf:1\\ncell:G28:vtf:t::IF(E28*F28>0,E28*F28,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A29:b::1::\\ncell:B29:b::1:1:1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C29:t::b:::2::l:1:f:7\\ncell:D29:t::b::2:2::l:1:f:7\\ncell:E29:b::1:1:1:f:1:ntvf:1\\ncell:F29:b::1:1:1:f:1:ntvf:1\\ncell:G29:vtf:t::IF(E29*F29>0,E29*F29,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:B30:b:2::::l:1:f:8:cf:1:colspan:3:rowspan:1\\ncell:C30:t::b:2::::l:1:f:7\\ncell:D30:t::b:2::::l:1:f:7\\ncell:E30:b:2::::l:1:f:8\\ncell:F30:t:Subtotal:b:1::::f:1\\ncell:G30:vtf:n:0:SUM(G18\\\\cG29):b:1::::f:1:ntvf:1\\ncell:B31:t:NOTES:b:::2::l:1:f:5:cf:2:colspan:3:rowspan:1\\ncell:C31:t::b:::2::l:1:f:7\\ncell:D31:t::b:::2::l:1:f:7\\ncell:F31:t:Tax Rate:f:1\\ncell:G31:v:0:f:1:ntvf:2\\ncell:B32:b:1::::f:1:cf:2:colspan:3:rowspan:1\\ncell:C32:t::b:2::::l:1:f:7\\ncell:D32:t::b:2::::l:1:f:7\\ncell:F32:t:Tax:f:1\\ncell:G32:vtf:n:0:G31*G30:f:1:ntvf:1\\ncell:B33:f:1:cf:2:colspan:3:rowspan:1\\ncell:C33:t::l:2:f:7\\ncell:D33:t::l:2:f:7\\ncell:F33:t:Other:b:::1::l:1:f:1\\ncell:G33:v:0:b:::1::f:1:ntvf:1\\ncell:B34:f:1:cf:2:colspan:3:rowspan:1\\ncell:C34:t::l:2:f:7\\ncell:D34:t::l:2:f:7\\ncell:F34:t:TOTAL:b:1::::l:1:f:4\\ncell:G34:vtf:n:0:(G30+G32)+G33:b:1::::f:4:ntvf:1\\ncell:B35:b:2::::l:1:f:7\\ncell:C35:b:2::::l:1:f:7\\ncell:D35:b:2::::l:1:f:7\\ncell:C36:tvf:4:colspan:5:rowspan:7\\ncol:A:w:40\\ncol:B:w:194\\ncol:C:w:128\\ncol:D:w:60\\ncol:E:w:65\\ncol:F:w:95\\ncol:G:w:90\\nrow:1:h:34.5\\nrow:2:h:34.5\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:14.25\\nrow:6:h:14.25\\nrow:7:h:14.25\\nrow:8:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:13:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:17:h:14.25\\nrow:18:h:14.25\\nrow:19:h:14.25\\nrow:20:h:14.25\\nrow:21:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nrow:24:h:14.25\\nrow:25:h:14.25\\nrow:26:h:14.25\\nrow:27:h:14.25\\nrow:28:h:14.25\\nrow:29:h:14.25\\nrow:30:h:14.25\\nrow:31:h:14.25\\nrow:32:h:14.25\\nrow:33:h:14.25\\nrow:34:h:14.25\\nrow:35:h:14.25\\nsheet:c:10:r:36:h:12.75:needsrecalc:yes\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\ncolor:1:rgb(0,0,0)\\ncolor:2:rgb(221, 221, 221)\\nfont:1:* * Trebuchet MS\\nfont:2:* 16pt Trebuchet MS\\nfont:3:italic normal * Trebuchet MS\\nfont:4:normal bold * Trebuchet MS\\nfont:5:normal bold 10pt Trebuchet MS\\nfont:6:normal bold 28pt Trebuchet MS\\nfont:7:normal normal 10pt Arial\\nfont:8:normal normal 10pt Trebuchet MS\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nlayout:3:padding:36px * 28px *;vertical-align:*;\\nvalueformat:1:#,##0.00\\nvalueformat:2:#,##0.00%\\nvalueformat:3:m/d/yy\\nvalueformat:4:text-html\\n\" }, \"name\": \"typeiv\", \"hidden\": \"0\" } }, \"EditableCells\": { \"allow\": true, \"cells\": { \"typei!C10\": true, \"typei!B2\": true, \"typei!C11\": true, \"typei!C12\": true, \"typei!C13\": true, \"typei!D9\": true, \"typei!D4\": true, \"typei!D6\": true, \"typei!E10\": true, \"typei!E11\": true, \"typei!E12\": true, \"typei!E13\": true, \"typei!F9\": true, \"typei!C16\": true, \"typei!C17\": true, \"typei!C18\": true, \"typei!C19\": true, \"typei!C20\": true, \"typei!C21\": true, \"typei!C22\": true, \"typei!C23\": true, \"typei!C24\": true, \"typei!C25\": true, \"typei!C26\": true, \"typei!C27\": true, \"typei!C28\": true, \"typei!F16\": true, \"typei!F17\": true, \"typei!F18\": true, \"typei!F19\": true, \"typei!F20\": true, \"typei!F21\": true, \"typei!F22\": true, \"typei!F23\": true, \"typei!F24\": true, \"typei!F25\": true, \"typei!F26\": true, \"typei!F27\": true, \"typei!F28\": true, \"typei!E35\": true, \"typeii!B2\": true, \"typeii!D4\": true, \"typeii!C10\": true, \"typeii!C11\": true, \"typeii!C12\": true, \"typeii!C13\": true, \"typeii!D9\": true, \"typeii!E10\": true, \"typeii!E11\": true, \"typeii!E12\": true, \"typeii!E13\": true, \"typeii!F9\": true, \"typeii!C16\": true, \"typeii!C17\": true, \"typeii!C18\": true, \"typeii!C19\": true, \"typeii!C20\": true, \"typeii!C21\": true, \"typeii!C22\": true, \"typeii!C23\": true, \"typeii!C24\": true, \"typeii!C25\": true, \"typeii!C26\": true, \"typeii!C27\": true, \"typeii!C28\": true, \"typeii!F16\": true, \"typeii!F17\": true, \"typeii!F18\": true, \"typeii!F19\": true, \"typeii!F20\": true, \"typeii!F21\": true, \"typeii!F22\": true, \"typeii!F23\": true, \"typeii!F24\": true, \"typeii!F25\": true, \"typeii!F26\": true, \"typeii!F27\": true, \"typeii!F28\": true, \"typeii!G16\": true, \"typeii!G17\": true, \"typeii!G18\": true, \"typeii!G19\": true, \"typeii!G20\": true, \"typeii!G21\": true, \"typeii!G22\": true, \"typeii!G23\": true, \"typeii!G24\": true, \"typeii!G25\": true, \"typeii!G26\": true, \"typeii!G27\": true, \"typeii!G28\": true, \"typeii!E35\": true, \"typeiii!G9\": true, \"typeiii!G10\": true, \"typeiii!B2\": true, \"typeiii!B3\": true, \"typeiii!B4\": true, \"typeiii!B5\": true, \"typeiii!B6\": true, \"typeiii!B7\": true, \"typeiii!B8\": true, \"typeiii!B9\": true, \"typeiii!B11\": true, \"typeiii!B12\": true, \"typeiii!B13\": true, \"typeiii!B14\": true, \"typeiii!B15\": true, \"typeiii!B18\": true, \"typeiii!B19\": true, \"typeiii!B20\": true, \"typeiii!B21\": true, \"typeiii!B22\": true, \"typeiii!B23\": true, \"typeiii!B24\": true, \"typeiii!B25\": true, \"typeiii!B26\": true, \"typeiii!B27\": true, \"typeiii!B28\": true, \"typeiii!B29\": true, \"typeiii!G18\": true, \"typeiii!G19\": true, \"typeiii!G20\": true, \"typeiii!G21\": true, \"typeiii!G22\": true, \"typeiii!G23\": true, \"typeiii!G24\": true, \"typeiii!G25\": true, \"typeiii!G26\": true, \"typeiii!G27\": true, \"typeiii!G28\": true, \"typeiii!G29\": true, \"typeiii!B32\": true, \"typeiii!B33\": true, \"typeiii!B34\": true, \"typeiii!G31\": true, \"typeiii!G33\": true, \"typeiii!B37\": true, \"typeiv!G9\": true, \"typeiv!G10\": true, \"typeiv!B2\": true, \"typeiv!B3\": true, \"typeiv!B4\": true, \"typeiv!B5\": true, \"typeiv!B6\": true, \"typeiv!B7\": true, \"typeiv!B8\": true, \"typeiv!B11\": true, \"typeiv!B12\": true, \"typeiv!B13\": true, \"typeiv!B14\": true, \"typeiv!B15\": true, \"typeiv!B16\": true, \"typeiv!B18\": true, \"typeiv!B19\": true, \"typeiv!B20\": true, \"typeiv!B21\": true, \"typeiv!B22\": true, \"typeiv!B23\": true, \"typeiv!B24\": true, \"typeiv!B25\": true, \"typeiv!B26\": true, \"typeiv!B27\": true, \"typeiv!B28\": true, \"typeiv!B29\": true, \"typeiv!E18\": true, \"typeiv!E19\": true, \"typeiv!E20\": true, \"typeiv!E21\": true, \"typeiv!E22\": true, \"typeiv!E23\": true, \"typeiv!E24\": true, \"typeiv!E25\": true, \"typeiv!E26\": true, \"typeiv!E27\": true, \"typeiv!E28\": true, \"typeiv!E29\": true, \"typeiv!F18\": true, \"typeiv!F19\": true, \"typeiv!F2\": true, \"typeiv!F20\": true, \"typeiv!F21\": true, \"typeiv!F22\": true, \"typeiv!F23\": true, \"typeiv!F24\": true, \"typeiv!F25\": true, \"typeiv!F26\": true, \"typeiv!F27\": true, \"typeiv!F28\": true, \"typeiv!F29\": true, \"typeiv!B32\": true, \"typeiv!B33\": true, \"typeiv!B34\": true, \"typeiv!G31\": true, \"typeiv!G33\": true, \"typeiv!B37\": true, \"typeii!F15\": true, \"typeii!G15\": true, \"typeiv!E17\": true, \"typeiv!F17\": true, \"typeii!D6\": true, \"typeiv!G11\": true, \"typei!C4\": true, \"typeii!C4\": true, \"typeiii!F10\": true, \"typeiv!F11\": true, \"typeiv!F10\": true, \"typeiii!F9\": true, \"typeii!C6\": true, \"typei!C6\": true, \"typei!F4\": true, \"typeii!F4\": true, \"typeiii!F4\": true, \"typeiii!F2\": true, \"typeiv!F4\": true, \"typei!F29\": true, \"typeii!H29\": true, \"typeiii!G30\": true, \"typeiii!G34\": true, \"typeiv!G30\": true, \"typeiv!G34\": true }, \"constraints\": {} } },\n\t                                                \"footers\": [{ name: 'Invoice 1', index: 1, isActive: true }, { name: 'Invoice 2', index: 2, isActive: false }, { name: 'Company Invoice 1', index: 3, isActive: false }, { name: 'Company Invoice 2', index: 4, isActive: false }]\n\t                                },\n\t                                \"iPhone\": {\n\t                                                \"msc\": { \"numsheets\": 5, \"currentid\": \"sheet1\", \"currentname\": \"inv1\", \"sheetArr\": { \"sheet1\": { \"sheetstr\": { \"savestr\": \"version:1.5\\ncell:B1:b:::2::l:1:f:10\\ncell:C1:b:::2::l:1:f:10\\ncell:D1:b:::2::l:1:f:10\\ncell:E1:b:::2::l:1:f:10\\ncell:F1:b:::2::l:1:f:10\\ncell:G1:b:::2::l:1:f:10\\ncell:A2:b::2:::l:1:f:10\\ncell:B2:t:INVOICE:b:1:1:1:1:f:13:cf:1:colspan:6\\ncell:C2:t::b:2::2::l:1:f:10\\ncell:D2:t::b:2::2::l:1:f:10\\ncell:E2:t::b:2::2::l:1:f:10\\ncell:F2:t::b:2::2::l:1:f:10\\ncell:G2:t::b:2::2::l:1:f:10\\ncell:A3:b::2:::l:3:f:10\\ncell:B3:b:2:::2:l:3:f:10\\ncell:C3:b:2::::l:1:f:10\\ncell:D3:b:2::::l:1:f:10\\ncell:E3:b:2::::l:1:f:10\\ncell:F3:b:2::::l:1:f:10\\ncell:G3:b:2:2:::l:3:f:10\\ncell:A4:b::2:::l:3:f:10\\ncell:B4:b::::2:l:3:f:6\\ncell:C4:t:BILL TO\\\\c:f:9:colspan:2\\ncell:E4:f:5:cf:2\\ncell:G4:b::2:::l:3:f:10\\ncell:A5:b::2:::l:3:f:10\\ncell:B5:b::::2:l:3:f:7\\ncell:C5:t:[Name]:f:9:cf:2:colspan:3\\ncell:E5:f:1:cf:2\\ncell:F5:t::l:2:f:10:tvf:4:rowspan:6\\ncell:G5:t::b::1:::l:2:f:10\\ncell:A6:b::2:::l:3:f:10\\ncell:B6:b::::2:l:3:f:7\\ncell:C6:t:[Street Address]:f:9:cf:2:colspan:3\\ncell:E6:f:1:cf:2\\ncell:F6:l:2:f:10\\ncell:G6:b::1:::l:2:f:10\\ncell:A7:b::2:::l:3:f:10\\ncell:B7:b::::2:l:3:f:7\\ncell:C7:t:[City, State, Zip]:f:9:cf:2:colspan:3\\ncell:E7:f:1:cf:2\\ncell:G7:b::2:::l:3:f:10\\ncell:A8:b::2:::l:3:f:10\\ncell:B8:b::::2:l:3:f:7\\ncell:C8:t:Phone\\\\c:f:9:cf:2:colspan:3\\ncell:D8:f:8:cf:2\\ncell:E8:f:1:cf:2\\ncell:G8:b::2:::l:3:f:10\\ncell:A9:b::2:::l:3:f:10\\ncell:B9:b::::2:l:3:f:7\\ncell:C9:t:Email\\\\c:f:9:cf:2:colspan:3\\ncell:E9:f:1:cf:2\\ncell:G9:b::2:::l:3:f:10\\ncell:A10:b::2:::l:3:f:10\\ncell:B10:b::::2:l:3:f:7\\ncell:C10:colspan:2\\ncell:G10:b::2:::l:3:f:10\\ncell:A11:b::2:::l:3:f:10\\ncell:B11:b::::2:l:3:f:7\\ncell:C11:t:FROM\\\\c:f:9:colspan:2\\ncell:E11:f:8:colspan:2\\ncell:G11:b::2:::l:3:f:10\\ncell:A12:b::2:::l:3:f:10\\ncell:B12:b::::2:l:3:f:7\\ncell:C12:t:[Name]:f:9:colspan:4\\ncell:E12:colspan:2\\ncell:G12:b::2:::l:3:f:10\\ncell:A13:b::2:::l:3:f:10\\ncell:B13:b::::2:l:3:f:7\\ncell:C13:t:[Street Address]:f:9:colspan:4\\ncell:E13:colspan:2\\ncell:G13:b::2:::l:3:f:10\\ncell:A14:b::2:::l:3:f:10\\ncell:B14:b::::2:l:3:f:7\\ncell:C14:t:[City, State, Zip]:f:9:colspan:4\\ncell:E14:colspan:2\\ncell:G14:b::2:::l:3:f:10\\ncell:A15:b::2:::l:3:f:10\\ncell:B15:b::::2:l:3:f:7\\ncell:C15:t:Phone\\\\c:f:9:colspan:4\\ncell:D15:f:8:cf:2:colspan:3\\ncell:E15:colspan:2\\ncell:G15:b::2:::l:3:f:10\\ncell:A16:b::2:::l:3:f:10\\ncell:B16:b::::2:l:3:f:7\\ncell:C16:t:Email\\\\c:f:9:colspan:4\\ncell:E16:colspan:2\\ncell:G16:b::2:::l:3:f:10\\ncell:A17:b::2:::l:3:f:10\\ncell:B17:b::::2:l:3:f:6\\ncell:G17:b::2:::l:3:f:10\\ncell:A18:b::2:::l:3:f:10\\ncell:B18:b::::2:l:3:f:10\\ncell:C18:t:INVOICE #\\\\c:f:9:cf:2:colspan:4\\ncell:D18:v:1:l:4:f:9:cf:2:colspan:3\\ncell:G18:b::2:::l:3:f:10\\ncell:A19:b::2:::l:3:f:10\\ncell:B19:b::::2:l:3:f:10\\ncell:G19:b::2:::l:3:f:10\\ncell:A20:b::2:::l:3:f:10\\ncell:B20:b::::2:l:3:f:10\\ncell:C20:t:DATE\\\\c:f:9:cf:2\\ncell:D20:vtf:nd:42081:TODAY():f:9:cf:2:ntvf:3:colspan:2\\ncell:G20:b::2:::l:3:f:10\\ncell:A21:b::2:::l:3:f:10\\ncell:B21:b::::2:l:3:f:6:cf:2\\ncell:C21:b:::2::l:1:f:10\\ncell:D21:b:::2::l:3:f:6:cf:2\\ncell:E21:b:::2::l:1:f:10\\ncell:F21:b:::2::l:1:f:10\\ncell:G21:b::2:::l:3:f:10\\ncell:A22:b::2:::l:3:f:10\\ncell:B22:b::2::2:l:3:f:10\\ncell:C22:t:Description:b:1::1:1:f:9:cf:1:colspan:3\\ncell:D22:t:Description:b:1::1::l:3:f:6:cf:2:colspan:2:rowspan:1\\ncell:E22:t::b:2:2:2::l:1:f:10\\ncell:F22:t:Amount:b:1:1:1:1:f:9:cf:1\\ncell:G22:b::2::2:l:3:f:10\\ncell:A23:b::2:::l:3:f:10\\ncell:B23:b::2::2:l:3:f:10\\ncell:C23:b:1:1::1:f:2:cf:2:colspan:3\\ncell:D23:b:1:1:::l:3:f:10:cf:2:colspan:2:rowspan:1\\ncell:E23:t::b:2:2:2::l:1:f:10\\ncell:F23:b:1:1:::f:2:ntvf:1\\ncell:G23:b::2::2:l:3:f:10\\ncell:A24:b::2:::l:3:f:10\\ncell:B24:b::2::2:l:3:f:10:cf:2\\ncell:C24:b::1::1:f:2:cf:2:colspan:3\\ncell:D24:b::1:::l:1:f:10:colspan:2\\ncell:E24:l:1:f:10\\ncell:F24:b::1:::f:2:ntvf:1\\ncell:G24:b::2::2:l:3:f:10\\ncell:A25:b::2:::l:3:f:10\\ncell:B25:b::2::2:l:3:f:10:cf:2:ntvf:2\\ncell:C25:b::1::1:f:2:cf:2:colspan:3\\ncell:D25:b::1:::colspan:2\\ncell:F25:b::1:::f:2:ntvf:1\\ncell:G25:b::2::2:l:3:f:10\\ncell:A26:b::2:::l:3:f:10\\ncell:B26:b::2::2:l:3:f:10:cf:2:ntvf:2\\ncell:C26:b::1::1:f:2:cf:2:colspan:3\\ncell:D26:b::1:::colspan:2\\ncell:F26:b::1:::f:2:ntvf:1\\ncell:G26:b::2::2:l:3:f:10\\ncell:A27:b::2:::l:3:f:10\\ncell:B27:b::2::2:l:3:f:10:cf:2:ntvf:2\\ncell:C27:b::1::1:f:2:cf:2:colspan:3\\ncell:D27:b::1:::colspan:2\\ncell:F27:b::1:::f:2:ntvf:1\\ncell:G27:b::2::2:l:3:f:10\\ncell:A28:b::2:::l:3:f:10\\ncell:B28:b::2::2:l:3:f:10:cf:2:ntvf:2\\ncell:C28:b::1::1:f:2:cf:2:colspan:3\\ncell:D28:b::1:::colspan:2\\ncell:F28:b::1:::f:2:ntvf:1\\ncell:G28:b::2::2:l:3:f:10\\ncell:A29:b::2:::l:3:f:10\\ncell:B29:b::2::2:l:3:f:10:cf:2:ntvf:2\\ncell:C29:b::1::1:f:2:cf:2:colspan:3\\ncell:D29:b::1:::colspan:2\\ncell:F29:b::1:::f:2:ntvf:1\\ncell:G29:b::2::2:l:3:f:10\\ncell:A30:b::2:::l:3:f:10\\ncell:B30:b::2::2:l:3:f:10:cf:2\\ncell:C30:b::1::1:f:2:cf:2:colspan:3\\ncell:D30:b::1:::colspan:2\\ncell:F30:b::1:::f:2:ntvf:1\\ncell:G30:b::2::2:l:3:f:10\\ncell:A31:b::2:::l:3:f:10\\ncell:B31:b::2::2:l:3:f:10:cf:2\\ncell:C31:b::1::1:f:2:cf:2:colspan:3\\ncell:D31:b::1:::colspan:2\\ncell:F31:b::1:::f:2:ntvf:1\\ncell:G31:b::2::2:l:3:f:10\\ncell:A32:b::2:::l:3:f:10\\ncell:B32:b::2::2:l:3:f:10:cf:2\\ncell:C32:b::1::1:f:2:cf:2:colspan:3\\ncell:D32:b::1:::colspan:2\\ncell:F32:b::1:::f:2:ntvf:1\\ncell:G32:b::2::2:l:3:f:10\\ncell:A33:b::2:::l:3:f:10\\ncell:B33:b::2::2:l:3:f:10:cf:2\\ncell:C33:b::1::1:f:2:cf:2:colspan:3\\ncell:D33:b::1:::colspan:2\\ncell:F33:b::1:::f:2:ntvf:1\\ncell:G33:b::2::2:l:3:f:10\\ncell:A34:b::2:::l:3:f:10\\ncell:B34:b::2::2:l:3:f:10:cf:2\\ncell:C34:b::1::1:f:2:cf:2:colspan:3\\ncell:D34:b::1:::colspan:2\\ncell:F34:b::1:::f:2:ntvf:1\\ncell:G34:b::2::2:l:3:f:10\\ncell:A35:b::2:::l:3:f:7\\ncell:B35:b::2::2:l:3:f:10:cf:2\\ncell:C35:b::1:1:1:f:2:cf:2:colspan:3\\ncell:D35:b::1:1::l:3:f:10:cf:2:colspan:2\\ncell:E35:b:::2::l:3:f:10:cf:2\\ncell:F35:b::1:1::f:2:ntvf:1\\ncell:G35:b::2::2:l:3:f:10\\ncell:A36:b::2:::l:3:f:6\\ncell:B36:b::2::2:l:3:f:6\\ncell:C36:t:TOTAL:b:1:1:1:1:f:11:cf:2:colspan:3\\ncell:D36:b:2::2::l:3:f:12:cf:2\\ncell:E36:b:2:2:2::l:3:f:12:cf:2\\ncell:F36:vtf:n:0:SUM(F23\\\\cF35):b:1:1:1::f:11:ntvf:1\\ncell:G36:b::2::2:l:3:f:7\\ncell:A37:b::2:::l:3:f:10\\ncell:B37:b::::2:l:3:f:6:cf:2\\ncell:C37:b:2::::l:1:f:10\\ncell:D37:b:2::::l:1:f:10\\ncell:E37:b:2::::l:1:f:10\\ncell:F37:b:2::::l:1:f:10\\ncell:G37:b::2:::l:3:f:6\\ncell:A38:b::2:::l:3:f:10\\ncell:B38:b::::2:l:3:f:10\\ncell:G38:b::2:::l:3:f:10\\ncell:A39:b::2:::l:3:f:10\\ncell:B39:b::::2:l:3:f:10:cf:2\\ncell:C39:t:Thank you for your business:f:4:cf:1:colspan:4\\ncell:D39:t:Thank you for your business:colspan:3\\ncell:E39:t:Thank you for your business:f:3:colspan:2\\ncell:F39:t::l:2:f:10\\ncell:G39:b::2:::l:3:f:10\\ncell:A40:b::2:::l:3:f:10\\ncell:B40:b::::2:l:3:f:10\\ncell:G40:b::2:::l:3:f:10\\ncell:A41:b::2:::l:3:f:10\\ncell:B41:b:::2:2:l:3:f:10\\ncell:C41:b:::2::l:3:f:10\\ncell:D41:b:::2::l:3:f:10\\ncell:E41:b:::2::l:3:f:10\\ncell:F41:b:::2::l:3:f:10\\ncell:G41:b::2:2::l:3:f:10\\ncell:B42:b:1:::\\ncell:C42:b:1:::\\ncell:D42:b:1:::\\ncell:E42:b:1:::\\ncell:F42:b:1:::\\ncell:G42:b:1:::\\ncol:A:w:10\\ncol:B:w:10\\ncol:C:w:62\\ncol:D:w:73\\ncol:E:w:15\\ncol:F:w:68\\ncol:G:w:10\\nrow:1:h:14.25\\nrow:2:h:18.75\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:15.75\\nrow:6:h:15.75\\nrow:7:h:15.75\\nrow:8:h:15.75\\nrow:9:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:13:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:16:h:14.25\\nrow:17:h:14.25\\nrow:18:h:14.25\\nrow:19:h:14.25\\nrow:20:h:14.25\\nrow:21:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nrow:24:h:14.25\\nrow:25:h:14.25\\nrow:26:h:14.25\\nrow:27:h:14.25\\nrow:28:h:14.25\\nrow:29:h:14.25\\nrow:30:h:14.25\\nrow:31:h:14.25\\nrow:32:h:14.25\\nrow:33:h:14.25\\nrow:34:h:14.25\\nrow:35:h:15.75\\nrow:36:h:15.75\\nrow:37:h:14.25\\nrow:38:h:14.25\\nrow:39:h:14.25\\nrow:40:h:14.25\\nrow:41:h:14.25\\nsheet:c:7:r:42:h:12.75\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\nfont:1:* * Trebuchet MS\\nfont:2:* 9pt Trebuchet MS\\nfont:3:italic bold * Trebuchet MS\\nfont:4:italic bold 10pt Trebuchet MS\\nfont:5:normal bold * Trebuchet MS\\nfont:6:normal bold 10pt Arial\\nfont:7:normal bold 12pt Arial\\nfont:8:normal normal * *\\nfont:9:normal normal * Trebuchet MS\\nfont:10:normal normal 10pt Arial\\nfont:11:normal normal 11pt Trebuchet MS\\nfont:12:normal normal 12pt Arial\\nfont:13:normal normal 16pt Trebuchet MS\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nlayout:3:padding:* * * *;vertical-align:top;\\nlayout:4:padding:* * * 4px;vertical-align:*;\\nvalueformat:1:#,##0.00\\nvalueformat:2:d-mmm\\nvalueformat:3:m/d/yy\\nvalueformat:4:text-html\\n\" }, \"name\": \"inv1\", \"hidden\": \"0\" }, \"sheet2\": { \"sheetstr\": { \"savestr\": \"version:1.5\\ncell:B2:t:INVOICE:l:1:f:9:cf:1:colspan:6\\ncell:C2:t::l:2:f:13\\ncell:D2:t::l:2:f:13\\ncell:E2:l:1:f:10:c:2:cf:3\\ncell:F2:t:INVOICE:l:1:f:8:c:2:cf:2:colspan:2\\ncell:G2:t::l:2:f:13\\ncell:B3:f:6:cf:2:colspan:4\\ncell:C3:t::l:2:f:13\\ncell:D3:t::l:2:f:13\\ncell:F3:l:1:f:7:cf:2\\ncell:G3:l:1:f:14:cf:2:ntvf:3\\ncell:B4:f:2:colspan:2\\ncell:F4:t:DATE\\\\c:l:1:f:14:cf:2\\ncell:G4:vtf:nd:42081:TODAY():l:1:f:14:cf:2:ntvf:3\\ncell:B5:t:INVOICE #\\\\c:f:3:colspan:6\\ncell:C5:cf:2:colspan:5\\ncell:F5:l:1:f:7:cf:2:colspan:2\\ncell:G5:l:1:f:14:cf:2\\ncell:B6:f:2:colspan:2\\ncell:F6:l:1:f:7:cf:2:colspan:2\\ncell:G6:l:1:f:14:cf:2\\ncell:B7:t:FROM\\\\c:f:12\\ncell:F7:l:1:f:7:cf:2:tvf:4:colspan:2:rowspan:6\\ncell:G7:l:1:f:14:cf:2\\ncell:B8:t:[Company Name]:f:3:colspan:4\\ncell:F8:l:1:f:7:cf:2:colspan:2\\ncell:G8:l:1:f:14:cf:2\\ncell:B9:t:[Street Address]:f:1:cf:2:colspan:4\\ncell:F9:l:1:f:7\\ncell:G9:l:1:f:14:cf:1\\ncell:B10:t:[City, State,  Zip]:f:1:cf:2:colspan:4\\ncell:G10:l:1:f:13\\ncell:B11:t:Phone\\\\c :f:1:cf:2:colspan:4\\ncell:B12:t:Email\\\\c:f:1:cf:2:colspan:4\\ncell:B13:colspan:2\\ncell:B14:t:BILL TO\\\\c:f:11:cf:2\\ncell:B15:t:[Name]:f:1:cf:2:colspan:6\\ncell:B16:t:[Company Name]:f:1:cf:2:colspan:6\\ncell:F16:t:  \\ncell:B17:t:[Street Address]:f:1:cf:2:colspan:6\\ncell:B18:t:[City, State,  Zip]:f:1:cf:2:colspan:6\\ncell:B19:t:Phone\\\\c :f:1:cf:2:colspan:6\\ncell:B20:t:Email\\\\c:f:1:cf:2:colspan:6\\ncell:A22:b::1::\\ncell:B22:t:DESCRIPTION:b:1:1:1:1:l:1:f:14:c:1:bg:3:cf:1:colspan:5:rowspan:1\\ncell:C22:t::l:2:f:13\\ncell:D22:t::l:2:f:13\\ncell:E22:t::l:2:f:13\\ncell:F22:t::l:2:f:13\\ncell:G22:t:AMOUNT:b:1:1:1::l:1:f:14:c:1:bg:3:cf:1\\ncell:A23:b::1::\\ncell:B23:b:1:1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C23:t::l:2:f:4\\ncell:D23:t::l:2:f:4\\ncell:E23:t::l:2:f:4\\ncell:F23:t::b::2:::l:1:f:4\\ncell:G23:b::1::1:f:4:ntvf:1\\ncell:A24:b::1::\\ncell:B24:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C24:t::l:2:f:4\\ncell:D24:t::l:2:f:4\\ncell:E24:t::l:2:f:4\\ncell:F24:t::b::2:::l:1:f:4\\ncell:G24:b::1::1:f:4:ntvf:1\\ncell:A25:b::1::\\ncell:B25:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C25:t::l:2:f:4\\ncell:D25:t::l:2:f:4\\ncell:E25:t::l:2:f:4\\ncell:F25:t::b::2:::l:1:f:4\\ncell:G25:b::1::1:f:4:ntvf:1\\ncell:A26:b::1::\\ncell:B26:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C26:t::l:2:f:4\\ncell:D26:t::l:2:f:4\\ncell:E26:t::l:2:f:4\\ncell:F26:t::b::2:::l:1:f:4\\ncell:G26:b::1::1:f:4:ntvf:1\\ncell:A27:b::1::\\ncell:B27:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C27:t::l:2:f:4\\ncell:D27:t::l:2:f:4\\ncell:E27:t::l:2:f:4\\ncell:F27:t::b::2:::l:1:f:4\\ncell:G27:b::1::1:f:4:ntvf:1\\ncell:A28:b::1::\\ncell:B28:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C28:t::l:2:f:4\\ncell:D28:t::l:2:f:4\\ncell:E28:t::l:2:f:4\\ncell:F28:t::b::2:::l:1:f:4\\ncell:G28:b::1::1:f:4:ntvf:1\\ncell:A29:b::1::\\ncell:B29:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C29:t::l:2:f:4\\ncell:D29:t::l:2:f:4\\ncell:E29:t::l:2:f:4\\ncell:F29:t::b::2:::l:1:f:4\\ncell:G29:b::1::1:f:4:ntvf:1\\ncell:A30:b::1::\\ncell:B30:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C30:t::l:2:f:4\\ncell:D30:t::l:2:f:4\\ncell:E30:t::l:2:f:4\\ncell:F30:t::b::2:::l:1:f:4\\ncell:G30:b::1::1:f:4:ntvf:1\\ncell:A31:b::1::\\ncell:B31:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C31:t::l:2:f:4\\ncell:D31:t::l:2:f:4\\ncell:E31:t::l:2:f:4\\ncell:F31:t::b::2:::l:1:f:4\\ncell:G31:b::1::1:f:4:ntvf:1\\ncell:A32:b::1::\\ncell:B32:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C32:t::l:2:f:4\\ncell:D32:t::l:2:f:4\\ncell:E32:t::l:2:f:4\\ncell:F32:t::b::2:::l:1:f:4\\ncell:G32:b::1::1:f:4:ntvf:1\\ncell:A33:b::1::\\ncell:B33:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C33:t::l:2:f:4\\ncell:D33:t::l:2:f:4\\ncell:E33:t::l:2:f:4\\ncell:F33:t::b::2:::l:1:f:4\\ncell:G33:b::1::1:f:4:ntvf:1\\ncell:A34:b::1::\\ncell:B34:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C34:l:2:f:4\\ncell:D34:l:2:f:4\\ncell:E34:l:2:f:4\\ncell:F34:b::2:::l:1:f:4\\ncell:G34:b::1::1:f:4:ntvf:1\\ncell:A35:b::1::\\ncell:B35:b::1:1:1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C35:t::b:::2::l:1:f:4\\ncell:D35:t::b:::2::l:1:f:4\\ncell:E35:t::b:::2::l:1:f:4\\ncell:F35:t::b::2:2::l:1:f:4\\ncell:G35:b::1:1:1:f:4:ntvf:1\\ncell:B36:b:2::::l:1:f:13\\ncell:C36:b:2::::l:1:f:13\\ncell:D36:b:2::::l:1:f:13\\ncell:E36:b:2::::l:1:f:14\\ncell:F36:t:Subtotal:b:2::::l:1:f:11\\ncell:G36:vtf:n:0:SUM(G23\\\\cG35):b:1::::f:11:ntvf:1\\ncell:B37:t:NOTES:b:::1::l:1:f:14:cf:2:colspan:3:rowspan:1\\ncell:C37:t::b:::2::l:1:f:13\\ncell:D37:t::b:::2::l:1:f:13\\ncell:F37:t:Tax Rate:l:1:f:11\\ncell:G37:v:0:f:1:ntvf:2\\ncell:B38:b:1::::f:1:cf:2:colspan:3\\ncell:C38:t::b:2::::l:1:f:13\\ncell:D38:t::b:2::::l:1:f:13\\ncell:F38:t:Tax:l:1:f:11\\ncell:G38:vtf:n:0:G37*G36:f:1:ntvf:1\\ncell:B39:f:1:cf:2:colspan:3\\ncell:C39:t::l:2:f:13\\ncell:D39:t::l:2:f:13\\ncell:F39:t:Other:b:::1::l:1:f:11\\ncell:G39:v:0:b:::1::f:1:ntvf:1\\ncell:B40:b:::1::f:1:cf:2:colspan:3:rowspan:1\\ncell:C40:t::l:2:f:13\\ncell:D40:t::l:2:f:13\\ncell:F40:t:TOTAL:b:1::::l:1:f:14\\ncell:G40:vtf:n:0:(G36+G38)+G39:b:1::::f:11:ntvf:1\\ncell:B43:t:Thank you for your business:l:1:f:5:cf:1:colspan:6:rowspan:1\\ncell:C43:t::l:2:f:13\\ncell:D43:t::l:2:f:13\\ncell:E43:t::l:2:f:13\\ncell:F43:t::l:2:f:13\\ncell:G43:t::l:2:f:13\\ncol:A:w:10\\ncol:B:w:90\\ncol:C:w:19\\ncol:D:w:10\\ncol:E:w:16\\ncol:F:w:45\\ncol:G:w:64\\nrow:1:h:34.5\\nrow:2:h:34.5\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:14.25\\nrow:6:h:14.25\\nrow:7:h:14.25\\nrow:8:h:14.25\\nrow:9:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:16:h:14.25\\nrow:17:h:14.25\\nrow:18:h:14.25\\nrow:19:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nrow:24:h:14.25\\nrow:25:h:14.25\\nrow:26:h:14.25\\nrow:27:h:14.25\\nrow:28:h:14.25\\nrow:29:h:14.25\\nrow:30:h:14.25\\nrow:31:h:14.25\\nrow:32:h:14.25\\nrow:33:h:14.25\\nrow:34:h:14.25\\nrow:35:h:14.25\\nrow:36:h:14.25\\nrow:37:h:14.25\\nrow:38:h:14.25\\nrow:39:h:14.25\\nrow:40:h:14.25\\nrow:43:h:15.75\\nsheet:c:7:r:43:h:12.75:needsrecalc:yes\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\ncellformat:3:right\\ncolor:1:rgb(0, 0, 0)\\ncolor:2:rgb(0,0,0)\\ncolor:3:rgb(221, 221, 221)\\nfont:1:* * Trebuchet MS\\nfont:2:* 10pt *\\nfont:3:* 10pt Trebuchet MS\\nfont:4:* 9pt Trebuchet MS\\nfont:5:italic bold 10pt Trebuchet MS\\nfont:6:italic normal * Trebuchet MS\\nfont:7:normal bold 10pt Trebuchet MS\\nfont:8:normal bold 14pt Trebuchet MS\\nfont:9:normal bold 16pt Trebuchet MS\\nfont:10:normal bold 28pt Trebuchet MS\\nfont:11:normal normal * Trebuchet MS\\nfont:12:normal normal 10pt *\\nfont:13:normal normal 10pt Arial\\nfont:14:normal normal 10pt Trebuchet MS\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nvalueformat:1:#,##0.00\\nvalueformat:2:#,##0.00%\\nvalueformat:3:m/d/yy\\nvalueformat:4:text-html\\n\" }, \"name\": \"inv2\", \"hidden\": \"0\" }, \"sheet3\": { \"sheetstr\": { \"savestr\": \"version:1.5\\ncell:B2:t:INVOICE:l:1:f:12:cf:1:colspan:6\\ncell:C2:t::l:2:f:10\\ncell:D2:t::l:2:f:10\\ncell:E2:l:1:f:8:c:2:cf:3\\ncell:F2:t:INVOICE:l:1:f:7:c:2:cf:2:colspan:2\\ncell:G2:t::l:2:f:10\\ncell:B3:f:5:cf:2:colspan:4\\ncell:C3:t::l:2:f:10\\ncell:D3:t::l:2:f:10\\ncell:F3:l:1:f:6:cf:2\\ncell:G3:l:1:f:11:cf:2:ntvf:3\\ncell:B4:f:2:colspan:2\\ncell:F4:t:DATE\\\\c:l:1:f:11:cf:2\\ncell:G4:vtf:nd:42081:TODAY():l:1:f:11:cf:2:ntvf:3\\ncell:B5:t:INVOICE #\\\\c:f:9:colspan:6\\ncell:C5:cf:2:colspan:5\\ncell:F5:l:1:f:6:cf:2:colspan:2\\ncell:G5:l:1:f:11:cf:2\\ncell:B6:f:2:colspan:2\\ncell:F6:l:1:f:6:cf:2:colspan:2\\ncell:G6:l:1:f:11:cf:2\\ncell:B7:t:FROM\\\\c:f:11\\ncell:F7:l:1:f:6:cf:2:colspan:2\\ncell:G7:l:1:f:11:cf:2\\ncell:B8:t:[Company Name]:f:9:colspan:4\\ncell:F8:l:1:f:6:cf:2:tvf:4:colspan:2:rowspan:5\\ncell:G8:l:1:f:11:cf:2\\ncell:B9:t:[Street Address]:f:9:cf:2:colspan:4\\ncell:F9:l:1:f:6\\ncell:G9:l:1:f:11:cf:1\\ncell:B10:t:[City, State,  Zip]:f:9:cf:2:colspan:4\\ncell:G10:l:1:f:10\\ncell:B11:t:Phone\\\\c :f:9:cf:2:colspan:4\\ncell:B12:t:Email\\\\c:f:9:cf:2:colspan:4\\ncell:B13:colspan:2\\ncell:B14:t:BILL TO\\\\c:f:9:cf:2\\ncell:B15:t:[Name]:f:9:cf:2:colspan:6\\ncell:B16:t:[Company Name]:f:9:cf:2:colspan:6\\ncell:F16:t:  \\ncell:B17:t:[Street Address]:f:9:cf:2:colspan:6\\ncell:B18:t:[City, State,  Zip]:f:9:cf:2:colspan:6\\ncell:B19:t:Phone\\\\c :f:9:cf:2:colspan:6\\ncell:B20:t:Email\\\\c:f:9:cf:2:colspan:6\\ncell:A22:b::1::\\ncell:B22:t:DESCRIPTION:b:1:1:1:1:l:1:f:11:c:1:bg:3:cf:1:colspan:5:rowspan:1\\ncell:C22:t::l:2:f:10\\ncell:D22:t::l:2:f:10\\ncell:E22:t::l:2:f:10\\ncell:F22:t::l:2:f:10\\ncell:G22:t:AMOUNT:b:1:1:1::l:1:f:11:c:1:bg:3:cf:1\\ncell:A23:b::1::\\ncell:B23:vtf:t: :IF(AND(ISBLANK(inv3!B6),ISBLANK(sheet7!B6)), \\\" \\\", IF(ISBLANK(inv3!B6), sheet7!B6, inv3!B6)):b:1:1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C23:t::l:2:f:3\\ncell:D23:t::l:2:f:3\\ncell:E23:t::l:2:f:3\\ncell:F23:t::b::2:::l:1:f:3\\ncell:G23:vtf:t: :IF(AND(ISBLANK(inv3!B6),ISBLANK(sheet7!B6)), \\\" \\\", IF(ISBLANK(inv3!B6), (sheet7!E6*sheet7!F6), (inv3!E6*inv3!F6))):b::1::1:f:3:ntvf:1\\ncell:A24:b::1::\\ncell:B24:vtf:t: :IF(AND(ISBLANK(INV3!B7),ISBLANK(SHEET7!B7)), \\\" \\\", IF(ISBLANK(INV3!B7), SHEET7!B7, INV3!B7)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C24:t::l:2:f:3\\ncell:D24:t::l:2:f:3\\ncell:E24:t::l:2:f:3\\ncell:F24:t::b::2:::l:1:f:3\\ncell:G24:vtf:t: :IF(AND(ISBLANK(INV3!B7),ISBLANK(SHEET7!B7)), \\\" \\\", IF(ISBLANK(INV3!B7), (SHEET7!E7*SHEET7!F7), (INV3!E7*INV3!F7))):b::1::1:f:3:ntvf:1\\ncell:A25:b::1::\\ncell:B25:vtf:t: :IF(AND(ISBLANK(INV3!B8),ISBLANK(SHEET7!B8)), \\\" \\\", IF(ISBLANK(INV3!B8), SHEET7!B8, INV3!B8)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C25:t::l:2:f:3\\ncell:D25:t::l:2:f:3\\ncell:E25:t::l:2:f:3\\ncell:F25:t::b::2:::l:1:f:3\\ncell:G25:vtf:t: :IF(AND(ISBLANK(INV3!B8),ISBLANK(SHEET7!B8)), \\\" \\\", IF(ISBLANK(INV3!B8), (SHEET7!E8*SHEET7!F8), (INV3!E8*INV3!F8))):b::1::1:f:3:ntvf:1\\ncell:A26:b::1::\\ncell:B26:vtf:t: :IF(AND(ISBLANK(INV3!B9),ISBLANK(SHEET7!B9)), \\\" \\\", IF(ISBLANK(INV3!B9), SHEET7!B9, INV3!B9)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C26:t::l:2:f:3\\ncell:D26:t::l:2:f:3\\ncell:E26:t::l:2:f:3\\ncell:F26:t::b::2:::l:1:f:3\\ncell:G26:vtf:t: :IF(AND(ISBLANK(INV3!B9),ISBLANK(SHEET7!B9)), \\\" \\\", IF(ISBLANK(INV3!B9), (SHEET7!E9*SHEET7!F9), (INV3!E9*INV3!F9))):b::1::1:f:3:ntvf:1\\ncell:A27:b::1::\\ncell:B27:vtf:t: :IF(AND(ISBLANK(INV3!B10),ISBLANK(SHEET7!B10)), \\\" \\\", IF(ISBLANK(INV3!B10), SHEET7!B10, INV3!B10)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C27:t::l:2:f:3\\ncell:D27:t::l:2:f:3\\ncell:E27:t::l:2:f:3\\ncell:F27:t::b::2:::l:1:f:3\\ncell:G27:vtf:t: :IF(AND(ISBLANK(INV3!B10),ISBLANK(SHEET7!B10)), \\\" \\\", IF(ISBLANK(INV3!B10), (SHEET7!E10*SHEET7!F10), (INV3!E10*INV3!F10))):b::1::1:f:3:ntvf:1\\ncell:A28:b::1::\\ncell:B28:vtf:t: :IF(AND(ISBLANK(INV3!B11),ISBLANK(SHEET7!B11)), \\\" \\\", IF(ISBLANK(INV3!B11), SHEET7!B11, INV3!B11)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C28:t::l:2:f:3\\ncell:D28:t::l:2:f:3\\ncell:E28:t::l:2:f:3\\ncell:F28:t::b::2:::l:1:f:3\\ncell:G28:vtf:t: :IF(AND(ISBLANK(INV3!B11),ISBLANK(SHEET7!B11)), \\\" \\\", IF(ISBLANK(INV3!B11), (SHEET7!E11*SHEET7!F11), (INV3!E11*INV3!F11))):b::1::1:f:3:ntvf:1\\ncell:A29:b::1::\\ncell:B29:vtf:t: :IF(AND(ISBLANK(INV3!B12),ISBLANK(SHEET7!B12)), \\\" \\\", IF(ISBLANK(INV3!B12), SHEET7!B12, INV3!B12)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C29:t::l:2:f:3\\ncell:D29:t::l:2:f:3\\ncell:E29:t::l:2:f:3\\ncell:F29:t::b::2:::l:1:f:3\\ncell:G29:vtf:t: :IF(AND(ISBLANK(INV3!B12),ISBLANK(SHEET7!B12)), \\\" \\\", IF(ISBLANK(INV3!B12), (SHEET7!E12*SHEET7!F12), (INV3!E12*INV3!F12))):b::1::1:f:3:ntvf:1\\ncell:A30:b::1::\\ncell:B30:vtf:t: :IF(AND(ISBLANK(INV3!B13),ISBLANK(SHEET7!B13)), \\\" \\\", IF(ISBLANK(INV3!B13), SHEET7!B13, INV3!B13)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C30:t::l:2:f:3\\ncell:D30:t::l:2:f:3\\ncell:E30:t::l:2:f:3\\ncell:F30:t::b::2:::l:1:f:3\\ncell:G30:vtf:t: :IF(AND(ISBLANK(INV3!B13),ISBLANK(SHEET7!B13)), \\\" \\\", IF(ISBLANK(INV3!B13), (SHEET7!E13*SHEET7!F13), (INV3!E13*INV3!F13))):b::1::1:f:3:ntvf:1\\ncell:A31:b::1::\\ncell:B31:vtf:t: :IF(AND(ISBLANK(INV3!B14),ISBLANK(SHEET7!B14)), \\\" \\\", IF(ISBLANK(INV3!B14), SHEET7!B14, INV3!B14)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C31:t::l:2:f:3\\ncell:D31:t::l:2:f:3\\ncell:E31:t::l:2:f:3\\ncell:F31:t::b::2:::l:1:f:3\\ncell:G31:vtf:t: :IF(AND(ISBLANK(INV3!B14),ISBLANK(SHEET7!B14)), \\\" \\\", IF(ISBLANK(INV3!B14), (SHEET7!E14*SHEET7!F14), (INV3!E14*INV3!F14))):b::1::1:f:3:ntvf:1\\ncell:A32:b::1::\\ncell:B32:vtf:t: :IF(AND(ISBLANK(INV3!B15),ISBLANK(SHEET7!B15)), \\\" \\\", IF(ISBLANK(INV3!B15), SHEET7!B15, INV3!B15)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C32:t::l:2:f:3\\ncell:D32:t::l:2:f:3\\ncell:E32:t::l:2:f:3\\ncell:F32:t::b::2:::l:1:f:3\\ncell:G32:vtf:t: :IF(AND(ISBLANK(INV3!B15),ISBLANK(SHEET7!B15)), \\\" \\\", IF(ISBLANK(INV3!B15), (SHEET7!E15*SHEET7!F15), (INV3!E15*INV3!F15))):b::1::1:f:3:ntvf:1\\ncell:A33:b::1::\\ncell:B33:vtf:t: :IF(AND(ISBLANK(INV3!B16),ISBLANK(SHEET7!B16)), \\\" \\\", IF(ISBLANK(INV3!B16), SHEET7!B16, INV3!B16)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C33:l:2:f:3\\ncell:D33:l:2:f:3\\ncell:E33:l:2:f:3\\ncell:F33:b::2:::l:1:f:3\\ncell:G33:vtf:t: :IF(AND(ISBLANK(INV3!B16),ISBLANK(SHEET7!B16)), \\\" \\\", IF(ISBLANK(INV3!B16), (SHEET7!E16*SHEET7!F16), (INV3!E16*INV3!F16))):b::1::1:f:3:ntvf:1\\ncell:A34:b::1::\\ncell:B34:vtf:t: :IF(AND(ISBLANK(INV3!B17),ISBLANK(SHEET7!B17)), \\\" \\\", IF(ISBLANK(INV3!B17), SHEET7!B17, INV3!B17)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C34:t::l:2:f:3\\ncell:D34:t::l:2:f:3\\ncell:E34:t::l:2:f:3\\ncell:F34:t::b::2:::l:1:f:3\\ncell:G34:vtf:t: :IF(AND(ISBLANK(INV3!B17),ISBLANK(SHEET7!B17)), \\\" \\\", IF(ISBLANK(INV3!B17), (SHEET7!E17*SHEET7!F17), (INV3!E17*INV3!F17))):b::1::1:f:3:ntvf:1\\ncell:A35:b::1::\\ncell:B35:vtf:t: :IF(AND(ISBLANK(INV3!B18),ISBLANK(SHEET7!B18)), \\\" \\\", IF(ISBLANK(INV3!B18), SHEET7!B18, INV3!B18)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C35:t::b:::2::l:1:f:3\\ncell:D35:t::b:::2::l:1:f:3\\ncell:E35:t::b:::2::l:1:f:3\\ncell:F35:t::b::2:2::l:1:f:3\\ncell:G35:vtf:t: :IF(AND(ISBLANK(INV3!B18),ISBLANK(SHEET7!B18)), \\\" \\\", IF(ISBLANK(INV3!B18), (SHEET7!E18*SHEET7!F18), (INV3!E18*INV3!F18))):b::1::1:f:3:ntvf:1\\ncell:B36:b:2::::l:1:f:10\\ncell:C36:b:2::::l:1:f:10\\ncell:D36:b:2::::l:1:f:10\\ncell:E36:b:2::::l:1:f:11\\ncell:F36:t:Subtotal:b:2::::l:1:f:9\\ncell:G36:vtf:n:0:SUM(G23\\\\cG35):b:1::::f:9:ntvf:1\\ncell:B37:t:NOTES:b:::1::l:1:f:11:cf:2:colspan:3:rowspan:1\\ncell:C37:t::b:::2::l:1:f:10\\ncell:D37:t::b:::2::l:1:f:10\\ncell:F37:t:Tax Rate:l:1:f:9\\ncell:G37:v:0:f:1:ntvf:2\\ncell:B38:b:1::::f:1:cf:2:colspan:3\\ncell:C38:t::b:2::::l:1:f:10\\ncell:D38:t::b:2::::l:1:f:10\\ncell:F38:t:Tax:l:1:f:9\\ncell:G38:vtf:n:0:G37*G36:f:1:ntvf:1\\ncell:B39:f:1:cf:2:colspan:3\\ncell:C39:t::l:2:f:10\\ncell:D39:t::l:2:f:10\\ncell:F39:t:Other:b:::1::l:1:f:9\\ncell:G39:v:0:b:::1::f:1:ntvf:1\\ncell:B40:b:::1::f:1:cf:2:colspan:3:rowspan:1\\ncell:C40:t::l:2:f:10\\ncell:D40:t::l:2:f:10\\ncell:F40:t:TOTAL:b:1::::l:1:f:11\\ncell:G40:vtf:n:0:(G36+G38)+G39:b:1::::f:9:ntvf:1\\ncell:B43:t:Thank you for your business:l:1:f:4:cf:1:colspan:6:rowspan:1\\ncell:C43:t::l:2:f:10\\ncell:D43:t::l:2:f:10\\ncell:E43:t::l:2:f:10\\ncell:F43:t::l:2:f:10\\ncell:G43:t::l:2:f:10\\ncol:A:w:10\\ncol:B:w:65\\ncol:C:w:19\\ncol:D:w:10\\ncol:E:w:16\\ncol:F:w:53\\ncol:G:w:64\\nrow:1:h:34.5\\nrow:2:h:34.5\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:14.25\\nrow:6:h:14.25\\nrow:7:h:14.25\\nrow:8:h:14.25\\nrow:9:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:16:h:14.25\\nrow:17:h:14.25\\nrow:18:h:14.25\\nrow:19:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nrow:24:h:14.25\\nrow:25:h:14.25\\nrow:26:h:14.25\\nrow:27:h:14.25\\nrow:28:h:14.25\\nrow:29:h:14.25\\nrow:30:h:14.25\\nrow:31:h:14.25\\nrow:32:h:14.25\\nrow:33:h:14.25\\nrow:34:h:14.25\\nrow:35:h:14.25\\nrow:36:h:14.25\\nrow:37:h:14.25\\nrow:38:h:14.25\\nrow:39:h:14.25\\nrow:40:h:14.25\\nrow:43:h:15.75\\nsheet:c:7:r:43:h:12.75:needsrecalc:yes\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\ncellformat:3:right\\ncolor:1:rgb(0, 0, 0)\\ncolor:2:rgb(0,0,0)\\ncolor:3:rgb(221, 221, 221)\\nfont:1:* * Trebuchet MS\\nfont:2:* 10pt *\\nfont:3:* 9pt Trebuchet MS\\nfont:4:italic bold 10pt Trebuchet MS\\nfont:5:italic normal * Trebuchet MS\\nfont:6:normal bold 10pt Trebuchet MS\\nfont:7:normal bold 14pt Trebuchet MS\\nfont:8:normal bold 28pt Trebuchet MS\\nfont:9:normal normal * Trebuchet MS\\nfont:10:normal normal 10pt Arial\\nfont:11:normal normal 10pt Trebuchet MS\\nfont:12:normal normal 16pt Trebuchet MS\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nvalueformat:1:#,##0.00\\nvalueformat:2:#,##0.00%\\nvalueformat:3:m/d/yy\\nvalueformat:4:text-html\\n\" }, \"name\": \"sheet6\", \"hidden\": \"0\" }, \"sheet4\": { \"sheetstr\": { \"savestr\": \"version:1.5\\ncell:B1:b:::2::l:1:f:7\\ncell:C1:b:::2::l:1:f:7\\ncell:D1:b:::2::l:1:f:7\\ncell:E1:b:::2::l:1:f:7\\ncell:F1:b:::2::l:1:f:7\\ncell:A2:b::2:::l:1:f:7\\ncell:B2:t:INVOICE DETAILS:b:1:1:1:1:l:1:f:8:cf:1:colspan:5\\ncell:C2:t::b:2::2::l:1:f:7\\ncell:D2:t::b:2::2::l:1:f:7\\ncell:E2:t::b:2::2::l:1:f:7\\ncell:F2:b:2:1:1::l:1:f:7\\ncell:G2:b::::1\\ncell:A3:b::2:::l:3:f:7\\ncell:B3:b:2::::l:1:f:7\\ncell:C3:b:2::::l:1:f:7\\ncell:D3:b:2::::l:1:f:7\\ncell:E3:b:2::::l:1:f:7\\ncell:F3:b:1:1:::l:1:f:7\\ncell:G3:b::::1\\ncell:A4:b::2:::l:3:f:7\\ncell:B4:b:::2::l:1:f:7\\ncell:C4:b:::2::l:3:f:4:cf:2\\ncell:D4:b:::2::l:1:f:7\\ncell:E4:b:::2::l:1:f:7\\ncell:F4:b::1:1::l:1:f:7\\ncell:G4:b::::1\\ncell:A5:b::2:::l:3:f:7\\ncell:B5:t:Description:b:1:1:1:1:f:6:cf:1:colspan:3\\ncell:C5:t:Description:b:2::2:2:l:3:f:4:cf:2:colspan:2:rowspan:1\\ncell:D5:t::b:2:2:2::l:1:f:7\\ncell:E5:t:Hours:b:1:1:1:1:f:6:cf:1\\ncell:F5:t:Rate:b:1:1:1:1:f:6:cf:1\\ncell:G5:b::::1\\ncell:A6:b::2:::l:3:f:7\\ncell:B6:b:1:1::1:f:1:cf:2:colspan:3\\ncell:C6:b:1:1::1:l:3:f:7:cf:2:colspan:2:rowspan:1\\ncell:D6:t::b:2:2:2::l:1:f:7\\ncell:E6:b:1:1:::f:1:ntvf:1\\ncell:F6:b:1:1:::f:1:ntvf:1\\ncell:G6:b::::1\\ncell:A7:b::2:::l:3:f:7\\ncell:B7:b::1::1:f:1:cf:2:colspan:3\\ncell:C7:b::1::1:l:1:f:7:colspan:2\\ncell:D7:l:1:f:7\\ncell:E7:b::1:::f:1:ntvf:1\\ncell:F7:b::1:::f:1:ntvf:1\\ncell:G7:b::::1\\ncell:A8:b::2:::l:3:f:7\\ncell:B8:b::1::1:f:1:cf:2:colspan:3\\ncell:C8:b::1::1:colspan:2\\ncell:E8:b::1:::f:1:ntvf:1\\ncell:F8:b::1:::f:1:ntvf:1\\ncell:G8:b::::1\\ncell:A9:b::2:::l:3:f:7\\ncell:B9:b::1::1:f:1:cf:2:colspan:3\\ncell:C9:b::1::1:colspan:2\\ncell:E9:b::1:::f:1:ntvf:1\\ncell:F9:b::1:::f:1:ntvf:1\\ncell:G9:b::::1\\ncell:A10:b::2:::l:3:f:7\\ncell:B10:b::1::1:f:1:cf:2:colspan:3\\ncell:C10:b::1::1:colspan:2\\ncell:E10:b::1:::f:1:ntvf:1\\ncell:F10:b::1:::f:1:ntvf:1\\ncell:G10:b::::1\\ncell:A11:b::2:::l:3:f:7\\ncell:B11:b::1::1:f:1:cf:2:colspan:3\\ncell:C11:b::1::1:colspan:2\\ncell:E11:b::1:::f:1:ntvf:1\\ncell:F11:b::1:::f:1:ntvf:1\\ncell:G11:b::::1\\ncell:A12:b::2:::l:3:f:7\\ncell:B12:b::1::1:f:1:cf:2:colspan:3\\ncell:C12:b::1::1:colspan:2\\ncell:E12:b::1:::f:1:ntvf:1\\ncell:F12:b::1:::f:1:ntvf:1\\ncell:G12:b::::1\\ncell:A13:b::2:::l:3:f:7\\ncell:B13:b::1::1:f:1:cf:2:colspan:3\\ncell:C13:b::1::1:colspan:2\\ncell:E13:b::1:::f:1:ntvf:1\\ncell:F13:b::1:::f:1:ntvf:1\\ncell:G13:b::::1\\ncell:A14:b::2:::l:3:f:7\\ncell:B14:b::1::1:f:1:cf:2:colspan:3\\ncell:C14:b::1::1:colspan:2\\ncell:E14:b::1:::f:1:ntvf:1\\ncell:F14:b::1:::f:1:ntvf:1\\ncell:G14:b::::1\\ncell:A15:b::2:::l:3:f:7\\ncell:B15:b::1::1:f:1:cf:2:colspan:3\\ncell:C15:b::1::1:colspan:2\\ncell:E15:b::1:::f:1:ntvf:1\\ncell:F15:b::1:::f:1:ntvf:1\\ncell:G15:b::::1\\ncell:A16:b::2:::l:3:f:7\\ncell:B16:b::1::1:f:1:cf:2:colspan:3\\ncell:C16:b::1::1:colspan:2\\ncell:E16:b::1:::f:1:ntvf:1\\ncell:F16:b::1:::f:1:ntvf:1\\ncell:G16:b::::1\\ncell:A17:b::2:::l:3:f:7\\ncell:B17:b::1::1:f:1:cf:2:colspan:3\\ncell:C17:b::1::1:colspan:2\\ncell:E17:b::1:::f:1:ntvf:1\\ncell:F17:b::1:::f:1:ntvf:1\\ncell:G17:b::::1\\ncell:A18:b::2:::l:3:f:5\\ncell:B18:b::1:1:1:f:1:cf:2:colspan:3\\ncell:C18:b::1:1:1:l:3:f:7:cf:2:colspan:2\\ncell:D18:b:::2::l:3:f:7:cf:2\\ncell:E18:b::1:1::f:1:ntvf:1\\ncell:F18:b::1:1::f:1:ntvf:1\\ncell:G18:b::::1\\ncell:A19:b::2:::l:3:f:7\\ncell:F19:b::1::\\ncell:G19:b::::1\\ncell:A20:b::2:::l:3:f:7\\ncell:F20:b::1::\\ncell:G20:b::::1\\ncell:A21:b::2:::l:3:f:7\\ncell:C21:t:Thank you for your business:b::1:::f:3:colspan:4\\ncell:D21:t:Thank you for your business:f:2:colspan:4\\ncell:E21:t::l:2:f:7\\ncell:F21:l:2:f:7\\ncell:G21:b::::1\\ncell:A22:b::2:::l:3:f:7\\ncell:F22:b::1::\\ncell:G22:b::::1\\ncell:A23:b::2:::l:3:f:7\\ncell:B23:b:::2::l:3:f:7\\ncell:C23:b:::2::l:3:f:7\\ncell:D23:b:::2::l:3:f:7\\ncell:E23:b:::2::l:3:f:7\\ncell:F23:b::1:1::l:3:f:7\\ncell:G23:b::::1\\ncell:B24:b:1:::\\ncell:C24:b:1:::\\ncell:D24:b:1:::\\ncell:E24:b:1:::\\ncell:F24:b:1:::\\ncol:A:w:10\\ncol:B:w:42\\ncol:C:w:56\\ncol:D:w:39\\ncol:E:w:48\\ncol:F:w:57\\nrow:1:h:14.25\\nrow:2:h:18.75\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:14.25\\nrow:6:h:14.25\\nrow:7:h:14.25\\nrow:8:h:14.25\\nrow:9:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:13:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:16:h:14.25\\nrow:17:h:14.25\\nrow:18:h:15.75\\nrow:19:h:14.25\\nrow:20:h:14.25\\nrow:21:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nsheet:c:7:r:24:h:12.75:needsrecalc:yes\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\nfont:1:* * Trebuchet MS\\nfont:2:italic bold * Trebuchet MS\\nfont:3:italic bold 10pt Trebuchet MS\\nfont:4:normal bold 10pt Arial\\nfont:5:normal bold 12pt Arial\\nfont:6:normal normal * Trebuchet MS\\nfont:7:normal normal 10pt Arial\\nfont:8:normal normal 16pt Arial\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nlayout:3:padding:* * * *;vertical-align:top;\\nvalueformat:1:#,##0.00\\n\" }, \"name\": \"inv3\", \"hidden\": \"0\" }, \"sheet5\": { \"sheetstr\": { \"savestr\": \"version:1.5\\ncell:B1:b:::2::l:1:f:7\\ncell:C1:b:::2::l:1:f:7\\ncell:D1:b:::2::l:1:f:7\\ncell:E1:b:::2::l:1:f:7\\ncell:F1:b:::2::l:1:f:7\\ncell:A2:b::2:::l:1:f:7\\ncell:B2:t:INVOICE DETAILS:b:1:1:1:1:l:1:f:8:cf:1:colspan:5\\ncell:C2:t::b:2::2::l:1:f:7\\ncell:D2:t::b:2::2::l:1:f:7\\ncell:E2:t::b:2::2::l:1:f:7\\ncell:F2:b:2:1:1::l:1:f:7\\ncell:G2:b::::1\\ncell:A3:b::2:::l:3:f:7\\ncell:B3:b:2::::l:1:f:7\\ncell:C3:b:2::::l:1:f:7\\ncell:D3:b:2::::l:1:f:7\\ncell:E3:b:2::::l:1:f:7\\ncell:F3:b:1:1:::l:1:f:7\\ncell:G3:b::::1\\ncell:A4:b::2:::l:3:f:7\\ncell:B4:b:::2::l:1:f:7\\ncell:C4:b:::2::l:3:f:4:cf:2\\ncell:D4:b:::2::l:1:f:7\\ncell:E4:b:::2::l:1:f:7\\ncell:F4:b::1:1::l:1:f:7\\ncell:G4:b::::1\\ncell:A5:b::2:::l:3:f:7\\ncell:B5:t:Description:b:1:1:1:1:f:6:cf:1:colspan:3\\ncell:C5:t:Description:b:2::2:2:l:3:f:4:cf:2:colspan:2:rowspan:1\\ncell:D5:t::b:2:2:2::l:1:f:7\\ncell:E5:t:Qty.:b:1:1:1:1:f:6:cf:1\\ncell:F5:t:Price:b:1:1:1:1:f:6:cf:1\\ncell:G5:b::::1\\ncell:A6:b::2:::l:3:f:7\\ncell:B6:b:1:1::1:f:1:cf:2:colspan:3\\ncell:C6:b:1:1::1:l:3:f:7:cf:2:colspan:2:rowspan:1\\ncell:D6:t::b:2:2:2::l:1:f:7\\ncell:E6:b:1:1:::f:1:ntvf:1\\ncell:F6:b:1:1:::f:1:ntvf:1\\ncell:G6:b::::1\\ncell:A7:b::2:::l:3:f:7\\ncell:B7:b::1::1:f:1:cf:2:colspan:3\\ncell:C7:b::1::1:l:1:f:7:colspan:2\\ncell:D7:l:1:f:7\\ncell:E7:b::1:::f:1:ntvf:1\\ncell:F7:b::1:::f:1:ntvf:1\\ncell:G7:b::::1\\ncell:A8:b::2:::l:3:f:7\\ncell:B8:b::1::1:f:1:cf:2:colspan:3\\ncell:C8:b::1::1:colspan:2\\ncell:E8:b::1:::f:1:ntvf:1\\ncell:F8:b::1:::f:1:ntvf:1\\ncell:G8:b::::1\\ncell:A9:b::2:::l:3:f:7\\ncell:B9:b::1::1:f:1:cf:2:colspan:3\\ncell:C9:b::1::1:colspan:2\\ncell:E9:b::1:::f:1:ntvf:1\\ncell:F9:b::1:::f:1:ntvf:1\\ncell:G9:b::::1\\ncell:A10:b::2:::l:3:f:7\\ncell:B10:b::1::1:f:1:cf:2:colspan:3\\ncell:C10:b::1::1:colspan:2\\ncell:E10:b::1:::f:1:ntvf:1\\ncell:F10:b::1:::f:1:ntvf:1\\ncell:G10:b::::1\\ncell:A11:b::2:::l:3:f:7\\ncell:B11:b::1::1:f:1:cf:2:colspan:3\\ncell:C11:b::1::1:colspan:2\\ncell:E11:b::1:::f:1:ntvf:1\\ncell:F11:b::1:::f:1:ntvf:1\\ncell:G11:b::::1\\ncell:A12:b::2:::l:3:f:7\\ncell:B12:b::1::1:f:1:cf:2:colspan:3\\ncell:C12:b::1::1:colspan:2\\ncell:E12:b::1:::f:1:ntvf:1\\ncell:F12:b::1:::f:1:ntvf:1\\ncell:G12:b::::1\\ncell:A13:b::2:::l:3:f:7\\ncell:B13:b::1::1:f:1:cf:2:colspan:3\\ncell:C13:b::1::1:colspan:2\\ncell:E13:b::1:::f:1:ntvf:1\\ncell:F13:b::1:::f:1:ntvf:1\\ncell:G13:b::::1\\ncell:A14:b::2:::l:3:f:7\\ncell:B14:b::1::1:f:1:cf:2:colspan:3\\ncell:C14:b::1::1:colspan:2\\ncell:E14:b::1:::f:1:ntvf:1\\ncell:F14:b::1:::f:1:ntvf:1\\ncell:G14:b::::1\\ncell:A15:b::2:::l:3:f:7\\ncell:B15:b::1::1:f:1:cf:2:colspan:3\\ncell:C15:b::1::1:colspan:2\\ncell:E15:b::1:::f:1:ntvf:1\\ncell:F15:b::1:::f:1:ntvf:1\\ncell:G15:b::::1\\ncell:A16:b::2:::l:3:f:7\\ncell:B16:b::1::1:f:1:cf:2:colspan:3\\ncell:C16:b::1::1:colspan:2\\ncell:E16:b::1:::f:1:ntvf:1\\ncell:F16:b::1:::f:1:ntvf:1\\ncell:G16:b::::1\\ncell:A17:b::2:::l:3:f:7\\ncell:B17:b::1::1:f:1:cf:2:colspan:3\\ncell:C17:b::1::1:colspan:2\\ncell:E17:b::1:::f:1:ntvf:1\\ncell:F17:b::1:::f:1:ntvf:1\\ncell:G17:b::::1\\ncell:A18:b::2:::l:3:f:5\\ncell:B18:b::1:1:1:f:1:cf:2:colspan:3\\ncell:C18:b::1:1:1:l:3:f:7:cf:2:colspan:2\\ncell:D18:b:::2::l:3:f:7:cf:2\\ncell:E18:b::1:1::f:1:ntvf:1\\ncell:F18:b::1:1::f:1:ntvf:1\\ncell:G18:b::::1\\ncell:A19:b::2:::l:3:f:7\\ncell:F19:b::1::\\ncell:G19:b::::1\\ncell:A20:b::2:::l:3:f:7\\ncell:F20:b::1::\\ncell:G20:b::::1\\ncell:A21:b::2:::l:3:f:7\\ncell:C21:t:Thank you for your business:b::1:::f:3:colspan:4\\ncell:D21:t:Thank you for your business:f:2:colspan:4\\ncell:E21:t::l:2:f:7\\ncell:F21:l:2:f:7\\ncell:G21:b::::1\\ncell:A22:b::2:::l:3:f:7\\ncell:F22:b::1::\\ncell:G22:b::::1\\ncell:A23:b::2:::l:3:f:7\\ncell:B23:b:::2::l:3:f:7\\ncell:C23:b:::2::l:3:f:7\\ncell:D23:b:::2::l:3:f:7\\ncell:E23:b:::2::l:3:f:7\\ncell:F23:b::1:1::l:3:f:7\\ncell:G23:b::::1\\ncell:B24:b:1:::\\ncell:C24:b:1:::\\ncell:D24:b:1:::\\ncell:E24:b:1:::\\ncell:F24:b:1:::\\ncol:A:w:10\\ncol:B:w:42\\ncol:C:w:56\\ncol:D:w:39\\ncol:E:w:48\\ncol:F:w:57\\nrow:1:h:14.25\\nrow:2:h:18.75\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:14.25\\nrow:6:h:14.25\\nrow:7:h:14.25\\nrow:8:h:14.25\\nrow:9:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:13:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:16:h:14.25\\nrow:17:h:14.25\\nrow:18:h:15.75\\nrow:19:h:14.25\\nrow:20:h:14.25\\nrow:21:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nsheet:c:7:r:24:h:12.75:needsrecalc:yes\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\nfont:1:* * Trebuchet MS\\nfont:2:italic bold * Trebuchet MS\\nfont:3:italic bold 10pt Trebuchet MS\\nfont:4:normal bold 10pt Arial\\nfont:5:normal bold 12pt Arial\\nfont:6:normal normal * Trebuchet MS\\nfont:7:normal normal 10pt Arial\\nfont:8:normal normal 16pt Arial\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nlayout:3:padding:* * * *;vertical-align:top;\\nvalueformat:1:#,##0.00\\n\" }, \"name\": \"sheet7\", \"hidden\": \"0\" } }, \"EditableCells\": { \"allow\": true, \"cells\": { \"inv1!B2\": true, \"inv1!C5\": true, \"inv1!C6\": true, \"inv1!C7\": true, \"inv1!C8\": true, \"inv1!C9\": true, \"inv1!C11\": true, \"inv1!C12\": true, \"inv1!C13\": true, \"inv1!C14\": true, \"inv1!C15\": true, \"inv1!C16\": true, \"inv1!C18\": true, \"inv1!C20\": true, \"inv1!D20\": true, \"inv1!C23\": true, \"inv1!C24\": true, \"inv1!C25\": true, \"inv1!C26\": true, \"inv1!C27\": true, \"inv1!C28\": true, \"inv1!C29\": true, \"inv1!C30\": true, \"inv1!C31\": true, \"inv1!C32\": true, \"inv1!C33\": true, \"inv1!C34\": true, \"inv1!C35\": true, \"inv1!F23\": true, \"inv1!F24\": true, \"inv1!F25\": true, \"inv1!F26\": true, \"inv1!F27\": true, \"inv1!F28\": true, \"inv1!F29\": true, \"inv1!F30\": true, \"inv1!F31\": true, \"inv1!F32\": true, \"inv1!F33\": true, \"inv1!F34\": true, \"inv1!F35\": true, \"inv2!B2\": true, \"inv2!F4\": true, \"inv2!G4\": true, \"inv2!B5\": true, \"inv2!B7\": true, \"inv2!B8\": true, \"inv2!B9\": true, \"inv2!B10\": true, \"inv2!B11\": true, \"inv2!B12\": true, \"inv2!B14\": true, \"inv2!B15\": true, \"inv2!B16\": true, \"inv2!B17\": true, \"inv2!B18\": true, \"inv2!B19\": true, \"inv2!B20\": true, \"inv2!B23\": true, \"inv2!B24\": true, \"inv2!B25\": true, \"inv2!B26\": true, \"inv2!B27\": true, \"inv2!B28\": true, \"inv2!B29\": true, \"inv2!B30\": true, \"inv2!B31\": true, \"inv2!B32\": true, \"inv2!B33\": true, \"inv2!B34\": true, \"inv2!B35\": true, \"inv2!G23\": true, \"inv2!G24\": true, \"inv2!G25\": true, \"inv2!G26\": true, \"inv2!G27\": true, \"inv2!G28\": true, \"inv2!G29\": true, \"inv2!G30\": true, \"inv2!G31\": true, \"inv2!G32\": true, \"inv2!G33\": true, \"inv2!G34\": true, \"inv2!G35\": true, \"inv2!B38\": true, \"inv2!B39\": true, \"inv2!B40\": true, \"inv2!F36\": true, \"inv2!G37\": true, \"inv2!F37\": true, \"inv2!F39\": true, \"inv2!G39\": true, \"inv2!F38\": true, \"sheet6!B2\": true, \"sheet6!F4\": true, \"sheet6!G4\": true, \"sheet6!B5\": true, \"sheet6!B7\": true, \"sheet6!B8\": true, \"sheet6!B9\": true, \"sheet6!B10\": true, \"sheet6!B11\": true, \"sheet6!B12\": true, \"sheet6!B14\": true, \"sheet6!B15\": true, \"sheet6!B16\": true, \"sheet6!B17\": true, \"sheet6!B18\": true, \"sheet6!B19\": true, \"sheet6!B20\": true, \"sheet6!B38\": true, \"sheet6!B39\": true, \"sheet6!B40\": true, \"sheet6!F36\": true, \"sheet6!G37\": true, \"sheet6!F37\": true, \"sheet6!F39\": true, \"sheet6!G39\": true, \"sheet6!F38\": true, \"inv3!B2\": true, \"inv3!B6\": true, \"inv3!B7\": true, \"inv3!B8\": true, \"inv3!B9\": true, \"inv3!B10\": true, \"inv3!B11\": true, \"inv3!B12\": true, \"inv3!B13\": true, \"inv3!B14\": true, \"inv3!B15\": true, \"inv3!B16\": true, \"inv3!B17\": true, \"inv3!B18\": true, \"inv3!E6\": true, \"inv3!E7\": true, \"inv3!E8\": true, \"inv3!E9\": true, \"inv3!E10\": true, \"inv3!E11\": true, \"inv3!E12\": true, \"inv3!E13\": true, \"inv3!E14\": true, \"inv3!E15\": true, \"inv3!E16\": true, \"inv3!E17\": true, \"inv3!E18\": true, \"inv3!F6\": true, \"inv3!F7\": true, \"inv3!F8\": true, \"inv3!F9\": true, \"inv3!F10\": true, \"inv3!F11\": true, \"inv3!F12\": true, \"inv3!F13\": true, \"inv3!F14\": true, \"inv3!F15\": true, \"inv3!F16\": true, \"inv3!F17\": true, \"inv3!F18\": true, \"sheet7!F6\": true, \"sheet7!F7\": true, \"sheet7!F8\": true, \"sheet7!F9\": true, \"sheet7!F10\": true, \"sheet7!F11\": true, \"sheet7!F12\": true, \"sheet7!F13\": true, \"sheet7!F14\": true, \"sheet7!F15\": true, \"sheet7!F16\": true, \"sheet7!F17\": true, \"sheet7!F18\": true, \"sheet7!E6\": true, \"sheet7!E7\": true, \"sheet7!E8\": true, \"sheet7!E9\": true, \"sheet7!E10\": true, \"sheet7!E11\": true, \"sheet7!E12\": true, \"sheet7!E13\": true, \"sheet7!E14\": true, \"sheet7!E15\": true, \"sheet7!E16\": true, \"sheet7!E17\": true, \"sheet7!E18\": true, \"sheet7!B6\": true, \"sheet7!B2\": true, \"sheet7!B7\": true, \"sheet7!B8\": true, \"sheet7!B9\": true, \"sheet7!B10\": true, \"sheet7!B11\": true, \"sheet7!B12\": true, \"sheet7!B13\": true, \"sheet7!B14\": true, \"sheet7!B15\": true, \"sheet7!B16\": true, \"sheet7!B17\": true, \"sheet7!B18\": true, \"inv1!D8\": true, \"inv1!D15\": true, \"inv1!D18\": true, \"inv2!C5\": true, \"sheet6!C5\": true }, \"constraints\": { \"inv1!C5\": [\"prompttext\", \"0\", \"1e10\", \"Name\"], \"inv1!C6\": [\"prompttext\", \"0\", \"1e10\", \"Street Address\"], \"inv1!C7\": [\"prompttext\", \"0\", \"1e10\", \"City, State, Zip\"], \"inv1!C8\": [\"prompttext\", \"0\", \"1e10\", \"Phone\"], \"inv1!C9\": [\"promptemail\", \"0\", \"1e10\", \"Email\"], \"inv1!C11\": [\"prompttext\", \"0\", \"1e10\", \"From\"], \"inv1!C12\": [\"prompttext\", \"0\", \"1e10\", \"Name\"], \"inv1!C13\": [\"prompttext\", \"0\", \"1e10\", \"Street Address\"], \"inv1!C14\": [\"prompttext\", \"0\", \"1e10\", \"City, State, Zip\"], \"inv1!C15\": [\"prompttext\", \"0\", \"1e10\", \"Phone\"], \"inv1!C16\": [\"promptemail\", \"0\", \"1e10\", \"Email\"], \"inv1!C18\": [\"prompttext\", \"0\", \"1e10\", \"Invoice #\"], \"inv1!C20\": [\"prompttext\", \"0\", \"1e10\", \"Date\"], \"inv1!D20\": [\"prompttext\", \"0\", \"1e10\", \"Date\"], \"inv1!C23\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv1!C24\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv1!C25\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv1!C26\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv1!C27\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv1!C28\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv1!C29\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv1!C30\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv1!C31\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv1!C32\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv1!C33\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv1!C34\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv1!C35\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv1!F23\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv1!F24\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv1!F25\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv1!F26\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv1!F27\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv1!F28\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv1!F29\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv1!F30\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv1!F31\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv1!F32\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv1!F33\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv1!F34\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv1!F35\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv2!B2\": [\"prompttext\", \"0\", \"1e10\", \"Invoice\"], \"inv2!F4\": [\"prompttext\", \"0\", \"1e10\", \"Date\"], \"inv2!G4\": [\"prompttext\", \"0\", \"1e10\", \"Date\"], \"inv2!B5\": [\"prompttext\", \"0\", \"1e10\", \"Invoice #\"], \"inv2!B7\": [\"prompttext\", \"0\", \"1e10\", \"From\"], \"inv2!B8\": [\"prompttext\", \"0\", \"1e10\", \"Company Name\"], \"inv2!B9\": [\"prompttext\", \"0\", \"1e10\", \"Street Address\"], \"inv2!B10\": [\"prompttext\", \"0\", \"1e10\", \"City, State, Zip\"], \"inv2!B11\": [\"prompttext\", \"0\", \"1e10\", \"Phone\"], \"inv2!B12\": [\"promptemail\", \"0\", \"1e10\", \"Email\"], \"inv2!B14\": [\"prompttext\", \"0\", \"1e10\", \"Bill To\"], \"inv2!B15\": [\"prompttext\", \"0\", \"1e10\", \"Name\"], \"inv2!B16\": [\"prompttext\", \"0\", \"1e10\", \"Company Name\"], \"inv2!B17\": [\"prompttext\", \"0\", \"1e10\", \"Street Address\"], \"inv2!B18\": [\"prompttext\", \"0\", \"1e10\", \"City, State, Zip\"], \"inv2!B19\": [\"prompttext\", \"0\", \"1e10\", \"Phone\"], \"inv2!B20\": [\"promptemail\", \"0\", \"1e10\", \"Email\"], \"inv2!B23\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv2!B24\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv2!B25\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv2!B26\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv2!B27\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv2!B28\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv2!B29\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv2!B30\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv2!B31\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv2!B32\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv2!B33\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv2!B34\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv2!B35\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv2!G23\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv2!G24\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv2!G25\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv2!G26\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv2!G27\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv2!G28\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv2!G29\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv2!G30\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv2!G31\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv2!G32\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv2!G33\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv2!G34\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv2!G35\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv2!B38\": [\"prompttext\", \"0\", \"1e10\", \"Notes\"], \"inv2!B39\": [\"prompttext\", \"0\", \"1e10\", \"Notes\"], \"inv2!B40\": [\"prompttext\", \"0\", \"1e10\", \"Notes\"], \"inv2!F36\": [\"prompttext\", \"0\", \"1e10\", \"Subtotal\"], \"inv2!G37\": [\"promptdecimal\", \"0\", \"1e10\", \"Tax Rate (0.00)\"], \"inv2!F37\": [\"prompttext\", \"0\", \"1e10\", \"Tax Rate\"], \"inv2!F39\": [\"prompttext\", \"0\", \"1e10\", \"Other\"], \"inv2!G39\": [\"promptdecimal\", \"0\", \"1e10\", \"Other\"], \"inv2!F38\": [\"prompttext\", \"0\", \"1e10\", \"Tax\"], \"sheet6!B2\": [\"prompttext\", \"0\", \"1e10\", \"Invoice\"], \"sheet6!F4\": [\"prompttext\", \"0\", \"1e10\", \"Date\"], \"sheet6!G4\": [\"prompttext\", \"0\", \"1e10\", \"Date\"], \"sheet6!B5\": [\"prompttext\", \"0\", \"1e10\", \"Invoice #\"], \"sheet6!B7\": [\"prompttext\", \"0\", \"1e10\", \"From\"], \"sheet6!B8\": [\"prompttext\", \"0\", \"1e10\", \"Company Name\"], \"sheet6!B9\": [\"prompttext\", \"0\", \"1e10\", \"Street Address\"], \"sheet6!B10\": [\"prompttext\", \"0\", \"1e10\", \"City, State, Zip\"], \"sheet6!B11\": [\"prompttext\", \"0\", \"1e10\", \"Phone\"], \"sheet6!B12\": [\"promptemail\", \"0\", \"1e10\", \"Email\"], \"sheet6!B14\": [\"prompttext\", \"0\", \"1e10\", \"Bill To\"], \"sheet6!B15\": [\"prompttext\", \"0\", \"1e10\", \"Name\"], \"sheet6!B16\": [\"prompttext\", \"0\", \"1e10\", \"Company Name\"], \"sheet6!B17\": [\"prompttext\", \"0\", \"1e10\", \"Street Address\"], \"sheet6!B18\": [\"prompttext\", \"0\", \"1e10\", \"City, State, Zip\"], \"sheet6!B19\": [\"prompttext\", \"0\", \"1e10\", \"Phone\"], \"sheet6!B20\": [\"promptemail\", \"0\", \"1e10\", \"Email\"], \"sheet6!B38\": [\"prompttext\", \"0\", \"1e10\", \"Notes\"], \"sheet6!B39\": [\"prompttext\", \"0\", \"1e10\", \"Notes\"], \"sheet6!B40\": [\"prompttext\", \"0\", \"1e10\", \"Notes\"], \"sheet6!F36\": [\"prompttext\", \"0\", \"1e10\", \"Subtotal\"], \"sheet6!G37\": [\"promptdecimal\", \"0\", \"1e10\", \"Tax Rate (0.00)\"], \"sheet6!F37\": [\"prompttext\", \"0\", \"1e10\", \"Tax Rate\"], \"sheet6!F39\": [\"prompttext\", \"0\", \"1e10\", \"Other\"], \"sheet6!G39\": [\"promptdecimal\", \"0\", \"1e10\", \"Other\"], \"sheet6!F38\": [\"prompttext\", \"0\", \"1e10\", \"Tax\"], \"inv3!B6\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv3!B7\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv3!B8\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv3!B9\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv3!B10\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv3!B11\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv3!B12\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv3!B13\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv3!B14\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv3!B15\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv3!B16\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv3!B17\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv3!B18\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"sheet7!B6\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"sheet7!B7\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"sheet7!B8\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"sheet7!B9\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"sheet7!B10\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"sheet7!B11\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"sheet7!B12\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"sheet7!B13\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"sheet7!B14\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"sheet7!B15\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"sheet7!B16\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"sheet7!B17\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"sheet7!B18\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv1!D8\": [\"prompttext\", \"0\", \"1e10\", \"Phone\"], \"inv1!D15\": [\"prompttext\", \"0\", \"1e10\", \"Phone\"], \"inv1!D18\": [\"promptnumeric\", \"0\", \"1e10\", \"Invoice#\"], \"inv2!C5\": [\"promptnumeric\", \"0\", \"1e10\", \"Invoice#\"], \"sheet6!C5\": [\"promptnumeric\", \"0\", \"1e10\", \"Invoice#\"], \"sheet7!E6\": [\"promptdecimal\", \"0\", \"1e10\", \"Quantity\"], \"sheet7!E7\": [\"promptdecimal\", \"0\", \"1e10\", \"Quantity\"], \"sheet7!E8\": [\"promptdecimal\", \"0\", \"1e10\", \"Quantity\"], \"sheet7!E9\": [\"promptdecimal\", \"0\", \"1e10\", \"Quantity\"], \"sheet7!E10\": [\"promptdecimal\", \"0\", \"1e10\", \"Quantity\"], \"sheet7!E11\": [\"promptdecimal\", \"0\", \"1e10\", \"Quantity\"], \"sheet7!E12\": [\"promptdecimal\", \"0\", \"1e10\", \"Quantity\"], \"sheet7!E13\": [\"promptdecimal\", \"0\", \"1e10\", \"Quantity\"], \"sheet7!E14\": [\"promptdecimal\", \"0\", \"1e10\", \"Quantity\"], \"sheet7!E15\": [\"promptdecimal\", \"0\", \"1e10\", \"Quantity\"], \"sheet7!E16\": [\"promptdecimal\", \"0\", \"1e10\", \"Quantity\"], \"sheet7!E17\": [\"promptdecimal\", \"0\", \"1e10\", \"Quantity\"], \"sheet7!E18\": [\"promptdecimal\", \"0\", \"1e10\", \"Quantity\"], \"sheet7!F6\": [\"promptdecimal\", \"0\", \"1e10\", \"Price\"], \"sheet7!F7\": [\"promptdecimal\", \"0\", \"1e10\", \"Price\"], \"sheet7!F8\": [\"promptdecimal\", \"0\", \"1e10\", \"Price\"], \"sheet7!F9\": [\"promptdecimal\", \"0\", \"1e10\", \"Price\"], \"sheet7!F10\": [\"promptdecimal\", \"0\", \"1e10\", \"Price\"], \"sheet7!F11\": [\"promptdecimal\", \"0\", \"1e10\", \"Price\"], \"sheet7!F12\": [\"promptdecimal\", \"0\", \"1e10\", \"Price\"], \"sheet7!F13\": [\"promptdecimal\", \"0\", \"1e10\", \"Price\"], \"sheet7!F14\": [\"promptdecimal\", \"0\", \"1e10\", \"Price\"], \"sheet7!F15\": [\"promptdecimal\", \"0\", \"1e10\", \"Price\"], \"sheet7!F16\": [\"promptdecimal\", \"0\", \"1e10\", \"Price\"], \"sheet7!F17\": [\"promptdecimal\", \"0\", \"1e10\", \"Price\"], \"sheet7!F18\": [\"promptdecimal\", \"0\", \"1e10\", \"Price\"], \"inv3!E6\": [\"promptdecimal\", \"0\", \"1e10\", \"Hours\"], \"inv3!E7\": [\"promptdecimal\", \"0\", \"1e10\", \"Hours\"], \"inv3!E8\": [\"promptdecimal\", \"0\", \"1e10\", \"Hours\"], \"inv3!E9\": [\"promptdecimal\", \"0\", \"1e10\", \"Hours\"], \"inv3!E10\": [\"promptdecimal\", \"0\", \"1e10\", \"Hours\"], \"inv3!E11\": [\"promptdecimal\", \"0\", \"1e10\", \"Hours\"], \"inv3!E12\": [\"promptdecimal\", \"0\", \"1e10\", \"Hours\"], \"inv3!E13\": [\"promptdecimal\", \"0\", \"1e10\", \"Hours\"], \"inv3!E14\": [\"promptdecimal\", \"0\", \"1e10\", \"Hours\"], \"inv3!E15\": [\"promptdecimal\", \"0\", \"1e10\", \"Hours\"], \"inv3!E16\": [\"promptdecimal\", \"0\", \"1e10\", \"Hours\"], \"inv3!E17\": [\"promptdecimal\", \"0\", \"1e10\", \"Hours\"], \"inv3!E18\": [\"promptdecimal\", \"0\", \"1e10\", \"Hours\"], \"inv3!F6\": [\"promptdecimal\", \"0\", \"1e10\", \"Rate\"], \"inv3!F7\": [\"promptdecimal\", \"0\", \"1e10\", \"Rate\"], \"inv3!F8\": [\"promptdecimal\", \"0\", \"1e10\", \"Rate\"], \"inv3!F9\": [\"promptdecimal\", \"0\", \"1e10\", \"Rate\"], \"inv3!F10\": [\"promptdecimal\", \"0\", \"1e10\", \"Rate\"], \"inv3!F11\": [\"promptdecimal\", \"0\", \"1e10\", \"Rate\"], \"inv3!F12\": [\"promptdecimal\", \"0\", \"1e10\", \"Rate\"], \"inv3!F13\": [\"promptdecimal\", \"0\", \"1e10\", \"Rate\"], \"inv3!F14\": [\"promptdecimal\", \"0\", \"1e10\", \"Rate\"], \"inv3!F15\": [\"promptdecimal\", \"0\", \"1e10\", \"Rate\"], \"inv3!F16\": [\"promptdecimal\", \"0\", \"1e10\", \"Rate\"], \"inv3!F17\": [\"promptdecimal\", \"0\", \"1e10\", \"Rate\"], \"inv3!F18\": [\"promptdecimal\", \"0\", \"1e10\", \"Rate\"] } } },\n\t                                                \"footers\": [{ name: 'Type1', index: 1, isActive: true }, { name: 'Type2', index: 2, isActive: false }, { name: 'Type3', index: 3, isActive: false }, { name: 'Detail1', index: 4, isActive: false }, { name: 'Detail2', index: 5, isActive: false }]\n\t                                },\n\t                                \"iPod\": {\n\t                                                \"msc\": { \"numsheets\": 5, \"currentid\": \"sheet1\", \"currentname\": \"inv1\", \"sheetArr\": { \"sheet1\": { \"sheetstr\": { \"savestr\": \"version:1.5\\ncell:B1:b:::2::l:1:f:10\\ncell:C1:b:::2::l:1:f:10\\ncell:D1:b:::2::l:1:f:10\\ncell:E1:b:::2::l:1:f:10\\ncell:F1:b:::2::l:1:f:10\\ncell:G1:b:::2::l:1:f:10\\ncell:A2:b::2:::l:1:f:10\\ncell:B2:t:INVOICE:b:1:1:1:1:f:13:cf:1:colspan:6\\ncell:C2:t::b:2::2::l:1:f:10\\ncell:D2:t::b:2::2::l:1:f:10\\ncell:E2:t::b:2::2::l:1:f:10\\ncell:F2:t::b:2::2::l:1:f:10\\ncell:G2:t::b:2::2::l:1:f:10\\ncell:A3:b::2:::l:3:f:10\\ncell:B3:b:2:::2:l:3:f:10\\ncell:C3:b:2::::l:1:f:10\\ncell:D3:b:2::::l:1:f:10\\ncell:E3:b:2::::l:1:f:10\\ncell:F3:b:2::::l:1:f:10\\ncell:G3:b:2:2:::l:3:f:10\\ncell:A4:b::2:::l:3:f:10\\ncell:B4:b::::2:l:3:f:6\\ncell:C4:t:BILL TO\\\\c:f:9:colspan:2\\ncell:E4:f:5:cf:2\\ncell:G4:b::2:::l:3:f:10\\ncell:A5:b::2:::l:3:f:10\\ncell:B5:b::::2:l:3:f:7\\ncell:C5:t:[Name]:f:9:cf:2:colspan:3\\ncell:E5:f:1:cf:2\\ncell:F5:t::l:2:f:10:tvf:4:rowspan:6\\ncell:G5:t::b::1:::l:2:f:10\\ncell:A6:b::2:::l:3:f:10\\ncell:B6:b::::2:l:3:f:7\\ncell:C6:t:[Street Address]:f:9:cf:2:colspan:3\\ncell:E6:f:1:cf:2\\ncell:F6:l:2:f:10\\ncell:G6:b::1:::l:2:f:10\\ncell:A7:b::2:::l:3:f:10\\ncell:B7:b::::2:l:3:f:7\\ncell:C7:t:[City, State, Zip]:f:9:cf:2:colspan:3\\ncell:E7:f:1:cf:2\\ncell:G7:b::2:::l:3:f:10\\ncell:A8:b::2:::l:3:f:10\\ncell:B8:b::::2:l:3:f:7\\ncell:C8:t:Phone\\\\c:f:9:cf:2:colspan:3\\ncell:D8:f:8:cf:2\\ncell:E8:f:1:cf:2\\ncell:G8:b::2:::l:3:f:10\\ncell:A9:b::2:::l:3:f:10\\ncell:B9:b::::2:l:3:f:7\\ncell:C9:t:Email\\\\c:f:9:cf:2:colspan:3\\ncell:E9:f:1:cf:2\\ncell:G9:b::2:::l:3:f:10\\ncell:A10:b::2:::l:3:f:10\\ncell:B10:b::::2:l:3:f:7\\ncell:C10:colspan:2\\ncell:G10:b::2:::l:3:f:10\\ncell:A11:b::2:::l:3:f:10\\ncell:B11:b::::2:l:3:f:7\\ncell:C11:t:FROM\\\\c:f:9:colspan:2\\ncell:E11:f:8:colspan:2\\ncell:G11:b::2:::l:3:f:10\\ncell:A12:b::2:::l:3:f:10\\ncell:B12:b::::2:l:3:f:7\\ncell:C12:t:[Name]:f:9:colspan:4\\ncell:E12:colspan:2\\ncell:G12:b::2:::l:3:f:10\\ncell:A13:b::2:::l:3:f:10\\ncell:B13:b::::2:l:3:f:7\\ncell:C13:t:[Street Address]:f:9:colspan:4\\ncell:E13:colspan:2\\ncell:G13:b::2:::l:3:f:10\\ncell:A14:b::2:::l:3:f:10\\ncell:B14:b::::2:l:3:f:7\\ncell:C14:t:[City, State, Zip]:f:9:colspan:4\\ncell:E14:colspan:2\\ncell:G14:b::2:::l:3:f:10\\ncell:A15:b::2:::l:3:f:10\\ncell:B15:b::::2:l:3:f:7\\ncell:C15:t:Phone\\\\c:f:9:colspan:4\\ncell:D15:f:8:cf:2:colspan:3\\ncell:E15:colspan:2\\ncell:G15:b::2:::l:3:f:10\\ncell:A16:b::2:::l:3:f:10\\ncell:B16:b::::2:l:3:f:7\\ncell:C16:t:Email\\\\c:f:9:colspan:4\\ncell:E16:colspan:2\\ncell:G16:b::2:::l:3:f:10\\ncell:A17:b::2:::l:3:f:10\\ncell:B17:b::::2:l:3:f:6\\ncell:G17:b::2:::l:3:f:10\\ncell:A18:b::2:::l:3:f:10\\ncell:B18:b::::2:l:3:f:10\\ncell:C18:t:INVOICE #\\\\c:f:9:cf:2:colspan:4\\ncell:D18:v:1:l:4:f:9:cf:2:colspan:3\\ncell:G18:b::2:::l:3:f:10\\ncell:A19:b::2:::l:3:f:10\\ncell:B19:b::::2:l:3:f:10\\ncell:G19:b::2:::l:3:f:10\\ncell:A20:b::2:::l:3:f:10\\ncell:B20:b::::2:l:3:f:10\\ncell:C20:t:DATE\\\\c:f:9:cf:2\\ncell:D20:vtf:nd:42081:TODAY():f:9:cf:2:ntvf:3:colspan:2\\ncell:G20:b::2:::l:3:f:10\\ncell:A21:b::2:::l:3:f:10\\ncell:B21:b::::2:l:3:f:6:cf:2\\ncell:C21:b:::2::l:1:f:10\\ncell:D21:b:::2::l:3:f:6:cf:2\\ncell:E21:b:::2::l:1:f:10\\ncell:F21:b:::2::l:1:f:10\\ncell:G21:b::2:::l:3:f:10\\ncell:A22:b::2:::l:3:f:10\\ncell:B22:b::2::2:l:3:f:10\\ncell:C22:t:Description:b:1::1:1:f:9:cf:1:colspan:3\\ncell:D22:t:Description:b:1::1::l:3:f:6:cf:2:colspan:2:rowspan:1\\ncell:E22:t::b:2:2:2::l:1:f:10\\ncell:F22:t:Amount:b:1:1:1:1:f:9:cf:1\\ncell:G22:b::2::2:l:3:f:10\\ncell:A23:b::2:::l:3:f:10\\ncell:B23:b::2::2:l:3:f:10\\ncell:C23:b:1:1::1:f:2:cf:2:colspan:3\\ncell:D23:b:1:1:::l:3:f:10:cf:2:colspan:2:rowspan:1\\ncell:E23:t::b:2:2:2::l:1:f:10\\ncell:F23:b:1:1:::f:2:ntvf:1\\ncell:G23:b::2::2:l:3:f:10\\ncell:A24:b::2:::l:3:f:10\\ncell:B24:b::2::2:l:3:f:10:cf:2\\ncell:C24:b::1::1:f:2:cf:2:colspan:3\\ncell:D24:b::1:::l:1:f:10:colspan:2\\ncell:E24:l:1:f:10\\ncell:F24:b::1:::f:2:ntvf:1\\ncell:G24:b::2::2:l:3:f:10\\ncell:A25:b::2:::l:3:f:10\\ncell:B25:b::2::2:l:3:f:10:cf:2:ntvf:2\\ncell:C25:b::1::1:f:2:cf:2:colspan:3\\ncell:D25:b::1:::colspan:2\\ncell:F25:b::1:::f:2:ntvf:1\\ncell:G25:b::2::2:l:3:f:10\\ncell:A26:b::2:::l:3:f:10\\ncell:B26:b::2::2:l:3:f:10:cf:2:ntvf:2\\ncell:C26:b::1::1:f:2:cf:2:colspan:3\\ncell:D26:b::1:::colspan:2\\ncell:F26:b::1:::f:2:ntvf:1\\ncell:G26:b::2::2:l:3:f:10\\ncell:A27:b::2:::l:3:f:10\\ncell:B27:b::2::2:l:3:f:10:cf:2:ntvf:2\\ncell:C27:b::1::1:f:2:cf:2:colspan:3\\ncell:D27:b::1:::colspan:2\\ncell:F27:b::1:::f:2:ntvf:1\\ncell:G27:b::2::2:l:3:f:10\\ncell:A28:b::2:::l:3:f:10\\ncell:B28:b::2::2:l:3:f:10:cf:2:ntvf:2\\ncell:C28:b::1::1:f:2:cf:2:colspan:3\\ncell:D28:b::1:::colspan:2\\ncell:F28:b::1:::f:2:ntvf:1\\ncell:G28:b::2::2:l:3:f:10\\ncell:A29:b::2:::l:3:f:10\\ncell:B29:b::2::2:l:3:f:10:cf:2:ntvf:2\\ncell:C29:b::1::1:f:2:cf:2:colspan:3\\ncell:D29:b::1:::colspan:2\\ncell:F29:b::1:::f:2:ntvf:1\\ncell:G29:b::2::2:l:3:f:10\\ncell:A30:b::2:::l:3:f:10\\ncell:B30:b::2::2:l:3:f:10:cf:2\\ncell:C30:b::1::1:f:2:cf:2:colspan:3\\ncell:D30:b::1:::colspan:2\\ncell:F30:b::1:::f:2:ntvf:1\\ncell:G30:b::2::2:l:3:f:10\\ncell:A31:b::2:::l:3:f:10\\ncell:B31:b::2::2:l:3:f:10:cf:2\\ncell:C31:b::1::1:f:2:cf:2:colspan:3\\ncell:D31:b::1:::colspan:2\\ncell:F31:b::1:::f:2:ntvf:1\\ncell:G31:b::2::2:l:3:f:10\\ncell:A32:b::2:::l:3:f:10\\ncell:B32:b::2::2:l:3:f:10:cf:2\\ncell:C32:b::1::1:f:2:cf:2:colspan:3\\ncell:D32:b::1:::colspan:2\\ncell:F32:b::1:::f:2:ntvf:1\\ncell:G32:b::2::2:l:3:f:10\\ncell:A33:b::2:::l:3:f:10\\ncell:B33:b::2::2:l:3:f:10:cf:2\\ncell:C33:b::1::1:f:2:cf:2:colspan:3\\ncell:D33:b::1:::colspan:2\\ncell:F33:b::1:::f:2:ntvf:1\\ncell:G33:b::2::2:l:3:f:10\\ncell:A34:b::2:::l:3:f:10\\ncell:B34:b::2::2:l:3:f:10:cf:2\\ncell:C34:b::1::1:f:2:cf:2:colspan:3\\ncell:D34:b::1:::colspan:2\\ncell:F34:b::1:::f:2:ntvf:1\\ncell:G34:b::2::2:l:3:f:10\\ncell:A35:b::2:::l:3:f:7\\ncell:B35:b::2::2:l:3:f:10:cf:2\\ncell:C35:b::1:1:1:f:2:cf:2:colspan:3\\ncell:D35:b::1:1::l:3:f:10:cf:2:colspan:2\\ncell:E35:b:::2::l:3:f:10:cf:2\\ncell:F35:b::1:1::f:2:ntvf:1\\ncell:G35:b::2::2:l:3:f:10\\ncell:A36:b::2:::l:3:f:6\\ncell:B36:b::2::2:l:3:f:6\\ncell:C36:t:TOTAL:b:1:1:1:1:f:11:cf:2:colspan:3\\ncell:D36:b:2::2::l:3:f:12:cf:2\\ncell:E36:b:2:2:2::l:3:f:12:cf:2\\ncell:F36:vtf:n:0:SUM(F23\\\\cF35):b:1:1:1::f:11:ntvf:1\\ncell:G36:b::2::2:l:3:f:7\\ncell:A37:b::2:::l:3:f:10\\ncell:B37:b::::2:l:3:f:6:cf:2\\ncell:C37:b:2::::l:1:f:10\\ncell:D37:b:2::::l:1:f:10\\ncell:E37:b:2::::l:1:f:10\\ncell:F37:b:2::::l:1:f:10\\ncell:G37:b::2:::l:3:f:6\\ncell:A38:b::2:::l:3:f:10\\ncell:B38:b::::2:l:3:f:10\\ncell:G38:b::2:::l:3:f:10\\ncell:A39:b::2:::l:3:f:10\\ncell:B39:b::::2:l:3:f:10:cf:2\\ncell:C39:t:Thank you for your business:f:4:cf:1:colspan:4\\ncell:D39:t:Thank you for your business:colspan:3\\ncell:E39:t:Thank you for your business:f:3:colspan:2\\ncell:F39:t::l:2:f:10\\ncell:G39:b::2:::l:3:f:10\\ncell:A40:b::2:::l:3:f:10\\ncell:B40:b::::2:l:3:f:10\\ncell:G40:b::2:::l:3:f:10\\ncell:A41:b::2:::l:3:f:10\\ncell:B41:b:::2:2:l:3:f:10\\ncell:C41:b:::2::l:3:f:10\\ncell:D41:b:::2::l:3:f:10\\ncell:E41:b:::2::l:3:f:10\\ncell:F41:b:::2::l:3:f:10\\ncell:G41:b::2:2::l:3:f:10\\ncell:B42:b:1:::\\ncell:C42:b:1:::\\ncell:D42:b:1:::\\ncell:E42:b:1:::\\ncell:F42:b:1:::\\ncell:G42:b:1:::\\ncol:A:w:10\\ncol:B:w:10\\ncol:C:w:62\\ncol:D:w:73\\ncol:E:w:15\\ncol:F:w:68\\ncol:G:w:10\\nrow:1:h:14.25\\nrow:2:h:18.75\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:15.75\\nrow:6:h:15.75\\nrow:7:h:15.75\\nrow:8:h:15.75\\nrow:9:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:13:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:16:h:14.25\\nrow:17:h:14.25\\nrow:18:h:14.25\\nrow:19:h:14.25\\nrow:20:h:14.25\\nrow:21:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nrow:24:h:14.25\\nrow:25:h:14.25\\nrow:26:h:14.25\\nrow:27:h:14.25\\nrow:28:h:14.25\\nrow:29:h:14.25\\nrow:30:h:14.25\\nrow:31:h:14.25\\nrow:32:h:14.25\\nrow:33:h:14.25\\nrow:34:h:14.25\\nrow:35:h:15.75\\nrow:36:h:15.75\\nrow:37:h:14.25\\nrow:38:h:14.25\\nrow:39:h:14.25\\nrow:40:h:14.25\\nrow:41:h:14.25\\nsheet:c:7:r:42:h:12.75\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\nfont:1:* * Trebuchet MS\\nfont:2:* 9pt Trebuchet MS\\nfont:3:italic bold * Trebuchet MS\\nfont:4:italic bold 10pt Trebuchet MS\\nfont:5:normal bold * Trebuchet MS\\nfont:6:normal bold 10pt Arial\\nfont:7:normal bold 12pt Arial\\nfont:8:normal normal * *\\nfont:9:normal normal * Trebuchet MS\\nfont:10:normal normal 10pt Arial\\nfont:11:normal normal 11pt Trebuchet MS\\nfont:12:normal normal 12pt Arial\\nfont:13:normal normal 16pt Trebuchet MS\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nlayout:3:padding:* * * *;vertical-align:top;\\nlayout:4:padding:* * * 4px;vertical-align:*;\\nvalueformat:1:#,##0.00\\nvalueformat:2:d-mmm\\nvalueformat:3:m/d/yy\\nvalueformat:4:text-html\\n\" }, \"name\": \"inv1\", \"hidden\": \"0\" }, \"sheet2\": { \"sheetstr\": { \"savestr\": \"version:1.5\\ncell:B2:t:INVOICE:l:1:f:9:cf:1:colspan:6\\ncell:C2:t::l:2:f:13\\ncell:D2:t::l:2:f:13\\ncell:E2:l:1:f:10:c:2:cf:3\\ncell:F2:t:INVOICE:l:1:f:8:c:2:cf:2:colspan:2\\ncell:G2:t::l:2:f:13\\ncell:B3:f:6:cf:2:colspan:4\\ncell:C3:t::l:2:f:13\\ncell:D3:t::l:2:f:13\\ncell:F3:l:1:f:7:cf:2\\ncell:G3:l:1:f:14:cf:2:ntvf:3\\ncell:B4:f:2:colspan:2\\ncell:F4:t:DATE\\\\c:l:1:f:14:cf:2\\ncell:G4:vtf:nd:42081:TODAY():l:1:f:14:cf:2:ntvf:3\\ncell:B5:t:INVOICE #\\\\c:f:3:colspan:6\\ncell:C5:cf:2:colspan:5\\ncell:F5:l:1:f:7:cf:2:colspan:2\\ncell:G5:l:1:f:14:cf:2\\ncell:B6:f:2:colspan:2\\ncell:F6:l:1:f:7:cf:2:colspan:2\\ncell:G6:l:1:f:14:cf:2\\ncell:B7:t:FROM\\\\c:f:12\\ncell:F7:l:1:f:7:cf:2:tvf:4:colspan:2:rowspan:6\\ncell:G7:l:1:f:14:cf:2\\ncell:B8:t:[Company Name]:f:3:colspan:4\\ncell:F8:l:1:f:7:cf:2:colspan:2\\ncell:G8:l:1:f:14:cf:2\\ncell:B9:t:[Street Address]:f:1:cf:2:colspan:4\\ncell:F9:l:1:f:7\\ncell:G9:l:1:f:14:cf:1\\ncell:B10:t:[City, State,  Zip]:f:1:cf:2:colspan:4\\ncell:G10:l:1:f:13\\ncell:B11:t:Phone\\\\c :f:1:cf:2:colspan:4\\ncell:B12:t:Email\\\\c:f:1:cf:2:colspan:4\\ncell:B13:colspan:2\\ncell:B14:t:BILL TO\\\\c:f:11:cf:2\\ncell:B15:t:[Name]:f:1:cf:2:colspan:6\\ncell:B16:t:[Company Name]:f:1:cf:2:colspan:6\\ncell:F16:t:  \\ncell:B17:t:[Street Address]:f:1:cf:2:colspan:6\\ncell:B18:t:[City, State,  Zip]:f:1:cf:2:colspan:6\\ncell:B19:t:Phone\\\\c :f:1:cf:2:colspan:6\\ncell:B20:t:Email\\\\c:f:1:cf:2:colspan:6\\ncell:A22:b::1::\\ncell:B22:t:DESCRIPTION:b:1:1:1:1:l:1:f:14:c:1:bg:3:cf:1:colspan:5:rowspan:1\\ncell:C22:t::l:2:f:13\\ncell:D22:t::l:2:f:13\\ncell:E22:t::l:2:f:13\\ncell:F22:t::l:2:f:13\\ncell:G22:t:AMOUNT:b:1:1:1::l:1:f:14:c:1:bg:3:cf:1\\ncell:A23:b::1::\\ncell:B23:b:1:1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C23:t::l:2:f:4\\ncell:D23:t::l:2:f:4\\ncell:E23:t::l:2:f:4\\ncell:F23:t::b::2:::l:1:f:4\\ncell:G23:b::1::1:f:4:ntvf:1\\ncell:A24:b::1::\\ncell:B24:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C24:t::l:2:f:4\\ncell:D24:t::l:2:f:4\\ncell:E24:t::l:2:f:4\\ncell:F24:t::b::2:::l:1:f:4\\ncell:G24:b::1::1:f:4:ntvf:1\\ncell:A25:b::1::\\ncell:B25:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C25:t::l:2:f:4\\ncell:D25:t::l:2:f:4\\ncell:E25:t::l:2:f:4\\ncell:F25:t::b::2:::l:1:f:4\\ncell:G25:b::1::1:f:4:ntvf:1\\ncell:A26:b::1::\\ncell:B26:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C26:t::l:2:f:4\\ncell:D26:t::l:2:f:4\\ncell:E26:t::l:2:f:4\\ncell:F26:t::b::2:::l:1:f:4\\ncell:G26:b::1::1:f:4:ntvf:1\\ncell:A27:b::1::\\ncell:B27:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C27:t::l:2:f:4\\ncell:D27:t::l:2:f:4\\ncell:E27:t::l:2:f:4\\ncell:F27:t::b::2:::l:1:f:4\\ncell:G27:b::1::1:f:4:ntvf:1\\ncell:A28:b::1::\\ncell:B28:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C28:t::l:2:f:4\\ncell:D28:t::l:2:f:4\\ncell:E28:t::l:2:f:4\\ncell:F28:t::b::2:::l:1:f:4\\ncell:G28:b::1::1:f:4:ntvf:1\\ncell:A29:b::1::\\ncell:B29:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C29:t::l:2:f:4\\ncell:D29:t::l:2:f:4\\ncell:E29:t::l:2:f:4\\ncell:F29:t::b::2:::l:1:f:4\\ncell:G29:b::1::1:f:4:ntvf:1\\ncell:A30:b::1::\\ncell:B30:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C30:t::l:2:f:4\\ncell:D30:t::l:2:f:4\\ncell:E30:t::l:2:f:4\\ncell:F30:t::b::2:::l:1:f:4\\ncell:G30:b::1::1:f:4:ntvf:1\\ncell:A31:b::1::\\ncell:B31:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C31:t::l:2:f:4\\ncell:D31:t::l:2:f:4\\ncell:E31:t::l:2:f:4\\ncell:F31:t::b::2:::l:1:f:4\\ncell:G31:b::1::1:f:4:ntvf:1\\ncell:A32:b::1::\\ncell:B32:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C32:t::l:2:f:4\\ncell:D32:t::l:2:f:4\\ncell:E32:t::l:2:f:4\\ncell:F32:t::b::2:::l:1:f:4\\ncell:G32:b::1::1:f:4:ntvf:1\\ncell:A33:b::1::\\ncell:B33:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C33:t::l:2:f:4\\ncell:D33:t::l:2:f:4\\ncell:E33:t::l:2:f:4\\ncell:F33:t::b::2:::l:1:f:4\\ncell:G33:b::1::1:f:4:ntvf:1\\ncell:A34:b::1::\\ncell:B34:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C34:l:2:f:4\\ncell:D34:l:2:f:4\\ncell:E34:l:2:f:4\\ncell:F34:b::2:::l:1:f:4\\ncell:G34:b::1::1:f:4:ntvf:1\\ncell:A35:b::1::\\ncell:B35:b::1:1:1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C35:t::b:::2::l:1:f:4\\ncell:D35:t::b:::2::l:1:f:4\\ncell:E35:t::b:::2::l:1:f:4\\ncell:F35:t::b::2:2::l:1:f:4\\ncell:G35:b::1:1:1:f:4:ntvf:1\\ncell:B36:b:2::::l:1:f:13\\ncell:C36:b:2::::l:1:f:13\\ncell:D36:b:2::::l:1:f:13\\ncell:E36:b:2::::l:1:f:14\\ncell:F36:t:Subtotal:b:2::::l:1:f:11\\ncell:G36:vtf:n:0:SUM(G23\\\\cG35):b:1::::f:11:ntvf:1\\ncell:B37:t:NOTES:b:::1::l:1:f:14:cf:2:colspan:3:rowspan:1\\ncell:C37:t::b:::2::l:1:f:13\\ncell:D37:t::b:::2::l:1:f:13\\ncell:F37:t:Tax Rate:l:1:f:11\\ncell:G37:v:0:f:1:ntvf:2\\ncell:B38:b:1::::f:1:cf:2:colspan:3\\ncell:C38:t::b:2::::l:1:f:13\\ncell:D38:t::b:2::::l:1:f:13\\ncell:F38:t:Tax:l:1:f:11\\ncell:G38:vtf:n:0:G37*G36:f:1:ntvf:1\\ncell:B39:f:1:cf:2:colspan:3\\ncell:C39:t::l:2:f:13\\ncell:D39:t::l:2:f:13\\ncell:F39:t:Other:b:::1::l:1:f:11\\ncell:G39:v:0:b:::1::f:1:ntvf:1\\ncell:B40:b:::1::f:1:cf:2:colspan:3:rowspan:1\\ncell:C40:t::l:2:f:13\\ncell:D40:t::l:2:f:13\\ncell:F40:t:TOTAL:b:1::::l:1:f:14\\ncell:G40:vtf:n:0:(G36+G38)+G39:b:1::::f:11:ntvf:1\\ncell:B43:t:Thank you for your business:l:1:f:5:cf:1:colspan:6:rowspan:1\\ncell:C43:t::l:2:f:13\\ncell:D43:t::l:2:f:13\\ncell:E43:t::l:2:f:13\\ncell:F43:t::l:2:f:13\\ncell:G43:t::l:2:f:13\\ncol:A:w:10\\ncol:B:w:90\\ncol:C:w:19\\ncol:D:w:10\\ncol:E:w:16\\ncol:F:w:45\\ncol:G:w:64\\nrow:1:h:34.5\\nrow:2:h:34.5\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:14.25\\nrow:6:h:14.25\\nrow:7:h:14.25\\nrow:8:h:14.25\\nrow:9:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:16:h:14.25\\nrow:17:h:14.25\\nrow:18:h:14.25\\nrow:19:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nrow:24:h:14.25\\nrow:25:h:14.25\\nrow:26:h:14.25\\nrow:27:h:14.25\\nrow:28:h:14.25\\nrow:29:h:14.25\\nrow:30:h:14.25\\nrow:31:h:14.25\\nrow:32:h:14.25\\nrow:33:h:14.25\\nrow:34:h:14.25\\nrow:35:h:14.25\\nrow:36:h:14.25\\nrow:37:h:14.25\\nrow:38:h:14.25\\nrow:39:h:14.25\\nrow:40:h:14.25\\nrow:43:h:15.75\\nsheet:c:7:r:43:h:12.75:needsrecalc:yes\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\ncellformat:3:right\\ncolor:1:rgb(0, 0, 0)\\ncolor:2:rgb(0,0,0)\\ncolor:3:rgb(221, 221, 221)\\nfont:1:* * Trebuchet MS\\nfont:2:* 10pt *\\nfont:3:* 10pt Trebuchet MS\\nfont:4:* 9pt Trebuchet MS\\nfont:5:italic bold 10pt Trebuchet MS\\nfont:6:italic normal * Trebuchet MS\\nfont:7:normal bold 10pt Trebuchet MS\\nfont:8:normal bold 14pt Trebuchet MS\\nfont:9:normal bold 16pt Trebuchet MS\\nfont:10:normal bold 28pt Trebuchet MS\\nfont:11:normal normal * Trebuchet MS\\nfont:12:normal normal 10pt *\\nfont:13:normal normal 10pt Arial\\nfont:14:normal normal 10pt Trebuchet MS\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nvalueformat:1:#,##0.00\\nvalueformat:2:#,##0.00%\\nvalueformat:3:m/d/yy\\nvalueformat:4:text-html\\n\" }, \"name\": \"inv2\", \"hidden\": \"0\" }, \"sheet3\": { \"sheetstr\": { \"savestr\": \"version:1.5\\ncell:B2:t:INVOICE:l:1:f:12:cf:1:colspan:6\\ncell:C2:t::l:2:f:10\\ncell:D2:t::l:2:f:10\\ncell:E2:l:1:f:8:c:2:cf:3\\ncell:F2:t:INVOICE:l:1:f:7:c:2:cf:2:colspan:2\\ncell:G2:t::l:2:f:10\\ncell:B3:f:5:cf:2:colspan:4\\ncell:C3:t::l:2:f:10\\ncell:D3:t::l:2:f:10\\ncell:F3:l:1:f:6:cf:2\\ncell:G3:l:1:f:11:cf:2:ntvf:3\\ncell:B4:f:2:colspan:2\\ncell:F4:t:DATE\\\\c:l:1:f:11:cf:2\\ncell:G4:vtf:nd:42081:TODAY():l:1:f:11:cf:2:ntvf:3\\ncell:B5:t:INVOICE #\\\\c:f:9:colspan:6\\ncell:C5:cf:2:colspan:5\\ncell:F5:l:1:f:6:cf:2:colspan:2\\ncell:G5:l:1:f:11:cf:2\\ncell:B6:f:2:colspan:2\\ncell:F6:l:1:f:6:cf:2:colspan:2\\ncell:G6:l:1:f:11:cf:2\\ncell:B7:t:FROM\\\\c:f:11\\ncell:F7:l:1:f:6:cf:2:colspan:2\\ncell:G7:l:1:f:11:cf:2\\ncell:B8:t:[Company Name]:f:9:colspan:4\\ncell:F8:l:1:f:6:cf:2:tvf:4:colspan:2:rowspan:5\\ncell:G8:l:1:f:11:cf:2\\ncell:B9:t:[Street Address]:f:9:cf:2:colspan:4\\ncell:F9:l:1:f:6\\ncell:G9:l:1:f:11:cf:1\\ncell:B10:t:[City, State,  Zip]:f:9:cf:2:colspan:4\\ncell:G10:l:1:f:10\\ncell:B11:t:Phone\\\\c :f:9:cf:2:colspan:4\\ncell:B12:t:Email\\\\c:f:9:cf:2:colspan:4\\ncell:B13:colspan:2\\ncell:B14:t:BILL TO\\\\c:f:9:cf:2\\ncell:B15:t:[Name]:f:9:cf:2:colspan:6\\ncell:B16:t:[Company Name]:f:9:cf:2:colspan:6\\ncell:F16:t:  \\ncell:B17:t:[Street Address]:f:9:cf:2:colspan:6\\ncell:B18:t:[City, State,  Zip]:f:9:cf:2:colspan:6\\ncell:B19:t:Phone\\\\c :f:9:cf:2:colspan:6\\ncell:B20:t:Email\\\\c:f:9:cf:2:colspan:6\\ncell:A22:b::1::\\ncell:B22:t:DESCRIPTION:b:1:1:1:1:l:1:f:11:c:1:bg:3:cf:1:colspan:5:rowspan:1\\ncell:C22:t::l:2:f:10\\ncell:D22:t::l:2:f:10\\ncell:E22:t::l:2:f:10\\ncell:F22:t::l:2:f:10\\ncell:G22:t:AMOUNT:b:1:1:1::l:1:f:11:c:1:bg:3:cf:1\\ncell:A23:b::1::\\ncell:B23:vtf:t: :IF(AND(ISBLANK(inv3!B6),ISBLANK(sheet7!B6)), \\\" \\\", IF(ISBLANK(inv3!B6), sheet7!B6, inv3!B6)):b:1:1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C23:t::l:2:f:3\\ncell:D23:t::l:2:f:3\\ncell:E23:t::l:2:f:3\\ncell:F23:t::b::2:::l:1:f:3\\ncell:G23:vtf:t: :IF(AND(ISBLANK(inv3!B6),ISBLANK(sheet7!B6)), \\\" \\\", IF(ISBLANK(inv3!B6), (sheet7!E6*sheet7!F6), (inv3!E6*inv3!F6))):b::1::1:f:3:ntvf:1\\ncell:A24:b::1::\\ncell:B24:vtf:t: :IF(AND(ISBLANK(INV3!B7),ISBLANK(SHEET7!B7)), \\\" \\\", IF(ISBLANK(INV3!B7), SHEET7!B7, INV3!B7)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C24:t::l:2:f:3\\ncell:D24:t::l:2:f:3\\ncell:E24:t::l:2:f:3\\ncell:F24:t::b::2:::l:1:f:3\\ncell:G24:vtf:t: :IF(AND(ISBLANK(INV3!B7),ISBLANK(SHEET7!B7)), \\\" \\\", IF(ISBLANK(INV3!B7), (SHEET7!E7*SHEET7!F7), (INV3!E7*INV3!F7))):b::1::1:f:3:ntvf:1\\ncell:A25:b::1::\\ncell:B25:vtf:t: :IF(AND(ISBLANK(INV3!B8),ISBLANK(SHEET7!B8)), \\\" \\\", IF(ISBLANK(INV3!B8), SHEET7!B8, INV3!B8)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C25:t::l:2:f:3\\ncell:D25:t::l:2:f:3\\ncell:E25:t::l:2:f:3\\ncell:F25:t::b::2:::l:1:f:3\\ncell:G25:vtf:t: :IF(AND(ISBLANK(INV3!B8),ISBLANK(SHEET7!B8)), \\\" \\\", IF(ISBLANK(INV3!B8), (SHEET7!E8*SHEET7!F8), (INV3!E8*INV3!F8))):b::1::1:f:3:ntvf:1\\ncell:A26:b::1::\\ncell:B26:vtf:t: :IF(AND(ISBLANK(INV3!B9),ISBLANK(SHEET7!B9)), \\\" \\\", IF(ISBLANK(INV3!B9), SHEET7!B9, INV3!B9)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C26:t::l:2:f:3\\ncell:D26:t::l:2:f:3\\ncell:E26:t::l:2:f:3\\ncell:F26:t::b::2:::l:1:f:3\\ncell:G26:vtf:t: :IF(AND(ISBLANK(INV3!B9),ISBLANK(SHEET7!B9)), \\\" \\\", IF(ISBLANK(INV3!B9), (SHEET7!E9*SHEET7!F9), (INV3!E9*INV3!F9))):b::1::1:f:3:ntvf:1\\ncell:A27:b::1::\\ncell:B27:vtf:t: :IF(AND(ISBLANK(INV3!B10),ISBLANK(SHEET7!B10)), \\\" \\\", IF(ISBLANK(INV3!B10), SHEET7!B10, INV3!B10)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C27:t::l:2:f:3\\ncell:D27:t::l:2:f:3\\ncell:E27:t::l:2:f:3\\ncell:F27:t::b::2:::l:1:f:3\\ncell:G27:vtf:t: :IF(AND(ISBLANK(INV3!B10),ISBLANK(SHEET7!B10)), \\\" \\\", IF(ISBLANK(INV3!B10), (SHEET7!E10*SHEET7!F10), (INV3!E10*INV3!F10))):b::1::1:f:3:ntvf:1\\ncell:A28:b::1::\\ncell:B28:vtf:t: :IF(AND(ISBLANK(INV3!B11),ISBLANK(SHEET7!B11)), \\\" \\\", IF(ISBLANK(INV3!B11), SHEET7!B11, INV3!B11)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C28:t::l:2:f:3\\ncell:D28:t::l:2:f:3\\ncell:E28:t::l:2:f:3\\ncell:F28:t::b::2:::l:1:f:3\\ncell:G28:vtf:t: :IF(AND(ISBLANK(INV3!B11),ISBLANK(SHEET7!B11)), \\\" \\\", IF(ISBLANK(INV3!B11), (SHEET7!E11*SHEET7!F11), (INV3!E11*INV3!F11))):b::1::1:f:3:ntvf:1\\ncell:A29:b::1::\\ncell:B29:vtf:t: :IF(AND(ISBLANK(INV3!B12),ISBLANK(SHEET7!B12)), \\\" \\\", IF(ISBLANK(INV3!B12), SHEET7!B12, INV3!B12)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C29:t::l:2:f:3\\ncell:D29:t::l:2:f:3\\ncell:E29:t::l:2:f:3\\ncell:F29:t::b::2:::l:1:f:3\\ncell:G29:vtf:t: :IF(AND(ISBLANK(INV3!B12),ISBLANK(SHEET7!B12)), \\\" \\\", IF(ISBLANK(INV3!B12), (SHEET7!E12*SHEET7!F12), (INV3!E12*INV3!F12))):b::1::1:f:3:ntvf:1\\ncell:A30:b::1::\\ncell:B30:vtf:t: :IF(AND(ISBLANK(INV3!B13),ISBLANK(SHEET7!B13)), \\\" \\\", IF(ISBLANK(INV3!B13), SHEET7!B13, INV3!B13)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C30:t::l:2:f:3\\ncell:D30:t::l:2:f:3\\ncell:E30:t::l:2:f:3\\ncell:F30:t::b::2:::l:1:f:3\\ncell:G30:vtf:t: :IF(AND(ISBLANK(INV3!B13),ISBLANK(SHEET7!B13)), \\\" \\\", IF(ISBLANK(INV3!B13), (SHEET7!E13*SHEET7!F13), (INV3!E13*INV3!F13))):b::1::1:f:3:ntvf:1\\ncell:A31:b::1::\\ncell:B31:vtf:t: :IF(AND(ISBLANK(INV3!B14),ISBLANK(SHEET7!B14)), \\\" \\\", IF(ISBLANK(INV3!B14), SHEET7!B14, INV3!B14)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C31:t::l:2:f:3\\ncell:D31:t::l:2:f:3\\ncell:E31:t::l:2:f:3\\ncell:F31:t::b::2:::l:1:f:3\\ncell:G31:vtf:t: :IF(AND(ISBLANK(INV3!B14),ISBLANK(SHEET7!B14)), \\\" \\\", IF(ISBLANK(INV3!B14), (SHEET7!E14*SHEET7!F14), (INV3!E14*INV3!F14))):b::1::1:f:3:ntvf:1\\ncell:A32:b::1::\\ncell:B32:vtf:t: :IF(AND(ISBLANK(INV3!B15),ISBLANK(SHEET7!B15)), \\\" \\\", IF(ISBLANK(INV3!B15), SHEET7!B15, INV3!B15)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C32:t::l:2:f:3\\ncell:D32:t::l:2:f:3\\ncell:E32:t::l:2:f:3\\ncell:F32:t::b::2:::l:1:f:3\\ncell:G32:vtf:t: :IF(AND(ISBLANK(INV3!B15),ISBLANK(SHEET7!B15)), \\\" \\\", IF(ISBLANK(INV3!B15), (SHEET7!E15*SHEET7!F15), (INV3!E15*INV3!F15))):b::1::1:f:3:ntvf:1\\ncell:A33:b::1::\\ncell:B33:vtf:t: :IF(AND(ISBLANK(INV3!B16),ISBLANK(SHEET7!B16)), \\\" \\\", IF(ISBLANK(INV3!B16), SHEET7!B16, INV3!B16)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C33:l:2:f:3\\ncell:D33:l:2:f:3\\ncell:E33:l:2:f:3\\ncell:F33:b::2:::l:1:f:3\\ncell:G33:vtf:t: :IF(AND(ISBLANK(INV3!B16),ISBLANK(SHEET7!B16)), \\\" \\\", IF(ISBLANK(INV3!B16), (SHEET7!E16*SHEET7!F16), (INV3!E16*INV3!F16))):b::1::1:f:3:ntvf:1\\ncell:A34:b::1::\\ncell:B34:vtf:t: :IF(AND(ISBLANK(INV3!B17),ISBLANK(SHEET7!B17)), \\\" \\\", IF(ISBLANK(INV3!B17), SHEET7!B17, INV3!B17)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C34:t::l:2:f:3\\ncell:D34:t::l:2:f:3\\ncell:E34:t::l:2:f:3\\ncell:F34:t::b::2:::l:1:f:3\\ncell:G34:vtf:t: :IF(AND(ISBLANK(INV3!B17),ISBLANK(SHEET7!B17)), \\\" \\\", IF(ISBLANK(INV3!B17), (SHEET7!E17*SHEET7!F17), (INV3!E17*INV3!F17))):b::1::1:f:3:ntvf:1\\ncell:A35:b::1::\\ncell:B35:vtf:t: :IF(AND(ISBLANK(INV3!B18),ISBLANK(SHEET7!B18)), \\\" \\\", IF(ISBLANK(INV3!B18), SHEET7!B18, INV3!B18)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C35:t::b:::2::l:1:f:3\\ncell:D35:t::b:::2::l:1:f:3\\ncell:E35:t::b:::2::l:1:f:3\\ncell:F35:t::b::2:2::l:1:f:3\\ncell:G35:vtf:t: :IF(AND(ISBLANK(INV3!B18),ISBLANK(SHEET7!B18)), \\\" \\\", IF(ISBLANK(INV3!B18), (SHEET7!E18*SHEET7!F18), (INV3!E18*INV3!F18))):b::1::1:f:3:ntvf:1\\ncell:B36:b:2::::l:1:f:10\\ncell:C36:b:2::::l:1:f:10\\ncell:D36:b:2::::l:1:f:10\\ncell:E36:b:2::::l:1:f:11\\ncell:F36:t:Subtotal:b:2::::l:1:f:9\\ncell:G36:vtf:n:0:SUM(G23\\\\cG35):b:1::::f:9:ntvf:1\\ncell:B37:t:NOTES:b:::1::l:1:f:11:cf:2:colspan:3:rowspan:1\\ncell:C37:t::b:::2::l:1:f:10\\ncell:D37:t::b:::2::l:1:f:10\\ncell:F37:t:Tax Rate:l:1:f:9\\ncell:G37:v:0:f:1:ntvf:2\\ncell:B38:b:1::::f:1:cf:2:colspan:3\\ncell:C38:t::b:2::::l:1:f:10\\ncell:D38:t::b:2::::l:1:f:10\\ncell:F38:t:Tax:l:1:f:9\\ncell:G38:vtf:n:0:G37*G36:f:1:ntvf:1\\ncell:B39:f:1:cf:2:colspan:3\\ncell:C39:t::l:2:f:10\\ncell:D39:t::l:2:f:10\\ncell:F39:t:Other:b:::1::l:1:f:9\\ncell:G39:v:0:b:::1::f:1:ntvf:1\\ncell:B40:b:::1::f:1:cf:2:colspan:3:rowspan:1\\ncell:C40:t::l:2:f:10\\ncell:D40:t::l:2:f:10\\ncell:F40:t:TOTAL:b:1::::l:1:f:11\\ncell:G40:vtf:n:0:(G36+G38)+G39:b:1::::f:9:ntvf:1\\ncell:B43:t:Thank you for your business:l:1:f:4:cf:1:colspan:6:rowspan:1\\ncell:C43:t::l:2:f:10\\ncell:D43:t::l:2:f:10\\ncell:E43:t::l:2:f:10\\ncell:F43:t::l:2:f:10\\ncell:G43:t::l:2:f:10\\ncol:A:w:10\\ncol:B:w:65\\ncol:C:w:19\\ncol:D:w:10\\ncol:E:w:16\\ncol:F:w:53\\ncol:G:w:64\\nrow:1:h:34.5\\nrow:2:h:34.5\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:14.25\\nrow:6:h:14.25\\nrow:7:h:14.25\\nrow:8:h:14.25\\nrow:9:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:16:h:14.25\\nrow:17:h:14.25\\nrow:18:h:14.25\\nrow:19:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nrow:24:h:14.25\\nrow:25:h:14.25\\nrow:26:h:14.25\\nrow:27:h:14.25\\nrow:28:h:14.25\\nrow:29:h:14.25\\nrow:30:h:14.25\\nrow:31:h:14.25\\nrow:32:h:14.25\\nrow:33:h:14.25\\nrow:34:h:14.25\\nrow:35:h:14.25\\nrow:36:h:14.25\\nrow:37:h:14.25\\nrow:38:h:14.25\\nrow:39:h:14.25\\nrow:40:h:14.25\\nrow:43:h:15.75\\nsheet:c:7:r:43:h:12.75:needsrecalc:yes\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\ncellformat:3:right\\ncolor:1:rgb(0, 0, 0)\\ncolor:2:rgb(0,0,0)\\ncolor:3:rgb(221, 221, 221)\\nfont:1:* * Trebuchet MS\\nfont:2:* 10pt *\\nfont:3:* 9pt Trebuchet MS\\nfont:4:italic bold 10pt Trebuchet MS\\nfont:5:italic normal * Trebuchet MS\\nfont:6:normal bold 10pt Trebuchet MS\\nfont:7:normal bold 14pt Trebuchet MS\\nfont:8:normal bold 28pt Trebuchet MS\\nfont:9:normal normal * Trebuchet MS\\nfont:10:normal normal 10pt Arial\\nfont:11:normal normal 10pt Trebuchet MS\\nfont:12:normal normal 16pt Trebuchet MS\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nvalueformat:1:#,##0.00\\nvalueformat:2:#,##0.00%\\nvalueformat:3:m/d/yy\\nvalueformat:4:text-html\\n\" }, \"name\": \"sheet6\", \"hidden\": \"0\" }, \"sheet4\": { \"sheetstr\": { \"savestr\": \"version:1.5\\ncell:B1:b:::2::l:1:f:7\\ncell:C1:b:::2::l:1:f:7\\ncell:D1:b:::2::l:1:f:7\\ncell:E1:b:::2::l:1:f:7\\ncell:F1:b:::2::l:1:f:7\\ncell:A2:b::2:::l:1:f:7\\ncell:B2:t:INVOICE DETAILS:b:1:1:1:1:l:1:f:8:cf:1:colspan:5\\ncell:C2:t::b:2::2::l:1:f:7\\ncell:D2:t::b:2::2::l:1:f:7\\ncell:E2:t::b:2::2::l:1:f:7\\ncell:F2:b:2:1:1::l:1:f:7\\ncell:G2:b::::1\\ncell:A3:b::2:::l:3:f:7\\ncell:B3:b:2::::l:1:f:7\\ncell:C3:b:2::::l:1:f:7\\ncell:D3:b:2::::l:1:f:7\\ncell:E3:b:2::::l:1:f:7\\ncell:F3:b:1:1:::l:1:f:7\\ncell:G3:b::::1\\ncell:A4:b::2:::l:3:f:7\\ncell:B4:b:::2::l:1:f:7\\ncell:C4:b:::2::l:3:f:4:cf:2\\ncell:D4:b:::2::l:1:f:7\\ncell:E4:b:::2::l:1:f:7\\ncell:F4:b::1:1::l:1:f:7\\ncell:G4:b::::1\\ncell:A5:b::2:::l:3:f:7\\ncell:B5:t:Description:b:1:1:1:1:f:6:cf:1:colspan:3\\ncell:C5:t:Description:b:2::2:2:l:3:f:4:cf:2:colspan:2:rowspan:1\\ncell:D5:t::b:2:2:2::l:1:f:7\\ncell:E5:t:Hours:b:1:1:1:1:f:6:cf:1\\ncell:F5:t:Rate:b:1:1:1:1:f:6:cf:1\\ncell:G5:b::::1\\ncell:A6:b::2:::l:3:f:7\\ncell:B6:b:1:1::1:f:1:cf:2:colspan:3\\ncell:C6:b:1:1::1:l:3:f:7:cf:2:colspan:2:rowspan:1\\ncell:D6:t::b:2:2:2::l:1:f:7\\ncell:E6:b:1:1:::f:1:ntvf:1\\ncell:F6:b:1:1:::f:1:ntvf:1\\ncell:G6:b::::1\\ncell:A7:b::2:::l:3:f:7\\ncell:B7:b::1::1:f:1:cf:2:colspan:3\\ncell:C7:b::1::1:l:1:f:7:colspan:2\\ncell:D7:l:1:f:7\\ncell:E7:b::1:::f:1:ntvf:1\\ncell:F7:b::1:::f:1:ntvf:1\\ncell:G7:b::::1\\ncell:A8:b::2:::l:3:f:7\\ncell:B8:b::1::1:f:1:cf:2:colspan:3\\ncell:C8:b::1::1:colspan:2\\ncell:E8:b::1:::f:1:ntvf:1\\ncell:F8:b::1:::f:1:ntvf:1\\ncell:G8:b::::1\\ncell:A9:b::2:::l:3:f:7\\ncell:B9:b::1::1:f:1:cf:2:colspan:3\\ncell:C9:b::1::1:colspan:2\\ncell:E9:b::1:::f:1:ntvf:1\\ncell:F9:b::1:::f:1:ntvf:1\\ncell:G9:b::::1\\ncell:A10:b::2:::l:3:f:7\\ncell:B10:b::1::1:f:1:cf:2:colspan:3\\ncell:C10:b::1::1:colspan:2\\ncell:E10:b::1:::f:1:ntvf:1\\ncell:F10:b::1:::f:1:ntvf:1\\ncell:G10:b::::1\\ncell:A11:b::2:::l:3:f:7\\ncell:B11:b::1::1:f:1:cf:2:colspan:3\\ncell:C11:b::1::1:colspan:2\\ncell:E11:b::1:::f:1:ntvf:1\\ncell:F11:b::1:::f:1:ntvf:1\\ncell:G11:b::::1\\ncell:A12:b::2:::l:3:f:7\\ncell:B12:b::1::1:f:1:cf:2:colspan:3\\ncell:C12:b::1::1:colspan:2\\ncell:E12:b::1:::f:1:ntvf:1\\ncell:F12:b::1:::f:1:ntvf:1\\ncell:G12:b::::1\\ncell:A13:b::2:::l:3:f:7\\ncell:B13:b::1::1:f:1:cf:2:colspan:3\\ncell:C13:b::1::1:colspan:2\\ncell:E13:b::1:::f:1:ntvf:1\\ncell:F13:b::1:::f:1:ntvf:1\\ncell:G13:b::::1\\ncell:A14:b::2:::l:3:f:7\\ncell:B14:b::1::1:f:1:cf:2:colspan:3\\ncell:C14:b::1::1:colspan:2\\ncell:E14:b::1:::f:1:ntvf:1\\ncell:F14:b::1:::f:1:ntvf:1\\ncell:G14:b::::1\\ncell:A15:b::2:::l:3:f:7\\ncell:B15:b::1::1:f:1:cf:2:colspan:3\\ncell:C15:b::1::1:colspan:2\\ncell:E15:b::1:::f:1:ntvf:1\\ncell:F15:b::1:::f:1:ntvf:1\\ncell:G15:b::::1\\ncell:A16:b::2:::l:3:f:7\\ncell:B16:b::1::1:f:1:cf:2:colspan:3\\ncell:C16:b::1::1:colspan:2\\ncell:E16:b::1:::f:1:ntvf:1\\ncell:F16:b::1:::f:1:ntvf:1\\ncell:G16:b::::1\\ncell:A17:b::2:::l:3:f:7\\ncell:B17:b::1::1:f:1:cf:2:colspan:3\\ncell:C17:b::1::1:colspan:2\\ncell:E17:b::1:::f:1:ntvf:1\\ncell:F17:b::1:::f:1:ntvf:1\\ncell:G17:b::::1\\ncell:A18:b::2:::l:3:f:5\\ncell:B18:b::1:1:1:f:1:cf:2:colspan:3\\ncell:C18:b::1:1:1:l:3:f:7:cf:2:colspan:2\\ncell:D18:b:::2::l:3:f:7:cf:2\\ncell:E18:b::1:1::f:1:ntvf:1\\ncell:F18:b::1:1::f:1:ntvf:1\\ncell:G18:b::::1\\ncell:A19:b::2:::l:3:f:7\\ncell:F19:b::1::\\ncell:G19:b::::1\\ncell:A20:b::2:::l:3:f:7\\ncell:F20:b::1::\\ncell:G20:b::::1\\ncell:A21:b::2:::l:3:f:7\\ncell:C21:t:Thank you for your business:b::1:::f:3:colspan:4\\ncell:D21:t:Thank you for your business:f:2:colspan:4\\ncell:E21:t::l:2:f:7\\ncell:F21:l:2:f:7\\ncell:G21:b::::1\\ncell:A22:b::2:::l:3:f:7\\ncell:F22:b::1::\\ncell:G22:b::::1\\ncell:A23:b::2:::l:3:f:7\\ncell:B23:b:::2::l:3:f:7\\ncell:C23:b:::2::l:3:f:7\\ncell:D23:b:::2::l:3:f:7\\ncell:E23:b:::2::l:3:f:7\\ncell:F23:b::1:1::l:3:f:7\\ncell:G23:b::::1\\ncell:B24:b:1:::\\ncell:C24:b:1:::\\ncell:D24:b:1:::\\ncell:E24:b:1:::\\ncell:F24:b:1:::\\ncol:A:w:10\\ncol:B:w:42\\ncol:C:w:56\\ncol:D:w:39\\ncol:E:w:48\\ncol:F:w:57\\nrow:1:h:14.25\\nrow:2:h:18.75\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:14.25\\nrow:6:h:14.25\\nrow:7:h:14.25\\nrow:8:h:14.25\\nrow:9:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:13:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:16:h:14.25\\nrow:17:h:14.25\\nrow:18:h:15.75\\nrow:19:h:14.25\\nrow:20:h:14.25\\nrow:21:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nsheet:c:7:r:24:h:12.75:needsrecalc:yes\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\nfont:1:* * Trebuchet MS\\nfont:2:italic bold * Trebuchet MS\\nfont:3:italic bold 10pt Trebuchet MS\\nfont:4:normal bold 10pt Arial\\nfont:5:normal bold 12pt Arial\\nfont:6:normal normal * Trebuchet MS\\nfont:7:normal normal 10pt Arial\\nfont:8:normal normal 16pt Arial\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nlayout:3:padding:* * * *;vertical-align:top;\\nvalueformat:1:#,##0.00\\n\" }, \"name\": \"inv3\", \"hidden\": \"0\" }, \"sheet5\": { \"sheetstr\": { \"savestr\": \"version:1.5\\ncell:B1:b:::2::l:1:f:7\\ncell:C1:b:::2::l:1:f:7\\ncell:D1:b:::2::l:1:f:7\\ncell:E1:b:::2::l:1:f:7\\ncell:F1:b:::2::l:1:f:7\\ncell:A2:b::2:::l:1:f:7\\ncell:B2:t:INVOICE DETAILS:b:1:1:1:1:l:1:f:8:cf:1:colspan:5\\ncell:C2:t::b:2::2::l:1:f:7\\ncell:D2:t::b:2::2::l:1:f:7\\ncell:E2:t::b:2::2::l:1:f:7\\ncell:F2:b:2:1:1::l:1:f:7\\ncell:G2:b::::1\\ncell:A3:b::2:::l:3:f:7\\ncell:B3:b:2::::l:1:f:7\\ncell:C3:b:2::::l:1:f:7\\ncell:D3:b:2::::l:1:f:7\\ncell:E3:b:2::::l:1:f:7\\ncell:F3:b:1:1:::l:1:f:7\\ncell:G3:b::::1\\ncell:A4:b::2:::l:3:f:7\\ncell:B4:b:::2::l:1:f:7\\ncell:C4:b:::2::l:3:f:4:cf:2\\ncell:D4:b:::2::l:1:f:7\\ncell:E4:b:::2::l:1:f:7\\ncell:F4:b::1:1::l:1:f:7\\ncell:G4:b::::1\\ncell:A5:b::2:::l:3:f:7\\ncell:B5:t:Description:b:1:1:1:1:f:6:cf:1:colspan:3\\ncell:C5:t:Description:b:2::2:2:l:3:f:4:cf:2:colspan:2:rowspan:1\\ncell:D5:t::b:2:2:2::l:1:f:7\\ncell:E5:t:Qty.:b:1:1:1:1:f:6:cf:1\\ncell:F5:t:Price:b:1:1:1:1:f:6:cf:1\\ncell:G5:b::::1\\ncell:A6:b::2:::l:3:f:7\\ncell:B6:b:1:1::1:f:1:cf:2:colspan:3\\ncell:C6:b:1:1::1:l:3:f:7:cf:2:colspan:2:rowspan:1\\ncell:D6:t::b:2:2:2::l:1:f:7\\ncell:E6:b:1:1:::f:1:ntvf:1\\ncell:F6:b:1:1:::f:1:ntvf:1\\ncell:G6:b::::1\\ncell:A7:b::2:::l:3:f:7\\ncell:B7:b::1::1:f:1:cf:2:colspan:3\\ncell:C7:b::1::1:l:1:f:7:colspan:2\\ncell:D7:l:1:f:7\\ncell:E7:b::1:::f:1:ntvf:1\\ncell:F7:b::1:::f:1:ntvf:1\\ncell:G7:b::::1\\ncell:A8:b::2:::l:3:f:7\\ncell:B8:b::1::1:f:1:cf:2:colspan:3\\ncell:C8:b::1::1:colspan:2\\ncell:E8:b::1:::f:1:ntvf:1\\ncell:F8:b::1:::f:1:ntvf:1\\ncell:G8:b::::1\\ncell:A9:b::2:::l:3:f:7\\ncell:B9:b::1::1:f:1:cf:2:colspan:3\\ncell:C9:b::1::1:colspan:2\\ncell:E9:b::1:::f:1:ntvf:1\\ncell:F9:b::1:::f:1:ntvf:1\\ncell:G9:b::::1\\ncell:A10:b::2:::l:3:f:7\\ncell:B10:b::1::1:f:1:cf:2:colspan:3\\ncell:C10:b::1::1:colspan:2\\ncell:E10:b::1:::f:1:ntvf:1\\ncell:F10:b::1:::f:1:ntvf:1\\ncell:G10:b::::1\\ncell:A11:b::2:::l:3:f:7\\ncell:B11:b::1::1:f:1:cf:2:colspan:3\\ncell:C11:b::1::1:colspan:2\\ncell:E11:b::1:::f:1:ntvf:1\\ncell:F11:b::1:::f:1:ntvf:1\\ncell:G11:b::::1\\ncell:A12:b::2:::l:3:f:7\\ncell:B12:b::1::1:f:1:cf:2:colspan:3\\ncell:C12:b::1::1:colspan:2\\ncell:E12:b::1:::f:1:ntvf:1\\ncell:F12:b::1:::f:1:ntvf:1\\ncell:G12:b::::1\\ncell:A13:b::2:::l:3:f:7\\ncell:B13:b::1::1:f:1:cf:2:colspan:3\\ncell:C13:b::1::1:colspan:2\\ncell:E13:b::1:::f:1:ntvf:1\\ncell:F13:b::1:::f:1:ntvf:1\\ncell:G13:b::::1\\ncell:A14:b::2:::l:3:f:7\\ncell:B14:b::1::1:f:1:cf:2:colspan:3\\ncell:C14:b::1::1:colspan:2\\ncell:E14:b::1:::f:1:ntvf:1\\ncell:F14:b::1:::f:1:ntvf:1\\ncell:G14:b::::1\\ncell:A15:b::2:::l:3:f:7\\ncell:B15:b::1::1:f:1:cf:2:colspan:3\\ncell:C15:b::1::1:colspan:2\\ncell:E15:b::1:::f:1:ntvf:1\\ncell:F15:b::1:::f:1:ntvf:1\\ncell:G15:b::::1\\ncell:A16:b::2:::l:3:f:7\\ncell:B16:b::1::1:f:1:cf:2:colspan:3\\ncell:C16:b::1::1:colspan:2\\ncell:E16:b::1:::f:1:ntvf:1\\ncell:F16:b::1:::f:1:ntvf:1\\ncell:G16:b::::1\\ncell:A17:b::2:::l:3:f:7\\ncell:B17:b::1::1:f:1:cf:2:colspan:3\\ncell:C17:b::1::1:colspan:2\\ncell:E17:b::1:::f:1:ntvf:1\\ncell:F17:b::1:::f:1:ntvf:1\\ncell:G17:b::::1\\ncell:A18:b::2:::l:3:f:5\\ncell:B18:b::1:1:1:f:1:cf:2:colspan:3\\ncell:C18:b::1:1:1:l:3:f:7:cf:2:colspan:2\\ncell:D18:b:::2::l:3:f:7:cf:2\\ncell:E18:b::1:1::f:1:ntvf:1\\ncell:F18:b::1:1::f:1:ntvf:1\\ncell:G18:b::::1\\ncell:A19:b::2:::l:3:f:7\\ncell:F19:b::1::\\ncell:G19:b::::1\\ncell:A20:b::2:::l:3:f:7\\ncell:F20:b::1::\\ncell:G20:b::::1\\ncell:A21:b::2:::l:3:f:7\\ncell:C21:t:Thank you for your business:b::1:::f:3:colspan:4\\ncell:D21:t:Thank you for your business:f:2:colspan:4\\ncell:E21:t::l:2:f:7\\ncell:F21:l:2:f:7\\ncell:G21:b::::1\\ncell:A22:b::2:::l:3:f:7\\ncell:F22:b::1::\\ncell:G22:b::::1\\ncell:A23:b::2:::l:3:f:7\\ncell:B23:b:::2::l:3:f:7\\ncell:C23:b:::2::l:3:f:7\\ncell:D23:b:::2::l:3:f:7\\ncell:E23:b:::2::l:3:f:7\\ncell:F23:b::1:1::l:3:f:7\\ncell:G23:b::::1\\ncell:B24:b:1:::\\ncell:C24:b:1:::\\ncell:D24:b:1:::\\ncell:E24:b:1:::\\ncell:F24:b:1:::\\ncol:A:w:10\\ncol:B:w:42\\ncol:C:w:56\\ncol:D:w:39\\ncol:E:w:48\\ncol:F:w:57\\nrow:1:h:14.25\\nrow:2:h:18.75\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:14.25\\nrow:6:h:14.25\\nrow:7:h:14.25\\nrow:8:h:14.25\\nrow:9:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:13:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:16:h:14.25\\nrow:17:h:14.25\\nrow:18:h:15.75\\nrow:19:h:14.25\\nrow:20:h:14.25\\nrow:21:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nsheet:c:7:r:24:h:12.75:needsrecalc:yes\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\nfont:1:* * Trebuchet MS\\nfont:2:italic bold * Trebuchet MS\\nfont:3:italic bold 10pt Trebuchet MS\\nfont:4:normal bold 10pt Arial\\nfont:5:normal bold 12pt Arial\\nfont:6:normal normal * Trebuchet MS\\nfont:7:normal normal 10pt Arial\\nfont:8:normal normal 16pt Arial\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nlayout:3:padding:* * * *;vertical-align:top;\\nvalueformat:1:#,##0.00\\n\" }, \"name\": \"sheet7\", \"hidden\": \"0\" } }, \"EditableCells\": { \"allow\": true, \"cells\": { \"inv1!B2\": true, \"inv1!C5\": true, \"inv1!C6\": true, \"inv1!C7\": true, \"inv1!C8\": true, \"inv1!C9\": true, \"inv1!C11\": true, \"inv1!C12\": true, \"inv1!C13\": true, \"inv1!C14\": true, \"inv1!C15\": true, \"inv1!C16\": true, \"inv1!C18\": true, \"inv1!C20\": true, \"inv1!D20\": true, \"inv1!C23\": true, \"inv1!C24\": true, \"inv1!C25\": true, \"inv1!C26\": true, \"inv1!C27\": true, \"inv1!C28\": true, \"inv1!C29\": true, \"inv1!C30\": true, \"inv1!C31\": true, \"inv1!C32\": true, \"inv1!C33\": true, \"inv1!C34\": true, \"inv1!C35\": true, \"inv1!F23\": true, \"inv1!F24\": true, \"inv1!F25\": true, \"inv1!F26\": true, \"inv1!F27\": true, \"inv1!F28\": true, \"inv1!F29\": true, \"inv1!F30\": true, \"inv1!F31\": true, \"inv1!F32\": true, \"inv1!F33\": true, \"inv1!F34\": true, \"inv1!F35\": true, \"inv2!B2\": true, \"inv2!F4\": true, \"inv2!G4\": true, \"inv2!B5\": true, \"inv2!B7\": true, \"inv2!B8\": true, \"inv2!B9\": true, \"inv2!B10\": true, \"inv2!B11\": true, \"inv2!B12\": true, \"inv2!B14\": true, \"inv2!B15\": true, \"inv2!B16\": true, \"inv2!B17\": true, \"inv2!B18\": true, \"inv2!B19\": true, \"inv2!B20\": true, \"inv2!B23\": true, \"inv2!B24\": true, \"inv2!B25\": true, \"inv2!B26\": true, \"inv2!B27\": true, \"inv2!B28\": true, \"inv2!B29\": true, \"inv2!B30\": true, \"inv2!B31\": true, \"inv2!B32\": true, \"inv2!B33\": true, \"inv2!B34\": true, \"inv2!B35\": true, \"inv2!G23\": true, \"inv2!G24\": true, \"inv2!G25\": true, \"inv2!G26\": true, \"inv2!G27\": true, \"inv2!G28\": true, \"inv2!G29\": true, \"inv2!G30\": true, \"inv2!G31\": true, \"inv2!G32\": true, \"inv2!G33\": true, \"inv2!G34\": true, \"inv2!G35\": true, \"inv2!B38\": true, \"inv2!B39\": true, \"inv2!B40\": true, \"inv2!F36\": true, \"inv2!G37\": true, \"inv2!F37\": true, \"inv2!F39\": true, \"inv2!G39\": true, \"inv2!F38\": true, \"sheet6!B2\": true, \"sheet6!F4\": true, \"sheet6!G4\": true, \"sheet6!B5\": true, \"sheet6!B7\": true, \"sheet6!B8\": true, \"sheet6!B9\": true, \"sheet6!B10\": true, \"sheet6!B11\": true, \"sheet6!B12\": true, \"sheet6!B14\": true, \"sheet6!B15\": true, \"sheet6!B16\": true, \"sheet6!B17\": true, \"sheet6!B18\": true, \"sheet6!B19\": true, \"sheet6!B20\": true, \"sheet6!B38\": true, \"sheet6!B39\": true, \"sheet6!B40\": true, \"sheet6!F36\": true, \"sheet6!G37\": true, \"sheet6!F37\": true, \"sheet6!F39\": true, \"sheet6!G39\": true, \"sheet6!F38\": true, \"inv3!B2\": true, \"inv3!B6\": true, \"inv3!B7\": true, \"inv3!B8\": true, \"inv3!B9\": true, \"inv3!B10\": true, \"inv3!B11\": true, \"inv3!B12\": true, \"inv3!B13\": true, \"inv3!B14\": true, \"inv3!B15\": true, \"inv3!B16\": true, \"inv3!B17\": true, \"inv3!B18\": true, \"inv3!E6\": true, \"inv3!E7\": true, \"inv3!E8\": true, \"inv3!E9\": true, \"inv3!E10\": true, \"inv3!E11\": true, \"inv3!E12\": true, \"inv3!E13\": true, \"inv3!E14\": true, \"inv3!E15\": true, \"inv3!E16\": true, \"inv3!E17\": true, \"inv3!E18\": true, \"inv3!F6\": true, \"inv3!F7\": true, \"inv3!F8\": true, \"inv3!F9\": true, \"inv3!F10\": true, \"inv3!F11\": true, \"inv3!F12\": true, \"inv3!F13\": true, \"inv3!F14\": true, \"inv3!F15\": true, \"inv3!F16\": true, \"inv3!F17\": true, \"inv3!F18\": true, \"sheet7!F6\": true, \"sheet7!F7\": true, \"sheet7!F8\": true, \"sheet7!F9\": true, \"sheet7!F10\": true, \"sheet7!F11\": true, \"sheet7!F12\": true, \"sheet7!F13\": true, \"sheet7!F14\": true, \"sheet7!F15\": true, \"sheet7!F16\": true, \"sheet7!F17\": true, \"sheet7!F18\": true, \"sheet7!E6\": true, \"sheet7!E7\": true, \"sheet7!E8\": true, \"sheet7!E9\": true, \"sheet7!E10\": true, \"sheet7!E11\": true, \"sheet7!E12\": true, \"sheet7!E13\": true, \"sheet7!E14\": true, \"sheet7!E15\": true, \"sheet7!E16\": true, \"sheet7!E17\": true, \"sheet7!E18\": true, \"sheet7!B6\": true, \"sheet7!B2\": true, \"sheet7!B7\": true, \"sheet7!B8\": true, \"sheet7!B9\": true, \"sheet7!B10\": true, \"sheet7!B11\": true, \"sheet7!B12\": true, \"sheet7!B13\": true, \"sheet7!B14\": true, \"sheet7!B15\": true, \"sheet7!B16\": true, \"sheet7!B17\": true, \"sheet7!B18\": true, \"inv1!D8\": true, \"inv1!D15\": true, \"inv1!D18\": true, \"inv2!C5\": true, \"sheet6!C5\": true }, \"constraints\": { \"inv1!C5\": [\"prompttext\", \"0\", \"1e10\", \"Name\"], \"inv1!C6\": [\"prompttext\", \"0\", \"1e10\", \"Street Address\"], \"inv1!C7\": [\"prompttext\", \"0\", \"1e10\", \"City, State, Zip\"], \"inv1!C8\": [\"prompttext\", \"0\", \"1e10\", \"Phone\"], \"inv1!C9\": [\"promptemail\", \"0\", \"1e10\", \"Email\"], \"inv1!C11\": [\"prompttext\", \"0\", \"1e10\", \"From\"], \"inv1!C12\": [\"prompttext\", \"0\", \"1e10\", \"Name\"], \"inv1!C13\": [\"prompttext\", \"0\", \"1e10\", \"Street Address\"], \"inv1!C14\": [\"prompttext\", \"0\", \"1e10\", \"City, State, Zip\"], \"inv1!C15\": [\"prompttext\", \"0\", \"1e10\", \"Phone\"], \"inv1!C16\": [\"promptemail\", \"0\", \"1e10\", \"Email\"], \"inv1!C18\": [\"prompttext\", \"0\", \"1e10\", \"Invoice #\"], \"inv1!C20\": [\"prompttext\", \"0\", \"1e10\", \"Date\"], \"inv1!D20\": [\"prompttext\", \"0\", \"1e10\", \"Date\"], \"inv1!C23\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv1!C24\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv1!C25\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv1!C26\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv1!C27\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv1!C28\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv1!C29\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv1!C30\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv1!C31\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv1!C32\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv1!C33\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv1!C34\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv1!C35\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv1!F23\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv1!F24\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv1!F25\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv1!F26\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv1!F27\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv1!F28\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv1!F29\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv1!F30\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv1!F31\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv1!F32\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv1!F33\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv1!F34\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv1!F35\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv2!B2\": [\"prompttext\", \"0\", \"1e10\", \"Invoice\"], \"inv2!F4\": [\"prompttext\", \"0\", \"1e10\", \"Date\"], \"inv2!G4\": [\"prompttext\", \"0\", \"1e10\", \"Date\"], \"inv2!B5\": [\"prompttext\", \"0\", \"1e10\", \"Invoice #\"], \"inv2!B7\": [\"prompttext\", \"0\", \"1e10\", \"From\"], \"inv2!B8\": [\"prompttext\", \"0\", \"1e10\", \"Company Name\"], \"inv2!B9\": [\"prompttext\", \"0\", \"1e10\", \"Street Address\"], \"inv2!B10\": [\"prompttext\", \"0\", \"1e10\", \"City, State, Zip\"], \"inv2!B11\": [\"prompttext\", \"0\", \"1e10\", \"Phone\"], \"inv2!B12\": [\"promptemail\", \"0\", \"1e10\", \"Email\"], \"inv2!B14\": [\"prompttext\", \"0\", \"1e10\", \"Bill To\"], \"inv2!B15\": [\"prompttext\", \"0\", \"1e10\", \"Name\"], \"inv2!B16\": [\"prompttext\", \"0\", \"1e10\", \"Company Name\"], \"inv2!B17\": [\"prompttext\", \"0\", \"1e10\", \"Street Address\"], \"inv2!B18\": [\"prompttext\", \"0\", \"1e10\", \"City, State, Zip\"], \"inv2!B19\": [\"prompttext\", \"0\", \"1e10\", \"Phone\"], \"inv2!B20\": [\"promptemail\", \"0\", \"1e10\", \"Email\"], \"inv2!B23\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv2!B24\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv2!B25\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv2!B26\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv2!B27\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv2!B28\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv2!B29\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv2!B30\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv2!B31\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv2!B32\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv2!B33\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv2!B34\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv2!B35\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv2!G23\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv2!G24\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv2!G25\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv2!G26\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv2!G27\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv2!G28\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv2!G29\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv2!G30\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv2!G31\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv2!G32\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv2!G33\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv2!G34\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv2!G35\": [\"promptdecimal\", \"0\", \"1e10\", \"Amount\"], \"inv2!B38\": [\"prompttext\", \"0\", \"1e10\", \"Notes\"], \"inv2!B39\": [\"prompttext\", \"0\", \"1e10\", \"Notes\"], \"inv2!B40\": [\"prompttext\", \"0\", \"1e10\", \"Notes\"], \"inv2!F36\": [\"prompttext\", \"0\", \"1e10\", \"Subtotal\"], \"inv2!G37\": [\"promptdecimal\", \"0\", \"1e10\", \"Tax Rate (0.00)\"], \"inv2!F37\": [\"prompttext\", \"0\", \"1e10\", \"Tax Rate\"], \"inv2!F39\": [\"prompttext\", \"0\", \"1e10\", \"Other\"], \"inv2!G39\": [\"promptdecimal\", \"0\", \"1e10\", \"Other\"], \"inv2!F38\": [\"prompttext\", \"0\", \"1e10\", \"Tax\"], \"sheet6!B2\": [\"prompttext\", \"0\", \"1e10\", \"Invoice\"], \"sheet6!F4\": [\"prompttext\", \"0\", \"1e10\", \"Date\"], \"sheet6!G4\": [\"prompttext\", \"0\", \"1e10\", \"Date\"], \"sheet6!B5\": [\"prompttext\", \"0\", \"1e10\", \"Invoice #\"], \"sheet6!B7\": [\"prompttext\", \"0\", \"1e10\", \"From\"], \"sheet6!B8\": [\"prompttext\", \"0\", \"1e10\", \"Company Name\"], \"sheet6!B9\": [\"prompttext\", \"0\", \"1e10\", \"Street Address\"], \"sheet6!B10\": [\"prompttext\", \"0\", \"1e10\", \"City, State, Zip\"], \"sheet6!B11\": [\"prompttext\", \"0\", \"1e10\", \"Phone\"], \"sheet6!B12\": [\"promptemail\", \"0\", \"1e10\", \"Email\"], \"sheet6!B14\": [\"prompttext\", \"0\", \"1e10\", \"Bill To\"], \"sheet6!B15\": [\"prompttext\", \"0\", \"1e10\", \"Name\"], \"sheet6!B16\": [\"prompttext\", \"0\", \"1e10\", \"Company Name\"], \"sheet6!B17\": [\"prompttext\", \"0\", \"1e10\", \"Street Address\"], \"sheet6!B18\": [\"prompttext\", \"0\", \"1e10\", \"City, State, Zip\"], \"sheet6!B19\": [\"prompttext\", \"0\", \"1e10\", \"Phone\"], \"sheet6!B20\": [\"promptemail\", \"0\", \"1e10\", \"Email\"], \"sheet6!B38\": [\"prompttext\", \"0\", \"1e10\", \"Notes\"], \"sheet6!B39\": [\"prompttext\", \"0\", \"1e10\", \"Notes\"], \"sheet6!B40\": [\"prompttext\", \"0\", \"1e10\", \"Notes\"], \"sheet6!F36\": [\"prompttext\", \"0\", \"1e10\", \"Subtotal\"], \"sheet6!G37\": [\"promptdecimal\", \"0\", \"1e10\", \"Tax Rate (0.00)\"], \"sheet6!F37\": [\"prompttext\", \"0\", \"1e10\", \"Tax Rate\"], \"sheet6!F39\": [\"prompttext\", \"0\", \"1e10\", \"Other\"], \"sheet6!G39\": [\"promptdecimal\", \"0\", \"1e10\", \"Other\"], \"sheet6!F38\": [\"prompttext\", \"0\", \"1e10\", \"Tax\"], \"inv3!B6\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv3!B7\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv3!B8\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv3!B9\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv3!B10\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv3!B11\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv3!B12\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv3!B13\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv3!B14\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv3!B15\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv3!B16\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv3!B17\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv3!B18\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"sheet7!B6\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"sheet7!B7\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"sheet7!B8\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"sheet7!B9\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"sheet7!B10\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"sheet7!B11\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"sheet7!B12\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"sheet7!B13\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"sheet7!B14\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"sheet7!B15\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"sheet7!B16\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"sheet7!B17\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"sheet7!B18\": [\"prompttext\", \"0\", \"1e10\", \"Description\"], \"inv1!D8\": [\"prompttext\", \"0\", \"1e10\", \"Phone\"], \"inv1!D15\": [\"prompttext\", \"0\", \"1e10\", \"Phone\"], \"inv1!D18\": [\"promptnumeric\", \"0\", \"1e10\", \"Invoice#\"], \"inv2!C5\": [\"promptnumeric\", \"0\", \"1e10\", \"Invoice#\"], \"sheet6!C5\": [\"promptnumeric\", \"0\", \"1e10\", \"Invoice#\"], \"sheet7!E6\": [\"promptdecimal\", \"0\", \"1e10\", \"Quantity\"], \"sheet7!E7\": [\"promptdecimal\", \"0\", \"1e10\", \"Quantity\"], \"sheet7!E8\": [\"promptdecimal\", \"0\", \"1e10\", \"Quantity\"], \"sheet7!E9\": [\"promptdecimal\", \"0\", \"1e10\", \"Quantity\"], \"sheet7!E10\": [\"promptdecimal\", \"0\", \"1e10\", \"Quantity\"], \"sheet7!E11\": [\"promptdecimal\", \"0\", \"1e10\", \"Quantity\"], \"sheet7!E12\": [\"promptdecimal\", \"0\", \"1e10\", \"Quantity\"], \"sheet7!E13\": [\"promptdecimal\", \"0\", \"1e10\", \"Quantity\"], \"sheet7!E14\": [\"promptdecimal\", \"0\", \"1e10\", \"Quantity\"], \"sheet7!E15\": [\"promptdecimal\", \"0\", \"1e10\", \"Quantity\"], \"sheet7!E16\": [\"promptdecimal\", \"0\", \"1e10\", \"Quantity\"], \"sheet7!E17\": [\"promptdecimal\", \"0\", \"1e10\", \"Quantity\"], \"sheet7!E18\": [\"promptdecimal\", \"0\", \"1e10\", \"Quantity\"], \"sheet7!F6\": [\"promptdecimal\", \"0\", \"1e10\", \"Price\"], \"sheet7!F7\": [\"promptdecimal\", \"0\", \"1e10\", \"Price\"], \"sheet7!F8\": [\"promptdecimal\", \"0\", \"1e10\", \"Price\"], \"sheet7!F9\": [\"promptdecimal\", \"0\", \"1e10\", \"Price\"], \"sheet7!F10\": [\"promptdecimal\", \"0\", \"1e10\", \"Price\"], \"sheet7!F11\": [\"promptdecimal\", \"0\", \"1e10\", \"Price\"], \"sheet7!F12\": [\"promptdecimal\", \"0\", \"1e10\", \"Price\"], \"sheet7!F13\": [\"promptdecimal\", \"0\", \"1e10\", \"Price\"], \"sheet7!F14\": [\"promptdecimal\", \"0\", \"1e10\", \"Price\"], \"sheet7!F15\": [\"promptdecimal\", \"0\", \"1e10\", \"Price\"], \"sheet7!F16\": [\"promptdecimal\", \"0\", \"1e10\", \"Price\"], \"sheet7!F17\": [\"promptdecimal\", \"0\", \"1e10\", \"Price\"], \"sheet7!F18\": [\"promptdecimal\", \"0\", \"1e10\", \"Price\"], \"inv3!E6\": [\"promptdecimal\", \"0\", \"1e10\", \"Hours\"], \"inv3!E7\": [\"promptdecimal\", \"0\", \"1e10\", \"Hours\"], \"inv3!E8\": [\"promptdecimal\", \"0\", \"1e10\", \"Hours\"], \"inv3!E9\": [\"promptdecimal\", \"0\", \"1e10\", \"Hours\"], \"inv3!E10\": [\"promptdecimal\", \"0\", \"1e10\", \"Hours\"], \"inv3!E11\": [\"promptdecimal\", \"0\", \"1e10\", \"Hours\"], \"inv3!E12\": [\"promptdecimal\", \"0\", \"1e10\", \"Hours\"], \"inv3!E13\": [\"promptdecimal\", \"0\", \"1e10\", \"Hours\"], \"inv3!E14\": [\"promptdecimal\", \"0\", \"1e10\", \"Hours\"], \"inv3!E15\": [\"promptdecimal\", \"0\", \"1e10\", \"Hours\"], \"inv3!E16\": [\"promptdecimal\", \"0\", \"1e10\", \"Hours\"], \"inv3!E17\": [\"promptdecimal\", \"0\", \"1e10\", \"Hours\"], \"inv3!E18\": [\"promptdecimal\", \"0\", \"1e10\", \"Hours\"], \"inv3!F6\": [\"promptdecimal\", \"0\", \"1e10\", \"Rate\"], \"inv3!F7\": [\"promptdecimal\", \"0\", \"1e10\", \"Rate\"], \"inv3!F8\": [\"promptdecimal\", \"0\", \"1e10\", \"Rate\"], \"inv3!F9\": [\"promptdecimal\", \"0\", \"1e10\", \"Rate\"], \"inv3!F10\": [\"promptdecimal\", \"0\", \"1e10\", \"Rate\"], \"inv3!F11\": [\"promptdecimal\", \"0\", \"1e10\", \"Rate\"], \"inv3!F12\": [\"promptdecimal\", \"0\", \"1e10\", \"Rate\"], \"inv3!F13\": [\"promptdecimal\", \"0\", \"1e10\", \"Rate\"], \"inv3!F14\": [\"promptdecimal\", \"0\", \"1e10\", \"Rate\"], \"inv3!F15\": [\"promptdecimal\", \"0\", \"1e10\", \"Rate\"], \"inv3!F16\": [\"promptdecimal\", \"0\", \"1e10\", \"Rate\"], \"inv3!F17\": [\"promptdecimal\", \"0\", \"1e10\", \"Rate\"], \"inv3!F18\": [\"promptdecimal\", \"0\", \"1e10\", \"Rate\"] } } },\n\t                                                \"footers\": [{ name: 'Type1', index: 1, isActive: true }, { name: 'Type2', index: 2, isActive: false }, { name: 'Type3', index: 3, isActive: false }, { name: 'Detail1', index: 4, isActive: false }, { name: 'Detail2', index: 5, isActive: false }]\n\t                                }\n\t                }\n\t};\n\n/***/ },\n/* 3 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\texports.getDeviceType = getDeviceType;\n\texports.initializeApp = initializeApp;\n\texports.activateFooterButton = activateFooterButton;\n\texports.viewFile = viewFile;\n\texports.getCSVContent = getCSVContent;\n\texports.mustshowprompt = mustshowprompt;\n\texports.getinputtype = getinputtype;\n\texports.prompttype = prompttype;\n\texports.showprompt = showprompt;\n\texports.getSpreadsheetContent = getSpreadsheetContent;\n\texports.getCurrentHTMLContent = getCurrentHTMLContent;\n\texports.getAllHTMLContent = getAllHTMLContent;\n\texports.saveAs = saveAs;\n\texports.getAllOldFiles = getAllOldFiles;\n\texports.deleteAllOldFiles = deleteAllOldFiles;\n\texports.addLogo = addLogo;\n\texports.removeLogo = removeLogo;\n\texports.undo = undo;\n\texports.redo = redo;\n\texports.getCurrentSheet = getCurrentSheet;\n\texports.changeSheetColor = changeSheetColor;\n\texports.changeFontSheet = changeFontSheet;\n\texports.executeCommand = executeCommand;\n\tvar SocialCalc = __webpack_require__(13);\n\t\n\tfunction getDeviceType() {\n\t    /* Returns the type of the device */\n\t    var device = \"default\";\n\t    if (navigator.userAgent.match(/iPod/)) device = \"iPod\";\n\t    if (navigator.userAgent.match(/iPad/)) device = \"iPad\";\n\t    if (navigator.userAgent.match(/iPhone/)) device = \"iPhone\";\n\t    console.log(\"Device is: \" + device);\n\t    return device;\n\t}\n\t\n\tfunction initializeApp(data) {\n\t    /* Initializes the spreadsheet */\n\t\n\t    var tableeditor = document.getElementById(\"tableeditor\");\n\t    var spreadsheet = new SocialCalc.SpreadsheetControl();\n\t    var workbook = new SocialCalc.WorkBook(spreadsheet);\n\t    workbook.InitializeWorkBook(\"sheet1\");\n\t\n\t    spreadsheet.InitializeSpreadsheetControl(tableeditor, 0, 0, 0);\n\t    spreadsheet.ExecuteCommand('redisplay', '');\n\t\n\t    var workbookcontrol = new SocialCalc.WorkBookControl(workbook, \"workbookControl\", \"sheet1\");\n\t    workbookcontrol.InitializeWorkBookControl();\n\t    // alert(\"app: \"+JSON.stringify(data));\n\t    SocialCalc.WorkBookControlLoad(data);\n\t    var ele = document.getElementById('te_griddiv');\n\t    ele.style.height = \"1600px\";\n\t    spreadsheet.DoOnResize();\n\t}\n\t\n\tfunction activateFooterButton(index) {\n\t    /* Activates the sheet according to the index*/\n\t    if (index === SocialCalc.oldBtnActive) return;\n\t    var control = SocialCalc.GetCurrentWorkBookControl();\n\t\n\t    var sheets = [];\n\t    for (var key in control.sheetButtonArr) {\n\t        //console.log(key);\n\t        sheets.push(key);\n\t    }\n\t    var spreadsheet = control.workbook.spreadsheet;\n\t    var ele = document.getElementById(spreadsheet.formulabarDiv.id);\n\t    if (ele) {\n\t        SocialCalc.ToggleInputLineButtons(false);\n\t        var input = ele.firstChild;\n\t        input.style.display = \"none\";\n\t        spreadsheet.editor.state = \"start\";\n\t    }\n\t    SocialCalc.WorkBookControlActivateSheet(sheets[index - 1]);\n\t\n\t    SocialCalc.oldBtnActive = index;\n\t}\n\t\n\tfunction viewFile(filename, data) {\n\t\n\t    SocialCalc.WorkBookControlInsertWorkbook(data);\n\t\n\t    SocialCalc.GetCurrentWorkBookControl().workbook.spreadsheet.editor.state = \"start\";\n\t\n\t    SocialCalc.GetCurrentWorkBookControl().workbook.spreadsheet.ExecuteCommand('redisplay', '');\n\t\n\t    window.setTimeout(function () {\n\t        SocialCalc.ScrollRelativeBoth(SocialCalc.GetCurrentWorkBookControl().workbook.spreadsheet.editor, 1, 0);\n\t        SocialCalc.ScrollRelativeBoth(SocialCalc.GetCurrentWorkBookControl().workbook.spreadsheet.editor, -1, 0);\n\t    }, 1000);\n\t}\n\t\n\tfunction getCSVContent() {\n\t    var val = SocialCalc.WorkBookControlSaveSheet();\n\t    var workBookObject = JSON.parse(val);\n\t    var control = SocialCalc.GetCurrentWorkBookControl();\n\t    var currentname = control.currentSheetButton.id;\n\t    var savestrr = workBookObject.sheetArr[currentname].sheetstr.savestr;\n\t    var res = SocialCalc.ConvertSaveToOtherFormat(savestrr, \"csv\", false);\n\t    return res;\n\t}\n\t\n\tfunction mustshowprompt(coord) {\n\t    var control = SocialCalc.GetCurrentWorkBookControl();\n\t    var editor = control.workbook.spreadsheet.editor;\n\t    var cellname = editor.workingvalues.currentsheet + \"!\" + editor.ecell.coord;\n\t    var constraint = SocialCalc.EditableCells.constraints[cellname];\n\t    if (constraint) {}\n\t    // for phone apps always show prompt\n\t    return true;\n\t}\n\t\n\tfunction getinputtype(coord) {\n\t    var control = SocialCalc.GetCurrentWorkBookControl();\n\t    var editor = control.workbook.spreadsheet.editor;\n\t    var cellname = editor.workingvalues.currentsheet + \"!\" + editor.ecell.coord;\n\t    var constraint = SocialCalc.EditableCells.constraints[cellname];\n\t    if (constraint) {}\n\t    return null;\n\t}\n\t\n\tfunction prompttype(coord) {\n\t    var control = SocialCalc.GetCurrentWorkBookControl();\n\t    var editor = control.workbook.spreadsheet.editor;\n\t    var cellname = editor.workingvalues.currentsheet + \"!\" + editor.ecell.coord;\n\t    var constraint = SocialCalc.EditableCells.constraints[cellname];\n\t\n\t    if (constraint) {}\n\t    return null;\n\t}\n\t\n\tfunction showprompt(coord) {\n\t\n\t    var control = SocialCalc.GetCurrentWorkBookControl();\n\t    var editor = control.workbook.spreadsheet.editor;\n\t    var cellname = editor.workingvalues.currentsheet + \"!\" + editor.ecell.coord;\n\t    var constraint = SocialCalc.EditableCells.constraints[cellname];\n\t    var highlights = editor.context.highlights;\n\t\n\t    //alert(constraint);\n\t    var wval = editor.workingvalues;\n\t    if (wval.eccord) {\n\t        wval.ecoord = null;\n\t        console.log(\"return due to ecoord\");\n\t        return;\n\t    }\n\t    wval.ecoord = coord;\n\t    if (!coord) coord = editor.ecell.coord;\n\t    var text = SocialCalc.GetCellContents(editor.context.sheetobj, coord);\n\t    console.log(\"in prompt, coord = \" + coord + \" text=\" + text);\n\t\n\t    if (SocialCalc.Constants.SCNoQuoteInInputBox && text.substring(0, 1) === \"'\") {\n\t        text = text.substring(1);\n\t    }\n\t    console.log(\"continue...\");\n\t\n\t    var cell = SocialCalc.GetEditorCellElement(editor, editor.ecell.row, editor.ecell.col);\n\t    //alert(cell);\n\t\n\t    /*var cancelfn = function() {\n\t        wval.ecoord = null;\n\t        delete highlights[editor.ecell.coord];\n\t        editor.UpdateCellCSS(cell, editor.ecell.row, editor.ecell.col);\n\t        \n\t    };*/\n\t\n\t    var okfn = function okfn(val) {\n\t        var callbackfn = function callbackfn() {\n\t            console.log(\"callback val \" + val);\n\t            SocialCalc.EditorSaveEdit(editor, val);\n\t        };\n\t        window.setTimeout(callbackfn, 100);\n\t    };\n\t\n\t    // highlight the cell\n\t    delete highlights[editor.ecell.coord];\n\t    highlights[editor.ecell.coord] = \"cursor\";\n\t    editor.UpdateCellCSS(cell, editor.ecell.row, editor.ecell.col);\n\t\n\t    var celltext = \"Enter Value\";\n\t    var title = \"Input\";\n\t    if (constraint) {} else {\n\t        console.log(\"cell text is null\");\n\t    }\n\t\n\t    var options = { title: title };\n\t\n\t    options[\"message\"] = celltext;\n\t    console.log(\"text is \" + text);\n\t    options[\"textvalue\"] = text;\n\t\n\t    function onPrompt(results) {\n\t        if (results.buttonIndex === 3) return;else if (results.buttonIndex === 2) {\n\t            var onConfirm = function onConfirm(buttonIndex) {\n\t                console.log(buttonIndex);\n\t                switch (buttonIndex) {\n\t                    case 1:\n\t                        //do nothing \n\t                        break;\n\t                    case 2:\n\t                        var onFontConfirm = function onFontConfirm(fontIndex) {\n\t                            switch (fontIndex) {\n\t                                case 1:\n\t                                    //do nothing \n\t                                    break;\n\t                                case 2:\n\t                                    SocialCalc.EditorChangefontFromWidget(editor, \"a\");\n\t                                    break;\n\t                                case 3:\n\t                                    SocialCalc.EditorChangefontFromWidget(editor, \"b\");\n\t                                    break;\n\t                                case 4:\n\t                                    SocialCalc.EditorChangefontFromWidget(editor, \"c\");\n\t                                    break;\n\t                                case 5:\n\t                                    SocialCalc.EditorChangefontFromWidget(editor, \"d\");\n\t                                    break;\n\t                                default:\n\t                                    break;\n\t                            }\n\t                        };\n\t\n\t                        navigator.notification.confirm('Customise cell options', // message\n\t                        onFontConfirm, // callback to invoke with index of button pressed\n\t                        'Customise', // title\n\t                        ['Cancel', 'Small:8pt', 'Medium:12pt', 'Big:14pt', 'Large:16pt'] // buttonLabels\n\t                        );\n\t                        break;\n\t                    case 3:\n\t                        var onColorConfirm = function onColorConfirm(colorIndex) {\n\t                            switch (colorIndex) {\n\t                                case 1:\n\t                                    //do nothing \n\t                                    break;\n\t                                case 2:\n\t                                    SocialCalc.EditorChangecolorFromWidget(editor, \"red\");\n\t                                    break;\n\t                                case 3:\n\t                                    SocialCalc.EditorChangecolorFromWidget(editor, \"yellow\");\n\t                                    break;\n\t                                case 4:\n\t                                    SocialCalc.EditorChangecolorFromWidget(editor, \"blue\");\n\t                                    break;\n\t                                case 5:\n\t                                    SocialCalc.EditorChangecolorFromWidget(editor, \"green\");\n\t                                    break;\n\t                                case 6:\n\t                                    SocialCalc.EditorChangecolorFromWidget(editor, \"purple\");\n\t                                    break;\n\t                                case 7:\n\t                                    SocialCalc.EditorChangecolorFromWidget(editor, \"black\");\n\t                                    break;\n\t                                default:\n\t                                    break;\n\t                            }\n\t                        };\n\t\n\t                        navigator.notification.confirm('Customise cell options', // message\n\t                        onColorConfirm, // callback to invoke with index of button pressed\n\t                        'Customise', // title\n\t                        ['Cancel', 'Red', 'Yellow', 'Blue', 'Green', 'Purple', 'Black'] // buttonLabels\n\t                        );\n\t                        break;\n\t                    case 4:\n\t                        editor.context.sheetobj.SheetUndo();\n\t                        break;\n\t                    case 5:\n\t                        editor.context.sheetobj.SheetRedo();\n\t                        break;\n\t                    case 6:\n\t                        SocialCalc.EditorCut(editor, 'a');\n\t                        break;\n\t                    case 7:\n\t                        SocialCalc.EditorCut(editor, 'b');\n\t                        break;\n\t                    case 8:\n\t                        SocialCalc.EditorCut(editor, 'c');\n\t                        break;\n\t                    case 9:\n\t                        SocialCalc.EditorCut(editor, 'd');\n\t                        break;\n\t                    default:\n\t                        break;\n\t                }\n\t            };\n\t            navigator.notification.confirm('Customise cell options', // message\n\t            onConfirm, // callback to invoke with index of button pressed\n\t            'Customise', // title\n\t            [\"Cancel\", \"Font\", \"Color\", \"Undo\", \"Redo\", \"Cut\", \"Copy\", \"Paste\", \"Clear\"] // buttonLabels\n\t            );\n\t        } else if (results.buttonIndex === 1) {\n\t            okfn(results.input1);\n\t        }\n\t    }\n\t\n\t    navigator.notification.prompt('Enter value', // message\n\t    onPrompt, // callback to invoke\n\t    'Input', // title\n\t    ['Ok', 'Customise', 'Cancel'], // buttonLabels\n\t    '' + text + '' // defaultText\n\t    );\n\t\n\t    return true;\n\t}\n\t\n\tfunction getSpreadsheetContent() {\n\t    return SocialCalc.WorkBookControlSaveSheet();\n\t}\n\t\n\tfunction getCurrentHTMLContent() {\n\t    var control = SocialCalc.GetCurrentWorkBookControl();\n\t    return control.workbook.spreadsheet.CreateSheetHTML();\n\t}\n\t\n\tfunction getAllHTMLContent(sheetdata) {\n\t    var appsheets = {};\n\t    // var control = SocialCalc.GetCurrentWorkBookControl();\n\t\n\t    for (var i = 1; i <= sheetdata.numsheets; i++) {\n\t        var key = \"sheet\" + i;\n\t        appsheets[key] = key;\n\t    }\n\t\n\t    return SocialCalc.WorkbookControlCreateSheetHTML(appsheets);\n\t}\n\t\n\tfunction saveAs() {\n\t    return new Promise(function (resolve, reject) {\n\t\n\t        navigator.notification.prompt('Please enter the filename', // message\n\t        function (results) {\n\t            if (results.buttonIndex === 2) {\n\t                resolve(results.input1);\n\t            }\n\t        }, // callback to invoke\n\t        'Save as', // title\n\t        ['Cancel', 'Save'], // buttonLabels\n\t        '' // defaultText\n\t        );\n\t    });\n\t}\n\t\n\tfunction getAllOldFiles() {\n\t    return new Promise(function (resolve, reject) {\n\t        var files = {};\n\t\n\t        for (var i = 0; i < window.localStorage.length; i++) {\n\t            if (window.localStorage.key(i).length >= 30) continue;\n\t            var filename = window.localStorage.key(i);\n\t\n\t            if (filename === \"logoArray\") continue;\n\t            if (filename === \"inapp\") continue;\n\t            if (filename === \"sound\") continue;\n\t            if (filename === \"cloudInapp\") continue;\n\t            if (filename === \"inapplocal\") continue;\n\t            if (filename === \"inappPurchase\") continue;\n\t            if (filename === \"flag\") continue;\n\t            if (filename === \"share\") continue;\n\t            if (filename === \"cellArray\") continue;\n\t            if (filename === \"sk_receiptForProduct\") continue;\n\t            if (filename === \"sk_receiptForTransaction\") continue;\n\t            if (filename === \"didTutorial\" || filename === \"customise\" || filename === \"rename\" || filename === \"choice\") continue;\n\t            /// console.log(filename);\n\t            var filedata = decodeURIComponent(window.localStorage.getItem(filename));\n\t\n\t            files[filename] = filedata;\n\t        }\n\t        // console.log(files);\n\t        resolve(files);\n\t    });\n\t}\n\t\n\tfunction deleteAllOldFiles(files) {\n\t    return new Promise(function (resolve, reject) {\n\t        for (var i in files) {\n\t            console.log(\"Removing..\" + i);\n\t            window.localStorage.removeItem(i);\n\t        }\n\t        resolve(true);\n\t    });\n\t}\n\t\n\tfunction addLogo(coord, url) {\n\t    return new Promise(function (resolve, reject) {\n\t        console.log(url);\n\t\n\t        var control = SocialCalc.GetCurrentWorkBookControl();\n\t        var currsheet = control.currentSheetButton.id;\n\t        // var editor = control.workbook.spreadsheet.editor;\n\t\n\t        var cmd = '';\n\t        for (var sheetname in coord) {\n\t            if (coord[sheetname] !== null) {\n\t                if (currsheet === sheetname) {\n\t                    console.log(sheetname + \" ,\" + coord[sheetname]); // eslint-disable-next-line\n\t                    cmd = 'set ' + coord[sheetname] + ' text t <img src=\"' + url + '\" height=\"100\" width=\"150\"></img>' + \"\\n\";\n\t                    cmd = { cmdtype: \"scmd\", id: currsheet, cmdstr: cmd, saveundo: false };\n\t                    control.ExecuteWorkBookControlCommand(cmd, false);\n\t                }\n\t            }\n\t        }\n\t        resolve(true);\n\t    });\n\t}\n\t\n\tfunction removeLogo(coord) {\n\t    return new Promise(function (resolve, reject) {\n\t        var control = SocialCalc.GetCurrentWorkBookControl();\n\t        var currsheet = control.currentSheetButton.id;\n\t        // var editor = control.workbook.spreadsheet.editor;\n\t\n\t        var cmd = '';\n\t        for (var sheetname in coord) {\n\t            if (coord[sheetname] !== null) {\n\t                if (currsheet === sheetname) {\n\t                    console.log(sheetname + \" ,\" + coord[sheetname]);\n\t                    cmd = 'erase ' + coord[sheetname] + ' formulas';\n\t                    cmd = { cmdtype: \"scmd\", id: currsheet, cmdstr: cmd, saveundo: false };\n\t                    control.ExecuteWorkBookControlCommand(cmd, false);\n\t                }\n\t            }\n\t        }\n\t        resolve(true);\n\t    });\n\t}\n\t\n\tfunction undo() {\n\t    var control = SocialCalc.GetCurrentWorkBookControl();\n\t    //alert('control are'+control);\n\t    var editor = control.workbook.spreadsheet.editor;\n\t    editor.context.sheetobj.SheetUndo();\n\t}\n\t\n\tfunction redo() {\n\t    var control = SocialCalc.GetCurrentWorkBookControl();\n\t    //alert('control are'+control);\n\t    var editor = control.workbook.spreadsheet.editor;\n\t    editor.context.sheetobj.SheetRedo();\n\t}\n\t\n\tfunction getCurrentSheet() {\n\t    return SocialCalc.GetCurrentWorkBookControl().currentSheetButton.id;\n\t}\n\t\n\tfunction changeSheetColor(name) {\n\t    var control = SocialCalc.GetCurrentWorkBookControl();\n\t    var editor = control.workbook.spreadsheet.editor;\n\t\n\t    name = name.toLowerCase();\n\t    //console.log(\"changing sheet color to: \"+name);\n\t    SocialCalc.EditorChangeSheetcolor(editor, name);\n\t}\n\t\n\tfunction changeFontSheet(cmdline) {\n\t    var control = SocialCalc.GetCurrentWorkBookControl();\n\t    //alert('control are'+control);\n\t    var editor = control.workbook.spreadsheet.editor;\n\t    editor.EditorScheduleSheetCommands(cmdline, true, false);\n\t}\n\t\n\tfunction executeCommand(cmdline) {\n\t    var control = SocialCalc.GetCurrentWorkBookControl();\n\t    //alert('control are'+control);\n\t    var editor = control.workbook.spreadsheet.editor;\n\t    editor.EditorScheduleSheetCommands(cmdline, true, false);\n\t}\n\n/***/ },\n/* 4 */\n/***/ function(module, exports) {\n\n\t/*\n\tobject-assign\n\t(c) Sindre Sorhus\n\t@license MIT\n\t*/\n\t\n\t'use strict';\n\t/* eslint-disable no-unused-vars */\n\tvar getOwnPropertySymbols = Object.getOwnPropertySymbols;\n\tvar hasOwnProperty = Object.prototype.hasOwnProperty;\n\tvar propIsEnumerable = Object.prototype.propertyIsEnumerable;\n\t\n\tfunction toObject(val) {\n\t\tif (val === null || val === undefined) {\n\t\t\tthrow new TypeError('Object.assign cannot be called with null or undefined');\n\t\t}\n\t\n\t\treturn Object(val);\n\t}\n\t\n\tfunction shouldUseNative() {\n\t\ttry {\n\t\t\tif (!Object.assign) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\n\t\t\t// Detect buggy property enumeration order in older V8 versions.\n\t\n\t\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=4118\n\t\t\tvar test1 = new String('abc');  // eslint-disable-line no-new-wrappers\n\t\t\ttest1[5] = 'de';\n\t\t\tif (Object.getOwnPropertyNames(test1)[0] === '5') {\n\t\t\t\treturn false;\n\t\t\t}\n\t\n\t\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\t\tvar test2 = {};\n\t\t\tfor (var i = 0; i < 10; i++) {\n\t\t\t\ttest2['_' + String.fromCharCode(i)] = i;\n\t\t\t}\n\t\t\tvar order2 = Object.getOwnPropertyNames(test2).map(function (n) {\n\t\t\t\treturn test2[n];\n\t\t\t});\n\t\t\tif (order2.join('') !== '0123456789') {\n\t\t\t\treturn false;\n\t\t\t}\n\t\n\t\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\t\tvar test3 = {};\n\t\t\t'abcdefghijklmnopqrst'.split('').forEach(function (letter) {\n\t\t\t\ttest3[letter] = letter;\n\t\t\t});\n\t\t\tif (Object.keys(Object.assign({}, test3)).join('') !==\n\t\t\t\t\t'abcdefghijklmnopqrst') {\n\t\t\t\treturn false;\n\t\t\t}\n\t\n\t\t\treturn true;\n\t\t} catch (err) {\n\t\t\t// We don't expect any of the above to throw, but better to be safe.\n\t\t\treturn false;\n\t\t}\n\t}\n\t\n\tmodule.exports = shouldUseNative() ? Object.assign : function (target, source) {\n\t\tvar from;\n\t\tvar to = toObject(target);\n\t\tvar symbols;\n\t\n\t\tfor (var s = 1; s < arguments.length; s++) {\n\t\t\tfrom = Object(arguments[s]);\n\t\n\t\t\tfor (var key in from) {\n\t\t\t\tif (hasOwnProperty.call(from, key)) {\n\t\t\t\t\tto[key] = from[key];\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\tif (getOwnPropertySymbols) {\n\t\t\t\tsymbols = getOwnPropertySymbols(from);\n\t\t\t\tfor (var i = 0; i < symbols.length; i++) {\n\t\t\t\t\tif (propIsEnumerable.call(from, symbols[i])) {\n\t\t\t\t\t\tto[symbols[i]] = from[symbols[i]];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\n\t\treturn to;\n\t};\n\n\n/***/ },\n/* 5 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar storage = window.localStorage;\n\t\n\tvar File = exports.File = function File(created, modified, content, name, password) {\n\t\t_classCallCheck(this, File);\n\t\n\t\tthis.created = created;\n\t\tthis.modified = modified;\n\t\tthis.content = content;\n\t\tthis.name = name;\n\t\tthis.password = password;\n\t};\n\t\n\tvar Local = exports.Local = function () {\n\t\tfunction Local() {\n\t\t\t_classCallCheck(this, Local);\n\t\n\t\t\tthis.storage = storage;\n\t\t\tthis.token = null;\n\t\t}\n\t\n\t\t_createClass(Local, [{\n\t\t\tkey: \"_saveFile\",\n\t\t\tvalue: function _saveFile(file) {\n\t\t\t\t// console.log(file.password);\n\t\t\t\tvar data = { created: file.created, modified: file.modified, content: file.content, password: file.password };\n\t\t\t\tthis.storage.setItem(file.name, JSON.stringify(data));\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"_getFile\",\n\t\t\tvalue: function _getFile(name) {\n\t\t\t\tvar rawData = this.storage.getItem(name);\n\t\t\t\treturn JSON.parse(rawData);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"_getAllFiles\",\n\t\t\tvalue: function _getAllFiles() {\n\t\t\t\tvar arr = {};\n\t\t\t\tfor (var i = 0; i < window.localStorage.length; i++) {\n\t\t\t\t\tvar fname = window.localStorage.key(i);\n\t\t\t\t\t// console.log(fname);\n\t\t\t\t\tvar data = this._getFile(fname);\n\t\t\t\t\tarr[fname] = data.modified;\n\t\t\t\t}\n\t\t\t\treturn arr;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"_deleteFile\",\n\t\t\tvalue: function _deleteFile(name) {\n\t\t\t\tconsole.log(\"deleting file \" + name);\n\t\t\t\tthis.storage.removeItem(name);\n\t\t\t}\n\t\t}]);\n\n\t\treturn Local;\n\t}();\n\n/***/ },\n/* 6 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar asap = __webpack_require__(7);\n\t\n\tfunction noop() {}\n\t\n\t// States:\n\t//\n\t// 0 - pending\n\t// 1 - fulfilled with _value\n\t// 2 - rejected with _value\n\t// 3 - adopted the state of another promise, _value\n\t//\n\t// once the state is no longer pending (0) it is immutable\n\t\n\t// All `_` prefixed properties will be reduced to `_{random number}`\n\t// at build time to obfuscate them and discourage their use.\n\t// We don't use symbols or Object.defineProperty to fully hide them\n\t// because the performance isn't good enough.\n\t\n\t\n\t// to avoid using try/catch inside critical functions, we\n\t// extract them to here.\n\tvar LAST_ERROR = null;\n\tvar IS_ERROR = {};\n\tfunction getThen(obj) {\n\t  try {\n\t    return obj.then;\n\t  } catch (ex) {\n\t    LAST_ERROR = ex;\n\t    return IS_ERROR;\n\t  }\n\t}\n\t\n\tfunction tryCallOne(fn, a) {\n\t  try {\n\t    return fn(a);\n\t  } catch (ex) {\n\t    LAST_ERROR = ex;\n\t    return IS_ERROR;\n\t  }\n\t}\n\tfunction tryCallTwo(fn, a, b) {\n\t  try {\n\t    fn(a, b);\n\t  } catch (ex) {\n\t    LAST_ERROR = ex;\n\t    return IS_ERROR;\n\t  }\n\t}\n\t\n\tmodule.exports = Promise;\n\t\n\tfunction Promise(fn) {\n\t  if (typeof this !== 'object') {\n\t    throw new TypeError('Promises must be constructed via new');\n\t  }\n\t  if (typeof fn !== 'function') {\n\t    throw new TypeError('not a function');\n\t  }\n\t  this._45 = 0;\n\t  this._81 = 0;\n\t  this._65 = null;\n\t  this._54 = null;\n\t  if (fn === noop) return;\n\t  doResolve(fn, this);\n\t}\n\tPromise._10 = null;\n\tPromise._97 = null;\n\tPromise._61 = noop;\n\t\n\tPromise.prototype.then = function(onFulfilled, onRejected) {\n\t  if (this.constructor !== Promise) {\n\t    return safeThen(this, onFulfilled, onRejected);\n\t  }\n\t  var res = new Promise(noop);\n\t  handle(this, new Handler(onFulfilled, onRejected, res));\n\t  return res;\n\t};\n\t\n\tfunction safeThen(self, onFulfilled, onRejected) {\n\t  return new self.constructor(function (resolve, reject) {\n\t    var res = new Promise(noop);\n\t    res.then(resolve, reject);\n\t    handle(self, new Handler(onFulfilled, onRejected, res));\n\t  });\n\t};\n\tfunction handle(self, deferred) {\n\t  while (self._81 === 3) {\n\t    self = self._65;\n\t  }\n\t  if (Promise._10) {\n\t    Promise._10(self);\n\t  }\n\t  if (self._81 === 0) {\n\t    if (self._45 === 0) {\n\t      self._45 = 1;\n\t      self._54 = deferred;\n\t      return;\n\t    }\n\t    if (self._45 === 1) {\n\t      self._45 = 2;\n\t      self._54 = [self._54, deferred];\n\t      return;\n\t    }\n\t    self._54.push(deferred);\n\t    return;\n\t  }\n\t  handleResolved(self, deferred);\n\t}\n\t\n\tfunction handleResolved(self, deferred) {\n\t  asap(function() {\n\t    var cb = self._81 === 1 ? deferred.onFulfilled : deferred.onRejected;\n\t    if (cb === null) {\n\t      if (self._81 === 1) {\n\t        resolve(deferred.promise, self._65);\n\t      } else {\n\t        reject(deferred.promise, self._65);\n\t      }\n\t      return;\n\t    }\n\t    var ret = tryCallOne(cb, self._65);\n\t    if (ret === IS_ERROR) {\n\t      reject(deferred.promise, LAST_ERROR);\n\t    } else {\n\t      resolve(deferred.promise, ret);\n\t    }\n\t  });\n\t}\n\tfunction resolve(self, newValue) {\n\t  // Promise Resolution Procedure: https://github.com/promises-aplus/promises-spec#the-promise-resolution-procedure\n\t  if (newValue === self) {\n\t    return reject(\n\t      self,\n\t      new TypeError('A promise cannot be resolved with itself.')\n\t    );\n\t  }\n\t  if (\n\t    newValue &&\n\t    (typeof newValue === 'object' || typeof newValue === 'function')\n\t  ) {\n\t    var then = getThen(newValue);\n\t    if (then === IS_ERROR) {\n\t      return reject(self, LAST_ERROR);\n\t    }\n\t    if (\n\t      then === self.then &&\n\t      newValue instanceof Promise\n\t    ) {\n\t      self._81 = 3;\n\t      self._65 = newValue;\n\t      finale(self);\n\t      return;\n\t    } else if (typeof then === 'function') {\n\t      doResolve(then.bind(newValue), self);\n\t      return;\n\t    }\n\t  }\n\t  self._81 = 1;\n\t  self._65 = newValue;\n\t  finale(self);\n\t}\n\t\n\tfunction reject(self, newValue) {\n\t  self._81 = 2;\n\t  self._65 = newValue;\n\t  if (Promise._97) {\n\t    Promise._97(self, newValue);\n\t  }\n\t  finale(self);\n\t}\n\tfunction finale(self) {\n\t  if (self._45 === 1) {\n\t    handle(self, self._54);\n\t    self._54 = null;\n\t  }\n\t  if (self._45 === 2) {\n\t    for (var i = 0; i < self._54.length; i++) {\n\t      handle(self, self._54[i]);\n\t    }\n\t    self._54 = null;\n\t  }\n\t}\n\t\n\tfunction Handler(onFulfilled, onRejected, promise){\n\t  this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n\t  this.onRejected = typeof onRejected === 'function' ? onRejected : null;\n\t  this.promise = promise;\n\t}\n\t\n\t/**\n\t * Take a potentially misbehaving resolver function and make sure\n\t * onFulfilled and onRejected are only called once.\n\t *\n\t * Makes no guarantees about asynchrony.\n\t */\n\tfunction doResolve(fn, promise) {\n\t  var done = false;\n\t  var res = tryCallTwo(fn, function (value) {\n\t    if (done) return;\n\t    done = true;\n\t    resolve(promise, value);\n\t  }, function (reason) {\n\t    if (done) return;\n\t    done = true;\n\t    reject(promise, reason);\n\t  })\n\t  if (!done && res === IS_ERROR) {\n\t    done = true;\n\t    reject(promise, LAST_ERROR);\n\t  }\n\t}\n\n\n/***/ },\n/* 7 */\n/***/ function(module, exports) {\n\n\t/* WEBPACK VAR INJECTION */(function(global) {\"use strict\";\n\t\n\t// Use the fastest means possible to execute a task in its own turn, with\n\t// priority over other events including IO, animation, reflow, and redraw\n\t// events in browsers.\n\t//\n\t// An exception thrown by a task will permanently interrupt the processing of\n\t// subsequent tasks. The higher level `asap` function ensures that if an\n\t// exception is thrown by a task, that the task queue will continue flushing as\n\t// soon as possible, but if you use `rawAsap` directly, you are responsible to\n\t// either ensure that no exceptions are thrown from your task, or to manually\n\t// call `rawAsap.requestFlush` if an exception is thrown.\n\tmodule.exports = rawAsap;\n\tfunction rawAsap(task) {\n\t    if (!queue.length) {\n\t        requestFlush();\n\t        flushing = true;\n\t    }\n\t    // Equivalent to push, but avoids a function call.\n\t    queue[queue.length] = task;\n\t}\n\t\n\tvar queue = [];\n\t// Once a flush has been requested, no further calls to `requestFlush` are\n\t// necessary until the next `flush` completes.\n\tvar flushing = false;\n\t// `requestFlush` is an implementation-specific method that attempts to kick\n\t// off a `flush` event as quickly as possible. `flush` will attempt to exhaust\n\t// the event queue before yielding to the browser's own event loop.\n\tvar requestFlush;\n\t// The position of the next task to execute in the task queue. This is\n\t// preserved between calls to `flush` so that it can be resumed if\n\t// a task throws an exception.\n\tvar index = 0;\n\t// If a task schedules additional tasks recursively, the task queue can grow\n\t// unbounded. To prevent memory exhaustion, the task queue will periodically\n\t// truncate already-completed tasks.\n\tvar capacity = 1024;\n\t\n\t// The flush function processes all tasks that have been scheduled with\n\t// `rawAsap` unless and until one of those tasks throws an exception.\n\t// If a task throws an exception, `flush` ensures that its state will remain\n\t// consistent and will resume where it left off when called again.\n\t// However, `flush` does not make any arrangements to be called again if an\n\t// exception is thrown.\n\tfunction flush() {\n\t    while (index < queue.length) {\n\t        var currentIndex = index;\n\t        // Advance the index before calling the task. This ensures that we will\n\t        // begin flushing on the next task the task throws an error.\n\t        index = index + 1;\n\t        queue[currentIndex].call();\n\t        // Prevent leaking memory for long chains of recursive calls to `asap`.\n\t        // If we call `asap` within tasks scheduled by `asap`, the queue will\n\t        // grow, but to avoid an O(n) walk for every task we execute, we don't\n\t        // shift tasks off the queue after they have been executed.\n\t        // Instead, we periodically shift 1024 tasks off the queue.\n\t        if (index > capacity) {\n\t            // Manually shift all values starting at the index back to the\n\t            // beginning of the queue.\n\t            for (var scan = 0, newLength = queue.length - index; scan < newLength; scan++) {\n\t                queue[scan] = queue[scan + index];\n\t            }\n\t            queue.length -= index;\n\t            index = 0;\n\t        }\n\t    }\n\t    queue.length = 0;\n\t    index = 0;\n\t    flushing = false;\n\t}\n\t\n\t// `requestFlush` is implemented using a strategy based on data collected from\n\t// every available SauceLabs Selenium web driver worker at time of writing.\n\t// https://docs.google.com/spreadsheets/d/1mG-5UYGup5qxGdEMWkhP6BWCz053NUb2E1QoUTU16uA/edit#gid=783724593\n\t\n\t// Safari 6 and 6.1 for desktop, iPad, and iPhone are the only browsers that\n\t// have WebKitMutationObserver but not un-prefixed MutationObserver.\n\t// Must use `global` or `self` instead of `window` to work in both frames and web\n\t// workers. `global` is a provision of Browserify, Mr, Mrs, or Mop.\n\t\n\t/* globals self */\n\tvar scope = typeof global !== \"undefined\" ? global : self;\n\tvar BrowserMutationObserver = scope.MutationObserver || scope.WebKitMutationObserver;\n\t\n\t// MutationObservers are desirable because they have high priority and work\n\t// reliably everywhere they are implemented.\n\t// They are implemented in all modern browsers.\n\t//\n\t// - Android 4-4.3\n\t// - Chrome 26-34\n\t// - Firefox 14-29\n\t// - Internet Explorer 11\n\t// - iPad Safari 6-7.1\n\t// - iPhone Safari 7-7.1\n\t// - Safari 6-7\n\tif (typeof BrowserMutationObserver === \"function\") {\n\t    requestFlush = makeRequestCallFromMutationObserver(flush);\n\t\n\t// MessageChannels are desirable because they give direct access to the HTML\n\t// task queue, are implemented in Internet Explorer 10, Safari 5.0-1, and Opera\n\t// 11-12, and in web workers in many engines.\n\t// Although message channels yield to any queued rendering and IO tasks, they\n\t// would be better than imposing the 4ms delay of timers.\n\t// However, they do not work reliably in Internet Explorer or Safari.\n\t\n\t// Internet Explorer 10 is the only browser that has setImmediate but does\n\t// not have MutationObservers.\n\t// Although setImmediate yields to the browser's renderer, it would be\n\t// preferrable to falling back to setTimeout since it does not have\n\t// the minimum 4ms penalty.\n\t// Unfortunately there appears to be a bug in Internet Explorer 10 Mobile (and\n\t// Desktop to a lesser extent) that renders both setImmediate and\n\t// MessageChannel useless for the purposes of ASAP.\n\t// https://github.com/kriskowal/q/issues/396\n\t\n\t// Timers are implemented universally.\n\t// We fall back to timers in workers in most engines, and in foreground\n\t// contexts in the following browsers.\n\t// However, note that even this simple case requires nuances to operate in a\n\t// broad spectrum of browsers.\n\t//\n\t// - Firefox 3-13\n\t// - Internet Explorer 6-9\n\t// - iPad Safari 4.3\n\t// - Lynx 2.8.7\n\t} else {\n\t    requestFlush = makeRequestCallFromTimer(flush);\n\t}\n\t\n\t// `requestFlush` requests that the high priority event queue be flushed as\n\t// soon as possible.\n\t// This is useful to prevent an error thrown in a task from stalling the event\n\t// queue if the exception handled by Node.jss\n\t// `process.on(\"uncaughtException\")` or by a domain.\n\trawAsap.requestFlush = requestFlush;\n\t\n\t// To request a high priority event, we induce a mutation observer by toggling\n\t// the text of a text node between \"1\" and \"-1\".\n\tfunction makeRequestCallFromMutationObserver(callback) {\n\t    var toggle = 1;\n\t    var observer = new BrowserMutationObserver(callback);\n\t    var node = document.createTextNode(\"\");\n\t    observer.observe(node, {characterData: true});\n\t    return function requestCall() {\n\t        toggle = -toggle;\n\t        node.data = toggle;\n\t    };\n\t}\n\t\n\t// The message channel technique was discovered by Malte Ubl and was the\n\t// original foundation for this library.\n\t// http://www.nonblocking.io/2011/06/windownexttick.html\n\t\n\t// Safari 6.0.5 (at least) intermittently fails to create message ports on a\n\t// page's first load. Thankfully, this version of Safari supports\n\t// MutationObservers, so we don't need to fall back in that case.\n\t\n\t// function makeRequestCallFromMessageChannel(callback) {\n\t//     var channel = new MessageChannel();\n\t//     channel.port1.onmessage = callback;\n\t//     return function requestCall() {\n\t//         channel.port2.postMessage(0);\n\t//     };\n\t// }\n\t\n\t// For reasons explained above, we are also unable to use `setImmediate`\n\t// under any circumstances.\n\t// Even if we were, there is another bug in Internet Explorer 10.\n\t// It is not sufficient to assign `setImmediate` to `requestFlush` because\n\t// `setImmediate` must be called *by name* and therefore must be wrapped in a\n\t// closure.\n\t// Never forget.\n\t\n\t// function makeRequestCallFromSetImmediate(callback) {\n\t//     return function requestCall() {\n\t//         setImmediate(callback);\n\t//     };\n\t// }\n\t\n\t// Safari 6.0 has a problem where timers will get lost while the user is\n\t// scrolling. This problem does not impact ASAP because Safari 6.0 supports\n\t// mutation observers, so that implementation is used instead.\n\t// However, if we ever elect to use timers in Safari, the prevalent work-around\n\t// is to add a scroll event listener that calls for a flush.\n\t\n\t// `setTimeout` does not call the passed callback if the delay is less than\n\t// approximately 7 in web workers in Firefox 8 through 18, and sometimes not\n\t// even then.\n\t\n\tfunction makeRequestCallFromTimer(callback) {\n\t    return function requestCall() {\n\t        // We dispatch a timeout with a specified delay of 0 for engines that\n\t        // can reliably accommodate that request. This will usually be snapped\n\t        // to a 4 milisecond delay, but once we're flushing, there's no delay\n\t        // between events.\n\t        var timeoutHandle = setTimeout(handleTimer, 0);\n\t        // However, since this timer gets frequently dropped in Firefox\n\t        // workers, we enlist an interval handle that will try to fire\n\t        // an event 20 times per second until it succeeds.\n\t        var intervalHandle = setInterval(handleTimer, 50);\n\t\n\t        function handleTimer() {\n\t            // Whichever timer succeeds will cancel both timers and\n\t            // execute the callback.\n\t            clearTimeout(timeoutHandle);\n\t            clearInterval(intervalHandle);\n\t            callback();\n\t        }\n\t    };\n\t}\n\t\n\t// This is for `asap.js` only.\n\t// Its name will be periodically randomized to break any code that depends on\n\t// its existence.\n\trawAsap.makeRequestCallFromTimer = makeRequestCallFromTimer;\n\t\n\t// ASAP was originally a nextTick shim included in Q. This was factored out\n\t// into this ASAP package. It was later adapted to RSVP which made further\n\t// amendments. These decisions, particularly to marginalize MessageChannel and\n\t// to capture the MutationObserver implementation in a closure, were integrated\n\t// back into ASAP proper.\n\t// https://github.com/tildeio/rsvp.js/blob/cddf7232546a9cf858524b75cde6f9edf72620a7/lib/rsvp/asap.js\n\t\n\t/* WEBPACK VAR INJECTION */}.call(exports, (function() { return this; }())))\n\n/***/ },\n/* 8 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _react = __webpack_require__(1);\n\t\n\tvar _react2 = _interopRequireDefault(_react);\n\t\n\tvar _AppGeneral = __webpack_require__(3);\n\t\n\tvar AppGeneral = _interopRequireWildcard(_AppGeneral);\n\t\n\tvar _appData = __webpack_require__(2);\n\t\n\t__webpack_require__(15);\n\t\n\tvar _Menu = __webpack_require__(11);\n\t\n\tvar _Menu2 = _interopRequireDefault(_Menu);\n\t\n\tvar _Files = __webpack_require__(9);\n\t\n\tvar _Files2 = _interopRequireDefault(_Files);\n\t\n\tfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\t// import '@ionic/react/css/core.css';\n\t\n\t// /* Basic CSS for apps built with Ionic */\n\t// import '@ionic/react/css/normalize.css';\n\t// import '@ionic/react/css/structure.css';\n\t// import '@ionic/react/css/typography.css';\n\t\n\t// /* Optional CSS utils that can be commented out */\n\t// import '@ionic/react/css/padding.css';\n\t// import '@ionic/react/css/float-elements.css';\n\t// import '@ionic/react/css/text-alignment.css';\n\t// import '@ionic/react/css/text-transformation.css';\n\t// import '@ionic/react/css/flex-utils.css';\n\t// import '@ionic/react/css/display.css';\n\t// import { Outlet } from 'react-router-dom';\n\t// import { setupIonicReact } from '@ionic/react';\n\t\n\t// import '../theme/variables.css';\n\t\n\t// setupIonicReact();\n\t\n\tvar App = function (_Component) {\n\t  _inherits(App, _Component);\n\t\n\t  function App(props) {\n\t    _classCallCheck(this, App);\n\t\n\t    var _this = _possibleConstructorReturn(this, (App.__proto__ || Object.getPrototypeOf(App)).call(this, props));\n\t\n\t    _this.state = { selectedFile: \"default\", device: AppGeneral.getDeviceType(), listFiles: false };\n\t    _this.updateSelectedFile = _this.updateSelectedFile.bind(_this);\n\t    _this.toggleListFiles = _this.toggleListFiles.bind(_this);\n\t    return _this;\n\t  }\n\t\n\t  _createClass(App, [{\n\t    key: 'updateSelectedFile',\n\t    value: function updateSelectedFile(selectedFile) {\n\t      this.setState({\n\t        selectedFile: selectedFile\n\t      });\n\t    }\n\t  }, {\n\t    key: 'toggleListFiles',\n\t    value: function toggleListFiles() {\n\t      this.setState(function (prevState) {\n\t        return {\n\t          listFiles: !prevState.listFiles\n\t        };\n\t      });\n\t    }\n\t  }, {\n\t    key: 'componentDidMount',\n\t    value: function componentDidMount() {\n\t      var data = _appData.DATA['home'][this.state.device]['msc'];\n\t      AppGeneral.initializeApp(JSON.stringify(data));\n\t    }\n\t  }, {\n\t    key: 'activateFooter',\n\t    value: function activateFooter(footer) {\n\t      // console.log(\"Button pressed! \"+footer);\n\t      AppGeneral.activateFooterButton(footer);\n\t    }\n\t  }, {\n\t    key: 'render',\n\t    value: function render() {\n\t      var _this2 = this;\n\t\n\t      var footers = _appData.DATA['home'][this.state.device]['footers'];\n\t\n\t      var footersList = footers.map(function (footerArray, i) {\n\t        // console.log(footerArray.name);\n\t        // console.log(footerArray.index);\n\t        return _react2.default.createElement(\n\t          'button',\n\t          { className: 'button button-outline', key: footerArray.index, onClick: function onClick() {\n\t              return _this2.activateFooter(footerArray.index);\n\t            } },\n\t          ' ',\n\t          footerArray.name,\n\t          ' '\n\t        );\n\t      });\n\t\n\t      return _react2.default.createElement(\n\t        'div',\n\t        { className: 'App' },\n\t        _react2.default.createElement(\n\t          'div',\n\t          { className: 'App-header' },\n\t          _react2.default.createElement(\n\t            'span',\n\t            null,\n\t            'Editing: ',\n\t            this.state.selectedFile,\n\t            ' '\n\t          ),\n\t          _react2.default.createElement(\n\t            'button',\n\t            { className: 'App-list', onClick: this.toggleListFiles },\n\t            'List Files'\n\t          )\n\t        ),\n\t        _react2.default.createElement(\n\t          'div',\n\t          { className: 'App-menu' },\n\t          ' ',\n\t          _react2.default.createElement(_Menu2.default, { file: this.state.selectedFile, updateSelectedFile: this.updateSelectedFile }),\n\t          ' '\n\t        ),\n\t        _react2.default.createElement(\n\t          'ul',\n\t          { className: 'App-footers' },\n\t          ' ',\n\t          footersList,\n\t          ' '\n\t        ),\n\t        _react2.default.createElement('div', { id: 'workbookControl' }),\n\t        _react2.default.createElement(\n\t          'div',\n\t          { id: 'tableeditor' },\n\t          'editor goes here'\n\t        ),\n\t        _react2.default.createElement('div', { id: 'msg' }),\n\t        this.state.listFiles ? _react2.default.createElement(\n\t          'div',\n\t          { className: 'App-files' },\n\t          _react2.default.createElement(_Files2.default, { file: this.state.selectedFile, updateSelectedFile: this.updateSelectedFile }),\n\t          ' '\n\t        ) : null\n\t      );\n\t    }\n\t  }]);\n\t\n\t  return App;\n\t}(_react.Component);\n\t\n\texports.default = App;\n\n/***/ },\n/* 9 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _react = __webpack_require__(1);\n\t\n\tvar _react2 = _interopRequireDefault(_react);\n\t\n\t__webpack_require__(16);\n\t\n\tvar _AppGeneral = __webpack_require__(3);\n\t\n\tvar AppGeneral = _interopRequireWildcard(_AppGeneral);\n\t\n\tvar _LocalStorage = __webpack_require__(5);\n\t\n\tvar _appData = __webpack_require__(2);\n\t\n\tfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar Files = function (_Component) {\n\t\t_inherits(Files, _Component);\n\t\n\t\tfunction Files(props) {\n\t\t\t_classCallCheck(this, Files);\n\t\n\t\t\tvar _this = _possibleConstructorReturn(this, (Files.__proto__ || Object.getPrototypeOf(Files)).call(this, props));\n\t\n\t\t\t_this.store = new _LocalStorage.Local(_this.props.file);\n\t\t\t_this.state = {\n\t\t\t\tfiles: _this.store._getAllFiles()\n\t\t\t};\n\t\t\treturn _this;\n\t\t}\n\t\n\t\t_createClass(Files, [{\n\t\t\tkey: 'editFile',\n\t\t\tvalue: function editFile(key) {\n\t\t\t\tvar data = this.store._getFile(key);\n\t\t\t\t// console.log(JSON.stringify(data));\n\t\t\t\tAppGeneral.viewFile(key, decodeURIComponent(data.content));\n\t\t\t\tthis.props.updateSelectedFile(key);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'deleteFile',\n\t\t\tvalue: function deleteFile(key) {\n\t\t\t\tevent.preventDefault();\n\t\t\t\tvar result = window.confirm('Do you want to delete the ' + key + ' file?');\n\t\t\t\tif (result) {\n\t\t\t\t\t// Delete file\n\t\t\t\t\tthis.store._deleteFile(key);\n\t\t\t\t\tthis.setState({ files: this.store._getAllFiles() });\n\t\t\t\t\tthis.loadDefault();\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'loadDefault',\n\t\t\tvalue: function loadDefault() {\n\t\t\t\tvar msc = _appData.DATA['home'][AppGeneral.getDeviceType()]['msc'];\n\t\t\t\tAppGeneral.viewFile('default', JSON.stringify(msc));\n\t\t\t\tthis.props.updateSelectedFile('default');\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'render',\n\t\t\tvalue: function render() {\n\t\t\t\tvar _this2 = this;\n\t\n\t\t\t\tvar files = this.store._getAllFiles();\n\t\t\t\t// console.log(JSON.stringify(files));\n\t\t\t\tvar fileList = Object.keys(files).map(function (key) {\n\t\t\t\t\t// console.log(key);\n\t\t\t\t\treturn _react2.default.createElement(\n\t\t\t\t\t\t'div',\n\t\t\t\t\t\t{ key: key },\n\t\t\t\t\t\t_react2.default.createElement(\n\t\t\t\t\t\t\t'li',\n\t\t\t\t\t\t\tnull,\n\t\t\t\t\t\t\tkey,\n\t\t\t\t\t\t\t' ',\n\t\t\t\t\t\t\t_react2.default.createElement(\n\t\t\t\t\t\t\t\t'span',\n\t\t\t\t\t\t\t\tnull,\n\t\t\t\t\t\t\t\t_this2._formatDate(files[key])\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t),\n\t\t\t\t\t\t_react2.default.createElement(\n\t\t\t\t\t\t\t'button',\n\t\t\t\t\t\t\t{ onClick: function onClick() {\n\t\t\t\t\t\t\t\t\t_this2.editFile(key);\n\t\t\t\t\t\t\t\t} },\n\t\t\t\t\t\t\t'Edit'\n\t\t\t\t\t\t),\n\t\t\t\t\t\t_react2.default.createElement(\n\t\t\t\t\t\t\t'button',\n\t\t\t\t\t\t\t{ onClick: function onClick() {\n\t\t\t\t\t\t\t\t\t_this2.deleteFile(key);\n\t\t\t\t\t\t\t\t} },\n\t\t\t\t\t\t\t'Delete'\n\t\t\t\t\t\t)\n\t\t\t\t\t);\n\t\t\t\t});\n\t\n\t\t\t\treturn _react2.default.createElement(\n\t\t\t\t\t'div',\n\t\t\t\t\t{ className: 'file' },\n\t\t\t\t\t_react2.default.createElement(\n\t\t\t\t\t\t'ul',\n\t\t\t\t\t\tnull,\n\t\t\t\t\t\tfileList\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: '_formatDate',\n\t\t\tvalue: function _formatDate(date) {\n\t\t\t\treturn new Date(date).toLocaleString();\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Files;\n\t}(_react.Component);\n\t\n\texports.default = Files;\n\n/***/ },\n/* 10 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _react = __webpack_require__(1);\n\t\n\tvar _react2 = _interopRequireDefault(_react);\n\t\n\t__webpack_require__(17);\n\t\n\tvar _CloudStorage = __webpack_require__(14);\n\t\n\tvar _appData = __webpack_require__(2);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar Login = function (_Component) {\n\t  _inherits(Login, _Component);\n\t\n\t  function Login(props) {\n\t    _classCallCheck(this, Login);\n\t\n\t    var _this = _possibleConstructorReturn(this, (Login.__proto__ || Object.getPrototypeOf(Login)).call(this, props));\n\t\n\t    _this.state = {\n\t      email: '', password: ''\n\t    };\n\t\n\t    _this.cloud = new _CloudStorage.Cloud();\n\t\n\t    return _this;\n\t  }\n\t\n\t  _createClass(Login, [{\n\t    key: 'updateEmail',\n\t    value: function updateEmail(e) {\n\t      this.setState({ email: e.target.value });\n\t    }\n\t  }, {\n\t    key: 'updatePassword',\n\t    value: function updatePassword(e) {\n\t      this.setState({ password: e.target.value });\n\t    }\n\t  }, {\n\t    key: 'doAuth',\n\t    value: function doAuth() {\n\t      console.log(\"Loggin in... \" + this.state.email);\n\t      var data = { email: this.state.email, password: this.state.password, appname: _appData.APP_NAME };\n\t      this.cloud._auth(data);\n\t    }\n\t  }, {\n\t    key: 'render',\n\t    value: function render() {\n\t      var _this2 = this;\n\t\n\t      return _react2.default.createElement(\n\t        'div',\n\t        { className: 'Login-modal' },\n\t        _react2.default.createElement('input', { type: 'text', id: 'email', value: this.state.email, onChange: this.updateEmail.bind(this), placeholder: 'Email..' }),\n\t        _react2.default.createElement('input', { type: 'password', id: 'password', value: this.state.password, onChange: this.updatePassword.bind(this), placeholder: 'Password..' }),\n\t        _react2.default.createElement(\n\t          'button',\n\t          { onClick: function onClick() {\n\t              return _this2.doAuth();\n\t            } },\n\t          ' Login '\n\t        )\n\t      );\n\t    }\n\t  }]);\n\t\n\t  return Login;\n\t}(_react.Component);\n\t\n\texports.default = Login;\n\n/***/ },\n/* 11 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _react = __webpack_require__(1);\n\t\n\tvar _react2 = _interopRequireDefault(_react);\n\t\n\t__webpack_require__(18);\n\t\n\tvar _AppGeneral = __webpack_require__(3);\n\t\n\tvar AppGeneral = _interopRequireWildcard(_AppGeneral);\n\t\n\tvar _LocalStorage = __webpack_require__(5);\n\t\n\tvar _appData = __webpack_require__(2);\n\t\n\tvar _Login = __webpack_require__(10);\n\t\n\tvar _Login2 = _interopRequireDefault(_Login);\n\t\n\tfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\t// import AWS from 'aws-sdk';\n\t//import config from '../config';\n\t\n\t\n\t// const ses = new AWS.SES({\n\t// \t  apiVersion: '2010-12-01',\n\t// \t  accessKeyId: 'AKIAIUAT6PWCBX54OQEA',\n\t// \t  \"secretAccessKey\": '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',\n\t// \t  \"region\": \"us-west-1\",\n\t// \t});\n\t\n\t\n\tvar Menu = function (_Component) {\n\t\t_inherits(Menu, _Component);\n\t\n\t\tfunction Menu(props) {\n\t\t\t_classCallCheck(this, Menu);\n\t\n\t\t\tvar _this = _possibleConstructorReturn(this, (Menu.__proto__ || Object.getPrototypeOf(Menu)).call(this, props));\n\t\n\t\t\t_this.store = new _LocalStorage.Local(_this.props.file);\n\t\t\t_this.state = { login: false, openLogin: false };\n\t\t\treturn _this;\n\t\t}\n\t\n\t\t_createClass(Menu, [{\n\t\t\tkey: 'doPrint',\n\t\t\tvalue: function doPrint() {\n\t\t\t\tvar content = AppGeneral.getCurrentHTMLContent();\n\t\t\t\tvar printWindow = window.open('', '', 'left=100,top=100');\n\t\t\t\tprintWindow.document.write(content);\n\t\t\t\tprintWindow.print();\n\t\t\t\tprintWindow.close();\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'doSave',\n\t\t\tvalue: function doSave() {\n\t\t\t\tif (this.props.file === \"default\") {\n\t\t\t\t\twindow.alert('Cannot update ' + this.props.file + ' file! ');\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar content = encodeURIComponent(AppGeneral.getSpreadsheetContent());\n\t\t\t\tvar data = this.store._getFile(this.props.file);\n\t\t\t\tvar file = new _LocalStorage.File(data.created, new Date().toString(), content, this.props.file);\n\t\t\t\tthis.store._saveFile(file);\n\t\t\t\tthis.props.updateSelectedFile(this.props.file);\n\t\t\t\twindow.alert('File ' + this.props.file + ' updated successfully! ');\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'doSaveAs',\n\t\t\tvalue: function doSaveAs() {\n\t\t\t\tevent.preventDefault();\n\t\t\t\tvar filename = window.prompt(\"Enter filename : \");\n\t\t\t\tif (filename) {\n\t\t\t\t\tif (this._validateName(filename)) {\n\t\t\t\t\t\t// filename valid . go on save\n\t\t\t\t\t\tvar content = encodeURIComponent(AppGeneral.getSpreadsheetContent());\n\t\t\t\t\t\t// console.log(content);\n\t\t\t\t\t\tvar file = new _LocalStorage.File(new Date().toString(), new Date().toString(), content, filename);\n\t\t\t\t\t\t// const data = { created: file.created, modified: file.modified, content: file.content, password: file.password };\n\t\t\t\t\t\t// console.log(JSON.stringify(data));\n\t\t\t\t\t\tthis.store._saveFile(file);\n\t\t\t\t\t\tthis.props.updateSelectedFile(filename);\n\t\t\t\t\t\twindow.alert('File ' + filename + ' saved successfully! ');\n\t\t\t\t\t} else {\n\t\t\t\t\t\twindow.alert('Filename cannot be ' + this.props.file);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'newFile',\n\t\t\tvalue: function newFile() {\n\t\t\t\tif (this.props.file !== 'default') {\n\t\t\t\t\tvar content = encodeURIComponent(AppGeneral.getSpreadsheetContent());\n\t\t\t\t\tvar data = this.store._getFile(this.props.file);\n\t\t\t\t\tvar file = new _LocalStorage.File(data.created, new Date().toString(), content, this.props.file);\n\t\t\t\t\tthis.store._saveFile(file);\n\t\t\t\t\tthis.props.updateSelectedFile(this.props.file);\n\t\t\t\t}\n\t\t\t\tvar msc = _appData.DATA['home'][AppGeneral.getDeviceType()]['msc'];\n\t\t\t\tAppGeneral.viewFile('default', JSON.stringify(msc));\n\t\t\t\tthis.props.updateSelectedFile('default');\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'auth',\n\t\t\tvalue: function auth(loggedIn) {\n\t\t\t\tif (loggedIn) {\n\t\t\t\t\t// console.log(\"log out..\");\n\t\t\t\t\tthis.setState({ login: false, openLogin: false });\n\t\t\t\t} else {\n\t\t\t\t\t// console.log(\"log in..\");\n\t\t\t\t\tthis.setState({ login: true, openLogin: true });\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'sendEmail',\n\t\t\tvalue: function sendEmail() {\n\t\t\t\t// Prepare values to send with email\n\t\t\t\tvar emailParams = {\n\t\t\t\t\tDestination: { ToAddresses: ['<aspiringuserapps@gmail.com>'] },\n\t\t\t\t\tMessage: {\n\t\t\t\t\t\tBody: { Text: {\n\t\t\t\t\t\t\t\tData: 'This is a test email' } },\n\t\t\t\t\t\tSubject: { Data: 'Contact Form' }\n\t\t\t\t\t},\n\t\t\t\t\tReplyToAddresses: [''],\n\t\t\t\t\tSource: '<aspiring.investments@gmail.com>' // this has to be verified email in SES\n\t\t\t\t};\n\t\n\t\t\t\t//   ses.sendEmail(emailParams, function(error, data) {\n\t\t\t\t//     if (error) {\n\t\t\t\t//        // handle error\n\t\t\t\t//     } else {\n\t\t\t\t//        // handle success\n\t\t\t\t//        alert(\"Done\");\n\t\t\t\t//     }\n\t\t\t\t//   });\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'render',\n\t\t\tvalue: function render() {\n\t\t\t\tvar _this2 = this;\n\t\n\t\t\t\treturn _react2.default.createElement(\n\t\t\t\t\t'div',\n\t\t\t\t\t{ className: 'Menu' },\n\t\t\t\t\t_react2.default.createElement(\n\t\t\t\t\t\t'button',\n\t\t\t\t\t\t{ onClick: function onClick() {\n\t\t\t\t\t\t\t\treturn _this2.doSave();\n\t\t\t\t\t\t\t} },\n\t\t\t\t\t\t' Save  '\n\t\t\t\t\t),\n\t\t\t\t\t_react2.default.createElement(\n\t\t\t\t\t\t'button',\n\t\t\t\t\t\t{ onClick: function onClick() {\n\t\t\t\t\t\t\t\treturn _this2.doSaveAs();\n\t\t\t\t\t\t\t} },\n\t\t\t\t\t\t' Save As '\n\t\t\t\t\t),\n\t\t\t\t\t_react2.default.createElement(\n\t\t\t\t\t\t'button',\n\t\t\t\t\t\t{ onClick: function onClick() {\n\t\t\t\t\t\t\t\treturn _this2.doPrint();\n\t\t\t\t\t\t\t} },\n\t\t\t\t\t\t' Print '\n\t\t\t\t\t),\n\t\t\t\t\t_react2.default.createElement(\n\t\t\t\t\t\t'button',\n\t\t\t\t\t\t{ onClick: function onClick() {\n\t\t\t\t\t\t\t\treturn _this2.sendEmail();\n\t\t\t\t\t\t\t} },\n\t\t\t\t\t\t' Email '\n\t\t\t\t\t),\n\t\t\t\t\t_react2.default.createElement(\n\t\t\t\t\t\t'button',\n\t\t\t\t\t\t{ onClick: function onClick() {\n\t\t\t\t\t\t\t\treturn _this2.newFile();\n\t\t\t\t\t\t\t} },\n\t\t\t\t\t\t' New File '\n\t\t\t\t\t),\n\t\t\t\t\t_react2.default.createElement(\n\t\t\t\t\t\t'button',\n\t\t\t\t\t\t{ onClick: function onClick() {\n\t\t\t\t\t\t\t\treturn _this2.auth(_this2.state.login);\n\t\t\t\t\t\t\t} },\n\t\t\t\t\t\t' ',\n\t\t\t\t\t\tthis.state.login ? 'Logout' : 'Login',\n\t\t\t\t\t\t' '\n\t\t\t\t\t),\n\t\t\t\t\tthis.state.openLogin ? _react2.default.createElement(_Login2.default, null) : null\n\t\t\t\t);\n\t\t\t}\n\t\n\t\t\t/* Utility functions */\n\t\n\t\t}, {\n\t\t\tkey: '_validateName',\n\t\t\tvalue: function _validateName(filename) {\n\t\n\t\t\t\tfilename = filename.trim();\n\t\t\t\tif (filename === \"default\" || filename === \"Untitled\") {\n\t\t\t\t\t// return 'Cannot update default file!';\n\t\t\t\t\treturn false;\n\t\t\t\t} else if (filename === '' || !filename) {\n\t\t\t\t\t// this.showToast('Filename cannot be empty');\n\t\t\t\t\treturn false;\n\t\t\t\t} else if (filename.length > 30) {\n\t\t\t\t\t// this.showToast('Filename too long');\n\t\t\t\t\treturn false;\n\t\t\t\t} else if (/^[a-zA-Z0-9- ]*$/.test(filename) === false) {\n\t\t\t\t\t// this.showToast('Special Characters cannot be used');\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: '_formatString',\n\t\t\tvalue: function _formatString(filename) {\n\t\t\t\t/* Remove whitespaces */\n\t\t\t\twhile (filename.indexOf(\" \") !== -1) {\n\t\t\t\t\tfilename = filename.replace(\" \", \"\");\n\t\t\t\t}\n\t\t\t\treturn filename;\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Menu;\n\t}(_react.Component);\n\t\n\texports.default = Menu;\n\n/***/ },\n/* 12 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _react = __webpack_require__(1);\n\t\n\tvar _react2 = _interopRequireDefault(_react);\n\t\n\tvar _reactDom = __webpack_require__(23);\n\t\n\tvar _reactDom2 = _interopRequireDefault(_reactDom);\n\t\n\tvar _App = __webpack_require__(8);\n\t\n\tvar _App2 = _interopRequireDefault(_App);\n\t\n\t__webpack_require__(19);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t_reactDom2.default.render(_react2.default.createElement(_App2.default, null), document.getElementById('root'));\n\n/***/ },\n/* 13 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;'use strict';var _typeof=typeof Symbol===\"function\"&&typeof Symbol.iterator===\"symbol\"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol===\"function\"&&obj.constructor===Symbol&&obj!==Symbol.prototype?\"symbol\":typeof obj;};/* eslint-disable */// Taken from https://github.com/umdjs/umd/blob/master/templates/returnExports.js\n\t// (c) by The UMD contributors\n\t// MIT License: https://github.com/umdjs/umd/blob/master/LICENSE.md\n\t(function(root,factory){if(true){// AMD. Register as an anonymous module.\n\t!(__WEBPACK_AMD_DEFINE_ARRAY__ = [], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory.bind(root,this)), __WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ? (__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));}else if((typeof module==='undefined'?'undefined':_typeof(module))==='object'&&module.exports){// Node. Does not work with strict CommonJS, but\n\t// only CommonJS-like environments that support module.exports,\n\t// like Node.\n\tmodule.exports=factory.call(root,this);}else{// Browser globals (root is window)\n\troot.SocialCalc=factory.call(root,this);}})(undefined,function(window){//\n\t/*\n\t// The module of the SocialCalc package with customizable constants, strings, etc.\n\t// This is where most of the common localizations are done.\n\t//\n\t// (c) Copyright 2008, 2009, 2010 Socialtext, Inc.\n\t// All Rights Reserved.\n\t//\n\t// The contents of this file are subject to the Artistic License 2.0; you may not\n\t// use this file except in compliance with the License. You may obtain a copy of \n\t// the License at http://socialcalc.org/licenses/al-20/.\n\t//\n\t// Some of the other files in the SocialCalc package are licensed under\n\t// different licenses. Please note the licenses of the modules you use.\n\t//\n\t// Code History:\n\t//\n\t// Initially coded by Dan Bricklin of Software Garden, Inc., for Socialtext, Inc.\n\t// Based in part on the SocialCalc 1.1.0 code written in Perl.\n\t// The SocialCalc 1.1.0 code was:\n\t//    Portions (c) Copyright 2005, 2006, 2007 Software Garden, Inc.\n\t//    All Rights Reserved.\n\t//    Portions (c) Copyright 2007 Socialtext, Inc.\n\t//    All Rights Reserved.\n\t// The Perl SocialCalc started as modifications to the wikiCalc(R) program, version 1.0.\n\t// wikiCalc 1.0 was written by Software Garden, Inc.\n\t// Unless otherwise specified, referring to \"SocialCalc\" in comments refers to this\n\t// JavaScript version of the code, not the SocialCalc Perl code.\n\t//\n\t*///\n\t/*\n\t// The module of the SocialCalc package with customizable constants, strings, etc.\n\t// This is where most of the common localizations are done.\n\t//\n\t// (c) Copyright 2008, 2009, 2010 Socialtext, Inc.\n\t// All Rights Reserved.\n\t//\n\t// The contents of this file are subject to the Artistic License 2.0; you may not\n\t// use this file except in compliance with the License. You may obtain a copy of \n\t// the License at http://socialcalc.org/licenses/al-20/.\n\t//\n\t// Some of the other files in the SocialCalc package are licensed under\n\t// different licenses. Please note the licenses of the modules you use.\n\t//\n\t// Code History:\n\t//\n\t// Initially coded by Dan Bricklin of Software Garden, Inc., for Socialtext, Inc.\n\t// Based in part on the SocialCalc 1.1.0 code written in Perl.\n\t// The SocialCalc 1.1.0 code was:\n\t//    Portions (c) Copyright 2005, 2006, 2007 Software Garden, Inc.\n\t//    All Rights Reserved.\n\t//    Portions (c) Copyright 2007 Socialtext, Inc.\n\t//    All Rights Reserved.\n\t// The Perl SocialCalc started as modifications to the wikiCalc(R) program, version 1.0.\n\t// wikiCalc 1.0 was written by Software Garden, Inc.\n\t// Unless otherwise specified, referring to \"SocialCalc\" in comments refers to this\n\t// JavaScript version of the code, not the SocialCalc Perl code.\n\t//\n\t*/var AppGeneral=__webpack_require__(3);var SocialCalc;if(!SocialCalc)SocialCalc={};// *************************************\n\t//\n\t// TO LEARN HOW TO LOCALIZE OR CUSTOMIZE SOCIALCALC, PLEASE READ THIS:\n\t//\n\t// The constants are all properties of the SocialCalc.Constants object.\n\t// They are grouped here by what they are for, which module uses them, etc.\n\t//\n\t// Properties whose names start with \"s_\" are strings, or arrays of strings,\n\t// that are good candidates for translation from the English.\n\t//\n\t// Other properties relate to visual settings, localization parameters, etc.\n\t//\n\t// These values are not used when SocialCalc modules are first loaded.\n\t// They may be modified before the first use of the routines that use them,\n\t// e.g., before creating SocialCalc objects.\n\t//\n\t// The exceptions are:\n\t//    TooltipOffsetX and TooltipOffsetY, as described with their definitions.\n\t//\n\t// SocialCalc IS NOT DESIGNED FOR USE WITH A TRANSLATION FUNCTION each time a string\n\t// is used. Instead, language translations may be done by modifying this object.\n\t//\n\t// To customize SocialCalc, you may either replace this file with a modified version\n\t// or you can overwrite the values before use. An example would be to\n\t// iterate over all the properties looking for names that start with \"s_\" and\n\t// use some other mechanism to obtain a localized string and replace the values\n\t// here with those translated values.\n\t//\n\t// There is also a function, SocialCalc.ConstantsSetClasses, that may be used\n\t// to easily switch SocialCalc from using explicit CSS styles for many things\n\t// to using CSS classes. See the function, below, for more information.\n\t//\n\t// *************************************\n\tSocialCalc.Constants={//\n\t// Main SocialCalc module, socialcalc-3.js:\n\t//\n\t//*** Common Constants\n\ttextdatadefaulttype:\"t\",// This sets the default type for text on reading source file\n\t// It should normally be \"t\"\n\t//*** Common error messages\n\ts_BrowserNotSupported:\"Browser not supported.\",// error thrown if browser can't handle events like IE or Firefox.\n\ts_InternalError:\"Internal SocialCalc error (probably an internal bug): \",// hopefully unlikely, but a test failed\n\t//*** SocialCalc.ParseSheetSave\n\t// Errors thrown on unexpected value in save file:\n\ts_pssUnknownColType:\"Unknown col type item\",s_pssUnknownRowType:\"Unknown row type item\",s_pssUnknownLineType:\"Unknown line type\",//*** SocialCalc.CellFromStringParts\n\t// Error thrown on unexpected value in save file:\n\ts_cfspUnknownCellType:\"Unknown cell type item\",//*** SocialCalc.CanonicalizeSheet\n\tdoCanonicalizeSheet:true,// if true, do the canonicalization calculations\n\t//*** ExecuteSheetCommand\n\ts_escUnknownSheetCmd:\"Unknown sheet command: \",s_escUnknownSetCoordCmd:\"Unknown set coord command: \",s_escUnknownCmd:\"Unknown command: \",//*** SocialCalc.CheckAndCalcCell\n\ts_caccCircRef:\"Circular reference to \",// circular reference found during recalc\n\t//*** SocialCalc.RenderContext\n\tdefaultRowNameWidth:\"30\",// used to set minimum width of the row header column - a string in pixels\n\tdefaultAssumedRowHeight:15,// used when guessing row heights - number\n\tdefaultCellIDPrefix:\"cell_\",// if non-null, each cell will render with an ID starting with this\n\t// Default sheet display values\n\tdefaultCellLayout:\"padding:2px 2px 1px 2px;vertical-align:top;\",defaultCellFontStyle:\"normal normal\",defaultCellFontSize:\"small\",defaultCellFontFamily:\"Verdana,Arial,Helvetica,sans-serif\",defaultPaneDividerWidth:\"2\",// a string\n\tdefaultPaneDividerHeight:\"3\",// a string\n\tdefaultGridCSS:\"1px solid #C0C0C0;\",// used as style to set each border when grid enabled (was #ECECEC)\n\tdefaultCommentClass:\"\",// class added to cells with non-null comments when grid enabled\n\tdefaultCommentStyle:\"background-repeat:no-repeat;background-position:top right;background-image:url(www/assets/images/sc_commentbg.gif);\",// style added to cells with non-null comments when grid enabled\n\tdefaultCommentNoGridClass:\"\",// class added to cells with non-null comments when grid not enabled\n\tdefaultCommentNoGridStyle:\"\",// style added to cells with non-null comments when grid not enabled\n\tdefaultColWidth:\"80\",// text\n\tdefaultMinimumColWidth:10,// numeric\n\t// For each of the following default sheet display values at least one of class and/or style are needed\n\tdefaultHighlightTypeCursorClass:\"\",// defaultHighlightTypeCursorStyle: \"color:#FFF;backgroundColor:#A6A6A6;\",\n\tdefaultHighlightTypeCursorStyle:\"\",defaultHighlightTypeRangeClass:\"\",//defaultHighlightTypeRangeStyle: \"color:#000;backgroundColor:#E5E5E5;\",\n\tdefaultHighlightTypeRangeStyle:\"\",defaultColnameClass:\"\",// regular column heading letters, needs a cursor property \n\tdefaultColnameStyle:\"font-size:small;text-align:center;color:#FFFFFF;background-color:#808080;cursor:e-resize;\",defaultSelectedColnameClass:\"\",// column with selected cell, needs a cursor property \n\tdefaultSelectedColnameStyle:\"font-size:small;text-align:center;color:#FFFFFF;background-color:#404040;cursor:e-resize;\",defaultRownameClass:\"\",// regular row heading numbers\n\tdefaultRownameStyle:\"font-size:small;text-align:right;color:#FFFFFF;background-color:#808080;\",defaultSelectedRownameClass:\"\",// column with selected cell, needs a cursor property \n\tdefaultSelectedRownameStyle:\"font-size:small;text-align:right;color:#FFFFFF;background-color:#404040;\",defaultUpperLeftClass:\"\",// Corner cell in upper left\n\tdefaultUpperLeftStyle:\"font-size:small;text-align:center;color:#FFFFFF;background-color:#808080;cursor:e-resize;\",defaultSkippedCellClass:\"\",// used if present for spanned cells peeking into a pane (at least one of class/style needed)\n\tdefaultSkippedCellStyle:\"font-size:small;background-color:#CCC\",// used if present\n\tdefaultPaneDividerClass:\"\",// used if present for the look of the space between panes (at least one of class/style needed)\n\tdefaultPaneDividerStyle:\"font-size:small;background-color:#C0C0C0;padding:0px;\",// used if present\n\ts_rcMissingSheet:\"Render Context must have a sheet object\",// unlikely thrown error\n\t//*** SocialCalc.format_text_for_display\n\tdefaultLinkFormatString:'<span style=\"font-size:smaller;text-decoration:none !important;background-color:#66B;color:#FFF;\">Link</span>',// used for format \"text-link\"; you could make this an img tag if desired\n\t//   defaultLinkFormatString: '<img src=\"www/assets/images/sc_linkout.gif\" border=\"0\" alt=\"Link out\" title=\"Link out\">',\n\tdefaultPageLinkFormatString:'<span style=\"font-size:smaller;text-decoration:none !important;background-color:#66B;color:#FFF;\">Page</span>',// used for format \"text-link\"; you could make this an img tag if desired\n\t//*** SocialCalc.format_number_for_display\n\tdefaultFormatdt:'d-mmm-yyyy h:mm:ss',defaultFormatd:'d-mmm-yyyy',defaultFormatt:'[h]:mm:ss',defaultDisplayTRUE:'TRUE',// how TRUE shows when rendered\n\tdefaultDisplayFALSE:'FALSE',//\n\t// SocialCalc Table Editor module, socialcalctableeditor.js:\n\t//\n\t//*** SocialCalc.TableEditor\n\tdefaultImagePrefix:\"www/assets/images/sc_\",// URL prefix for images (e.g., \"/www/assets/images/sc\")\n\tdefaultTableEditorIDPrefix:\"te_\",// if present, many TableEditor elements are assigned IDs with this prefix\n\tdefaultPageUpDnAmount:15,// number of rows to move cursor on PgUp/PgDn keys (numeric)\n\tAllowCtrlS:true,// turns on Ctrl-S trapdoor for setting custom numeric formats and commands if true\n\t//*** SocialCalc.CreateTableEditor\n\tdefaultTableControlThickness:0,// the short size for the scrollbars, etc. (numeric in pixels)\n\tcteGriddivClass:\"\",// if present, the class for the TableEditor griddiv element\n\t//** SocialCalc.EditorGetStatuslineString -- strings shown on status line\n\ts_statusline_executing:\"Executing...\",s_statusline_displaying:\"Displaying...\",s_statusline_ordering:\"Ordering...\",s_statusline_calculating:\"Calculating...\",s_statusline_calculatingls:\"Calculating... Loading Sheet...\",s_statusline_doingserverfunc:\"doing server function \",s_statusline_incell:\" in cell \",s_statusline_calcstart:\"Calculation start...\",s_statusline_sum:\"SUM\",s_statusline_recalcneeded:'<span style=\"color:#999;\">(Recalc needed)</span>',s_statusline_circref:'<span style=\"color:red;\">Circular reference: ',//** SocialCalc.InputBoxDisplayCellContents\n\ts_inputboxdisplaymultilinetext:\"[Multi-line text: Click icon on right to edit]\",//** SocialCalc.InputEcho\n\tdefaultInputEchoClass:\"\",// if present, the class of the popup inputEcho div\n\tdefaultInputEchoStyle:\"filter:alpha(opacity=90);opacity:.9;backgroundColor:#FFD;border:1px solid #884;\"+\"fontSize:small;padding:2px 10px 1px 2px;cursor:default;\",// if present, pseudo style\n\tdefaultInputEchoPromptClass:\"\",// if present, the class of the popup inputEcho div\n\tdefaultInputEchoPromptStyle:\"filter:alpha(opacity=90);opacity:.9;backgroundColor:#FFD;\"+\"borderLeft:1px solid #884;borderRight:1px solid #884;borderBottom:1px solid #884;\"+\"fontSize:small;fontStyle:italic;padding:2px 10px 1px 2px;cursor:default;\",// if present, pseudo style\n\t//** SocialCalc.InputEchoText\n\tietUnknownFunction:\"Unknown function \",// displayed when typing \"=unknown(\"\n\t//** SocialCalc.CellHandles\n\tCH_radius1:29.0,// extent of inner circle within 90px image\n\tCH_radius2:41.0,// extent of outer circle within 90px image\n\ts_CHfillAllTooltip:\"Fill Contents and Formats Down/Right\",// tooltip for fill all handle\n\ts_CHfillContentsTooltip:\"Fill Contents Only Down/Right\",// tooltip for fill formulas handle\n\ts_CHmovePasteAllTooltip:\"Move Contents and Formats\",// etc.\n\ts_CHmovePasteContentsTooltip:\"Move Contents Only\",s_CHmoveInsertAllTooltip:\"Slide Contents and Formats within Row/Col\",s_CHmoveInsertContentsTooltip:\"Slide Contents within Row/Col\",s_CHindicatorOperationLookup:{\"Fill\":\"Fill\",\"FillC\":\"Fill Contents\",\"Move\":\"Move\",\"MoveI\":\"Slide\",\"MoveC\":\"Move Contents\",\"MoveIC\":\"Slide Contents\"},// short form of operation to follow drag\n\ts_CHindicatorDirectionLookup:{\"Down\":\" Down\",\"Right\":\" Right\",\"Horizontal\":\" Horizontal\",\"Vertical\":\" Vertical\"},// direction that modifies operation during drag\n\t//*** SocialCalc.TableControl\n\tdefaultTCSliderThickness:9,// length of pane slider (numeric in pixels)\n\tdefaultTCButtonThickness:20,// length of scroll +/- buttons (numeric in pixels)\n\tdefaultTCThumbThickness:15,// length of thumb (numeric in pixels)\n\t//*** SocialCalc.CreateTableControl\n\tTCmainStyle:\"backgroundColor:#EEE;\",// if present, pseudo style (text-align is textAlign) for main div of a table control\n\tTCmainClass:\"\",// if present, the CSS class of the main div for a table control\n\tTCendcapStyle:\"backgroundColor:#FFF;\",// backgroundColor may be used while waiting for image that may not come\n\tTCendcapClass:\"\",TCpanesliderStyle:\"backgroundColor:#CCC;\",TCpanesliderClass:\"\",s_panesliderTooltiph:\"Drag to lock pane vertically\",// tooltip for horizontal table control pane slider\n\ts_panesliderTooltipv:\"Drag to lock pane horizontally\",TClessbuttonStyle:\"backgroundColor:#AAA;\",TClessbuttonClass:\"\",TClessbuttonRepeatWait:300,// in milliseconds\n\tTClessbuttonRepeatInterval:20,//100, // in milliseconds\n\tTCmorebuttonStyle:\"backgroundColor:#AAA;\",TCmorebuttonClass:\"\",TCmorebuttonRepeatWait:300,// in milliseconds\n\tTCmorebuttonRepeatInterval:20,//100, // in milliseconds\n\tTCscrollareaStyle:\"backgroundColor:#DDD;\",TCscrollareaClass:\"\",TCscrollareaRepeatWait:500,// in milliseconds\n\tTCscrollareaRepeatInterval:100,// in milliseconds\n\tTCthumbClass:\"\",TCthumbStyle:\"backgroundColor:#CCC;\",//*** SocialCalc.TCPSDragFunctionStart\n\tTCPStrackinglineClass:\"\",// at least one of class/style for pane slider tracking line display in table control\n\tTCPStrackinglineStyle:\"overflow:hidden;position:absolute;zIndex:100;\",// if present, pseudo style (text-align is textAlign)\n\tTCPStrackinglineThickness:\"2px\",// narrow dimension of trackling line (string with units)\n\t//*** SocialCalc.TCTDragFunctionStart\n\tTCTDFSthumbstatusvClass:\"\",// at least one of class/style for vertical thumb dragging status display in table control\n\tTCTDFSthumbstatusvStyle:\"height:20px;width:auto;border:3px solid #808080;overflow:hidden;\"+\"backgroundColor:#FFF;fontSize:small;position:absolute;zIndex:100;\",// if present, pseudo style (text-align is textAlign)\n\tTCTDFSthumbstatushClass:\"\",// at least one of class/style for horizontal thumb dragging status display in table control\n\tTCTDFSthumbstatushStyle:\"height:20px;width:auto;border:1px solid black;padding:2px;\"+\"backgroundColor:#FFF;fontSize:small;position:absolute;zIndex:100;\",// if present, pseudo style (text-align is textAlign)\n\tTCTDFSthumbstatusrownumClass:\"\",// at least one of class/style for thumb dragging status display in table control\n\tTCTDFSthumbstatusrownumStyle:\"color:#FFF;background-color:#808080;font-size:small;white-space:nowrap;padding:3px;\",// if present, real style\n\tTCTDFStopOffsetv:0,// offsets for thumbstatus display while dragging\n\tTCTDFSleftOffsetv:-80,s_TCTDFthumbstatusPrefixv:\"Row \",// Text Control Drag Function text before row number\n\tTCTDFStopOffseth:-30,TCTDFSleftOffseth:0,s_TCTDFthumbstatusPrefixh:\"Col \",// Text Control Drag Function text before col number\n\t//*** SocialCalc.TooltipInfo\n\t// Note: These two values are used to set the TooltipInfo initial values when the code is first read in.\n\t// Modifying them here after loading has no effect -- you need to modify SocialCalc.TooltipInfo directly\n\t// to dynamically set them. This is different than most other constants which may be modified until use.\n\tTooltipOffsetX:2,// offset in pixels from mouse position (to right on left side of screen, to left on right)\n\tTooltipOffsetY:10,// offset in pixels above mouse position for lower edge\n\t//*** SocialCalc.TooltipDisplay\n\tTDpopupElementClass:\"\",// at least one of class/style for tooltip display\n\tTDpopupElementStyle:\"border:1px solid black;padding:1px 2px 2px 2px;textAlign:center;backgroundColor:#FFF;\"+\"fontSize:7pt;fontFamily:Verdana,Arial,Helvetica,sans-serif;\"+\"position:absolute;width:auto;zIndex:110;\",// if present, pseudo style (text-align is textAlign)\n\t//\n\t// SocialCalc Spreadsheet Control module, socialcalcspreadsheetcontrol.js:\n\t//\n\t//*** SocialCalc.SpreadsheetControl\n\tSCToolbarbackground:\"background-color:#404040;\",SCTabbackground:\"background-color:#CCC;\",SCTabselectedCSS:\"font-size:small;padding:6px 30px 6px 8px;color:#FFF;background-color:#404040;cursor:default;border-right:1px solid #CCC;\",SCTabplainCSS:\"font-size:small;padding:6px 30px 6px 8px;color:#FFF;background-color:#808080;cursor:default;border-right:1px solid #CCC;\",SCToolbartext:\"font-size:x-small;font-weight:bold;color:#FFF;padding-bottom:4px;\",SCFormulabarheight:0,// in pixels, will contain a text input box\n\tSCStatuslineheight:20,// in pixels\n\tSCStatuslineCSS:\"font-size:10px;padding:3px 0px;\",// workbook\n\tdoWorkBook:true,SCSheetBarHeight:25,SCSheetBarBackground:\"background-color:#CCC;\",SCSheetBarCSS:\"background-color:#CCC;\",SCSheetBarWidth:\"70%\",SCCellHandlesDisable:true,SCNoInputEcho:true,// do we need an input echo ?\n\ts_inputboxdisplaynoteditable:\"[not editable]\",SCNoRowName:true,SCNoRanging:true,SCNoQuoteInInputBox:true,// Constants for default Format tab (settings)\n\t//\n\t// *** EVEN THOUGH THESE DON'T START WITH s_: ***\n\t//\n\t// These should be carefully checked for localization. Make sure you understand what they do and how they work!\n\t// The first part of \"first:second|first:second|...\" is what is displayed and the second is the value to be used.\n\t// The value is normally not translated -- only the displayed part. The [cancel], [break], etc., are not translated --\n\t// they are commands to SocialCalc.SettingsControls.PopupListInitialize \n\tSCFormatNumberFormats:\"[cancel]:|[break]:|%loc!Default!:|[custom]:|%loc!Automatic!:general|%loc!Auto w/ commas!:[,]General|[break]:|\"+\"00:00|000:000|0000:0000|00000:00000|[break]:|%loc!Formula!:formula|%loc!Hidden!:hidden|[newcol]:\"+\"1234:0|1,234:#,##0|1,234.5:#,##0.0|1,234.56:#,##0.00|1,234.567:#,##0.000|1,234.5678:#,##0.0000|\"+\"[break]:|1,234%:#,##0%|1,234.5%:#,##0.0%|1,234.56%:#,##0.00%|\"+\"[newcol]:|$1,234:$#,##0|$1,234.5:$#,##0.0|$1,234.56:$#,##0.00|[break]:|\"+\"(1,234):#,##0_);(#,##0)|(1,234.5):#,##0.0_);(#,##0.0)|(1,234.56):#,##0.00_);(#,##0.00)|[break]:|\"+\"($1,234):#,##0_);($#,##0)|($1,234.5):$#,##0.0_);($#,##0.0)|($1,234.56):$#,##0.00_);($#,##0.00)|\"+\"[newcol]:|1/4/06:m/d/yy|01/04/2006:mm/dd/yyyy|2006-01-04:yyyy-mm-dd|4-Jan-06:d-mmm-yy|04-Jan-2006:dd-mmm-yyyy|January 4, 2006:mmmm d, yyyy|\"+\"[break]:|1\\\\c23:h:mm|1\\\\c23 PM:h:mm AM/PM|1\\\\c23\\\\c45:h:mm:ss|01\\\\c23\\\\c45:hh:mm:ss|26\\\\c23 (h\\\\cm):[hh]:mm|69\\\\c45 (m\\\\cs):[mm]:ss|69 (s):[ss]|\"+\"[newcol]:|2006-01-04 01\\\\c23\\\\c45:yyyy-mm-dd hh:mm:ss|January 4, 2006:mmmm d, yyyy hh:mm:ss|Wed:ddd|Wednesday:dddd|\",SCFormatTextFormats:\"[cancel]:|[break]:|%loc!Default!:|[custom]:|%loc!Automatic!:general|%loc!Plain Text!:text-plain|\"+\"HTML:text-html|%loc!Wikitext!:text-wiki|%loc!Link!:text-link|%loc!Formula!:formula|%loc!Hidden!:hidden|\",SCFormatPadsizes:\"[cancel]:|[break]:|%loc!Default!:|[custom]:|%loc!No padding!:0px|\"+\"[newcol]:|1 pixel:1px|2 pixels:2px|3 pixels:3px|4 pixels:4px|5 pixels:5px|\"+\"6 pixels:6px|7 pixels:7px|8 pixels:8px|[newcol]:|9 pixels:9px|10 pixels:10px|11 pixels:11px|\"+\"12 pixels:12px|13 pixels:13px|14 pixels:14px|16 pixels:16px|\"+\"18 pixels:18px|[newcol]:|20 pixels:20px|22 pixels:22px|24 pixels:24px|28 pixels:28px|36 pixels:36px|\",SCFormatFontsizes:\"[cancel]:|[break]:|%loc!Default!:|[custom]:|X-Small:x-small|Small:small|Medium:medium|Large:large|X-Large:x-large|\"+\"[newcol]:|6pt:6pt|7pt:7pt|8pt:8pt|9pt:9pt|10pt:10pt|11pt:11pt|12pt:12pt|14pt:14pt|16pt:16pt|\"+\"[newcol]:|18pt:18pt|20pt:20pt|22pt:22pt|24pt:24pt|28pt:28pt|36pt:36pt|48pt:48pt|72pt:72pt|\"+\"[newcol]:|8 pixels:8px|9 pixels:9px|10 pixels:10px|11 pixels:11px|\"+\"12 pixels:12px|13 pixels:13px|14 pixels:14px|[newcol]:|16 pixels:16px|\"+\"18 pixels:18px|20 pixels:20px|22 pixels:22px|24 pixels:24px|28 pixels:28px|36 pixels:36px|\",SCFormatFontfamilies:\"[cancel]:|[break]:|%loc!Default!:|[custom]:|Verdana:Verdana,Arial,Helvetica,sans-serif|\"+\"Arial:arial,helvetica,sans-serif|Courier:'Courier New',Courier,monospace|\",SCFormatFontlook:\"[cancel]:|[break]:|%loc!Default!:|%loc!Normal!:normal normal|%loc!Bold!:normal bold|%loc!Italic!:italic normal|\"+\"%loc!Bold Italic!:italic bold\",SCFormatTextAlignhoriz:\"[cancel]:|[break]:|%loc!Default!:|%loc!Left!:left|%loc!Center!:center|%loc!Right!:right|\",SCFormatNumberAlignhoriz:\"[cancel]:|[break]:|%loc!Default!:|%loc!Left!:left|%loc!Center!:center|%loc!Right!:right|\",SCFormatAlignVertical:\"[cancel]:|[break]:|%loc!Default!:|%loc!Top!:top|%loc!Middle!:middle|%loc!Bottom!:bottom|\",SCFormatColwidth:\"[cancel]:|[break]:|%loc!Default!:|[custom]:|[newcol]:|\"+\"20 pixels:20|40:40|60:60|80:80|100:100|120:120|140:140|160:160|\"+\"[newcol]:|180 pixels:180|200:200|220:220|240:240|260:260|280:280|300:300|\",SCFormatRecalc:\"[cancel]:|[break]:|%loc!Auto!:|%loc!Manual!:off|\",//*** SocialCalc.InitializeSpreadsheetControl\n\tISCButtonBorderNormal:\"#404040\",ISCButtonBorderHover:\"#999\",ISCButtonBorderDown:\"#FFF\",ISCButtonDownBackground:\"#888\",//*** SocialCalc.SettingsControls.PopupListInitialize\n\ts_PopupListCancel:\"[Cancel]\",s_PopupListCustom:\"Custom\",// ***\n\t//\n\t// s_loc_ constants accessed by SocialCalc.LocalizeString and SocialCalc.LocalizeSubstrings\n\t//\n\t// Used extensively by socialcalcspreadsheetcontrol.js\n\t//\n\t// ***\n\ts_loc_align_center:\"Align Center\",s_loc_align_left:\"Align Left\",s_loc_align_right:\"Align Right\",s_loc_alignment:\"Alignment\",s_loc_audit:\"Audit\",s_loc_audit_trail_this_session:\"Audit Trail This Session\",s_loc_auto:\"Auto\",s_loc_auto_sum:\"Auto Sum\",s_loc_auto_wX_commas:\"Auto w/ commas\",s_loc_automatic:\"Automatic\",s_loc_background:\"Background\",s_loc_bold:\"Bold\",s_loc_bold_XampX_italics:\"Bold &amp; Italics\",s_loc_bold_italic:\"Bold Italic\",s_loc_borders:\"Borders\",s_loc_borders_off:\"Borders Off\",s_loc_borders_on:\"Borders On\",s_loc_bottom:\"Bottom\",s_loc_bottom_border:\"Bottom Border\",s_loc_cell_settings:\"CELL SETTINGS\",s_loc_csv_format:\"CSV format\",s_loc_cancel:\"Cancel\",s_loc_category:\"Category\",s_loc_center:\"Center\",s_loc_clear:\"Clear\",s_loc_clear_socialcalc_clipboard:\"Clear SocialCalc Clipboard\",s_loc_clipboard:\"Clipboard\",s_loc_color:\"Color\",s_loc_column_:\"Column \",s_loc_comment:\"Comment\",s_loc_copy:\"Copy\",s_loc_custom:\"Custom\",s_loc_cut:\"Cut\",s_loc_default:\"Default\",s_loc_default_alignment:\"Default Alignment\",s_loc_default_column_width:\"Default Column Width\",s_loc_default_font:\"Default Font\",s_loc_default_format:\"Default Format\",s_loc_default_padding:\"Default Padding\",s_loc_delete:\"Delete\",s_loc_delete_column:\"Delete Column\",s_loc_delete_contents:\"Delete Contents\",s_loc_delete_row:\"Delete Row\",s_loc_description:\"Description\",s_loc_display_clipboard_in:\"Display Clipboard in\",s_loc_down:\"Down\",s_loc_edit:\"Edit\",s_loc_existing_names:\"Existing Names\",s_loc_family:\"Family\",s_loc_fill_down:\"Fill Down\",s_loc_fill_right:\"Fill Right\",s_loc_font:\"Font\",s_loc_format:\"Format\",s_loc_formula:\"Formula\",s_loc_function_list:\"Function List\",s_loc_functions:\"Functions\",s_loc_grid:\"Grid\",s_loc_hidden:\"Hidden\",s_loc_horizontal:\"Horizontal\",s_loc_insert_column:\"Insert Column\",s_loc_insert_row:\"Insert Row\",s_loc_italic:\"Italic\",s_loc_last_sort:\"Last Sort\",s_loc_left:\"Left\",s_loc_left_border:\"Left Border\",s_loc_link:\"Link\",s_loc_link_input_box:\"Link Input Box\",s_loc_list:\"List\",s_loc_load_socialcalc_clipboard_with_this:\"Load SocialCalc Clipboard With This\",s_loc_major_sort:\"Major Sort\",s_loc_manual:\"Manual\",s_loc_merge_cells:\"Merge Cells\",s_loc_middle:\"Middle\",s_loc_minor_sort:\"Minor Sort\",s_loc_move_insert:\"Move Insert\",s_loc_move_paste:\"Move Paste\",s_loc_multiXline_input_box:\"Multi-line Input Box\",s_loc_name:\"Name\",s_loc_names:\"Names\",s_loc_no_padding:\"No padding\",s_loc_normal:\"Normal\",s_loc_number:\"Number\",s_loc_number_horizontal:\"Number Horizontal\",s_loc_ok:\"OK\",s_loc_padding:\"Padding\",s_loc_page_name:\"Page Name\",s_loc_paste:\"Paste\",s_loc_paste_formats:\"Paste Formats\",s_loc_plain_text:\"Plain Text\",s_loc_recalc:\"Recalc\",s_loc_recalculation:\"Recalculation\",s_loc_redo:\"Redo\",s_loc_right:\"Right\",s_loc_right_border:\"Right Border\",s_loc_sheet_settings:\"SHEET SETTINGS\",s_loc_save:\"Save\",s_loc_save_to:\"Save to\",s_loc_set_cell_contents:\"Set Cell Contents\",s_loc_set_cells_to_sort:\"Set Cells To Sort\",s_loc_set_value_to:\"Set Value To\",s_loc_set_to_link_format:\"Set to Link format\",s_loc_setXclear_move_from:\"Set/Clear Move From\",s_loc_show_cell_settings:\"Show Cell Settings\",s_loc_show_sheet_settings:\"Show Sheet Settings\",s_loc_show_in_new_browser_window:\"Show in new browser window\",s_loc_size:\"Size\",s_loc_socialcalcXsave_format:\"SocialCalc-save format\",s_loc_sort:\"Sort\",s_loc_sort_:\"Sort \",s_loc_sort_cells:\"Sort Cells\",s_loc_swap_colors:\"Swap Colors\",s_loc_tabXdelimited_format:\"Tab-delimited format\",s_loc_text:\"Text\",s_loc_text_horizontal:\"Text Horizontal\",s_loc_this_is_aXbrXsample:\"This is a<br>sample\",s_loc_top:\"Top\",s_loc_top_border:\"Top Border\",s_loc_undone_steps:\"UNDONE STEPS\",s_loc_url:\"URL\",s_loc_undo:\"Undo\",s_loc_unmerge_cells:\"Unmerge Cells\",s_loc_up:\"Up\",s_loc_value:\"Value\",s_loc_vertical:\"Vertical\",s_loc_wikitext:\"Wikitext\",s_loc_workspace:\"Workspace\",s_loc_XnewX:\"[New]\",s_loc_XnoneX:\"[None]\",s_loc_Xselect_rangeX:\"[select range]\",//\n\t// SocialCalc Spreadsheet Viewer module, socialcalcviewer.js:\n\t//\n\t//*** SocialCalc.SpreadsheetViewer\n\tSVStatuslineheight:20,// in pixels\n\tSVStatuslineCSS:\"font-size:10px;padding:3px 0px;\",//\n\t// SocialCalc Format Number module, formatnumber2.js:\n\t//\n\tFormatNumber_separatorchar:\",\",// the thousands separator character when formatting numbers for display\n\tFormatNumber_decimalchar:\".\",// the decimal separator character when formatting numbers for display\n\tFormatNumber_defaultCurrency:\"$\",// the currency string used if none specified\n\t// The following constants are arrays of strings with the short (3 character) and full names of days and months\n\ts_FormatNumber_daynames:[\"Sunday\",\"Monday\",\"Tuesday\",\"Wednesday\",\"Thursday\",\"Friday\",\"Saturday\"],s_FormatNumber_daynames3:[\"Sun\",\"Mon\",\"Tue\",\"Wed\",\"Thu\",\"Fri\",\"Sat\"],s_FormatNumber_monthnames:[\"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\"July\",\"August\",\"September\",\"October\",\"November\",\"December\"],s_FormatNumber_monthnames3:[\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\"],s_FormatNumber_am:\"AM\",s_FormatNumber_am1:\"A\",s_FormatNumber_pm:\"PM\",s_FormatNumber_pm1:\"P\",//\n\t// SocialCalc Spreadsheet Formula module, formula1.js:\n\t//\n\ts_parseerrexponent:\"Improperly formed number exponent\",s_parseerrchar:\"Unexpected character in formula\",s_parseerrstring:\"Improperly formed string\",s_parseerrspecialvalue:\"Improperly formed special value\",s_parseerrtwoops:\"Error in formula (two operators inappropriately in a row)\",s_parseerrmissingopenparen:\"Missing open parenthesis in list with comma(s). \",s_parseerrcloseparennoopen:\"Closing parenthesis without open parenthesis. \",s_parseerrmissingcloseparen:\"Missing close parenthesis. \",s_parseerrmissingoperand:\"Missing operand. \",s_parseerrerrorinformula:\"Error in formula.\",s_calcerrerrorvalueinformula:\"Error value in formula\",s_parseerrerrorinformulabadval:\"Error in formula resulting in bad value\",s_formularangeresult:\"Formula results in range value:\",s_calcerrnumericnan:\"Formula results in an bad numeric value\",s_calcerrnumericoverflow:\"Numeric overflow\",s_sheetunavailable:\"Sheet unavailable:\",// when FindSheetInCache returns null\n\ts_calcerrcellrefmissing:\"Cell reference missing when expected.\",s_calcerrsheetnamemissing:\"Sheet name missing when expected.\",s_circularnameref:\"Circular name reference to name\",s_calcerrunknownname:\"Unknown name\",s_calcerrincorrectargstofunction:\"Incorrect arguments to function\",s_sheetfuncunknownfunction:\"Unknown function\",s_sheetfunclnarg:\"LN argument must be greater than 0\",s_sheetfunclog10arg:\"LOG10 argument must be greater than 0\",s_sheetfunclogsecondarg:\"LOG second argument must be numeric greater than 0\",s_sheetfunclogfirstarg:\"LOG first argument must be greater than 0\",s_sheetfuncroundsecondarg:\"ROUND second argument must be numeric\",s_sheetfuncddblife:\"DDB life must be greater than 1\",s_sheetfuncslnlife:\"SLN life must be greater than 1\",// Function definition text\n\ts_fdef_ABS:'Absolute value function. ',s_fdef_ACOS:'Trigonometric arccosine function. ',s_fdef_AND:'True if all arguments are true. ',s_fdef_ASIN:'Trigonometric arcsine function. ',s_fdef_ATAN:'Trigonometric arctan function. ',s_fdef_ATAN2:'Trigonometric arc tangent function (result is in radians). ',s_fdef_AVERAGE:'Averages the values. ',s_fdef_CHOOSE:'Returns the value specified by the index. The values may be ranges of cells. ',s_fdef_COLUMNS:'Returns the number of columns in the range. ',s_fdef_COS:'Trigonometric cosine function (value is in radians). ',s_fdef_COUNT:'Counts the number of numeric values, not blank, text, or error. ',s_fdef_COUNTA:'Counts the number of non-blank values. ',s_fdef_COUNTBLANK:'Counts the number of blank values. (Note: \"\" is not blank.) ',s_fdef_COUNTIF:'Counts the number of number of cells in the range that meet the criteria. The criteria may be a value (\"x\", 15, 1+3) or a test (>25). ',s_fdef_DATE:'Returns the appropriate date value given numbers for year, month, and day. For example: DATE(2006,2,1) for February 1, 2006. Note: In this program, day \"1\" is December 31, 1899 and the year 1900 is not a leap year. Some programs use January 1, 1900, as day \"1\" and treat 1900 as a leap year. In both cases, though, dates on or after March 1, 1900, are the same. ',s_fdef_DAVERAGE:'Averages the values in the specified field in records that meet the criteria. ',s_fdef_DAY:'Returns the day of month for a date value. ',s_fdef_DCOUNT:'Counts the number of numeric values, not blank, text, or error, in the specified field in records that meet the criteria. ',s_fdef_DCOUNTA:'Counts the number of non-blank values in the specified field in records that meet the criteria. ',s_fdef_DDB:'Returns the amount of depreciation at the given period of time (the default factor is 2 for double-declining balance).   ',s_fdef_DEGREES:'Converts value in radians into degrees. ',s_fdef_DGET:'Returns the value of the specified field in the single record that meets the criteria. ',s_fdef_DMAX:'Returns the maximum of the numeric values in the specified field in records that meet the criteria. ',s_fdef_DMIN:'Returns the maximum of the numeric values in the specified field in records that meet the criteria. ',s_fdef_DPRODUCT:'Returns the result of multiplying the numeric values in the specified field in records that meet the criteria. ',s_fdef_DSTDEV:'Returns the sample standard deviation of the numeric values in the specified field in records that meet the criteria. ',s_fdef_DSTDEVP:'Returns the standard deviation of the numeric values in the specified field in records that meet the criteria. ',s_fdef_DSUM:'Returns the sum of the numeric values in the specified field in records that meet the criteria. ',s_fdef_DVAR:'Returns the sample variance of the numeric values in the specified field in records that meet the criteria. ',s_fdef_DVARP:'Returns the variance of the numeric values in the specified field in records that meet the criteria. ',s_fdef_EVEN:'Rounds the value up in magnitude to the nearest even integer. ',s_fdef_EXACT:'Returns \"true\" if the values are exactly the same, including case, type, etc. ',s_fdef_EXP:'Returns e raised to the value power. ',s_fdef_FACT:'Returns factorial of the value. ',s_fdef_FALSE:'Returns the logical value \"false\". ',s_fdef_FIND:'Returns the starting position within string2 of the first occurrence of string1 at or after \"start\". If start is omitted, 1 is assumed. ',s_fdef_FV:'Returns the future value of repeated payments of money invested at the given rate for the specified number of periods, with optional present value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period). ',s_fdef_HLOOKUP:'Look for the matching value for the given value in the range and return the corresponding value in the cell specified by the row offset. If rangelookup is 1 (the default) and not 0, match if within numeric brackets (match<=value) instead of exact match. ',s_fdef_HOUR:'Returns the hour portion of a time or date/time value. ',s_fdef_IF:'Results in true-value if logical-expression is TRUE or non-zero, otherwise results in false-value. ',s_fdef_INDEX:'Returns a cell or range reference for the specified row and column in the range. If range is 1-dimensional, then only one of rownum or colnum are needed. If range is 2-dimensional and rownum or colnum are zero, a reference to the range of just the specified column or row is returned. You can use the returned reference value in a range, e.g., sum(A1:INDEX(A2:A10,4)). ',s_fdef_INT:'Returns the value rounded down to the nearest integer (towards -infinity). ',s_fdef_IRR:'Returns the interest rate at which the cash flows in the range have a net present value of zero. Uses an iterative process that will return #NUM! error if it does not converge. There may be more than one possible solution. Providing the optional guess value may help in certain situations where it does not converge or finds an inappropriate solution (the default guess is 10%). ',s_fdef_ISBLANK:'Returns \"true\" if the value is a reference to a blank cell. ',s_fdef_ISERR:'Returns \"true\" if the value is of type \"Error\" but not \"NA\". ',s_fdef_ISERROR:'Returns \"true\" if the value is of type \"Error\". ',s_fdef_ISLOGICAL:'Returns \"true\" if the value is of type \"Logical\" (true/false). ',s_fdef_ISNA:'Returns \"true\" if the value is the error type \"NA\". ',s_fdef_ISNONTEXT:'Returns \"true\" if the value is not of type \"Text\". ',s_fdef_ISNUMBER:'Returns \"true\" if the value is of type \"Number\" (including logical values). ',s_fdef_ISTEXT:'Returns \"true\" if the value is of type \"Text\". ',s_fdef_LEFT:'Returns the specified number of characters from the text value. If count is omitted, 1 is assumed. ',s_fdef_LEN:'Returns the number of characters in the text value. ',s_fdef_LN:'Returns the natural logarithm of the value. ',s_fdef_LOG:'Returns the logarithm of the value using the specified base. ',s_fdef_LOG10:'Returns the base 10 logarithm of the value. ',s_fdef_LOWER:'Returns the text value with all uppercase characters converted to lowercase. ',s_fdef_MATCH:'Look for the matching value for the given value in the range and return position (the first is 1) in that range. If rangelookup is 1 (the default) and not 0, match if within numeric brackets (match<=value) instead of exact match. If rangelookup is -1, act like 1 but the bracket is match>=value. ',s_fdef_MAX:'Returns the maximum of the numeric values. ',s_fdef_MID:'Returns the specified number of characters from the text value starting from the specified position. ',s_fdef_MIN:'Returns the minimum of the numeric values. ',s_fdef_MINUTE:'Returns the minute portion of a time or date/time value. ',s_fdef_MOD:'Returns the remainder of the first value divided by the second. ',s_fdef_MONTH:'Returns the month part of a date value. ',s_fdef_N:'Returns the value if it is a numeric value otherwise an error. ',s_fdef_NA:'Returns the #N/A error value which propagates through most operations. ',s_fdef_NOT:'Returns FALSE if value is true, and TRUE if it is false. ',s_fdef_NOW:'Returns the current date/time. ',s_fdef_NPER:'Returns the number of periods at which payments invested each period at the given rate with optional future value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period) has the given present value. ',s_fdef_NPV:'Returns the net present value of cash flows (which may be individual values and/or ranges) at the given rate. The flows are positive if income, negative if paid out, and are assumed at the end of each period. ',s_fdef_ODD:'Rounds the value up in magnitude to the nearest odd integer. ',s_fdef_OR:'True if any argument is true ',s_fdef_PI:'The value 3.1415926... ',s_fdef_PMT:'Returns the amount of each payment that must be invested at the given rate for the specified number of periods to have the specified present value, with optional future value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period). ',s_fdef_POWER:'Returns the first value raised to the second value power. ',s_fdef_PRODUCT:'Returns the result of multiplying the numeric values. ',s_fdef_PROPER:'Returns the text value with the first letter of each word converted to uppercase and the others to lowercase. ',s_fdef_PV:'Returns the present value of the given number of payments each invested at the given rate, with optional future value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period). ',s_fdef_RADIANS:'Converts value in degrees into radians. ',s_fdef_RATE:'Returns the rate at which the given number of payments each invested at the given rate has the specified present value, with optional future value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period). Uses an iterative process that will return #NUM! error if it does not converge. There may be more than one possible solution. Providing the optional guess value may help in certain situations where it does not converge or finds an inappropriate solution (the default guess is 10%). ',s_fdef_REPLACE:'Returns text1 with the specified number of characters starting from the specified position replaced by text2. ',s_fdef_REPT:'Returns the text repeated the specified number of times. ',s_fdef_RIGHT:'Returns the specified number of characters from the text value starting from the end. If count is omitted, 1 is assumed. ',s_fdef_ROUND:'Rounds the value to the specified number of decimal places. If precision is negative, then round to powers of 10. The default precision is 0 (round to integer). ',s_fdef_ROWS:'Returns the number of rows in the range. ',s_fdef_SECOND:'Returns the second portion of a time or date/time value (truncated to an integer). ',s_fdef_SIN:'Trigonometric sine function (value is in radians) ',s_fdef_SLN:'Returns the amount of depreciation at each period of time using the straight-line method. ',s_fdef_SQRT:'Square root of the value ',s_fdef_STDEV:'Returns the sample standard deviation of the numeric values. ',s_fdef_STDEVP:'Returns the standard deviation of the numeric values. ',s_fdef_SUBSTITUTE:'Returns text1 with the all occurrences of oldtext replaced by newtext. If \"occurrence\" is present, then only that occurrence is replaced. ',s_fdef_SUM:'Adds the numeric values. The values to the sum function may be ranges in the form similar to A1:B5. ',s_fdef_SUMIF:'Sums the numeric values of cells in the range that meet the criteria. The criteria may be a value (\"x\", 15, 1+3) or a test (>25). If range2 is present, then range1 is tested and the corresponding range2 value is summed. ',s_fdef_SYD:'Depreciation by Sum of Year\\'s Digits method. ',s_fdef_T:'Returns the text value or else a null string. ',s_fdef_TAN:'Trigonometric tangent function (value is in radians) ',s_fdef_TIME:'Returns the time value given the specified hour, minute, and second. ',s_fdef_TODAY:'Returns the current date (an integer). Note: In this program, day \"1\" is December 31, 1899 and the year 1900 is not a leap year. Some programs use January 1, 1900, as day \"1\" and treat 1900 as a leap year. In both cases, though, dates on or after March 1, 1900, are the same. ',s_fdef_TRIM:'Returns the text value with leading, trailing, and repeated spaces removed. ',s_fdef_TRUE:'Returns the logical value \"true\". ',s_fdef_TRUNC:'Truncates the value to the specified number of decimal places. If precision is negative, truncate to powers of 10. ',s_fdef_UPPER:'Returns the text value with all lowercase characters converted to uppercase. ',s_fdef_VALUE:'Converts the specified text value into a numeric value. Various forms that look like numbers (including digits followed by %, forms that look like dates, etc.) are handled. This may not handle all of the forms accepted by other spreadsheets and may be locale dependent. ',s_fdef_VAR:'Returns the sample variance of the numeric values. ',s_fdef_VARP:'Returns the variance of the numeric values. ',s_fdef_VLOOKUP:'Look for the matching value for the given value in the range and return the corresponding value in the cell specified by the column offset. If rangelookup is 1 (the default) and not 0, match if within numeric brackets (match>=value) instead of exact match. ',s_fdef_WEEKDAY:'Returns the day of week specified by the date value. If type is 1 (the default), Sunday is day and Saturday is day 7. If type is 2, Monday is day 1 and Sunday is day 7. If type is 3, Monday is day 0 and Sunday is day 6. ',s_fdef_YEAR:'Returns the year part of a date value. ',s_farg_v:\"value\",s_farg_vn:\"value1, value2, ...\",s_farg_xy:\"valueX, valueY\",s_farg_choose:\"index, value1, value2, ...\",s_farg_range:\"range\",s_farg_rangec:\"range, criteria\",s_farg_date:\"year, month, day\",s_farg_dfunc:\"databaserange, fieldname, criteriarange\",s_farg_ddb:\"cost, salvage, lifetime, period [, factor]\",s_farg_find:\"string1, string2 [, start]\",s_farg_fv:\"rate, n, payment, [pv, [paytype]]\",s_farg_hlookup:\"value, range, row, [rangelookup]\",s_farg_iffunc:\"logical-expression, true-value, false-value\",s_farg_index:\"range, rownum, colnum\",s_farg_irr:\"range, [guess]\",s_farg_tc:\"text, count\",s_farg_log:\"value, base\",s_farg_match:\"value, range, [rangelookup]\",s_farg_mid:\"text, start, length\",s_farg_nper:\"rate, payment, pv, [fv, [paytype]]\",s_farg_npv:\"rate, value1, value2, ...\",s_farg_pmt:\"rate, n, pv, [fv, [paytype]]\",s_farg_pv:\"rate, n, payment, [fv, [paytype]]\",s_farg_rate:\"n, payment, pv, [fv, [paytype, [guess]]]\",s_farg_replace:\"text1, start, length, text2\",s_farg_vp:\"value, [precision]\",s_farg_valpre:\"value, precision\",s_farg_csl:\"cost, salvage, lifetime\",s_farg_cslp:\"cost, salvage, lifetime, period\",s_farg_subs:\"text1, oldtext, newtext [, occurrence]\",s_farg_sumif:\"range1, criteria [, range2]\",s_farg_hms:\"hour, minute, second\",s_farg_txt:\"text\",s_farg_vlookup:\"value, range, col, [rangelookup]\",s_farg_weekday:\"date, [type]\",s_farg_dt:\"date\",function_classlist:[\"all\",\"stat\",\"lookup\",\"datetime\",\"financial\",\"test\",\"math\",\"text\"],// order of function classes\n\ts_fclass_all:\"All\",s_fclass_stat:\"Statistics\",s_fclass_lookup:\"Lookup\",s_fclass_datetime:\"Date & Time\",s_fclass_financial:\"Financial\",s_fclass_test:\"Test\",s_fclass_math:\"Math\",s_fclass_text:\"Text\",lastone:null};// Default classnames for use with SocialCalc.ConstantsSetClasses:\n\tSocialCalc.ConstantsDefaultClasses={defaultComment:\"\",defaultCommentNoGrid:\"\",defaultHighlightTypeCursor:\"\",defaultHighlightTypeRange:\"\",defaultColname:\"\",defaultSelectedColname:\"\",defaultRowname:\"\",defaultSelectedRowname:\"\",defaultUpperLeft:\"\",defaultSkippedCell:\"\",defaultPaneDivider:\"\",cteGriddiv:\"\",// this one has no Style version with it\n\tdefaultInputEcho:{classname:\"\",style:\"filter:alpha(opacity=90);opacity:.9;\"},// so FireFox won't show warning\n\tTCmain:\"\",TCendcap:\"\",TCpaneslider:\"\",TClessbutton:\"\",TCmorebutton:\"\",TCscrollarea:\"\",TCthumb:\"\",TCPStrackingline:\"\",TCTDFSthumbstatus:\"\",TDpopupElement:\"\"};//\n\t// SocialCalc.ConstantsSetClasses(prefix)\n\t//\n\t// This routine goes through all of the xyzClass/xyzStyle pairs and sets the Class to a default and\n\t// turns off the Style, if present. The prefix is put before each default.\n\t// The list of items to set is in SocialCalc.ConstantsDefaultClasses. The names there\n\t// correspond to the \"xyz\" parts. If there is a value, it is the default to set. If the\n\t// default is a null, no change is made. If the default is the null string (\"\"), the\n\t// name of the item is used (e.g., \"defaultComment\" would use the classname \"defaultComment\").\n\t// If the default is an object, then it expects {classname: classname, style: stylestring} - this\n\t// lets you combine both.\n\t//\n\tSocialCalc.ConstantsSetClasses=function(prefix){var defaults=SocialCalc.ConstantsDefaultClasses;var scc=SocialCalc.Constants;var item;prefix=prefix||\"\";for(item in defaults){if(typeof defaults[item]==\"string\"){scc[item+\"Class\"]=prefix+(defaults[item]||item);if(scc[item+\"Style\"]!==undefined){scc[item+\"Style\"]=\"\";}}else if(_typeof(defaults[item])==\"object\"){scc[item+\"Class\"]=prefix+(defaults[item].classname||item);scc[item+\"Style\"]=defaults[item].style;}}};//\n\t// The main SocialCalc code module of the SocialCalc package\n\t//\n\t/*\n\t// (c) Copyright 2010 Socialtext, Inc.\n\t// All Rights Reserved.\n\t//\n\t// The contents of this file are subject to the Artistic License 2.0; you may not\n\t// use this file except in compliance with the License. You may obtain a copy of \n\t// the License at http://socialcalc.org/licenses/al-20/.\n\t//\n\t// Some of the other files in the SocialCalc package are licensed under\n\t// different licenses. Please note the licenses of the modules you use.\n\t//\n\t// Code History:\n\t//\n\t// Initially coded by Dan Bricklin of Software Garden, Inc., for Socialtext, Inc.\n\t// Based in part on the SocialCalc 1.1.0 code written in Perl.\n\t// The SocialCalc 1.1.0 code was:\n\t//    Portions (c) Copyright 2005, 2006, 2007 Software Garden, Inc.\n\t//    All Rights Reserved.\n\t//    Portions (c) Copyright 2007 Socialtext, Inc.\n\t//    All Rights Reserved.\n\t// The Perl SocialCalc started as modifications to the wikiCalc(R) program, version 1.0.\n\t// wikiCalc 1.0 was written by Software Garden, Inc.\n\t// Unless otherwise specified, referring to \"SocialCalc\" in comments refers to this\n\t// JavaScript version of the code, not the SocialCalc Perl code.\n\t//\n\t*//*\n\t\n\t**** Overview ****\n\t\n\tThis is the beginning of a library of routines for displaying and editing spreadsheet\n\tdata in a browser. The HTML that includes this does not need to have anything\n\tspecific to the spreadsheet or editor already present -- everything is dynamically\n\tadded to the DOM by this code, including the rendered sheet and any editing controls.\n\t\n\tThe library has a few parts. This is the main SocialCalc code module.\n\tOther parts are the Table Editor module, the Formula module, and the Format Number module.\n\tNote: The Table Editor module is licensed under a different license than this module.\n\t\n\tThe class/object style is derived from O'Reilly's JavaScript by Flanagan, 5th Edition,\n\tsection 9.3, page 157.\n\t\n\tAll of the data, object definitions, functions, etc., are stored as properties of the SocialCalc\n\tobject so as not to clutter up the global variables nor conflict with other names.\n\t\n\tA design goal (not tested yet for success) is to make it possible to have more than one\n\tspreadsheet active on a page, perhaps even open for editing. It is assumed, though, that\n\tthere is only one mouse and one keyboard (a good assumption on most PCs today but not in the\n\tnew \"touch and surface world\" Apple and Microsoft are working towards).\n\t\n\tThe testing has been on Windows Firefox (2 and 3),\n\tInternet Explorer (6 and 7), Opera (9.23 and mainly later), Mac Safari (3.1), and Mac Firefox (2.0.0.6).\n\tThere are small issues with Firefox before 2.0 (cosmetic with drag handles) and larger ones\n\twith Opera before 9.5 (the Delete key isn't recognized in some cases -- the 9.5 version was still\n\tin beta and this bug affects other products like GMail, I believe).\n\t\n\tThe data is stored in a SocialCalc.Sheet object. The data is organized in a form similar to that\n\tused by SocialCalc 1.1.0. There is a function for converting a normal SocialCalc spreadsheet\n\tsave data string (the spreadsheet part of a SocialCalc data file) into this internal form.\n\t\n\tThe SocialCalc.RenderContext class provides methods for rendering a table into the DOM representing\n\tpart of the spreadsheet. It is assumed that the spreadsheet could possibly be very large\n\tand that rendering the whole thing at once could be too time consuming. It is also set up so\n\tthat it might be possible to have some of the sheet data only be loaded on demand (such as by Ajax).\n\tThe rendering can render cells to the right and below the already active area of the spreadsheet\n\tso that you can scroll to that \"clean\" area without explicitly doing \"add row/column\". The class also\n\tdoes simple operations such as \"scrolling\" within that table. The table may optionally include\n\trow and column headers and may be split into panes. Most of the code assumes any number of panes,\n\tbut only the rightmost pane has scrolling code. In normal operation there would be one or two\n\tpanes horizontally and vertically. The panes may start on any row/column, though a given row/column\n\tshould only appear in one pane at a time (not all code enforces this, yet).\n\t\n\tThe RenderContext is designed to be rendered as part of a SocialCalc.TableEditor. The TableEditor\n\tincludes the spreadsheet grid as well as scrollbars, pane sliders, and (eventually) editing controls.\n\tThe layout is dynamic and may be recomputed on the fly, such as in response to resizing the browser\n\twindow.\n\t\n\tThe scrollbars and pane sliders are created using SocialCalc.TableControl objects. These in turn\n\tmake use of Dragging, ToolTip, Button, and MouseWheel functions.\n\t\n\tThe keyboard input is handled by keyboard code.\n\t\n\tThere are also some helper routines.\n\t\n\tMore comments yet to come...\n\t\n\t*/var SocialCalc;if(!SocialCalc)SocialCalc={};// *************************************\n\t//\n\t// Shared values\n\t//\n\t// These are \"global\" values shared by the classes, including default settings\n\t//\n\t// *************************************\n\t// Callbacks\n\tSocialCalc.Callbacks={// The next two are used by SocialCalc.format_text_for_display\n\t// The function to expand wiki text - should be set if you want wikitext expansion\n\t// The form is: expand_wiki(displayvalue, sheetobj, linkstyle, valueformat)\n\t//    valueformat is text-wiki followed by optional sub-formats, e.g., text-wikipagelink\n\texpand_wiki:null,expand_markup:function expand_markup(displayvalue,sheetobj,linkstyle)// the old function to expand wiki text - may be replaced\n\t{return SocialCalc.default_expand_markup(displayvalue,sheetobj,linkstyle);},// MakePageLink is used to create the href for a link to another \"page\"\n\t// The form is: MakePageLink(pagename, workspacename, linktyle, valueformat), returns string\n\tMakePageLink:null,// NormalizeSheetName is used to make different variations of sheetnames use the same cache slot\n\tNormalizeSheetName:null// use default - lowercase\n\t};// Shared flags\n\t// none at present\n\t// *************************************\n\t//\n\t// Cell class:\n\t//\n\t// *************************************\n\t//\n\t// Class SocialCalc.Cell\n\t//\n\t// Usage: var s = new SocialCalc.Cell(coord);\n\t//\n\t// Cell attributes include:\n\t//\n\t//    coord: the column/row as a string, e.g., \"A1\"\n\t//    datavalue: the value to be used for computation and formatting for display,\n\t//               string or numeric (tolerant of numbers stored as strings)\n\t//    datatype: if present, v=numeric value, t=text value, f=formula,\n\t//              or c=constant that is not a simple number (like \"$1.20\")\n\t//    formula: if present, the formula (without leading \"=\") for computation or the constant\n\t//    valuetype: first char is main type, the following are sub-types.\n\t//               Main types are b=blank cell, n=numeric, t=text, e=error\n\t//               Examples of using sub-types would be \"nt\" for a numeric time value, \"n$\" for currency, \"nl\" for logical\n\t//    displayvalue: if present, rendered version of datavalue with formatting attributes applied\n\t//    parseinfo: if present, cached parsed version of formula\n\t//\n\t//    The following optional values, if present, are mainly used in rendering, overriding defaults:\n\t//\n\t//    bt, br, bb, bl: number of border's definition\n\t//    layout: layout (vertical alignment, padding) definition number\n\t//    font: font definition number\n\t//    color: text color definition number\n\t//    bgcolor: background color definition number\n\t//    cellformat: cell format (horizontal alignment) definition number\n\t//    nontextvalueformat: custom format definition number for non-text values, e.g., numbers\n\t//    textvalueformat: custom format definition number for text values\n\t//    colspan, rowspan: number of cells to span for merged cells (only on main cell)\n\t//    cssc: custom css classname for cell, as text (no special chars)\n\t//    csss: custom css style definition\n\t//    mod: modification allowed flag \"y\" if present\n\t//    comment: cell comment string\n\t//\n\tSocialCalc.Cell=function(coord){this.coord=coord;this.datavalue=\"\";this.datatype=null;this.formula=\"\";this.valuetype=\"b\";};// The types of cell properties\n\t//\n\t// Type 1: Base, Type 2: Attribute, Type 3: Special (e.g., displaystring, parseinfo)\n\tSocialCalc.CellProperties={coord:1,datavalue:1,datatype:1,formula:1,valuetype:1,errors:1,comment:1,bt:2,br:2,bb:2,bl:2,layout:2,font:2,color:2,bgcolor:2,cellformat:2,nontextvalueformat:2,textvalueformat:2,colspan:2,rowspan:2,cssc:2,csss:2,mod:2,displaystring:3,// used to cache rendered HTML of cell contents\n\tparseinfo:3,// used to cache parsed formulas\n\thcolspan:3,hrowspan:3// spans taking hidden cols/rows into account (!!! NOT YET !!!)\n\t};SocialCalc.CellPropertiesTable={bt:\"borderstyle\",br:\"borderstyle\",bb:\"borderstyle\",bl:\"borderstyle\",layout:\"layout\",font:\"font\",color:\"color\",bgcolor:\"color\",cellformat:\"cellformat\",nontextvalueformat:\"valueformat\",textvalueformat:\"valueformat\"};// *************************************\n\t//\n\t// Sheet class:\n\t//\n\t// *************************************\n\t//\n\t// Class SocialCalc.Sheet\n\t//\n\t// Usage: var s = new SocialCalc.Sheet();\n\t//\n\tSocialCalc.Sheet=function(){SocialCalc.ResetSheet(this);// Set other values:\n\t//\n\t// sheet.statuscallback(data, status, arg, this.statuscallbackparams) is called\n\t// during recalc and commands.\n\t//\n\t// During recalc, data is the current recalcdata.\n\t// The values for status and the corresponding arg are:\n\t//\n\t//    calcorder, {coord: coord, total: celllist length, count: count} [0 or more times per recalc]\n\t//    calccheckdone, calclist length [once per recalc]\n\t//    calcstep, {coord: coord, total: calclist length, count: count} [0 or more times per recalc]\n\t//    calcloading, {sheetname: name-of-sheet}\n\t//    calcserverfunc, {funcname: name-of-function, coord: coord, total: calclist length, count: count}\n\t//    calcfinished, time in milliseconds [once per recalc]\n\t//\n\t// During commands, data is SocialCalc.SheetCommandInfo.\n\t// These values for status and arg are:\n\t//\n\t//    cmdstart, cmdstr\n\t//    cmdend\n\t//\n\tthis.statuscallback=null;// routine called with cmdstart, calcstart, etc., status and args:\n\t// sheet.statuscallback(data, status, arg, params)\n\tthis.statuscallbackparams=null;// parameters passed to that routine\n\t};//\n\t// SocialCalc.ResetSheet(sheet)\n\t//\n\t// Resets (and/or initializes) sheet data values.\n\t// \n\tSocialCalc.ResetSheet=function(sheet,reload){// properties:\n\tsheet.cells={};// at least one for each non-blank cell: coord: cell-object\n\tsheet.attribs=// sheet attributes\n\t{lastcol:1,lastrow:1,defaultlayout:0};sheet.rowattribs={hide:{},// access by row number\n\theight:{}};sheet.colattribs={width:{},// access by col name\n\thide:{}};sheet.names={};// Each is: {desc: \"optional description\", definition: \"B5, A1:B7, or =formula\"}\n\tsheet.layouts=[];sheet.layouthash={};sheet.fonts=[];sheet.fonthash={};sheet.colors=[];sheet.colorhash={};sheet.borderstyles=[];sheet.borderstylehash={};sheet.cellformats=[];sheet.cellformathash={};sheet.valueformats=[];sheet.valueformathash={};sheet.copiedfrom=\"\";// if a range, then this was loaded from a saved range as clipboard content\n\tsheet.changes=new SocialCalc.UndoStack();sheet.renderneeded=false;sheet.changedrendervalues=true;// if true, spans and/or fonts have changed (set by ExecuteSheetCommand & GetStyle)\n\tsheet.recalcchangedavalue=false;// true if a recalc resulted in a change to a cell's calculated value\n\t};// Methods:\n\tSocialCalc.Sheet.prototype.ResetSheet=function(){SocialCalc.ResetSheet(this);};SocialCalc.Sheet.prototype.AddCell=function(newcell){return this.cells[newcell.coord]=newcell;};SocialCalc.Sheet.prototype.GetAssuredCell=function(coord){return this.cells[coord]||this.AddCell(new SocialCalc.Cell(coord));};SocialCalc.Sheet.prototype.ParseSheetSave=function(savedsheet){SocialCalc.ParseSheetSave(savedsheet,this);};SocialCalc.Sheet.prototype.CellFromStringParts=function(cell,parts,j){return SocialCalc.CellFromStringParts(this,cell,parts,j);};SocialCalc.Sheet.prototype.CreateSheetSave=function(range,canonicalize){return SocialCalc.CreateSheetSave(this,range,canonicalize);};SocialCalc.Sheet.prototype.CellToString=function(cell){return SocialCalc.CellToString(this,cell);};SocialCalc.Sheet.prototype.CanonicalizeSheet=function(full){return SocialCalc.CanonicalizeSheet(this,full);};SocialCalc.Sheet.prototype.EncodeCellAttributes=function(coord){return SocialCalc.EncodeCellAttributes(this,coord);};SocialCalc.Sheet.prototype.EncodeSheetAttributes=function(){return SocialCalc.EncodeSheetAttributes(this);};SocialCalc.Sheet.prototype.DecodeCellAttributes=function(coord,attribs,range){return SocialCalc.DecodeCellAttributes(this,coord,attribs,range);};SocialCalc.Sheet.prototype.DecodeSheetAttributes=function(attribs){return SocialCalc.DecodeSheetAttributes(this,attribs);};SocialCalc.Sheet.prototype.ScheduleSheetCommands=function(cmd,saveundo,isRemote){return SocialCalc.ScheduleSheetCommands(this,cmd,saveundo,isRemote);};SocialCalc.Sheet.prototype.SheetUndo=function(){return SocialCalc.SheetUndo(this);};SocialCalc.Sheet.prototype.SheetRedo=function(){return SocialCalc.SheetRedo(this);};SocialCalc.Sheet.prototype.CreateAuditString=function(){return SocialCalc.CreateAuditString(this);};SocialCalc.Sheet.prototype.GetStyleNum=function(atype,style){return SocialCalc.GetStyleNum(this,atype,style);};SocialCalc.Sheet.prototype.GetStyleString=function(atype,num){return SocialCalc.GetStyleString(this,atype,num);};SocialCalc.Sheet.prototype.RecalcSheet=function(){return SocialCalc.RecalcSheet(this);};//\n\t// Sheet save format:\n\t//\n\t// linetype:param1:param2:...\n\t//\n\t// Linetypes are:\n\t//\n\t//    version:versionname - version of this format. Currently 1.4.\n\t//\n\t//    cell:coord:type:value...:type:value... - Types are as follows:\n\t//\n\t//       v:value - straight numeric value\n\t//       t:value - straight text/wiki-text in cell, encoded to handle \\, :, newlines\n\t//       vt:fulltype:value - value with value type/subtype\n\t//       vtf:fulltype:value:formulatext - formula resulting in value with value type/subtype, value and text encoded\n\t//       vtc:fulltype:value:valuetext - formatted text constant resulting in value with value type/subtype, value and text encoded\n\t//       vf:fvalue:formulatext - formula resulting in value, value and text encoded (obsolete: only pre format version 1.1)\n\t//          fvalue - first char is \"N\" for numeric value, \"T\" for text value, \"H\" for HTML value, rest is the value\n\t//       e:errortext - Error text. Non-blank means formula parsing/calculation results in error.\n\t//       b:topborder#:rightborder#:bottomborder#:leftborder# - border# in sheet border list or blank if none\n\t//       l:layout# - number in cell layout list\n\t//       f:font# - number in sheet fonts list\n\t//       c:color# - sheet color list index for text\n\t//       bg:color# - sheet color list index for background color\n\t//       cf:format# - sheet cell format number for explicit format (align:left, etc.)\n\t//       cvf:valueformat# - sheet cell value format number (obsolete: only pre format v1.2)\n\t//       tvf:valueformat# - sheet cell text value format number\n\t//       ntvf:valueformat# - sheet cell non-text value format number\n\t//       colspan:numcols - number of columns spanned in merged cell\n\t//       rowspan:numrows - number of rows spanned in merged cell\n\t//       cssc:classname - name of CSS class to be used for cell when published instead of one calculated here\n\t//       csss:styletext - explicit CSS style information, encoded to handle :, etc.\n\t//       mod:allow - if \"y\" allow modification of cell for live \"view\" recalc\n\t//       comment:value - encoded text of comment for this cell (added in v1.5)\n\t//\n\t//    col:\n\t//       w:widthval - number, \"auto\" (no width in <col> tag), number%, or blank (use default)\n\t//       hide: - yes/no, no is assumed if missing\n\t//    row:\n\t//       hide - yes/no, no is assumed if missing\n\t//\n\t//    sheet:\n\t//       c:lastcol - number\n\t//       r:lastrow - number\n\t//       w:defaultcolwidth - number, \"auto\", number%, or blank (default->80)\n\t//       h:defaultrowheight - not used\n\t//       tf:format# - cell format number for sheet default for text values\n\t//       ntf:format# - cell format number for sheet default for non-text values (i.e., numbers)\n\t//       layout:layout# - default cell layout number in cell layout list\n\t//       font:font# - default font number in sheet font list\n\t//       vf:valueformat# - default number value format number in sheet valueformat list (obsolete: only pre format version 1.2)\n\t//       ntvf:valueformat# - default non-text (number) value format number in sheet valueformat list\n\t//       tvf:valueformat# - default text value format number in sheet valueformat list\n\t//       color:color# - default number for text color in sheet color list\n\t//       bgcolor:color# - default number for background color in sheet color list\n\t//       circularreferencecell:coord - cell coord with a circular reference\n\t//       recalc:value - on/off (on is default). If not \"off\", appropriate changes to the sheet cause a recalc\n\t//       needsrecalc:value - yes/no (no is default). If \"yes\", formula values are not up to date\n\t//\n\t//    name:name:description:value - name definition, name in uppercase, with value being \"B5\", \"A1:B7\", or \"=formula\";\n\t//                                  description and value are encoded.\n\t//    font:fontnum:value - text of font definition (style weight size family) for font fontnum\n\t//                         \"*\" for \"style weight\", size, or family, means use default (first look to sheet, then builtin)\n\t//    color:colornum:rgbvalue - text of color definition (e.g., rgb(255,255,255)) for color colornum\n\t//    border:bordernum:value - text of border definition (thickness style color) for border bordernum\n\t//    layout:layoutnum:value - text of vertical alignment and padding style for cell layout layoutnum (* for default):\n\t//                             vertical-alignment:vavalue;padding:topval rightval bottomval leftval;\n\t//    cellformat:cformatnum:value - text of cell alignment (left/center/right) for cellformat cformatnum\n\t//    valueformat:vformatnum:value - text of number format (see FormatValueForDisplay) for valueformat vformatnum (changed in v1.2)\n\t//    clipboardrange:upperleftcoord:bottomrightcoord - ignored -- from wikiCalc\n\t//    clipboard:coord:type:value:... - ignored -- from wikiCalc\n\t//\n\t// If this is clipboard contents, then there is also information to facilitate pasting:\n\t//\n\t//    copiedfrom:upperleftcoord:bottomrightcoord - range from which this was copied\n\t//\n\t// Functions:\n\tSocialCalc.ParseSheetSave=function(savedsheet,sheetobj){var lines=savedsheet.split(/\\r\\n|\\n/);var parts=[];var line;var i,j,t,v,coord,cell,attribs,name;var scc=SocialCalc.Constants;for(i=0;i<lines.length;i++){line=lines[i];parts=line.split(\":\");switch(parts[0]){case\"cell\":cell=sheetobj.GetAssuredCell(parts[1]);j=2;sheetobj.CellFromStringParts(cell,parts,j);break;case\"col\":coord=parts[1];j=2;while(t=parts[j++]){switch(t){case\"w\":sheetobj.colattribs.width[coord]=parts[j++];// must be text - could be auto or %, etc.\n\tbreak;case\"hide\":sheetobj.colattribs.hide[coord]=parts[j++];break;default:throw scc.s_pssUnknownColType+\" '\"+t+\"'\";break;}}break;case\"row\":coord=parts[1]-0;j=2;while(t=parts[j++]){switch(t){case\"h\":sheetobj.rowattribs.height[coord]=parts[j++]-0;break;case\"hide\":sheetobj.rowattribs.hide[coord]=parts[j++];break;default:throw scc.s_pssUnknownRowType+\" '\"+t+\"'\";break;}}break;case\"sheet\":attribs=sheetobj.attribs;j=1;while(t=parts[j++]){switch(t){case\"c\":attribs.lastcol=parts[j++]-0;break;case\"r\":attribs.lastrow=parts[j++]-0;break;case\"w\":attribs.defaultcolwidth=parts[j++]+\"\";break;case\"h\":attribs.defaultrowheight=parts[j++]-0;break;case\"tf\":attribs.defaulttextformat=parts[j++]-0;break;case\"ntf\":attribs.defaultnontextformat=parts[j++]-0;break;case\"layout\":attribs.defaultlayout=parts[j++]-0;break;case\"font\":attribs.defaultfont=parts[j++]-0;break;case\"tvf\":attribs.defaulttextvalueformat=parts[j++]-0;break;case\"ntvf\":attribs.defaultnontextvalueformat=parts[j++]-0;break;case\"color\":attribs.defaultcolor=parts[j++]-0;break;case\"bgcolor\":attribs.defaultbgcolor=parts[j++]-0;break;case\"circularreferencecell\":attribs.circularreferencecell=parts[j++];break;case\"recalc\":attribs.recalc=parts[j++];break;case\"needsrecalc\":attribs.needsrecalc=parts[j++];break;default:j+=1;break;}}break;case\"name\":name=SocialCalc.decodeFromSave(parts[1]).toUpperCase();sheetobj.names[name]={desc:SocialCalc.decodeFromSave(parts[2])};sheetobj.names[name].definition=SocialCalc.decodeFromSave(parts[3]);break;case\"layout\":parts=lines[i].match(/^layout\\:(\\d+)\\:(.+)$/);// layouts can have \":\" in them\n\tsheetobj.layouts[parts[1]-0]=parts[2];sheetobj.layouthash[parts[2]]=parts[1]-0;break;case\"font\":sheetobj.fonts[parts[1]-0]=parts[2];sheetobj.fonthash[parts[2]]=parts[1]-0;break;case\"color\":sheetobj.colors[parts[1]-0]=parts[2];sheetobj.colorhash[parts[2]]=parts[1]-0;break;case\"border\":sheetobj.borderstyles[parts[1]-0]=parts[2];sheetobj.borderstylehash[parts[2]]=parts[1]-0;break;case\"cellformat\":v=SocialCalc.decodeFromSave(parts[2]);sheetobj.cellformats[parts[1]-0]=v;sheetobj.cellformathash[v]=parts[1]-0;break;case\"valueformat\":v=SocialCalc.decodeFromSave(parts[2]);sheetobj.valueformats[parts[1]-0]=v;sheetobj.valueformathash[v]=parts[1]-0;break;case\"version\":break;case\"copiedfrom\":sheetobj.copiedfrom=parts[1]+\":\"+parts[2];break;case\"clipboardrange\":// in save versions up to 1.3. Ignored.\n\tcase\"clipboard\":break;case\"\":break;default:alert(scc.s_pssUnknownLineType+\" '\"+parts[0]+\"'\");throw scc.s_pssUnknownLineType+\" '\"+parts[0]+\"'\";break;}parts=null;}};//\n\t// SocialCalc.CellFromStringParts(sheet, cell, parts, j)\n\t//\n\t// Takes string that has been split by \":\" in parts, starting at item j,\n\t// and fills in cell assuming save format.\n\t//\n\tSocialCalc.CellFromStringParts=function(sheet,cell,parts,j){var cell,t,v;while(t=parts[j++]){switch(t){case\"v\":cell.datavalue=SocialCalc.decodeFromSave(parts[j++])-0;cell.datatype=\"v\";cell.valuetype=\"n\";break;case\"t\":cell.datavalue=SocialCalc.decodeFromSave(parts[j++]);cell.datatype=\"t\";cell.valuetype=SocialCalc.Constants.textdatadefaulttype;break;case\"vt\":v=parts[j++];cell.valuetype=v;if(v.charAt(0)==\"n\"){cell.datatype=\"v\";cell.datavalue=SocialCalc.decodeFromSave(parts[j++])-0;}else{cell.datatype=\"t\";cell.datavalue=SocialCalc.decodeFromSave(parts[j++]);}break;case\"vtf\":v=parts[j++];cell.valuetype=v;if(v.charAt(0)==\"n\"){cell.datavalue=SocialCalc.decodeFromSave(parts[j++])-0;}else{cell.datavalue=SocialCalc.decodeFromSave(parts[j++]);}cell.formula=SocialCalc.decodeFromSave(parts[j++]);cell.datatype=\"f\";break;case\"vtc\":v=parts[j++];cell.valuetype=v;if(v.charAt(0)==\"n\"){cell.datavalue=SocialCalc.decodeFromSave(parts[j++])-0;}else{cell.datavalue=SocialCalc.decodeFromSave(parts[j++]);}cell.formula=SocialCalc.decodeFromSave(parts[j++]);cell.datatype=\"c\";break;case\"e\":cell.errors=SocialCalc.decodeFromSave(parts[j++]);break;case\"b\":cell.bt=parts[j++]-0;cell.br=parts[j++]-0;cell.bb=parts[j++]-0;cell.bl=parts[j++]-0;break;case\"l\":cell.layout=parts[j++]-0;break;case\"f\":cell.font=parts[j++]-0;break;case\"c\":cell.color=parts[j++]-0;break;case\"bg\":cell.bgcolor=parts[j++]-0;break;case\"cf\":cell.cellformat=parts[j++]-0;break;case\"ntvf\":cell.nontextvalueformat=parts[j++]-0;break;case\"tvf\":cell.textvalueformat=parts[j++]-0;break;case\"colspan\":cell.colspan=parts[j++]-0;break;case\"rowspan\":cell.rowspan=parts[j++]-0;break;case\"cssc\":cell.cssc=parts[j++];break;case\"csss\":cell.csss=SocialCalc.decodeFromSave(parts[j++]);break;case\"mod\":j+=1;break;case\"comment\":cell.comment=SocialCalc.decodeFromSave(parts[j++]);break;default:throw SocialCalc.Constants.s_cfspUnknownCellType+\" '\"+t+\"'\";break;}}};SocialCalc.sheetfields=[\"defaultrowheight\",\"defaultcolwidth\",\"circularreferencecell\",\"recalc\",\"needsrecalc\"];SocialCalc.sheetfieldsshort=[\"h\",\"w\",\"circularreferencecell\",\"recalc\",\"needsrecalc\"];SocialCalc.sheetfieldsxlat=[\"defaulttextformat\",\"defaultnontextformat\",\"defaulttextvalueformat\",\"defaultnontextvalueformat\",\"defaultcolor\",\"defaultbgcolor\",\"defaultfont\",\"defaultlayout\"];SocialCalc.sheetfieldsxlatshort=[\"tf\",\"ntf\",\"tvf\",\"ntvf\",\"color\",\"bgcolor\",\"font\",\"layout\"];SocialCalc.sheetfieldsxlatxlt=[\"cellformat\",\"cellformat\",\"valueformat\",\"valueformat\",\"color\",\"color\",\"font\",\"layout\"];//\n\t// sheetstr = SocialCalc.CreateSheetSave(sheetobj, range, canonicalize)\n\t//\n\t// Creates a text representation of the sheetobj data.\n\t// If the range is present then only those cells are saved\n\t// (as clipboard data with \"copiedfrom\" set).\n\t//\n\tSocialCalc.CreateSheetSave=function(sheetobj,range,canonicalize){var cell,cr1,cr2,row,col,coord,attrib,line,value,formula,i,t,r,b,l,name,blanklen;var result=[];var prange;sheetobj.CanonicalizeSheet(canonicalize||SocialCalc.Constants.doCanonicalizeSheet);var xlt=sheetobj.xlt;if(range){prange=SocialCalc.ParseRange(range);}else{prange={cr1:{row:1,col:1},cr2:{row:xlt.maxrow,col:xlt.maxcol}};}cr1=prange.cr1;cr2=prange.cr2;result.push(\"version:1.5\");for(row=cr1.row;row<=cr2.row;row++){for(col=cr1.col;col<=cr2.col;col++){coord=SocialCalc.crToCoord(col,row);cell=sheetobj.cells[coord];if(!cell)continue;line=sheetobj.CellToString(cell);if(line.length==0)continue;// ignore completely empty cells\n\tline=\"cell:\"+coord+line;result.push(line);}}for(col=1;col<=xlt.maxcol;col++){coord=SocialCalc.rcColname(col);if(sheetobj.colattribs.width[coord])result.push(\"col:\"+coord+\":w:\"+sheetobj.colattribs.width[coord]);if(sheetobj.colattribs.hide[coord])result.push(\"col:\"+coord+\":hide:\"+sheetobj.colattribs.hide[coord]);}for(row=1;row<=xlt.maxrow;row++){if(sheetobj.rowattribs.height[row])result.push(\"row:\"+row+\":h:\"+sheetobj.rowattribs.height[row]);if(sheetobj.rowattribs.hide[row])result.push(\"row:\"+row+\":hide:\"+sheetobj.rowattribs.hide[row]);}line=\"sheet:c:\"+xlt.maxcol+\":r:\"+xlt.maxrow;for(i=0;i<SocialCalc.sheetfields.length;i++){// non-xlated values\n\tvalue=SocialCalc.encodeForSave(sheetobj.attribs[SocialCalc.sheetfields[i]]);if(value)line+=\":\"+SocialCalc.sheetfieldsshort[i]+\":\"+value;}for(i=0;i<SocialCalc.sheetfieldsxlat.length;i++){// xlated values\n\tvalue=sheetobj.attribs[SocialCalc.sheetfieldsxlat[i]];if(value)line+=\":\"+SocialCalc.sheetfieldsxlatshort[i]+\":\"+xlt[SocialCalc.sheetfieldsxlatxlt[i]+\"sxlat\"][value];}result.push(line);for(i=1;i<xlt.newborderstyles.length;i++){result.push(\"border:\"+i+\":\"+xlt.newborderstyles[i]);}for(i=1;i<xlt.newcellformats.length;i++){result.push(\"cellformat:\"+i+\":\"+SocialCalc.encodeForSave(xlt.newcellformats[i]));}for(i=1;i<xlt.newcolors.length;i++){result.push(\"color:\"+i+\":\"+xlt.newcolors[i]);}for(i=1;i<xlt.newfonts.length;i++){result.push(\"font:\"+i+\":\"+xlt.newfonts[i]);}for(i=1;i<xlt.newlayouts.length;i++){result.push(\"layout:\"+i+\":\"+xlt.newlayouts[i]);}for(i=1;i<xlt.newvalueformats.length;i++){result.push(\"valueformat:\"+i+\":\"+SocialCalc.encodeForSave(xlt.newvalueformats[i]));}for(i=0;i<xlt.namesorder.length;i++){name=xlt.namesorder[i];result.push(\"name:\"+SocialCalc.encodeForSave(name).toUpperCase()+\":\"+SocialCalc.encodeForSave(sheetobj.names[name].desc)+\":\"+SocialCalc.encodeForSave(sheetobj.names[name].definition));}if(range){result.push(\"copiedfrom:\"+SocialCalc.crToCoord(cr1.col,cr1.row)+\":\"+SocialCalc.crToCoord(cr2.col,cr2.row));}result.push(\"\");// one extra to get extra \\n\n\tdelete sheetobj.xlt;// clean up\n\treturn result.join(\"\\n\");};//\n\t// line = SocialCalc.CellToString(sheet, cell)\n\t//\n\tSocialCalc.CellToString=function(sheet,cell){var cell,line,value,formula,t,r,b,l,xlt;line=\"\";if(!cell)return line;value=SocialCalc.encodeForSave(cell.datavalue);if(cell.datatype==\"v\"){if(cell.valuetype==\"n\")line+=\":v:\"+value;else line+=\":vt:\"+cell.valuetype+\":\"+value;}else if(cell.datatype==\"t\"){if(cell.valuetype==SocialCalc.Constants.textdatadefaulttype)line+=\":t:\"+value;else line+=\":vt:\"+cell.valuetype+\":\"+value;}else{formula=SocialCalc.encodeForSave(cell.formula);if(cell.datatype==\"f\"){line+=\":vtf:\"+cell.valuetype+\":\"+value+\":\"+formula;}else if(cell.datatype==\"c\"){line+=\":vtc:\"+cell.valuetype+\":\"+value+\":\"+formula;}}if(cell.errors){line+=\":e:\"+SocialCalc.encodeForSave(cell.errors);}t=cell.bt||\"\";r=cell.br||\"\";b=cell.bb||\"\";l=cell.bl||\"\";if(sheet.xlt){// if have canonical save info\n\txlt=sheet.xlt;if(t||r||b||l)line+=\":b:\"+xlt.borderstylesxlat[t||0]+\":\"+xlt.borderstylesxlat[r||0]+\":\"+xlt.borderstylesxlat[b||0]+\":\"+xlt.borderstylesxlat[l||0];if(cell.layout)line+=\":l:\"+xlt.layoutsxlat[cell.layout];if(cell.font)line+=\":f:\"+xlt.fontsxlat[cell.font];if(cell.color)line+=\":c:\"+xlt.colorsxlat[cell.color];if(cell.bgcolor)line+=\":bg:\"+xlt.colorsxlat[cell.bgcolor];if(cell.cellformat)line+=\":cf:\"+xlt.cellformatsxlat[cell.cellformat];if(cell.textvalueformat)line+=\":tvf:\"+xlt.valueformatsxlat[cell.textvalueformat];if(cell.nontextvalueformat)line+=\":ntvf:\"+xlt.valueformatsxlat[cell.nontextvalueformat];}else{if(t||r||b||l)line+=\":b:\"+t+\":\"+r+\":\"+b+\":\"+l;if(cell.layout)line+=\":l:\"+cell.layout;if(cell.font)line+=\":f:\"+cell.font;if(cell.color)line+=\":c:\"+cell.color;if(cell.bgcolor)line+=\":bg:\"+cell.bgcolor;if(cell.cellformat)line+=\":cf:\"+cell.cellformat;if(cell.textvalueformat)line+=\":tvf:\"+cell.textvalueformat;if(cell.nontextvalueformat)line+=\":ntvf:\"+cell.nontextvalueformat;}if(cell.colspan)line+=\":colspan:\"+cell.colspan;if(cell.rowspan)line+=\":rowspan:\"+cell.rowspan;if(cell.cssc)line+=\":cssc:\"+cell.cssc;if(cell.csss)line+=\":csss:\"+SocialCalc.encodeForSave(cell.csss);if(cell.mod)line+=\":mod:\"+cell.mod;if(cell.comment)line+=\":comment:\"+SocialCalc.encodeForSave(cell.comment);return line;};//\n\t// SocialCalc.CanonicalizeSheet(sheetobj, full)\n\t//\n\t// Goes through the sheet and fills in sheetobj.xlt with the following:\n\t//\n\t//   .maxrow, .maxcol - lastrow and lastcol are as small as possible\n\t//   .newlayouts - new version of sheetobj.layouts without unused ones and all in ascending order\n\t//   .layoutsxlat - maps old layouts index to new one\n\t//   same \".new\" and \".xlat\" for fonts, colors, borderstyles, cell and value formats\n\t//   .namesorder - array with names sorted\n\t//\n\t// If full or SocialCalc.Constants.doCanonicalizeSheet are not true, then the values will leave things unchanged (to save time, etc.)\n\t//\n\t// sheetobj.xlt should be deleted when you are finished using it\n\t//\n\tSocialCalc.CanonicalizeSheet=function(sheetobj,full){var l,coord,cr,cell,filled,an,a,newa,newxlat,used,ahash,i,v;var maxrow=0;var maxcol=0;var alist=[\"borderstyle\",\"cellformat\",\"color\",\"font\",\"layout\",\"valueformat\"];var xlt={};xlt.namesorder=[];// always return a sorted list\n\tfor(a in sheetobj.names){xlt.namesorder.push(a);}xlt.namesorder.sort();if(!SocialCalc.Constants.doCanonicalizeSheet||!full){// return make-no-changes values if not wanted\n\tfor(an=0;an<alist.length;an++){a=alist[an];xlt[\"new\"+a+\"s\"]=sheetobj[a+\"s\"];l=sheetobj[a+\"s\"].length;newxlat=new Array(l);newxlat[0]=\"\";for(i=1;i<l;i++){newxlat[i]=i;}xlt[a+\"sxlat\"]=newxlat;}xlt.maxrow=sheetobj.attribs.lastrow;xlt.maxcol=sheetobj.attribs.lastcol;sheetobj.xlt=xlt;return;}for(an=0;an<alist.length;an++){a=alist[an];xlt[a+\"sUsed\"]={};}var colorsUsed=xlt.colorsUsed;var borderstylesUsed=xlt.borderstylesUsed;var fontsUsed=xlt.fontsUsed;var layoutsUsed=xlt.layoutsUsed;var cellformatsUsed=xlt.cellformatsUsed;var valueformatsUsed=xlt.valueformatsUsed;for(coord in sheetobj.cells){// check all cells to see which values are used\n\tcr=SocialCalc.coordToCr(coord);cell=sheetobj.cells[coord];filled=false;if(cell.valuetype&&cell.valuetype!=\"b\")filled=true;if(cell.color){colorsUsed[cell.color]=1;filled=true;}if(cell.bgcolor){colorsUsed[cell.bgcolor]=1;filled=true;}if(cell.bt){borderstylesUsed[cell.bt]=1;filled=true;}if(cell.br){borderstylesUsed[cell.br]=1;filled=true;}if(cell.bb){borderstylesUsed[cell.bb]=1;filled=true;}if(cell.bl){borderstylesUsed[cell.bl]=1;filled=true;}if(cell.layout){layoutsUsed[cell.layout]=1;filled=true;}if(cell.font){fontsUsed[cell.font]=1;filled=true;}if(cell.cellformat){cellformatsUsed[cell.cellformat]=1;filled=true;}if(cell.textvalueformat){valueformatsUsed[cell.textvalueformat]=1;filled=true;}if(cell.nontextvalueformat){valueformatsUsed[cell.nontextvalueformat]=1;filled=true;}if(filled){if(cr.row>maxrow)maxrow=cr.row;if(cr.col>maxcol)maxcol=cr.col;}}for(i=0;i<SocialCalc.sheetfieldsxlat.length;i++){// do sheet values, too\n\tv=sheetobj.attribs[SocialCalc.sheetfieldsxlat[i]];if(v){xlt[SocialCalc.sheetfieldsxlatxlt[i]+\"sUsed\"][v]=1;}}a={\"height\":1,\"hide\":1};// look at explicit row settings\n\tfor(v in a){for(cr in sheetobj.rowattribs[v]){if(cr>maxrow)maxrow=cr;}}a={\"hide\":1,\"width\":1};// look at explicit col settings\n\tfor(v in a){for(coord in sheetobj.colattribs[v]){cr=SocialCalc.coordToCr(coord+\"1\");if(cr.col>maxcol)maxcol=cr.col;}}for(an=0;an<alist.length;an++){// go through the attribs we want\n\ta=alist[an];newa=[];used=xlt[a+\"sUsed\"];for(v in used){newa.push(sheetobj[a+\"s\"][v]);}newa.sort();newa.unshift(\"\");newxlat=[\"\"];ahash=sheetobj[a+\"hash\"];for(i=1;i<newa.length;i++){newxlat[ahash[newa[i]]]=i;}xlt[a+\"sxlat\"]=newxlat;xlt[\"new\"+a+\"s\"]=newa;}xlt.maxrow=maxrow||1;xlt.maxcol=maxcol||1;sheetobj.xlt=xlt;// leave for use by caller\n\t};//\n\t// result = SocialCalc.EncodeCellAttributes(sheet, coord)\n\t//\n\t// Returns the cell's attributes in an object, each in the following form:\n\t//\n\t//    attribname: {def: true/false, val: full-value}\n\t//\n\tSocialCalc.EncodeCellAttributes=function(sheet,coord){var value,i,b,bb,parts;var result={};var InitAttrib=function InitAttrib(name){result[name]={def:true,val:\"\"};};var InitAttribs=function InitAttribs(namelist){for(var i=0;i<namelist.length;i++){InitAttrib(namelist[i]);}};var SetAttrib=function SetAttrib(name,v){result[name].def=false;result[name].val=v||\"\";};var SetAttribStar=function SetAttribStar(name,v){if(v==\"*\")return;result[name].def=false;result[name].val=v;};var cell=sheet.GetAssuredCell(coord);// cellformat: alignhoriz\n\tInitAttrib(\"alignhoriz\");if(cell.cellformat){SetAttrib(\"alignhoriz\",sheet.cellformats[cell.cellformat]);}// layout: alignvert, padtop, padright, padbottom, padleft\n\tInitAttribs([\"alignvert\",\"padtop\",\"padright\",\"padbottom\",\"padleft\"]);if(cell.layout){parts=sheet.layouts[cell.layout].match(/^padding:\\s*(\\S+)\\s+(\\S+)\\s+(\\S+)\\s+(\\S+);vertical-align:\\s*(\\S+);/);SetAttribStar(\"padtop\",parts[1]);SetAttribStar(\"padright\",parts[2]);SetAttribStar(\"padbottom\",parts[3]);SetAttribStar(\"padleft\",parts[4]);SetAttribStar(\"alignvert\",parts[5]);}// font: fontfamily, fontlook, fontsize\n\tInitAttribs([\"fontfamily\",\"fontlook\",\"fontsize\"]);if(cell.font){parts=sheet.fonts[cell.font].match(/^(\\*|\\S+? \\S+?) (\\S+?) (\\S.*)$/);SetAttribStar(\"fontfamily\",parts[3]);SetAttribStar(\"fontsize\",parts[2]);SetAttribStar(\"fontlook\",parts[1]);}// color: textcolor\n\tInitAttrib(\"textcolor\");if(cell.color){SetAttrib(\"textcolor\",sheet.colors[cell.color]);}// bgcolor: bgcolor\n\tInitAttrib(\"bgcolor\");if(cell.bgcolor){SetAttrib(\"bgcolor\",sheet.colors[cell.bgcolor]);}// formatting: numberformat, textformat\n\tInitAttribs([\"numberformat\",\"textformat\"]);if(cell.nontextvalueformat){SetAttrib(\"numberformat\",sheet.valueformats[cell.nontextvalueformat]);}if(cell.textvalueformat){SetAttrib(\"textformat\",sheet.valueformats[cell.textvalueformat]);}// merges: colspan, rowspan\n\tInitAttribs([\"colspan\",\"rowspan\"]);SetAttrib(\"colspan\",cell.colspan||1);SetAttrib(\"rowspan\",cell.rowspan||1);// borders: bXthickness, bXstyle, bXcolor for X = t, r, b, and l\n\tfor(i=0;i<4;i++){b=\"trbl\".charAt(i);bb=\"b\"+b;InitAttrib(bb);SetAttrib(bb,cell[bb]?sheet.borderstyles[cell[bb]]:\"\");InitAttrib(bb+\"thickness\");InitAttrib(bb+\"style\");InitAttrib(bb+\"color\");if(cell[bb]){parts=sheet.borderstyles[cell[bb]].match(/(\\S+)\\s+(\\S+)\\s+(\\S.+)/);SetAttrib(bb+\"thickness\",parts[1]);SetAttrib(bb+\"style\",parts[2]);SetAttrib(bb+\"color\",parts[3]);}}// misc: cssc, csss, mod\n\tInitAttribs([\"cssc\",\"csss\",\"mod\"]);SetAttrib(\"cssc\",cell.cssc||\"\");SetAttrib(\"csss\",cell.csss||\"\");SetAttrib(\"mod\",cell.mod||\"n\");return result;};//\n\t// result = SocialCalc.EncodeSheetAttributes(sheet)\n\t//\n\t// Returns the sheet's attributes in an object, each in the following form:\n\t//\n\t//    attribname: {def: true/false, val: full-value}\n\t//\n\tSocialCalc.EncodeSheetAttributes=function(sheet){var value;var attribs=sheet.attribs;var result={};var InitAttrib=function InitAttrib(name){result[name]={def:true,val:\"\"};};var InitAttribs=function InitAttribs(namelist){for(var i=0;i<namelist.length;i++){InitAttrib(namelist[i]);}};var SetAttrib=function SetAttrib(name,v){result[name].def=false;result[name].val=v||value;};var SetAttribStar=function SetAttribStar(name,v){if(v==\"*\")return;result[name].def=false;result[name].val=v;};// sizes: colwidth, rowheight\n\tInitAttrib(\"colwidth\");if(attribs.defaultcolwidth){SetAttrib(\"colwidth\",attribs.defaultcolwidth);}InitAttrib(\"rowheight\");if(attribs.rowheight){SetAttrib(\"rowheight\",attribs.defaultrowheight);}// cellformat: textalignhoriz, numberalignhoriz\n\tInitAttrib(\"textalignhoriz\");if(attribs.defaulttextformat){SetAttrib(\"textalignhoriz\",sheet.cellformats[attribs.defaulttextformat]);}InitAttrib(\"numberalignhoriz\");if(attribs.defaultnontextformat){SetAttrib(\"numberalignhoriz\",sheet.cellformats[attribs.defaultnontextformat]);}// layout: alignvert, padtop, padright, padbottom, padleft\n\tInitAttribs([\"alignvert\",\"padtop\",\"padright\",\"padbottom\",\"padleft\"]);if(attribs.defaultlayout){parts=sheet.layouts[attribs.defaultlayout].match(/^padding:\\s*(\\S+)\\s+(\\S+)\\s+(\\S+)\\s+(\\S+);vertical-align:\\s*(\\S+);/);SetAttribStar(\"padtop\",parts[1]);SetAttribStar(\"padright\",parts[2]);SetAttribStar(\"padbottom\",parts[3]);SetAttribStar(\"padleft\",parts[4]);SetAttribStar(\"alignvert\",parts[5]);}// font: fontfamily, fontlook, fontsize\n\tInitAttribs([\"fontfamily\",\"fontlook\",\"fontsize\"]);if(attribs.defaultfont){parts=sheet.fonts[attribs.defaultfont].match(/^(\\*|\\S+? \\S+?) (\\S+?) (\\S.*)$/);SetAttribStar(\"fontfamily\",parts[3]);SetAttribStar(\"fontsize\",parts[2]);SetAttribStar(\"fontlook\",parts[1]);}// color: textcolor\n\tInitAttrib(\"textcolor\");if(attribs.defaultcolor){SetAttrib(\"textcolor\",sheet.colors[attribs.defaultcolor]);}// bgcolor: bgcolor\n\tInitAttrib(\"bgcolor\");if(attribs.defaultbgcolor){SetAttrib(\"bgcolor\",sheet.colors[attribs.defaultbgcolor]);}// formatting: numberformat, textformat\n\tInitAttribs([\"numberformat\",\"textformat\"]);if(attribs.defaultnontextvalueformat){SetAttrib(\"numberformat\",sheet.valueformats[attribs.defaultnontextvalueformat]);}if(attribs.defaulttextvalueformat){SetAttrib(\"textformat\",sheet.valueformats[attribs.defaulttextvalueformat]);}// recalc: recalc\n\tInitAttrib(\"recalc\");if(attribs.recalc){SetAttrib(\"recalc\",attribs.recalc);}return result;};//\n\t// cmdstr = SocialCalc.DecodeCellAttributes(sheet, coord, attribs, range)\n\t//\n\t// Takes cell attributes in an object, each in the following form:\n\t//\n\t//    attribname: {def: true/false, val: full-value}\n\t//\n\t// and returns the sheet commands to make the actual attributes correspond.\n\t// Returns a non-null string if any commands are to be executed, null otherwise.\n\t//\n\t// If range is provided, the commands are executed on the whole range.\n\t//\n\tSocialCalc.DecodeCellAttributes=function(sheet,coord,newattribs,range){var value,b,bb;var cell=sheet.GetAssuredCell(coord);var changed=false;var CheckChanges=function CheckChanges(attribname,oldval,cmdname){var val;if(newattribs[attribname]){if(newattribs[attribname].def){val=\"\";}else{val=newattribs[attribname].val;}if(val!=(oldval||\"\")){DoCmd(cmdname+\" \"+val);}}};var cmdstr=\"\";var DoCmd=function DoCmd(str){if(cmdstr)cmdstr+=\"\\n\";cmdstr+=\"set \"+(range||coord)+\" \"+str;changed=true;};// cellformat: alignhoriz\n\tCheckChanges(\"alignhoriz\",sheet.cellformats[cell.cellformat],\"cellformat\");// layout: alignvert, padtop, padright, padbottom, padleft\n\tif(!newattribs.alignvert.def||!newattribs.padtop.def||!newattribs.padright.def||!newattribs.padbottom.def||!newattribs.padleft.def){value=\"padding:\"+(newattribs.padtop.def?\"* \":newattribs.padtop.val+\" \")+(newattribs.padright.def?\"* \":newattribs.padright.val+\" \")+(newattribs.padbottom.def?\"* \":newattribs.padbottom.val+\" \")+(newattribs.padleft.def?\"*\":newattribs.padleft.val)+\";vertical-align:\"+(newattribs.alignvert.def?\"*;\":newattribs.alignvert.val+\";\");}else{value=\"\";}if(value!=(sheet.layouts[cell.layout]||\"\")){DoCmd(\"layout \"+value);}// font: fontfamily, fontlook, fontsize\n\tif(!newattribs.fontlook.def||!newattribs.fontsize.def||!newattribs.fontfamily.def){value=(newattribs.fontlook.def?\"* \":newattribs.fontlook.val+\" \")+(newattribs.fontsize.def?\"* \":newattribs.fontsize.val+\" \")+(newattribs.fontfamily.def?\"*\":newattribs.fontfamily.val);}else{value=\"\";}if(value!=(sheet.fonts[cell.font]||\"\")){DoCmd(\"font \"+value);}// color: textcolor\n\tCheckChanges(\"textcolor\",sheet.colors[cell.color],\"color\");// bgcolor: bgcolor\n\tCheckChanges(\"bgcolor\",sheet.colors[cell.bgcolor],\"bgcolor\");// formatting: numberformat, textformat\n\tCheckChanges(\"numberformat\",sheet.valueformats[cell.nontextvalueformat],\"nontextvalueformat\");CheckChanges(\"textformat\",sheet.valueformats[cell.textvalueformat],\"textvalueformat\");// merges: colspan, rowspan - NOT HANDLED: IGNORED!\n\t// borders: bX for X = t, r, b, and l; bXthickness, bXstyle, bXcolor ignored\n\tfor(var i=0;i<4;i++){b=\"trbl\".charAt(i);bb=\"b\"+b;CheckChanges(bb,sheet.borderstyles[cell[bb]],bb);}// misc: cssc, csss, mod\n\tCheckChanges(\"cssc\",cell.cssc,\"cssc\");CheckChanges(\"csss\",cell.csss,\"csss\");if(newattribs.mod){if(newattribs.mod.def){value=\"n\";}else{value=newattribs.mod.val;}if(value!=(cell.mod||\"n\")){if(value==\"n\")value=\"\";// restrict to \"y\" and \"\" normally\n\tDoCmd(\"mod \"+value);}}// if any changes return command(s)\n\tif(changed){return cmdstr;}else{return null;}};//\n\t// changed = SocialCalc.DecodeSheetAttributes(sheet, newattribs)\n\t//\n\t// Takes sheet attributes in an object, each in the following form:\n\t//\n\t//    attribname: {def: true/false, val: full-value}\n\t//\n\t// and returns the sheet commands to make the actual attributes correspond.\n\t// Returns a non-null string if any commands were executed, null otherwise.\n\t//\n\tSocialCalc.DecodeSheetAttributes=function(sheet,newattribs){var value;var attribs=sheet.attribs;var changed=false;var CheckChanges=function CheckChanges(attribname,oldval,cmdname){var val;if(newattribs[attribname]){if(newattribs[attribname].def){val=\"\";}else{val=newattribs[attribname].val;}if(val!=(oldval||\"\")){DoCmd(cmdname+\" \"+val);}}};var cmdstr=\"\";var DoCmd=function DoCmd(str){if(cmdstr)cmdstr+=\"\\n\";cmdstr+=\"set sheet \"+str;changed=true;};// sizes: colwidth, rowheight\n\tCheckChanges(\"colwidth\",attribs.defaultcolwidth,\"defaultcolwidth\");CheckChanges(\"rowheight\",attribs.defaultrowheight,\"defaultrowheight\");// cellformat: textalignhoriz, numberalignhoriz\n\tCheckChanges(\"textalignhoriz\",sheet.cellformats[attribs.defaulttextformat],\"defaulttextformat\");CheckChanges(\"numberalignhoriz\",sheet.cellformats[attribs.defaultnontextformat],\"defaultnontextformat\");// layout: alignvert, padtop, padright, padbottom, padleft\n\tif(!newattribs.alignvert.def||!newattribs.padtop.def||!newattribs.padright.def||!newattribs.padbottom.def||!newattribs.padleft.def){value=\"padding:\"+(newattribs.padtop.def?\"* \":newattribs.padtop.val+\" \")+(newattribs.padright.def?\"* \":newattribs.padright.val+\" \")+(newattribs.padbottom.def?\"* \":newattribs.padbottom.val+\" \")+(newattribs.padleft.def?\"*\":newattribs.padleft.val)+\";vertical-align:\"+(newattribs.alignvert.def?\"*;\":newattribs.alignvert.val+\";\");}else{value=\"\";}if(value!=(sheet.layouts[attribs.defaultlayout]||\"\")){DoCmd(\"defaultlayout \"+value);}// font: fontfamily, fontlook, fontsize\n\tif(!newattribs.fontlook.def||!newattribs.fontsize.def||!newattribs.fontfamily.def){value=(newattribs.fontlook.def?\"* \":newattribs.fontlook.val+\" \")+(newattribs.fontsize.def?\"* \":newattribs.fontsize.val+\" \")+(newattribs.fontfamily.def?\"*\":newattribs.fontfamily.val);}else{value=\"\";}if(value!=(sheet.fonts[attribs.defaultfont]||\"\")){DoCmd(\"defaultfont \"+value);}// color: textcolor\n\tCheckChanges(\"textcolor\",sheet.colors[attribs.defaultcolor],\"defaultcolor\");// bgcolor: bgcolor\n\tCheckChanges(\"bgcolor\",sheet.colors[attribs.defaultbgcolor],\"defaultbgcolor\");// formatting: numberformat, textformat\n\tCheckChanges(\"numberformat\",sheet.valueformats[attribs.defaultnontextvalueformat],\"defaultnontextvalueformat\");CheckChanges(\"textformat\",sheet.valueformats[attribs.defaulttextvalueformat],\"defaulttextvalueformat\");// recalc: recalc\n\tCheckChanges(\"recalc\",sheet.attribs.recalc,\"recalc\");// if any changes return command(s)\n\tif(changed){return cmdstr;}else{return null;}};// *************************************\n\t//\n\t// Sheet command routines\n\t//\n\t// *************************************\n\t//\n\t// SocialCalc.SheetCommandInfo - object with information used during command execution\n\t//\n\tSocialCalc.SheetCommandInfo={// only one of these\n\tsheetobj:null,// sheet being operated on\n\tparseobj:null,// SocialCalc.Parse object with the command string, etc.\n\ttimerobj:null,// used for timeslicing\n\tfirsttimerdelay:50,// wait before starting cmds (for Chrome - to give time to update)\n\ttimerdelay:1,// wait between slices\n\tmaxtimeslice:100,// do another slice after this many milliseconds\n\tsaveundo:false,// arg for ExecuteSheetCommand\n\tCmdExtensionCallbacks:{},// for startcmdextension, in form: cmdname, {func:function(cmdname, data, sheet, SocialCalc.Parse object, saveundo), data:whatever}\n\tcmdextensionbusy:\"\"// if length>0, command loop waits for SocialCalc.ResumeFromCmdExtension()\n\t//   statuscallback: null, // called during execution - obsolete: use sheet obj's\n\t//   statuscallbackparams: null\n\t};//\n\t// SocialCalc.ScheduleSheetCommands\n\t//\n\t// statuscallback is called at the beginning (cmdstart) and end (cmdend).\n\t//\n\tSocialCalc.ScheduleSheetCommands=function(sheet,cmdstr,saveundo,isRemote){if(SocialCalc.Callbacks.broadcast&&!isRemote){if(cmdstr!='redisplay'&&cmdstr!='set sheet defaulttextvalueformat text-wiki'&&cmdstr!='recalc'){SocialCalc.Callbacks.broadcast('execute',{cmdtype:\"scmd\",id:sheet.sheetid,cmdstr:cmdstr,saveundo:saveundo});}}var sci=SocialCalc.SheetCommandInfo;sci.sheetobj=sheet;sci.parseobj=new SocialCalc.Parse(cmdstr);sci.saveundo=saveundo;if(sci.sheetobj.statuscallback){// notify others if requested\n\tsheet.statuscallback(sci,\"cmdstart\",\"\",sci.sheetobj.statuscallbackparams);}if(sci.saveundo){sci.sheetobj.changes.PushChange(\"\");// add a step to undo stack\n\t}sci.timerobj=window.setTimeout(SocialCalc.SheetCommandsTimerRoutine,sci.firsttimerdelay);};SocialCalc.SheetCommandsTimerRoutine=function(){var errortext;var sci=SocialCalc.SheetCommandInfo;var starttime=new Date();sci.timerobj=null;while(!sci.parseobj.EOF()){// go through all commands (separated by newlines)\n\terrortext=SocialCalc.ExecuteSheetCommand(sci.sheetobj,sci.parseobj,sci.saveundo);if(errortext)alert(errortext);sci.parseobj.NextLine();if(sci.cmdextensionbusy.length>0){// forced wait\n\tif(sci.sheetobj.statuscallback){// notify others if requested\n\tsci.sheetobj.statuscallback(sci,\"cmdextension\",sci.cmdextensionbusy,sci.sheetobj.statuscallbackparams);}return;}if(new Date()-starttime>=sci.maxtimeslice){// if taking too long, give up CPU for a while\n\tsci.timerobj=window.setTimeout(SocialCalc.SheetCommandsTimerRoutine,sci.timerdelay);return;}}if(sci.sheetobj.statuscallback){// notify others if requested\n\tsci.sheetobj.statuscallback(sci,\"cmdend\",\"\",sci.sheetobj.statuscallbackparams);}};SocialCalc.ResumeFromCmdExtension=function(){var sci=SocialCalc.SheetCommandInfo;sci.cmdextensionbusy=\"\";SocialCalc.SheetCommandsTimerRoutine();};//\n\t// errortext = SocialCalc.ExecuteSheetCommand(sheet, cmd, saveundo)\n\t//\n\t// cmd is a SocialCalc.Parse object.\n\t//\n\t// Executes commands that modify the sheet data.\n\t// Sets sheet \"needsrecalc\" as needed.\n\t// Sets sheet \"changedrendervalues\" as needed.\n\t//\n\t// The cmd string may be multiple commands, separated by newlines. In that case\n\t// only one \"step\" is put on the undo stack representing all the commands.\n\t// Note that because of this, in \"set A1 text ...\" and \"set A1 comment ...\" text is\n\t// treated as encoded (newline => \\n, \\ => \\b, : => \\c).\n\t//\n\t// The commands are in the forms:\n\t//\n\t//    set sheet attributename value (plus lastcol and lastrow)\n\t//    set 22 attributename value\n\t//    set B attributename value\n\t//    set A1 attributename value1 value2... (see each attribute in code for details)\n\t//    set A1:B5 attributename value1 value2...\n\t//    erase/copy/cut/paste/fillright/filldown A1:B5 all/formulas/format\n\t//    loadclipboard save-encoded-clipboard-data\n\t//    clearclipboard\n\t//    merge C3:F3\n\t//    unmerge C3\n\t//    insertcol/insertrow C5\n\t//    deletecol/deleterow C5:E7\n\t//    movepaste/moveinsert A1:B5 A8 all/formulas/format (if insert, destination must be in same rows or columns or else paste done)\n\t//    sort cr1:cr2 col1 up/down col2 up/down col3 up/down\n\t//    name define NAME definition\n\t//    name desc NAME description\n\t//    name delete NAME\n\t//    recalc\n\t//    redisplay\n\t//    changedrendervalues\n\t//    startcmdextension extension rest-of-command\n\t//\n\t// If saveundo is true, then undo information is saved in sheet.changes.\n\t//\n\tSocialCalc.ExecuteSheetCommand=function(sheet,cmd,saveundo){var cmdstr,cmd1,rest,what,attrib,num,pos,pos2,errortext,undostart,val;var cr1,cr2,col,row,cr,cell,newcell;var fillright,rowstart,colstart,crbase,rowoffset,coloffset,basecell;var clipsheet,cliprange,numcols,numrows,attribtable;var colend,rowend,newcolstart,newrowstart,newcolend,newrowend,rownext,colnext,colthis,cellnext;var lastrow,lastcol,rowbefore,colbefore,oldformula,oldcr;var cols,dirs,lastsortcol,i,sortlist,sortcells,sortvalues,sorttypes;var sortfunction,slen,valtype,originalrow,sortedcr;var name,v1,v2;var cmdextension;var attribs=sheet.attribs;var changes=sheet.changes;var cellProperties=SocialCalc.CellProperties;var scc=SocialCalc.Constants;var ParseRange=function ParseRange(){var prange=SocialCalc.ParseRange(what);cr1=prange.cr1;cr2=prange.cr2;if(cr2.col>attribs.lastcol)attribs.lastcol=cr2.col;if(cr2.row>attribs.lastrow)attribs.lastrow=cr2.row;};errortext=\"\";cmdstr=cmd.RestOfStringNoMove();if(saveundo){sheet.changes.AddDo(cmdstr);}cmd1=cmd.NextToken();switch(cmd1){case\"set\":what=cmd.NextToken();attrib=cmd.NextToken();rest=cmd.RestOfString();undostart=\"set \"+what+\" \"+attrib;if(what==\"sheet\"){sheet.renderneeded=true;switch(attrib){case\"defaultcolwidth\":if(saveundo)changes.AddUndo(undostart,attribs[attrib]);attribs[attrib]=rest;break;case\"defaultcolor\":case\"defaultbgcolor\":if(saveundo)changes.AddUndo(undostart,sheet.GetStyleString(\"color\",attribs[attrib]));attribs[attrib]=sheet.GetStyleNum(\"color\",rest);break;case\"defaultlayout\":if(saveundo)changes.AddUndo(undostart,sheet.GetStyleString(\"layout\",attribs[attrib]));attribs[attrib]=sheet.GetStyleNum(\"layout\",rest);break;case\"defaultfont\":if(saveundo)changes.AddUndo(undostart,sheet.GetStyleString(\"font\",attribs[attrib]));if(rest==\"* * *\")rest=\"\";// all default\n\tattribs[attrib]=sheet.GetStyleNum(\"font\",rest);break;case\"defaulttextformat\":case\"defaultnontextformat\":if(saveundo)changes.AddUndo(undostart,sheet.GetStyleString(\"cellformat\",attribs[attrib]));attribs[attrib]=sheet.GetStyleNum(\"cellformat\",rest);break;case\"defaulttextvalueformat\":case\"defaultnontextvalueformat\":if(saveundo)changes.AddUndo(undostart,sheet.GetStyleString(\"valueformat\",attribs[attrib]));attribs[attrib]=sheet.GetStyleNum(\"valueformat\",rest);for(cr in sheet.cells){// forget all cached display strings\n\tdelete sheet.cells[cr].displaystring;}break;case\"lastcol\":case\"lastrow\":if(saveundo)changes.AddUndo(undostart,attribs[attrib]-0);num=rest-0;if(typeof num==\"number\")attribs[attrib]=num>0?num:1;break;case\"recalc\":if(saveundo)changes.AddUndo(undostart,attribs[attrib]);if(rest==\"off\"){attribs.recalc=rest;// manual recalc, not auto\n\t}else{// all values other than \"off\" mean \"on\"\n\tdelete attribs.recalc;}break;default:errortext=scc.s_escUnknownSheetCmd+cmdstr;break;}}else if(/(^[A-Z])([A-Z])?(:[A-Z][A-Z]?){0,1}$/i.test(what)){// col attributes\n\tsheet.renderneeded=true;what=what.toUpperCase();pos=what.indexOf(\":\");if(pos>=0){cr1=SocialCalc.coordToCr(what.substring(0,pos)+\"1\");cr2=SocialCalc.coordToCr(what.substring(pos+1)+\"1\");}else{cr1=SocialCalc.coordToCr(what+\"1\");cr2=cr1;}for(col=cr1.col;col<=cr2.col;col++){if(attrib==\"width\"){cr=SocialCalc.rcColname(col);if(saveundo)changes.AddUndo(\"set \"+cr+\" width\",sheet.colattribs.width[cr]);if(rest.length>0){sheet.colattribs.width[cr]=rest;}else{delete sheet.colattribs.width[cr];}}}}// !!!!! need row attribs !!!!\n\telse if(/([a-z]){0,1}(\\d+)/i.test(what)){// cell attributes\n\tParseRange();if(cr1.row!=cr2.row||cr1.col!=cr2.col||sheet.celldisplayneeded||sheet.renderneeded){// not one cell\n\tsheet.renderneeded=true;sheet.celldisplayneeded=\"\";}else{sheet.celldisplayneeded=SocialCalc.crToCoord(cr1.col,cr1.row);}for(row=cr1.row;row<=cr2.row;row++){for(col=cr1.col;col<=cr2.col;col++){cr=SocialCalc.crToCoord(col,row);cell=sheet.GetAssuredCell(cr);if(saveundo)changes.AddUndo(\"set \"+cr+\" all\",sheet.CellToString(cell));if(attrib==\"value\"){// set coord value type numeric-value\n\tpos=rest.indexOf(\" \");cell.datavalue=rest.substring(pos+1)-0;delete cell.errors;cell.datatype=\"v\";cell.valuetype=rest.substring(0,pos);delete cell.displaystring;delete cell.parseinfo;attribs.needsrecalc=\"yes\";}else if(attrib==\"text\"){// set coord text type text-value\n\tpos=rest.indexOf(\" \");cell.datavalue=SocialCalc.decodeFromSave(rest.substring(pos+1));delete cell.errors;cell.datatype=\"t\";cell.valuetype=rest.substring(0,pos);delete cell.displaystring;delete cell.parseinfo;attribs.needsrecalc=\"yes\";}else if(attrib==\"formula\"){// set coord formula formula-body-less-initial-=\n\tcell.datavalue=0;// until recalc\n\tdelete cell.errors;cell.datatype=\"f\";cell.valuetype=\"e#N/A\";// until recalc\n\tcell.formula=rest;delete cell.displaystring;delete cell.parseinfo;attribs.needsrecalc=\"yes\";}else if(attrib==\"constant\"){// set coord constant type numeric-value source-text\n\tpos=rest.indexOf(\" \");pos2=rest.substring(pos+1).indexOf(\" \");cell.datavalue=rest.substring(pos+1,pos+1+pos2)-0;cell.valuetype=rest.substring(0,pos);if(cell.valuetype.charAt(0)==\"e\"){// error\n\tcell.errors=cell.valuetype.substring(1);}else{delete cell.errors;}cell.datatype=\"c\";cell.formula=rest.substring(pos+pos2+2);delete cell.displaystring;delete cell.parseinfo;attribs.needsrecalc=\"yes\";}else if(attrib==\"empty\"){// erase value\n\tcell.datavalue=\"\";delete cell.errors;cell.datatype=null;cell.formula=\"\";cell.valuetype=\"b\";delete cell.displaystring;delete cell.parseinfo;attribs.needsrecalc=\"yes\";}else if(attrib==\"all\"){// set coord all :this:val1:that:val2...\n\tif(rest.length>0){cell=new SocialCalc.Cell(cr);sheet.CellFromStringParts(cell,rest.split(\":\"),1);sheet.cells[cr]=cell;}else{delete sheet.cells[cr];}attribs.needsrecalc=\"yes\";}else if(/^b[trbl]$/.test(attrib)){// set coord bt 1px solid black\n\tcell[attrib]=sheet.GetStyleNum(\"borderstyle\",rest);sheet.renderneeded=true;// affects more than just one cell\n\t}else if(attrib==\"color\"||attrib==\"bgcolor\"){cell[attrib]=sheet.GetStyleNum(\"color\",rest);}else if(attrib==\"layout\"||attrib==\"cellformat\"){cell[attrib]=sheet.GetStyleNum(attrib,rest);}else if(attrib==\"font\"){// set coord font style weight size family\n\tif(rest==\"* * *\")rest=\"\";cell[attrib]=sheet.GetStyleNum(\"font\",rest);}else if(attrib==\"textvalueformat\"||attrib==\"nontextvalueformat\"){cell[attrib]=sheet.GetStyleNum(\"valueformat\",rest);delete cell.displaystring;}else if(attrib==\"cssc\"){rest=rest.replace(/[^a-zA-Z0-9\\-]/g,\"\");cell.cssc=rest;}else if(attrib==\"csss\"){rest=rest.replace(/\\n/g,\"\");cell.csss=rest;}else if(attrib==\"mod\"){rest=rest.replace(/[^yY]/g,\"\").toLowerCase();cell.mod=rest;}else if(attrib==\"comment\"){cell.comment=SocialCalc.decodeFromSave(rest);}else{errortext=scc.s_escUnknownSetCoordCmd+cmdstr;}}}}break;case\"merge\":sheet.renderneeded=true;what=cmd.NextToken();rest=cmd.RestOfString();ParseRange();cell=sheet.GetAssuredCell(cr1.coord);if(saveundo)changes.AddUndo(\"unmerge \"+cr1.coord);if(cr2.col>cr1.col)cell.colspan=cr2.col-cr1.col+1;else delete cell.colspan;if(cr2.row>cr1.row)cell.rowspan=cr2.row-cr1.row+1;else delete cell.rowspan;sheet.changedrendervalues=true;break;case\"unmerge\":sheet.renderneeded=true;what=cmd.NextToken();rest=cmd.RestOfString();ParseRange();cell=sheet.GetAssuredCell(cr1.coord);if(saveundo)changes.AddUndo(\"merge \"+cr1.coord+\":\"+SocialCalc.crToCoord(cr1.col+(cell.colspan||1)-1,cr1.row+(cell.rowspan||1)-1));delete cell.colspan;delete cell.rowspan;sheet.changedrendervalues=true;break;case\"erase\":case\"cut\":sheet.renderneeded=true;sheet.changedrendervalues=true;what=cmd.NextToken();rest=cmd.RestOfString();ParseRange();if(saveundo)changes.AddUndo(\"changedrendervalues\");// to take care of undone pasted spans\n\tif(cmd1==\"cut\"){// save copy of whole thing before erasing\n\tif(saveundo)changes.AddUndo(\"loadclipboard\",SocialCalc.encodeForSave(SocialCalc.Clipboard.clipboard));SocialCalc.Clipboard.clipboard=SocialCalc.CreateSheetSave(sheet,what);}for(row=cr1.row;row<=cr2.row;row++){for(col=cr1.col;col<=cr2.col;col++){cr=SocialCalc.crToCoord(col,row);cell=sheet.GetAssuredCell(cr);if(saveundo)changes.AddUndo(\"set \"+cr+\" all\",sheet.CellToString(cell));if(rest==\"all\"){delete sheet.cells[cr];}else if(rest==\"formulas\"){cell.datavalue=\"\";cell.datatype=null;cell.formula=\"\";cell.valuetype=\"b\";delete cell.errors;delete cell.displaystring;delete cell.parseinfo;if(cell.comment){// comments are considered content for erasing\n\tdelete cell.comment;}}else if(rest==\"formats\"){newcell=new SocialCalc.Cell(cr);// create a new cell without attributes\n\tnewcell.datavalue=cell.datavalue;// copy existing values\n\tnewcell.datatype=cell.datatype;newcell.formula=cell.formula;newcell.valuetype=cell.valuetype;if(cell.comment){newcell.comment=cell.comment;}sheet.cells[cr]=newcell;// replace\n\t}}}attribs.needsrecalc=\"yes\";break;case\"fillright\":case\"filldown\":sheet.renderneeded=true;sheet.changedrendervalues=true;if(saveundo)changes.AddUndo(\"changedrendervalues\");// to take care of undone pasted spans\n\twhat=cmd.NextToken();rest=cmd.RestOfString();ParseRange();if(cmd1==\"fillright\"){fillright=true;rowstart=cr1.row;colstart=cr1.col+1;}else{fillright=false;rowstart=cr1.row+1;colstart=cr1.col;}for(row=rowstart;row<=cr2.row;row++){for(col=colstart;col<=cr2.col;col++){cr=SocialCalc.crToCoord(col,row);cell=sheet.GetAssuredCell(cr);if(saveundo)changes.AddUndo(\"set \"+cr+\" all\",sheet.CellToString(cell));if(fillright){crbase=SocialCalc.crToCoord(cr1.col,row);coloffset=col-colstart+1;rowoffset=0;}else{crbase=SocialCalc.crToCoord(col,cr1.row);coloffset=0;rowoffset=row-rowstart+1;}basecell=sheet.GetAssuredCell(crbase);if(rest==\"all\"||rest==\"formats\"){for(attrib in cellProperties){if(cellProperties[attrib]==1)continue;// copy only format attributes\n\tif(_typeof(basecell[attrib])===undefined||cellProperties[attrib]==3){delete cell[attrib];}else{cell[attrib]=basecell[attrib];}}}if(rest==\"all\"||rest==\"formulas\"){cell.datavalue=basecell.datavalue;cell.datatype=basecell.datatype;cell.valuetype=basecell.valuetype;if(cell.datatype==\"f\"){// offset relative coords, even in sheet references\n\tcell.formula=SocialCalc.OffsetFormulaCoords(basecell.formula,coloffset,rowoffset);}else{cell.formula=basecell.formula;}delete cell.parseinfo;cell.errors=basecell.errors;}delete cell.displaystring;}}attribs.needsrecalc=\"yes\";break;case\"copy\":what=cmd.NextToken();rest=cmd.RestOfString();if(saveundo)changes.AddUndo(\"loadclipboard\",SocialCalc.encodeForSave(SocialCalc.Clipboard.clipboard));SocialCalc.Clipboard.clipboard=SocialCalc.CreateSheetSave(sheet,what);break;case\"loadclipboard\":rest=cmd.RestOfString();if(saveundo)changes.AddUndo(\"loadclipboard\",SocialCalc.encodeForSave(SocialCalc.Clipboard.clipboard));SocialCalc.Clipboard.clipboard=SocialCalc.decodeFromSave(rest);break;case\"clearclipboard\":if(saveundo)changes.AddUndo(\"loadclipboard\",SocialCalc.encodeForSave(SocialCalc.Clipboard.clipboard));SocialCalc.Clipboard.clipboard=\"\";break;case\"paste\":sheet.renderneeded=true;sheet.changedrendervalues=true;if(saveundo)changes.AddUndo(\"changedrendervalues\");// to take care of undone pasted spans\n\twhat=cmd.NextToken();rest=cmd.RestOfString();ParseRange();if(!SocialCalc.Clipboard.clipboard){break;}clipsheet=new SocialCalc.Sheet();// load clipboard contents as another sheet\n\tclipsheet.ParseSheetSave(SocialCalc.Clipboard.clipboard);cliprange=SocialCalc.ParseRange(clipsheet.copiedfrom);coloffset=cr1.col-cliprange.cr1.col;// get sizes, etc.\n\trowoffset=cr1.row-cliprange.cr1.row;numcols=cliprange.cr2.col-cliprange.cr1.col+1;numrows=cliprange.cr2.row-cliprange.cr1.row+1;if(cr1.col+numcols-1>attribs.lastcol)attribs.lastcol=cr1.col+numcols-1;if(cr1.row+numrows-1>attribs.lastrow)attribs.lastrow=cr1.row+numrows-1;for(row=cr1.row;row<cr1.row+numrows;row++){for(col=cr1.col;col<cr1.col+numcols;col++){cr=SocialCalc.crToCoord(col,row);cell=sheet.GetAssuredCell(cr);if(saveundo)changes.AddUndo(\"set \"+cr+\" all\",sheet.CellToString(cell));crbase=SocialCalc.crToCoord(col-coloffset,row-rowoffset);basecell=clipsheet.GetAssuredCell(crbase);if(rest==\"all\"||rest==\"formats\"){for(attrib in cellProperties){if(cellProperties[attrib]==1)continue;// copy only format attributes\n\tif(_typeof(basecell[attrib])===undefined||cellProperties[attrib]==3){delete cell[attrib];}else{attribtable=SocialCalc.CellPropertiesTable[attrib];if(attribtable&&basecell[attrib]){// table indexes to expand to strings since other sheet may have diff indexes\n\tcell[attrib]=sheet.GetStyleNum(attribtable,clipsheet.GetStyleString(attribtable,basecell[attrib]));}else{// these are not table indexes\n\tcell[attrib]=basecell[attrib];}}}}if(rest==\"all\"||rest==\"formulas\"){cell.datavalue=basecell.datavalue;cell.datatype=basecell.datatype;cell.valuetype=basecell.valuetype;if(cell.datatype==\"f\"){// offset relative coords, even in sheet references\n\tcell.formula=SocialCalc.OffsetFormulaCoords(basecell.formula,coloffset,rowoffset);}else{cell.formula=basecell.formula;}delete cell.parseinfo;cell.errors=basecell.errors;if(basecell.comment){// comments are pasted as part of content, though not filled, etc.\n\tcell.comment=basecell.comment;}else if(cell.comment){delete cell.comment;}}delete cell.displaystring;}}attribs.needsrecalc=\"yes\";break;case\"sort\":// sort cr1:cr2 col1 up/down col2 up/down col3 up/down\n\tsheet.renderneeded=true;sheet.changedrendervalues=true;if(saveundo)changes.AddUndo(\"changedrendervalues\");// to take care of undone pasted spans\n\twhat=cmd.NextToken();ParseRange();cols=[];// get columns and sort directions (or \"\")\n\tdirs=[];lastsortcol=0;for(i=0;i<=3;i++){cols[i]=cmd.NextToken();dirs[i]=cmd.NextToken();if(cols[i])lastsortcol=i;}sortcells={};// a copy of the data which will replace the original, but in the new order\n\tsortlist=[];// an array of 0, 1, ..., nrows-1 needed for sorting\n\tsortvalues=[];// values to be sorted corresponding to sortlist\n\tsorttypes=[];// basic types of the values\n\tfor(row=cr1.row;row<=cr2.row;row++){// fill in the sort info\n\tfor(col=cr1.col;col<=cr2.col;col++){cr=SocialCalc.crToCoord(col,row);cell=sheet.cells[cr];if(cell){// only copy non-empty cells\n\tsortcells[cr]=sheet.CellToString(cell);if(saveundo)changes.AddUndo(\"set \"+cr+\" all\",sortcells[cr]);}else{if(saveundo)changes.AddUndo(\"set \"+cr+\" all\");}}sortlist.push(sortlist.length);sortvalues.push([]);sorttypes.push([]);slast=sorttypes.length-1;for(i=0;i<=lastsortcol;i++){cr=cols[i]+row;// get cr on this row in sort col\n\tcell=sheet.GetAssuredCell(cr);val=cell.datavalue;valtype=cell.valuetype.charAt(0)||\"b\";if(valtype==\"t\")val=val.toLowerCase();sortvalues[slast].push(val);sorttypes[slast].push(valtype);}}sortfunction=function sortfunction(a,b){// a comparison function that can handle all the type variations\n\tvar i,a1,b1,ta,cresult;for(i=0;i<=lastsortcol;i++){if(dirs[i]==\"up\"){// handle sort direction\n\ta1=a;b1=b;}else{a1=b;b1=a;}ta=sorttypes[a1][i];tb=sorttypes[b1][i];if(ta==\"t\"){// numbers < text < errors, blank always last no matter what dir\n\tif(tb==\"t\"){a1=sortvalues[a1][i];b1=sortvalues[b1][i];cresult=a1>b1?1:a1<b1?-1:0;}else if(tb==\"n\"){cresult=1;}else if(tb==\"b\"){cresult=dirs[i]==\"up\"?-1:1;}else if(tb==\"e\"){cresult=-1;}}else if(ta==\"n\"){if(tb==\"t\"){cresult=-1;}else if(tb==\"n\"){a1=sortvalues[a1][i]-0;// force to numeric, just in case\n\tb1=sortvalues[b1][i]-0;cresult=a1>b1?1:a1<b1?-1:0;}else if(tb==\"b\"){cresult=dirs[i]==\"up\"?-1:1;}else if(tb==\"e\"){cresult=-1;}}else if(ta==\"e\"){if(tb==\"e\"){a1=sortvalues[a1][i];b1=sortvalues[b1][i];cresult=a1>b1?1:a1<b1?-1:0;}else if(tb==\"b\"){cresult=dirs[i]==\"up\"?-1:1;}else{cresult=1;}}else if(ta==\"b\"){if(tb==\"b\"){cresult=0;}else{cresult=dirs[i]==\"up\"?1:-1;}}if(cresult){// return if tested not equal, otherwise do next column\n\treturn cresult;}}cresult=a>b?1:a<b?-1:0;// equal - return position in original to maintain it\n\treturn cresult;};sortlist.sort(sortfunction);for(row=cr1.row;row<=cr2.row;row++){// copy original rows into sorted positions\n\toriginalrow=sortlist[row-cr1.row];// relative position where it was in original\n\tfor(col=cr1.col;col<=cr2.col;col++){cr=SocialCalc.crToCoord(col,row);sortedcr=SocialCalc.crToCoord(col,originalrow+cr1.row);// original cell to be put in new place\n\tif(sortcells[sortedcr]){cell=new SocialCalc.Cell(cr);sheet.CellFromStringParts(cell,sortcells[sortedcr].split(\":\"),1);if(cell.datatype==\"f\"){// offset coord refs, even to ***relative*** coords in other sheets\n\tcell.formula=SocialCalc.OffsetFormulaCoords(cell.formula,0,row-cr1.row-originalrow);}sheet.cells[cr]=cell;}else{delete sheet.cells[cr];}}}attribs.needsrecalc=\"yes\";break;case\"insertcol\":case\"insertrow\":sheet.renderneeded=true;sheet.changedrendervalues=true;what=cmd.NextToken();rest=cmd.RestOfString();ParseRange();if(cmd1==\"insertcol\"){coloffset=1;colend=cr1.col;rowoffset=0;rowend=1;newcolstart=cr1.col;newcolend=cr1.col;newrowstart=1;newrowend=attribs.lastrow;if(saveundo)changes.AddUndo(\"deletecol \"+cr1.coord);}else{coloffset=0;colend=1;rowoffset=1;rowend=cr1.row;newcolstart=1;newcolend=attribs.lastcol;newrowstart=cr1.row;newrowend=cr1.row;if(saveundo)changes.AddUndo(\"deleterow \"+cr1.coord);}for(row=attribs.lastrow;row>=rowend;row--){// copy the cells forward\n\tfor(col=attribs.lastcol;col>=colend;col--){crbase=SocialCalc.crToCoord(col,row);cr=SocialCalc.crToCoord(col+coloffset,row+rowoffset);if(!sheet.cells[crbase]){// copying empty cell\n\tdelete sheet.cells[cr];// delete anything that may have been there\n\t}else{// overwrite existing cell with moved contents\n\tsheet.cells[cr]=sheet.cells[crbase];}}}for(row=newrowstart;row<=newrowend;row++){// fill the \"new\" empty cells\n\tfor(col=newcolstart;col<=newcolend;col++){cr=SocialCalc.crToCoord(col,row);cell=new SocialCalc.Cell(cr);sheet.cells[cr]=cell;crbase=SocialCalc.crToCoord(col-coloffset,row-rowoffset);// copy attribs of the one before (0 gives you A or 1)\n\tbasecell=sheet.GetAssuredCell(crbase);for(attrib in cellProperties){if(cellProperties[attrib]==2){// copy only format attributes\n\tcell[attrib]=basecell[attrib];}}}}for(cr in sheet.cells){// update cell references to moved cells in calculated formulas\n\tcell=sheet.cells[cr];if(cell&&cell.datatype==\"f\"){cell.formula=SocialCalc.AdjustFormulaCoords(cell.formula,cr1.col,coloffset,cr1.row,rowoffset);}if(cell){delete cell.parseinfo;}}for(name in sheet.names){// update cell references to moved cells in names\n\tif(sheet.names[name]){// works with \"A1\", \"A1:A20\", and \"=formula\" forms\n\tv1=sheet.names[name].definition;v2=\"\";if(v1.charAt(0)==\"=\"){v2=\"=\";v1=v1.substring(1);}sheet.names[name].definition=v2+SocialCalc.AdjustFormulaCoords(v1,cr1.col,coloffset,cr1.row,rowoffset);}}for(row=attribs.lastrow;row>=rowend&&cmd1==\"insertrow\";row--){// copy the row attributes forward\n\trownext=row+rowoffset;for(attrib in sheet.rowattribs){val=sheet.rowattribs[attrib][row];if(sheet.rowattribs[attrib][rownext]!=val){// make assignment only if different\n\tif(val){sheet.rowattribs[attrib][rownext]=val;}else{delete sheet.rowattribs[attrib][rownext];}}}}for(col=attribs.lastcol;col>=colend&&cmd1==\"insertcol\";col--){// copy the column attributes forward\n\tcolthis=SocialCalc.rcColname(col);colnext=SocialCalc.rcColname(col+coloffset);for(attrib in sheet.colattribs){val=sheet.colattribs[attrib][colthis];if(sheet.colattribs[attrib][colnext]!=val){// make assignment only if different\n\tif(val){sheet.colattribs[attrib][colnext]=val;}else{delete sheet.colattribs[attrib][colnext];}}}}attribs.lastcol+=coloffset;attribs.lastrow+=rowoffset;attribs.needsrecalc=\"yes\";break;case\"deletecol\":case\"deleterow\":sheet.renderneeded=true;sheet.changedrendervalues=true;what=cmd.NextToken();rest=cmd.RestOfString();lastcol=attribs.lastcol;// save old values since ParseRange sets...\n\tlastrow=attribs.lastrow;ParseRange();if(cmd1==\"deletecol\"){coloffset=cr1.col-cr2.col-1;rowoffset=0;colstart=cr2.col+1;rowstart=1;}else{coloffset=0;rowoffset=cr1.row-cr2.row-1;colstart=1;rowstart=cr2.row+1;}for(row=rowstart;row<=lastrow-rowoffset;row++){// copy the cells backwards - extra so no dup of last set\n\tfor(col=colstart;col<=lastcol-coloffset;col++){cr=SocialCalc.crToCoord(col+coloffset,row+rowoffset);if(saveundo&&(row<rowstart-rowoffset||col<colstart-coloffset)){// save cells that are overwritten as undo info\n\tcell=sheet.cells[cr];if(!cell){// empty cell\n\tchanges.AddUndo(\"erase \"+cr+\" all\");}else{changes.AddUndo(\"set \"+cr+\" all\",sheet.CellToString(cell));}}crbase=SocialCalc.crToCoord(col,row);cell=sheet.cells[crbase];if(!cell){// copying empty cell\n\tdelete sheet.cells[cr];// delete anything that may have been there\n\t}else{// overwrite existing cell with moved contents\n\tsheet.cells[cr]=cell;}}}//!!! multiple deletes isn't setting #REF!; need to fix up #REF!'s on undo but only those!\n\tfor(cr in sheet.cells){// update cell references to moved cells in calculated formulas\n\tcell=sheet.cells[cr];if(cell){if(cell.datatype==\"f\"){oldformula=cell.formula;cell.formula=SocialCalc.AdjustFormulaCoords(oldformula,cr1.col,coloffset,cr1.row,rowoffset);if(cell.formula!=oldformula){delete cell.parseinfo;if(saveundo&&cell.formula.indexOf(\"#REF!\")!=-1){// save old version only if removed coord\n\toldcr=SocialCalc.coordToCr(cr);changes.AddUndo(\"set \"+SocialCalc.rcColname(oldcr.col-coloffset)+(oldcr.row-rowoffset)+\" formula \"+oldformula);}}}else{delete cell.parseinfo;}}}for(name in sheet.names){// update cell references to moved cells in names\n\tif(sheet.names[name]){// works with \"A1\", \"A1:A20\", and \"=formula\" forms\n\tv1=sheet.names[name].definition;v2=\"\";if(v1.charAt(0)==\"=\"){v2=\"=\";v1=v1.substring(1);}sheet.names[name].definition=v2+SocialCalc.AdjustFormulaCoords(v1,cr1.col,coloffset,cr1.row,rowoffset);}}for(row=rowstart;row<=lastrow-rowoffset&&cmd1==\"deleterow\";row++){// copy the row attributes backwards\n\trowbefore=row+rowoffset;for(attrib in sheet.rowattribs){val=sheet.rowattribs[attrib][row];if(sheet.rowattribs[attrib][rowbefore]!=val){// make assignment only if different\n\tif(saveundo)changes.AddUndo(\"set \"+rowbefore+\" \"+attrib,sheet.rowattribs[attrib][rowbefore]);if(val){sheet.rowattribs[attrib][rowbefore]=val;}else{delete sheet.rowattribs[attrib][rowbefore];}}}}for(col=colstart;col<=lastcol-coloffset&&cmd1==\"deletecol\";col++){// copy the column attributes backwards\n\tcolthis=SocialCalc.rcColname(col);colbefore=SocialCalc.rcColname(col+coloffset);for(attrib in sheet.colattribs){val=sheet.colattribs[attrib][colthis];if(sheet.colattribs[attrib][colbefore]!=val){// make assignment only if different\n\tif(saveundo)changes.AddUndo(\"set \"+colbefore+\" \"+attrib,sheet.colattribs[attrib][colbefore]);if(val){sheet.colattribs[attrib][colbefore]=val;}else{delete sheet.colattribs[attrib][colbefore];}}}}if(saveundo){if(cmd1==\"deletecol\"){for(col=cr1.col;col<=cr2.col;col++){changes.AddUndo(\"insertcol \"+SocialCalc.rcColname(col));}}else{for(row=cr1.row;row<=cr2.row;row++){changes.AddUndo(\"insertrow \"+row);}}}if(cmd1==\"deletecol\"){if(cr1.col<=lastcol){// shrink sheet unless deleted phantom cols off the end\n\tif(cr2.col<=lastcol){attribs.lastcol+=coloffset;}else{attribs.lastcol=cr1.col-1;}}}else{if(cr1.row<=lastrow){// shrink sheet unless deleted phantom rows off the end\n\tif(cr2.row<=lastrow){attribs.lastrow+=rowoffset;}else{attribs.lastrow=cr1.row-1;}}}attribs.needsrecalc=\"yes\";break;case\"movepaste\":case\"moveinsert\":var movingcells,dest,destcr,inserthoriz,insertvert,pushamount,movedto;sheet.renderneeded=true;sheet.changedrendervalues=true;if(saveundo)changes.AddUndo(\"changedrendervalues\");// to take care of undone pasted spans\n\twhat=cmd.NextToken();dest=cmd.NextToken();rest=cmd.RestOfString();// rest is all/formulas/formats\n\tif(rest==\"\")rest=\"all\";ParseRange();destcr=SocialCalc.coordToCr(dest);coloffset=destcr.col-cr1.col;rowoffset=destcr.row-cr1.row;numcols=cr2.col-cr1.col+1;numrows=cr2.row-cr1.row+1;// get a copy of moving cells and erase from where they were\n\tmovingcells={};for(row=cr1.row;row<=cr2.row;row++){for(col=cr1.col;col<=cr2.col;col++){cr=SocialCalc.crToCoord(col,row);cell=sheet.GetAssuredCell(cr);if(saveundo)changes.AddUndo(\"set \"+cr+\" all\",sheet.CellToString(cell));if(!sheet.cells[cr]){// if had nothing\n\tcontinue;// don't save anything\n\t}movingcells[cr]=new SocialCalc.Cell(cr);// create new cell to copy\n\tfor(attrib in cellProperties){// go through each property\n\tif(_typeof(cell[attrib])===undefined){// don't copy undefined things and no need to delete\n\tcontinue;}else{movingcells[cr][attrib]=cell[attrib];// copy for potential moving\n\t}if(rest==\"all\"){delete cell[attrib];}if(rest==\"formulas\"){if(cellProperties[attrib]==1||cellProperties[attrib]==3){delete cell[attrib];}}if(rest==\"formats\"){if(cellProperties[attrib]==2){delete cell[attrib];}}}if(rest==\"formulas\"){// leave pristene deleted cell\n\tcell.datavalue=\"\";cell.datatype=null;cell.formula=\"\";cell.valuetype=\"b\";}if(rest==\"all\"){// leave nothing for move all\n\tdelete sheet.cells[cr];}}}// if moveinsert, check destination OK, and calculate pushing parameters\n\tif(cmd1==\"moveinsert\"){inserthoriz=false;insertvert=false;if(rowoffset==0&&(destcr.col<cr1.col||destcr.col>cr2.col)){if(destcr.col<cr1.col){// moving left\n\tpushamount=cr1.col-destcr.col;inserthoriz=-1;}else{destcr.col-=1;coloffset=destcr.col-cr2.col;pushamount=destcr.col-cr2.col;inserthoriz=1;}}else if(coloffset==0&&(destcr.row<cr1.row||destcr.row>cr2.row)){if(destcr.row<cr1.row){// moving up\n\tpushamount=cr1.row-destcr.row;insertvert=-1;}else{destcr.row-=1;rowoffset=destcr.row-cr2.row;pushamount=destcr.row-cr2.row;insertvert=1;}}else{cmd1=\"movepaste\";// not allowed right now - ignore\n\t}}// push any cells that need pushing\n\tmovedto={};// remember what was moved where\n\tif(insertvert){for(row=0;row<pushamount;row++){for(col=cr1.col;col<=cr2.col;col++){if(insertvert<0){crbase=SocialCalc.crToCoord(col,destcr.row+pushamount-row-1);// from cell\n\tcr=SocialCalc.crToCoord(col,cr2.row-row);// to cell\n\t}else{crbase=SocialCalc.crToCoord(col,destcr.row-pushamount+row+1);// from cell\n\tcr=SocialCalc.crToCoord(col,cr1.row+row);// to cell\n\t}basecell=sheet.GetAssuredCell(crbase);if(saveundo)changes.AddUndo(\"set \"+crbase+\" all\",sheet.CellToString(basecell));cell=sheet.GetAssuredCell(cr);if(rest==\"all\"||rest==\"formats\"){for(attrib in cellProperties){if(cellProperties[attrib]==1)continue;// copy only format attributes\n\tif(_typeof(basecell[attrib])===undefined||cellProperties[attrib]==3){delete cell[attrib];}else{cell[attrib]=basecell[attrib];}}}if(rest==\"all\"||rest==\"formulas\"){cell.datavalue=basecell.datavalue;cell.datatype=basecell.datatype;cell.valuetype=basecell.valuetype;cell.formula=basecell.formula;delete cell.parseinfo;cell.errors=basecell.errors;}delete cell.displaystring;movedto[crbase]=cr;// old crbase is now at cr\n\t}}}if(inserthoriz){for(col=0;col<pushamount;col++){for(row=cr1.row;row<=cr2.row;row++){if(inserthoriz<0){crbase=SocialCalc.crToCoord(destcr.col+pushamount-col-1,row);cr=SocialCalc.crToCoord(cr2.col-col,row);}else{crbase=SocialCalc.crToCoord(destcr.col-pushamount+col+1,row);cr=SocialCalc.crToCoord(cr1.col+col,row);}basecell=sheet.GetAssuredCell(crbase);if(saveundo)changes.AddUndo(\"set \"+crbase+\" all\",sheet.CellToString(basecell));cell=sheet.GetAssuredCell(cr);if(rest==\"all\"||rest==\"formats\"){for(attrib in cellProperties){if(cellProperties[attrib]==1)continue;// copy only format attributes\n\tif(_typeof(basecell[attrib])===undefined||cellProperties[attrib]==3){delete cell[attrib];}else{cell[attrib]=basecell[attrib];}}}if(rest==\"all\"||rest==\"formulas\"){cell.datavalue=basecell.datavalue;cell.datatype=basecell.datatype;cell.valuetype=basecell.valuetype;cell.formula=basecell.formula;delete cell.parseinfo;cell.errors=basecell.errors;}delete cell.displaystring;movedto[crbase]=cr;// old crbase is now at cr\n\t}}}// paste moved cells into new place\n\tif(destcr.col+numcols-1>attribs.lastcol)attribs.lastcol=destcr.col+numcols-1;if(destcr.row+numrows-1>attribs.lastrow)attribs.lastrow=destcr.row+numrows-1;for(row=cr1.row;row<cr1.row+numrows;row++){for(col=cr1.col;col<cr1.col+numcols;col++){cr=SocialCalc.crToCoord(col+coloffset,row+rowoffset);cell=sheet.GetAssuredCell(cr);if(saveundo)changes.AddUndo(\"set \"+cr+\" all\",sheet.CellToString(cell));crbase=SocialCalc.crToCoord(col,row);// get old cell to move\n\tmovedto[crbase]=cr;// old crbase (moved cell) will now be at cr (destination)\n\tif(rest==\"all\"&&!movingcells[crbase]){// moving an empty cell\n\tdelete sheet.cells[cr];// make the cell empty\n\tcontinue;}basecell=movingcells[crbase];if(!basecell)basecell=sheet.GetAssuredCell(crbase);if(rest==\"all\"||rest==\"formats\"){for(attrib in cellProperties){if(cellProperties[attrib]==1)continue;// copy only format attributes\n\tif(_typeof(basecell[attrib])===undefined||cellProperties[attrib]==3){delete cell[attrib];}else{cell[attrib]=basecell[attrib];}}}if(rest==\"all\"||rest==\"formulas\"){cell.datavalue=basecell.datavalue;cell.datatype=basecell.datatype;cell.valuetype=basecell.valuetype;cell.formula=basecell.formula;delete cell.parseinfo;cell.errors=basecell.errors;if(basecell.comment){// comments are pasted as part of content, though not filled, etc.\n\tcell.comment=basecell.comment;}else if(cell.comment){delete cell.comment;}}delete cell.displaystring;}}// do fixups\n\tfor(cr in sheet.cells){// update cell references to moved cells in calculated formulas\n\tcell=sheet.cells[cr];if(cell){if(cell.datatype==\"f\"){oldformula=cell.formula;cell.formula=SocialCalc.ReplaceFormulaCoords(oldformula,movedto);if(cell.formula!=oldformula){delete cell.parseinfo;if(saveundo&&!movedto[cr]){// moved cells are already saved for undo\n\tchanges.AddUndo(\"set \"+cr+\" formula \"+oldformula);}}}else{delete cell.parseinfo;}}}for(name in sheet.names){// update cell references to moved cells in names\n\tif(sheet.names[name]){// works with \"A1\", \"A1:A20\", and \"=formula\" forms\n\tv1=sheet.names[name].definition;oldformula=v1;v2=\"\";if(v1.charAt(0)==\"=\"){v2=\"=\";v1=v1.substring(1);}sheet.names[name].definition=v2+SocialCalc.ReplaceFormulaCoords(v1,movedto);if(saveundo&&sheet.names[name].definition!=oldformula){// save changes\n\tchanges.AddUndo(\"name define \"+name+\" \"+oldformula);}}}attribs.needsrecalc=\"yes\";break;case\"name\":what=cmd.NextToken();name=cmd.NextToken();rest=cmd.RestOfString();name=name.toUpperCase().replace(/[^A-Z0-9_\\.]/g,\"\");if(name==\"\")break;// must have something\n\tif(what==\"define\"){if(rest==\"\")break;// must have something\n\tif(sheet.names[name]){// already exists\n\tif(saveundo)changes.AddUndo(\"name define \"+name+\" \"+sheet.names[name].definition);sheet.names[name].definition=rest;}else{// new\n\tif(saveundo)changes.AddUndo(\"name delete \"+name);sheet.names[name]={definition:rest,desc:\"\"};}}else if(what==\"desc\"){if(sheet.names[name]){// must already exist\n\tif(saveundo)changes.AddUndo(\"name desc \"+name+\" \"+sheet.names[name].desc);sheet.names[name].desc=rest;}}else if(what==\"delete\"){if(saveundo){if(sheet.names[name].desc)changes.AddUndo(\"name desc \"+name+\" \"+sheet.names[name].desc);changes.AddUndo(\"name define \"+name+\" \"+sheet.names[name].definition);}delete sheet.names[name];}attribs.needsrecalc=\"yes\";break;case\"recalc\":attribs.needsrecalc=\"yes\";// request recalc\n\tsheet.recalconce=true;// even if turned off\n\tbreak;case\"redisplay\":sheet.renderneeded=true;break;case\"changedrendervalues\":// needed for undo sometimes\n\tsheet.changedrendervalues=true;break;case\"startcmdextension\":// startcmdextension extension rest-of-command\n\tname=cmd.NextToken();cmdextension=SocialCalc.SheetCommandInfo.CmdExtensionCallbacks[name];if(cmdextension){cmdextension.func(name,cmdextension.data,sheet,cmd,saveundo);}break;default:errortext=scc.s_escUnknownCmd+cmdstr;break;}/* For Debugging:\n\tvar ustack=\"\";\n\tfor (var i=0;i<sheet.changes.stack.length;i++) {\n\t   ustack+=(i-0)+\":\"+sheet.changes.stack[i].command[0]+\" of \"+sheet.changes.stack[i].command.length+\"/\"+sheet.changes.stack[i].undo[0]+\" of \"+sheet.changes.stack[i].undo.length+\",\";\n\t   }\n\talert(cmdstr+\"|\"+sheet.changes.stack.length+\"--\"+ustack);\n\t*/return errortext;};SocialCalc.SheetUndo=function(sheet){var i;var tos=sheet.changes.TOS();var lastone=tos?tos.undo.length-1:-1;var cmdstr=\"\";for(i=lastone;i>=0;i--){// do them backwards\n\tif(cmdstr)cmdstr+=\"\\n\";// concatenate with separate lines\n\tcmdstr+=tos.undo[i];}sheet.changes.Undo();sheet.ScheduleSheetCommands(cmdstr,false);// do undo operations\n\t};SocialCalc.SheetRedo=function(sheet){var tos,i;var didredo=sheet.changes.Redo();if(!didredo){sheet.ScheduleSheetCommands(\"\",false);// schedule doing nothing\n\treturn;}tos=sheet.changes.TOS();var cmdstr=\"\";for(i=0;tos&&i<tos.command.length;i++){if(cmdstr)cmdstr+=\"\\n\";// concatenate with separate lines\n\tcmdstr+=tos.command[i];}sheet.ScheduleSheetCommands(cmdstr,false);// do undo operations\n\t};SocialCalc.CreateAuditString=function(sheet){var i,j;var result=\"\";var stack=sheet.changes.stack;var tos=sheet.changes.tos;for(i=0;i<=tos;i++){for(j=0;j<stack[i].command.length;j++){result+=stack[i].command[j]+\"\\n\";}}return result;};SocialCalc.GetStyleNum=function(sheet,atype,style){var num;if(style.length==0)return 0;// null means use zero, which means default or global default\n\tnum=sheet[atype+\"hash\"][style];if(!num){if(sheet[atype+\"s\"].length<1)sheet[atype+\"s\"].push(\"\");num=sheet[atype+\"s\"].push(style)-1;sheet[atype+\"hash\"][style]=num;sheet.changedrendervalues=true;}return num;};SocialCalc.GetStyleString=function(sheet,atype,num){if(!num)return null;// zero, null, and undefined return null\n\treturn sheet[atype+\"s\"][num];};//\n\t// updatedformula = SocialCalc.OffsetFormulaCoords(formula, coloffset, rowoffset)\n\t//\n\t// Change relative cell references by offsets (even those to other worksheets so fill, paste, sort work as expected).\n\t// If not what you want, use absolute references.\n\t//\n\tSocialCalc.OffsetFormulaCoords=function(formula,coloffset,rowoffset){var parseinfo,ttext,ttype,i,cr,newcr;var updatedformula=\"\";var scf=SocialCalc.Formula;if(!scf){return\"Need SocialCalc.Formula\";}var tokentype=scf.TokenType;var token_op=tokentype.op;var token_string=tokentype.string;var token_coord=tokentype.coord;var tokenOpExpansion=scf.TokenOpExpansion;parseinfo=scf.ParseFormulaIntoTokens(formula);for(i=0;i<parseinfo.length;i++){ttype=parseinfo[i].type;ttext=parseinfo[i].text;if(ttype==token_coord){newcr=\"\";cr=SocialCalc.coordToCr(ttext);if(ttext.charAt(0)!=\"$\"){// add col offset unless absolute column\n\tcr.col+=coloffset;}else{newcr+=\"$\";}newcr+=SocialCalc.rcColname(cr.col);if(ttext.indexOf(\"$\",1)==-1){// add row offset unless absolute row\n\tcr.row+=rowoffset;}else{newcr+=\"$\";}newcr+=cr.row;if(cr.row<1||cr.col<1){newcr=\"#REF!\";}updatedformula+=newcr;}else if(ttype==token_string){if(ttext.indexOf('\"')>=0){// quotes to double\n\tupdatedformula+='\"'+ttext.replace(/\"/,'\"\"')+'\"';}else updatedformula+='\"'+ttext+'\"';}else if(ttype==token_op){updatedformula+=tokenOpExpansion[ttext]||ttext;// make sure short tokens (e.g., \"G\") go back full (\">=\")\n\t}else{// leave everything else alone\n\tupdatedformula+=ttext;}}return updatedformula;};//\n\t// updatedformula = SocialCalc.AdjustFormulaCoords(formula, col, coloffset, row, rowoffset)\n\t//\n\t// Change all cell references to cells starting with col/row by offsets\n\t//\n\tSocialCalc.AdjustFormulaCoords=function(formula,col,coloffset,row,rowoffset){var ttype,ttext,i,newcr;var updatedformula=\"\";var sheetref=false;var scf=SocialCalc.Formula;if(!scf){return\"Need SocialCalc.Formula\";}var tokentype=scf.TokenType;var token_op=tokentype.op;var token_string=tokentype.string;var token_coord=tokentype.coord;var tokenOpExpansion=scf.TokenOpExpansion;parseinfo=SocialCalc.Formula.ParseFormulaIntoTokens(formula);for(i=0;i<parseinfo.length;i++){ttype=parseinfo[i].type;ttext=parseinfo[i].text;if(ttype==token_op){// references with sheet specifier are not offset\n\tif(ttext==\"!\"){sheetref=true;// found a sheet reference\n\t}else if(ttext!=\":\"){// for everything but a range, reset\n\tsheetref=false;}ttext=tokenOpExpansion[ttext]||ttext;// make sure short tokens (e.g., \"G\") go back full (\">=\")\n\t}if(ttype==token_coord){cr=SocialCalc.coordToCr(ttext);if(coloffset<0&&cr.col>=col&&cr.col<col-coloffset||rowoffset<0&&cr.row>=row&&cr.row<row-rowoffset){// refs to deleted cells become invalid\n\tif(!sheetref){cr.col=0;cr.row=0;}}if(!sheetref){if(cr.col>=col){cr.col+=coloffset;}if(cr.row>=row){cr.row+=rowoffset;}}if(ttext.charAt(0)==\"$\"){newcr=\"$\"+SocialCalc.rcColname(cr.col);}else{newcr=SocialCalc.rcColname(cr.col);}if(ttext.indexOf(\"$\",1)!=-1){newcr+=\"$\"+cr.row;}else{newcr+=cr.row;}if(cr.row<1||cr.col<1){newcr=\"#REF!\";}ttext=newcr;}else if(ttype==token_string){if(ttext.indexOf('\"')>=0){// quotes to double\n\tttext='\"'+ttext.replace(/\"/,'\"\"')+'\"';}else ttext='\"'+ttext+'\"';}updatedformula+=ttext;}return updatedformula;};//\n\t// updatedformula = SocialCalc.ReplaceFormulaCoords(formula, movedto)\n\t//\n\t// Change all cell references to cells that are keys in moveto to be to moveto[coord].\n\t// Don't change references to other sheets.\n\t// Handle range extents specially.\n\t//\n\tSocialCalc.ReplaceFormulaCoords=function(formula,movedto){var ttype,ttext,i,newcr,coord;var updatedformula=\"\";var sheetref=false;var scf=SocialCalc.Formula;if(!scf){return\"Need SocialCalc.Formula\";}var tokentype=scf.TokenType;var token_op=tokentype.op;var token_string=tokentype.string;var token_coord=tokentype.coord;var tokenOpExpansion=scf.TokenOpExpansion;parseinfo=SocialCalc.Formula.ParseFormulaIntoTokens(formula);for(i=0;i<parseinfo.length;i++){ttype=parseinfo[i].type;ttext=parseinfo[i].text;if(ttype==token_op){// references with sheet specifier are not change\n\tif(ttext==\"!\"){sheetref=true;// found a sheet reference\n\t}else if(ttext!=\":\"){// for everything but a range, reset\n\tsheetref=false;}//!!!! HANDLE RANGE EXTENT MOVES\n\tttext=tokenOpExpansion[ttext]||ttext;// make sure short tokens (e.g., \"G\") go back full (\">=\")\n\t}if(ttype==token_coord){cr=SocialCalc.coordToCr(ttext);// get parts\n\tcoord=SocialCalc.crToCoord(cr.col,cr.row);// get \"clean\" reference\n\tif(movedto[coord]&&!sheetref){// this is a reference to a moved cell\n\tcr=SocialCalc.coordToCr(movedto[coord]);// get new row and col\n\tif(ttext.charAt(0)==\"$\"){// copy absolute ref marks if present\n\tnewcr=\"$\"+SocialCalc.rcColname(cr.col);}else{newcr=SocialCalc.rcColname(cr.col);}if(ttext.indexOf(\"$\",1)!=-1){newcr+=\"$\"+cr.row;}else{newcr+=cr.row;}ttext=newcr;}}else if(ttype==token_string){if(ttext.indexOf('\"')>=0){// quotes to double\n\tttext='\"'+ttext.replace(/\"/,'\"\"')+'\"';}else ttext='\"'+ttext+'\"';}updatedformula+=ttext;}return updatedformula;};// ************************\n\t//\n\t// Recalc Loop Code\n\t//\n\t// ************************\n\t//\n\t// How recalc works:\n\t//\n\t// !!!!!!!!!!!!!!\n\t//\n\t// SocialCalc.RecalcInfo - object with global recalc info\n\tSocialCalc.RecalcInfo={sheet:null,// which sheet is being recalced\n\tcurrentState:0,// current state\n\tstate:{start_calc:1,order:2,calc:3,start_wait:4,done_wait:5},// allowed state values\n\trecalctimer:null,// value to cancel timer\n\tmaxtimeslice:100,// maximum milliseconds per slice of recalc time before a wait\n\ttimeslicedelay:1,// milliseconds to wait between recalc time slices\n\tstarttime:0,// when recalc started\n\t// LoadSheet: a function that returns true if started a load or false if not.\n\t//\n\tLoadSheet:function LoadSheet(sheetname){return false;}// default returns not found\n\t// SocialCalc.RecalcData - object with recalc info while determining recalc order and afterward\n\t};SocialCalc.RecalcData=function(){// initialize a RecalcData object\n\tthis.inrecalc=true;// if true, doing a recalc\n\tthis.celllist=[];// list with all potential cells to calculate\n\tthis.celllistitem=0;// cell to check next when ordering\n\tthis.calclist=null;// object which is the chained list of cells to calculate\n\t// each in the form of \"coord: nextcoord\"\n\t// e.g., if B8 is calculated right after A8, then calclist.A8==\"B8\"\n\t// if null, need to create the list\n\tthis.calclistlength=0;// number of items in calclist\n\tthis.firstcalc=null;// start of the calc list - a string or null\n\tthis.lastcalc=null;// last one on chain (used to add more to the end)\n\tthis.nextcalc=null;// used to keep track during background recalc to make it restartable\n\tthis.count=0;// number calculated\n\t// checkinfo is used when determining calc order:\n\tthis.checkinfo={};// attributes are coords; if no attrib for a coord, it wasn't checked or doesn't need it\n\t// values are RecalcCheckInfo objects while checking or TRUE when complete\n\t};// SocialCalc.RecalcCheckInfo - object that stores checking info while determining recalc order\n\tSocialCalc.RecalcCheckInfo=function(){// initialize a RecalcCheckInfo object\n\tthis.oldcoord=null;// chain back up of cells referring to cells\n\tthis.parsepos=0;// which token we are up to\n\t// range info\n\tthis.inrange=false;// if true, in the process of checking a range of coords\n\tthis.inrangestart=false;// if true, have not yet filled in range loop values\n\tthis.cr1=null;// range first coord as a cr object\n\tthis.cr2=null;// range second coord as a cr object\n\tthis.c1=null;// range extents\n\tthis.c2=null;this.r1=null;this.r2=null;this.c=null;// looping values\n\tthis.r=null;};// Recalc the entire sheet\n\tSocialCalc.RecalcSheet=function(sheet){var coord,err,recalcdata;var scri=SocialCalc.RecalcInfo;delete sheet.attribs.circularreferencecell;// reset recalc-wide things\n\tSocialCalc.Formula.FreshnessInfoReset();SocialCalc.RecalcClearTimeout();scri.sheet=sheet;// set values needed by background recalc\n\tscri.currentState=scri.state.start_calc;scri.starttime=new Date();if(sheet.statuscallback){sheet.statuscallback(scri,\"calcstart\",null,sheet.statuscallbackparams);}SocialCalc.RecalcSetTimeout();};//\n\t// SocialCalc.RecalcSetTimeout - set a timer for next recalc step\n\t//\n\tSocialCalc.RecalcSetTimeout=function(){var scri=SocialCalc.RecalcInfo;scri.recalctimer=window.setTimeout(SocialCalc.RecalcTimerRoutine,scri.timeslicedelay);};//\n\t// SocialCalc.RecalcClearTimeout - cancel any timeouts\n\t//\n\tSocialCalc.RecalcClearTimeout=function(){var scri=SocialCalc.RecalcInfo;if(scri.recalctimer){window.clearTimeout(scri.recalctimer);scri.recalctimer=null;}};//\n\t// SocialCalc.RecalcLoadedSheet(sheetname, str, recalcneeded)\n\t//\n\t// Called when a sheet finishes loading with name, string, and t/f whether it should be recalced.\n\t// If loaded sheet has sheet.attribs.recalc==\"off\", then no recalc done.\n\t// If sheetname is null, then the sheetname waiting for will be used.\n\t//\n\tSocialCalc.RecalcLoadedSheet=function(sheetname,str,recalcneeded){var sheet;var scri=SocialCalc.RecalcInfo;var scf=SocialCalc.Formula;sheet=SocialCalc.Formula.AddSheetToCache(sheetname||scf.SheetCache.waitingForLoading,str);if(recalcneeded&&sheet&&sheet.attribs.recalc!=\"off\"){// if recalcneeded, and not manual sheet, chain in this new sheet to recalc loop\n\tsheet.previousrecalcsheet=scri.sheet;scri.sheet=sheet;scri.currentState=scri.state.start_calc;}scf.SheetCache.waitingForLoading=null;SocialCalc.RecalcSetTimeout();};//\n\t// SocialCalc.RecalcTimerRoutine - handles the actual order determination and cell-by-cell recalculation in the background\n\t//\n\tSocialCalc.RecalcTimerRoutine=function(){var eresult,cell,coord,err,status;var starttime=new Date();var count=0;var scf=SocialCalc.Formula;if(!scf){return\"Need SocialCalc.Formula\";}var scri=SocialCalc.RecalcInfo;var sheet=scri.sheet;if(!sheet){return;}var recalcdata=sheet.recalcdata;var do_statuscallback=function do_statuscallback(status,arg){// routine to do callback if required\n\tif(sheet.statuscallback){sheet.statuscallback(recalcdata,status,arg,sheet.statuscallbackparams);}};SocialCalc.RecalcClearTimeout();if(scri.currentState==scri.state.start_calc){recalcdata=new SocialCalc.RecalcData();sheet.recalcdata=recalcdata;for(coord in sheet.cells){// get list of cells to check for order\n\tif(!coord)continue;recalcdata.celllist.push(coord);}recalcdata.calclist={};// start with empty list\n\tscri.currentState=scri.state.order;// drop through to determining recalc order\n\t}if(scri.currentState==scri.state.order){while(recalcdata.celllistitem<recalcdata.celllist.length){// check all the cells to see if they should be on the list\n\tcoord=recalcdata.celllist[recalcdata.celllistitem++];err=SocialCalc.RecalcCheckCell(sheet,coord);if(new Date()-starttime>=scri.maxtimeslice){// if taking too long, give up CPU for a while\n\tdo_statuscallback(\"calcorder\",{coord:coord,total:recalcdata.celllist.length,count:recalcdata.celllistitem});SocialCalc.RecalcSetTimeout();return;}}do_statuscallback(\"calccheckdone\",recalcdata.calclistlength);recalcdata.nextcalc=recalcdata.firstcalc;// start at the beginning of the recalc chain\n\tscri.currentState=scri.state.calc;// loop through cells on next timer call\n\tSocialCalc.RecalcSetTimeout();return;}if(scri.currentState==scri.state.start_wait){// starting to wait for something\n\tscri.currentState=scri.state.done_wait;// finished on next timer call\n\tif(scri.LoadSheet){status=scri.LoadSheet(scf.SheetCache.waitingForLoading);if(status){// started a load operation\n\treturn;}}SocialCalc.RecalcLoadedSheet(null,\"\",false);return;}if(scri.currentState==scri.state.done_wait){scri.currentState=scri.state.calc;// loop through cells on next timer call\n\tSocialCalc.RecalcSetTimeout();return;}// otherwise should be scri.state.calc\n\tif(scri.currentState!=scri.state.calc){alert(\"Recalc state error: \"+scri.currentState+\". Error in SocialCalc code.\");}coord=sheet.recalcdata.nextcalc;while(coord){cell=sheet.cells[coord];eresult=scf.evaluate_parsed_formula(cell.parseinfo,sheet,false);if(scf.SheetCache.waitingForLoading){// wait until restarted\n\trecalcdata.nextcalc=coord;// start with this cell again\n\trecalcdata.count+=count;do_statuscallback(\"calcloading\",{sheetname:scf.SheetCache.waitingForLoading});scri.currentState=scri.state.start_wait;// start load on next timer call\n\tSocialCalc.RecalcSetTimeout();return;}if(scf.RemoteFunctionInfo.waitingForServer){// wait until restarted\n\trecalcdata.nextcalc=coord;// start with this cell again\n\trecalcdata.count+=count;do_statuscallback(\"calcserverfunc\",{funcname:scf.RemoteFunctionInfo.waitingForServer,coord:coord,total:recalcdata.calclistlength,count:recalcdata.count});scri.currentState=scri.state.done_wait;// start load on next timer call\n\treturn;// return and wait for next recalc timer event\n\t}if(cell.datavalue!=eresult.value||cell.valuetype!=eresult.type){// only update if changed from last time\n\tcell.datavalue=eresult.value;cell.valuetype=eresult.type;delete cell.displaystring;sheet.recalcchangedavalue=true;// remember something changed in case other code wants to know\n\t}if(eresult.error){cell.errors=eresult.error;}count++;coord=sheet.recalcdata.calclist[coord];if(new Date()-starttime>=scri.maxtimeslice){// if taking too long, give up CPU for a while\n\trecalcdata.nextcalc=coord;// start with next cell on chain\n\trecalcdata.count+=count;do_statuscallback(\"calcstep\",{coord:coord,total:recalcdata.calclistlength,count:recalcdata.count});SocialCalc.RecalcSetTimeout();return;}}recalcdata.inrecalc=false;delete sheet.recalcdata;// save memory and clear out for name lookup formula evaluation\n\tdelete sheet.attribs.needsrecalc;// remember recalc done\n\tscri.sheet=sheet.previousrecalcsheet||null;// chain back if doing recalc of loaded sheets\n\tif(scri.sheet){scri.currentState=scri.state.calc;// start where we left off\n\tSocialCalc.RecalcSetTimeout();return;}scf.FreshnessInfo.recalc_completed=true;// say freshness info is complete\n\tdo_statuscallback(\"calcfinished\",new Date()-scri.starttime);};//\n\t// circref = SocialCalc.RecalcCheckCell(sheet, coord)\n\t//\n\t// Checks cell to put on calclist, looking at parsed tokens.\n\t// Also checks cells this cell is dependent upon\n\t// if it contains a formula with cell references.\n\t// If circular reference, returns non-null.\n\t//\n\tSocialCalc.RecalcCheckCell=function(sheet,startcoord){var parseinfo,ttext,ttype,i,rangecoord,circref,value,pos,pos2,cell,coordvals;var scf=SocialCalc.Formula;if(!scf){return\"Need SocialCalc.Formula\";}var tokentype=scf.TokenType;var token_op=tokentype.op;var token_name=tokentype.name;var token_coord=tokentype.coord;var recalcdata=sheet.recalcdata;var checkinfo=recalcdata.checkinfo;var sheetref=false;// if true, a sheet reference is in effect, so don't check that\n\tvar oldcoord=null;// coord of formula that referred to this one when checking down the tree\n\tvar coord=startcoord;// the coord of the cell we are checking\n\t// Start with requested cell, and then continue down or up the dependency tree\n\t// oldcoord (and checkinfo[coord].oldcoord) maintains the reference stack during the tree walk\n\t// checkinfo[coord] maintains the stack of checking looping values, e.g., token number being checked\n\tmainloop:while(coord){cell=sheet.cells[coord];coordvals=checkinfo[coord];if(!cell||cell.datatype!=\"f\"||// Don't calculate if not a formula\n\tcoordvals&&(typeof coordvals==='undefined'?'undefined':_typeof(coordvals))!=\"object\"){// Don't calc if already calculated\n\tcoord=oldcoord;// go back up dependency tree to coord that referred to us\n\tif(checkinfo[coord])oldcoord=checkinfo[coord].oldcoord;continue;}if(!coordvals){// do we have checking information about this cell?\n\tcoordvals=new SocialCalc.RecalcCheckInfo();// no - make a place to hold it\n\tcheckinfo[coord]=coordvals;}if(cell.errors){// delete errors from previous recalcs\n\tdelete cell.errors;}if(!cell.parseinfo){// cache parsed formula\n\tcell.parseinfo=scf.ParseFormulaIntoTokens(cell.formula);}parseinfo=cell.parseinfo;for(i=coordvals.parsepos;i<parseinfo.length;i++){// go through each token in formula\n\tif(coordvals.inrange){// processing a range of coords\n\tif(coordvals.inrangestart){// first time - fill in other values\n\tif(coordvals.cr1.col>coordvals.cr2.col){coordvals.c1=coordvals.cr2.col;coordvals.c2=coordvals.cr1.col;}else{coordvals.c1=coordvals.cr1.col;coordvals.c2=coordvals.cr2.col;}coordvals.c=coordvals.c1-1;// start one before\n\tif(coordvals.cr1.row>coordvals.cr2.row){coordvals.r1=coordvals.cr2.row;coordvals.r2=coordvals.cr1.row;}else{coordvals.r1=coordvals.cr1.row;coordvals.r2=coordvals.cr2.row;}coordvals.r=coordvals.r1;// start on this row\n\tcoordvals.inrangestart=false;}else{// not first time\n\t}coordvals.c+=1;// increment column\n\tif(coordvals.c>coordvals.c2){// finished the columns of this row\n\tcoordvals.r+=1;// increment row\n\tif(coordvals.r>coordvals.r2){// finished checking the entire range\n\tcoordvals.inrange=false;continue;}coordvals.c=coordvals.c1;// start at the beginning of next row\n\t}rangecoord=SocialCalc.crToCoord(coordvals.c,coordvals.r);// now check that one\n\tcoordvals.parsepos=i;// remember our position\n\tcoordvals.oldcoord=oldcoord;// remember back up chain\n\toldcoord=coord;// come back to us\n\tcoord=rangecoord;if(checkinfo[coord]&&_typeof(checkinfo[coord])==\"object\"){// Circular reference\n\tcell.errors=SocialCalc.Constants.s_caccCircRef+startcoord;// set on original cell making the ref\n\tcheckinfo[startcoord]=true;// this one should be calculated once at this point\n\tif(!recalcdata.firstcalc){recalcdata.firstcalc=startcoord;}else{recalcdata.calclist[recalcdata.lastcalc]=startcoord;}recalcdata.lastcalc=startcoord;recalcdata.calclistlength++;// count number on list\n\tsheet.attribs.circularreferencecell=coord+\"|\"+oldcoord;// remember at least one circ ref\n\treturn cell.errors;}continue mainloop;}ttype=parseinfo[i].type;// get token details\n\tttext=parseinfo[i].text;if(ttype==token_op){// references with sheet specifier are not checked\n\tif(ttext==\"!\"){sheetref=true;// found a sheet reference\n\t}else if(ttext!=\":\"){// for everything but a range, reset\n\tsheetref=false;}}if(ttype==token_name){// look for named range\n\tvalue=scf.LookupName(sheet,ttext);if(value.type==\"range\"){// only need to recurse here for range, which may be just one cell\n\tpos=value.value.indexOf(\"|\");if(pos!=-1){// range - check each cell\n\tcoordvals.cr1=SocialCalc.coordToCr(value.value.substring(0,pos));pos2=value.value.indexOf(\"|\",pos+1);coordvals.cr2=SocialCalc.coordToCr(value.value.substring(pos+1,pos2));coordvals.inrange=true;coordvals.inrangestart=true;i=i-1;// back up so will start up again here\n\tcontinue;}}else if(value.type==\"coord\"){// just a coord\n\tttype=token_coord;// treat as a coord inline\n\tttext=value.value;// and then drop through to next test which should succeed\n\t}else{// not a defined name - probably a function\n\t}}if(ttype==token_coord){// token is a coord\n\tif(i>=2// look for a range\n\t&&parseinfo[i-1].type==token_op&&parseinfo[i-1].text==':'&&parseinfo[i-2].type==token_coord&&!sheetref){// Range -- check each cell\n\tcoordvals.cr1=SocialCalc.coordToCr(parseinfo[i-2].text);// remember range extents\n\tcoordvals.cr2=SocialCalc.coordToCr(ttext);coordvals.inrange=true;// next time use the range looping code\n\tcoordvals.inrangestart=true;i=i-1;// back up so will start up again here\n\tcontinue;}else if(!sheetref){// Single cell reference\n\tif(ttext.indexOf(\"$\")!=-1)ttext=ttext.replace(/\\$/g,\"\");// remove any $'s\n\tcoordvals.parsepos=i+1;// remember our position - come back on next token\n\tcoordvals.oldcoord=oldcoord;// remember back up chain\n\toldcoord=coord;// come back to us\n\tcoord=ttext;if(checkinfo[coord]&&_typeof(checkinfo[coord])==\"object\"){// Circular reference\n\tcell.errors=SocialCalc.Constants.s_caccCircRef+startcoord;// set on original cell making the ref\n\tcheckinfo[startcoord]=true;// this one should be calculated once at this point\n\tif(!recalcdata.firstcalc){// add to calclist\n\trecalcdata.firstcalc=startcoord;}else{recalcdata.calclist[recalcdata.lastcalc]=startcoord;}recalcdata.lastcalc=startcoord;recalcdata.calclistlength++;// count number on list\n\tsheet.attribs.circularreferencecell=coord+\"|\"+oldcoord;// remember at least one circ ref\n\treturn cell.errors;}continue mainloop;}}}sheetref=false;// make sure off when bump back up\n\tcheckinfo[coord]=true;// this one is finished\n\tif(!recalcdata.firstcalc){// add to calclist\n\trecalcdata.firstcalc=coord;}else{recalcdata.calclist[recalcdata.lastcalc]=coord;}recalcdata.lastcalc=coord;recalcdata.calclistlength++;// count number on list\n\tcoord=oldcoord;// go back to the formula that referred to us and continue\n\toldcoord=checkinfo[coord]?checkinfo[coord].oldcoord:null;}return\"\";};// *************************************\n\t//\n\t// Parse class:\n\t//\n\t// Used by ExecuteSheetCommand to get elements of commands to execute.\n\t// The string it works with consists of one or more lines each\n\t// made up of one or more tokens separated by a delimiter.\n\t//\n\t// *************************************\n\t// Initialize: set string to work with\n\tSocialCalc.Parse=function(str){// properties:\n\tthis.str=str;this.pos=0;this.delimiter=\" \";this.lineEnd=str.indexOf(\"\\n\");if(this.lineEnd<0){this.lineEnd=str.length;}};// Return next token as a string\n\tSocialCalc.Parse.prototype.NextToken=function(){if(this.pos<0)return\"\";var pos2=this.str.indexOf(this.delimiter,this.pos);var pos1=this.pos;if(pos2>this.lineEnd){// don't go past end of line\n\tpos2=this.lineEnd;}if(pos2>=0){this.pos=pos2+1;return this.str.substring(pos1,pos2);}else{this.pos=this.lineEnd;return this.str.substring(pos1,this.lineEnd);}};// Return everything from current point until end of line\n\tSocialCalc.Parse.prototype.RestOfString=function(){var oldpos=this.pos;if(this.pos<0||this.pos>=this.lineEnd)return\"\";this.pos=this.lineEnd;return this.str.substring(oldpos,this.lineEnd);};SocialCalc.Parse.prototype.RestOfStringNoMove=function(){if(this.pos<0||this.pos>=this.lineEnd)return\"\";return this.str.substring(this.pos,this.lineEnd);};// Move current point to next line\n\tSocialCalc.Parse.prototype.NextLine=function(){this.pos=this.lineEnd+1;this.lineEnd=this.str.indexOf(\"\\n\",this.pos);if(this.lineEnd<0){this.lineEnd=this.str.length;}};// Check to see if at end of string with no more to process\n\tSocialCalc.Parse.prototype.EOF=function(){if(this.pos<0||this.pos>=this.str.length)return true;return false;};// *************************************\n\t//\n\t// UndoStack class:\n\t//\n\t// Implements the behavior needed for a normal application's undo/redo stack.\n\t// You add a new change sequence with PushChange.\n\t// The type argument is a string that can be used to lookup some general string \n\t// like \"typing\" or \"setting attribute\" for the menu prompts for undo/redo.\n\t//\n\t// You add the \"do\" steps with AddDo. The non-null, non-undefined arguments are\n\t// joined together with \" \" to make a command string to be saved.\n\t//\n\t// You add the undo steps as commands for the most recent change with AddUndo.\n\t// The non-null, non-undefined arguments are joined together with \" \" to make\n\t// a command string to be saved.\n\t//\n\t// The Undo and Redo functions move the Top Of Stack pointer through the changes stack\n\t// so you can undo and redo. Doing a new PushChange removes all undone items\n\t// after TOS.\n\t//\n\t// You can push more things than you can undo if you want.\n\t// There is a maximum to remember as the \"did\" stack for an audit trail (and as redo). This may be unlimited.\n\t// There is a separate maximum to remember that can be undone. This may be smaller than maxRedo.\n\t//\n\t// *************************************\n\tSocialCalc.UndoStack=function(){// properties:\n\tthis.stack=[];// {command: [], type: type, undo: []} -- multiple dos and undos allowed\n\tthis.tos=-1;// top of stack position, used for undo/redo\n\tthis.maxRedo=0;// Maximum size of redo stack (and audit trail which is this.stack[n].command) or zero if no limit\n\tthis.maxUndo=50;// Maximum number of steps kept for undo (usually the memory intensive part) or zero if no limit\n\t};SocialCalc.UndoStack.prototype.PushChange=function(type){// adding a new thing to the stack\n\twhile(this.stack.length>0&&this.stack.length-1>this.tos){// pop off things not redone\n\tthis.stack.pop();}this.stack.push({command:[],type:type,undo:[]});if(this.maxRedo&&this.stack.length>this.maxRedo){// limit number kept as audit trail\n\tthis.stack.shift();// remove the extra one\n\t}if(this.maxUndo&&this.stack.length>this.maxUndo){// need to trim excess undo info\n\tthis.stack[this.stack.length-this.maxUndo-1].undo=[];// only need to remove one\n\t}this.tos=this.stack.length-1;};SocialCalc.UndoStack.prototype.AddDo=function(){var args=[];for(var i=0;i<arguments.length;i++){if(arguments[i]!=null)args.push(arguments[i]);// ignore null or undefined\n\t}var cmd=args.join(\" \");this.stack[this.stack.length-1].command.push(cmd);};SocialCalc.UndoStack.prototype.AddUndo=function(){var args=[];for(var i=0;i<arguments.length;i++){if(arguments[i]!=null)args.push(arguments[i]);// ignore null or undefined\n\t}var cmd=args.join(\" \");this.stack[this.stack.length-1].undo.push(cmd);};SocialCalc.UndoStack.prototype.TOS=function(){if(this.tos>=0)return this.stack[this.tos];else return null;};SocialCalc.UndoStack.prototype.Undo=function(){if(this.tos>=0&&(!this.maxUndo||this.tos>this.stack.length-this.maxUndo-1)){this.tos-=1;return true;}else{return false;}};SocialCalc.UndoStack.prototype.Redo=function(){if(this.tos<this.stack.length-1){this.tos+=1;return true;}else{return false;}};// *************************************\n\t//\n\t// Clipboard Object:\n\t//\n\t// This is a single object.\n\t// Stores the clipboard, which is shared by all active sheets.\n\t// Like the undo stack, it does not persist from one editing session to another.\n\t//\n\t// *************************************\n\tSocialCalc.Clipboard={// properties:\n\tclipboard:\"\"// empty or string in save format with \"copiedfrom:\" set to a range\n\t// *************************************\n\t//\n\t// RenderContext class:\n\t//\n\t// *************************************\n\t};SocialCalc.RenderContext=function(sheetobj){var parts,num,s;var attribs=sheetobj.attribs;var scc=SocialCalc.Constants;// properties:\n\tthis.sheetobj=sheetobj;this.hideRowsCols=false;// Rendering with panes only works with \"false\"\n\t// !!!! Note: not implemented yet in rendering, just saved as an attribute\n\tthis.showGrid=false;this.showRCHeaders=false;this.rownamewidth=scc.defaultRowNameWidth;this.pixelsPerRow=scc.defaultAssumedRowHeight;this.cellskip={};// if present, coord of cell covering this cell\n\tthis.coordToCR={};// for cells starting spans, coordToCR[coord]={row:row, col:col}\n\tthis.colwidth=[];// precomputed column widths, taking into account defaults\n\tthis.totalwidth=0;// precomputed total table width\n\tthis.rowpanes=[];// for each pane, {first: firstrow, last: lastrow}\n\tthis.colpanes=[];// for each pane, {first: firstrow, last: lastrow}\n\tthis.maxcol=0;// max col and row to display, adding long spans, etc.\n\tthis.maxrow=0;this.highlights={};// for each cell with special display: coord:highlightType (see this.highlightTypes)\n\tthis.cursorsuffix=\"\";// added to highlights[cr]==\"cursor\" to get type to lookup\n\tthis.highlightTypes=// attributes to change when highlit\n\t{cursor:{style:scc.defaultHighlightTypeCursorStyle,className:scc.defaultHighlightTypeCursorClass},range:{style:scc.defaultHighlightTypeRangeStyle,className:scc.defaultHighlightTypeRangeClass},cursorinsertup:{style:\"color:#FFF;backgroundColor:#A6A6A6;backgroundRepeat:repeat-x;backgroundPosition:top left;backgroundImage:url(\"+scc.defaultImagePrefix+\"cursorinsertup.gif);\",className:scc.defaultHighlightTypeCursorClass},cursorinsertleft:{style:\"color:#FFF;backgroundColor:#A6A6A6;backgroundRepeat:repeat-y;backgroundPosition:top left;backgroundImage:url(\"+scc.defaultImagePrefix+\"cursorinsertleft.gif);\",className:scc.defaultHighlightTypeCursorClass},range2:{style:\"color:#000;backgroundColor:#FFF;backgroundImage:url(\"+scc.defaultImagePrefix+\"range2.gif);\",className:\"\"}};this.cellIDprefix=scc.defaultCellIDPrefix;// if non-null, each cell will render with an ID\n\tthis.defaultlinkstyle=null;// default linkstyle object (allows you to pass values to link renderer)\n\tthis.defaultHTMLlinkstyle={type:\"html\"};// default linkstyle for standalone HTML\n\t// constants:\n\tthis.defaultfontstyle=scc.defaultCellFontStyle;this.defaultfontsize=scc.defaultCellFontSize;this.defaultfontfamily=scc.defaultCellFontFamily;this.defaultlayout=scc.defaultCellLayout;this.defaultpanedividerwidth=scc.defaultPaneDividerWidth;this.defaultpanedividerheight=scc.defaultPaneDividerHeight;this.gridCSS=scc.defaultGridCSS;this.commentClassName=scc.defaultCommentClass;// for cells with non-blank comments when this.showGrid is true\n\tthis.commentCSS=scc.defaultCommentStyle;// any combination of classnames and styles may be used\n\tthis.commentNoGridClassName=scc.defaultCommentNoGridClass;// for cells when this.showGrid is false\n\tthis.commentNoGridCSS=scc.defaultCommentNoGridStyle;// any combination of classnames and styles may be used\n\tthis.classnames=// any combination of classnames and explicitStyles can be used\n\t{colname:scc.defaultColnameClass,rowname:scc.defaultRownameClass,selectedcolname:scc.defaultSelectedColnameClass,selectedrowname:scc.defaultSelectedRownameClass,upperleft:scc.defaultUpperLeftClass,skippedcell:scc.defaultSkippedCellClass,panedivider:scc.defaultPaneDividerClass};this.explicitStyles=// these may be used so you won't need a stylesheet with the classnames\n\t{colname:scc.defaultColnameStyle,rowname:scc.defaultRownameStyle,selectedcolname:scc.defaultSelectedColnameStyle,selectedrowname:scc.defaultSelectedRownameStyle,upperleft:scc.defaultUpperLeftStyle,skippedcell:scc.defaultSkippedCellStyle,panedivider:scc.defaultPaneDividerStyle};// processed info about cell skipping\n\tthis.cellskip=null;this.needcellskip=true;// precomputed values, filling in defaults indicated by \"*\"\n\tthis.fonts=[];// for each fontnum, {style: fs, weight: fw, size: fs, family: ff}\n\tthis.layouts=[];// for each layout, \"padding:Tpx Rpx Bpx Lpx;vertical-align:va;\"\n\tthis.needprecompute=true;// need to call PrecomputeSheetFontsAndLayouts\n\t// if have a sheet object, initialize constants and precomputed values\n\tif(sheetobj){this.rowpanes[0]={first:1,last:attribs.lastrow};this.colpanes[0]={first:1,last:attribs.lastcol};}else throw scc.s_rcMissingSheet;};// Methods:\n\tSocialCalc.RenderContext.prototype.PrecomputeSheetFontsAndLayouts=function(){SocialCalc.PrecomputeSheetFontsAndLayouts(this);};SocialCalc.RenderContext.prototype.CalculateCellSkipData=function(){SocialCalc.CalculateCellSkipData(this);};SocialCalc.RenderContext.prototype.CalculateColWidthData=function(){SocialCalc.CalculateColWidthData(this);};SocialCalc.RenderContext.prototype.SetRowPaneFirstLast=function(panenum,first,last){this.rowpanes[panenum]={first:first,last:last};};SocialCalc.RenderContext.prototype.SetColPaneFirstLast=function(panenum,first,last){this.colpanes[panenum]={first:first,last:last};};SocialCalc.RenderContext.prototype.CoordInPane=function(coord,rowpane,colpane){return SocialCalc.CoordInPane(this,coord,rowpane,colpane);};SocialCalc.RenderContext.prototype.CellInPane=function(row,col,rowpane,colpane){return SocialCalc.CellInPane(this,row,col,rowpane,colpane);};SocialCalc.RenderContext.prototype.InitializeTable=function(tableobj){SocialCalc.InitializeTable(this,tableobj);};SocialCalc.RenderContext.prototype.RenderSheet=function(oldtable,linkstyle){return SocialCalc.RenderSheet(this,oldtable,linkstyle);};SocialCalc.RenderContext.prototype.RenderColGroup=function(){return SocialCalc.RenderColGroup(this);};SocialCalc.RenderContext.prototype.RenderColHeaders=function(){return SocialCalc.RenderColHeaders(this);};SocialCalc.RenderContext.prototype.RenderSizingRow=function(){return SocialCalc.RenderSizingRow(this);};SocialCalc.RenderContext.prototype.RenderRow=function(rownum,rowpane,linkstyle){return SocialCalc.RenderRow(this,rownum,rowpane,linkstyle);};SocialCalc.RenderContext.prototype.RenderSpacingRow=function(){return SocialCalc.RenderSpacingRow(this);};SocialCalc.RenderContext.prototype.RenderCell=function(rownum,colnum,rowpane,colpane,noElement,linkstyle){return SocialCalc.RenderCell(this,rownum,colnum,rowpane,colpane,noElement,linkstyle);};// Functions:\n\tSocialCalc.PrecomputeSheetFontsAndLayouts=function(context){var defaultfont,parts,layoutre,dparts,sparts,num,s,i;var sheetobj=context.sheetobj;var attribs=sheetobj.attribs;if(attribs.defaultfont){defaultfont=sheetobj.fonts[attribs.defaultfont];defaultfont=defaultfont.replace(/^\\*/,SocialCalc.Constants.defaultCellFontStyle);defaultfont=defaultfont.replace(/(.+)\\*(.+)/,\"$1\"+SocialCalc.Constants.defaultCellFontSize+\"$2\");defaultfont=defaultfont.replace(/\\*$/,SocialCalc.Constants.defaultCellFontFamily);parts=defaultfont.match(/^(\\S+? \\S+?) (\\S+?) (\\S.*)$/);context.defaultfontstyle=parts[1];context.defaultfontsize=parts[2];context.defaultfontfamily=parts[3];}for(num=1;num<sheetobj.fonts.length;num++){// precompute fonts by filling in the *'s\n\ts=sheetobj.fonts[num];s=s.replace(/^\\*/,context.defaultfontstyle);s=s.replace(/(.+)\\*(.+)/,\"$1\"+context.defaultfontsize+\"$2\");s=s.replace(/\\*$/,context.defaultfontfamily);parts=s.match(/^(\\S+?) (\\S+?) (\\S+?) (\\S.*)$/);context.fonts[num]={style:parts[1],weight:parts[2],size:parts[3],family:parts[4]};}layoutre=/^padding:\\s*(\\S+)\\s+(\\S+)\\s+(\\S+)\\s+(\\S+);vertical-align:\\s*(\\S+);/;dparts=SocialCalc.Constants.defaultCellLayout.match(layoutre);// get built-in defaults\n\tif(attribs.defaultlayout){sparts=sheetobj.layouts[attribs.defaultlayout].match(layoutre);// get sheet defaults, if set\n\t}else{sparts=[\"\",\"*\",\"*\",\"*\",\"*\",\"*\"];}for(num=1;num<sheetobj.layouts.length;num++){// precompute layouts by filling in the *'s\n\ts=sheetobj.layouts[num];parts=s.match(layoutre);for(i=1;i<=5;i++){if(parts[i]==\"*\"){parts[i]=sparts[i]!=\"*\"?sparts[i]:dparts[i];// if *, sheet default or built-in\n\t}}context.layouts[num]=\"padding:\"+parts[1]+\" \"+parts[2]+\" \"+parts[3]+\" \"+parts[4]+\";vertical-align:\"+parts[5]+\";\";}context.needprecompute=false;};SocialCalc.CalculateCellSkipData=function(context){var row,col,coord,cell,contextcell,colspan,rowspan,skiprow,skipcol,skipcoord;var sheetobj=context.sheetobj;var sheetrowattribs=sheetobj.rowattribs;var sheetcolattribs=sheetobj.colattribs;context.maxrow=0;context.maxcol=0;context.cellskip={};// reset\n\t// Calculate cellskip data\n\tfor(row=1;row<=sheetobj.attribs.lastrow;row++){for(col=1;col<=sheetobj.attribs.lastcol;col++){// look for spans and set cellskip for skipped cells\n\tcoord=SocialCalc.crToCoord(col,row);cell=sheetobj.cells[coord];// don't look at undefined cells (they have no spans) or skipped cells\n\tif(cell===undefined||context.cellskip[coord])continue;colspan=cell.colspan||1;rowspan=cell.rowspan||1;if(colspan>1||rowspan>1){for(skiprow=row;skiprow<row+rowspan;skiprow++){for(skipcol=col;skipcol<col+colspan;skipcol++){// do the setting on individual cells\n\tskipcoord=SocialCalc.crToCoord(skipcol,skiprow);if(skipcoord==coord){// for coord, remember row and col\n\tcontext.coordToCR[coord]={row:row,col:col};}else{// for other cells, flag with coord of here\n\tcontext.cellskip[skipcoord]=coord;}if(skiprow>context.maxrow)maxrow=skiprow;if(skipcol>context.maxcol)maxcol=skipcol;}}}}}context.needcellskip=false;};SocialCalc.CalculateColWidthData=function(context){var colnum,colname,colwidth,totalwidth;var sheetobj=context.sheetobj;var sheetcolattribs=sheetobj.colattribs;// Calculate column width data\n\ttotalwidth=context.showRCHeaders?context.rownamewidth-0:0;for(colpane=0;colpane<context.colpanes.length;colpane++){for(colnum=context.colpanes[colpane].first;colnum<=context.colpanes[colpane].last;colnum++){colname=SocialCalc.rcColname(colnum);colwidth=sheetobj.colattribs.width[colname]||sheetobj.attribs.defaultcolwidth||SocialCalc.Constants.defaultColWidth;if(colwidth==\"blank\"||colwidth==\"auto\")colwidth=\"\";context.colwidth[colnum]=colwidth+\"\";totalwidth+=colwidth&&colwidth-0>0?colwidth-0:10;}}context.totalwidth=totalwidth;};SocialCalc.InitializeTable=function(context,tableobj){/*\n\t\n\tUses border-collapse so corners don't have holes\n\tNote: IE and Firefox handle <col> differently (IE adds borders and padding)\n\tunder border-collapse and Safari has problems with <col> and wide text\n\tTablelayout \"fixed\" also leads to problems\n\t\n\t*//*\n\t\n\t*** Discussion ***\n\t\n\tThe rendering assumes fixed column widths, even though SocialCalc allows \"auto\".\n\tThere may be issues with \"auto\" and it is hard to make it work cross-browser\n\twith border-collapse, etc.\n\t\n\tThis and the RenderSheet routine are where in the code the specifics of\n\ttable attributes and column size definitions are set. As the browsers settle down\n\tand when we decide if we don't need auto width, we may want to revisit the way the\n\tcode does this (e.g., use table-layout:fixed).\n\t\n\t*/tableobj.style.borderCollapse=\"collapse\";tableobj.cellSpacing=\"0\";tableobj.cellPadding=\"0\";tableobj.style.width=context.totalwidth+\"px\";};//\n\t// tableobj = SocialCalc.RenderSheet(context, oldtable, linkstyle)\n\t//\n\t// Renders a render context returning a DOM table object.\n\t// If there is an oldtable object, it replaces it in the parent node.\n\t// If oldtable is null, it just returns the new one.\n\t// The linkstyle is \"\" or null for editing rendering\n\t// and optionally an object passed on to formatting code.\n\t//\n\tSocialCalc.RenderSheet=function(context,oldtable,linkstyle){var newrow,rowpane;var tableobj,colgroupobj,tbodyobj,parentnode;// do precompute stuff if necessary\n\tif(context.sheetobj.changedrendervalues){context.needcellskip=true;context.needprecompute=true;context.sheetobj.changedrendervalues=false;}if(context.needcellskip){context.CalculateCellSkipData();}if(context.needprecompute){context.PrecomputeSheetFontsAndLayouts();}context.CalculateColWidthData();// always make sure col width values are up to date\n\t// make the table element and fill it in\n\ttableobj=document.createElement(\"table\");context.InitializeTable(tableobj);colgroupobj=context.RenderColGroup();tableobj.appendChild(colgroupobj);tbodyobj=document.createElement(\"tbody\");tbodyobj.appendChild(context.RenderSizingRow());if(context.showRCHeaders){newrow=context.RenderColHeaders();if(newrow)tbodyobj.appendChild(newrow);}for(rowpane=0;rowpane<context.rowpanes.length;rowpane++){for(rownum=context.rowpanes[rowpane].first;rownum<=context.rowpanes[rowpane].last;rownum++){newrow=context.RenderRow(rownum,rowpane,linkstyle);tbodyobj.appendChild(newrow);}if(rowpane<context.rowpanes.length-1){newrow=context.RenderSpacingRow();tbodyobj.appendChild(newrow);}}tableobj.appendChild(tbodyobj);if(oldtable){parentnode=oldtable.parentNode;if(parentnode)parentnode.replaceChild(tableobj,oldtable);}SocialCalc.EvalUserScripts();return tableobj;};SocialCalc.RenderRow=function(context,rownum,rowpane,linkstyle){var sheetobj=context.sheetobj;var result=document.createElement(\"tr\");var colnum,newcol,colpane,newdiv;if(context.showRCHeaders){newcol=document.createElement(\"td\");if(context.classnames)newcol.className=context.classnames.rowname;if(context.explicitStyles)newcol.style.cssText=context.explicitStyles.rowname;newcol.width=context.rownamewidth;newcol.style.verticalAlign=\"top\";// to get around Safari making top of centered row number be\n\t// considered top of row (and can't get <row> position in Safari)\n\tif(!SocialCalc.Constants.SCNoRowName){newcol.innerHTML=rownum+\"\";}result.appendChild(newcol);}for(colpane=0;colpane<context.colpanes.length;colpane++){for(colnum=context.colpanes[colpane].first;colnum<=context.colpanes[colpane].last;colnum++){newcol=context.RenderCell(rownum,colnum,rowpane,colpane,null,linkstyle);if(newcol)result.appendChild(newcol);}if(colpane<context.colpanes.length-1){newcol=document.createElement(\"td\");newcol.width=context.defaultpanedividerwidth;if(context.classnames.panedivider)newcol.className=context.classnames.panedivider;if(context.explicitStyles.panedivider)newcol.style.cssText=context.explicitStyles.panedivider;newdiv=document.createElement(\"div\");// for Firefox to avoid squishing\n\tnewdiv.style.width=context.defaultpanedividerwidth+\"px\";newdiv.style.overflow=\"hidden\";newcol.appendChild(newdiv);result.appendChild(newcol);}}return result;};SocialCalc.RenderSpacingRow=function(context){var colnum,newcol,colpane,w;var sheetobj=context.sheetobj;var result=document.createElement(\"tr\");if(context.showRCHeaders){newcol=document.createElement(\"td\");newcol.width=context.rownamewidth;newcol.height=context.defaultpanedividerheight;if(context.classnames.panedivider)newcol.className=context.classnames.panedivider;if(context.explicitStyles.panedivider)newcol.style.cssText=context.explicitStyles.panedivider;result.appendChild(newcol);}for(colpane=0;colpane<context.colpanes.length;colpane++){for(colnum=context.colpanes[colpane].first;colnum<=context.colpanes[colpane].last;colnum++){newcol=document.createElement(\"td\");w=context.colwidth[colnum];if(w)newcol.width=w;newcol.height=context.defaultpanedividerheight;if(context.classnames.panedivider)newcol.className=context.classnames.panedivider;if(context.explicitStyles.panedivider)newcol.style.cssText=context.explicitStyles.panedivider;if(newcol)result.appendChild(newcol);}if(colpane<context.colpanes.length-1){newcol=document.createElement(\"td\");newcol.width=context.defaultpanedividerwidth;newcol.height=context.defaultpanedividerheight;if(context.classnames.panedivider)newcol.className=context.classnames.panedivider;if(context.explicitStyles.panedivider)newcol.style.cssText=context.explicitStyles.panedivider;result.appendChild(newcol);}}return result;};SocialCalc.RenderColHeaders=function(context){var sheetobj=context.sheetobj;var result=document.createElement(\"tr\");var colnum,newcol;if(!context.showRCHeaders)return null;newcol=document.createElement(\"td\");if(context.classnames)newcol.className=context.classnames.upperleft;if(context.explicitStyles)newcol.style.cssText=context.explicitStyles.upperleft;newcol.width=context.rownamewidth;result.appendChild(newcol);for(colpane=0;colpane<context.colpanes.length;colpane++){for(colnum=context.colpanes[colpane].first;colnum<=context.colpanes[colpane].last;colnum++){newcol=document.createElement(\"td\");if(context.classnames)newcol.className=context.classnames.colname;if(context.explicitStyles)newcol.style.cssText=context.explicitStyles.colname;if(SocialCalc.Constants.SCNoColNames){// newcol.innerHTML=\"&nbsp;\";\n\t// newcol.innerHTML=\"\";\n\t}else{newcol.innerHTML=SocialCalc.rcColname(colnum);}result.appendChild(newcol);}if(colpane<context.colpanes.length-1){newcol=document.createElement(\"td\");newcol.width=context.defaultpanedividerwidth;if(context.classnames.panedivider)newcol.className=context.classnames.panedivider;if(context.explicitStyles.panedivider)newcol.style.cssText=context.explicitStyles.panedivider;result.appendChild(newcol);}}return result;};SocialCalc.RenderColGroup=function(context){var colpane,colnum,newcol,t;var sheetobj=context.sheetobj;var result=document.createElement(\"colgroup\");if(context.showRCHeaders){newcol=document.createElement(\"col\");newcol.width=context.rownamewidth;result.appendChild(newcol);}for(colpane=0;colpane<context.colpanes.length;colpane++){for(colnum=context.colpanes[colpane].first;colnum<=context.colpanes[colpane].last;colnum++){newcol=document.createElement(\"col\");t=context.colwidth[colnum];if(t)newcol.width=t;result.appendChild(newcol);}if(colpane<context.colpanes.length-1){newcol=document.createElement(\"col\");newcol.width=context.defaultpanedividerwidth;result.appendChild(newcol);}}return result;};SocialCalc.RenderSizingRow=function(context){var colpane,colnum,newcell,t;var sheetobj=context.sheetobj;var result=document.createElement(\"tr\");if(context.showRCHeaders){newcell=document.createElement(\"td\");newcell.style.width=context.rownamewidth+\"px\";newcell.height=\"1\";result.appendChild(newcell);}for(colpane=0;colpane<context.colpanes.length;colpane++){for(colnum=context.colpanes[colpane].first;colnum<=context.colpanes[colpane].last;colnum++){newcell=document.createElement(\"td\");t=context.colwidth[colnum];if(t)newcell.width=t;newcell.height=\"1\";result.appendChild(newcell);}if(colpane<context.colpanes.length-1){newcell=document.createElement(\"td\");newcell.width=context.defaultpanedividerwidth;newcell.height=\"1\";result.appendChild(newcell);}}return result;};SocialCalc.RenderCell=function(context,rownum,colnum,rowpane,colpane,noElement,linkstyle){var sheetobj=context.sheetobj;var num,t,result,span,stylename,cell,sheetattribs,scdefaults;var stylestr=\"\";rownum=rownum-0;// make sure a number\n\tcolnum=colnum-0;var coord=SocialCalc.crToCoord(colnum,rownum);if(context.cellskip[coord]){// skip if within a span\n\tif(context.CoordInPane(context.cellskip[coord],rowpane,colpane)){return null;// span starts in this pane -- so just skip\n\t}result=noElement?SocialCalc.CreatePseudoElement():document.createElement(\"td\");// span start is scrolled away, so make a special cell\n\tif(context.classnames.skippedcell)result.className=context.classnames.skippedcell;if(context.explicitStyles.skippedcell)result.style.cssText=context.explicitStyles.skippedcell;result.innerHTML=\"&nbsp;\";// put something there so height is OK\n\t// !!! Really need to add borders in case there isn't anything else shown in the pane to get height\n\treturn result;}result=noElement?SocialCalc.CreatePseudoElement():document.createElement(\"td\");if(context.cellIDprefix){result.id=context.cellIDprefix+coord;}cell=sheetobj.cells[coord];if(!cell){cell=new SocialCalc.Cell(coord);}sheetattribs=sheetobj.attribs;scc=SocialCalc.Constants;if(cell.colspan>1){span=1;for(num=1;num<cell.colspan;num++){if(sheetobj.colattribs.hide[SocialCalc.rcColname(colnum+num)]!=\"yes\"&&context.CellInPane(rownum,colnum+num,rowpane,colpane)){span++;}}result.colSpan=span;}if(cell.rowspan>1){span=1;for(num=1;num<cell.rowspan;num++){if(sheetobj.rowattribs.hide[rownum+num+\"\"]!=\"yes\"&&context.CellInPane(rownum+num,colnum,rowpane,colpane))span++;}result.rowSpan=span;}if(cell.displaystring==undefined){// cache the display value\n\tcell.displaystring=SocialCalc.FormatValueForDisplay(sheetobj,cell.datavalue,coord,linkstyle||context.defaultlinkstyle);}else{// callout to execute scripts if needed\n\tSocialCalc.CallOutOnRenderCell(sheetobj,cell.datavalue,coord);}result.innerHTML=cell.displaystring;num=cell.layout||sheetattribs.defaultlayout;if(num){stylestr+=context.layouts[num];// use precomputed layout with \"*\"'s filled in\n\t}else{stylestr+=scc.defaultCellLayout;}num=cell.font||sheetattribs.defaultfont;if(num){// get expanded font strings in context\n\tt=context.fonts[num];// do each - plain \"font:\" style sets all sorts of other values, too (Safari font-stretch problem on cssText)\n\tstylestr+=\"font-style:\"+t.style+\";font-weight:\"+t.weight+\";font-size:\"+t.size+\";font-family:\"+t.family+\";\";}else{if(scc.defaultCellFontSize){stylestr+=\"font-size:\"+scc.defaultCellFontSize+\";\";}if(scc.defaultCellFontFamily){stylestr+=\"font-family:\"+scc.defaultCellFontFamily+\";\";}}num=cell.color||sheetattribs.defaultcolor;if(num)stylestr+=\"color:\"+sheetobj.colors[num]+\";\";num=cell.bgcolor||sheetattribs.defaultbgcolor;if(num)stylestr+=\"background-color:\"+sheetobj.colors[num]+\";\";num=cell.cellformat;if(num){stylestr+=\"text-align:\"+sheetobj.cellformats[num]+\";\";}else{t=cell.valuetype.charAt(0);if(t==\"t\"){num=sheetattribs.defaulttextformat;if(num)stylestr+=\"text-align:\"+sheetobj.cellformats[num]+\";\";}else if(t=\"n\"){num=sheetattribs.defaultnontextformat;if(num){stylestr+=\"text-align:\"+sheetobj.cellformats[num]+\";\";}else{stylestr+=\"text-align:right;\";}}else stylestr+=\"text-align:left;\";}num=cell.bt;if(num)stylestr+=\"border-top:\"+sheetobj.borderstyles[num]+\";\";num=cell.br;if(num)stylestr+=\"border-right:\"+sheetobj.borderstyles[num]+\";\";else if(context.showGrid){if(context.CellInPane(rownum,colnum+(cell.colspan||1),rowpane,colpane))t=SocialCalc.crToCoord(colnum+(cell.colspan||1),rownum);else t=\"nomatch\";if(context.cellskip[t])t=context.cellskip[t];if(!sheetobj.cells[t]||!sheetobj.cells[t].bl)stylestr+=\"border-right:\"+context.gridCSS;}num=cell.bb;if(num)stylestr+=\"border-bottom:\"+sheetobj.borderstyles[num]+\";\";else if(context.showGrid){if(context.CellInPane(rownum+(cell.rowspan||1),colnum,rowpane,colpane))t=SocialCalc.crToCoord(colnum,rownum+(cell.rowspan||1));else t=\"nomatch\";if(context.cellskip[t])t=context.cellskip[t];if(!sheetobj.cells[t]||!sheetobj.cells[t].bt)stylestr+=\"border-bottom:\"+context.gridCSS;}num=cell.bl;if(num)stylestr+=\"border-left:\"+sheetobj.borderstyles[num]+\";\";if(cell.comment){if(context.showGrid){if(context.commentClassName){result.className=(result.className?result.className+\" \":\"\")+context.commentClassName;}stylestr+=context.commentCSS;}else{if(context.commentNoGridClassName){result.className=(result.className?result.className+\" \":\"\")+context.commentNoGridClassName;}stylestr+=context.commentNoGridCSS;}}result.style.cssText=stylestr;//!!!!!!!!!\n\t// NOTE: csss and cssc are not supported yet.\n\t// csss needs to be parsed into pieces to override just the attributes specified, not all with assignment to cssText.\n\t// cssc just needs to set the className.\n\tt=context.highlights[coord];if(t){// this is a highlit cell: Override style appropriately\n\tif(t==\"cursor\")t+=context.cursorsuffix;// cursor can take alternative forms\n\tif(context.highlightTypes[t].className){result.className=(result.className?result.className+\" \":\"\")+context.highlightTypes[t].className;}// only if cell is editable, set the cursor class\n\tif(t==\"cursor\"&&SocialCalc.Callbacks.IsCoordEditable&&!SocialCalc.Callbacks.IsCoordEditable(context.sheetobj.sheetname+\"!\"+coord)){SocialCalc.setStyles(result,\"\");}else{SocialCalc.setStyles(result,context.highlightTypes[t].style);}}return result;};SocialCalc.CoordInPane=function(context,coord,rowpane,colpane){var coordToCR=context.coordToCR[coord];if(!coordToCR||!coordToCR.row||!coordToCR.col)throw\"Bad coordToCR for \"+coord;return context.CellInPane(coordToCR.row,coordToCR.col,rowpane,colpane);};SocialCalc.CellInPane=function(context,row,col,rowpane,colpane){var panerowlimits=context.rowpanes[rowpane];var panecollimits=context.colpanes[colpane];if(!panerowlimits||!panecollimits)throw\"CellInPane called with unknown panes \"+rowpane+\"/\"+colpane;if(row<panerowlimits.first||row>panerowlimits.last)return false;if(col<panecollimits.first||col>panecollimits.last)return false;return true;};SocialCalc.CreatePseudoElement=function(){return{style:{cssText:\"\"},innerHTML:\"\",className:\"\"};};// *************************************\n\t//\n\t// Misc. functions:\n\t//\n\t// *************************************\n\tSocialCalc.rcColname=function(c){if(c>702)c=702;// maximum number of columns - ZZ\n\tif(c<1)c=1;var collow=(c-1)%26+65;var colhigh=Math.floor((c-1)/26);if(colhigh)return String.fromCharCode(colhigh+64)+String.fromCharCode(collow);else return String.fromCharCode(collow);};SocialCalc.letters=[\"A\",\"B\",\"C\",\"D\",\"E\",\"F\",\"G\",\"H\",\"I\",\"J\",\"K\",\"L\",\"M\",\"N\",\"O\",\"P\",\"Q\",\"R\",\"S\",\"T\",\"U\",\"V\",\"W\",\"X\",\"Y\",\"Z\"];SocialCalc.crToCoord=function(c,r){var result;if(c<1)c=1;if(c>702)c=702;// maximum number of columns - ZZ\n\tif(r<1)r=1;var collow=(c-1)%26;var colhigh=Math.floor((c-1)/26);if(colhigh)result=SocialCalc.letters[colhigh-1]+SocialCalc.letters[collow]+r;else result=SocialCalc.letters[collow]+r;return result;};SocialCalc.coordToCol={};// too expensive to set in crToCoord since that is called so many times\n\tSocialCalc.coordToRow={};SocialCalc.coordToCr=function(cr){var c,i,ch;var r=SocialCalc.coordToRow[cr];if(r)return{row:r,col:SocialCalc.coordToCol[cr]};c=0;r=0;for(i=0;i<cr.length;i++){// this was faster than using regexes; assumes well-formed\n\tch=cr.charCodeAt(i);if(ch==36);// skip $'s\n\telse if(ch<=57)r=10*r+ch-48;else if(ch>=97)c=26*c+ch-96;else if(ch>=65)c=26*c+ch-64;}SocialCalc.coordToCol[cr]=c;SocialCalc.coordToRow[cr]=r;return{row:r,col:c};};SocialCalc.ParseRange=function(range){var pos,cr,cr1,cr2;if(!range)range=\"A1:A1\";// error return, hopefully benign\n\trange=range.toUpperCase();pos=range.indexOf(\":\");if(pos>=0){cr=range.substring(0,pos);cr1=SocialCalc.coordToCr(cr);cr1.coord=cr;cr=range.substring(pos+1);cr2=SocialCalc.coordToCr(cr);cr2.coord=cr;}else{cr1=SocialCalc.coordToCr(range);cr1.coord=range;cr2=SocialCalc.coordToCr(range);cr2.coord=range;}return{cr1:cr1,cr2:cr2};};SocialCalc.decodeFromSave=function(s){if(typeof s!=\"string\")return s;if(s.indexOf(\"\\\\\")==-1)return s;// for performace reasons: replace nothing takes up time\n\tvar r=s.replace(/\\\\c/g,\":\");r=r.replace(/\\\\n/g,\"\\n\");return r.replace(/\\\\b/g,\"\\\\\");};SocialCalc.decodeFromAjax=function(s){if(typeof s!=\"string\")return s;if(s.indexOf(\"\\\\\")==-1)return s;// for performace reasons: replace nothing takes up time\n\tvar r=s.replace(/\\\\c/g,\":\");r=r.replace(/\\\\n/g,\"\\n\");r=r.replace(/\\\\e/g,\"]]\");return r.replace(/\\\\b/g,\"\\\\\");};SocialCalc.encodeForSave=function(s){if(typeof s!=\"string\")return s;if(s.indexOf(\"\\\\\")!=-1)// for performace reasons: replace nothing takes up time\n\ts=s.replace(/\\\\/g,\"\\\\b\");if(s.indexOf(\":\")!=-1)s=s.replace(/:/g,\"\\\\c\");if(s.indexOf(\"\\n\")!=-1)s=s.replace(/\\n/g,\"\\\\n\");return s;};//\n\t// Returns estring where &, <, >, \" are HTML escaped\n\t// \n\tSocialCalc.special_chars=function(string){if(/[&<>\"]/.test(string)){// only do \"slow\" replaces if something to replace\n\tstring=string.replace(/&/g,\"&amp;\");string=string.replace(/</g,\"&lt;\");string=string.replace(/>/g,\"&gt;\");string=string.replace(/\"/g,\"&quot;\");}return string;};SocialCalc.Lookup=function(value,list){for(i=0;i<list.length;i++){if(list[i]>value){if(i>0)return i-1;else return null;}}return list.length-1;// if all smaller, matches last\n\t};//\n\t// setStyles(element, cssText)\n\t//\n\t// Takes a pseudo style string (e.g., text-align must be textAlign) and sets\n\t// the element's style value for each style name listed (leaving others unchanged).\n\t// OK to call with null cssText.\n\t//\n\tSocialCalc.setStyles=function(element,cssText){var parts,part,pos,name,value;if(!cssText)return;parts=cssText.split(\";\");for(part=0;part<parts.length;part++){pos=parts[part].indexOf(\":\");// find first colon (could be one in url)\n\tif(pos!=-1){name=parts[part].substring(0,pos);value=parts[part].substring(pos+1);if(name&&value){// if non-null name and value, set style\n\telement.style[name]=value;}}//      namevalue = parts[part].split(\":\");\n\t//      if (namevalue[0]) element.style[namevalue[0]] = namevalue[1];\n\t}};//\n\t// GetViewportInfo() - returns object with viewport width and height, and scroll offsets\n\t//\n\t// Flanagan, JavaScript, 5th Edition, page 276\n\t//\n\tSocialCalc.GetViewportInfo=function(){var result={};if(window.innerWidth){// all but IE\n\tresult.width=window.innerWidth;result.height=window.innerHeight;result.horizontalScroll=window.pageXOffset;result.verticalScroll=window.pageYOffset;}else{if(document.documentElement&&document.documentElement.clientWidth){result.width=document.documentElement.clientWidth;result.height=document.documentElement.clientHeight;result.horizontalScroll=document.documentElement.scrollLeft;result.verticalScroll=document.documentElement.scrollTop;}else if(document.body.clientWidth){result.width=document.body.clientWidth;result.height=document.body.clientHeight;result.horizontalScroll=document.body.scrollLeft;result.verticalScroll=document.body.scrollTop;}}return result;};//\n\t// GetElementPosition(element) - returns object with left and top position of the element in the document\n\t//\n\t// Goodman's JavaScript & DHTML Cookbook, 2nd Edition, page 415\n\t//\n\tSocialCalc.GetElementPosition=function(element){var offsetLeft=0;var offsetTop=0;while(element){offsetLeft+=element.offsetLeft;offsetTop+=element.offsetTop;element=element.offsetParent;}return{left:offsetLeft,top:offsetTop};};//\n\t// GetElementPositionWithScroll(element) - returns object with left and top position of the element in the document\n\t//\n\t// Takes into account scroll offsets by going through entire tree\n\t//\n\tSocialCalc.GetElementPositionWithScroll=function(element){var offsetLeft=0;var offsetTop=0;var offsetElement=element;while(element){if(element.tagName==\"HTML\")break;if(element==offsetElement){offsetLeft+=element.offsetLeft;offsetTop+=element.offsetTop;offsetElement=element.offsetParent;}if(element.scrollLeft){offsetLeft-=element.scrollLeft;}if(element.scrollTop){offsetTop-=element.scrollTop;}element=element.parentNode;}return{left:offsetLeft,top:offsetTop};};//\n\t// LookupElement(element, array) - returns array element which is an object with \"element\" of element\n\t//\n\tSocialCalc.LookupElement=function(element,array){var i;for(i=0;i<array.length;i++){if(array[i].element==element)return array[i];}return null;};//\n\t// AssignID(obj, element, id) - Optionally assigns an ID with a prefix to the element\n\t//\n\tSocialCalc.AssignID=function(obj,element,id){if(obj.idPrefix){// Object must have a non-empty idPrefix attribute\n\telement.id=obj.idPrefix+id;}};//\n\t// SocialCalc.GetCellContents(sheetobj, coord)\n\t//\n\t// Returns the contents (value, formula, constant, etc.) of a cell\n\t// with appropriate prefix (\"'\", \"=\", etc.)\n\t//\n\tSocialCalc.GetCellContents=function(sheetobj,coord){var result=\"\";var cellobj=sheetobj.cells[coord];if(cellobj){switch(cellobj.datatype){case\"v\":result=cellobj.datavalue+\"\";break;case\"t\":result=\"'\"+cellobj.datavalue;break;case\"f\":result=\"=\"+cellobj.formula;break;case\"c\":result=cellobj.formula;break;default:break;}}return result;};//\n\t// Routines translated from the SocialCalc 1.1.0 Perl code:\n\t//\n\t// (Makes use of the FormatNumber JavaScript code translated from the Perl.)\n\t//\n\t//\n\t// displayvalue = FormatValueForDisplay(sheetobj, value, cr, linkstyle)\n\t//\n\t// Returns a string, in HTML, for the contents of a cell.\n\t//\n\t// The value is a either numeric or text, the cr is the coord of the cell\n\t// (its cell properties are used to determine formatting), and linkstyle\n\t// is a value passed to wiki-text expansion routines specifying the\n\t// purpose of the rendering so, for example, links can be rendered differently\n\t// during edit than with plain HTML.\n\t//\n\tSocialCalc.FormatValueForDisplay=function(sheetobj,value,cr,linkstyle){var valueformat,has_parens,has_commas,valuetype,valuesubtype;var displayvalue;var sheetattribs=sheetobj.attribs;var scc=SocialCalc.Constants;var cell=sheetobj.cells[cr];if(!cell){// get an empty cell if not there\n\tcell=new SocialCalc.Cell(cr);}displayvalue=value;valuetype=cell.valuetype||\"\";// get type of value to determine formatting\n\tvaluesubtype=valuetype.substring(1);valuetype=valuetype.charAt(0);if(cell.errors||valuetype==\"e\"){displayvalue=cell.errors||valuesubtype||\"Error in cell\";return displayvalue;}if(valuetype==\"t\"){valueformat=sheetobj.valueformats[cell.textvalueformat-0]||sheetobj.valueformats[sheetattribs.defaulttextvalueformat-0]||\"\";if(valueformat==\"formula\"){if(cell.datatype==\"f\"){displayvalue=SocialCalc.special_chars(\"=\"+cell.formula)||\"&nbsp;\";}else if(cell.datatype==\"c\"){displayvalue=SocialCalc.special_chars(\"'\"+cell.formula)||\"&nbsp;\";}else{displayvalue=SocialCalc.special_chars(\"'\"+displayvalue)||\"&nbsp;\";}return displayvalue;}displayvalue=SocialCalc.format_text_for_display(displayvalue,cell.valuetype,valueformat,sheetobj,linkstyle);if(valueformat==\"text-html\")SocialCalc.ScriptCheck(sheetobj.sheetid,cr,value);}else if(valuetype==\"n\"){valueformat=cell.nontextvalueformat;if(valueformat==null||valueformat==\"\"){//\n\tvalueformat=sheetattribs.defaultnontextvalueformat;}valueformat=sheetobj.valueformats[valueformat-0];if(valueformat==null||valueformat==\"none\"){valueformat=\"\";}if(valueformat==\"formula\"){if(cell.datatype==\"f\"){displayvalue=SocialCalc.special_chars(\"=\"+cell.formula)||\"&nbsp;\";}else if(cell.datatype==\"c\"){displayvalue=SocialCalc.special_chars(\"'\"+cell.formula)||\"&nbsp;\";}else{displayvalue=SocialCalc.special_chars(\"'\"+displayvalue)||\"&nbsp;\";}return displayvalue;}else if(valueformat==\"forcetext\"){if(cell.datatype==\"f\"){displayvalue=SocialCalc.special_chars(\"=\"+cell.formula)||\"&nbsp;\";}else if(cell.datatype==\"c\"){displayvalue=SocialCalc.special_chars(cell.formula)||\"&nbsp;\";}else{displayvalue=SocialCalc.special_chars(displayvalue)||\"&nbsp;\";}return displayvalue;}displayvalue=SocialCalc.format_number_for_display(displayvalue,cell.valuetype,valueformat);}else{// unknown type - probably blank\n\tdisplayvalue=\"&nbsp;\";}return displayvalue;};//\n\t// displayvalue = format_text_for_display(rawvalue, valuetype, valueformat, sheetobj, linkstyle)\n\t//\n\tSocialCalc.format_text_for_display=function(rawvalue,valuetype,valueformat,sheetobj,linkstyle){var valueformat,valuesubtype,dvsc,dvue,textval;var displayvalue;valuesubtype=valuetype.substring(1);displayvalue=rawvalue;if(valueformat==\"none\"||valueformat==null)valueformat=\"\";if(!/^(text-|custom|hidden)/.test(valueformat))valueformat=\"\";if(valueformat==\"\"||valueformat==\"General\"){// determine format from type\n\tif(valuesubtype==\"h\")valueformat=\"text-html\";if(valuesubtype==\"w\"||valuesubtype==\"r\")valueformat=\"text-wiki\";if(valuesubtype==\"l\")valueformat=\"text-link\";if(!valuesubtype)valueformat=\"text-plain\";}if(valueformat==\"text-html\"){// HTML - output as it as is\n\t;}else if(SocialCalc.Callbacks.expand_wiki&&/^text-wiki/.test(valueformat)){// do general wiki markup\n\tdisplayvalue=SocialCalc.Callbacks.expand_wiki(displayvalue,sheetobj,linkstyle,valueformat);}else if(valueformat==\"text-wiki\"){// Wiki-text - encode then output\n\tdisplayvalue=SocialCalc.special_chars(displayvalue);}else if(valueformat==\"text-wiki\"){// wiki text\n\tdisplayvalue=SocialCalc.Callbacks.expand_markup&&SocialCalc.Callbacks.expand_markup(displayvalue,sheetobj,linkstyle)||// do old wiki markup\n\tSocialCalc.special_chars(displayvalue);}else if(valueformat==\"text-url\"){// text is a URL for a link\n\tdvsc=SocialCalc.special_chars(displayvalue);dvue=encodeURI(displayvalue);displayvalue='<a href=\"'+dvue+'\">'+dvsc+'</a>';}else if(valueformat==\"text-link\"){// more extensive link capabilities for regular web links\n\tdisplayvalue=SocialCalc.expand_text_link(displayvalue,sheetobj,linkstyle,valueformat);}else if(valueformat==\"text-image\"){// text is a URL for an image\n\tdvue=encodeURI(displayvalue);displayvalue='<img src=\"'+dvue+'\">';}else if(valueformat.substring(0,12)==\"text-custom:\"){// construct a custom text format: @r = text raw, @s = special chars, @u = url encoded\n\tdvsc=SocialCalc.special_chars(displayvalue);// do special chars\n\tdvsc=dvsc.replace(/  /g,\"&nbsp; \");// keep multiple spaces\n\tdvsc=dvsc.replace(/\\n/g,\"<br>\");// keep line breaks\n\tdvue=encodeURI(displayvalue);textval={};textval.r=displayvalue;textval.s=dvsc;textval.u=dvue;displayvalue=valueformat.substring(12);// remove \"text-custom:\"\n\tdisplayvalue=displayvalue.replace(/@(r|s|u)/g,function(a,c){return textval[c];});// replace placeholders\n\t}else if(valueformat.substring(0,6)==\"custom\"){// custom\n\tdisplayvalue=SocialCalc.special_chars(displayvalue);// do special chars\n\tdisplayvalue=displayvalue.replace(/  /g,\"&nbsp; \");// keep multiple spaces\n\tdisplayvalue=displayvalue.replace(/\\n/g,\"<br>\");// keep line breaks\n\tdisplayvalue+=\" (custom format)\";}else if(valueformat==\"hidden\"){displayvalue=\"&nbsp;\";}else{// plain text\n\tdisplayvalue=SocialCalc.special_chars(displayvalue);// do special chars\n\tdisplayvalue=displayvalue.replace(/  /g,\"&nbsp; \");// keep multiple spaces\n\tdisplayvalue=displayvalue.replace(/\\n/g,\"<br>\");// keep line breaks\n\t}return displayvalue;};//\n\t// displayvalue = format_number_for_display(rawvalue, valuetype, valueformat)\n\t//\n\tSocialCalc.format_number_for_display=function(rawvalue,valuetype,valueformat){var value,valuesubtype;var scc=SocialCalc.Constants;value=rawvalue-0;valuesubtype=valuetype.substring(1);if(valueformat==\"Auto\"||valueformat==\"\"){// cases with default format\n\tif(valuesubtype==\"%\"){// will display a % character\n\tvalueformat=\"#,##0.0%\";}else if(valuesubtype=='$'){valueformat='[$]#,##0.00';}else if(valuesubtype=='dt'){valueformat=scc.defaultFormatdt;}else if(valuesubtype=='d'){valueformat=scc.defaultFormatd;}else if(valuesubtype=='t'){valueformat=scc.defaultFormatt;}else if(valuesubtype=='l'){valueformat='logical';}else{valueformat=\"General\";}}if(valueformat==\"logical\"){// do logical format\n\treturn value?scc.defaultDisplayTRUE:scc.defaultDisplayFALSE;}if(valueformat==\"hidden\"){// do hidden format\n\treturn\"&nbsp;\";}// Use format\n\treturn SocialCalc.FormatNumber.formatNumberWithFormat(rawvalue,valueformat,\"\");};//\n\t// valueinfo = DetermineValueType(rawvalue)\n\t//\n\t// Takes a value and looks for special formatting like $, %, numbers, etc.\n\t// Returns the value as a number or string and the type as {value: value, type: type}.\n\t// Tries to follow the spec for spreadsheet function VALUE(v).\n\t//\n\tSocialCalc.DetermineValueType=function(rawvalue){var value=rawvalue+\"\";var type=\"t\";var tvalue,matches,year,hour,minute,second,denom,num,intgr,constr;tvalue=value.replace(/^\\s+/,\"\");// remove leading and trailing blanks\n\ttvalue=tvalue.replace(/\\s+$/,\"\");if(value.length==0){type=\"\";}else if(value.match(/^\\s+$/)){// just blanks\n\t;// leave type \"t\"\n\t}else if(tvalue.match(/^[-+]?\\d*(?:\\.)?\\d*(?:[eE][-+]?\\d+)?$/)){// general number, including E\n\tvalue=tvalue-0;// try converting to number\n\tif(isNaN(value)){// leave alone - catches things like plain \"-\"\n\tvalue=rawvalue+\"\";}else{type=\"n\";}}else if(tvalue.match(/^[-+]?\\d*(?:\\.)?\\d*\\s*%$/)){// percent form: 15.1%\n\tvalue=(tvalue.slice(0,-1)-0)/100;// convert and scale\n\ttype=\"n%\";}else if(tvalue.match(/^[-+]?\\$\\s*\\d*(?:\\.)?\\d*\\s*$/)&&tvalue.match(/\\d/)){// $ format: $1.49\n\tvalue=tvalue.replace(/\\$/,\"\")-0;type=\"n$\";}else if(tvalue.match(/^[-+]?(\\d*,\\d*)+(?:\\.)?\\d*$/)){// number format ignoring commas: 1,234.49\n\tvalue=tvalue.replace(/,/g,\"\")-0;type=\"n\";}else if(tvalue.match(/^[-+]?(\\d*,\\d*)+(?:\\.)?\\d*\\s*%$/)){// % with commas: 1,234.49%\n\tvalue=(tvalue.replace(/[%,]/g,\"\")-0)/100;type=\"n%\";}else if(tvalue.match(/^[-+]?\\$\\s*(\\d*,\\d*)+(?:\\.)?\\d*$/)&&tvalue.match(/\\d/)){// $ and commas: $1,234.49\n\tvalue=tvalue.replace(/[\\$,]/g,\"\")-0;type=\"n$\";}else if(matches=value.match(/^(\\d{1,2})[\\/\\-](\\d{1,2})[\\/\\-](\\d{1,4})\\s*$/)){// MM/DD/YYYY, MM/DD/YYYY\n\tyear=matches[3]-0;year=year<1000?year+2000:year;value=SocialCalc.FormatNumber.convert_date_gregorian_to_julian(year,matches[1]-0,matches[2]-0)-2415019;type=\"nd\";}else if(matches=value.match(/^(\\d{4})[\\/\\-](\\d{1,2})[\\/\\-](\\d{1,2})\\s*$/)){// YYYY-MM-DD, YYYY/MM/DD\n\tyear=matches[1]-0;year=year<1000?year+2000:year;value=SocialCalc.FormatNumber.convert_date_gregorian_to_julian(year,matches[2]-0,matches[3]-0)-2415019;type=\"nd\";}else if(matches=value.match(/^(\\d{1,2}):(\\d{1,2})\\s*$/)){// HH:MM\n\thour=matches[1]-0;minute=matches[2]-0;if(hour<24&&minute<60){value=hour/24+minute/(24*60);type=\"nt\";}}else if(matches=value.match(/^(\\d{1,2}):(\\d{1,2}):(\\d{1,2})\\s*$/)){// HH:MM:SS\n\thour=matches[1]-0;minute=matches[2]-0;second=matches[3]-0;if(hour<24&&minute<60&&second<60){value=hour/24+minute/(24*60)+second/(24*60*60);type=\"nt\";}}else if(matches=value.match(/^\\s*([-+]?\\d+) (\\d+)\\/(\\d+)\\s*$/)){// 1 1/2\n\tintgr=matches[1]-0;num=matches[2]-0;denom=matches[3]-0;if(denom&&denom>0){value=intgr+(intgr<0?-num/denom:num/denom);type=\"n\";}}else if(constr=SocialCalc.InputConstants[value.toUpperCase()]){// special constants, like \"false\" and #N/A\n\tnum=constr.indexOf(\",\");value=constr.substring(0,num)-0;type=constr.substring(num+1);}else if(tvalue.length>7&&tvalue.substring(0,7).toLowerCase()==\"http://\"){// URL\n\tvalue=tvalue;type=\"tl\";}return{value:value,type:type};};SocialCalc.InputConstants={// strings that turn into constants for SocialCalc.DetermineValueType\n\t\"TRUE\":\"1,nl\",\"FALSE\":\"0,nl\",\"#N/A\":\"0,e#N/A\",\"#NULL!\":\"0,e#NULL!\",\"#NUM!\":\"0,e#NUM!\",\"#DIV/0!\":\"0,e#DIV/0!\",\"#VALUE!\":\"0,e#VALUE!\",\"#REF!\":\"0,e#REF!\",\"#NAME?\":\"0,e#NAME?\"};//\n\t// result = default_expand_markup(displayvalue, sheetobj, linkstyle)\n\t//\n\t// Processes wiki-text -- this is a placeholder.\n\t// Reference to here in SocialCalc.expand_markup should be replaced by application-specific routine.\n\t//\n\tSocialCalc.default_expand_markup=function(displayvalue,sheetobj,linkstyle){var result=displayvalue;result=SocialCalc.special_chars(result);// do special chars\n\tresult=result.replace(/  /g,\"&nbsp; \");// keep multiple spaces\n\tresult=result.replace(/\\n/g,\"<br>\");// keep line breaks\n\treturn result;// do very little by default\n\tresult=result.replace(/('*)'''(.*?)'''/g,\"$1<b>$2<\\/b>\");// Wiki-style bold/italics\n\tresult=result.replace(/''(.*?)''/g,\"<i>$1<\\/i>\");return result;};//\n\t// result = SocialCalc.expand_text_link(displayvalue, sheetobj, linkstyle, valueformat)\n\t//\n\t// Parses link text (URL, descriptions, pagenames, workspace names) and returns HTML\n\t//\n\tSocialCalc.expand_text_link=function(displayvalue,sheetobj,linkstyle,valueformat){var desc,tb,str;var scc=SocialCalc.Constants;var url=\"\";var parts=SocialCalc.ParseCellLinkText(displayvalue+\"\");if(parts.desc){desc=SocialCalc.special_chars(parts.desc);}else{desc=parts.pagename?scc.defaultPageLinkFormatString:scc.defaultLinkFormatString;}if(displayvalue.length>7&&displayvalue.substring(0,7).toLowerCase()==\"http://\"&&displayvalue.charAt(displayvalue.length-1)!=\">\"){desc=desc.substring(7);// remove http:// unless explicit\n\t}tb=parts.newwin||!linkstyle?' target=\"_blank\"':\"\";if(parts.pagename){if(SocialCalc.Callbacks.MakePageLink){url=SocialCalc.Callbacks.MakePageLink(parts.pagename,parts.workspacename,linkstyle,valueformat);}//      else if (parts.workspace) {\n\t//         url = \"/\" + encodeURI(parts.workspace) + \"/\" + encodeURI(parts.pagename);\n\t//         }\n\t//      else {\n\t//         url = parts.pagename;\n\t//         }\n\t}else{url=encodeURI(parts.url);}str='<a href=\"'+url+'\"'+tb+'>'+desc+'</a>';return str;};//\n\t// result = SocialCalc.ParseCellLinkText(str)\n\t//\n\t// Given: url = http://www.someurl.com/more, desc = Some descriptive text\n\t//\n\t// Takes the following:\n\t//\n\t//    url\n\t//    <url>\n\t//    desc<url>\n\t//    \"desc\"<url>\n\t//    <<>> instead of <> => target=\"_blank\" (new window)\n\t//\n\t//    [page name]\n\t//    \"desc\"[page name]\n\t//    desc[page name]\n\t//    {workspace name [page name]}\n\t//    \"desc\"{workspace name [page name]}\n\t//    [[]] instead of [] => target=\"_blank\" (new window)\n\t//\n\t//\n\t// Returns: {url: url, desc: desc, newwin: t/f, pagename: pagename, workspace: workspace}\n\t//\n\tSocialCalc.ParseCellLinkText=function(str){var result={url:\"\",desc:\"\",newwin:false,pagename:\"\",workspace:\"\"};var pageform=false;var urlend=str.length-1;var descstart=0;var lastlt=str.lastIndexOf(\"<\");var lastbrkt=str.lastIndexOf(\"[\");var lastbrace=str.lastIndexOf(\"{\");var descend=-1;if((str.charAt(urlend)!=\">\"||lastlt==-1)&&(str.charAt(urlend)!=\"]\"||lastbrkt==-1)&&(str.charAt(urlend)!=\"}\"||str.charAt(urlend-1)!=\"]\"||lastbrace==-1||lastbrkt==-1||lastbrkt<lastbrace)){// plain url\n\turlend++;descend=urlend;}else{// some markup\n\tif(str.charAt(urlend)==\">\"){// url form\n\tdescend=lastlt-1;if(lastlt>0&&str.charAt(descend)==\"<\"&&str.charAt(urlend-1)==\">\"){descend--;urlend--;result.newwin=true;}}else if(str.charAt(urlend)==\"]\"){// plain page form\n\tdescend=lastbrkt-1;pageform=true;if(lastbrkt>0&&str.charAt(descend)==\"[\"&&str.charAt(urlend-1)==\"]\"){descend--;urlend--;result.newwin=true;}}else if(str.charAt(urlend)==\"}\"){// page and workspace form\n\tdescend=lastbrace-1;pageform=true;wsend=lastbrkt;urlend--;if(lastbrkt>0&&str.charAt(lastbrkt-1)==\"[\"&&str.charAt(urlend-1)==\"]\"){wsend=lastbrkt-1;urlend--;result.newwin=true;}if(str.charAt(wsend-1)==\" \"){// trim trailing space in workspace name\n\twsend--;}result.workspace=str.substring(lastbrace+1,wsend)||\"\";}if(str.charAt(descend)==\" \"){// trim trailing space on desc\n\tdescend--;}if(str.charAt(descstart)=='\"'&&str.charAt(descend)=='\"'){descstart++;descend--;}}if(pageform){result.pagename=str.substring(lastbrkt+1,urlend)||\"\";}else{result.url=str.substring(lastlt+1,urlend)||\"\";}if(descend>=descstart){result.desc=str.substring(descstart,descend+1);}return result;};//\n\t// result = SocialCalc.ConvertSaveToOtherFormat(savestr, outputformat, dorecalc)\n\t//\n\t// Returns a string in the specificed format: \"scsave\", \"html\", \"csv\", \"tab\" (tab delimited)\n\t// If dorecalc is true, performs a recalc after loading (NO: obsolete!).\n\t//\n\tSocialCalc.ConvertSaveToOtherFormat=function(savestr,outputformat,dorecalc){var sheet,context,clipextents,div,ele,row,col,cr,cell,str;var result=\"\";if(outputformat==\"scsave\"){return savestr;}if(savestr==\"\"){return\"\";}sheet=new SocialCalc.Sheet();sheet.ParseSheetSave(savestr);if(dorecalc){// no longer supported as of 9/10/08\n\t// Recalc is now async, so can't do it this way\n\tthrow\"SocialCalc.ConvertSaveToOtherFormat: Not doing recalc.\";}if(sheet.copiedfrom){clipextents=SocialCalc.ParseRange(sheet.copiedfrom);}else{clipextents={cr1:{row:1,col:1},cr2:{row:sheet.attribs.lastrow,col:sheet.attribs.lastcol}};}if(outputformat==\"html\"){context=new SocialCalc.RenderContext(sheet);if(sheet.copiedfrom){context.rowpanes[0]={first:clipextents.cr1.row,last:clipextents.cr2.row};context.colpanes[0]={first:clipextents.cr1.col,last:clipextents.cr2.col};}div=document.createElement(\"div\");ele=context.RenderSheet(null,context.defaultHTMLlinkstyle);div.appendChild(ele);context=undefined;sheet=undefined;result=div.innerHTML;ele=undefined;div=undefined;return result;}for(row=clipextents.cr1.row;row<=clipextents.cr2.row;row++){for(col=clipextents.cr1.col;col<=clipextents.cr2.col;col++){cr=SocialCalc.crToCoord(col,row);cell=sheet.GetAssuredCell(cr);if(cell.errors){str=cell.errors;}else{str=cell.datavalue+\"\";// get value as text\n\t}if(outputformat==\"csv\"){if(str.indexOf('\"')!=-1){str=str.replace(/\"/g,'\"\"');// double quotes\n\t}if(/[, \\n\"]/.test(str)){str='\"'+str+'\"';// add quotes\n\t}if(col>clipextents.cr1.col){str=\",\"+str;// add commas\n\t}}else if(outputformat==\"tab\"){if(str.indexOf('\\n')!=-1){// if multiple lines\n\tif(str.indexOf('\"')!=-1){str=str.replace(/\"/g,'\"\"');// double quotes\n\t}str='\"'+str+'\"';// add quotes\n\t}if(col>clipextents.cr1.col){str=\"\\t\"+str;// add tabs\n\t}}result+=str;}result+=\"\\n\";}return result;};//\n\t// result = SocialCalc.ConvertOtherFormatToSave(inputstr, inputformat)\n\t//\n\t// Returns a string converted from the specified format: \"scsave\", \"csv\", \"tab\" (tab delimited)\n\t//\n\tSocialCalc.ConvertOtherFormatToSave=function(inputstr,inputformat){var sheet,context,lines,i,line,value,inquote,j,ch,values,row,col,cr,maxc;var result=\"\";var AddCell=function AddCell(){col++;if(col>maxc)maxc=col;cr=SocialCalc.crToCoord(col,row);SocialCalc.SetConvertedCell(sheet,cr,value);value=\"\";};if(inputformat==\"scsave\"){return inputstr;}sheet=new SocialCalc.Sheet();lines=inputstr.split(/\\r\\n|\\n/);maxc=0;if(inputformat==\"csv\"){row=0;inquote=false;for(i=0;i<lines.length;i++){if(i==lines.length-1&&lines[i]==\"\"){// extra null line - ignore\n\tbreak;}if(inquote){// if inquote, just continue from where left off\n\tvalue+=\"\\n\";}else{// otherwise next row\n\tvalue=\"\";row++;col=0;}line=lines[i];for(j=0;j<line.length;j++){ch=line.charAt(j);if(ch=='\"'){if(inquote){if(j<line.length-1&&line.charAt(j+1)=='\"'){// double quotes\n\tj++;// skip the second one\n\tvalue+='\"';// add one quote\n\t}else{inquote=false;if(j==line.length-1){// at end of line\n\tAddCell();}}}else{inquote=true;}continue;}if(ch==\",\"&&!inquote){AddCell();}else{value+=ch;}if(j==line.length-1&&!inquote){AddCell();}}}if(maxc>0){sheet.attribs.lastrow=row;sheet.attribs.lastcol=maxc;result=sheet.CreateSheetSave(\"A1:\"+SocialCalc.crToCoord(maxc,row));}}if(inputformat==\"tab\"){row=0;inquote=false;for(i=0;i<lines.length;i++){if(i==lines.length-1&&lines[i]==\"\"){// extra null line - ignore\n\tbreak;}if(inquote){// if inquote, just continue from where left off\n\tvalue+=\"\\n\";}else{// otherwise next row\n\tvalue=\"\";row++;col=0;}line=lines[i];for(j=0;j<line.length;j++){ch=line.charAt(j);if(ch=='\"'){if(inquote){if(j<line.length-1){if(line.charAt(j+1)=='\"'){// double quotes\n\tj++;// skip the second one\n\tvalue+='\"';// add one quote\n\t}else if(line.charAt(j+1)=='\\t'){// end of quoted item\n\tj++;inquote=false;AddCell();}}else{// at end of line\n\tinquote=false;AddCell();}continue;}if(value==\"\"){// quote at start of item\n\tinquote=true;continue;}}if(ch==\"\\t\"&&!inquote){AddCell();}else{value+=ch;}if(j==line.length-1&&!inquote){AddCell();}}}if(maxc>0){sheet.attribs.lastrow=row;sheet.attribs.lastcol=maxc;result=sheet.CreateSheetSave(\"A1:\"+SocialCalc.crToCoord(maxc,row));}}return result;};//\n\t// SocialCalc.SetConvertedCell(sheet, cr, rawvalue)\n\t//\n\t// Sets the cell cr with a value and type determined from rawvalue\n\t//\n\tSocialCalc.SetConvertedCell=function(sheet,cr,rawvalue){var cell,value;cell=sheet.GetAssuredCell(cr);value=SocialCalc.DetermineValueType(rawvalue);if(value.type=='n'&&value.value==rawvalue){// check that we don't need \"constant\" to remember original value\n\tcell.datatype=\"v\";cell.valuetype=\"n\";cell.datavalue=value.value;}else if(value.type.charAt(0)=='t'){// text of some sort but left unchanged\n\tcell.datatype=\"t\";cell.valuetype=value.type;cell.datavalue=value.value;}else{// special number types\n\tcell.datatype=\"c\";cell.valuetype=value.type;cell.datavalue=value.value;cell.formula=rawvalue;}};//\n\t// socialcalctouch adds touch gestures to SocialCalc\n\t// \n\t// As a start, touch gestures are modeled similar to \n\t// mouse events \n\t//\n\t// Author: Ramu Ramamurthy\n\t//\n\t//\n\t//\n\t//\n\t//\n\t// To initialize, SocialCalc.CreateTableEditor must call \n\t//    SocialCalc.TouchRegister(editor.toplevel, {Swipe: SocialCalc.EditorProcessSwipe, editor: editor});\n\t//    Also, any element create inside the grid needs to be touch registered for it to work\n\t//        this includes buttons, etc\n\t//\n\t// TestCases:\n\t//     1) tap to point to cell, and to move edit-cell\n\t//     2) double-tap on a cell to open edit-box, then tap on edit box to pullup keyboard\n\t//          -- when editing, tap on any other cell to be done with edit\n\t//              *** figure out escape to cancel edit versus return to accept edit\n\t//          -- when editing, and if = seen than tapping on cell puts the cell name into the edit box\n\t//     3) tap on input box on top opens edit on cell\n\t//        tap on any cell accepts and finishes this edit\n\t//        *** need a way to cancel the edit versus accept the edit\n\t//\n\t//     4) tap on a cell and move finger starts a range\n\t//        removing finger completes the range\n\t//        tap on cell cancels range\n\t//       \n\t//     5) a swipe action scrolls the sheet\n\t//        swipe up/dn scrolls up/dn\n\t//        swipe lt/rt scrolls lt/rt\n\t// \n\t//\n\t// Wishlist:\n\t//     1) smooth scroll will be nice (in addition to swipe) -- using a two-touch pan ?\n\t//\n\tvar SocialCalc;if(!SocialCalc){alert(\"Main SocialCalc code module needed\");SocialCalc={};}// *************************************\n\t//\n\t// Touch functions:\n\t//\n\t// *************************************\n\tSocialCalc.HasTouch=false;(function(){// platform specific registration\n\tvar agent=navigator.userAgent.toLowerCase();if(agent.indexOf('iphone')>=0||agent.indexOf('ipad')>=0||agent.indexOf('android')>=0){SocialCalc.HasTouch=true;}})();SocialCalc.TouchInfo={// In sequence the following will be implemented\n\t// swipe up/dn, left/right will scroll up/dn/left/right respectively\n\t// \n\t// touch on a cell will move ecell to that cell\n\t// repeated touch on a cell will start edit on that cell\n\t// touch on another cell will cancel edit if it was in progress (?)\n\t// etc\n\t// \n\t// touch on buttons will activate the buttons\n\t// \n\t// The registeredElements array is used to identify items.\n\t// One item for each element to respond to the touch, each an object with:\n\t//    .element, .functionobj\n\tregisteredElements:[],// for swipe\n\tthreshold_x:20,threshold_y:20,orig_coord_x:0,orig_coord_y:0,final_coord_x:0,final_coord_y:0,px_to_rows:20,// 20 pixels is 1 row scroll\n\tpx_to_cols:20,// 20 pixels is 1 col scroll\n\ttouch_start:0,ranging:false,ranging_threshold:100,move_start:0,last_touch:0,timeout_handle:null,doubletap_threshold:500// max milliseconds between taps\n\t};//\n\t// TouchRegister(element, functionobj) - make element respond to touch\n\t//\n\tSocialCalc.TouchRegister=function(element,functionobj){if(!SocialCalc.HasTouch){return;}var touchinfo=SocialCalc.TouchInfo;if(SocialCalc.LookupElement(element,touchinfo.registeredElements)){// already registered\n\treturn;}touchinfo.registeredElements.push({element:element,functionobj:functionobj});if(SocialCalc.HasTouch&&element.addEventListener){// Webkit based (?)\n\telement.addEventListener(\"touchstart\",SocialCalc.ProcessTouchStart,false);element.addEventListener(\"touchmove\",SocialCalc.ProcessTouchMove,false);element.addEventListener(\"touchend\",SocialCalc.ProcessTouchEnd,false);element.addEventListener(\"touchcancel\",SocialCalc.ProcessTouchCancel,false);// element.addEventListener(\"orientationchange\", SocialCalc.ProcessOrientationChange, false);\n\t}};SocialCalc.FindTouchElement=function(event){var touchinfo=SocialCalc.TouchInfo;var event=event||window.event;var ele=event.target||event.srcElement;// investigate\n\tfor(wobj=null;!wobj&&ele;ele=ele.parentNode){// investigate\n\twobj=SocialCalc.LookupElement(ele,touchinfo.registeredElements);}return wobj;};SocialCalc.ProcessTouchStart=function(event){var touchinfo=SocialCalc.TouchInfo;touchinfo.orig_coord_x=event.targetTouches[0].pageX;touchinfo.orig_coord_y=event.targetTouches[0].pageY;touchinfo.final_coord_x=touchinfo.orig_coord_x;touchinfo.final_coord_y=touchinfo.orig_coord_y;touchinfo.touch_start=new Date().getTime();event.preventDefault();};SocialCalc.TouchGetSimulatedMouseEvent=function(event,mouse_evt_name){var touches=event.changedTouches;var first=touches[0];var simulatedEvent=document.createEvent(\"MouseEvent\");simulatedEvent.initMouseEvent(mouse_evt_name,true,true,window,1,first.screenX,first.screenY,first.clientX,first.clientY,false,false,false,false,0,null);return simulatedEvent;};SocialCalc.ProcessTouchMove=function(event){var touchinfo=SocialCalc.TouchInfo;touchinfo.final_coord_x=event.targetTouches[0].pageX;touchinfo.final_coord_y=event.targetTouches[0].pageY;var wobj=SocialCalc.FindTouchElement(event);if(!wobj)return;// not one of our elements\n\tif(touchinfo.move_start==0){touchinfo.move_start=new Date().getTime();if(touchinfo.move_start-touchinfo.touch_start>touchinfo.ranging_threshold){// This is a delayed move\n\t// send a mouse down event\n\t// This is for ranging and dragging\n\ttouchinfo.ranging=true;var mouseDn=SocialCalc.TouchGetSimulatedMouseEvent(event,\"mousedown\");wobj.functionobj.editor.fullgrid.dispatchEvent(mouseDn);}}else if(touchinfo.ranging){// already ranging\n\t// send a mouse move event\n\tvar mouseMv=SocialCalc.TouchGetSimulatedMouseEvent(event,\"mousemove\");wobj.functionobj.editor.fullgrid.dispatchEvent(mouseMv);}event.preventDefault();};SocialCalc.ProcessTouchEnd=function(e){var touchinfo=SocialCalc.TouchInfo;var changeX=touchinfo.orig_coord_x-touchinfo.final_coord_x;var changeY=touchinfo.orig_coord_y-touchinfo.final_coord_y;var wobj=SocialCalc.FindTouchElement(event);if(!wobj)return;// not one of our elements\n\tvar event=e||window.event;touchinfo.move_start=0;touchinfo.touch_start=0;if(touchinfo.ranging){// in ranging, and dragging\n\t// send a mouseup event\n\ttouchinfo.ranging=false;var mouseUp=SocialCalc.TouchGetSimulatedMouseEvent(event,\"mouseup\");wobj.functionobj.editor.fullgrid.dispatchEvent(mouseUp);}else if(Math.abs(changeY)>touchinfo.threshold_y||Math.abs(changeX)>touchinfo.threshold_x){// check for swipe\n\tvar amount_y=Math.floor(changeY/touchinfo.px_to_rows);var amount_x=Math.floor(changeX/touchinfo.px_to_cols);if(wobj.functionobj&&wobj.functionobj.Swipe){wobj.functionobj.Swipe(event,touchinfo,wobj,amount_y,amount_x);}}else{// detect a double tap\n\tvar now=new Date().getTime();var lasttouch=touchinfo.last_touch||now+1;var delta=now-lasttouch;if(touchinfo.timeout_handle){clearTimeout(touchinfo.timeout_handle);touchinfo.timeout_handle=null;}if(delta<touchinfo.doubletap_threshold&&delta>0){// doubletap seen\n\tif(wobj.functionobj&&wobj.functionobj.DoubleTap){wobj.functionobj.DoubleTap(event,touchinfo,wobj);}}else{// this is a single tap\n\ttouchinfo.last_touch=now;var timeoutFn=function timeoutFn(){if(wobj.functionobj&&wobj.functionobj.SingleTap){wobj.functionobj.SingleTap(event,touchinfo,wobj);}};touchinfo.timeout_handle=setTimeout(timeoutFn(),touchinfo.doubletap_threshold);}touchinfo.last_touch=now;}e.preventDefault();};SocialCalc.ProcessTouchCancel=function(event){var wobj=SocialCalc.FindTouchElement(event);if(!wobj){return;// do default behavior\n\t}var touchinfo=SocialCalc.TouchInfo;touchinfo.orig_coord_x=0;touchinfo.orig_coord_y=0;touchinfo.final_coord_x=0;touchinfo.final_coord_y=0;touchinfo.move_start=0;touchinfo.touch_start=0;touchinfo.ranging=false;};SocialCalc.EditorProcessSwipe=function(event,touchinfo,wobj,swipevert,swipehoriz){if(wobj.functionobj.editor.busy){return;// ignore if busy\n\t}if(wobj.functionobj.editor.state!=\"start\"){return;// ignore if cell being edited\n\t}if(swipevert!=0||swipehoriz!=0){//wobj.functionobj.editor.ScrollRelativeBoth(swipevert,swipehoriz);\n\twobj.functionobj.editor.ScrollRelativeBoth(swipevert,0);//ignore horiz swipes entirely\n\t}};SocialCalc.EditorProcessSingleTap=function(event,touchinfo,wobj){if(wobj.functionobj.editor.busy){return;// ignore if busy\n\t}// send mouse down\n\tvar mouseDn=SocialCalc.TouchGetSimulatedMouseEvent(event,\"mousedown\");wobj.functionobj.editor.fullgrid.dispatchEvent(mouseDn);// then send mouse up\n\tvar mouseUp=SocialCalc.TouchGetSimulatedMouseEvent(event,\"mouseup\");wobj.functionobj.editor.fullgrid.dispatchEvent(mouseUp);};SocialCalc.EditorProcessDoubleTap=function(event,touchinfo,wobj){if(wobj.functionobj.editor.busy){return;// ignore if busy\n\t}// simulate a mouse double click\n\tvar mouseDblClick=SocialCalc.TouchGetSimulatedMouseEvent(event,\"dblclick\");wobj.functionobj.editor.fullgrid.dispatchEvent(mouseDblClick);};SocialCalc.ProcessOrientationChange=function(event){console.log(\"orientation change\");//var height = $(window).height();\n\t//var width = $(window).width(); \n\t//console.log(\"width=\"+width+\",height=\"+height)\n\t// $(window).trigger( \"orientationchange.htmlclass\" );   \n\t// spreadsheet.DoOnResize(); \n\t};//\n\t// SocialCalcTableEditor\n\t//\n\t/*\n\t // The code module of the SocialCalc package that displays a scrolling grid with panes\n\t // and handles keyboard and mouse I/O.\n\t //\n\t // (c) Copyright 2008, 2009, 2010 Socialtext, Inc.\n\t // All Rights Reserved.\n\t //\n\t *//*\n\t \n\t LEGAL NOTICES REQUIRED BY THE COMMON PUBLIC ATTRIBUTION LICENSE:\n\t \n\t EXHIBIT A. Common Public Attribution License Version 1.0.\n\t \n\t The contents of this file are subject to the Common Public Attribution License Version 1.0 (the\n\t \"License\"); you may not use this file except in compliance with the License. You may obtain a copy\n\t of the License at http://socialcalc.org. The License is based on the Mozilla Public License Version 1.1 but\n\t Sections 14 and 15 have been added to cover use of software over a computer network and provide for\n\t limited attribution for the Original Developer. In addition, Exhibit A has been modified to be\n\t consistent with Exhibit B.\n\t \n\t Software distributed under the License is distributed on an \"AS IS\" basis, WITHOUT WARRANTY OF ANY\n\t KIND, either express or implied. See the License for the specific language governing rights and\n\t limitations under the License.\n\t \n\t The Original Code is SocialCalc JavaScript TableEditor.\n\t \n\t The Original Developer is the Initial Developer.\n\t \n\t The Initial Developer of the Original Code is Socialtext, Inc. All portions of the code written by\n\t Socialtext, Inc., are Copyright (c) Socialtext, Inc. All Rights Reserved.\n\t \n\t Contributor: Dan Bricklin.\n\t \n\t \n\t EXHIBIT B. Attribution Information\n\t \n\t When the TableEditor is producing and/or controlling the display the Graphic Image must be\n\t displayed on the screen visible to the user in a manner comparable to that in the\n\t Original Code. The Attribution Phrase must be displayed as a \"tooltip\" or \"hover-text\" for\n\t that image. The image must be linked to the Attribution URL so as to access that page\n\t when clicked. If the user interface includes a prominent \"about\" display which includes\n\t factual prominent attribution in a form similar to that in the \"about\" display included\n\t with the Original Code, including Socialtext copyright notices and URLs, then the image\n\t need not be linked to the Attribution URL but the \"tool-tip\" is still required.\n\t \n\t Attribution Copyright Notice:\n\t \n\t Copyright (C) 2010 Socialtext, Inc.\n\t All Rights Reserved.\n\t \n\t Attribution Phrase (not exceeding 10 words): SocialCalc\n\t \n\t Attribution URL: http://www.socialcalc.org/xoattrib\n\t \n\t Graphic Image: The contents of the sc-logo.gif file in the Original Code or\n\t a suitable replacement from http://www.socialcalc.org/licenses specified as\n\t being for SocialCalc.\n\t \n\t Display of Attribution Information is required in Larger Works which are defined\n\t in the CPAL as a work which combines Covered Code or portions thereof with code\n\t not governed by the terms of the CPAL.\n\t \n\t *///\n\t// Some of the other files in the SocialCalc package are licensed under\n\t// different licenses. Please note the licenses of the modules you use.\n\t//\n\t// Code History:\n\t//\n\t// Initially coded by Dan Bricklin of Software Garden, Inc., for Socialtext, Inc.\n\t// Based in part on the SocialCalc 1.1.0 code written in Perl.\n\t// The SocialCalc 1.1.0 code was:\n\t//    Portions (c) Copyright 2005, 2006, 2007 Software Garden, Inc.\n\t//    All Rights Reserved.\n\t//    Portions (c) Copyright 2007 Socialtext, Inc.\n\t//    All Rights Reserved.\n\t// The Perl SocialCalc started as modifications to the wikiCalc(R) program, version 1.0.\n\t// wikiCalc 1.0 was written by Software Garden, Inc.\n\t// Unless otherwise specified, referring to \"SocialCalc\" in comments refers to this\n\t// JavaScript version of the code, not the SocialCalc Perl code.\n\t//\n\t/*\n\t \n\t See the comments in the main SocialCalc code module file of the SocialCalc package.\n\t \n\t */var SocialCalc;if(!SocialCalc){// created here, too, in case load order is wrong, but main routines are required\n\tSocialCalc={};}// *************************************\n\t//\n\t// Table Editor class:\n\t//\n\t// *************************************\n\t// Constructor:\n\tSocialCalc.TableEditor=function(context){var scc=SocialCalc.Constants;// Properties:\n\tthis.context=context;// editing context\n\tthis.toplevel=null;// top level HTML element for this table editor\n\tthis.fullgrid=null;// rendered editing context\n\tthis.noEdit=false;// if true, disable all edit UI and make read-only\n\tthis.width=null;this.tablewidth=null;this.height=null;this.tableheight=null;this.inputBox=null;this.inputEcho=null;this.verticaltablecontrol=null;this.horizontaltablecontrol=null;this.logo=null;this.cellhandles=null;// Dynamic properties:\n\tthis.timeout=null;// if non-null, timer id for position calculations\n\tthis.busy=false;// true when executing command, calculating, etc.\n\tthis.ensureecell=false;// if true, ensure ecell is visible after timeout\n\tthis.deferredCommands=[];// commands to execute after busy, in form: {cmdstr: \"cmds\", saveundo: t/f}\n\tthis.gridposition=null;// screen coords of full grid\n\tthis.headposition=null;// screen coords of upper left of grid within header rows\n\tthis.firstscrollingrow=null;// row number of top row in last (the scrolling) pane\n\tthis.firstscrollingrowtop=null;// position of top row in last (the scrolling) pane\n\tthis.lastnonscrollingrow=null;// row number of last displayed row in last non-scrolling\n\t// pane, or zero (for thumb position calculations)\n\tthis.lastvisiblerow=null;// used for paging down\n\tthis.firstscrollingcol=null;// column number of top col in last (the scrolling) pane\n\tthis.firstscrollingcolleft=null;// position of top col in last (the scrolling) pane\n\tthis.lastnonscrollingcol=null;// col number of last displayed column in last non-scrolling\n\t// pane, or zero (for thumb position calculations)\n\tthis.lastvisiblecol=null;// used for paging right\n\tthis.rowpositions=[];// screen positions of the top of some rows\n\tthis.colpositions=[];// screen positions of the left side of some rows\n\tthis.rowheight=[];// size in pixels of each row when last checked, or null/undefined, for page up\n\tthis.colwidth=[];// size in pixels of each column when last checked, or null/undefined, for page left\n\tthis.ecell=null;// either null or {coord: c, row: r, col: c}\n\tthis.state=\"start\";// the keyboard states: see EditorProcessKey\n\tthis.workingvalues={};// values used during keyboard editing, etc.\n\t// Constants:\n\tthis.imageprefix=scc.defaultImagePrefix;// URL prefix for images (e.g., \"/www/assets/images/sc\")\n\tthis.idPrefix=scc.defaultTableEditorIDPrefix;this.pageUpDnAmount=scc.defaultPageUpDnAmount;// number of rows to move cursor on PgUp/PgDn keys (numeric)\n\t// Callbacks\n\t// recalcFunction: if present, function(editor) {...}, called to do a recalc\n\t// Default (sheet.RecalcSheet) does all the right stuff.\n\tthis.recalcFunction=function(editor){if(editor.context.sheetobj.RecalcSheet){editor.context.sheetobj.RecalcSheet(SocialCalc.EditorSheetStatusCallback,editor);}else return null;};// ctrlkeyFunction: if present, function(editor, charname) {...}, called to handle ctrl-V, etc., at top level\n\t// Returns true (pass through for continued processing) or false (stop processing this key).\n\tthis.ctrlkeyFunction=function(editor,charname){var ta,ha,cell,position,cmd,sel,cliptext;switch(charname){case\"[ctrl-c]\":case\"[ctrl-x]\":ta=editor.pasteTextarea;ta.value=\"\";cell=SocialCalc.GetEditorCellElement(editor,editor.ecell.row,editor.ecell.col);if(cell){position=SocialCalc.GetElementPosition(cell.element);ta.style.left=position.left-1+\"px\";ta.style.top=position.top-1+\"px\";}if(editor.range.hasrange){sel=SocialCalc.crToCoord(editor.range.left,editor.range.top)+\":\"+SocialCalc.crToCoord(editor.range.right,editor.range.bottom);}else{sel=editor.ecell.coord;}// get what to copy to clipboard\n\tcliptext=SocialCalc.ConvertSaveToOtherFormat(SocialCalc.CreateSheetSave(editor.context.sheetobj,sel),\"tab\");if(charname==\"[ctrl-c]\"||editor.noEdit||SocialCalc.Callbacks.IsCellEditable&&!SocialCalc.Callbacks.IsCellEditable(editor)){// if copy or cut but in no edit\n\tcmd=\"copy \"+sel+\" formulas\";}else{// [ctrl-x]\n\tcmd=\"cut \"+sel+\" formulas\";}editor.EditorScheduleSheetCommands(cmd,true,false);// queue up command to put on SocialCalc clipboard\n\t/* Copy as HTML: This fails rather badly as it won't paste into Notepad as tab-delimited text. Oh well.\n\t\n\tha = editor.pasteHTMLarea;\n\tif (editor.range.hasrange) {\n\tcell = SocialCalc.GetEditorCellElement(editor, editor.range.top, editor.range.left);\n\t}\n\telse {\n\tcell = SocialCalc.GetEditorCellElement(editor, editor.ecell.row, editor.ecell.col);\n\t}\n\tif (cell) position = SocialCalc.GetElementPosition(cell.element);\n\t\n\tif (ha) {\n\tif (position) {\n\tha.style.left = (position.left-1)+\"px\";\n\tha.style.top = (position.top-1)+\"px\";\n\t}\n\tha.style.visibility=\"visible\";\n\tcliptext = SocialCalc.ConvertSaveToOtherFormat(SocialCalc.CreateSheetSave(editor.context.sheetobj, sel), \"html\");\n\tha.innerHTML = cliptext.replace(/<tr\\b[^>]*>[\\d\\D]*?<\\/tr\\b[^>]*>/i, '');\n\tha.focus();\n\t\n\tvar range = document.body.createControlRange();\n\trange.addElement(ha.childNodes[0]);\n\trange.select();\n\t}\n\t*/ta.style.display=\"block\";ta.value=cliptext;// must follow \"block\" setting for Webkit\n\tta.focus();ta.select();window.setTimeout(function(){if(!SocialCalc.GetSpreadsheetControlObject)return;// in case not loaded\n\tvar s=SocialCalc.GetSpreadsheetControlObject();if(!s)return;var editor=s.editor;/*\n\tvar ha = editor.pasteHTMLarea;\n\tif (ha) {\n\tha.blur();\n\tha.innerHTML = '';\n\tha.style.visibility = 'hidden';\n\t}\n\t*/var ta=editor.pasteTextarea;ta.blur();ta.style.display=\"none\";SocialCalc.KeyboardFocus();},200);return true;case\"[ctrl-v]\":if(editor.noEdit)return true;// not if no edit\n\tif(SocialCalc.Callbacks&&SocialCalc.Callbacks.IsCellEditable){if(!SocialCalc.Callbacks.IsCellEditable(editor)){return true;}}var showPasteTextArea=function showPasteTextArea(){ta=editor.pasteTextarea;ta.value=\"\";cell=SocialCalc.GetEditorCellElement(editor,editor.ecell.row,editor.ecell.col);if(cell){position=SocialCalc.GetElementPosition(cell.element);ta.style.left=position.left-1+\"px\";ta.style.top=position.top-1+\"px\";}ta.style.display=\"block\";ta.value=\"\";// must follow \"block\" setting for Webkit\n\tta.focus();};ha=editor.pasteHTMLarea;if(ha){/* Pasting via HTML - Currently IE only */ha.style.visibility=\"visible\";ha.focus();}else{showPasteTextArea();}window.setTimeout(function(){if(!SocialCalc.GetSpreadsheetControlObject)return;var s=SocialCalc.GetSpreadsheetControlObject();if(!s)return;var editor=s.editor;var value=null;var isPasteSameAsClipboard=false;ha=editor.pasteHTMLarea;if(ha){/* IE: We append a U+FFFC to every TD that's not the last of its row,\n\t*     then we obtain innerText, then turn U+FFFC back to \\t,\n\t*     thereby preserving the cell separations (which gets discarded\n\t*     if we simply paste via textarea.\n\t*/var _ObjectReplacementCharacter_=String.fromCharCode(0xFFFC);var html=ha.innerHTML;if(html.search(/<(?![Bb][Rr])[A-Za-z]/)>=0){/* HTML Paste: Mark TDs with U+FFFC accordingly.. */ha.innerHTML=html.replace(/(?:<\\/[Tt][Dd]>)/g,_ObjectReplacementCharacter_);}else{/* Text Paste: In IE, \\t is transformed into &nbsp;, so replace them with U+FFFC. */ha.innerHTML=html.replace(/&[Nn][Bb][Ss][Pp];/g,_ObjectReplacementCharacter_);}value=ha.innerText.replace(new RegExp(_ObjectReplacementCharacter_,'g'),'\\t');ha.innerHTML='';ha.blur();ha.style.visibility=\"hidden\";}else{var ta=editor.pasteTextarea;value=ta.value;ta.blur();ta.style.display=\"none\";}value=value.replace(/\\r\\n/g,\"\\n\").replace(/\\n?$/,'\\n');var clipstr=SocialCalc.ConvertSaveToOtherFormat(SocialCalc.Clipboard.clipboard,\"tab\");if(value==clipstr||value.length-clipstr.length==1&&value.substring(0,value.length-1)==clipstr){isPasteSameAsClipboard=true;}var cmd=\"\";// pastes SocialCalc clipboard if did a Ctrl-C and contents still the same\n\t// Webkit adds an extra blank line, so need to allow for that\n\tif(!isPasteSameAsClipboard){cmd=\"loadclipboard \"+SocialCalc.encodeForSave(SocialCalc.ConvertOtherFormatToSave(value,\"tab\"))+\"\\n\";}var cr;if(editor.range.hasrange){cr=SocialCalc.crToCoord(editor.range.left,editor.range.top);}else{cr=editor.ecell.coord;}cmd+=\"paste \"+cr+\" formulas\";editor.EditorScheduleSheetCommands(cmd,true,false);SocialCalc.KeyboardFocus();},200);return true;case\"[ctrl-z]\":editor.EditorScheduleSheetCommands(\"undo\",true,false);return false;case\"[ctrl-s]\":// !!!! temporary hack\n\twindow.setTimeout(function(){if(!SocialCalc.GetSpreadsheetControlObject)return;var s=SocialCalc.GetSpreadsheetControlObject();if(!s)return;var editor=s.editor;var sheet=editor.context.sheetobj;var cell=sheet.GetAssuredCell(editor.ecell.coord);var ntvf=cell.nontextvalueformat?sheet.valueformats[cell.nontextvalueformat-0]||\"\":\"\";var newntvf=window.prompt(\"Advanced Feature:\\n\\nCustom Numeric Format or Command\",ntvf);if(newntvf!=null){// not cancelled\n\tif(newntvf.match(/^cmd:/)){cmd=newntvf.substring(4);// execute as command\n\t}else if(newntvf.match(/^edit:/)){cmd=newntvf.substring(5);// execute as command\n\tif(SocialCalc.CtrlSEditor){SocialCalc.CtrlSEditor(cmd);}return;}else{if(editor.range.hasrange){sel=SocialCalc.crToCoord(editor.range.left,editor.range.top)+\":\"+SocialCalc.crToCoord(editor.range.right,editor.range.bottom);}else{sel=editor.ecell.coord;}cmd=\"set \"+sel+\" nontextvalueformat \"+newntvf;}editor.EditorScheduleSheetCommands(cmd,true,false);}},200);return false;default:break;}return true;};// Set sheet's status callback:\n\tcontext.sheetobj.statuscallback=SocialCalc.EditorSheetStatusCallback;context.sheetobj.statuscallbackparams=this;// this object: the table editor object\n\t// StatusCallback: all values are called at appropriate times, add with unique name, delete when done\n\t//\n\t// Each value must be an object in the form of:\n\t//\n\t//    func: function(editor, status, arg, params) {...},\n\t//    params: params value to call func with\n\t//\n\t// The values for status and arg are:\n\t//\n\t//    all the SocialCalc RecalcSheet statuscallbacks, including:\n\t//\n\t//       calccheckdone, calclist length\n\t//       calcorder, {coord: coord, total: celllist length, count: count}\n\t//       calcstep, {coord: coord, total: calclist length, count: count}\n\t//       calcfinished, time in milliseconds\n\t//\n\t//    the command callbacks, like cmdstart and cmdend\n\t//    cmdendnorender\n\t//\n\t//    calcstart, null\n\t//    moveecell, new ecell coord\n\t//    rangechange, \"coord:coord\" or \"coord\" or \"\"\n\t//    specialkey, keyname (\"[esc]\")\n\t//\n\tthis.StatusCallback={};this.MoveECellCallback={};// all values are called with editor as arg; add with unique name, delete when done\n\tthis.RangeChangeCallback={};// all values are called with editor as arg; add with unique name, delete when done\n\tthis.SettingsCallbacks={};// See SocialCalc.SaveEditorSettings\n\t// Set initial cursor\n\tthis.ecell={coord:\"A1\",row:1,col:1};context.highlights[this.ecell.coord]=\"cursor\";// Initialize range data\n\t// Range has at least hasrange (true/false).\n\t// It may also have: anchorcoord, anchorrow, anchorcol, top, bottom, left, and right.\n\tthis.range={hasrange:false};// Initialize range2 data (used to show selections, such as for move)\n\t// Range2 has at least hasrange (true/false).\n\t// It may also have: top, bottom, left, and right.\n\tthis.range2={hasrange:false};};// Methods:\n\tSocialCalc.TableEditor.prototype.CreateTableEditor=function(width,height){return SocialCalc.CreateTableEditor(this,width,height);};SocialCalc.TableEditor.prototype.ResizeTableEditor=function(width,height){return SocialCalc.ResizeTableEditor(this,width,height);};SocialCalc.TableEditor.prototype.SaveEditorSettings=function(){return SocialCalc.SaveEditorSettings(this);};SocialCalc.TableEditor.prototype.LoadEditorSettings=function(str,flags){return SocialCalc.LoadEditorSettings(this,str,flags);};SocialCalc.TableEditor.prototype.EditorRenderSheet=function(){SocialCalc.EditorRenderSheet(this);};SocialCalc.TableEditor.prototype.EditorScheduleSheetCommands=function(cmdstr,saveundo,ignorebusy){SocialCalc.EditorScheduleSheetCommands(this,cmdstr,saveundo,ignorebusy);};SocialCalc.TableEditor.prototype.ScheduleSheetCommands=function(cmdstr,saveundo){this.context.sheetobj.ScheduleSheetCommands(cmdstr,saveundo);};SocialCalc.TableEditor.prototype.SheetUndo=function(){this.context.sheetobj.SheetUndo();};SocialCalc.TableEditor.prototype.SheetRedo=function(){this.context.sheetobj.SheetRedo();};SocialCalc.TableEditor.prototype.EditorStepSet=function(status,arg){SocialCalc.EditorStepSet(this,status,arg);};SocialCalc.TableEditor.prototype.GetStatuslineString=function(status,arg,params){return SocialCalc.EditorGetStatuslineString(this,status,arg,params);};SocialCalc.TableEditor.prototype.EditorMouseRegister=function(){return SocialCalc.EditorMouseRegister(this);};SocialCalc.TableEditor.prototype.EditorMouseUnregister=function(){return SocialCalc.EditorMouseUnregister(this);};SocialCalc.TableEditor.prototype.EditorMouseRange=function(coord){return SocialCalc.EditorMouseRange(this,coord);};SocialCalc.TableEditor.prototype.EditorProcessKey=function(ch,e){return SocialCalc.EditorProcessKey(this,ch,e);};SocialCalc.TableEditor.prototype.EditorAddToInput=function(str,prefix){return SocialCalc.EditorAddToInput(this,str,prefix);};SocialCalc.TableEditor.prototype.DisplayCellContents=function(){return SocialCalc.EditorDisplayCellContents(this);};SocialCalc.TableEditor.prototype.EditorSaveEdit=function(text){return SocialCalc.EditorSaveEdit(this,text);};SocialCalc.TableEditor.prototype.EditorApplySetCommandsToRange=function(cmdline,type){return SocialCalc.EditorApplySetCommandsToRange(this,cmdline,type);};SocialCalc.TableEditor.prototype.MoveECellWithKey=function(ch){return SocialCalc.MoveECellWithKey(this,ch);};SocialCalc.TableEditor.prototype.MoveECell=function(newcell){return SocialCalc.MoveECell(this,newcell);};SocialCalc.TableEditor.prototype.ReplaceCell=function(cell,row,col){SocialCalc.ReplaceCell(this,cell,row,col);};SocialCalc.TableEditor.prototype.UpdateCellCSS=function(cell,row,col){SocialCalc.UpdateCellCSS(this,cell,row,col);};SocialCalc.TableEditor.prototype.SetECellHeaders=function(selected){SocialCalc.SetECellHeaders(this,selected);};SocialCalc.TableEditor.prototype.EnsureECellVisible=function(){SocialCalc.EnsureECellVisible(this);};SocialCalc.TableEditor.prototype.RangeAnchor=function(coord){SocialCalc.RangeAnchor(this,coord);};SocialCalc.TableEditor.prototype.RangeExtend=function(coord){SocialCalc.RangeExtend(this,coord);};SocialCalc.TableEditor.prototype.RangeRemove=function(){SocialCalc.RangeRemove(this);};SocialCalc.TableEditor.prototype.Range2Remove=function(){SocialCalc.Range2Remove(this);};SocialCalc.TableEditor.prototype.FitToEditTable=function(){SocialCalc.FitToEditTable(this);};SocialCalc.TableEditor.prototype.CalculateEditorPositions=function(){SocialCalc.CalculateEditorPositions(this);};SocialCalc.TableEditor.prototype.ScheduleRender=function(){SocialCalc.ScheduleRender(this);};SocialCalc.TableEditor.prototype.DoRenderStep=function(){SocialCalc.DoRenderStep(this);};SocialCalc.TableEditor.prototype.SchedulePositionCalculations=function(){SocialCalc.SchedulePositionCalculations(this);};SocialCalc.TableEditor.prototype.DoPositionCalculations=function(){SocialCalc.DoPositionCalculations(this);};SocialCalc.TableEditor.prototype.CalculateRowPositions=function(panenum,positions,sizes){return SocialCalc.CalculateRowPositions(this,panenum,positions,sizes);};SocialCalc.TableEditor.prototype.CalculateColPositions=function(panenum,positions,sizes){return SocialCalc.CalculateColPositions(this,panenum,positions,sizes);};SocialCalc.TableEditor.prototype.ScrollRelative=function(vertical,amount){SocialCalc.ScrollRelative(this,vertical,amount);};SocialCalc.TableEditor.prototype.ScrollRelativeBoth=function(vamount,hamount){SocialCalc.ScrollRelativeBoth(this,vamount,hamount);};SocialCalc.TableEditor.prototype.PageRelative=function(vertical,direction){SocialCalc.PageRelative(this,vertical,direction);};SocialCalc.TableEditor.prototype.LimitLastPanes=function(){SocialCalc.LimitLastPanes(this);};SocialCalc.TableEditor.prototype.ScrollTableUpOneRow=function(){return SocialCalc.ScrollTableUpOneRow(this);};SocialCalc.TableEditor.prototype.ScrollTableDownOneRow=function(){return SocialCalc.ScrollTableDownOneRow(this);};SocialCalc.TableEditor.prototype.ScrollTableLeftOneCol=function(){return SocialCalc.ScrollTableLeftOneCol(this);};SocialCalc.TableEditor.prototype.ScrollTableRightOneCol=function(){return SocialCalc.ScrollTableRightOneCol(this);};//contact prototype\n\tSocialCalc.TableEditor.prototype.EditorChangecontact=function(text,name,phone,email,street,city,company,val){return SocialCalc.EditorChangecontact(this,text,name,phone,email,street,city,company,val);};SocialCalc.TableEditor.prototype.EditorChangecolorFromWidget=function(text){return SocialCalc.EditorChangecolorFromWidget(this,text);};SocialCalc.TableEditor.prototype.EditorChangeSheetcolor=function(text){return SocialCalc.EditorChangeSheetcolor(this,text);};SocialCalc.TableEditor.prototype.EditorChangefontFromWidget=function(text){return SocialCalc.EditorChangefontFromWidget(this,text);};SocialCalc.TableEditor.prototype.EditorChangeSheetfont=function(text){return SocialCalc.EditorChangeSheetfont(this,text);};SocialCalc.TableEditor.prototype.EditorCut=function(text,no_of_cells){return SocialCalc.EditorCut(this,text,no_of_cells);};SocialCalc.TableEditor.prototype.EditorClearSheet=function(text,cell_to_clear){return SocialCalc.EditorClearSheet(this,text,cell_to_clear);};// Functions:\n\tSocialCalc.CreateTableEditor=function(editor,width,height){var scc=SocialCalc.Constants;var AssignID=SocialCalc.AssignID;editor.toplevel=document.createElement(\"div\");editor.width=width;editor.height=height;editor.griddiv=document.createElement(\"div\");editor.tablewidth=Math.max(0,width-scc.defaultTableControlThickness);editor.tableheight=Math.max(0,height-scc.defaultTableControlThickness);editor.griddiv.style.width=editor.tablewidth+\"px\";editor.griddiv.style.height=editor.tableheight+\"px\";editor.griddiv.style.overflow=\"hidden\";editor.griddiv.style.cursor=\"default\";if(scc.cteGriddivClass)editor.griddiv.className=scc.cteGriddivClass;AssignID(editor,editor.griddiv,\"griddiv\");editor.FitToEditTable();editor.EditorRenderSheet();editor.griddiv.appendChild(editor.fullgrid);editor.verticaltablecontrol=new SocialCalc.TableControl(editor,true,editor.tableheight);editor.verticaltablecontrol.CreateTableControl();AssignID(editor,editor.verticaltablecontrol.main,\"tablecontrolv\");editor.horizontaltablecontrol=new SocialCalc.TableControl(editor,false,editor.tablewidth);editor.horizontaltablecontrol.CreateTableControl();AssignID(editor,editor.horizontaltablecontrol.main,\"tablecontrolh\");var table,tbody,tr,td,img,anchor,ta,ha;table=document.createElement(\"table\");editor.layouttable=table;table.cellSpacing=0;table.cellPadding=0;AssignID(editor,table,\"layouttable\");tbody=document.createElement(\"tbody\");table.appendChild(tbody);tr=document.createElement(\"tr\");tbody.appendChild(tr);td=document.createElement(\"td\");td.appendChild(editor.griddiv);tr.appendChild(td);td=document.createElement(\"td\");//td.appendChild(editor.verticaltablecontrol.main);\n\ttr.appendChild(td);tr=document.createElement(\"tr\");tbody.appendChild(tr);td=document.createElement(\"td\");//td.appendChild(editor.horizontaltablecontrol.main);\n\ttr.appendChild(td);td=document.createElement(\"td\");// logo display: Required by CPAL License for this code!\n\t//td.style.background=\"url(\"+editor.imageprefix+\"logo.gif) no-repeat center center\";\n\ttd.innerHTML=\"<div style='cursor:pointer;font-size:1px;'><img src='\"+editor.imageprefix+\"1x1.gif' border='0' width='18' height='18'></div>\";tr.appendChild(td);editor.logo=td;AssignID(editor,editor.logo,\"logo\");SocialCalc.TooltipRegister(td.firstChild.firstChild,\"SocialCalc\",null);editor.toplevel.appendChild(editor.layouttable);if(!editor.noEdit){editor.inputEcho=new SocialCalc.InputEcho(editor);AssignID(editor,editor.inputEcho.main,\"inputecho\");}editor.cellhandles=new SocialCalc.CellHandles(editor);ta=document.createElement(\"textarea\");// used for ctrl-c/ctrl-v where an invisible text area is needed\n\tSocialCalc.setStyles(ta,\"display:none;position:absolute;height:1px;width:1px;opacity:0;filter:alpha(opacity=0);\");ta.value=\"\";editor.pasteTextarea=ta;AssignID(editor,editor.pasteTextarea,\"pastetextarea\");if(navigator.userAgent.match(/Safari\\//)&&!navigator.userAgent.match(/Chrome\\//)){// special code for Safari 5 change\n\twindow.removeEventListener('beforepaste',SocialCalc.SafariPasteFunction,false);window.addEventListener('beforepaste',SocialCalc.SafariPasteFunction,false);window.removeEventListener('beforecopy',SocialCalc.SafariPasteFunction,false);window.addEventListener('beforecopy',SocialCalc.SafariPasteFunction,false);window.removeEventListener('beforecut',SocialCalc.SafariPasteFunction,false);window.addEventListener('beforecut',SocialCalc.SafariPasteFunction,false);}editor.toplevel.appendChild(editor.pasteTextarea);var div=document.createElement(\"div\");div.innerHTML='    <br/>';if(div.firstChild.nodeType==1){/* We are running in IE -- Using HTML-based area for Ctrl-V */ha=document.createElement(\"div\");// used for ctrl-v where an invisible html area is needed\n\teditor.pasteHTMLarea=ha;editor.toplevel.appendChild(editor.pasteHTMLarea);ha.contentEditable=true;AssignID(editor,editor.pasteHTMLarea,\"pastehtmlarea\");SocialCalc.setStyles(ha,\"display:block;visibility:hidden;position:absolute;height:1px;width:1px;opacity:0;filter:alpha(opacity=0);overflow:hidden\");}SocialCalc.MouseWheelRegister(editor.toplevel,{WheelMove:SocialCalc.EditorProcessMouseWheel,editor:editor});if(SocialCalc.HasTouch){SocialCalc.TouchRegister(editor.toplevel,{Swipe:SocialCalc.EditorProcessSwipe,DoubleTap:SocialCalc.EditorProcessDoubleTap,SingleTap:SocialCalc.EditorProcessSingleTap,editor:editor});}if(editor.inputBox){// this seems to fix an obscure bug with Firefox 2 Mac where Ctrl-V doesn't get fired right\n\tif(editor.inputBox.element){editor.inputBox.element.focus();editor.inputBox.element.blur();}}SocialCalc.KeyboardSetFocus(editor);// do status reporting things\n\tSocialCalc.EditorSheetStatusCallback(null,\"startup\",null,editor);// done\n\treturn editor.toplevel;};// Special code needed for change that occurred with Safari 5 that made paste not work for some reason\n\tSocialCalc.SafariPasteFunction=function(e){e.preventDefault();};//\n\t// SocialCalc.ResizeTableEditor(editor, width, height)\n\t//\n\t// Move things around as appropriate and resize\n\t//\n\tSocialCalc.ResizeTableEditor=function(editor,width,height){var scc=SocialCalc.Constants;editor.width=width;editor.height=height;editor.toplevel.style.width=width+\"px\";editor.toplevel.style.height=height+\"px\";editor.tablewidth=Math.max(0,width-scc.defaultTableControlThickness);editor.tableheight=Math.max(0,height-scc.defaultTableControlThickness);editor.griddiv.style.width=editor.tablewidth+\"px\";editor.griddiv.style.height=editor.tableheight+\"px\";editor.verticaltablecontrol.main.style.height=editor.tableheight+\"px\";editor.horizontaltablecontrol.main.style.width=editor.tablewidth+\"px\";editor.FitToEditTable();editor.ScheduleRender();return;};//\n\t// str = SaveEditorSettings(editor)\n\t//\n\t// Returns a string representation of the pane settings, etc.\n\t//\n\t// The format is:\n\t//\n\t//    version:1.0\n\t//    rowpane:panenumber:firstnum:lastnum\n\t//    colpane:panenumber:firstnum:lastnum\n\t//    ecell:coord -- if set\n\t//    range:anchorcoord:top:bottom:left:right -- if set\n\t//\n\t// You can add additional values to be saved by using editor.SettingsCallbacks:\n\t//\n\t//   editor.SettingsCallbacks[\"item-name\"] = {save: savefunction, load: loadfunction}\n\t//\n\t// where savefunction(editor, \"item-name\") returns a string with the new lines to be added to the saved settings\n\t// which include the trailing newlines, and loadfunction(editor, \"item-name\", line, flags) is given the line to process\n\t// without the trailing newlines.\n\t//\n\tSocialCalc.SaveEditorSettings=function(editor){var i,setting;var context=editor.context;var range=editor.range;var result=\"\";result+=\"version:1.0\\n\";for(i=0;i<context.rowpanes.length;i++){result+=\"rowpane:\"+i+\":\"+context.rowpanes[i].first+\":\"+context.rowpanes[i].last+\"\\n\";}for(i=0;i<context.colpanes.length;i++){result+=\"colpane:\"+i+\":\"+context.colpanes[i].first+\":\"+context.colpanes[i].last+\"\\n\";}if(editor.ecell){result+=\"ecell:\"+editor.ecell.coord+\"\\n\";}if(range.hasrange){result+=\"range:\"+range.anchorcoord+\":\"+range.top+\":\"+range.bottom+\":\"+range.left+\":\"+range.right+\"\\n\";}for(setting in editor.SettingsCallbacks){result+=editor.SettingsCallbacks[setting].save(editor,setting);}return result;};//\n\t// LoadEditorSettings(editor, str, flags)\n\t//\n\t// Sets the editor settings based on str. See SocialCalc.SaveEditorSettings for more details.\n\t// Unrecognized lines are ignored.\n\t//\n\tSocialCalc.LoadEditorSettings=function(editor,str,flags){var lines=str.split(/\\r\\n|\\n/);var parts=[];var line,i,cr,row,col,coord,setting;var context=editor.context;var highlights,range;context.rowpanes=[{first:1,last:1}];// reset to start\n\tcontext.colpanes=[{first:1,last:1}];editor.ecell=null;editor.range={hasrange:false};editor.range2={hasrange:false};range=editor.range;context.highlights={};highlights=context.highlights;for(i=0;i<lines.length;i++){line=lines[i];parts=line.split(\":\");setting=parts[0];switch(setting){case\"version\":break;case\"rowpane\":context.rowpanes[parts[1]-0]={first:parts[2]-0,last:parts[3]-0};break;case\"colpane\":context.colpanes[parts[1]-0]={first:parts[2]-0,last:parts[3]-0};break;case\"ecell\":editor.ecell=SocialCalc.coordToCr(parts[1]);editor.ecell.coord=parts[1];highlights[parts[1]]=\"cursor\";break;case\"range\":range.hasrange=true;range.anchorcoord=parts[1];cr=SocialCalc.coordToCr(range.anchorcoord);range.anchorrow=cr.row;range.anchorcol=cr.col;range.top=parts[2]-0;range.bottom=parts[3]-0;range.left=parts[4]-0;range.right=parts[5]-0;for(row=range.top;row<=range.bottom;row++){for(col=range.left;col<=range.right;col++){coord=SocialCalc.crToCoord(col,row);if(highlights[coord]!=\"cursor\"){highlights[coord]=\"range\";}}}break;default:if(editor.SettingsCallbacks[setting]){editor.SettingsCallbacks[setting].load(editor,setting,line,flags);}break;}}return;};//\n\t// EditorRenderSheet(editor)\n\t//\n\t// Renders the sheet and updates editor.fullgrid.\n\t// Sets event handlers.\n\t//\n\tSocialCalc.EditorRenderSheet=function(editor){editor.EditorMouseUnregister();editor.fullgrid=editor.context.RenderSheet(editor.fullgrid);if(editor.ecell)editor.SetECellHeaders(\"selected\");SocialCalc.AssignID(editor,editor.fullgrid,\"fullgrid\");// give it an id\n\teditor.EditorMouseRegister();};//\n\t// EditorScheduleSheetCommands(editor, cmdstr, saveundo, ignorebusy)\n\t//\n\tSocialCalc.EditorScheduleSheetCommands=function(editor,cmdstr,saveundo,ignorebusy){if(editor.state!=\"start\"&&!ignorebusy){// ignore commands if editing a cell\n\treturn;}if(editor.busy&&!ignorebusy){// hold off on commands if doing one\n\teditor.deferredCommands.push({cmdstr:cmdstr,saveundo:saveundo});return;}switch(cmdstr){case\"recalc\":case\"redisplay\":editor.context.sheetobj.ScheduleSheetCommands(cmdstr,false);break;case\"undo\":editor.SheetUndo();break;case\"redo\":editor.SheetRedo();break;default:editor.context.sheetobj.ScheduleSheetCommands(cmdstr,saveundo);break;}};//\n\t// EditorSheetStatusCallback(recalcdata, status, arg, editor)\n\t//\n\t// Called during recalc, executing commands, etc.\n\t//\n\tSocialCalc.EditorSheetStatusCallback=function(recalcdata,status,arg,editor){var f,cell,dcmd;var sheetobj=editor.context.sheetobj;var signalstatus=function signalstatus(s){for(f in editor.StatusCallback){if(editor.StatusCallback[f].func){editor.StatusCallback[f].func(editor,s,arg,editor.StatusCallback[f].params);}}};switch(status){case\"startup\":break;case\"cmdstart\":editor.busy=true;sheetobj.celldisplayneeded=\"\";break;case\"cmdextension\":break;case\"cmdend\":signalstatus(status);if(sheetobj.changedrendervalues){editor.context.PrecomputeSheetFontsAndLayouts();editor.context.CalculateCellSkipData();sheetobj.changedrendervalues=false;}if(sheetobj.celldisplayneeded&&!sheetobj.renderneeded){cr=SocialCalc.coordToCr(sheetobj.celldisplayneeded);cell=SocialCalc.GetEditorCellElement(editor,cr.row,cr.col);editor.ReplaceCell(cell,cr.row,cr.col);}if(editor.deferredCommands.length){dcmd=editor.deferredCommands.shift();editor.EditorScheduleSheetCommands(dcmd.cmdstr,dcmd.saveundo,true);return;}if(sheetobj.attribs.needsrecalc&&(sheetobj.attribs.recalc!=\"off\"||sheetobj.recalconce)&&editor.recalcFunction){editor.FitToEditTable();sheetobj.renderneeded=false;// recalc will force a render\n\tif(sheetobj.recalconce)delete sheetobj.recalconce;// only do once\n\teditor.recalcFunction(editor);}else{if(sheetobj.renderneeded){editor.FitToEditTable();sheetobj.renderneeded=false;editor.ScheduleRender();}else{editor.SchedulePositionCalculations();// just in case command changed positions\n\t//               editor.busy = false;\n\t//               signalstatus(\"cmdendnorender\");\n\t}}return;case\"calcstart\":editor.busy=true;break;case\"calccheckdone\":case\"calcorder\":case\"calcstep\":case\"calcloading\":case\"calcserverfunc\":break;case\"calcfinished\":signalstatus(status);editor.ScheduleRender();return;case\"schedrender\":editor.busy=true;// in case got here without cmd or recalc\n\tbreak;case\"renderdone\":break;case\"schedposcalc\":editor.busy=true;// in case got here without cmd or recalc\n\tbreak;case\"doneposcalc\":if(editor.deferredCommands.length){signalstatus(status);dcmd=editor.deferredCommands.shift();editor.EditorScheduleSheetCommands(dcmd.cmdstr,dcmd.saveundo,true);}else{editor.busy=false;signalstatus(status);if(editor.state==\"start\")editor.DisplayCellContents();// make sure up to date\n\t}return;default:addmsg(\"Unknown status: \"+status);break;}signalstatus(status);return;};// Timer-driven steps for use with SocialCalc.EditorSheetStatusCallback\n\tSocialCalc.EditorStepInfo={//   status: \"\", // saved value to pass to callback\n\teditor:null// for callback\n\t//   arg: null, // for callback\n\t//   timerobj: null\n\t};/*\n\t     SocialCalc.EditorStepSet = function(editor, status, arg) {\n\t     var esi = SocialCalc.EditorStepInfo;\n\t     addmsg(\"step: \"+status);\n\t     if (esi.timerobj) {\n\t     alert(\"Already waiting. Old/new: \"+esi.status+\"/\"+status);\n\t     }\n\t     esi.editor = editor;\n\t     esi.status = status;\n\t     esi.timerobj = window.setTimeout(SocialCalc.EditorStepDone, 1);\n\t     }\n\t     \n\t     SocialCalc.EditorStepDone = function() {\n\t     var esi = SocialCalc.EditorStepInfo;\n\t     esi.timerobj = null;\n\t     SocialCalc.EditorSheetStatusCallback(null, esi.status, null, esi.editor);\n\t     }\n\t     *///\n\t// str = SocialCalc.EditorGetStatuslineString(editor, status, arg, params)\n\t//\n\t// Assumes params is an object where it can use \"calculating\" and \"command\"\n\t// to keep track of state.\n\t// Returns string for status line.\n\t//\n\tSocialCalc.EditorGetStatuslineString=function(editor,status,arg,params){var scc=SocialCalc.Constants;var sstr,progress,coord,circ,r,c,cell,sum,ele;progress=\"\";switch(status){case\"moveecell\":case\"rangechange\":case\"startup\":break;case\"cmdstart\":params.command=true;document.body.style.cursor=\"progress\";editor.griddiv.style.cursor=\"progress\";progress=scc.s_statusline_executing;break;case\"cmdextension\":progress=\"Command Extension: \"+arg;break;case\"cmdend\":params.command=false;break;case\"schedrender\":progress=scc.s_statusline_displaying;break;case\"renderdone\":progress=\" \";break;case\"schedposcalc\":progress=scc.s_statusline_displaying;break;case\"cmdendnorender\":case\"doneposcalc\":document.body.style.cursor=\"default\";editor.griddiv.style.cursor=\"default\";break;case\"calcorder\":progress=scc.s_statusline_ordering+Math.floor(100*arg.count/(arg.total||1))+\"%\";break;case\"calcstep\":progress=scc.s_statusline_calculating+Math.floor(100*arg.count/(arg.total||1))+\"%\";break;case\"calcloading\":progress=scc.s_statusline_calculatingls+\": \"+arg.sheetname;break;case\"calcserverfunc\":progress=scc.s_statusline_calculating+Math.floor(100*arg.count/(arg.total||1))+\"%, \"+scc.s_statusline_doingserverfunc+arg.funcname+scc.s_statusline_incell+arg.coord;break;case\"calcstart\":params.calculating=true;document.body.style.cursor=\"progress\";editor.griddiv.style.cursor=\"progress\";// griddiv has an explicit cursor style\n\tprogress=scc.s_statusline_calcstart;break;case\"calccheckdone\":break;case\"calcfinished\":params.calculating=false;break;default:progress=status;break;}if(!progress&&params.calculating){progress=scc.s_statusline_calculating;}// if there is a range, calculate sum (not during busy times)\n\tif(!params.calculating&&!params.command&&!progress&&editor.range.hasrange&&(editor.range.left!=editor.range.right||editor.range.top!=editor.range.bottom)){sum=0;for(r=editor.range.top;r<=editor.range.bottom;r++){for(c=editor.range.left;c<=editor.range.right;c++){cell=editor.context.sheetobj.cells[SocialCalc.crToCoord(c,r)];if(!cell)continue;if(cell.valuetype&&cell.valuetype.charAt(0)==\"n\"){sum+=cell.datavalue-0;}}}sum=SocialCalc.FormatNumber.formatNumberWithFormat(sum,\"[,]General\",\"\");coord=SocialCalc.crToCoord(editor.range.left,editor.range.top)+\":\"+SocialCalc.crToCoord(editor.range.right,editor.range.bottom);progress=coord+\" (\"+(editor.range.right-editor.range.left+1)+\"x\"+(editor.range.bottom-editor.range.top+1)+\") \"+scc.s_statusline_sum+\"=\"+sum+\" \"+progress;}sstr=editor.ecell.coord+\" &nbsp; \"+progress;if(!params.calculating&&editor.context.sheetobj.attribs.needsrecalc==\"yes\"){sstr+=' &nbsp; '+scc.s_statusline_recalcneeded;}circ=editor.context.sheetobj.attribs.circularreferencecell;if(circ){circ=circ.replace(/\\|/,\" referenced by \");sstr+=' &nbsp; '+scc.s_statusline_circref+circ+'</span>';}return sstr;};//\n\t// Mouse stuff\n\t//\n\tSocialCalc.EditorMouseInfo={// The registeredElements array is used to identify editor grid in which the mouse is doing things.\n\t// One item for each active editor, each an object with:\n\t//    .element, .editor\n\tregisteredElements:[],editor:null,// editor being processed (between mousedown and mouseup)\n\telement:null,// element being processed\n\tignore:false,// if true, mousedowns are ignored\n\tmousedowncoord:\"\",// coord where mouse went down for drag range\n\tmouselastcoord:\"\",// coord where mouse last was during drag\n\tmouseresizecol:\"\",// col being resized\n\tmouseresizeclientx:null,// where resize started\n\tmouseresizedisplay:null// element tracking new size\n\t//\n\t// EditorMouseRegister(editor)\n\t//\n\t};SocialCalc.EditorMouseRegister=function(editor){var mouseinfo=SocialCalc.EditorMouseInfo;var element=editor.fullgrid;var i;for(i=0;i<mouseinfo.registeredElements.length;i++){if(mouseinfo.registeredElements[i].editor==editor){if(mouseinfo.registeredElements[i].element==element){return;// already set - don't do it again\n\t}break;}}if(i<mouseinfo.registeredElements.length){mouseinfo.registeredElements[i].element=element;}else{mouseinfo.registeredElements.push({element:element,editor:editor});}if(element.addEventListener){// DOM Level 2 -- Firefox, et al\n\telement.addEventListener(\"mousedown\",SocialCalc.ProcessEditorMouseDown,false);element.addEventListener(\"dblclick\",SocialCalc.ProcessEditorDblClick,false);}else if(element.attachEvent){// IE 5+\n\telement.attachEvent(\"onmousedown\",SocialCalc.ProcessEditorMouseDown);element.attachEvent(\"ondblclick\",SocialCalc.ProcessEditorDblClick);}else{// don't handle this\n\tthrow\"Browser not supported\";}mouseinfo.ignore=false;// just in case\n\treturn;};//\n\t// EditorMouseUnregister(editor)\n\t//\n\tSocialCalc.EditorMouseUnregister=function(editor){var mouseinfo=SocialCalc.EditorMouseInfo;var element=editor.fullgrid;var i,oldelement;for(i=0;i<mouseinfo.registeredElements.length;i++){if(mouseinfo.registeredElements[i].editor==editor){break;}}if(i<mouseinfo.registeredElements.length){oldelement=mouseinfo.registeredElements[i].element;// remove old handlers\n\tif(oldelement.removeEventListener){// DOM Level 2\n\toldelement.removeEventListener(\"mousedown\",SocialCalc.ProcessEditorMouseDown,false);oldelement.removeEventListener(\"dblclick\",SocialCalc.ProcessEditorDblClick,false);}else if(oldelement.detachEvent){// IE\n\toldelement.detachEvent(\"onmousedown\",SocialCalc.ProcessEditorMouseDown);oldelement.detachEvent(\"ondblclick\",SocialCalc.ProcessEditorDblClick);}mouseinfo.registeredElements.splice(i,1);}return;};SocialCalc.ProcessEditorMouseDown=function(e){var editor,result,coord,textarea,wval,range;var event=e||window.event;var viewport=SocialCalc.GetViewportInfo();var clientX=event.clientX+viewport.horizontalScroll;var clientY=event.clientY+viewport.verticalScroll;var mouseinfo=SocialCalc.EditorMouseInfo;var ele=event.target||event.srcElement;// source object is often within what we want\n\tvar mobj;if(mouseinfo.ignore)return;// ignore this\n\tfor(mobj=null;!mobj&&ele;ele=ele.parentNode){// go up tree looking for one of our elements\n\tmobj=SocialCalc.LookupElement(ele,mouseinfo.registeredElements);}if(!mobj){mouseinfo.editor=null;return;// not one of our elements\n\t}editor=mobj.editor;mouseinfo.element=ele;range=editor.range;result=SocialCalc.GridMousePosition(editor,clientX,clientY);if(!result||result.rowheader)return;// not on a cell or col header\n\tmouseinfo.editor=editor;// remember for later\n\tif(result.colheader&&result.coltoresize){// col header - do drag resize\n\tSocialCalc.ProcessEditorColsizeMouseDown(e,ele,result);return;}if(!result.coord)return;// not us\n\tif(!range.hasrange){if(e.shiftKey)editor.RangeAnchor();}SocialCalc.Callbacks.ToggleCell(result.coord);coord=editor.MoveECell(result.coord);if(range.hasrange){if(e.shiftKey)editor.RangeExtend();else editor.RangeRemove();}mouseinfo.mousedowncoord=coord;// remember if starting drag range select\n\tmouseinfo.mouselastcoord=coord;editor.EditorMouseRange(coord);SocialCalc.KeyboardSetFocus(editor);if(editor.state!=\"start\"&&editor.inputBox)editor.inputBox.element.focus();// Event code from JavaScript, Flanagan, 5th Edition, pg. 422\n\tif(document.addEventListener){// DOM Level 2 -- Firefox, et al\n\tdocument.addEventListener(\"mousemove\",SocialCalc.ProcessEditorMouseMove,true);// capture everywhere\n\tdocument.addEventListener(\"mouseup\",SocialCalc.ProcessEditorMouseUp,true);// capture everywhere\n\t}else if(ele.attachEvent){// IE 5+\n\tele.setCapture();ele.attachEvent(\"onmousemove\",SocialCalc.ProcessEditorMouseMove);ele.attachEvent(\"onmouseup\",SocialCalc.ProcessEditorMouseUp);ele.attachEvent(\"onlosecapture\",SocialCalc.ProcessEditorMouseUp);}if(event.stopPropagation)event.stopPropagation();// DOM Level 2\n\telse event.cancelBubble=true;// IE 5+\n\tif(event.preventDefault)event.preventDefault();// DOM Level 2\n\telse event.returnValue=false;// IE 5+\n\treturn;};SocialCalc.EditorMouseRange=function(editor,coord){var inputtext,wval;var range=editor.range;switch(editor.state){// editing a cell - shouldn't get here if no inputBox\n\tcase\"input\":inputtext=editor.inputBox.GetText();wval=editor.workingvalues;if(\"(+-*/,:!&<>=^\".indexOf(inputtext.slice(-1))>=0&&inputtext.slice(0,1)==\"=\"||inputtext==\"=\"){wval.partialexpr=inputtext;}if(wval.partialexpr){// if in pointing operation\n\tif(coord){if(range.hasrange){var sheetpref=wval.currentsheet==wval.startsheet?\"\":wval.currentsheet+\"!\";editor.inputBox.SetText(wval.partialexpr+sheetpref+SocialCalc.crToCoord(range.left,range.top)+\":\"+sheetpref+SocialCalc.crToCoord(range.right,range.bottom));}else{var sheetpref=wval.currentsheet==wval.startsheet?\"\":wval.currentsheet+\"!\";editor.inputBox.SetText(wval.partialexpr+sheetpref+coord);}}}else{// not in point -- done editing\n\teditor.inputBox.Blur();editor.inputBox.ShowInputBox(false);editor.state=\"start\";editor.cellhandles.ShowCellHandles(true);editor.EditorSaveEdit();editor.inputBox.DisplayCellContents(null);}break;case\"inputboxdirect\":editor.inputBox.Blur();editor.inputBox.ShowInputBox(false);editor.state=\"start\";editor.cellhandles.ShowCellHandles(true);editor.EditorSaveEdit();editor.inputBox.DisplayCellContents(null);break;}};SocialCalc.ProcessEditorMouseMove=function(e){var editor,element,result,coord,now,textarea,sheetobj,cellobj,wval;var event=e||window.event;var viewport=SocialCalc.GetViewportInfo();var clientX=event.clientX+viewport.horizontalScroll;var clientY=event.clientY+viewport.verticalScroll;var mouseinfo=SocialCalc.EditorMouseInfo;editor=mouseinfo.editor;if(!editor)return;// not us, ignore\n\tif(mouseinfo.ignore)return;// ignore this\n\telement=mouseinfo.element;result=SocialCalc.GridMousePosition(editor,clientX,clientY);// get cell with move\n\tif(!result)return;if(result&&!result.coord){SocialCalc.SetDragAutoRepeat(editor,result);return;}SocialCalc.SetDragAutoRepeat(editor,null);// stop repeating if it was\n\tif(!result.coord)return;if(result.coord!=mouseinfo.mouselastcoord){if(!e.shiftKey&&!editor.range.hasrange){editor.RangeAnchor(mouseinfo.mousedowncoord);}editor.MoveECell(result.coord);editor.RangeExtend();}mouseinfo.mouselastcoord=result.coord;editor.EditorMouseRange(result.coord);if(event.stopPropagation)event.stopPropagation();// DOM Level 2\n\telse event.cancelBubble=true;// IE 5+\n\tif(event.preventDefault)event.preventDefault();// DOM Level 2\n\telse event.returnValue=false;// IE 5+\n\treturn;};SocialCalc.ProcessEditorMouseUp=function(e){var editor,element,result,coord,now,textarea,sheetobj,cellobj,wval;var event=e||window.event;var viewport=SocialCalc.GetViewportInfo();var clientX=event.clientX+viewport.horizontalScroll;var clientY=event.clientY+viewport.verticalScroll;var mouseinfo=SocialCalc.EditorMouseInfo;editor=mouseinfo.editor;if(!editor)return;// not us, ignore\n\tif(mouseinfo.ignore)return;// ignore this\n\telement=mouseinfo.element;result=SocialCalc.GridMousePosition(editor,clientX,clientY);// get cell with up\n\tSocialCalc.SetDragAutoRepeat(editor,null);// stop repeating if it was\n\tif(!result)return;if(!result.coord)result.coord=editor.ecell.coord;if(editor.range.hasrange){editor.MoveECell(result.coord);editor.RangeExtend();}else if(result.coord&&result.coord!=mouseinfo.mousedowncoord){editor.RangeAnchor(mouseinfo.mousedowncoord);editor.MoveECell(result.coord);editor.RangeExtend();}editor.EditorMouseRange(result.coord);if(event.stopPropagation)event.stopPropagation();// DOM Level 2\n\telse event.cancelBubble=true;// IE 5+\n\tif(event.preventDefault)event.preventDefault();// DOM Level 2\n\telse event.returnValue=false;// IE 5+\n\tif(document.removeEventListener){// DOM Level 2\n\tdocument.removeEventListener(\"mousemove\",SocialCalc.ProcessEditorMouseMove,true);document.removeEventListener(\"mouseup\",SocialCalc.ProcessEditorMouseUp,true);}else if(element.detachEvent){// IE\n\telement.detachEvent(\"onlosecapture\",SocialCalc.ProcessEditorMouseUp);element.detachEvent(\"onmouseup\",SocialCalc.ProcessEditorMouseUp);element.detachEvent(\"onmousemove\",SocialCalc.ProcessEditorMouseMove);element.releaseCapture();}mouseinfo.editor=null;return false;};SocialCalc.ProcessEditorColsizeMouseDown=function(e,ele,result){var event=e||window.event;var mouseinfo=SocialCalc.EditorMouseInfo;var editor=mouseinfo.editor;var viewport=SocialCalc.GetViewportInfo();var clientX=event.clientX+viewport.horizontalScroll;mouseinfo.mouseresizecolnum=result.coltoresize;// remember col being resized\n\tmouseinfo.mouseresizecol=SocialCalc.rcColname(result.coltoresize);mouseinfo.mousedownclientx=clientX;var sizedisplay=document.createElement(\"div\");mouseinfo.mouseresizedisplay=sizedisplay;sizedisplay.style.width=\"auto\";sizedisplay.style.position=\"absolute\";sizedisplay.style.zIndex=100;sizedisplay.style.top=editor.headposition.top+0+\"px\";sizedisplay.style.left=editor.colpositions[result.coltoresize]+\"px\";sizedisplay.innerHTML='<table cellpadding=\"0\" cellspacing=\"0\"><tr><td style=\"height:100px;'+'border:1px dashed black;background-color:white;width:'+(editor.context.colwidth[mouseinfo.mouseresizecolnum]-2)+'px;\">&nbsp;</td>'+'<td><div style=\"font-size:small;color:white;background-color:gray;padding:4px;\">'+editor.context.colwidth[mouseinfo.mouseresizecolnum]+'</div></td></tr></table>';SocialCalc.setStyles(sizedisplay.firstChild.lastChild.firstChild.childNodes[0],\"filter:alpha(opacity=85);opacity:.85;\");// so no warning msg with Firefox about filter\n\teditor.toplevel.appendChild(sizedisplay);// Event code from JavaScript, Flanagan, 5th Edition, pg. 422\n\tif(document.addEventListener){// DOM Level 2 -- Firefox, et al\n\tdocument.addEventListener(\"mousemove\",SocialCalc.ProcessEditorColsizeMouseMove,true);// capture everywhere\n\tdocument.addEventListener(\"mouseup\",SocialCalc.ProcessEditorColsizeMouseUp,true);// capture everywhere\n\t}else if(editor.toplevel.attachEvent){// IE 5+\n\teditor.toplevel.setCapture();editor.toplevel.attachEvent(\"onmousemove\",SocialCalc.ProcessEditorColsizeMouseMove);editor.toplevel.attachEvent(\"onmouseup\",SocialCalc.ProcessEditorColsizeMouseUp);editor.toplevel.attachEvent(\"onlosecapture\",SocialCalc.ProcessEditorColsizeMouseUp);}if(event.stopPropagation)event.stopPropagation();// DOM Level 2\n\telse event.cancelBubble=true;// IE 5+\n\tif(event.preventDefault)event.preventDefault();// DOM Level 2\n\telse event.returnValue=false;// IE 5+\n\treturn;};SocialCalc.ProcessEditorColsizeMouseMove=function(e){var event=e||window.event;var mouseinfo=SocialCalc.EditorMouseInfo;var editor=mouseinfo.editor;if(!editor)return;// not us, ignore\n\tvar viewport=SocialCalc.GetViewportInfo();var clientX=event.clientX+viewport.horizontalScroll;var newsize=editor.context.colwidth[mouseinfo.mouseresizecolnum]-0+(clientX-mouseinfo.mousedownclientx);if(newsize<SocialCalc.Constants.defaultMinimumColWidth)newsize=SocialCalc.Constants.defaultMinimumColWidth;var sizedisplay=mouseinfo.mouseresizedisplay;//   sizedisplay.firstChild.lastChild.firstChild.childNodes[1].firstChild.innerHTML = newsize+\"\";\n\t//   sizedisplay.firstChild.lastChild.firstChild.childNodes[0].firstChild.style.width = (newsize-2)+\"px\";\n\tsizedisplay.innerHTML='<table cellpadding=\"0\" cellspacing=\"0\"><tr><td style=\"height:100px;'+'border:1px dashed black;background-color:white;width:'+(newsize-2)+'px;\">&nbsp;</td>'+'<td><div style=\"font-size:small;color:white;background-color:gray;padding:4px;\">'+newsize+'</div></td></tr></table>';SocialCalc.setStyles(sizedisplay.firstChild.lastChild.firstChild.childNodes[0],\"filter:alpha(opacity=85);opacity:.85;\");// so no warning msg with Firefox about filter\n\tif(event.stopPropagation)event.stopPropagation();// DOM Level 2\n\telse event.cancelBubble=true;// IE 5+\n\tif(event.preventDefault)event.preventDefault();// DOM Level 2\n\telse event.returnValue=false;// IE 5+\n\treturn;};SocialCalc.ProcessEditorColsizeMouseUp=function(e){var event=e||window.event;var mouseinfo=SocialCalc.EditorMouseInfo;var editor=mouseinfo.editor;if(!editor)return;// not us, ignore\n\telement=mouseinfo.element;var viewport=SocialCalc.GetViewportInfo();var clientX=event.clientX+viewport.horizontalScroll;if(event.stopPropagation)event.stopPropagation();// DOM Level 2\n\telse event.cancelBubble=true;// IE 5+\n\tif(event.preventDefault)event.preventDefault();// DOM Level 2\n\telse event.returnValue=false;// IE 5+\n\tif(document.removeEventListener){// DOM Level 2\n\tdocument.removeEventListener(\"mousemove\",SocialCalc.ProcessEditorColsizeMouseMove,true);document.removeEventListener(\"mouseup\",SocialCalc.ProcessEditorColsizeMouseUp,true);}else if(editor.toplevel.detachEvent){// IE\n\teditor.toplevel.detachEvent(\"onlosecapture\",SocialCalc.ProcessEditorColsizeMouseUp);editor.toplevel.detachEvent(\"onmouseup\",SocialCalc.ProcessEditorColsizeMouseUp);editor.toplevel.detachEvent(\"onmousemove\",SocialCalc.ProcessEditorColsizeMouseMove);editor.toplevel.releaseCapture();}var newsize=editor.context.colwidth[mouseinfo.mouseresizecolnum]-0+(clientX-mouseinfo.mousedownclientx);if(newsize<SocialCalc.Constants.defaultMinimumColWidth)newsize=SocialCalc.Constants.defaultMinimumColWidth;editor.EditorScheduleSheetCommands(\"set \"+mouseinfo.mouseresizecol+\" width \"+newsize,true,false);if(editor.timeout)window.clearTimeout(editor.timeout);editor.timeout=window.setTimeout(SocialCalc.FinishColsize,1);// wait - Firefox 2 has a bug otherwise with next mousedown\n\treturn false;};SocialCalc.FinishColsize=function(){var mouseinfo=SocialCalc.EditorMouseInfo;var editor=mouseinfo.editor;if(!editor)return;editor.toplevel.removeChild(mouseinfo.mouseresizedisplay);mouseinfo.mouseresizedisplay=null;//   editor.FitToEditTable();\n\t//   editor.EditorRenderSheet();\n\t//   editor.SchedulePositionCalculations();\n\tmouseinfo.editor=null;return;};//\n\t// Handle auto-repeat of dragging the cursor into the borders of the sheet\n\t//\n\tSocialCalc.AutoRepeatInfo={timer:null,// timer object for repeating\n\tmouseinfo:null,// result from SocialCalc.GridMousePosition\n\trepeatinterval:1000,// milliseconds to wait between repeats\n\teditor:null,// editor object to use when it repeats\n\trepeatcallback:null// used instead of default when repeating (e.g., for cellhandles)\n\t// called as: repeatcallback(newcoord, direction)\n\t};// Control auto-repeat. If mouseinfo==null, cancel.\n\tSocialCalc.SetDragAutoRepeat=function(editor,mouseinfo,callback){var repeatinfo=SocialCalc.AutoRepeatInfo;var coord,direction;repeatinfo.repeatcallback=callback;// null in regular case\n\tif(!mouseinfo){// cancel\n\tif(repeatinfo.timer){// If was repeating, stop\n\twindow.clearTimeout(repeatinfo.timer);// cancel timer\n\trepeatinfo.timer=null;}repeatinfo.mouseinfo=null;return;// done\n\t}repeatinfo.editor=editor;if(repeatinfo.mouseinfo){// check for change while repeating\n\tif(mouseinfo.rowheader||mouseinfo.rowfooter){if(mouseinfo.row!=repeatinfo.mouseinfo.row){// changed row while dragging sidewards\n\tcoord=SocialCalc.crToCoord(editor.ecell.col,mouseinfo.row);// change to it\n\tif(repeatinfo.repeatcallback){if(mouseinfo.row<repeatinfo.mouseinfo.row){direction=\"left\";}else if(mouseinfo.row>repeatinfo.mouseinfo.row){direction=\"right\";}else{direction=\"\";}repeatinfo.repeatcallback(coord,direction);}else{editor.MoveECell(coord);editor.MoveECell(coord);editor.RangeExtend();editor.EditorMouseRange(coord);}}}else if(mouseinfo.colheader||mouseinfo.colfooter){if(mouseinfo.col!=repeatinfo.mouseinfo.col){// changed col while dragging vertically\n\tcoord=SocialCalc.crToCoord(mouseinfo.col,editor.ecell.row);// change to it\n\tif(repeatinfo.repeatcallback){if(mouseinfo.row<repeatinfo.mouseinfo.row){direction=\"left\";}else if(mouseinfo.row>repeatinfo.mouseinfo.row){direction=\"right\";}else{direction=\"\";}repeatinfo.repeatcallback(coord,direction);}else{editor.MoveECell(coord);editor.RangeExtend();editor.EditorMouseRange(coord);}}}}repeatinfo.mouseinfo=mouseinfo;if(mouseinfo.distance<5)repeatinfo.repeatinterval=333;else if(mouseinfo.distance<10)repeatinfo.repeatinterval=250;else if(mouseinfo.distance<25)repeatinfo.repeatinterval=100;else if(mouseinfo.distance<35)repeatinfo.repeatinterval=75;else{// too far - stop repeating\n\tif(repeatinfo.timer){// if repeating, cancel it\n\twindow.clearTimeout(repeatinfo.timer);// cancel timer\n\trepeatinfo.timer=null;}return;}if(!repeatinfo.timer){// start if not already running\n\trepeatinfo.timer=window.setTimeout(SocialCalc.DragAutoRepeat,repeatinfo.repeatinterval);}return;};//\n\t// DragAutoRepeat()\n\t//\n\tSocialCalc.DragAutoRepeat=function(){var repeatinfo=SocialCalc.AutoRepeatInfo;var mouseinfo=repeatinfo.mouseinfo;var direction,coord,cr;if(mouseinfo.rowheader)direction=\"left\";else if(mouseinfo.rowfooter)direction=\"right\";else if(mouseinfo.colheader)direction=\"up\";else if(mouseinfo.colfooter)direction=\"down\";if(repeatinfo.repeatcallback){cr=SocialCalc.coordToCr(repeatinfo.editor.ecell.coord);if(direction==\"left\"&&cr.col>1)cr.col--;else if(direction==\"right\")cr.col++;else if(direction==\"up\"&&cr.row>1)cr.row--;else if(direction==\"down\")cr.row++;coord=SocialCalc.crToCoord(cr.col,cr.row);repeatinfo.repeatcallback(coord,direction);}else{coord=repeatinfo.editor.MoveECellWithKey(\"[a\"+direction+\"]shifted\");if(coord)repeatinfo.editor.EditorMouseRange(coord);}repeatinfo.timer=window.setTimeout(SocialCalc.DragAutoRepeat,repeatinfo.repeatinterval);};//\n\t// Handling Clicking\n\t//\n\tSocialCalc.ProcessEditorDblClick=function(e){var editor,result,coord,textarea,wval,range;var event=e||window.event;var viewport=SocialCalc.GetViewportInfo();var clientX=event.clientX+viewport.horizontalScroll;var clientY=event.clientY+viewport.verticalScroll;var mouseinfo=SocialCalc.EditorMouseInfo;var ele=event.target||event.srcElement;// source object is often within what we want\n\tvar mobj;if(mouseinfo.ignore)return;// ignore this\n\tfor(mobj=null;!mobj&&ele;ele=ele.parentNode){// go up tree looking for one of our elements\n\tmobj=SocialCalc.LookupElement(ele,mouseinfo.registeredElements);}if(!mobj){mouseinfo.editor=null;return;// not one of our elements\n\t}editor=mobj.editor;result=SocialCalc.GridMousePosition(editor,clientX,clientY);if(!result||!result.coord)return;// not within cell area - ignore\n\tmouseinfo.editor=editor;// remember for later\n\tmouseinfo.element=ele;range=editor.range;sheetobj=editor.context.sheetobj;switch(editor.state){case\"start\":SocialCalc.EditorOpenCellEdit(editor);break;case\"input\":break;default:break;}if(event.stopPropagation)event.stopPropagation();// DOM Level 2\n\telse event.cancelBubble=true;// IE 5+\n\tif(event.preventDefault)event.preventDefault();// DOM Level 2\n\telse event.returnValue=false;// IE 5+\n\treturn;};SocialCalc.EditorOpenCellEdit=function(editor){var wval;if(!editor.ecell)return true;// no ecell\n\tif(!editor.inputBox)return true;// no input box, so no editing (happens on noEdit)\n\tif(SocialCalc.Callbacks&&SocialCalc.Callbacks.IsCellEditable){if(!SocialCalc.Callbacks.IsCellEditable(editor)){return true;}}if(editor.inputBox.element.disabled)return true;// multi-line: ignore\n\tif(editor.inputBox.element.style.display=='none'){for(f in editor.StatusCallback){editor.StatusCallback[f].func(editor,\"editecell\",null,editor.StatusCallback[f].params);}return true;// no inputBox display, so no editing\n\t}editor.inputBox.ShowInputBox(true);editor.inputBox.Focus();editor.state=\"inputboxdirect\";editor.inputBox.SetText(\"\");editor.inputBox.DisplayCellContents();editor.inputBox.Select(\"end\");wval=editor.workingvalues;wval.partialexpr=\"\";wval.ecoord=editor.ecell.coord;wval.erow=editor.ecell.row;wval.ecol=editor.ecell.col;wval.startsheet=wval.currentsheet;wval.startsheetid=wval.currentsheetid;return;};SocialCalc.EditorProcessKey=function(editor,ch,e){var result,cell,cellobj,valueinfo,fch,coord,inputtext,f;var sheetobj=editor.context.sheetobj;var wval=editor.workingvalues;var range=editor.range;if(typeof ch!=\"string\")ch=\"\";switch(editor.state){case\"start\":if(e.shiftKey&&ch.substr(0,2)==\"[a\"){ch=ch+\"shifted\";}if(ch==\"[enter]\")ch=\"[adown]\";if(ch==\"[tab]\")ch=e.shiftKey?\"[aleft]\":\"[aright]\";if(ch.substr(0,2)==\"[a\"||ch.substr(0,3)==\"[pg\"||ch==\"[home]\"){result=editor.MoveECellWithKey(ch);return!result;}if(ch==\"[del]\"||ch==\"[backspace]\"){if(!editor.noEdit){editor.EditorApplySetCommandsToRange(\"empty\",\"\");}if(SocialCalc.Callbacks&&SocialCalc.Callbacks.IsCellEditable){if(!SocialCalc.Callbacks.IsCellEditable(editor)){return true;}}break;}if(ch==\"[esc]\"){if(range.hasrange){editor.RangeRemove();editor.MoveECell(range.anchorcoord);for(f in editor.StatusCallback){editor.StatusCallback[f].func(editor,\"specialkey\",ch,editor.StatusCallback[f].params);}}return false;}if(ch==\"[f2]\"){if(editor.noEdit)return true;SocialCalc.EditorOpenCellEdit(editor);return false;}if(ch.length>1&&ch.substr(0,1)==\"[\"||ch.length==0){// some control key\n\tif(editor.ctrlkeyFunction&&ch.length>0){return editor.ctrlkeyFunction(editor,ch);}else{return true;}}if(!editor.ecell)return true;// no ecell\n\tif(!editor.inputBox)return true;// no inputBox so no editing\n\tif(editor.inputBox.element.style.display=='none'){for(f in editor.StatusCallback){editor.StatusCallback[f].func(editor,\"editecell\",ch,editor.StatusCallback[f].params);}return true;// no inputBox display, so no editing\n\t}if(SocialCalc.Callbacks&&SocialCalc.Callbacks.IsCellEditable){if(!SocialCalc.Callbacks.IsCellEditable(editor)){return true;}}editor.inputBox.element.disabled=false;// make sure editable\n\teditor.state=\"input\";editor.inputBox.ShowInputBox(true);editor.inputBox.Focus();editor.inputBox.SetText(ch);editor.inputBox.Select(\"end\");wval.partialexpr=\"\";wval.ecoord=editor.ecell.coord;wval.erow=editor.ecell.row;wval.ecol=editor.ecell.col;wval.startsheet=wval.currentsheet;wval.startsheetid=wval.currentsheetid;editor.RangeRemove();break;case\"input\":inputtext=editor.inputBox.GetText();// should not get here if no inputBox\n\tif(editor.inputBox.skipOne)return false;// ignore a key already handled\n\tif(ch==\"[esc]\"||ch==\"[enter]\"||ch==\"[tab]\"||ch&&ch.substr(0,2)==\"[a\"){if(\"(+-*/,:!&<>=^\".indexOf(inputtext.slice(-1))>=0&&inputtext.slice(0,1)==\"=\"||inputtext==\"=\"){wval.partialexpr=inputtext;}if(wval.partialexpr){// if in pointing operation\n\tif(e.shiftKey&&ch.substr(0,2)==\"[a\"){ch=ch+\"shifted\";}coord=editor.MoveECellWithKey(ch);if(coord){if(range.hasrange){editor.inputBox.SetText(wval.partialexpr+SocialCalc.crToCoord(range.left,range.top)+\":\"+SocialCalc.crToCoord(range.right,range.bottom));}else{editor.inputBox.SetText(wval.partialexpr+coord);}return false;}}editor.inputBox.Blur();editor.inputBox.ShowInputBox(false);editor.state=\"start\";editor.cellhandles.ShowCellHandles(true);if(ch!=\"[esc]\"){editor.EditorSaveEdit();if(editor.ecell.coord!=wval.ecoord){editor.MoveECell(wval.ecoord);}if(ch==\"[enter]\")ch=\"[adown]\";if(ch==\"[tab]\")ch=e.shiftKey?\"[aleft]\":\"[aright]\";if(ch.substr(0,2)==\"[a\"){editor.MoveECellWithKey(ch);}}else{editor.inputBox.DisplayCellContents();editor.RangeRemove();editor.MoveECell(wval.ecoord);}break;}if(wval.partialexpr&&ch==\"[backspace]\"){editor.inputBox.SetText(wval.partialexpr);wval.partialexpr=\"\";editor.RangeRemove();editor.MoveECell(wval.ecoord);editor.inputBox.ShowInputBox(true);// make sure it's moved back if necessary\n\treturn false;}if(ch==\"[f2]\")return false;if(range.hasrange){editor.RangeRemove();}editor.MoveECell(wval.ecoord);if(wval.partialexpr){editor.inputBox.ShowInputBox(true);// make sure it's moved back if necessary\n\twval.partialexpr=\"\";// not pointing\n\t}return true;case\"inputboxdirect\":inputtext=editor.inputBox.GetText();// should not get here if no inputBox\n\tif(ch==\"[esc]\"||ch==\"[enter]\"||ch==\"[tab]\"){editor.inputBox.Blur();editor.inputBox.ShowInputBox(false);editor.state=\"start\";editor.cellhandles.ShowCellHandles(true);if(ch==\"[esc]\"){editor.inputBox.DisplayCellContents();}else{editor.EditorSaveEdit();if(editor.ecell.coord!=wval.ecoord){editor.MoveECell(wval.ecoord);}if(ch==\"[enter]\")ch=\"[adown]\";if(ch==\"[tab]\")ch=e.shiftKey?\"[aleft]\":\"[aright]\";if(ch.substr(0,2)==\"[a\"){editor.MoveECellWithKey(ch);}}break;}if(ch==\"[f2]\")return false;return true;case\"skip-and-start\":editor.state=\"start\";editor.cellhandles.ShowCellHandles(true);return false;default:return true;}return false;};SocialCalc.EditorAddToInput=function(editor,str,prefix){var wval=editor.workingvalues;if(editor.noEdit)return;if(SocialCalc.Callbacks&&SocialCalc.Callbacks.IsCellEditable){if(!SocialCalc.Callbacks.IsCellEditable(editor)){return true;}}switch(editor.state){case\"start\":editor.state=\"input\";editor.inputBox.ShowInputBox(true);editor.inputBox.element.disabled=false;// make sure editable and overwrite old\n\teditor.inputBox.Focus();editor.inputBox.SetText((prefix||\"\")+str);editor.inputBox.Select(\"end\");wval.partialexpr=\"\";wval.ecoord=editor.ecell.coord;wval.erow=editor.ecell.row;wval.ecol=editor.ecell.col;wval.startsheet=wval.currentsheet;wval.startsheetid=wval.currentsheetid;editor.RangeRemove();break;case\"input\":case\"inputboxdirect\":editor.inputBox.element.focus();if(wval.partialexpr){editor.inputBox.SetText(wval.partialexpr);wval.partialexpr=\"\";editor.RangeRemove();editor.MoveECell(wval.ecoord);}editor.inputBox.SetText(editor.inputBox.GetText()+str);break;default:break;}};SocialCalc.EditorDisplayCellContents=function(editor){if(editor.inputBox)editor.inputBox.DisplayCellContents();};var arr=[];SocialCalc.EditorSaveEdit=function(editor,text){//console.log(\"editorSaveEdit\");\n\tvar result,cell,valueinfo,fch,type,value,oldvalue,cmdline;var sheetobj=editor.context.sheetobj;var wval=editor.workingvalues;if(SocialCalc.Callbacks&&SocialCalc.Callbacks.IsCellEditable){if(!SocialCalc.Callbacks.IsCellEditable(editor)){return true;}}type=\"text t\";//changes for prompt\n\tvalue=typeof text==\"string\"?text:editor.inputBox.GetText();// either explicit or from input box\n\toldvalue=SocialCalc.GetCellContents(sheetobj,wval.ecoord)+\"\";//console.log(\"old:\"+oldvalue)\n\t//console.log(\"new:\"+value)\n\tif(value==oldvalue){// no change\n\treturn;}if(\"'\"+value==oldvalue){return;}fch=value.charAt(0);if(fch==\"=\"&&value.indexOf(\"\\n\")==-1){type=\"formula\";value=value.substring(1);}else if(fch==\"'\"){type=\"text t\";value=value.substring(1);}else if(value.length==0){type=\"empty\";}else{valueinfo=SocialCalc.DetermineValueType(value);if(valueinfo.type==\"n\"&&value==valueinfo.value+\"\"){// see if don't need \"constant\"\n\ttype=\"value n\";}else if(valueinfo.type.charAt(0)==\"t\"){type=\"text \"+valueinfo.type;}else if(valueinfo.type==\"\"){type=\"text t\";}else{type=\"constant \"+valueinfo.type+\" \"+valueinfo.value;}}if(type.charAt(0)==\"t\"){// text\n\tvalue=SocialCalc.encodeForSave(value);// newlines, :, and \\ are escaped\n\t}// if startsheet different from currentsheet, switch to start sheet\n\t// for the save to take effect\n\tif(SocialCalc.WorkBook&&wval.currentsheet!=wval.startsheet){var control=SocialCalc.GetCurrentWorkBookControl();var cmdstr=\"activatesheet \"+wval.startsheetid;control.ExecuteWorkBookControlCommand({cmdtype:\"wcmd\",id:\"0\",cmdstr:cmdstr},false);}cmdline=\"set \"+wval.ecoord+\" \"+type+\" \"+value;editor.EditorScheduleSheetCommands(cmdline,true,false);return;};//\n\t// SocialCalc.EditorApplySetCommandsToRange(editor, cmd)\n\t//\n\t// Takes ecell or range and does a \"set\" command with cmd.\n\t//\n\tSocialCalc.EditorApplySetCommandsToRange=function(editor,cmd){var cell,row,col,line,errortext;var sheetobj=editor.context.sheetobj;var ecell=editor.ecell;var range=editor.range;if(range.hasrange){coord=SocialCalc.crToCoord(range.left,range.top)+\":\"+SocialCalc.crToCoord(range.right,range.bottom);line=\"set \"+coord+\" \"+cmd;errortext=editor.EditorScheduleSheetCommands(line,true,false);}else{line=\"set \"+ecell.coord+\" \"+cmd;errortext=editor.EditorScheduleSheetCommands(line,true,false);}editor.DisplayCellContents();};SocialCalc.EditorProcessMouseWheel=function(event,delta,mousewheelinfo,wobj){if(wobj.functionobj.editor.busy)return;// ignore if busy\n\tif(delta>0){wobj.functionobj.editor.ScrollRelative(true,-1);}if(delta<0){wobj.functionobj.editor.ScrollRelative(true,+1);}};//\n\t// GridMousePosition(editor, clientX, clientY)\n\t//\n\t// Returns an object with row and col numbers and coord (spans handled for coords),\n\t// and rowheader/colheader true if in header (where coord will be undefined).\n\t// If in colheader, will return coltoresize if on appropriate place in col header.\n\t// Also, there is rowfooter (on right) and colfooter (on bottom).\n\t// In row/col header/footer, returns \"distance\" as pixels over the edge.\n\t//\n\tSocialCalc.GridMousePosition=function(editor,clientX,clientY){var row,col,colpane;var result={};for(row=1;row<editor.rowpositions.length;row++){if(!editor.rowheight[row])continue;// not rendered yet -- may be above or below us\n\tif(editor.rowpositions[row]+editor.rowheight[row]>clientY){break;}}for(col=1;col<editor.colpositions.length;col++){if(!editor.colwidth[col])continue;if(editor.colpositions[col]+editor.colwidth[col]>clientX){break;}}result.row=row;result.col=col;if(editor.headposition){if(clientX<editor.headposition.left&&clientX>=editor.gridposition.left){result.rowheader=true;result.distance=editor.headposition.left-clientX;return result;}else if(clientY<editor.headposition.top&&clientY>editor.gridposition.top){// > because of sizing row\n\tresult.colheader=true;result.distance=editor.headposition.top-clientY;result.coltoresize=col-(editor.colpositions[col]+editor.colwidth[col]/2>clientX?1:0)||1;for(colpane=0;colpane<editor.context.colpanes.length;colpane++){if(result.coltoresize>=editor.context.colpanes[colpane].first&&result.coltoresize<=editor.context.colpanes[colpane].last){// visible column\n\treturn result;}}delete result.coltoresize;return result;}else if(clientX>=editor.verticaltablecontrol.controlborder){result.rowfooter=true;result.distance=clientX-editor.verticaltablecontrol.controlborder;return result;}else if(clientY>=editor.horizontaltablecontrol.controlborder){result.colfooter=true;result.distance=clientY-editor.horizontaltablecontrol.controlborder;return result;}else if(clientX<editor.gridposition.left){result.rowheader=true;result.distance=editor.headposition.left-clientX;return result;}else if(clientY<=editor.gridposition.top){result.colheader=true;result.distance=editor.headposition.top-clientY;return result;}else{result.coord=SocialCalc.crToCoord(result.col,result.row);if(editor.context.cellskip[result.coord]){// handle skipped cells\n\tresult.coord=editor.context.cellskip[result.coord];}return result;}}return null;};//\n\t// GetEditorCellElement(editor, row, col)\n\t//\n\t// Returns an object with element, the table cell element in the DOM that corresponds to row and column,\n\t// as well as rowpane and colpane, the panes with the cell.\n\t// If no such element, then returns null;\n\t//\n\tSocialCalc.GetEditorCellElement=function(editor,row,col){var rowpane,colpane,c,coord;var rowindex=0;var colindex=0;for(rowpane=0;rowpane<editor.context.rowpanes.length;rowpane++){if(row>=editor.context.rowpanes[rowpane].first&&row<=editor.context.rowpanes[rowpane].last){for(colpane=0;colpane<editor.context.colpanes.length;colpane++){if(col>=editor.context.colpanes[colpane].first&&col<=editor.context.colpanes[colpane].last){rowindex+=row-editor.context.rowpanes[rowpane].first+2;for(c=editor.context.colpanes[colpane].first;c<=col;c++){coord=editor.context.cellskip[SocialCalc.crToCoord(c,row)];if(!coord||!editor.context.CoordInPane(coord,rowpane,colpane))// don't count col-spanned cells\n\tcolindex++;}return{element:editor.griddiv.firstChild.lastChild.childNodes[rowindex].childNodes[colindex],rowpane:rowpane,colpane:colpane};}for(c=editor.context.colpanes[colpane].first;c<=editor.context.colpanes[colpane].last;c++){coord=editor.context.cellskip[SocialCalc.crToCoord(c,row)];if(!coord||!editor.context.CoordInPane(coord,rowpane,colpane))// don't count col-spanned cells\n\tcolindex++;}colindex+=1;}}rowindex+=editor.context.rowpanes[rowpane].last-editor.context.rowpanes[rowpane].first+1+1;}return null;};//\n\t// cellcoord = MoveECellWithKey(editor, ch)\n\t//\n\t// Processes an arrow key, etc., moving the edit cell.\n\t// If not a movement key, returns null.\n\t//\n\tSocialCalc.MoveECellWithKey=function(editor,ch){var coord,row,col,cell;var shifted=false;if(!editor.ecell){return null;}if(ch.slice(-7)==\"shifted\"){ch=ch.slice(0,-7);shifted=true;}row=editor.ecell.row;col=editor.ecell.col;cell=editor.context.sheetobj.cells[editor.ecell.coord];switch(ch){case\"[adown]\":row+=cell&&cell.rowspan||1;break;case\"[aup]\":row--;break;case\"[pgdn]\":row+=editor.pageUpDnAmount-1+(cell&&cell.rowspan||1);break;case\"[pgup]\":row-=editor.pageUpDnAmount;break;case\"[aright]\":col+=cell&&cell.colspan||1;break;case\"[aleft]\":col--;break;case\"[home]\":row=1;col=1;break;default:return null;}if(!editor.range.hasrange){if(shifted)editor.RangeAnchor();}coord=editor.MoveECell(SocialCalc.crToCoord(col,row));if(editor.range.hasrange){if(shifted)editor.RangeExtend();else editor.RangeRemove();}return coord;};//\n\t// cellcoord = MoveECell(editor, newecell)\n\t//\n\t// Takes a coordinate and returns the new edit cell coordinate (which may be\n\t// different if newecell is covered by a span).\n\t//\n\tSocialCalc.MoveECell=function(editor,newcell){var cell,f;var highlights=editor.context.highlights;if(editor.ecell){//changes for prompt\n\tif(editor.ecell.coord==newcell)return newcell;if(SocialCalc.Callbacks.broadcast){SocialCalc.Callbacks.broadcast('ecell',{original:editor.ecell.coord,ecell:newcell});}cell=SocialCalc.GetEditorCellElement(editor,editor.ecell.row,editor.ecell.col);delete highlights[editor.ecell.coord];if(editor.range2.hasrange&&editor.ecell.row>=editor.range2.top&&editor.ecell.row<=editor.range2.bottom&&editor.ecell.col>=editor.range2.left&&editor.ecell.col<=editor.range2.right){highlights[editor.ecell.coord]=\"range2\";}editor.UpdateCellCSS(cell,editor.ecell.row,editor.ecell.col);editor.SetECellHeaders(\"\");// set to regular col/rowname styles\n\teditor.cellhandles.ShowCellHandles(false);}else if(SocialCalc.Callbacks.broadcast){SocialCalc.Callbacks.broadcast('ecell',{ecell:newcell});}newcell=editor.context.cellskip[newcell]||newcell;editor.ecell=SocialCalc.coordToCr(newcell);editor.ecell.coord=newcell;cell=SocialCalc.GetEditorCellElement(editor,editor.ecell.row,editor.ecell.col);highlights[newcell]=\"cursor\";for(f in editor.MoveECellCallback){// let others know\n\teditor.MoveECellCallback[f](editor);}editor.UpdateCellCSS(cell,editor.ecell.row,editor.ecell.col);editor.SetECellHeaders(\"selected\");for(f in editor.StatusCallback){// let status line, etc., know\n\teditor.StatusCallback[f].func(editor,\"moveecell\",newcell,editor.StatusCallback[f].params);}if(editor.busy){editor.ensureecell=true;// wait for when not busy\n\t}else{editor.ensureecell=false;editor.EnsureECellVisible();}return newcell;};SocialCalc.EnsureECellVisible=function(editor){var vamount=0;var hamount=0;if(editor.ecell.row>editor.lastnonscrollingrow){if(editor.ecell.row<editor.firstscrollingrow){vamount=editor.ecell.row-editor.firstscrollingrow;}else if(editor.ecell.row>editor.lastvisiblerow){vamount=editor.ecell.row-editor.lastvisiblerow;}}if(editor.ecell.col>editor.lastnonscrollingcol){if(editor.ecell.col<editor.firstscrollingcol){hamount=editor.ecell.col-editor.firstscrollingcol;}else if(editor.ecell.col>editor.lastvisiblecol){hamount=editor.ecell.col-editor.lastvisiblecol;}}if(vamount!=0||hamount!=0){editor.ScrollRelativeBoth(vamount,hamount);}else{editor.cellhandles.ShowCellHandles(true);}};SocialCalc.ReplaceCell=function(editor,cell,row,col){var newelement,a;if(!cell)return;newelement=editor.context.RenderCell(row,col,cell.rowpane,cell.colpane,true,null);if(newelement){// Don't use a real element and replaceChild, which seems to have focus issues with IE, Firefox, and speed issues\n\tcell.element.innerHTML=newelement.innerHTML;cell.element.style.cssText=\"\";cell.element.className=newelement.className;for(a in newelement.style){if(newelement.style[a]!=\"cssText\")cell.element.style[a]=newelement.style[a];}}};SocialCalc.UpdateCellCSS=function(editor,cell,row,col){var newelement,a;if(!cell)return;newelement=editor.context.RenderCell(row,col,cell.rowpane,cell.colpane,true,null);if(newelement){cell.element.style.cssText=\"\";cell.element.className=newelement.className;for(a in newelement.style){if(newelement.style[a]!=\"cssText\")cell.element.style[a]=newelement.style[a];}}};SocialCalc.SetECellHeaders=function(editor,selected){var ecell=editor.ecell;var context=editor.context;var rowpane,colpane,first,last;var rowindex=0;var colindex=0;var headercell;if(!ecell)return;for(rowpane=0;rowpane<context.rowpanes.length;rowpane++){first=context.rowpanes[rowpane].first;last=context.rowpanes[rowpane].last;if(ecell.row>=first&&ecell.row<=last){headercell=editor.fullgrid.childNodes[1].childNodes[2+rowindex+ecell.row-first].childNodes[0];if(headercell){if(context.classnames)headercell.className=context.classnames[selected+\"rowname\"];if(context.explicitStyles)headercell.style.cssText=context.explicitStyles[selected+\"rowname\"];headercell.style.verticalAlign=\"top\";// to get around Safari making top of centered row number be\n\t// considered top of row (and can't get <row> position in Safari)\n\t}}rowindex+=last-first+1+1;}for(colpane=0;colpane<context.colpanes.length;colpane++){first=context.colpanes[colpane].first;last=context.colpanes[colpane].last;if(ecell.col>=first&&ecell.col<=last){headercell=editor.fullgrid.childNodes[1].childNodes[1].childNodes[1+colindex+ecell.col-first];if(headercell){if(context.classnames)headercell.className=context.classnames[selected+\"colname\"];if(context.explicitStyles)headercell.style.cssText=context.explicitStyles[selected+\"colname\"];}}colindex+=last-first+1+1;}};//\n\t// RangeAnchor(editor, ecoord)\n\t//\n\t// Sets the anchor of a range to ecoord (or ecell if missing).\n\t//\n\tSocialCalc.RangeAnchor=function(editor,ecoord){if(editor.range.hasrange){editor.RangeRemove();}editor.RangeExtend(ecoord);};//\n\t// RangeExtend(editor, ecoord)\n\t//\n\t// Sets the other corner of the range to ecoord or, if missing, ecell.\n\t//\n\tSocialCalc.RangeExtend=function(editor,ecoord){var a,cell,cr,coord,row,col,f;var highlights=editor.context.highlights;var range=editor.range;var range2=editor.range2;var ecell;if(ecoord){ecell=SocialCalc.coordToCr(ecoord);ecell.coord=ecoord;}else ecell=editor.ecell;if(!ecell)return;// just in case\n\tif(SocialCalc.Constants.SCNoRanging)return;if(!range.hasrange){// called without RangeAnchor...\n\trange.anchorcoord=ecell.coord;range.anchorrow=ecell.row;range.top=ecell.row;range.bottom=ecell.row;range.anchorcol=ecell.col;range.left=ecell.col;range.right=ecell.col;range.hasrange=true;}if(range.anchorrow<ecell.row){range.top=range.anchorrow;range.bottom=ecell.row;}else{range.top=ecell.row;range.bottom=range.anchorrow;}if(range.anchorcol<ecell.col){range.left=range.anchorcol;range.right=ecell.col;}else{range.left=ecell.col;range.right=range.anchorcol;}for(coord in highlights){switch(highlights[coord]){case\"range\":highlights[coord]=\"unrange\";break;case\"range2\":highlights[coord]=\"unrange2\";break;}}for(row=range.top;row<=range.bottom;row++){for(col=range.left;col<=range.right;col++){coord=SocialCalc.crToCoord(col,row);switch(highlights[coord]){case\"unrange\":highlights[coord]=\"range\";break;case\"cursor\":break;case\"unrange2\":default:highlights[coord]=\"newrange\";break;}}}for(row=range2.top;range2.hasrange&&row<=range2.bottom;row++){for(col=range2.left;col<=range2.right;col++){coord=SocialCalc.crToCoord(col,row);switch(highlights[coord]){case\"unrange2\":highlights[coord]=\"range2\";break;case\"range\":case\"newrange\":case\"cursor\":break;default:highlights[coord]=\"newrange2\";break;}}}for(coord in highlights){switch(highlights[coord]){case\"unrange\":delete highlights[coord];break;case\"newrange\":highlights[coord]=\"range\";break;case\"newrange2\":highlights[coord]=\"range2\";break;case\"range\":case\"range2\":case\"cursor\":continue;}cr=SocialCalc.coordToCr(coord);cell=SocialCalc.GetEditorCellElement(editor,cr.row,cr.col);editor.UpdateCellCSS(cell,cr.row,cr.col);}for(f in editor.RangeChangeCallback){// let others know\n\teditor.RangeChangeCallback[f](editor);}// create range/coord string and do status callback\n\tcoord=SocialCalc.crToCoord(editor.range.left,editor.range.top);if(editor.range.left!=editor.range.right||editor.range.top!=editor.range.bottom){// more than one cell\n\tcoord+=\":\"+SocialCalc.crToCoord(editor.range.right,editor.range.bottom);}for(f in editor.StatusCallback){editor.StatusCallback[f].func(editor,\"rangechange\",coord,editor.StatusCallback[f].params);}return;};//\n\t// RangeRemove(editor)\n\t//\n\t// Turns off the range.\n\t//\n\tSocialCalc.RangeRemove=function(editor){var cell,cr,coord,row,col,f;var highlights=editor.context.highlights;var range=editor.range;var range2=editor.range2;if(!range.hasrange&&!range2.hasrange)return;for(row=range2.top;range2.hasrange&&row<=range2.bottom;row++){for(col=range2.left;col<=range2.right;col++){coord=SocialCalc.crToCoord(col,row);switch(highlights[coord]){case\"range\":highlights[coord]=\"newrange2\";break;case\"range2\":case\"cursor\":break;default:highlights[coord]=\"newrange2\";break;}}}for(coord in highlights){switch(highlights[coord]){case\"range\":delete highlights[coord];break;case\"newrange2\":highlights[coord]=\"range2\";break;case\"cursor\":continue;}cr=SocialCalc.coordToCr(coord);cell=SocialCalc.GetEditorCellElement(editor,cr.row,cr.col);editor.UpdateCellCSS(cell,cr.row,cr.col);}range.hasrange=false;for(f in editor.RangeChangeCallback){// let others know\n\teditor.RangeChangeCallback[f](editor);}for(f in editor.StatusCallback){editor.StatusCallback[f].func(editor,\"rangechange\",\"\",editor.StatusCallback[f].params);}return;};//\n\t// Range2Remove(editor)\n\t//\n\t// Turns off the range2.\n\t//\n\tSocialCalc.Range2Remove=function(editor){var cell,cr,coord,row,col,f;var highlights=editor.context.highlights;var range2=editor.range2;if(!range2.hasrange)return;for(coord in highlights){switch(highlights[coord]){case\"range2\":delete highlights[coord];break;case\"range\":case\"cursor\":continue;}cr=SocialCalc.coordToCr(coord);cell=SocialCalc.GetEditorCellElement(editor,cr.row,cr.col);editor.UpdateCellCSS(cell,cr.row,cr.col);}range2.hasrange=false;return;};//\n\t// FitToEditTable(editor)\n\t//\n\t// Figure out (through column width declarations and approximation of pixels per row)\n\t// how many rendered rows and columns you need to be at least a little larger than\n\t// the editor's editing area.\n\t//\n\tSocialCalc.FitToEditTable=function(editor){var colnum,colname,colwidth,totalwidth,totalrows,rowpane,needed;var context=editor.context;var sheetobj=context.sheetobj;var sheetcolattribs=sheetobj.colattribs;// Calculate column width data\n\ttotalwidth=context.showRCHeaders?context.rownamewidth-0:0;for(colpane=0;colpane<context.colpanes.length-1;colpane++){// Get width of all but last pane\n\tfor(colnum=context.colpanes[colpane].first;colnum<=context.colpanes[colpane].last;colnum++){colname=SocialCalc.rcColname(colnum);colwidth=sheetobj.colattribs.width[colname]||sheetobj.attribs.defaultcolwidth||SocialCalc.Constants.defaultColWidth;if(colwidth==\"blank\"||colwidth==\"auto\")colwidth=\"\";totalwidth+=colwidth&&colwidth-0>0?colwidth-0:10;}}for(colnum=context.colpanes[colpane].first;colnum<=10000;colnum++){//!!! max for safety, but makes that col max!!!\n\tcolname=SocialCalc.rcColname(colnum);colwidth=sheetobj.colattribs.width[colname]||sheetobj.attribs.defaultcolwidth||SocialCalc.Constants.defaultColWidth;if(colwidth==\"blank\"||colwidth==\"auto\")colwidth=\"\";totalwidth+=colwidth&&colwidth-0>0?colwidth-0:10;if(totalwidth>editor.tablewidth)break;}context.colpanes[colpane].last=colnum;// Calculate row height data\n\ttotalrows=context.showRCHeaders?1:0;for(rowpane=0;rowpane<context.rowpanes.length-1;rowpane++){// count all panes but last one\n\ttotalrows+=context.rowpanes[rowpane].last-context.rowpanes[rowpane].first+1;}needed=editor.tableheight-totalrows*context.pixelsPerRow;// estimate amount needed\n\tcontext.rowpanes[rowpane].last=context.rowpanes[rowpane].first+Math.floor(needed/context.pixelsPerRow)+1;};//\n\t// CalculateEditorPositions(editor)\n\t//\n\t// Calculate the screen positions and other values of various editing elements\n\t// These values change and need to be recomputed when the pane first/last or cell contents change,\n\t// as well as new column widths, etc.\n\t//\n\t// Note: Only call this after the grid has been rendered! You may have to wait for a timeout...\n\t//\n\tSocialCalc.CalculateEditorPositions=function(editor){var rowpane,colpane,i;editor.gridposition=SocialCalc.GetElementPosition(editor.griddiv);editor.headposition=SocialCalc.GetElementPosition(editor.griddiv.firstChild.lastChild.childNodes[2].childNodes[1]);// 3rd tr 2nd td\n\teditor.rowpositions=[];for(rowpane=0;rowpane<editor.context.rowpanes.length;rowpane++){editor.CalculateRowPositions(rowpane,editor.rowpositions,editor.rowheight);}for(i=0;i<editor.rowpositions.length;i++){if(editor.rowpositions[i]>editor.gridposition.top+editor.tableheight)break;}editor.lastvisiblerow=i-1;editor.colpositions=[];for(colpane=0;colpane<editor.context.colpanes.length;colpane++){editor.CalculateColPositions(colpane,editor.colpositions,editor.colwidth);}for(i=0;i<editor.colpositions.length;i++){if(editor.colpositions[i]>editor.gridposition.left+editor.tablewidth)break;}editor.lastvisiblecol=i-1;editor.firstscrollingrow=editor.context.rowpanes[editor.context.rowpanes.length-1].first;editor.firstscrollingrowtop=editor.rowpositions[editor.firstscrollingrow]||editor.headposition.top;editor.lastnonscrollingrow=editor.context.rowpanes.length-1>0?editor.context.rowpanes[editor.context.rowpanes.length-2].last:0;editor.firstscrollingcol=editor.context.colpanes[editor.context.colpanes.length-1].first;editor.firstscrollingcolleft=editor.colpositions[editor.firstscrollingcol]||editor.headposition.left;editor.lastnonscrollingcol=editor.context.colpanes.length-1>0?editor.context.colpanes[editor.context.colpanes.length-2].last:0;// Now do the table controls\n\teditor.verticaltablecontrol.ComputeTableControlPositions();editor.horizontaltablecontrol.ComputeTableControlPositions();};//\n\t// ScheduleRender(editor)\n\t//\n\t// Do a series of timeouts to render the sheet, wait for background layout and\n\t// rendering by the browser, and then update editor visuals, sliders, etc.\n\t//\n\tSocialCalc.ScheduleRender=function(editor){if(editor.timeout)window.clearTimeout(editor.timeout);// in case called more than once, just use latest\n\tSocialCalc.EditorSheetStatusCallback(null,\"schedrender\",null,editor);SocialCalc.EditorStepInfo.editor=editor;editor.timeout=window.setTimeout(SocialCalc.DoRenderStep,1);};// DoRenderStep()\n\t//\n\tSocialCalc.DoRenderStep=function(){var editor=SocialCalc.EditorStepInfo.editor;editor.timeout=null;editor.EditorRenderSheet();SocialCalc.EditorSheetStatusCallback(null,\"renderdone\",null,editor);SocialCalc.EditorSheetStatusCallback(null,\"schedposcalc\",null,editor);editor.timeout=window.setTimeout(SocialCalc.DoPositionCalculations,1);};//\n\t// SocialCalc.SchedulePositionCalculations(editor)\n\t//\n\tSocialCalc.SchedulePositionCalculations=function(editor){SocialCalc.EditorStepInfo.editor=editor;SocialCalc.EditorSheetStatusCallback(null,\"schedposcalc\",null,editor);editor.timeout=window.setTimeout(SocialCalc.DoPositionCalculations,1);};// DoPositionCalculations(editor)\n\t//\n\t// Update editor visuals, sliders, etc.\n\t//\n\t// Note: Only call this after the DOM objects have been modified and rendered!\n\t//\n\tSocialCalc.DoPositionCalculations=function(){var editor=SocialCalc.EditorStepInfo.editor;editor.timeout=null;var ok=false;try{editor.CalculateEditorPositions();ok=true;}catch(e){}if(!ok){if(typeof $!='undefined'){$(window).trigger('resize');setTimeout(SocialCalc.DoPositionCalculations,400);}return;/* Workaround IE6 partial-initialized-DOM bug */}editor.verticaltablecontrol.PositionTableControlElements();editor.horizontaltablecontrol.PositionTableControlElements();SocialCalc.EditorSheetStatusCallback(null,\"doneposcalc\",null,editor);if(editor.ensureecell&&editor.ecell&&!editor.deferredCommands.length){// don't do if deferred cmd to execute\n\teditor.ensureecell=false;editor.EnsureECellVisible();// this could cause another redisplay\n\t}editor.cellhandles.ShowCellHandles(true);//!!! Need to now check to see if this positioned controls out of the editing area\n\t//!!! (such as when there is a large wrapped cell and it pushes the pane boundary too far down).\n\tif(SocialCalc.Callbacks.broadcast)SocialCalc.Callbacks.broadcast('ask.ecell');};SocialCalc.CalculateRowPositions=function(editor,panenum,positions,sizes){var toprow,rowpane,rownum,offset,trowobj,cellposition;var context=editor.context;var sheetobj=context.sheetobj;var tbodyobj;if(!context.showRCHeaders)throw\"Needs showRCHeaders=true\";tbodyobj=editor.fullgrid.lastChild;// Calculate start of this pane as row in this table:\n\ttoprow=2;for(rowpane=0;rowpane<panenum;rowpane++){toprow+=context.rowpanes[rowpane].last-context.rowpanes[rowpane].first+2;// skip pane and spacing row\n\t}offset=0;for(rownum=context.rowpanes[rowpane].first;rownum<=context.rowpanes[rowpane].last;rownum++){trowobj=tbodyobj.childNodes[toprow+offset];offset++;cellposition=SocialCalc.GetElementPosition(trowobj.firstChild);// Safari has problem: If a cell in the row is high, cell 1 is centered and it returns top of centered part\n\t// but if you get position of row element, it always returns the same value (not the row's)\n\t// So we require row number to be vertical aligned to top\n\tif(!positions[rownum]){positions[rownum]=cellposition.top;// first one takes precedence\n\tsizes[rownum]=trowobj.firstChild.offsetHeight;}}return;};SocialCalc.CalculateColPositions=function(editor,panenum,positions,sizes){var leftcol,colpane,colnum,offset,trowobj,cellposition;var context=editor.context;var sheetobj=context.sheetobj;var tbodyobj;if(!context.showRCHeaders)throw\"Needs showRCHeaders=true\";tbodyobj=editor.fullgrid.lastChild;// Calculate start of this pane as column in this table:\n\tleftcol=1;for(colpane=0;colpane<panenum;colpane++){leftcol+=context.colpanes[colpane].last-context.colpanes[colpane].first+2;// skip pane and spacing col\n\t}trowobj=tbodyobj.childNodes[1];// get heading row, which has all columns\n\toffset=0;for(colnum=context.colpanes[colpane].first;colnum<=context.colpanes[colpane].last;colnum++){cellposition=SocialCalc.GetElementPosition(trowobj.childNodes[leftcol+offset]);if(!positions[colnum]){positions[colnum]=cellposition.left;// first one takes precedence\n\tif(trowobj.childNodes[leftcol+offset]){sizes[colnum]=trowobj.childNodes[leftcol+offset].offsetWidth;}}offset++;}return;};// ScrollRelative(editor, vertical, amount)\n\t//\n\t// If vertical true, scrolls up(-)/down(+), else left(-)/right(+)\n\tSocialCalc.ScrollRelative=function(editor,vertical,amount){if(vertical){editor.ScrollRelativeBoth(amount,0);}else{editor.ScrollRelativeBoth(0,amount);}return;};// ScrollRelativeBoth(editor, vamount, hamount)\n\t//\n\t// Does both with one render\n\tSocialCalc.ScrollRelativeBoth=function(editor,vamount,hamount){var context=editor.context;var vplen=context.rowpanes.length;var vlimit=vplen>1?context.rowpanes[vplen-2].last+1:1;// don't scroll past here\n\tif(context.rowpanes[vplen-1].first+vamount<vlimit){// limit amount\n\tvamount=-context.rowpanes[vplen-1].first+vlimit;}var hplen=context.colpanes.length;var hlimit=hplen>1?context.colpanes[hplen-2].last+1:1;// don't scroll past here\n\tif(context.colpanes[hplen-1].first+hamount<hlimit){// limit amount\n\thamount=-context.colpanes[hplen-1].first+hlimit;}if(SocialCalc.IsScrollPossible&&!SocialCalc.IsScrollPossible(editor.context.sheetobj.attribs.lastrow,editor.context.sheetobj.attribs.lastcol,context.rowpanes[vplen-1].first,context.colpanes[hplen-1].first,vamount,hamount)){return;}if((vamount==1||vamount==-1)&&hamount==0){// special case quick scrolls\n\tif(vamount==1){editor.ScrollTableUpOneRow();}else{editor.ScrollTableDownOneRow();}if(editor.ecell)editor.SetECellHeaders(\"selected\");editor.SchedulePositionCalculations();return;}// Do a gross move and render\n\tif(vamount!=0||hamount!=0){context.rowpanes[vplen-1].first+=vamount;context.rowpanes[vplen-1].last+=vamount;context.colpanes[hplen-1].first+=hamount;context.colpanes[hplen-1].last+=hamount;editor.FitToEditTable();editor.ScheduleRender();}};// PageRelative(editor, vertical, direction)\n\t//\n\t// If vertical true, pages up(direction is -)/down(+), else left(-)/right(+)\n\tSocialCalc.PageRelative=function(editor,vertical,direction){var context=editor.context;var panes=vertical?\"rowpanes\":\"colpanes\";var lastpane=context[panes][context[panes].length-1];var lastvisible=vertical?\"lastvisiblerow\":\"lastvisiblecol\";var sizearray=vertical?editor.rowheight:editor.colwidth;var defaultsize=vertical?SocialCalc.Constants.defaultAssumedRowHeight:SocialCalc.Constants.defaultColWidth;var size,newfirst,totalsize,current;if(direction>0){// down/right\n\tnewfirst=editor[lastvisible];if(newfirst==lastpane.first)newfirst+=1;// move at least one\n\t}else{if(vertical){// calculate amount to scroll\n\ttotalsize=editor.tableheight-(editor.firstscrollingrowtop-editor.gridposition.top);}else{totalsize=editor.tablewidth-(editor.firstscrollingcolleft-editor.gridposition.left);}totalsize-=sizearray[editor[lastvisible]]>0?sizearray[editor[lastvisible]]:defaultsize;for(newfirst=lastpane.first-1;newfirst>0;newfirst--){size=sizearray[newfirst]>0?sizearray[newfirst]:defaultsize;if(totalsize<size)break;totalsize-=size;}current=lastpane.first;if(newfirst>=current)newfirst=current-1;// move at least 1\n\tif(newfirst<1)newfirst=1;}lastpane.first=newfirst;lastpane.last=newfirst+1;editor.LimitLastPanes();editor.FitToEditTable();editor.ScheduleRender();};// LimitLastPanes(editor)\n\t//\n\t// Makes sure that the \"first\" of the last panes isn't before the last of the previous pane\n\t//\n\tSocialCalc.LimitLastPanes=function(editor){var context=editor.context;var plen;plen=context.rowpanes.length;if(plen>1&&context.rowpanes[plen-1].first<=context.rowpanes[plen-2].last)context.rowpanes[plen-1].first=context.rowpanes[plen-2].last+1;plen=context.colpanes.length;if(plen>1&&context.colpanes[plen-1].first<=context.colpanes[plen-2].last)context.colpanes[plen-1].first=context.colpanes[plen-2].last+1;};SocialCalc.ScrollTableUpOneRow=function(editor){var toprow,rowpane,rownum,colnum,colpane,cell,oldrownum,maxspan,newbottomrow,newrow,oldchild,bottomrownum;var rowneedsrefresh={};var context=editor.context;var sheetobj=context.sheetobj;var tableobj=editor.fullgrid;var tbodyobj;tbodyobj=tableobj.lastChild;toprow=context.showRCHeaders?2:1;for(rowpane=0;rowpane<context.rowpanes.length-1;rowpane++){toprow+=context.rowpanes[rowpane].last-context.rowpanes[rowpane].first+2;// skip pane and spacing row\n\t}tbodyobj.removeChild(tbodyobj.childNodes[toprow]);context.rowpanes[rowpane].first++;context.rowpanes[rowpane].last++;editor.FitToEditTable();context.CalculateColWidthData();// Just in case, since normally done in RenderSheet\n\tnewbottomrow=context.RenderRow(context.rowpanes[rowpane].last,rowpane);tbodyobj.appendChild(newbottomrow);// if scrolled off a row with starting rowspans, replace rows for the largest rowspan\n\tmaxrowspan=1;oldrownum=context.rowpanes[rowpane].first-1;for(colpane=0;colpane<context.colpanes.length;colpane++){for(colnum=context.colpanes[colpane].first;colnum<=context.colpanes[colpane].last;colnum++){coord=SocialCalc.crToCoord(colnum,oldrownum);if(context.cellskip[coord])continue;cell=sheetobj.cells[coord];if(cell&&cell.rowspan>maxrowspan)maxrowspan=cell.rowspan;}}if(maxrowspan>1){for(rownum=1;rownum<maxrowspan;rownum++){if(rownum+oldrownum>=context.rowpanes[rowpane].last)break;newrow=context.RenderRow(rownum+oldrownum,rowpane);oldchild=tbodyobj.childNodes[toprow+rownum-1];tbodyobj.replaceChild(newrow,oldchild);}}// if added a row that includes rowspans from above, update the size of those to include new row\n\tbottomrownum=context.rowpanes[rowpane].last;for(colpane=0;colpane<context.colpanes.length;colpane++){for(colnum=context.colpanes[colpane].first;colnum<=context.colpanes[colpane].last;colnum++){coord=context.cellskip[SocialCalc.crToCoord(colnum,bottomrownum)];if(!coord)continue;// only look at spanned cells\n\trownum=context.coordToCR[coord].row-0;if(rownum==context.rowpanes[rowpane].last||rownum<context.rowpanes[rowpane].first)continue;// this row (colspan) or starts above pane\n\tcell=sheetobj.cells[coord];if(cell&&cell.rowspan>1)rowneedsrefresh[rownum]=true;// remember row num to update\n\t}}for(rownum in rowneedsrefresh){newrow=context.RenderRow(rownum,rowpane);oldchild=tbodyobj.childNodes[toprow+(rownum-context.rowpanes[rowpane].first)];tbodyobj.replaceChild(newrow,oldchild);}return tableobj;};SocialCalc.ScrollTableDownOneRow=function(editor){var toprow,rowpane,rownum,colnum,colpane,cell,newrownum,maxspan,newbottomrow,newrow,oldchild,bottomrownum;var rowneedsrefresh={};var context=editor.context;var sheetobj=context.sheetobj;var tableobj=editor.fullgrid;var tbodyobj;tbodyobj=tableobj.lastChild;toprow=context.showRCHeaders?2:1;for(rowpane=0;rowpane<context.rowpanes.length-1;rowpane++){toprow+=context.rowpanes[rowpane].last-context.rowpanes[rowpane].first+2;// skip pane and spacing row\n\t}tbodyobj.removeChild(tbodyobj.childNodes[toprow+(context.rowpanes[rowpane].last-context.rowpanes[rowpane].first)]);context.rowpanes[rowpane].first--;context.rowpanes[rowpane].last--;editor.FitToEditTable();context.CalculateColWidthData();// Just in case, since normally done in RenderSheet\n\tnewrow=context.RenderRow(context.rowpanes[rowpane].first,rowpane);tbodyobj.insertBefore(newrow,tbodyobj.childNodes[toprow]);// if inserted a row with starting rowspans, replace rows for the largest rowspan\n\tmaxrowspan=1;newrownum=context.rowpanes[rowpane].first;for(colpane=0;colpane<context.colpanes.length;colpane++){for(colnum=context.colpanes[colpane].first;colnum<=context.colpanes[colpane].last;colnum++){coord=SocialCalc.crToCoord(colnum,newrownum);if(context.cellskip[coord])continue;cell=sheetobj.cells[coord];if(cell&&cell.rowspan>maxrowspan)maxrowspan=cell.rowspan;}}if(maxrowspan>1){for(rownum=1;rownum<maxrowspan;rownum++){if(rownum+newrownum>context.rowpanes[rowpane].last)break;newrow=context.RenderRow(rownum+newrownum,rowpane);oldchild=tbodyobj.childNodes[toprow+rownum];tbodyobj.replaceChild(newrow,oldchild);}}// if last row now includes rowspans or rowspans from above, update the size of those to remove deleted row\n\tbottomrownum=context.rowpanes[rowpane].last;for(colpane=0;colpane<context.colpanes.length;colpane++){for(colnum=context.colpanes[colpane].first;colnum<=context.colpanes[colpane].last;colnum++){coord=SocialCalc.crToCoord(colnum,bottomrownum);cell=sheetobj.cells[coord];if(cell&&cell.rowspan>1){rowneedsrefresh[bottomrownum]=true;// need to update this row\n\tcontinue;}coord=context.cellskip[SocialCalc.crToCoord(colnum,bottomrownum)];if(!coord)continue;// only look at spanned cells\n\trownum=context.coordToCR[coord].row-0;if(rownum==bottomrownum||rownum<context.rowpanes[rowpane].first)continue;// this row (colspan) or starts above pane\n\tcell=sheetobj.cells[coord];if(cell&&cell.rowspan>1)rowneedsrefresh[rownum]=true;// remember row num to update\n\t}}for(rownum in rowneedsrefresh){newrow=context.RenderRow(rownum,rowpane);oldchild=tbodyobj.childNodes[toprow+(rownum-context.rowpanes[rowpane].first)];tbodyobj.replaceChild(newrow,oldchild);}return tableobj;};// *************************************\n\t//\n\t// InputBox class:\n\t//\n\t// This class deals with the text box for editing cell contents.\n\t// It mainly controls a user input box for typed content and is used to interact with\n\t// the keyboard code, etc.\n\t//\n\t// You can use this inside a formula bar control of some sort.\n\t// You create this after you have created a table editor object (but not necessarily\n\t// done the CreateTableEditor method).\n\t//\n\t// When the user starts typing text, or double-clicks on a cell, this object\n\t// comes into play.\n\t//\n\t// The element given when this is first constructed should be an input HTMLElement or\n\t// something that acts like one. Check the code here to see what is done to it.\n\t//\n\t// *************************************\n\tSocialCalc.InputBox=function(element,editor){if(!element)return;// invoked without enough data to work\n\tthis.element=element;// the input element associated with this InputBox\n\tthis.editor=editor;// the TableEditor this belongs to\n\tthis.inputEcho=null;editor.inputBox=this;element.onmousedown=SocialCalc.InputBoxOnMouseDown;editor.MoveECellCallback.formulabar=function(e){if(e.state!=\"start\"){return;}// if not in normal keyboard mode don't replace formula bar\n\teditor.inputBox.DisplayCellContents(e.ecell.coord);};};// Methods:\n\tSocialCalc.InputBox.prototype.DisplayCellContents=function(coord){SocialCalc.InputBoxDisplayCellContents(this,coord);};SocialCalc.InputBox.prototype.ShowInputBox=function(show){this.editor.inputEcho.ShowInputEcho(show);};SocialCalc.InputBox.prototype.GetText=function(){return this.element.value;};SocialCalc.InputBox.prototype.SetText=function(newtext){if(!this.element)return;this.element.value=newtext;if(!SocialCalc.Constants.SCNoInputEcho){this.editor.inputEcho.SetText(newtext+\"_\");}};SocialCalc.InputBox.prototype.Focus=function(){SocialCalc.InputBoxFocus(this);};SocialCalc.InputBox.prototype.Blur=function(){return this.element.blur();};SocialCalc.InputBox.prototype.Select=function(t){if(!this.element)return;switch(t){case\"end\":if(document.selection&&document.selection.createRange){/* IE 4+ - Safer than setting .selectionEnd as it also works for Textareas. */var range=document.selection.createRange().duplicate();range.moveToElementText(this.element);range.collapse(false);range.select();}else if(this.element.selectionStart!=undefined){this.element.selectionStart=this.element.value.length;this.element.selectionEnd=this.element.value.length;}break;}};// Functions:\n\t//\n\t// SocialCalc.InputBoxDisplayCellContents(inputbox, coord)\n\t//\n\t// Sets input box to the contents of the specified cell (or ecell if null).\n\t//\n\tvar CoordForColorChange;var editCoord;SocialCalc.InputBoxDisplayCellContents=function(inputbox,coord){var scc=SocialCalc.Constants;if(!inputbox)return;//changes for prompt\n\tif(!coord){coord=inputbox.editor.ecell.coord;}var text=SocialCalc.GetCellContents(inputbox.editor.context.sheetobj,coord);if(text.indexOf(\"\\n\")!=-1){//text = scc.s_inputboxdisplaymultilinetext;\n\ttext=scc.s_inputboxdisplaynoteditable;inputbox.element.disabled=true;SocialCalc.ToggleInputLineButtons(false);}else if(!SocialCalc.Callbacks.IsCellEditable(inputbox.editor)){text=scc.s_inputboxdisplaynoteditable;SocialCalc.ToggleInputLineButtons(false);inputbox.element.disabled=true;inputbox.element.style.display=\"none\";}else{CoordForColorChange=coord;editCoord=coord;//changes for prompt\n\tvar control=SocialCalc.GetCurrentWorkBookControl();var spreadsheet=control.workbook.spreadsheet;cell=SocialCalc.GetEditorCellElement(inputbox.editor,inputbox.editor.ecell.row,inputbox.editor.ecell.col);var left=\"100px\";var top=\"100px\";var width=100;if(cell){position=SocialCalc.GetElementPosition(cell.element);left=position.left-2+\"px\";top=position.top-7+\"px\";width=cell.element.offsetWidth;}if(!cell||width==0){//scrolled off screen\n\tSocialCalc.ToggleInputLineButtons(false);inputbox.element.disabled=true;inputbox.element.style.display=\"none\";// do nothing\n\treturn;}var ele=document.getElementById(spreadsheet.formulabarDiv.id);if(ele){spreadsheet.spreadsheetDiv.removeChild(spreadsheet.formulabarDiv);}spreadsheet.formulabarDiv.style.left=left;spreadsheet.formulabarDiv.style.top=top;//spreadsheet.formulabarDiv.style.width = \"30px\";\n\t//spreadsheet.formulabarDiv.style.fontSize = \"10px\";\n\tspreadsheet.formulabarDiv.style.zIndex=100;spreadsheet.formulabarDiv.style.position=\"absolute\";var input=spreadsheet.formulabarDiv.firstChild;//changes for prompt\n\tinput.style.fontSize=\"100%\";// input.style.backgroundColor = \"#72A4D2\";\n\tinput.style.borderBottomColor=\"#306eff\";input.style.borderBottomLeftRadius=\"3px\";input.style.borderBottomRightRadius=\"3px\";input.style.borderBottomStyle=\"solid\";input.style.borderBottomWidth=\"2px\";input.style.borderLeftColor=\"#306eff\";input.style.borderLeftStyle=\"solid\";input.style.borderLeftWidth=\"2px\";input.style.borderRightColor=\"#306eff\";input.style.borderRightStyle=\"solid\";input.style.borderRightWidth=\"2px\";input.style.borderTopColor=\"#306eff\";input.style.borderTopLeftRadius=\"3px\";input.style.borderTopRightRadius=\"3px\";input.style.borderTopStyle=\"solid\";input.style.borderTopWidth=\"2px\";//console.log(\"cell width =\"+width)\n\t//changes for prompt\n\tinput.size=\"\"+width/8;spreadsheet.spreadsheetDiv.appendChild(spreadsheet.formulabarDiv);inputbox.element.disabled=false;inputbox.element.style.display=\"inline\";SocialCalc.ToggleInputLineButtons(true);}if(scc.SCNoQuoteInInputBox&&text.substring(0,1)==\"'\"){text=text.substring(1);}inputbox.SetText(text);// autoSave(selectedFile);\n\t};//\n\t// SocialCalc.InputBoxFocus(inputbox)\n\t//\n\t// Call this to have the input box get the focus and respond to keystrokes\n\t// but still pass them off to SocialCalc.ProcessKey.\n\t//\n\tSocialCalc.InputBoxFocus=function(inputbox){if(!inputbox)return;inputbox.element.focus();var editor=inputbox.editor;editor.state=\"input\";var wval=editor.workingvalues;wval.partialexpr=\"\";wval.ecoord=editor.ecell.coord;wval.erow=editor.ecell.row;wval.ecol=editor.ecell.col;};//\n\t// SocialCalc.InputBoxOnMouseDown(e)\n\t//\n\t// This is called when the input box gets the focus. It then responds to keystrokes\n\t// and pass them off to SocialCalc.ProcessKey, but in a different editing state.\n\t//\n\tSocialCalc.InputBoxOnMouseDown=function(e){var editor=SocialCalc.Keyboard.focusTable;// get TableEditor doing keyboard stuff\n\tif(!editor)return true;// we're not handling it -- let browser do default\n\tvar wval=editor.workingvalues;switch(editor.state){case\"start\":editor.state=\"inputboxdirect\";wval.partialexpr=\"\";wval.ecoord=editor.ecell.coord;wval.erow=editor.ecell.row;wval.ecol=editor.ecell.col;editor.inputEcho.ShowInputEcho(true);break;case\"input\":wval.partialexpr=\"\";// make sure not pointing\n\teditor.MoveECell(wval.ecoord);editor.state=\"inputboxdirect\";SocialCalc.KeyboardFocus();// may have come here from outside of grid\n\tbreak;case\"inputboxdirect\":break;}};// *************************************\n\t//\n\t// InputEcho class:\n\t//\n\t// This object creates and controls an element that echos what's in the InputBox during editing\n\t// It is draggable.\n\t//\n\t// *************************************\n\tSocialCalc.InputEcho=function(editor){var scc=SocialCalc.Constants;this.editor=editor;// the TableEditor this belongs to\n\tthis.text=\"\";// current value of what is displayed\n\tthis.interval=null;// timer handle\n\tthis.container=null;// element containing main echo as well as prompt line\n\tthis.main=null;// main echo area\n\tthis.prompt=null;this.functionbox=null;// function chooser dialog\n\tthis.container=document.createElement(\"div\");SocialCalc.setStyles(this.container,\"display:none;position:absolute;zIndex:10;\");this.topprompt=document.createElement(\"div\");if(scc.defaultInputEchoPromptClass)this.topprompt.className=scc.defaultInputEchoPromptClass;if(scc.defaultInputEchoPromptStyle)SocialCalc.setStyles(this.topprompt,scc.defaultInputEchoPromptStyle);this.topprompt.innerHTML=\"\";this.container.appendChild(this.topprompt);this.main=document.createElement(\"div\");if(scc.defaultInputEchoClass)this.main.className=scc.defaultInputEchoClass;if(scc.defaultInputEchoStyle)SocialCalc.setStyles(this.main,scc.defaultInputEchoStyle);this.main.innerHTML=\"&nbsp;\";this.container.appendChild(this.main);this.prompt=document.createElement(\"div\");if(scc.defaultInputEchoPromptClass)this.prompt.className=scc.defaultInputEchoPromptClass;if(scc.defaultInputEchoPromptStyle)SocialCalc.setStyles(this.prompt,scc.defaultInputEchoPromptStyle);this.prompt.innerHTML=\"\";this.container.appendChild(this.prompt);SocialCalc.DragRegister(this.main,true,true,{MouseDown:SocialCalc.DragFunctionStart,MouseMove:SocialCalc.DragFunctionPosition,MouseUp:SocialCalc.DragFunctionPosition,Disabled:null,positionobj:this.container});editor.toplevel.appendChild(this.container);};// Methods:\n\tSocialCalc.InputEcho.prototype.ShowInputEcho=function(show){return SocialCalc.ShowInputEcho(this,show);};SocialCalc.InputEcho.prototype.SetText=function(str){return SocialCalc.SetInputEchoText(this,str);};// Functions:\n\tSocialCalc.ShowInputEcho=function(inputecho,show){var cell,position;var editor=inputecho.editor;if(!editor)return;if(SocialCalc.Constants.SCNoInputEcho){return;}if(show){editor.cellhandles.ShowCellHandles(false);cell=SocialCalc.GetEditorCellElement(editor,editor.ecell.row,editor.ecell.col);if(cell){position=SocialCalc.GetElementPosition(cell.element);inputecho.container.style.left=position.left-1+\"px\";inputecho.container.style.top=position.top-1+\"px\";}inputecho.container.style.display=\"block\";if(inputecho.interval)window.clearInterval(inputecho.interval);// just in case\n\tinputecho.interval=window.setInterval(SocialCalc.InputEchoHeartbeat,50);}else{if(inputecho.interval)window.clearInterval(inputecho.interval);inputecho.container.style.display=\"none\";inputecho.topprompt.innerHTML=\"\";}};SocialCalc.SetInputEchoText=function(inputecho,str){if(SocialCalc.Constants.SCNoInputEcho){return;}var scc=SocialCalc.Constants;var fname,fstr;var newstr=SocialCalc.special_chars(str);newstr=newstr.replace(/\\n/g,\"<br>\");if(inputecho.text!=newstr){inputecho.main.innerHTML=newstr;inputecho.text=newstr;}var parts=str.match(/.*[\\+\\-\\*\\/\\&\\^\\<\\>\\=\\,\\(]([A-Za-z][A-ZA-z]\\w*?)\\([^\\)]*$/);if(str.charAt(0)==\"=\"&&parts){fname=parts[1].toUpperCase();if(SocialCalc.Formula.FunctionList[fname]){SocialCalc.Formula.FillFunctionInfo();//  make sure filled\n\tfstr=SocialCalc.special_chars(fname+\"(\"+SocialCalc.Formula.FunctionArgString(fname)+\")\");}else{fstr=scc.ietUnknownFunction+fname;}if(inputecho.prompt.innerHTML!=fstr){inputecho.prompt.innerHTML=fstr;inputecho.prompt.style.display=\"block\";}}else if(inputecho.prompt.style.display!=\"none\"){inputecho.prompt.innerHTML=\"\";inputecho.prompt.style.display=\"none\";}var editor=inputecho.editor;if(editor.workingvalues.currentsheet!=editor.workingvalues.startsheet){var promptstr=\"Editing:\"+editor.workingvalues.startsheet+\"!\"+editor.workingvalues.ecoord;if(promptstr!=inputecho.topprompt.innerHTML){inputecho.topprompt.innerHTML=\"Editing:\"+editor.workingvalues.startsheet+\"!\"+editor.workingvalues.ecoord;inputecho.topprompt.style.display=\"block\";}}else{if(inputecho.topprompt.style.display!=\"none\"){inputecho.topprompt.innerHTML=\"\";inputecho.topprompt.style.display=\"none\";}}};SocialCalc.InputEchoHeartbeat=function(){var editor=SocialCalc.Keyboard.focusTable;// get TableEditor doing keyboard stuff\n\tif(!editor)return true;// we're not handling it -- let browser do default\n\tif(SocialCalc.Constants.SCNoInputEcho){return;}if(editor.state==\"inputboxdirect\"){editor.inputEcho.SetText(editor.inputBox.GetText()+\"_\");}};SocialCalc.InputEchoMouseDown=function(e){var event=e||window.event;var editor=SocialCalc.Keyboard.focusTable;// get TableEditor doing keyboard stuff\n\tif(!editor)return true;// we're not handling it -- let browser do default\n\tif(SocialCalc.Constants.SCNoInputEcho){return;}//      if (event.stopPropagation) event.stopPropagation(); // DOM Level 2\n\t//      else event.cancelBubble = true; // IE 5+\n\t//      if (event.preventDefault) event.preventDefault(); // DOM Level 2\n\t//      else event.returnValue = false; // IE 5+\n\teditor.inputBox.element.focus();//      return false;\n\t};// *************************************\n\t//\n\t// CellHandles class:\n\t//\n\t// This object creates and controls the elements around the cursor cell for dragging, etc.\n\t//\n\t// *************************************\n\tSocialCalc.CellHandles=function(editor){var scc=SocialCalc.Constants;var functions;if(editor.noEdit)return;// leave us with nothing\n\tif(scc.SCCellHandlesDisable)return;this.editor=editor;// the TableEditor this belongs to\n\tthis.noCursorSuffix=false;this.movedmouse=false;// used to detect no-op\n\tthis.draghandle=document.createElement(\"div\");SocialCalc.setStyles(this.draghandle,\"display:none;position:absolute;zIndex:8;border:1px solid white;width:4px;height:4px;fontSize:1px;backgroundColor:#0E93D8;cursor:default;\");this.draghandle.innerHTML='&nbsp;';editor.toplevel.appendChild(this.draghandle);SocialCalc.AssignID(editor,this.draghandle,\"draghandle\");var imagetype=\"png\";if(navigator.userAgent.match(/MSIE 6\\.0/)){imagetype=\"gif\";}this.dragpalette=document.createElement(\"div\");SocialCalc.setStyles(this.dragpalette,\"display:none;position:absolute;zIndex:8;width:90px;height:90px;fontSize:1px;textAlign:center;cursor:default;\"+\"backgroundImage:url(\"+SocialCalc.Constants.defaultImagePrefix+\"drag-handles.\"+imagetype+\");\");this.dragpalette.innerHTML='&nbsp;';editor.toplevel.appendChild(this.dragpalette);SocialCalc.AssignID(editor,this.dragpalette,\"dragpalette\");this.dragtooltip=document.createElement(\"div\");SocialCalc.setStyles(this.dragtooltip,\"display:none;position:absolute;zIndex:9;border:1px solid black;width:100px;height:auto;fontSize:10px;backgroundColor:#FFFFFF;\");this.dragtooltip.innerHTML='&nbsp;';editor.toplevel.appendChild(this.dragtooltip);SocialCalc.AssignID(editor,this.dragtooltip,\"dragtooltip\");this.fillinghandle=document.createElement(\"div\");SocialCalc.setStyles(this.fillinghandle,\"display:none;position:absolute;zIndex:9;border:1px solid black;width:auto;height:14px;fontSize:10px;backgroundColor:#FFFFFF;\");this.fillinghandle.innerHTML='&nbsp;';editor.toplevel.appendChild(this.fillinghandle);SocialCalc.AssignID(editor,this.fillinghandle,\"fillinghandle\");if(this.draghandle.addEventListener){// DOM Level 2 -- Firefox, et al\n\tthis.draghandle.addEventListener(\"mousemove\",SocialCalc.CellHandlesMouseMoveOnHandle,false);this.dragpalette.addEventListener(\"mousedown\",SocialCalc.CellHandlesMouseDown,false);this.dragpalette.addEventListener(\"mousemove\",SocialCalc.CellHandlesMouseMoveOnHandle,false);}else if(this.draghandle.attachEvent){// IE 5+\n\tthis.draghandle.attachEvent(\"onmousemove\",SocialCalc.CellHandlesMouseMoveOnHandle);this.dragpalette.attachEvent(\"onmousedown\",SocialCalc.CellHandlesMouseDown);this.dragpalette.attachEvent(\"onmousemove\",SocialCalc.CellHandlesMouseMoveOnHandle);}else{// don't handle this\n\tthrow\"Browser not supported\";}};// Methods:\n\tSocialCalc.CellHandles.prototype.ShowCellHandles=function(show,moveshow){return SocialCalc.ShowCellHandles(this,show,moveshow);};// Functions:\n\tSocialCalc.ShowCellHandles=function(cellhandles,show,moveshow){var cell,cell2,position,position2;var editor=cellhandles.editor;var doshow=false;var row,col,viewport;if(!editor)return;do{// a block that can you can \"break\" out of easily\n\tif(!show)break;row=editor.ecell.row;col=editor.ecell.col;if(editor.state!=\"start\")break;if(row>=editor.lastvisiblerow)break;if(col>=editor.lastvisiblecol)break;if(row<editor.firstscrollingrow)break;if(col<editor.firstscrollingcol)break;if(editor.rowpositions[row+1]+20>editor.horizontaltablecontrol.controlborder){break;}if(editor.rowpositions[row+1]-10<editor.headposition.top){break;}if(editor.colpositions[col+1]+20>editor.verticaltablecontrol.controlborder){break;}if(editor.colpositions[col+1]-30<editor.headposition.left){break;}cellhandles.draghandle.style.left=editor.colpositions[col+1]-1+\"px\";cellhandles.draghandle.style.top=editor.rowpositions[row+1]-1+\"px\";cellhandles.draghandle.style.display=\"block\";if(moveshow){cellhandles.draghandle.style.display=\"none\";cellhandles.dragpalette.style.left=editor.colpositions[col+1]-45+\"px\";cellhandles.dragpalette.style.top=editor.rowpositions[row+1]-45+\"px\";cellhandles.dragpalette.style.display=\"block\";viewport=SocialCalc.GetViewportInfo();cellhandles.dragtooltip.style.right=viewport.width-(editor.colpositions[col+1]-1)+\"px\";cellhandles.dragtooltip.style.bottom=viewport.height-(editor.rowpositions[row+1]-1)+\"px\";cellhandles.dragtooltip.style.display=\"none\";}doshow=true;}while(false);// only do once\n\tif(!doshow){cellhandles.draghandle.style.display=\"none\";}if(!moveshow){cellhandles.dragpalette.style.display=\"none\";cellhandles.dragtooltip.style.display=\"none\";}};SocialCalc.CellHandlesMouseMoveOnHandle=function(e){var scc=SocialCalc.Constants;var event=e||window.event;var target=event.target||event.srcElement;var viewport=SocialCalc.GetViewportInfo();var clientX=event.clientX+viewport.horizontalScroll;var clientY=event.clientY+viewport.verticalScroll;editor=SocialCalc.Keyboard.focusTable;// get TableEditor doing keyboard stuff\n\tif(!editor)return true;// we're not handling it -- let browser do default\n\tvar cellhandles=editor.cellhandles;if(!cellhandles.editor)return true;// no handles\n\tif(!editor.cellhandles.mouseDown){editor.cellhandles.ShowCellHandles(true,true);// show move handles, too\n\tif(target==cellhandles.dragpalette){var whichhandle=SocialCalc.SegmentDivHit([scc.CH_radius1,scc.CH_radius2],editor.cellhandles.dragpalette,clientX,clientY);if(whichhandle==0){// off of active part of palette\n\tSocialCalc.CellHandlesHoverTimeout();return;}if(cellhandles.tooltipstimer){window.clearTimeout(cellhandles.tooltipstimer);cellhandles.tooltipstimer=null;}cellhandles.tooltipswhichhandle=whichhandle;cellhandles.tooltipstimer=window.setTimeout(SocialCalc.CellHandlesTooltipsTimeout,700);}if(cellhandles.timer){window.clearTimeout(cellhandles.timer);cellhandles.timer=null;}cellhandles.timer=window.setTimeout(SocialCalc.CellHandlesHoverTimeout,3000);}return;};//\n\t// whichsegment = SocialCalc.SegmentDivHit(segtable, divWithMouseHit, x, y)\n\t//\n\t// Takes segtable = [upperleft quadrant, upperright, bottomright, bottomleft]\n\t//  where each quadrant is either:\n\t//      0 = ignore hits here\n\t//      number = return this value\n\t//      array = a new segtable for this subquadrant\n\t//\n\t// Alternatively, segtable can be:\n\t//  [radius 1, radius 2] and it returns 0 if no hit,\n\t//  -1, -2, -3, -4 for inner quadrants, and +1...+4 for outer quadrants\n\t//\n\tSocialCalc.SegmentDivHit=function(segtable,divWithMouseHit,x,y){var width=divWithMouseHit.offsetWidth;var height=divWithMouseHit.offsetHeight;var left=divWithMouseHit.offsetLeft;var top=divWithMouseHit.offsetTop;var v=0;var table=segtable;var len=Math.sqrt(Math.pow(x-left-(width/2.0-.5),2)+Math.pow(y-top-(height/2.0-.5),2));if(table.length==2){// type 2 segtable\n\tif(x>=left&&x<left+width/2&&y>=top&&y<top+height/2){// upper left\n\tif(len<=segtable[0])v=-1;else if(len<=segtable[1])v=1;}if(x>=left+width/2&&x<left+width&&y>=top&&y<top+height/2){// upper right\n\tif(len<=segtable[0])v=-2;else if(len<=segtable[1])v=2;}if(x>=left+width/2&&x<left+width&&y>=top+height/2&&y<top+height){// bottom right\n\tif(len<=segtable[0])v=-3;else if(len<=segtable[1])v=3;}if(x>=left&&x<left+width/2&&y>=top+height/2&&y<top+height){// bottom right\n\tif(len<=segtable[0])v=-4;else if(len<=segtable[1])v=4;}return v;}while(true){if(x>=left&&x<left+width/2&&y>=top&&y<top+height/2){// upper left\n\tquadrant+=\"1\";v=table[0];if(typeof v==\"number\"){break;}table=v;width=width/2;height=height/2;continue;}if(x>=left+width/2&&x<left+width&&y>=top&&y<top+height/2){// upper right\n\tquadrant+=\"2\";v=table[1];if(typeof v==\"number\"){break;}table=v;width=width/2;left=left+width;height=height/2;continue;}if(x>=left+width/2&&x<left+width&&y>=top+height/2&&y<top+height){// bottom right\n\tquadrant+=\"3\";v=table[2];if(typeof v==\"number\"){break;}table=v;width=width/2;left=left+width;height=height/2;top=top+height;continue;}if(x>=left&&x<left+width/2&&y>=top+height/2&&y<top+height){// bottom right\n\tquadrant+=\"4\";v=table[3];if(typeof v==\"number\"){break;}table=v;width=width/2;height=height/2;top=top+height;continue;}return 0;// didn't match\n\t}//addmsg((x-divWithMouseHit.offsetLeft)+\",\"+(y-divWithMouseHit.offsetTop)+\"=\"+quadrant+\" \"+v);\n\treturn v;};SocialCalc.CellHandlesHoverTimeout=function(){editor=SocialCalc.Keyboard.focusTable;// get TableEditor doing keyboard stuff\n\tif(!editor)return true;// we're not handling it -- let browser do default\n\tvar cellhandles=editor.cellhandles;if(cellhandles.timer){window.clearTimeout(cellhandles.timer);cellhandles.timer=null;}if(cellhandles.tooltipstimer){window.clearTimeout(cellhandles.tooltipstimer);cellhandles.tooltipstimer=null;}editor.cellhandles.ShowCellHandles(true,false);// hide move handles\n\t};SocialCalc.CellHandlesTooltipsTimeout=function(){editor=SocialCalc.Keyboard.focusTable;// get TableEditor doing keyboard stuff\n\tif(!editor)return true;// we're not handling it -- let browser do default\n\tvar cellhandles=editor.cellhandles;if(cellhandles.tooltipstimer){window.clearTimeout(cellhandles.tooltipstimer);cellhandles.tooltipstimer=null;}var whichhandle=cellhandles.tooltipswhichhandle;if(whichhandle==0){// off of active part of palette\n\tSocialCalc.CellHandlesHoverTimeout();return;}if(whichhandle==-3){cellhandles.dragtooltip.innerHTML=scc.s_CHfillAllTooltip;}else if(whichhandle==3){cellhandles.dragtooltip.innerHTML=scc.s_CHfillContentsTooltip;}else if(whichhandle==-2){cellhandles.dragtooltip.innerHTML=scc.s_CHmovePasteAllTooltip;}else if(whichhandle==-4){cellhandles.dragtooltip.innerHTML=scc.s_CHmoveInsertAllTooltip;}else if(whichhandle==2){cellhandles.dragtooltip.innerHTML=scc.s_CHmovePasteContentsTooltip;}else if(whichhandle==4){cellhandles.dragtooltip.innerHTML=scc.s_CHmoveInsertContentsTooltip;}else{cellhandles.dragtooltip.innerHTML=\"&nbsp;\";cellhandles.dragtooltip.style.display=\"none\";return;}cellhandles.dragtooltip.style.display=\"block\";};SocialCalc.CellHandlesMouseDown=function(e){var scc=SocialCalc.Constants;var editor,result,coord,textarea,wval,range;var event=e||window.event;var viewport=SocialCalc.GetViewportInfo();var clientX=event.clientX+viewport.horizontalScroll;var clientY=event.clientY+viewport.verticalScroll;var mouseinfo=SocialCalc.EditorMouseInfo;editor=SocialCalc.Keyboard.focusTable;// get TableEditor doing keyboard stuff\n\tif(!editor)return true;// we're not handling it -- let browser do default\n\tif(editor.busy)return;// don't do anything when busy (is this correct?)\n\tvar cellhandles=editor.cellhandles;cellhandles.movedmouse=false;// detect no-op\n\tif(cellhandles.timer){// cancel timer\n\twindow.clearTimeout(cellhandles.timer);cellhandles.timer=null;}if(cellhandles.tooltipstimer){window.clearTimeout(cellhandles.tooltipstimer);cellhandles.tooltipstimer=null;}cellhandles.dragtooltip.innerHTML=\"&nbsp;\";cellhandles.dragtooltip.style.display=\"none\";range=editor.range;var whichhandle=SocialCalc.SegmentDivHit([scc.CH_radius1,scc.CH_radius2],editor.cellhandles.dragpalette,clientX,clientY);if(whichhandle==1||whichhandle==-1||whichhandle==0){cellhandles.ShowCellHandles(true,false);// hide move handles\n\treturn;}mouseinfo.ignore=true;// stop other code from looking at the mouse\n\tif(whichhandle==-3){cellhandles.dragtype=\"Fill\";//      mouseinfo.element = editor.cellhandles.fillhandle;\n\tcellhandles.noCursorSuffix=false;}else if(whichhandle==3){cellhandles.dragtype=\"FillC\";//      mouseinfo.element = editor.cellhandles.fillhandle;\n\tcellhandles.noCursorSuffix=false;}else if(whichhandle==-2){cellhandles.dragtype=\"Move\";//      mouseinfo.element = editor.cellhandles.movehandle1;\n\tcellhandles.noCursorSuffix=true;}else if(whichhandle==-4){cellhandles.dragtype=\"MoveI\";//      mouseinfo.element = editor.cellhandles.movehandle2;\n\tcellhandles.noCursorSuffix=false;}else if(whichhandle==2){cellhandles.dragtype=\"MoveC\";//      mouseinfo.element = editor.cellhandles.movehandle1;\n\tcellhandles.noCursorSuffix=true;}else if(whichhandle==4){cellhandles.dragtype=\"MoveIC\";//      mouseinfo.element = editor.cellhandles.movehandle2;\n\tcellhandles.noCursorSuffix=false;}cellhandles.filltype=null;switch(cellhandles.dragtype){case\"Fill\":case\"FillC\":if(!range.hasrange){editor.RangeAnchor();}break;case\"Move\":case\"MoveI\":case\"MoveC\":case\"MoveIC\":if(!range.hasrange){editor.RangeAnchor();}editor.range2.top=editor.range.top;editor.range2.right=editor.range.right;editor.range2.bottom=editor.range.bottom;editor.range2.left=editor.range.left;editor.range2.hasrange=true;editor.RangeRemove();break;default:return;// not for us\n\t}cellhandles.fillinghandle.style.left=clientX+\"px\";cellhandles.fillinghandle.style.top=clientY-17+\"px\";cellhandles.fillinghandle.innerHTML=scc.s_CHindicatorOperationLookup[cellhandles.dragtype]+(scc.s_CHindicatorDirectionLookup[editor.cellhandles.filltype]||\"\");cellhandles.fillinghandle.style.display=\"block\";cellhandles.ShowCellHandles(true,false);// hide move handles\n\tcellhandles.mouseDown=true;mouseinfo.editor=editor;// remember for later\n\tcoord=editor.ecell.coord;// start with cell with handles\n\tcellhandles.startingcoord=coord;cellhandles.startingX=clientX;cellhandles.startingY=clientY;mouseinfo.mouselastcoord=coord;SocialCalc.KeyboardSetFocus(editor);if(document.addEventListener){// DOM Level 2 -- Firefox, et al\n\tdocument.addEventListener(\"mousemove\",SocialCalc.CellHandlesMouseMove,true);// capture everywhere\n\tdocument.addEventListener(\"mouseup\",SocialCalc.CellHandlesMouseUp,true);// capture everywhere\n\t}else if(cellhandles.draghandle.attachEvent){// IE 5+\n\tcellhandles.draghandle.setCapture();cellhandles.draghandle.attachEvent(\"onmousemove\",SocialCalc.CellHandlesMouseMove);cellhandles.draghandle.attachEvent(\"onmouseup\",SocialCalc.CellHandlesMouseUp);cellhandles.draghandle.attachEvent(\"onlosecapture\",SocialCalc.CellHandlesMouseUp);}if(event.stopPropagation)event.stopPropagation();// DOM Level 2\n\telse event.cancelBubble=true;// IE 5+\n\tif(event.preventDefault)event.preventDefault();// DOM Level 2\n\telse event.returnValue=false;// IE 5+\n\treturn;};SocialCalc.CellHandlesMouseMove=function(e){var scc=SocialCalc.Constants;var editor,element,result,coord,now,textarea,sheetobj,cellobj,wval;var crstart,crend,cr,c,r;var event=e||window.event;var viewport=SocialCalc.GetViewportInfo();var clientX=event.clientX+viewport.horizontalScroll;var clientY=event.clientY+viewport.verticalScroll;var mouseinfo=SocialCalc.EditorMouseInfo;editor=mouseinfo.editor;if(!editor)return;// not us, ignore\n\tvar cellhandles=editor.cellhandles;element=mouseinfo.element;result=SocialCalc.GridMousePosition(editor,clientX,clientY);// get cell with move\n\tif(!result)return;if(result&&!result.coord){SocialCalc.SetDragAutoRepeat(editor,result,SocialCalc.CellHandlesDragAutoRepeat);return;}SocialCalc.SetDragAutoRepeat(editor,null);// stop repeating if it was\n\tif(!result.coord)return;crstart=SocialCalc.coordToCr(editor.cellhandles.startingcoord);crend=SocialCalc.coordToCr(result.coord);cellhandles.movedmouse=true;// did move, so not no-op\n\tswitch(cellhandles.dragtype){case\"Fill\":case\"FillC\":if(result.coord==cellhandles.startingcoord){// reset when come back\n\tcellhandles.filltype=null;cellhandles.startingX=clientX;cellhandles.startingY=clientY;}else{if(cellhandles.filltype){// moving and have already determined filltype\n\tif(cellhandles.filltype==\"Down\"){// coerse to that\n\tcrend.col=crstart.col;if(crend.row<crstart.row)crend.row=crstart.row;}else{crend.row=crstart.row;if(crend.col<crstart.col)crend.col=crstart.col;}}else{if(Math.abs(clientY-cellhandles.startingY)>10){cellhandles.filltype=\"Down\";}else if(Math.abs(clientX-cellhandles.startingX)>10){cellhandles.filltype=\"Right\";}crend.col=crstart.col;// until decide, leave it at start\n\tcrend.row=crstart.row;}}result.coord=SocialCalc.crToCoord(crend.col,crend.row);if(result.coord!=mouseinfo.mouselastcoord){editor.MoveECell(result.coord);editor.RangeExtend();}break;case\"Move\":case\"MoveC\":if(result.coord!=mouseinfo.mouselastcoord){editor.MoveECell(result.coord);c=editor.range2.right-editor.range2.left+result.col;r=editor.range2.bottom-editor.range2.top+result.row;editor.RangeAnchor(SocialCalc.crToCoord(c,r));editor.RangeExtend();}break;case\"MoveI\":case\"MoveIC\":if(result.coord==cellhandles.startingcoord){// reset when come back\n\tcellhandles.filltype=null;cellhandles.startingX=clientX;cellhandles.startingY=clientY;}else{if(cellhandles.filltype){// moving and have already determined filltype\n\tif(cellhandles.filltype==\"Vertical\"){// coerse to that\n\tcrend.col=editor.range2.left;if(crend.row>=editor.range2.top&&crend.row<=editor.range2.bottom+1)crend.row=editor.range2.bottom+2;}else{crend.row=editor.range2.top;if(crend.col>=editor.range2.left&&crend.col<=editor.range2.right+1)crend.col=editor.range2.right+2;}}else{if(Math.abs(clientY-cellhandles.startingY)>10){cellhandles.filltype=\"Vertical\";}else if(Math.abs(clientX-cellhandles.startingX)>10){cellhandles.filltype=\"Horizontal\";}crend.col=crstart.col;// until decide, leave it at start\n\tcrend.row=crstart.row;}}result.coord=SocialCalc.crToCoord(crend.col,crend.row);if(result.coord!=mouseinfo.mouselastcoord){editor.MoveECell(result.coord);if(!cellhandles.filltype){// no fill type\n\teditor.RangeRemove();}else{c=editor.range2.right-editor.range2.left+crend.col;r=editor.range2.bottom-editor.range2.top+crend.row;editor.RangeAnchor(SocialCalc.crToCoord(c,r));editor.RangeExtend();}}break;}cellhandles.fillinghandle.style.left=clientX+\"px\";cellhandles.fillinghandle.style.top=clientY-17+\"px\";cellhandles.fillinghandle.innerHTML=scc.s_CHindicatorOperationLookup[cellhandles.dragtype]+(scc.s_CHindicatorDirectionLookup[editor.cellhandles.filltype]||\"\");cellhandles.fillinghandle.style.display=\"block\";mouseinfo.mouselastcoord=result.coord;if(event.stopPropagation)event.stopPropagation();// DOM Level 2\n\telse event.cancelBubble=true;// IE 5+\n\tif(event.preventDefault)event.preventDefault();// DOM Level 2\n\telse event.returnValue=false;// IE 5+\n\treturn;};SocialCalc.CellHandlesDragAutoRepeat=function(coord,direction){var mouseinfo=SocialCalc.EditorMouseInfo;var editor=mouseinfo.editor;if(!editor)return;// not us, ignore\n\tvar cellhandles=editor.cellhandles;var crstart=SocialCalc.coordToCr(editor.cellhandles.startingcoord);var crend=SocialCalc.coordToCr(coord);var newcoord,c,r;var vscroll=0;var hscroll=0;if(direction==\"left\")hscroll=-1;else if(direction==\"right\")hscroll=1;else if(direction==\"up\")vscroll=-1;else if(direction==\"down\")vscroll=1;editor.ScrollRelativeBoth(vscroll,hscroll);switch(cellhandles.dragtype){case\"Fill\":case\"FillC\":if(cellhandles.filltype){// moving and have already determined filltype\n\tif(cellhandles.filltype==\"Down\"){// coerse to that\n\tcrend.col=crstart.col;if(crend.row<crstart.row)crend.row=crstart.row;}else{crend.row=crstart.row;if(crend.col<crstart.col)crend.col=crstart.col;}}else{crend.col=crstart.col;// until decide, leave it at start\n\tcrend.row=crstart.row;}newcoord=SocialCalc.crToCoord(crend.col,crend.row);if(newcoord!=mouseinfo.mouselastcoord){editor.MoveECell(coord);editor.RangeExtend();}break;case\"Move\":case\"MoveC\":if(coord!=mouseinfo.mouselastcoord){editor.MoveECell(coord);c=editor.range2.right-editor.range2.left+editor.ecell.col;r=editor.range2.bottom-editor.range2.top+editor.ecell.row;editor.RangeAnchor(SocialCalc.crToCoord(c,r));editor.RangeExtend();}break;case\"MoveI\":case\"MoveIC\":if(cellhandles.filltype){// moving and have already determined filltype\n\tif(cellhandles.filltype==\"Vertical\"){// coerse to that\n\tcrend.col=editor.range2.left;if(crend.row>=editor.range2.top&&crend.row<=editor.range2.bottom+1)crend.row=editor.range2.bottom+2;}else{crend.row=editor.range2.top;if(crend.col>=editor.range2.left&&crend.col<=editor.range2.right+1)crend.col=editor.range2.right+2;}}else{crend.col=crstart.col;// until decide, leave it at start\n\tcrend.row=crstart.row;}newcoord=SocialCalc.crToCoord(crend.col,crend.row);if(newcoord!=mouseinfo.mouselastcoord){editor.MoveECell(newcoord);c=editor.range2.right-editor.range2.left+crend.col;r=editor.range2.bottom-editor.range2.top+crend.row;editor.RangeAnchor(SocialCalc.crToCoord(c,r));editor.RangeExtend();}break;}mouseinfo.mouselastcoord=newcoord;};SocialCalc.CellHandlesMouseUp=function(e){var editor,element,result,coord,now,textarea,sheetobj,cellobj,wval,cstr,cmdtype,cmdtype2;var crstart,crend;var sizec,sizer,deltac,deltar;var event=e||window.event;var viewport=SocialCalc.GetViewportInfo();var clientX=event.clientX+viewport.horizontalScroll;var clientY=event.clientY+viewport.verticalScroll;var mouseinfo=SocialCalc.EditorMouseInfo;editor=mouseinfo.editor;if(!editor)return;// not us, ignore\n\tvar cellhandles=editor.cellhandles;element=mouseinfo.element;mouseinfo.ignore=false;result=SocialCalc.GridMousePosition(editor,clientX,clientY);// get cell with up\n\tSocialCalc.SetDragAutoRepeat(editor,null);// stop repeating if it was\n\tcellhandles.mouseDown=false;cellhandles.noCursorSuffix=false;cellhandles.fillinghandle.style.display=\"none\";if(!result)result={};if(!result.coord)result.coord=editor.ecell.coord;switch(cellhandles.dragtype){case\"Fill\":case\"Move\":case\"MoveI\":cmdtype2=\" all\";break;case\"FillC\":case\"MoveC\":case\"MoveIC\":cmdtype2=\" formulas\";break;}if(!cellhandles.movedmouse){// didn't move: just leave one cell selected\n\tcellhandles.dragtype=\"Nothing\";}switch(cellhandles.dragtype){case\"Nothing\":editor.Range2Remove();editor.RangeRemove();break;case\"Fill\":case\"FillC\":crstart=SocialCalc.coordToCr(cellhandles.startingcoord);crend=SocialCalc.coordToCr(result.coord);if(cellhandles.filltype){if(cellhandles.filltype==\"Down\"){crend.col=crstart.col;}else{crend.row=crstart.row;}}result.coord=SocialCalc.crToCoord(crend.col,crend.row);editor.MoveECell(result.coord);editor.RangeExtend();if(editor.cellhandles.filltype==\"Right\"){cmdtype=\"right\";}else{cmdtype=\"down\";}cstr=\"fill\"+cmdtype+\" \"+SocialCalc.crToCoord(editor.range.left,editor.range.top)+\":\"+SocialCalc.crToCoord(editor.range.right,editor.range.bottom)+cmdtype2;editor.EditorScheduleSheetCommands(cstr,true,false);break;case\"Move\":case\"MoveC\":editor.context.cursorsuffix=\"\";cstr=\"movepaste \"+SocialCalc.crToCoord(editor.range2.left,editor.range2.top)+\":\"+SocialCalc.crToCoord(editor.range2.right,editor.range2.bottom)+\" \"+editor.ecell.coord+cmdtype2;editor.EditorScheduleSheetCommands(cstr,true,false);editor.Range2Remove();break;case\"MoveI\":case\"MoveIC\":editor.context.cursorsuffix=\"\";sizec=editor.range2.right-editor.range2.left;sizer=editor.range2.bottom-editor.range2.top;deltac=editor.ecell.col-editor.range2.left;deltar=editor.ecell.row-editor.range2.top;cstr=\"moveinsert \"+SocialCalc.crToCoord(editor.range2.left,editor.range2.top)+\":\"+SocialCalc.crToCoord(editor.range2.right,editor.range2.bottom)+\" \"+editor.ecell.coord+cmdtype2;editor.EditorScheduleSheetCommands(cstr,true,false);editor.Range2Remove();editor.RangeRemove();if(editor.cellhandles.filltype==\" Horizontal\"&&deltac>0){editor.MoveECell(SocialCalc.crToCoord(editor.ecell.col-sizec-1,editor.ecell.row));}else if(editor.cellhandles.filltype==\" Vertical\"&&deltar>0){editor.MoveECell(SocialCalc.crToCoord(editor.ecell.col,editor.ecell.row-sizer-1));}editor.RangeAnchor(SocialCalc.crToCoord(editor.ecell.col+sizec,editor.ecell.row+sizer));editor.RangeExtend();break;}if(event.stopPropagation)event.stopPropagation();// DOM Level 2\n\telse event.cancelBubble=true;// IE 5+\n\tif(event.preventDefault)event.preventDefault();// DOM Level 2\n\telse event.returnValue=false;// IE 5+\n\tif(document.removeEventListener){// DOM Level 2\n\tdocument.removeEventListener(\"mousemove\",SocialCalc.CellHandlesMouseMove,true);document.removeEventListener(\"mouseup\",SocialCalc.CellHandlesMouseUp,true);}else if(cellhandles.draghandle.detachEvent){// IE\n\tcellhandles.draghandle.detachEvent(\"onlosecapture\",SocialCalc.CellHandlesMouseUp);cellhandles.draghandle.detachEvent(\"onmouseup\",SocialCalc.CellHandlesMouseUp);cellhandles.draghandle.detachEvent(\"onmousemove\",SocialCalc.CellHandlesMouseMove);cellhandles.draghandle.releaseCapture();}mouseinfo.editor=null;return false;};// *************************************\n\t//\n\t// TableControl class:\n\t//\n\t// This class deals with the horizontal and verical scrollbars and pane sliders.\n\t//\n\t// +--------------+\n\t// | Endcap       |\n\t// +- - - - - - - +\n\t// |              |\n\t// +--------------+\n\t// | Pane Slider  |\n\t// +--------------+\n\t// |              |\n\t// | Less Button  |\n\t// |              |\n\t// +--------------+\n\t// | Scroll Area  |\n\t// |              |\n\t// |              |\n\t// +--------------+\n\t// | Thumb        |\n\t// +--------------+\n\t// |              |\n\t// +--------------+\n\t// |              |\n\t// | More Button  |\n\t// |              |\n\t// +--------------+\n\t//\n\t// *************************************\n\tSocialCalc.TableControl=function(editor,vertical,size){var scc=SocialCalc.Constants;this.editor=editor;// the TableEditor this belongs to\n\tthis.vertical=vertical;// true if vertical control, false if horizontal\n\tthis.size=size;// length in pixels\n\tthis.main=null;// main element containing all the others\n\tthis.endcap=null;// the area at the top/left between the end and the pane slider\n\tthis.paneslider=null;// the slider to adjust the pane split\n\tthis.lessbutton=null;// the top/left scroll button\n\tthis.morebutton=null;// the bottom/right scroll button\n\tthis.scrollarea=null;// the area between the scroll buttons\n\tthis.thumb=null;// the sliding thing in the scrollarea\n\t// computed position values:\n\tthis.controlborder=null;// left or top screen position for vertical or horizontal control\n\tthis.endcapstart=null;// top or left screen position for vertical or horizontal control\n\tthis.panesliderstart=null;this.lessbuttonstart=null;this.morebuttonstart=null;this.scrollareastart=null;this.scrollareaend=null;this.scrollareasize=null;this.thumbpos=null;// constants:\n\tthis.controlthickness=scc.defaultTableControlThickness;// other dimension of complete control in pixels\n\tthis.sliderthickness=scc.defaultTCSliderThickness;this.buttonthickness=scc.defaultTCButtonThickness;this.thumbthickness=scc.defaultTCThumbThickness;this.minscrollingpanesize=this.buttonthickness+this.buttonthickness+this.thumbthickness+20;// the 20 is to leave a little space\n\t};// Methods:\n\tSocialCalc.TableControl.prototype.CreateTableControl=function(){return SocialCalc.CreateTableControl(this);};SocialCalc.TableControl.prototype.PositionTableControlElements=function(){SocialCalc.PositionTableControlElements(this);};SocialCalc.TableControl.prototype.ComputeTableControlPositions=function(){SocialCalc.ComputeTableControlPositions(this);};// Functions:\n\tSocialCalc.CreateTableControl=function(control){var s,functions,params;var AssignID=SocialCalc.AssignID;var setStyles=SocialCalc.setStyles;var scc=SocialCalc.Constants;var TooltipRegister=function TooltipRegister(element,etype,vh){if(scc[\"s_\"+etype+\"Tooltip\"+vh]){SocialCalc.TooltipRegister(element,scc[\"s_\"+etype+\"Tooltip\"+vh],null);}};var imageprefix=control.editor.imageprefix;var vh=control.vertical?\"v\":\"h\";control.main=document.createElement(\"div\");s=control.main.style;s.height=(control.vertical?control.size:control.controlthickness)+\"px\";s.width=(control.vertical?control.controlthickness:control.size)+\"px\";s.zIndex=0;setStyles(control.main,scc.TCmainStyle);s.backgroundImage=\"url(\"+imageprefix+\"main-\"+vh+\".gif)\";if(scc.TCmainClass)control.main.className=scc.TCmainClass;control.main.style.display=\"none\";// wait for layout\n\tcontrol.endcap=document.createElement(\"div\");s=control.endcap.style;s.height=control.controlthickness+\"px\";s.width=control.controlthickness+\"px\";s.zIndex=1;s.overflow=\"hidden\";// IE will make the DIV at least font-size height...so use this\n\ts.position=\"absolute\";setStyles(control.endcap,scc.TCendcapStyle);s.backgroundImage=\"url(\"+imageprefix+\"endcap-\"+vh+\".gif)\";if(scc.TCendcapClass)control.endcap.className=scc.TCendcapClass;AssignID(control.editor,control.endcap,\"endcap\"+vh);control.main.appendChild(control.endcap);control.paneslider=document.createElement(\"div\");s=control.paneslider.style;s.height=(control.vertical?control.sliderthickness:control.controlthickness)+\"px\";s.overflow=\"hidden\";// IE will make the DIV at least font-size height...so use this\n\ts.width=(control.vertical?control.controlthickness:control.sliderthickness)+\"px\";s.position=\"absolute\";s[control.vertical?\"top\":\"left\"]=\"4px\";s.zIndex=3;setStyles(control.paneslider,scc.TCpanesliderStyle);s.backgroundImage=\"url(\"+imageprefix+\"paneslider-\"+vh+\".gif)\";if(scc.TCpanesliderClass)control.paneslider.className=scc.TCpanesliderClass;AssignID(control.editor,control.paneslider,\"paneslider\"+vh);TooltipRegister(control.paneslider,\"paneslider\",vh);functions={MouseDown:SocialCalc.TCPSDragFunctionStart,MouseMove:SocialCalc.TCPSDragFunctionMove,MouseUp:SocialCalc.TCPSDragFunctionStop,Disabled:function Disabled(){return control.editor.busy;}};functions.control=control;// make sure this is there\n\tSocialCalc.DragRegister(control.paneslider,control.vertical,!control.vertical,functions);control.main.appendChild(control.paneslider);control.lessbutton=document.createElement(\"div\");s=control.lessbutton.style;s.height=(control.vertical?control.buttonthickness:control.controlthickness)+\"px\";s.width=(control.vertical?control.controlthickness:control.buttonthickness)+\"px\";s.zIndex=2;s.overflow=\"hidden\";// IE will make the DIV at least font-size height...so use this\n\ts.position=\"absolute\";setStyles(control.lessbutton,scc.TClessbuttonStyle);s.backgroundImage=\"url(\"+imageprefix+\"less-\"+vh+\"n.gif)\";if(scc.TClessbuttonClass)control.lessbutton.className=scc.TClessbuttonClass;AssignID(control.editor,control.lessbutton,\"lessbutton\"+vh);params={repeatwait:scc.TClessbuttonRepeatWait,repeatinterval:scc.TClessbuttonRepeatInterval,normalstyle:\"backgroundImage:url(\"+imageprefix+\"less-\"+vh+\"n.gif);\",downstyle:\"backgroundImage:url(\"+imageprefix+\"less-\"+vh+\"d.gif);\",hoverstyle:\"backgroundImage:url(\"+imageprefix+\"less-\"+vh+\"h.gif);\"};functions={MouseDown:function MouseDown(){if(!control.editor.busy)control.editor.ScrollRelative(control.vertical,-1);},Repeat:function Repeat(){if(!control.editor.busy)control.editor.ScrollRelative(control.vertical,-1);},Disabled:function Disabled(){return control.editor.busy;}};SocialCalc.ButtonRegister(control.lessbutton,params,functions);control.main.appendChild(control.lessbutton);control.morebutton=document.createElement(\"div\");s=control.morebutton.style;s.height=(control.vertical?control.buttonthickness:control.controlthickness)+\"px\";s.width=(control.vertical?control.controlthickness:control.buttonthickness)+\"px\";s.zIndex=2;s.overflow=\"hidden\";// IE will make the DIV at least font-size height...so use this\n\ts.position=\"absolute\";setStyles(control.morebutton,scc.TCmorebuttonStyle);s.backgroundImage=\"url(\"+imageprefix+\"more-\"+vh+\"n.gif)\";if(scc.TCmorebuttonClass)control.morebutton.className=scc.TCmorebuttonClass;AssignID(control.editor,control.morebutton,\"morebutton\"+vh);params={repeatwait:scc.TCmorebuttonRepeatWait,repeatinterval:scc.TCmorebuttonRepeatInterval,normalstyle:\"backgroundImage:url(\"+imageprefix+\"more-\"+vh+\"n.gif);\",downstyle:\"backgroundImage:url(\"+imageprefix+\"more-\"+vh+\"d.gif);\",hoverstyle:\"backgroundImage:url(\"+imageprefix+\"more-\"+vh+\"h.gif);\"};functions={MouseDown:function MouseDown(){if(!control.editor.busy)control.editor.ScrollRelative(control.vertical,+1);},Repeat:function Repeat(){if(!control.editor.busy)control.editor.ScrollRelative(control.vertical,+1);},Disabled:function Disabled(){return control.editor.busy;}};SocialCalc.ButtonRegister(control.morebutton,params,functions);control.main.appendChild(control.morebutton);control.scrollarea=document.createElement(\"div\");s=control.scrollarea.style;s.height=control.controlthickness+\"px\";s.width=control.controlthickness+\"px\";s.zIndex=1;s.overflow=\"hidden\";// IE will make the DIV at least font-size height...so use this\n\ts.position=\"absolute\";setStyles(control.scrollarea,scc.TCscrollareaStyle);s.backgroundImage=\"url(\"+imageprefix+\"scrollarea-\"+vh+\".gif)\";if(scc.TCscrollareaClass)control.scrollarea.className=scc.TCscrollareaClass;AssignID(control.editor,control.scrollarea,\"scrollarea\"+vh);params={repeatwait:scc.TCscrollareaRepeatWait,repeatinterval:scc.TCscrollareaRepeatWait};functions={MouseDown:SocialCalc.ScrollAreaClick,Repeat:SocialCalc.ScrollAreaClick,Disabled:function Disabled(){return control.editor.busy;}};functions.control=control;SocialCalc.ButtonRegister(control.scrollarea,params,functions);control.main.appendChild(control.scrollarea);control.thumb=document.createElement(\"div\");s=control.thumb.style;s.height=(control.vertical?control.thumbthickness:control.controlthickness)+\"px\";s.width=(control.vertical?control.controlthickness:control.thumbthickness)+\"px\";s.zIndex=2;s.overflow=\"hidden\";// IE will make the DIV at least font-size height...so use this\n\ts.position=\"absolute\";setStyles(control.thumb,scc.TCthumbStyle);control.thumb.style.backgroundImage=\"url(\"+imageprefix+\"thumb-\"+vh+\"n.gif)\";if(scc.TCthumbClass)control.thumb.className=scc.TCthumbClass;AssignID(control.editor,control.thumb,\"thumb\"+vh);functions={MouseDown:SocialCalc.TCTDragFunctionStart,MouseMove:SocialCalc.TCTDragFunctionMove,MouseUp:SocialCalc.TCTDragFunctionStop,Disabled:function Disabled(){return control.editor.busy;}};functions.control=control;// make sure this is there\n\tSocialCalc.DragRegister(control.thumb,control.vertical,!control.vertical,functions);params={normalstyle:\"backgroundImage:url(\"+imageprefix+\"thumb-\"+vh+\"n.gif)\",name:\"Thumb\",downstyle:\"backgroundImage:url(\"+imageprefix+\"thumb-\"+vh+\"d.gif)\",hoverstyle:\"backgroundImage:url(\"+imageprefix+\"thumb-\"+vh+\"h.gif)\"};SocialCalc.ButtonRegister(control.thumb,params,null);// give it button-like visual behavior\n\tcontrol.main.appendChild(control.thumb);return control.main;};//\n\t// ScrollAreaClick - Button function to process pageup/down clicks\n\t//\n\tSocialCalc.ScrollAreaClick=function(e,buttoninfo,bobj){var control=bobj.functionobj.control;var bposition=SocialCalc.GetElementPosition(bobj.element);var clickpos=control.vertical?buttoninfo.clientY:buttoninfo.clientX;if(control.editor.busy){// ignore if busy - wait for next repeat\n\treturn;}control.editor.PageRelative(control.vertical,clickpos>control.thumbpos?1:-1);return;};//\n\t// PositionTableControlElements\n\t//\n\tSocialCalc.PositionTableControlElements=function(control){var border,realend,thumbpos;var editor=control.editor;if(control.vertical){border=control.controlborder+\"px\";control.endcap.style.top=control.endcapstart+\"px\";control.endcap.style.left=border;control.paneslider.style.top=control.panesliderstart+\"px\";control.paneslider.style.left=border;control.lessbutton.style.top=control.lessbuttonstart+\"px\";control.lessbutton.style.left=border;control.morebutton.style.top=control.morebuttonstart+\"px\";control.morebutton.style.left=border;control.scrollarea.style.top=control.scrollareastart+\"px\";control.scrollarea.style.left=border;control.scrollarea.style.height=control.scrollareasize+\"px\";realend=Math.max(editor.context.sheetobj.attribs.lastrow,editor.firstscrollingrow+1);thumbpos=(editor.firstscrollingrow-(editor.lastnonscrollingrow+1))*(control.scrollareasize-3*control.thumbthickness)/(realend-(editor.lastnonscrollingrow+1))+control.scrollareastart-1;thumbpos=Math.floor(thumbpos);control.thumb.style.top=thumbpos+\"px\";control.thumb.style.left=border;}else{border=control.controlborder+\"px\";control.endcap.style.left=control.endcapstart+\"px\";control.endcap.style.top=border;control.paneslider.style.left=control.panesliderstart+\"px\";control.paneslider.style.top=border;control.lessbutton.style.left=control.lessbuttonstart+\"px\";control.lessbutton.style.top=border;control.morebutton.style.left=control.morebuttonstart+\"px\";control.morebutton.style.top=border;control.scrollarea.style.left=control.scrollareastart+\"px\";control.scrollarea.style.top=border;control.scrollarea.style.width=control.scrollareasize+\"px\";realend=Math.max(editor.context.sheetobj.attribs.lastcol,editor.firstscrollingcol+1);thumbpos=(editor.firstscrollingcol-(editor.lastnonscrollingcol+1))*(control.scrollareasize-control.thumbthickness)/(realend-editor.lastnonscrollingcol)+control.scrollareastart-1;thumbpos=Math.floor(thumbpos);control.thumb.style.left=thumbpos+\"px\";control.thumb.style.top=border;}control.thumbpos=thumbpos;control.main.style.display=\"block\";};//\n\t// ComputeTableControlPositions\n\t//\n\t// This routine computes the screen positions and other values needed for laying out\n\t// the table control elements.\n\t//\n\tSocialCalc.ComputeTableControlPositions=function(control){var editor=control.editor;if(!editor.gridposition||!editor.headposition)throw\"Can't compute table control positions before editor positions\";if(control.vertical){control.controlborder=editor.gridposition.left+editor.tablewidth;// border=left position\n\tcontrol.endcapstart=editor.gridposition.top;// start=top position\n\tcontrol.panesliderstart=editor.firstscrollingrowtop-control.sliderthickness;control.lessbuttonstart=editor.firstscrollingrowtop-1;control.morebuttonstart=editor.gridposition.top+editor.tableheight-control.buttonthickness;control.scrollareastart=editor.firstscrollingrowtop-1+control.buttonthickness;control.scrollareaend=control.morebuttonstart-1;control.scrollareasize=control.scrollareaend-control.scrollareastart+1;}else{control.controlborder=editor.gridposition.top+editor.tableheight;// border=top position\n\tcontrol.endcapstart=editor.gridposition.left;// start=left position\n\tcontrol.panesliderstart=editor.firstscrollingcolleft-control.sliderthickness;control.lessbuttonstart=editor.firstscrollingcolleft-1;control.morebuttonstart=editor.gridposition.left+editor.tablewidth-control.buttonthickness;control.scrollareastart=editor.firstscrollingcolleft-1+control.buttonthickness;control.scrollareaend=control.morebuttonstart-1;control.scrollareasize=control.scrollareaend-control.scrollareastart+1;}};////// TCPS - TableControl Pan Slider methods\n\t//\n\t// TCPSDragFunctionStart(event, draginfo, dobj)\n\t//\n\t// TableControlPaneSlider function for starting drag\n\t//\n\tSocialCalc.TCPSDragFunctionStart=function(event,draginfo,dobj){var editor=dobj.functionobj.control.editor;var scc=SocialCalc.Constants;SocialCalc.DragFunctionStart(event,draginfo,dobj);draginfo.trackingline=document.createElement(\"div\");draginfo.trackingline.style.height=dobj.vertical?scc.TCPStrackinglineThickness:editor.tableheight-(editor.headposition.top-editor.gridposition.top)+\"px\";draginfo.trackingline.style.width=dobj.vertical?editor.tablewidth-(editor.headposition.left-editor.gridposition.left)+\"px\":scc.TCPStrackinglineThickness;draginfo.trackingline.style.backgroundImage=\"url(\"+editor.imageprefix+\"trackingline-\"+(dobj.vertical?\"v\":\"h\")+\".gif)\";;if(scc.TCPStrackinglineClass)draginfo.trackingline.className=scc.TCPStrackinglineClass;SocialCalc.setStyles(draginfo.trackingline,scc.TCPStrackinglineStyle);if(dobj.vertical){row=SocialCalc.Lookup(draginfo.clientY+dobj.functionobj.control.sliderthickness,editor.rowpositions);draginfo.trackingline.style.top=(editor.rowpositions[row]||editor.headposition.top)+\"px\";draginfo.trackingline.style.left=editor.headposition.left+\"px\";if(editor.context.rowpanes.length-1){// has 2 already\n\teditor.context.SetRowPaneFirstLast(1,editor.context.rowpanes[0].last+1,editor.context.rowpanes[0].last+1);editor.FitToEditTable();editor.ScheduleRender();}}else{col=SocialCalc.Lookup(draginfo.clientX+dobj.functionobj.control.sliderthickness,editor.colpositions);draginfo.trackingline.style.top=editor.headposition.top+\"px\";draginfo.trackingline.style.left=(editor.colpositions[col]||editor.headposition.left)+\"px\";if(editor.context.colpanes.length-1){// has 2 already\n\teditor.context.SetColPaneFirstLast(1,editor.context.colpanes[0].last+1,editor.context.colpanes[0].last+1);editor.FitToEditTable();editor.ScheduleRender();}}editor.griddiv.appendChild(draginfo.trackingline);};//\n\t// TCPSDragFunctionMove(event, draginfo, dobj)\n\t//\n\tSocialCalc.TCPSDragFunctionMove=function(event,draginfo,dobj){var row,col,max,min;var control=dobj.functionobj.control;var sliderthickness=control.sliderthickness;var editor=control.editor;if(dobj.vertical){max=control.morebuttonstart-control.minscrollingpanesize-draginfo.offsetY;// restrict movement\n\tif(draginfo.clientY>max)draginfo.clientY=max;min=editor.headposition.top-sliderthickness-draginfo.offsetY;if(draginfo.clientY<min)draginfo.clientY=min;row=SocialCalc.Lookup(draginfo.clientY+sliderthickness,editor.rowpositions);draginfo.trackingline.style.top=(editor.rowpositions[row]||editor.headposition.top)+\"px\";}else{max=control.morebuttonstart-control.minscrollingpanesize-draginfo.offsetX;if(draginfo.clientX>max)draginfo.clientX=max;min=editor.headposition.left-sliderthickness-draginfo.offsetX;if(draginfo.clientX<min)draginfo.clientX=min;col=SocialCalc.Lookup(draginfo.clientX+sliderthickness,editor.colpositions);draginfo.trackingline.style.left=(editor.colpositions[col]||editor.headposition.left)+\"px\";}SocialCalc.DragFunctionPosition(event,draginfo,dobj);};//\n\t// TCPSDragFunctionStop(event, draginfo, dobj)\n\t//\n\tSocialCalc.TCPSDragFunctionStop=function(event,draginfo,dobj){var row,col,max,min;var control=dobj.functionobj.control;var sliderthickness=control.sliderthickness;var editor=control.editor;if(dobj.vertical){max=control.morebuttonstart-control.minscrollingpanesize-draginfo.offsetY;// restrict movement\n\tif(draginfo.clientY>max)draginfo.clientY=max;min=editor.headposition.top-sliderthickness-draginfo.offsetY;if(draginfo.clientY<min)draginfo.clientY=min;row=SocialCalc.Lookup(draginfo.clientY+sliderthickness,editor.rowpositions);if(row>editor.context.sheetobj.attribs.lastrow)row=editor.context.sheetobj.attribs.lastrow;// can't extend sheet here\n\tif(!row||row<=editor.context.rowpanes[0].first){// set to no panes, leaving first pane settings\n\tif(editor.context.rowpanes.length>1)editor.context.rowpanes.length=1;}else if(editor.context.rowpanes.length-1){// has 2 already\n\tif(!editor.timeout){// not waiting for position calc (so positions could be wrong)\n\teditor.context.SetRowPaneFirstLast(0,editor.context.rowpanes[0].first,row-1);editor.context.SetRowPaneFirstLast(1,row,row);}}else{editor.context.SetRowPaneFirstLast(0,editor.context.rowpanes[0].first,row-1);editor.context.SetRowPaneFirstLast(1,row,row);}}else{max=control.morebuttonstart-control.minscrollingpanesize-draginfo.offsetX;if(draginfo.clientX>max)draginfo.clientX=max;min=editor.headposition.left-sliderthickness-draginfo.offsetX;if(draginfo.clientX<min)draginfo.clientX=min;col=SocialCalc.Lookup(draginfo.clientX+sliderthickness,editor.colpositions);if(col>editor.context.sheetobj.attribs.lastcol)col=editor.context.sheetobj.attribs.lastcol;// can't extend sheet here\n\tif(!col||col<=editor.context.colpanes[0].first){// set to no panes, leaving first pane settings\n\tif(editor.context.colpanes.length>1)editor.context.colpanes.length=1;}else if(editor.context.colpanes.length-1){// has 2 already\n\tif(!editor.timeout){// not waiting for position calc (so positions could be wrong)\n\teditor.context.SetColPaneFirstLast(0,editor.context.colpanes[0].first,col-1);editor.context.SetColPaneFirstLast(1,col,col);}}else{editor.context.SetColPaneFirstLast(0,editor.context.colpanes[0].first,col-1);editor.context.SetColPaneFirstLast(1,col,col);}}editor.FitToEditTable();editor.griddiv.removeChild(draginfo.trackingline);editor.ScheduleRender();};////// TCT - TableControl Thumb methods\n\t//!!!! Note: Need to make start use same code as move/stop for determining row/col, since stop will set that\n\t//!!!! Note: Need to make start/move/stop use positioning code that corresponds closer to\n\t//!!!!       ComputeTableControlPositions calculations.\n\t//\n\t// TCTDragFunctionStart(event, draginfo, dobj)\n\t//\n\t// TableControlThumb function for starting drag\n\t//\n\tSocialCalc.TCTDragFunctionStart=function(event,draginfo,dobj){var rowpane,colpane,row,col;var control=dobj.functionobj.control;var editor=control.editor;var scc=SocialCalc.Constants;SocialCalc.DragFunctionStart(event,draginfo,dobj);if(draginfo.thumbstatus){// get rid of old one if mouseup was out of window\n\tif(draginfo.thumbstatus.rowmsgele)draginfo.thumbstatus.rowmsgele=null;if(draginfo.thumbstatus.rowpreviewele)draginfo.thumbstatus.rowpreviewele=null;editor.toplevel.removeChild(draginfo.thumbstatus);draginfo.thumbstatus=null;}draginfo.thumbstatus=document.createElement(\"div\");if(dobj.vertical){if(scc.TCTDFSthumbstatusvClass)draginfo.thumbstatus.className=scc.TCTDFSthumbstatusvClass;SocialCalc.setStyles(draginfo.thumbstatus,scc.TCTDFSthumbstatusvStyle);draginfo.thumbstatus.style.top=draginfo.clientY+scc.TCTDFStopOffsetv+\"px\";draginfo.thumbstatus.style.left=control.controlborder-10-editor.tablewidth/2+\"px\";draginfo.thumbstatus.style.width=editor.tablewidth/2+\"px\";draginfo.thumbcontext=new SocialCalc.RenderContext(editor.context.sheetobj);draginfo.thumbcontext.showGrid=true;draginfo.thumbcontext.rowpanes=[{first:1,last:1}];var pane=editor.context.colpanes[editor.context.colpanes.length-1];draginfo.thumbcontext.colpanes=[{first:pane.first,last:pane.last}];draginfo.thumbstatus.innerHTML='<table cellspacing=\"0\" cellpadding=\"0\"><tr><td valign=\"top\" style=\"'+scc.TCTDFSthumbstatusrownumStyle+'\" class=\"'+scc.TCTDFSthumbstatusrownumClass+'\"><div>msg</div></td><td valign=\"top\"><div style=\"overflow:hidden;\">preview</div></td></tr></table>';draginfo.thumbstatus.rowmsgele=draginfo.thumbstatus.firstChild.firstChild.firstChild.firstChild.firstChild;draginfo.thumbstatus.rowpreviewele=draginfo.thumbstatus.firstChild.firstChild.firstChild.childNodes[1].firstChild;editor.toplevel.appendChild(draginfo.thumbstatus);SocialCalc.TCTDragFunctionRowSetStatus(draginfo,editor,editor.firstscrollingrow||1);}else{if(scc.TCTDFSthumbstatushClass)draginfo.thumbstatus.className=scc.TCTDFSthumbstatushClass;SocialCalc.setStyles(draginfo.thumbstatus,scc.TCTDFSthumbstatushStyle);draginfo.thumbstatus.style.top=control.controlborder+scc.TCTDFStopOffseth+\"px\";draginfo.thumbstatus.style.left=draginfo.clientX+scc.TCTDFSleftOffseth+\"px\";editor.toplevel.appendChild(draginfo.thumbstatus);draginfo.thumbstatus.innerHTML=scc.s_TCTDFthumbstatusPrefixh+SocialCalc.rcColname(editor.firstscrollingcol);}};//\n\t// SocialCalc.TCTDragFunctionRowSetStatus(draginfo, editor, row)\n\t//\n\t// Render partial row\n\t//\n\tSocialCalc.TCTDragFunctionRowSetStatus=function(draginfo,editor,row){var scc=SocialCalc.Constants;var msg=scc.s_TCTDFthumbstatusPrefixv+row+\" \";draginfo.thumbstatus.rowmsgele.innerHTML=msg;draginfo.thumbcontext.rowpanes=[{first:row,last:row}];draginfo.thumbrowshown=row;var ele=draginfo.thumbcontext.RenderSheet(draginfo.thumbstatus.rowpreviewele.firstChild,{type:\"html\"});};//\n\t// TCTDragFunctionMove(event, draginfo, dobj)\n\t//\n\tSocialCalc.TCTDragFunctionMove=function(event,draginfo,dobj){var first,msg;var control=dobj.functionobj.control;var thumbthickness=control.thumbthickness;var editor=control.editor;var scc=SocialCalc.Constants;if(dobj.vertical){if(draginfo.clientY>control.scrollareaend-draginfo.offsetY-control.thumbthickness+2)draginfo.clientY=control.scrollareaend-draginfo.offsetY-control.thumbthickness+2;if(draginfo.clientY<control.scrollareastart-draginfo.offsetY-1)draginfo.clientY=control.scrollareastart-draginfo.offsetY-1;draginfo.thumbstatus.style.top=draginfo.clientY+\"px\";first=(draginfo.clientY+draginfo.offsetY-control.scrollareastart+1)/(control.scrollareasize-control.thumbthickness)*(editor.context.sheetobj.attribs.lastrow-editor.lastnonscrollingrow)+editor.lastnonscrollingrow+1;first=Math.floor(first);if(first<=editor.lastnonscrollingrow)first=editor.lastnonscrollingrow+1;if(first>editor.context.sheetobj.attribs.lastrow)first=editor.context.sheetobj.attribs.lastrow;//      msg = scc.s_TCTDFthumbstatusPrefixv+first;\n\tif(first!=draginfo.thumbrowshown){SocialCalc.TCTDragFunctionRowSetStatus(draginfo,editor,first);}}else{if(draginfo.clientX>control.scrollareaend-draginfo.offsetX-control.thumbthickness+2)draginfo.clientX=control.scrollareaend-draginfo.offsetX-control.thumbthickness+2;if(draginfo.clientX<control.scrollareastart-draginfo.offsetX-1)draginfo.clientX=control.scrollareastart-draginfo.offsetX-1;draginfo.thumbstatus.style.left=draginfo.clientX+\"px\";first=(draginfo.clientX+draginfo.offsetX-control.scrollareastart+1)/(control.scrollareasize-control.thumbthickness)*(editor.context.sheetobj.attribs.lastcol-editor.lastnonscrollingcol)+editor.lastnonscrollingcol+1;first=Math.floor(first);if(first<=editor.lastnonscrollingcol)first=editor.lastnonscrollingcol+1;if(first>editor.context.sheetobj.attribs.lastcol)first=editor.context.sheetobj.attribs.lastcol;msg=scc.s_TCTDFthumbstatusPrefixh+SocialCalc.rcColname(first);draginfo.thumbstatus.innerHTML=msg;}SocialCalc.DragFunctionPosition(event,draginfo,dobj);};//\n\t// TCTDragFunctionStop(event, draginfo, dobj)\n\t//\n\tSocialCalc.TCTDragFunctionStop=function(event,draginfo,dobj){var first;var control=dobj.functionobj.control;var editor=control.editor;if(dobj.vertical){first=(draginfo.clientY+draginfo.offsetY-control.scrollareastart+1)/(control.scrollareasize-control.thumbthickness)*(editor.context.sheetobj.attribs.lastrow-editor.lastnonscrollingrow)+editor.lastnonscrollingrow+1;first=Math.floor(first);if(first<=editor.lastnonscrollingrow)first=editor.lastnonscrollingrow+1;if(first>editor.context.sheetobj.attribs.lastrow)first=editor.context.sheetobj.attribs.lastrow;editor.context.SetRowPaneFirstLast(editor.context.rowpanes.length-1,first,first+1);}else{first=(draginfo.clientX+draginfo.offsetX-control.scrollareastart+1)/(control.scrollareasize-control.thumbthickness)*(editor.context.sheetobj.attribs.lastcol-editor.lastnonscrollingcol)+editor.lastnonscrollingcol+1;first=Math.floor(first);if(first<=editor.lastnonscrollingcol)first=editor.lastnonscrollingcol+1;if(first>editor.context.sheetobj.attribs.lastcol)first=editor.context.sheetobj.attribs.lastcol;editor.context.SetColPaneFirstLast(editor.context.colpanes.length-1,first,first+1);}editor.FitToEditTable();if(draginfo.thumbstatus.rowmsgele)draginfo.thumbstatus.rowmsgele=null;if(draginfo.thumbstatus.rowpreviewele)draginfo.thumbstatus.rowpreviewele=null;editor.toplevel.removeChild(draginfo.thumbstatus);draginfo.thumbstatus=null;editor.ScheduleRender();};// *************************************\n\t//\n\t// Dragging functions:\n\t//\n\t// *************************************\n\tSocialCalc.DragInfo={// There is only one of these -- no \"new\" is done.\n\t// Only one dragging operation can be active at a time.\n\t// The registeredElements array is used to decide which item to drag.\n\t// One item for each draggable thing, each an object with:\n\t//    .element, .vertical, .horizontal, .functionobj\n\tregisteredElements:[],// Items used during a drag\n\tdraggingElement:null,// item being processed (.element is the actual element)\n\tstartX:0,startY:0,startZ:0,clientX:0,// modifyable version to restrict movement\n\tclientY:0,offsetX:0,offsetY:0,horizontalScroll:0,// retrieved at drag start\n\tverticalScroll:0//\n\t// DragRegister(element, vertical, horizontal, functionobj) - make element draggable\n\t//\n\t// The functionobj defaults to moving the element contrained only by vertical and horizontal settings.\n\t//\n\t};SocialCalc.DragRegister=function(element,vertical,horizontal,functionobj){var draginfo=SocialCalc.DragInfo;if(!functionobj){functionobj={MouseDown:SocialCalc.DragFunctionStart,MouseMove:SocialCalc.DragFunctionPosition,MouseUp:SocialCalc.DragFunctionPosition,Disabled:null};}draginfo.registeredElements.push({element:element,vertical:vertical,horizontal:horizontal,functionobj:functionobj});if(element.addEventListener){// DOM Level 2 -- Firefox, et al\n\telement.addEventListener(\"mousedown\",SocialCalc.DragMouseDown,false);}else if(element.attachEvent){// IE 5+\n\telement.attachEvent(\"onmousedown\",SocialCalc.DragMouseDown);}else{// don't handle this\n\tthrow SocialCalc.Constants.s_BrowserNotSupported;}};//\n\t// DragUnregister(element) - remove object from list\n\t//\n\tSocialCalc.DragUnregister=function(element){var draginfo=SocialCalc.DragInfo;var i;if(!element)return;for(i=0;i<draginfo.registeredElements.length;i++){if(draginfo.registeredElements[i].element==element){draginfo.registeredElements.splice(i,1);if(element.removeEventListener){// DOM Level 2 -- Firefox, et al\n\telement.removeEventListener(\"mousedown\",SocialCalc.DragMouseDown,false);}else{// IE 5+\n\telement.detachEvent(\"onmousedown\",SocialCalc.DragMouseDown);}return;}}return;// ignore if not in list\n\t};//\n\t// DragMouseDown(event)\n\t//\n\tSocialCalc.DragMouseDown=function(event){var e=event||window.event;var draginfo=SocialCalc.DragInfo;var dobj=SocialCalc.LookupElement(e.target||e.srcElement,draginfo.registeredElements);if(!dobj)return;if(dobj&&dobj.functionobj&&dobj.functionobj.Disabled){if(dobj.functionobj.Disabled(e,draginfo,dobj)){return;}}draginfo.draggingElement=dobj;var viewportinfo=SocialCalc.GetViewportInfo();draginfo.horizontalScroll=viewportinfo.horizontalScroll;draginfo.verticalScroll=viewportinfo.verticalScroll;draginfo.clientX=e.clientX+draginfo.horizontalScroll;// get document-relative coordinates\n\tdraginfo.clientY=e.clientY+draginfo.verticalScroll;draginfo.startX=draginfo.clientX;draginfo.startY=draginfo.clientY;draginfo.startZ=dobj.element.style.zIndex;draginfo.offsetX=0;draginfo.offsetY=0;dobj.element.style.zIndex=\"100\";// Event code from JavaScript, Flanagan, 5th Edition, pg. 422\n\tif(document.addEventListener){// DOM Level 2 -- Firefox, et al\n\tdocument.addEventListener(\"mousemove\",SocialCalc.DragMouseMove,true);// capture everywhere\n\tdocument.addEventListener(\"mouseup\",SocialCalc.DragMouseUp,true);}else if(dobj.element.attachEvent){// IE 5+\n\tdobj.element.setCapture();dobj.element.attachEvent(\"onmousemove\",SocialCalc.DragMouseMove);dobj.element.attachEvent(\"onmouseup\",SocialCalc.DragMouseUp);dobj.element.attachEvent(\"onlosecapture\",SocialCalc.DragMouseUp);}if(e.stopPropagation)e.stopPropagation();// DOM Level 2\n\telse e.cancelBubble=true;// IE 5+\n\tif(e.preventDefault)e.preventDefault();// DOM Level 2\n\telse e.returnValue=false;// IE 5+\n\tif(dobj&&dobj.functionobj&&dobj.functionobj.MouseDown)dobj.functionobj.MouseDown(e,draginfo,dobj);return false;};//\n\t// DragMouseMove(event)\n\t//\n\tSocialCalc.DragMouseMove=function(event){var e=event||window.event;var draginfo=SocialCalc.DragInfo;draginfo.clientX=e.clientX+draginfo.horizontalScroll;draginfo.clientY=e.clientY+draginfo.verticalScroll;var dobj=draginfo.draggingElement;if(e.stopPropagation)e.stopPropagation();// DOM Level 2\n\telse e.cancelBubble=true;// IE 5+\n\tif(dobj&&dobj.functionobj&&dobj.functionobj.MouseMove)dobj.functionobj.MouseMove(e,draginfo,dobj);return false;};//\n\t// DragMouseUp(event)\n\t//\n\tSocialCalc.DragMouseUp=function(event){var e=event||window.event;var draginfo=SocialCalc.DragInfo;draginfo.clientX=e.clientX+draginfo.horizontalScroll;draginfo.clientY=e.clientY+draginfo.verticalScroll;var dobj=draginfo.draggingElement;dobj.element.style.zIndex=draginfo.startZ;if(dobj&&dobj.functionobj&&dobj.functionobj.MouseUp)dobj.functionobj.MouseUp(e,draginfo,dobj);if(e.stopPropagation)e.stopPropagation();// DOM Level 2\n\telse e.cancelBubble=true;// IE 5+\n\tif(document.removeEventListener){// DOM Level 2\n\tdocument.removeEventListener(\"mousemove\",SocialCalc.DragMouseMove,true);document.removeEventListener(\"mouseup\",SocialCalc.DragMouseUp,true);// Note: In old (1.5?) versions of Firefox, this causes the browser to skip the MouseUp for\n\t// the button code. https://bugzilla.mozilla.org/show_bug.cgi?id=174320\n\t// Firefox 1.5 is <1% share (http://marketshare.hitslink.com/report.aspx?qprid=7)\n\t}else if(dobj.element.detachEvent){// IE\n\tdobj.element.detachEvent(\"onlosecapture\",SocialCalc.DragMouseUp);dobj.element.detachEvent(\"onmouseup\",SocialCalc.DragMouseUp);dobj.element.detachEvent(\"onmousemove\",SocialCalc.DragMouseMove);dobj.element.releaseCapture();}draginfo.draggingElement=null;return false;};//\n\t// DragFunctionStart(event, draginfo, dobj)\n\t//\n\tSocialCalc.DragFunctionStart=function(event,draginfo,dobj){var val;var element=dobj.functionobj.positionobj||dobj.element;val=element.style.top.match(/\\d*/);draginfo.offsetY=(val?val[0]-0:0)-draginfo.clientY;val=element.style.left.match(/\\d*/);draginfo.offsetX=(val?val[0]-0:0)-draginfo.clientX;};//\n\t// DragFunctionPosition(event, draginfo, dobj)\n\t//\n\tSocialCalc.DragFunctionPosition=function(event,draginfo,dobj){var element=dobj.functionobj.positionobj||dobj.element;if(dobj.vertical)element.style.top=draginfo.clientY+draginfo.offsetY+\"px\";if(dobj.horizontal)element.style.left=draginfo.clientX+draginfo.offsetX+\"px\";};// *************************************\n\t//\n\t// Tooltip functions:\n\t//\n\t// *************************************\n\tSocialCalc.TooltipInfo={// There is only one of these -- no \"new\" is done.\n\t// Only one tooltip operation can be active at a time.\n\t// The registeredElements array is used to identify items.\n\t// One item for each element with a tooltip, each an object with:\n\t//    .element, .tiptext, .functionobj\n\t// Currently .functionobj can only contain .offsetx and .offsety.\n\t// If present they are used instead of the default ones.\n\tregisteredElements:[],registered:false,// if true, an event handler has been registered for this functionality\n\t// Items used during hover over an element\n\ttooltipElement:null,// item being processed (.element is the actual element)\n\ttimer:null,// timer object waiting to see if holding over element\n\tpopupElement:null,// tooltip element being displayed\n\tclientX:0,// modifyable version to restrict movement\n\tclientY:0,offsetX:SocialCalc.Constants.TooltipOffsetX,// modifyable version to allow positioning\n\toffsetY:SocialCalc.Constants.TooltipOffsetY//\n\t// TooltipRegister(element, tiptext, functionobj) - make element have a tooltip\n\t//\n\t};SocialCalc.TooltipRegister=function(element,tiptext,functionobj){var tooltipinfo=SocialCalc.TooltipInfo;tooltipinfo.registeredElements.push({element:element,tiptext:tiptext,functionobj:functionobj});if(tooltipinfo.registered)return;// only need to add event listener once\n\tif(document.addEventListener){// DOM Level 2 -- Firefox, et al\n\tdocument.addEventListener(\"mousemove\",SocialCalc.TooltipMouseMove,false);}else if(document.attachEvent){// IE 5+\n\tdocument.attachEvent(\"onmousemove\",SocialCalc.TooltipMouseMove);}else{// don't handle this\n\tthrow SocialCalc.Constants.s_BrowserNotSupported;}tooltipinfo.registered=true;// remember\n\treturn;};//\n\t// TooltipMouseMove(event)\n\t//\n\tSocialCalc.TooltipMouseMove=function(event){var e=event||window.event;var tooltipinfo=SocialCalc.TooltipInfo;tooltipinfo.viewport=SocialCalc.GetViewportInfo();tooltipinfo.clientX=e.clientX+tooltipinfo.viewport.horizontalScroll;tooltipinfo.clientY=e.clientY+tooltipinfo.viewport.verticalScroll;var tobj=SocialCalc.LookupElement(e.target||e.srcElement,tooltipinfo.registeredElements);if(tooltipinfo.timer){// waiting to see if holding still: didn't hold still\n\twindow.clearTimeout(tooltipinfo.timer);// cancel timer\n\ttooltipinfo.timer=null;}if(tooltipinfo.popupElement){// currently displaying a tip: hide it\n\tSocialCalc.TooltipHide();}tooltipinfo.tooltipElement=tobj||null;if(!tobj||SocialCalc.ButtonInfo.buttonDown)return;// if not an object with a tip or a \"button\" is down, ignore\n\ttooltipinfo.timer=window.setTimeout(SocialCalc.TooltipWaitDone,700);if(tooltipinfo.tooltipElement.element.addEventListener){// Register event for mouse down which cancels tooltip stuff\n\ttooltipinfo.tooltipElement.element.addEventListener(\"mousedown\",SocialCalc.TooltipMouseDown,false);}else if(tooltipinfo.tooltipElement.element.attachEvent){// IE\n\ttooltipinfo.tooltipElement.element.attachEvent(\"onmousedown\",SocialCalc.TooltipMouseDown);}return;};//\n\t// TooltipMouseDown(event)\n\t//\n\tSocialCalc.TooltipMouseDown=function(event){var e=event||window.event;var tooltipinfo=SocialCalc.TooltipInfo;if(tooltipinfo.timer){window.clearTimeout(tooltipinfo.timer);// cancel timer\n\ttooltipinfo.timer=null;}if(tooltipinfo.popupElement){// currently displaying a tip: hide it\n\tSocialCalc.TooltipHide();}if(tooltipinfo.tooltipElement){if(tooltipinfo.tooltipElement.element.removeEventListener){// DOM Level 2 -- Firefox, et al\n\ttooltipinfo.tooltipElement.element.removeEventListener(\"mousedown\",SocialCalc.TooltipMouseDown,false);}else if(tooltipinfo.tooltipElement.element.attachEvent){// IE 5+\n\ttooltipinfo.tooltipElement.element.detachEvent(\"onmousedown\",SocialCalc.TooltipMouseDown);}tooltipinfo.tooltipElement=null;}return;};//\n\t// TooltipDisplay(tobj)\n\t//\n\tSocialCalc.TooltipDisplay=function(tobj){var tooltipinfo=SocialCalc.TooltipInfo;var scc=SocialCalc.Constants;var offsetX=tobj.functionobj&&typeof tobj.functionobj.offsetx==\"number\"?tobj.functionobj.offsetx:tooltipinfo.offsetX;var offsetY=tobj.functionobj&&typeof tobj.functionobj.offsety==\"number\"?tobj.functionobj.offsety:tooltipinfo.offsetY;tooltipinfo.popupElement=document.createElement(\"div\");if(scc.TDpopupElementClass)tooltipinfo.popupElement.className=scc.TDpopupElementClass;SocialCalc.setStyles(tooltipinfo.popupElement,scc.TDpopupElementStyle);tooltipinfo.popupElement.innerHTML=tobj.tiptext;if(tooltipinfo.clientX>tooltipinfo.viewport.width/2){// on right side of screen\n\ttooltipinfo.popupElement.style.bottom=tooltipinfo.viewport.height-tooltipinfo.clientY+offsetY+\"px\";tooltipinfo.popupElement.style.right=tooltipinfo.viewport.width-tooltipinfo.clientX+offsetX+\"px\";}else{// on left side of screen\n\ttooltipinfo.popupElement.style.bottom=tooltipinfo.viewport.height-tooltipinfo.clientY+offsetY+\"px\";tooltipinfo.popupElement.style.left=tooltipinfo.clientX+offsetX+\"px\";}if(tooltipinfo.clientY<50){// make sure fits on screen if nothing above grid\n\ttooltipinfo.popupElement.style.bottom=tooltipinfo.viewport.height-tooltipinfo.clientY+offsetY-50+\"px\";}document.body.appendChild(tooltipinfo.popupElement);};//\n\t// TooltipHide()\n\t//\n\tSocialCalc.TooltipHide=function(){var tooltipinfo=SocialCalc.TooltipInfo;if(tooltipinfo.popupElement){tooltipinfo.popupElement.parentNode.removeChild(tooltipinfo.popupElement);tooltipinfo.popupElement=null;}};//\n\t// TooltipWaitDone()\n\t//\n\tSocialCalc.TooltipWaitDone=function(){var tooltipinfo=SocialCalc.TooltipInfo;tooltipinfo.timer=null;SocialCalc.TooltipDisplay(tooltipinfo.tooltipElement);};// *************************************\n\t//\n\t// Button functions:\n\t//\n\t// *************************************\n\tSocialCalc.ButtonInfo={// There is only one of these -- no \"new\" is done.\n\t// Only one button operation can be active at a time.\n\t// The registeredElements array is used to identify items.\n\t// One item for each clickable element, each an object with:\n\t//    .element, .normalstyle, .hoverstyle, .downstyle, .repeatinterval, .functionobj\n\t//\n\t// .functionobj is an object with optional function objects for:\n\t//    mouseover, mouseout, mousedown, repeatinterval, mouseup, disabled\n\tregisteredElements:[],// Items used during hover over an element, clicking, repeating, etc.\n\tbuttonElement:null,// item being processed, hover or down (.element is the actual element)\n\tdoingHover:false,// true if mouse is over one of our elements\n\tbuttonDown:false,// true if button down and buttonElement not null\n\ttimer:null,// timer object for repeating\n\t// Used while processing an event\n\thorizontalScroll:0,verticalScroll:0,clientX:0,clientY:0//\n\t// ButtonRegister(element, paramobj, functionobj) - make element clickable\n\t//\n\t// The arguments (other than element) may be null (meaning no change for style and no repeat)\n\t// The paramobj has the optional normalstyle, hoverstyle, downstyle, repeatwait, repeatinterval settings\n\t};SocialCalc.ButtonRegister=function(element,paramobj,functionobj){var buttoninfo=SocialCalc.ButtonInfo;if(!paramobj)paramobj={};buttoninfo.registeredElements.push({name:paramobj.name,element:element,normalstyle:paramobj.normalstyle,hoverstyle:paramobj.hoverstyle,downstyle:paramobj.downstyle,repeatwait:paramobj.repeatwait,repeatinterval:paramobj.repeatinterval,functionobj:functionobj});if(element.addEventListener){// DOM Level 2 -- Firefox, et al\n\telement.addEventListener(\"mousedown\",SocialCalc.ButtonMouseDown,false);element.addEventListener(\"mouseover\",SocialCalc.ButtonMouseOver,false);element.addEventListener(\"mouseout\",SocialCalc.ButtonMouseOut,false);}else if(element.attachEvent){// IE 5+\n\telement.attachEvent(\"onmousedown\",SocialCalc.ButtonMouseDown);element.attachEvent(\"onmouseover\",SocialCalc.ButtonMouseOver);element.attachEvent(\"onmouseout\",SocialCalc.ButtonMouseOut);}else{// don't handle this\n\tthrow SocialCalc.Constants.s_BrowserNotSupported;}return;};//\n\t// ButtonMouseOver(event)\n\t//\n\tSocialCalc.ButtonMouseOver=function(event){var e=event||window.event;var buttoninfo=SocialCalc.ButtonInfo;var bobj=SocialCalc.LookupElement(e.target||e.srcElement,buttoninfo.registeredElements);if(!bobj)return;if(buttoninfo.buttonDown){if(buttoninfo.buttonElement==bobj){buttoninfo.doingHover=true;// keep track whether we are on the pressed button or not\n\t}return;}if(buttoninfo.buttonElement&&buttoninfo.buttonElement!=bobj&&buttoninfo.doingHover){// moved to a new one, undo hover there\n\tSocialCalc.setStyles(buttoninfo.buttonElement.element,buttoninfo.buttonElement.normalstyle);}buttoninfo.buttonElement=bobj;// remember this one is hovering\n\tbuttoninfo.doingHover=true;SocialCalc.setStyles(bobj.element,bobj.hoverstyle);// set style (if provided)\n\tif(bobj&&bobj.functionobj&&bobj.functionobj.MouseOver)bobj.functionobj.MouseOver(e,buttoninfo,bobj);return;};//\n\t// ButtonMouseOut(event)\n\t//\n\tSocialCalc.ButtonMouseOut=function(event){var e=event||window.event;var buttoninfo=SocialCalc.ButtonInfo;if(buttoninfo.buttonDown){buttoninfo.doingHover=false;// keep track of overs and outs\n\treturn;}var bobj=SocialCalc.LookupElement(e.target||e.srcElement,buttoninfo.registeredElements);if(buttoninfo.doingHover){// if there was a hover, undo it\n\tif(buttoninfo.buttonElement)SocialCalc.setStyles(buttoninfo.buttonElement.element,buttoninfo.buttonElement.normalstyle);buttoninfo.buttonElement=null;buttoninfo.doingHover=false;}if(bobj&&bobj.functionobj&&bobj.functionobj.MouseOut)bobj.functionobj.MouseOut(e,buttoninfo,bobj);return;};//\n\t// ButtonMouseDown(event)\n\t//\n\tSocialCalc.ButtonMouseDown=function(event){var e=event||window.event;var buttoninfo=SocialCalc.ButtonInfo;var viewportinfo=SocialCalc.GetViewportInfo();var bobj=SocialCalc.LookupElement(e.target||e.srcElement,buttoninfo.registeredElements);if(!bobj)return;// not one of our elements\n\tif(bobj&&bobj.functionobj&&bobj.functionobj.Disabled){if(bobj.functionobj.Disabled(e,buttoninfo,bobj)){return;}}buttoninfo.buttonElement=bobj;buttoninfo.buttonDown=true;SocialCalc.setStyles(bobj.element,buttoninfo.buttonElement.downstyle);// Register event handler for mouse up\n\t// Event code from JavaScript, Flanagan, 5th Edition, pg. 422\n\tif(document.addEventListener){// DOM Level 2 -- Firefox, et al\n\tdocument.addEventListener(\"mouseup\",SocialCalc.ButtonMouseUp,true);// capture everywhere\n\t}else if(bobj.element.attachEvent){// IE 5+\n\tbobj.element.setCapture();bobj.element.attachEvent(\"onmouseup\",SocialCalc.ButtonMouseUp);bobj.element.attachEvent(\"onlosecapture\",SocialCalc.ButtonMouseUp);}if(e.stopPropagation)e.stopPropagation();// DOM Level 2\n\telse e.cancelBubble=true;// IE 5+\n\tif(e.preventDefault)e.preventDefault();// DOM Level 2\n\telse e.returnValue=false;// IE 5+\n\tbuttoninfo.horizontalScroll=viewportinfo.horizontalScroll;buttoninfo.verticalScroll=viewportinfo.verticalScroll;buttoninfo.clientX=e.clientX+buttoninfo.horizontalScroll;// get document-relative coordinates\n\tbuttoninfo.clientY=e.clientY+buttoninfo.verticalScroll;if(bobj&&bobj.functionobj&&bobj.functionobj.MouseDown)bobj.functionobj.MouseDown(e,buttoninfo,bobj);if(bobj.repeatwait){// if a repeat wait is set, then starting waiting for first repetition\n\tbuttoninfo.timer=window.setTimeout(SocialCalc.ButtonRepeat,bobj.repeatwait);}return;};//\n\t// ButtonMouseUp(event)\n\t//\n\tSocialCalc.ButtonMouseUp=function(event){var e=event||window.event;var buttoninfo=SocialCalc.ButtonInfo;var bobj=buttoninfo.buttonElement;if(buttoninfo.timer){// if repeating, cancel it\n\twindow.clearTimeout(buttoninfo.timer);// cancel timer\n\tbuttoninfo.timer=null;}if(!buttoninfo.buttonDown)return;// already did this (e.g., in IE, releaseCapture fires losecapture)\n\tif(e.stopPropagation)e.stopPropagation();// DOM Level 2\n\telse e.cancelBubble=true;// IE 5+\n\tif(e.preventDefault)e.preventDefault();// DOM Level 2\n\telse e.returnValue=false;// IE 5+\n\tif(document.removeEventListener){// DOM Level 2\n\tdocument.removeEventListener(\"mouseup\",SocialCalc.ButtonMouseUp,true);}else if(document.detachEvent){// IE\n\tbobj.element.detachEvent(\"onlosecapture\",SocialCalc.ButtonMouseUp);bobj.element.detachEvent(\"onmouseup\",SocialCalc.ButtonMouseUp);bobj.element.releaseCapture();}if(buttoninfo.buttonElement.downstyle){if(buttoninfo.doingHover)SocialCalc.setStyles(bobj.element,buttoninfo.buttonElement.hoverstyle);else SocialCalc.setStyles(bobj.element,buttoninfo.buttonElement.normalstyle);}buttoninfo.buttonDown=false;if(bobj&&bobj.functionobj&&bobj.functionobj.MouseUp)bobj.functionobj.MouseUp(e,buttoninfo,bobj);};//\n\t// ButtonRepeat()\n\t//\n\tSocialCalc.ButtonRepeat=function(){var buttoninfo=SocialCalc.ButtonInfo;var bobj=buttoninfo.buttonElement;if(!bobj)return;if(bobj&&bobj.functionobj&&bobj.functionobj.Repeat)bobj.functionobj.Repeat(null,buttoninfo,bobj);buttoninfo.timer=window.setTimeout(SocialCalc.ButtonRepeat,bobj.repeatinterval||100);};// *************************************\n\t//\n\t// MouseWheel functions:\n\t//\n\t// *************************************\n\tSocialCalc.MouseWheelInfo={// There is only one of these -- no \"new\" is done.\n\t// The mousewheel only affects the one area the mouse pointer is over\n\t// The registeredElements array is used to identify items.\n\t// One item for each element to respond to the mousewheel, each an object with:\n\t//    .element, .functionobj\n\tregisteredElements:[]//\n\t// MouseWheelRegister(element, functionobj) - make element respond to mousewheel\n\t//\n\t};SocialCalc.MouseWheelRegister=function(element,functionobj){var mousewheelinfo=SocialCalc.MouseWheelInfo;mousewheelinfo.registeredElements.push({element:element,functionobj:functionobj});if(element.addEventListener){// DOM Level 2 -- Firefox, et al\n\telement.addEventListener(\"DOMMouseScroll\",SocialCalc.ProcessMouseWheel,false);element.addEventListener(\"mousewheel\",SocialCalc.ProcessMouseWheel,false);// Opera needs this\n\t}else if(element.attachEvent){// IE 5+\n\telement.attachEvent(\"onmousewheel\",SocialCalc.ProcessMouseWheel);}else{// don't handle this\n\tthrow SocialCalc.Constants.s_BrowserNotSupported;}return;};SocialCalc.ProcessMouseWheel=function(e){var event=e||window.event;var delta;if(SocialCalc.Keyboard.passThru)return;// ignore\n\tvar mousewheelinfo=SocialCalc.MouseWheelInfo;var ele=event.target||event.srcElement;// source object is often within what we want\n\tvar wobj;for(wobj=null;!wobj&&ele;ele=ele.parentNode){// go up tree looking for one of our elements\n\twobj=SocialCalc.LookupElement(ele,mousewheelinfo.registeredElements);}if(!wobj)return;// not one of our elements\n\tif(event.wheelDelta){delta=event.wheelDelta/120;}else delta=-event.detail/3;if(!delta)delta=0;if(wobj.functionobj&&wobj.functionobj.WheelMove)wobj.functionobj.WheelMove(event,delta,mousewheelinfo,wobj);if(event.preventDefault)event.preventDefault();event.returnValue=false;};// *************************************\n\t//\n\t// Keyboard functions:\n\t//\n\t// For more information about keyboard handling, see: http://unixpapa.com/js/key.html\n\t//\n\t// *************************************\n\tSocialCalc.keyboardTables={specialKeysCommon:{8:\"[backspace]\",9:\"[tab]\",13:\"[enter]\",25:\"[tab]\",27:\"[esc]\",33:\"[pgup]\",34:\"[pgdn]\",35:\"[end]\",36:\"[home]\",37:\"[aleft]\",38:\"[aup]\",39:\"[aright]\",40:\"[adown]\",45:\"[ins]\",46:\"[del]\",113:\"[f2]\"},specialKeysIE:{8:\"[backspace]\",9:\"[tab]\",13:\"[enter]\",25:\"[tab]\",27:\"[esc]\",33:\"[pgup]\",34:\"[pgdn]\",35:\"[end]\",36:\"[home]\",37:\"[aleft]\",38:\"[aup]\",39:\"[aright]\",40:\"[adown]\",45:\"[ins]\",46:\"[del]\",113:\"[f2]\"},controlKeysIE:{67:\"[ctrl-c]\",83:\"[ctrl-s]\",86:\"[ctrl-v]\",88:\"[ctrl-x]\",90:\"[ctrl-z]\"},specialKeysOpera:{8:\"[backspace]\",9:\"[tab]\",13:\"[enter]\",25:\"[tab]\",27:\"[esc]\",33:\"[pgup]\",34:\"[pgdn]\",35:\"[end]\",36:\"[home]\",37:\"[aleft]\",38:\"[aup]\",39:\"[aright]\",40:\"[adown]\",45:\"[ins]\",// issues with releases before 9.5 - same as \"-\" (\"-\" changed in 9.5)\n\t46:\"[del]\",// issues with releases before 9.5 - same as \".\" (\".\" changed in 9.5)\n\t113:\"[f2]\"},controlKeysOpera:{67:\"[ctrl-c]\",83:\"[ctrl-s]\",86:\"[ctrl-v]\",88:\"[ctrl-x]\",90:\"[ctrl-z]\"},specialKeysSafari:{8:\"[backspace]\",9:\"[tab]\",13:\"[enter]\",25:\"[tab]\",27:\"[esc]\",63232:\"[aup]\",63233:\"[adown]\",63234:\"[aleft]\",63235:\"[aright]\",63272:\"[del]\",63273:\"[home]\",63275:\"[end]\",63276:\"[pgup]\",63277:\"[pgdn]\",63237:\"[f2]\"},controlKeysSafari:{99:\"[ctrl-c]\",115:\"[ctrl-s]\",118:\"[ctrl-v]\",120:\"[ctrl-x]\",122:\"[ctrl-z]\"},ignoreKeysSafari:{63236:\"[f1]\",63238:\"[f3]\",63239:\"[f4]\",63240:\"[f5]\",63241:\"[f6]\",63242:\"[f7]\",63243:\"[f8]\",63244:\"[f9]\",63245:\"[f10]\",63246:\"[f11]\",63247:\"[f12]\",63289:\"[numlock]\"},specialKeysFirefox:{8:\"[backspace]\",9:\"[tab]\",13:\"[enter]\",25:\"[tab]\",27:\"[esc]\",33:\"[pgup]\",34:\"[pgdn]\",35:\"[end]\",36:\"[home]\",37:\"[aleft]\",38:\"[aup]\",39:\"[aright]\",40:\"[adown]\",45:\"[ins]\",46:\"[del]\",113:\"[f2]\"},controlKeysFirefox:{99:\"[ctrl-c]\",115:\"[ctrl-s]\",118:\"[ctrl-v]\",120:\"[ctrl-x]\",122:\"[ctrl-z]\"},ignoreKeysFirefox:{16:\"[shift]\",17:\"[ctrl]\",18:\"[alt]\",20:\"[capslock]\",19:\"[pause]\",44:\"[printscreen]\",91:\"[windows]\",92:\"[windows]\",112:\"[f1]\",114:\"[f3]\",115:\"[f4]\",116:\"[f5]\",117:\"[f6]\",118:\"[f7]\",119:\"[f8]\",120:\"[f9]\",121:\"[f10]\",122:\"[f11]\",123:\"[f12]\",144:\"[numlock]\",145:\"[scrolllock]\",224:\"[cmd]\"}};SocialCalc.Keyboard={areListener:false,// if true, we have been installed as a listener for keyboard events\n\tfocusTable:null,// the table editor object that gets keystrokes or null\n\tpassThru:null,// if not null, control element with focus to pass keyboard events to (has blur method), or \"true\"\n\tdidProcessKey:false,// did SocialCalc.ProcessKey in keydown\n\tstatusFromProcessKey:false,// the status from the keydown SocialCalc.ProcessKey\n\trepeatingKeyPress:false,// some browsers (Opera, Gecko Mac) repeat special keys as KeyPress not KeyDown\n\tchForProcessKey:\"\"// remember so can do repeat in those cases\n\t};SocialCalc.KeyboardSetFocus=function(editor){SocialCalc.Keyboard.focusTable=editor;if(!SocialCalc.Keyboard.areListener){document.onkeydown=SocialCalc.ProcessKeyDown;document.onkeypress=SocialCalc.ProcessKeyPress;SocialCalc.Keyboard.areListener=true;}if(SocialCalc.Keyboard.passThru){if(SocialCalc.Keyboard.passThru.blur){SocialCalc.Keyboard.passThru.blur();}SocialCalc.Keyboard.passThru=null;}window.focus();};SocialCalc.KeyboardFocus=function(){SocialCalc.Keyboard.passThru=null;window.focus();};SocialCalc.ProcessKeyDown=function(e){var kt=SocialCalc.keyboardTables;kt.didProcessKey=false;// always start false\n\tkt.statusFromProcessKey=false;kt.repeatingKeyPress=false;var ch=\"\";var status=true;if(SocialCalc.Keyboard.passThru)return;// ignore\n\te=e||window.event;// IE and Safari 3.1+ won't fire keyPress, so check for special keys here.\n\tif(e.which==undefined||typeof e.keyIdentifier==\"string\"){ch=kt.specialKeysCommon[e.keyCode];if(!ch){if(e.ctrlKey){ch=kt.controlKeysIE[e.keyCode];}if(!ch)return true;}status=SocialCalc.ProcessKey(ch,e);if(!status){if(e.preventDefault)e.preventDefault();e.returnValue=false;}}else{ch=kt.specialKeysCommon[e.keyCode];if(!ch){//         return true;\n\tif(e.ctrlKey||e.metaKey){ch=kt.controlKeysIE[e.keyCode];// this works here\n\t}if(!ch)return true;}status=SocialCalc.ProcessKey(ch,e);// process the key\n\tkt.didProcessKey=true;// remember what happened\n\tkt.statusFromProcessKey=status;kt.chForProcessKey=ch;}return status;};SocialCalc.ProcessKeyPress=function(e){var kt=SocialCalc.keyboardTables;var ch=\"\";e=e||window.event;if(SocialCalc.Keyboard.passThru)return;// ignore\n\tif(kt.didProcessKey){// already processed this key\n\tif(kt.repeatingKeyPress){return SocialCalc.ProcessKey(kt.chForProcessKey,e);// process the same key as on KeyDown\n\t}else{kt.repeatingKeyPress=true;// see if get another KeyPress before KeyDown\n\treturn kt.statusFromProcessKey;// do what it said to do\n\t}}if(e.which==undefined){// IE\n\t// Note: Esc and Enter will come through here, too, if not stopped at KeyDown\n\tch=String.fromCharCode(e.keyCode);// convert to a character (special chars handled at ev1)\n\t}else{// not IE\n\tif(!e.which)return false;// ignore - special key\n\tif(e.charCode==undefined){// Opera\n\tif(e.which!=0){// character\n\tif(e.which<32||e.which==144){// special char (144 is numlock)\n\tch=kt.specialKeysOpera[e.which];if(ch){return true;}}else{if(e.ctrlKey){ch=kt.controlKeysOpera[e.keyCode];}else{ch=String.fromCharCode(e.which);}}}else{// special char\n\treturn true;}}else if(e.keyCode==0&&e.charCode==0){// OLPC Fn key or something\n\treturn;// ignore\n\t}else if(e.keyCode==e.charCode){// Safari\n\tch=kt.specialKeysSafari[e.keyCode];if(!ch){if(kt.ignoreKeysSafari[e.keyCode])// pass this through\n\treturn true;if(e.metaKey){ch=kt.controlKeysSafari[e.keyCode];}else{ch=String.fromCharCode(e.which);}}}else{// Firefox\n\tif(kt.specialKeysFirefox[e.keyCode]){return true;}ch=String.fromCharCode(e.which);if(e.ctrlKey||e.metaKey){ch=kt.controlKeysFirefox[e.which];}}}var status=SocialCalc.ProcessKey(ch,e);if(!status){if(e.preventDefault)e.preventDefault();e.returnValue=false;}return status;};/* \n\t*\n\t* OLD ProcessKeyDown and ProcessKeyPress -- replaced for handling newer browsers, including Safari 3.1 and Opera 9.5\n\t*\n\t\n\tSocialCalc.ProcessKeyDown = function(e) {\n\t\n\tvar kt = SocialCalc.keyboardTables;\n\t\n\tvar ch=\"\";\n\tvar status=true;\n\t\n\tif (SocialCalc.Keyboard.passThru) return; // ignore\n\t\n\te = e || window.event;\n\t\n\tif (e.which==undefined) { // IE\n\tch = kt.specialKeysIE[e.keyCode];\n\tif (!ch) {\n\tif (e.ctrlKey) {\n\tch=kt.controlKeysIE[e.keyCode];\n\t}\n\tif (!ch)\n\treturn true;\n\t}\n\t\n\tstatus = SocialCalc.ProcessKey(ch, e);\n\t\n\tif (!status) {\n\tif (e.preventDefault) e.preventDefault();\n\te.returnValue = false;\n\t}\n\t}\n\t\n\telse { // don't do anything for other browsers - wait for keyPress\n\t; // special key repeats are done as keypress in those browsers\n\t}\n\t\n\treturn status;\n\t\n\t}\n\t\n\tSocialCalc.ProcessKeyPress = function(e) {\n\t\n\tvar kt = SocialCalc.keyboardTables;\n\t\n\tvar ch=\"\";\n\t\n\tif (SocialCalc.Keyboard.passThru) return; // ignore\n\t\n\te = e || window.event;\n\t\n\tif (e.which==undefined) { // IE\n\t// Note: Esc and Enter will come through here, too, if not stopped at KeyDown\n\tch=String.fromCharCode(e.keyCode); // convert to a character (special chars handled at ev1)\n\t}\n\t\n\telse { // not IE\n\tif (e.charCode==undefined) { // Opera\n\tif (e.which!=0) { // character\n\tif (e.which<32) { // special char\n\tch = kt.specialKeysOpera[e.keyCode];\n\tif (!ch)\n\treturn true;\n\t}\n\telse {\n\tif (e.ctrlKey) {\n\tch=kt.controlKeysOpera[e.keyCode];\n\t}\n\telse {\n\tch = String.fromCharCode(e.which);\n\t}\n\t}\n\t}\n\telse { // special char\n\tch = kt.specialKeysOpera[e.keyCode];\n\tif (!ch)\n\treturn true;\n\t}\n\t}\n\t\n\telse if (e.keyCode==0 && e.charCode==0) { // OLPC Fn key or something\n\treturn; // ignore\n\t}\n\t\n\telse if (e.keyCode==e.charCode) { // Safari\n\tch = kt.specialKeysSafari[e.keyCode];\n\tif (!ch) {\n\tif (kt.ignoreKeysSafari[e.keyCode]) // pass this through\n\treturn true;\n\tif (e.metaKey) {\n\tch=kt.controlKeysSafari[e.keyCode];\n\t}\n\telse {\n\tch = String.fromCharCode(e.which);\n\t}\n\t}\n\t}\n\t\n\telse { // Firefox\n\tch = kt.specialKeysFirefox[e.keyCode];\n\tif (!ch) {\n\tif (kt.ignoreKeysFirefox[e.keyCode]) // pass this through\n\treturn true;\n\tif (e.which) { // normal char\n\tif (e.ctrlKey || e.metaKey) {\n\tch = kt.controlKeysFirefox[e.which];\n\t}\n\telse {\n\tch = String.fromCharCode(e.which);\n\t}\n\t}\n\telse { // usually a special char\n\treturn true; // old Firefox gives extra, empty keyPress for \"/\" - ignore\n\t}\n\t}\n\t}\n\t}\n\t\n\tvar status = SocialCalc.ProcessKey(ch, e);\n\t\n\tif (!status) {\n\tif (e.preventDefault) e.preventDefault();\n\te.returnValue = false;\n\t}\n\t\n\treturn status;\n\t\n\t}\n\t*///\n\t// status = SocialCalc.ProcessKey(ch, e)\n\t//\n\t// Take a key representation as a character string and dispatch to appropriate routine\n\t//\n\tSocialCalc.ProcessKey=function(ch,e){var ft=SocialCalc.Keyboard.focusTable;if(!ft)return true;// we're not handling it -- let browser do default\n\treturn ft.EditorProcessKey(ch,e);};// For Contact\n\tSocialCalc.EditorChangecontact=function(editor,text,name,phone,email,street,city,company,val){// alert('changecontact called');\n\t//var wval = editor.workingvalues;\n\tif(name!=\"\"){cmdline=\"set \"+name+\" \"+\"text t\"+\" \"+contactname;editor.EditorScheduleSheetCommands(cmdline,true,false);}cmdline=\"set \"+phone+\" \"+\"text t\"+\" \"+contactphoneNumber;editor.EditorScheduleSheetCommands(cmdline,true,false);if(email!=\"\"){cmdline=\"set \"+email+\" \"+\"text t\"+\" \"+contactemail;editor.EditorScheduleSheetCommands(cmdline,true,false);}cmdline=\"set \"+street+\" \"+\"text t\"+\" \"+contactStreet;editor.EditorScheduleSheetCommands(cmdline,true,false);cmdline=\"set \"+city+\" \"+\"text t\"+\" \"+contactcity;editor.EditorScheduleSheetCommands(cmdline,true,false);if(val==\"y\"){cmdline=\"set \"+company+\" \"+\"text t\"+\" \"+contactcompany;editor.EditorScheduleSheetCommands(cmdline,true,false);}return;};//changes by mini for font and color\n\tSocialCalc.EditorChangeSheetcolor=function(editor,text){var result,cell,valueinfo,fch,type,value,oldvalue,cmdline;var sheetobj=editor.context.sheetobj;var wval=editor.workingvalues;type=\"text t\";//value = typeof text == \"string\" ? text : editor.inputBox.GetText(); // either explicit or from input box\n\tvalue=text;oldvalue=SocialCalc.GetCellContents(sheetobj,wval.ecoord)+\"\";if(value==oldvalue){// no change\n\treturn;}fch=value.charAt(0);if(fch==\"=\"&&value.indexOf(\"\\n\")==-1){type=\"formula\";value=value.substring(1);}else if(fch==\"'\"){type=\"text t\";value=value.substring(1);}else if(value.length==0){type=\"empty\";}else{valueinfo=SocialCalc.DetermineValueType(value);if(valueinfo.type==\"n\"&&value==valueinfo.value+\"\"){// see if don't need \"constant\"\n\ttype=\"value n\";}else if(valueinfo.type.charAt(0)==\"t\"){type=\"text \"+valueinfo.type;}else if(valueinfo.type==\"\"){type=\"text t\";}else{type=\"constant \"+valueinfo.type+\" \"+valueinfo.value;}}if(type.charAt(0)==\"t\"){// text\n\tvalue=SocialCalc.encodeForSave(value);// newlines, :, and \\ are escaped\n\t}// if startsheet different from currentsheet, switch to start sheet\n\t// for the save to take effect\n\tif(SocialCalc.WorkBook&&wval.currentsheet!=wval.startsheet){var control=SocialCalc.GetCurrentWorkBookControl();var cmdstr=\"activatesheet \"+wval.startsheetid;control.ExecuteWorkBookControlCommand({cmdtype:\"wcmd\",id:\"0\",cmdstr:cmdstr},false);}//cmdline = \"set \"+wval.ecoord+\" \"+\"font\"+\" \"+value;\n\tcmdline=\"set \"+\"sheet\"+\" \"+\"defaultcolor\"+\" \"+value;//cmdline = \"set \"+\"sheet\"+\" \"+\"defaultcolor green\";\n\t//var control = SocialCalc.GetCurrentWorkBookControl();\n\t//alert('u reach sheet' + \" \"+control.workbook.sheetArr[\"sheet1\"].sheet);\n\t//cmdline = \"set \"+sheetobj+\" \"+\"font\"+\" \"+value;\n\t//cmdline=\"set \"+  control.workbook.sheetArr[\"sheet1\"].sheet+\" color blue\" ;\n\teditor.EditorScheduleSheetCommands(cmdline,true,false);return;};SocialCalc.EditorChangecolorFromWidget=function(editor,text){var result,cell,valueinfo,fch,type,value,oldvalue,cmdline;var sheetobj=editor.context.sheetobj;var wval=editor.workingvalues;if(!CoordForColorChange){alert(\"No active cell\");return;}// if startsheet different from currentsheet, switch to start sheet\n\t// for the save to take effect\n\tif(SocialCalc.WorkBook&&wval.currentsheet!=wval.startsheet){var control=SocialCalc.GetCurrentWorkBookControl();var cmdstr=\"activatesheet \"+wval.startsheetid;control.ExecuteWorkBookControlCommand({cmdtype:\"wcmd\",id:\"0\",cmdstr:cmdstr},false);}cmdline=\"set \"+CoordForColorChange+\" \"+\"color\"+\" \"+text;editor.EditorScheduleSheetCommands(cmdline,true,false);return;};SocialCalc.EditorChangefontFromWidget=function(editor,text){var result,cell,valueinfo,fch,type,value,oldvalue,cmdline;var sheetobj=editor.context.sheetobj;var wval=editor.workingvalues;if(!CoordForColorChange){alert(\"No active cell\");return;}//alert(CoordForColorChange);\n\t// if startsheet different from currentsheet, switch to start sheet\n\t// for the save to take effect\n\tif(SocialCalc.WorkBook&&wval.currentsheet!=wval.startsheet){var control=SocialCalc.GetCurrentWorkBookControl();var cmdstr=\"activatesheet \"+wval.startsheetid;control.ExecuteWorkBookControlCommand({cmdtype:\"wcmd\",id:\"0\",cmdstr:cmdstr},false);}//cmdline = \"set \"+CoordForColorChange+\" \"+\"font\"+\" \"+text;\n\t//editor.EditorScheduleSheetCommands(cmdline, true, false);\n\tvar value=text;if(value==\"a\"){cmdline=\"set \"+CoordForColorChange+\" font * 12px *\";editor.EditorScheduleSheetCommands(cmdline,true,false);}if(value==\"b\"){cmdline=\"set \"+CoordForColorChange+\" font * 14px *\";editor.EditorScheduleSheetCommands(cmdline,true,false);}if(value==\"c\"){cmdline=\"set \"+CoordForColorChange+\" font * 16px *\";editor.EditorScheduleSheetCommands(cmdline,true,false);}if(value==\"d\"){cmdline=\"set \"+CoordForColorChange+\" font * 18px *\";editor.EditorScheduleSheetCommands(cmdline,true,false);}return;};SocialCalc.EditorChangeSheetfont=function(editor,text){var result,cell,valueinfo,fch,type,value,oldvalue,cmdline;var sheetobj=editor.context.sheetobj;var wval=editor.workingvalues;type=\"text t\";//value = typeof text == \"string\" ? text : editor.inputBox.GetText(); // either explicit or from input box\n\tvalue=text;oldvalue=SocialCalc.GetCellContents(sheetobj,wval.ecoord)+\"\";if(value==oldvalue){// no change\n\treturn;}fch=value.charAt(0);if(fch==\"=\"&&value.indexOf(\"\\n\")==-1){type=\"formula\";value=value.substring(1);}else if(fch==\"'\"){type=\"text t\";value=value.substring(1);}else if(value.length==0){type=\"empty\";}else{valueinfo=SocialCalc.DetermineValueType(value);if(valueinfo.type==\"n\"&&value==valueinfo.value+\"\"){// see if don't need \"constant\"\n\ttype=\"value n\";}else if(valueinfo.type.charAt(0)==\"t\"){type=\"text \"+valueinfo.type;}else if(valueinfo.type==\"\"){type=\"text t\";}else{type=\"constant \"+valueinfo.type+\" \"+valueinfo.value;}}if(type.charAt(0)==\"t\"){// text\n\tvalue=SocialCalc.encodeForSave(value);// newlines, :, and \\ are escaped\n\t}// if startsheet different from currentsheet, switch to start sheet\n\t// for the save to take effect\n\tif(SocialCalc.WorkBook&&wval.currentsheet!=wval.startsheet){var control=SocialCalc.GetCurrentWorkBookControl();var cmdstr=\"activatesheet \"+wval.startsheetid;control.ExecuteWorkBookControlCommand({cmdtype:\"wcmd\",id:\"0\",cmdstr:cmdstr},false);}//cmdline = \"set \"+wval.ecoord+\" \"+\"font\"+\" \"+value;\n\t//cmdline = \"set \"+\"sheet\"+\" \"+\"defaultcolor\"+\" \"+ value;\n\t//cmdline = \"set \"+\"sheet\"+\" \"+\"defaultfont\"+\" * \"+value+\" *\";\n\t//cmdline = \"set sheet defaultfont normal normal \"+value +\" *\";\n\t//cmdline=\"set sheet defaultfont\";\n\t// alert(cmdline);\n\t//editor.EditorScheduleSheetCommands(cmdline, true, false);\n\tif(value==\"a\"){cmdline=\"set sheet defaultfont * 12px *\";editor.EditorScheduleSheetCommands(cmdline,true,false);}if(value==\"b\"){cmdline=\"set sheet defaultfont * 14px *\";editor.EditorScheduleSheetCommands(cmdline,true,false);}if(value==\"c\"){cmdline=\"set sheet defaultfont * 16px *\";editor.EditorScheduleSheetCommands(cmdline,true,false);}if(value==\"d\"){cmdline=\"set sheet defaultfont * 18px *\";editor.EditorScheduleSheetCommands(cmdline,true,false);}//cmdline = \"\"+\"set sheet defaultfont * 8pt *\";\n\t//cmdline = \"set \"+\"sheet\"+\" \"+\"defaultcolor green\";\n\t//var control = SocialCalc.GetCurrentWorkBookControl();\n\t//alert('u reach sheet' + \" \"+control.workbook.sheetArr[\"sheet1\"].sheet);\n\t//cmdline = \"set \"+sheetobj+\" \"+\"font\"+\" \"+value;\n\t//cmdline=\"set \"+  control.workbook.sheetArr[\"sheet1\"].sheet+\" color blue\" ;\n\treturn;};SocialCalc.EditorCut=function(editor,value){var result,cell,valueinfo,fch,type,value,oldvalue,cmdline;var sheetobj=editor.context.sheetobj;var wval=editor.workingvalues;if(SocialCalc.Callbacks&&SocialCalc.Callbacks.IsCellEditable){if(!SocialCalc.Callbacks.IsCellEditable(editor)){return true;}}if(value==\"a\"){cmdline=\"cut \"+editCoord+\" all\";}else if(value==\"b\"){cmdline=\"copy \"+editCoord+\" all\";}else if(value==\"c\"){cmdline=\"paste \"+editCoord+\" all\";}else if(value==\"d\"){cmdline=\"erase \"+editCoord+\" formulas\";}editor.EditorScheduleSheetCommands(cmdline,true,false);};SocialCalc.EditorClearSheet=function(editor,cell_to_clear){//alert(\"clear\");\n\tvar cmdline;var coord=cell_to_clear;cmdline=\"erase \"+coord+\" formulas\";//console.log(cmdline);\n\teditor.EditorScheduleSheetCommands(cmdline,true,false);};//\n\t/*\n\t// SocialCalc Number Formatting Library\n\t//\n\t// Part of the SocialCalc package.\n\t//\n\t// (c) Copyright 2008 Socialtext, Inc.\n\t// All Rights Reserved.\n\t//\n\t// The contents of this file are subject to the Artistic License 2.0; you may not\n\t// use this file except in compliance with the License. You may obtain a copy of \n\t// the License at http://socialcalc.org/licenses/al-20/.\n\t//\n\t// Some of the other files in the SocialCalc package are licensed under\n\t// different licenses. Please note the licenses of the modules you use.\n\t//\n\t// Code History:\n\t//\n\t// Initially coded by Dan Bricklin of Software Garden, Inc., for Socialtext, Inc.\n\t// Based in part on the SocialCalc 1.1.0 code written in Perl.\n\t// The SocialCalc 1.1.0 code was:\n\t//    Portions (c) Copyright 2005, 2006, 2007 Software Garden, Inc.\n\t//    All Rights Reserved.\n\t//    Portions (c) Copyright 2007 Socialtext, Inc.\n\t//    All Rights Reserved.\n\t// The Perl SocialCalc started as modifications to the wikiCalc(R) program, version 1.0.\n\t// wikiCalc 1.0 was written by Software Garden, Inc.\n\t// Unless otherwise specified, referring to \"SocialCalc\" in comments refers to this\n\t// JavaScript version of the code, not the SocialCalc Perl code.\n\t//\n\t*/var SocialCalc;if(!SocialCalc)SocialCalc={};// May be used with other SocialCalc libraries or standalone\n\tSocialCalc.FormatNumber={};SocialCalc.FormatNumber.format_definitions={};// Parsed formats are stored here globally\n\t// Most constants that are often customized for localization are in the SocialCalc.Constants module.\n\t// If you use this module standalone, provide at least the \"FormatNumber\" values.\n\t//\n\t// The following values may be customized externally for further localization of the format definitions themselves,\n\t// but that would make them incompatible with other uses and is discouraged.\n\t//\n\tSocialCalc.FormatNumber.separatorchar=\",\";SocialCalc.FormatNumber.decimalchar=\".\";SocialCalc.FormatNumber.daynames=[\"Sunday\",\"Monday\",\"Tuesday\",\"Wednesday\",\"Thursday\",\"Friday\",\"Saturday\"];SocialCalc.FormatNumber.daynames3=[\"Sun\",\"Mon\",\"Tue\",\"Wed\",\"Thu\",\"Fri\",\"Sat\"];SocialCalc.FormatNumber.monthnames3=[\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\"];SocialCalc.FormatNumber.monthnames=[\"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\"July\",\"August\",\"September\",\"October\",\"November\",\"December\"];SocialCalc.FormatNumber.allowedcolors={BLACK:\"#000000\",BLUE:\"#0000FF\",CYAN:\"#00FFFF\",GREEN:\"#00FF00\",MAGENTA:\"#FF00FF\",RED:\"#FF0000\",WHITE:\"#FFFFFF\",YELLOW:\"#FFFF00\"};SocialCalc.FormatNumber.alloweddates={H:\"h]\",M:\"m]\",MM:\"mm]\",S:\"s]\",SS:\"ss]\"};// Other constants\n\tSocialCalc.FormatNumber.commands={copy:1,color:2,integer_placeholder:3,fraction_placeholder:4,decimal:5,currency:6,general:7,separator:8,date:9,comparison:10,section:11,style:12};SocialCalc.FormatNumber.datevalues={julian_offset:2415019,seconds_in_a_day:24*60*60,seconds_in_an_hour:60*60};/* *******************\n\t\n\t result = SocialCalc.FormatNumber.formatNumberWithFormat = function(rawvalue, format_string, currency_char)\n\t\n\t************************* */SocialCalc.FormatNumber.formatNumberWithFormat=function(rawvalue,format_string,currency_char){var scc=SocialCalc.Constants;var scfn=SocialCalc.FormatNumber;var op,operandstr,fromend,cval,operandstrlc;var startval,estartval;var hrs,mins,secs,ehrs,emins,esecs,ampmstr,ymd;var minOK,mpos;var result=\"\";var thisformat;var section,gotcomparison,compop,compval,cpos,oppos;var sectioninfo;var i,decimalscale,scaledvalue,strvalue,strparts,integervalue,fractionvalue;var integerdigits2,integerpos,fractionpos,textcolor,textstyle,separatorchar,decimalchar;var value;// working copy to change sign, etc.\n\trawvalue=rawvalue-0;// make sure a number\n\tvalue=rawvalue;if(!isFinite(value))return\"NaN\";var negativevalue=value<0?1:0;// determine sign, etc.\n\tif(negativevalue)value=-value;var zerovalue=value==0?1:0;currency_char=currency_char||scc.FormatNumber_DefaultCurrency;scfn.parse_format_string(scfn.format_definitions,format_string);// make sure format is parsed\n\tthisformat=scfn.format_definitions[format_string];// Get format structure\n\tif(!thisformat)throw\"Format not parsed error!\";section=thisformat.sectioninfo.length-1;// get number of sections - 1\n\tif(thisformat.hascomparison){// has comparisons - determine which section\n\tsection=0;// set to which section we will use\n\tgotcomparison=0;// this section has no comparison\n\tfor(cpos=0;;cpos++){// scan for comparisons\n\top=thisformat.operators[cpos];operandstr=thisformat.operands[cpos];// get next operator and operand\n\tif(!op){// at end with no match\n\tif(gotcomparison){// if comparison but no match\n\tformat_string=\"General\";// use default of General\n\tscfn.parse_format_string(scfn.format_definitions,format_string);thisformat=scfn.format_definitions[format_string];section=0;}break;// if no comparision, matches on this section\n\t}if(op==scfn.commands.section){// end of section\n\tif(!gotcomparison){// no comparison, so it's a match\n\tbreak;}gotcomparison=0;section++;// check out next one\n\tcontinue;}if(op==scfn.commands.comparison){// found a comparison - do we meet it?\n\ti=operandstr.indexOf(\":\");compop=operandstr.substring(0,i);compval=operandstr.substring(i+1)-0;if(compop==\"<\"&&rawvalue<compval||compop==\"<=\"&&rawvalue<=compval||compop==\"=\"&&rawvalue==compval||compop==\"<>\"&&rawvalue!=compval||compop==\">=\"&&rawvalue>=compval||compop==\">\"&&rawvalue>compval){// a match\n\tbreak;}gotcomparison=1;}}}else if(section>0){// more than one section (separated by \";\")\n\tif(section==1){// two sections\n\tif(negativevalue){negativevalue=0;// sign will provided by section, not automatically\n\tsection=1;// use second section for negative values\n\t}else{section=0;// use first for all others\n\t}}else if(section==2){// three sections\n\tif(negativevalue){negativevalue=0;// sign will provided by section, not automatically\n\tsection=1;// use second section for negative values\n\t}else if(zerovalue){section=2;// use third section for zero values\n\t}else{section=0;// use first for positive\n\t}}}sectioninfo=thisformat.sectioninfo[section];// look at values for our section\n\tif(sectioninfo.commas>0){// scale by thousands\n\tfor(i=0;i<sectioninfo.commas;i++){value/=1000;}}if(sectioninfo.percent>0){// do percent scaling\n\tfor(i=0;i<sectioninfo.percent;i++){value*=100;}}decimalscale=1;// cut down to required number of decimal digits\n\tfor(i=0;i<sectioninfo.fractiondigits;i++){decimalscale*=10;}scaledvalue=Math.floor(value*decimalscale+0.5);scaledvalue=scaledvalue/decimalscale;if(typeof scaledvalue!=\"number\")return\"NaN\";if(!isFinite(scaledvalue))return\"NaN\";strvalue=scaledvalue+\"\";// convert to string (Number.toFixed doesn't do all we need)\n\t//   strvalue = value.toFixed(sectioninfo.fractiondigits); // cut down to required number of decimal digits\n\t// and convert to string\n\tif(scaledvalue==0&&(sectioninfo.fractiondigits||sectioninfo.integerdigits)){negativevalue=0;// no \"-0\" unless using multiple sections or General\n\t}if(strvalue.indexOf(\"e\")>=0){// converted to scientific notation\n\treturn rawvalue+\"\";// Just return plain converted raw value\n\t}strparts=strvalue.match(/^\\+{0,1}(\\d*)(?:\\.(\\d*)){0,1}$/);// get integer and fraction parts\n\tif(!strparts)return\"NaN\";// if not a number\n\tintegervalue=strparts[1];if(!integervalue||integervalue==\"0\")integervalue=\"\";fractionvalue=strparts[2];if(!fractionvalue)fractionvalue=\"\";if(sectioninfo.hasdate){// there are date placeholders\n\tif(rawvalue<0){// bad date\n\treturn\"??-???-??&nbsp;??:??:??\";}startval=(rawvalue-Math.floor(rawvalue))*scfn.datevalues.seconds_in_a_day;// get date/time parts\n\testartval=rawvalue*scfn.datevalues.seconds_in_a_day;// do elapsed time version, too\n\thrs=Math.floor(startval/scfn.datevalues.seconds_in_an_hour);ehrs=Math.floor(estartval/scfn.datevalues.seconds_in_an_hour);startval=startval-hrs*scfn.datevalues.seconds_in_an_hour;mins=Math.floor(startval/60);emins=Math.floor(estartval/60);secs=startval-mins*60;decimalscale=1;// round appropriately depending if there is ss.0\n\tfor(i=0;i<sectioninfo.fractiondigits;i++){decimalscale*=10;}secs=Math.floor(secs*decimalscale+0.5);secs=secs/decimalscale;esecs=Math.floor(estartval*decimalscale+0.5);esecs=esecs/decimalscale;if(secs>=60){// handle round up into next second, minute, etc.\n\tsecs=0;mins++;emins++;if(mins>=60){mins=0;hrs++;ehrs++;if(hrs>=24){hrs=0;rawvalue++;}}}fractionvalue=secs-Math.floor(secs)+\"\";// for \"hh:mm:ss.000\"\n\tfractionvalue=fractionvalue.substring(2);// skip \"0.\"\n\tymd=SocialCalc.FormatNumber.convert_date_julian_to_gregorian(Math.floor(rawvalue+scfn.datevalues.julian_offset));minOK=0;// says \"m\" can be minutes if true\n\tmspos=sectioninfo.sectionstart;// m scan position in ops\n\tfor(;;mspos++){// scan for \"m\" and \"mm\" to see if any minutes fields, and am/pm\n\top=thisformat.operators[mspos];operandstr=thisformat.operands[mspos];// get next operator and operand\n\tif(!op)break;// don't go past end\n\tif(op==scfn.commands.section)break;if(op==scfn.commands.date){if((operandstr.toLowerCase()==\"am/pm\"||operandstr.toLowerCase()==\"a/p\")&&!ampmstr){if(hrs>=12){hrs-=12;ampmstr=operandstr.toLowerCase()==\"a/p\"?scc.s_FormatNumber_pm1:scc.s_FormatNumber_pm;// \"P\" : \"PM\";\n\t}else{ampmstr=operandstr.toLowerCase()==\"a/p\"?scc.s_FormatNumber_am1:scc.s_FormatNumber_am;// \"A\" : \"AM\";\n\t}if(operandstr.indexOf(ampmstr)<0)ampmstr=ampmstr.toLowerCase();// have case match case in format\n\t}if(minOK&&(operandstr==\"m\"||operandstr==\"mm\")){thisformat.operands[mspos]+=\"in\";// turn into \"min\" or \"mmin\"\n\t}if(operandstr.charAt(0)==\"h\"){minOK=1;// m following h or hh or [h] is minutes not months\n\t}else{minOK=0;}}else if(op!=scfn.commands.copy){// copying chars can be between h and m\n\tminOK=0;}}minOK=0;for(--mspos;;mspos--){// scan other way for s after m\n\top=thisformat.operators[mspos];operandstr=thisformat.operands[mspos];// get next operator and operand\n\tif(!op)break;// don't go past end\n\tif(op==scfn.commands.section)break;if(op==scfn.commands.date){if(minOK&&(operandstr==\"m\"||operandstr==\"mm\")){thisformat.operands[mspos]+=\"in\";// turn into \"min\" or \"mmin\"\n\t}if(operandstr==\"ss\"){minOK=1;// m before ss is minutes not months\n\t}else{minOK=0;}}else if(op!=scfn.commands.copy){// copying chars can be between ss and m\n\tminOK=0;}}}integerdigits2=0;// init counters, etc.\n\tintegerpos=0;fractionpos=0;textcolor=\"\";textstyle=\"\";separatorchar=scc.FormatNumber_separatorchar;if(separatorchar.indexOf(\" \")>=0)separatorchar=separatorchar.replace(/ /g,\"&nbsp;\");decimalchar=scc.FormatNumber_decimalchar;if(decimalchar.indexOf(\" \")>=0)decimalchar=decimalchar.replace(/ /g,\"&nbsp;\");oppos=sectioninfo.sectionstart;while(op=thisformat.operators[oppos]){// execute format\n\toperandstr=thisformat.operands[oppos++];// get next operator and operand\n\tif(op==scfn.commands.copy){// put char in result\n\tresult+=operandstr;}else if(op==scfn.commands.color){// set color\n\ttextcolor=operandstr;}else if(op==scfn.commands.style){// set style\n\ttextstyle=operandstr;}else if(op==scfn.commands.integer_placeholder){// insert number part\n\tif(negativevalue){result+=\"-\";negativevalue=0;}integerdigits2++;if(integerdigits2==1){// first one\n\tif(integervalue.length>sectioninfo.integerdigits){// see if integer wider than field\n\tfor(;integerpos<integervalue.length-sectioninfo.integerdigits;integerpos++){result+=integervalue.charAt(integerpos);if(sectioninfo.thousandssep){// see if this is a separator position\n\tfromend=integervalue.length-integerpos-1;if(fromend>2&&fromend%3==0){result+=separatorchar;}}}}}if(integervalue.length<sectioninfo.integerdigits&&integerdigits2<=sectioninfo.integerdigits-integervalue.length){// field is wider than value\n\tif(operandstr==\"0\"||operandstr==\"?\"){// fill with appropriate characters\n\tresult+=operandstr==\"0\"?\"0\":\"&nbsp;\";if(sectioninfo.thousandssep){// see if this is a separator position\n\tfromend=sectioninfo.integerdigits-integerdigits2;if(fromend>2&&fromend%3==0){result+=separatorchar;}}}}else{// normal integer digit - add it\n\tresult+=integervalue.charAt(integerpos);if(sectioninfo.thousandssep){// see if this is a separator position\n\tfromend=integervalue.length-integerpos-1;if(fromend>2&&fromend%3==0){result+=separatorchar;}}integerpos++;}}else if(op==scfn.commands.fraction_placeholder){// add fraction part of number\n\tif(fractionpos>=fractionvalue.length){if(operandstr==\"0\"||operandstr==\"?\"){result+=operandstr==\"0\"?\"0\":\"&nbsp;\";}}else{result+=fractionvalue.charAt(fractionpos);}fractionpos++;}else if(op==scfn.commands.decimal){// decimal point\n\tif(negativevalue){result+=\"-\";negativevalue=0;}result+=decimalchar;}else if(op==scfn.commands.currency){// currency symbol\n\tif(negativevalue){result+=\"-\";negativevalue=0;}result+=operandstr;}else if(op==scfn.commands.general){// insert \"General\" conversion\n\t// *** Cut down number of significant digits to avoid floating point artifacts:\n\tif(value!=0){// only if non-zero\n\tvar factor=Math.floor(Math.LOG10E*Math.log(value));// get integer magnitude as a power of 10\n\tfactor=Math.pow(10,13-factor);// turn into scaling factor\n\tvalue=Math.floor(factor*value+0.5)/factor;// scale positive value, round, undo scaling\n\tif(!isFinite(value))return\"NaN\";}if(negativevalue){result+=\"-\";}strvalue=value+\"\";// convert original value to string\n\tif(strvalue.indexOf(\"e\")>=0){// converted to scientific notation\n\tresult+=strvalue;continue;}strparts=strvalue.match(/^\\+{0,1}(\\d*)(?:\\.(\\d*)){0,1}$/);// get integer and fraction parts\n\tintegervalue=strparts[1];if(!integervalue||integervalue==\"0\")integervalue=\"\";fractionvalue=strparts[2];if(!fractionvalue)fractionvalue=\"\";integerpos=0;fractionpos=0;if(integervalue.length){for(;integerpos<integervalue.length;integerpos++){result+=integervalue.charAt(integerpos);if(sectioninfo.thousandssep){// see if this is a separator position\n\tfromend=integervalue.length-integerpos-1;if(fromend>2&&fromend%3==0){result+=separatorchar;}}}}else{result+=\"0\";}if(fractionvalue.length){result+=decimalchar;for(;fractionpos<fractionvalue.length;fractionpos++){result+=fractionvalue.charAt(fractionpos);}}}else if(op==scfn.commands.date){// date placeholder\n\toperandstrlc=operandstr.toLowerCase();if(operandstrlc==\"y\"||operandstrlc==\"yy\"){result+=(ymd.year+\"\").substring(2);}else if(operandstrlc==\"yyyy\"){result+=ymd.year+\"\";}else if(operandstrlc==\"d\"){result+=ymd.day+\"\";}else if(operandstrlc==\"dd\"){cval=1000+ymd.day;result+=(cval+\"\").substr(2);}else if(operandstrlc==\"ddd\"){cval=Math.floor(rawvalue+6)%7;result+=scc.s_FormatNumber_daynames3[cval];}else if(operandstrlc==\"dddd\"){cval=Math.floor(rawvalue+6)%7;result+=scc.s_FormatNumber_daynames[cval];}else if(operandstrlc==\"m\"){result+=ymd.month+\"\";}else if(operandstrlc==\"mm\"){cval=1000+ymd.month;result+=(cval+\"\").substr(2);}else if(operandstrlc==\"mmm\"){result+=scc.s_FormatNumber_monthnames3[ymd.month-1];}else if(operandstrlc==\"mmmm\"){result+=scc.s_FormatNumber_monthnames[ymd.month-1];}else if(operandstrlc==\"mmmmm\"){result+=scc.s_FormatNumber_monthnames[ymd.month-1].charAt(0);}else if(operandstrlc==\"h\"){result+=hrs+\"\";}else if(operandstrlc==\"h]\"){result+=ehrs+\"\";}else if(operandstrlc==\"mmin\"){cval=1000+mins+\"\";result+=cval.substr(2);}else if(operandstrlc==\"mm]\"){if(emins<100){cval=1000+emins+\"\";result+=cval.substr(2);}else{result+=emins+\"\";}}else if(operandstrlc==\"min\"){result+=mins+\"\";}else if(operandstrlc==\"m]\"){result+=emins+\"\";}else if(operandstrlc==\"hh\"){cval=1000+hrs+\"\";result+=cval.substr(2);}else if(operandstrlc==\"s\"){cval=Math.floor(secs);result+=cval+\"\";}else if(operandstrlc==\"ss\"){cval=1000+Math.floor(secs)+\"\";result+=cval.substr(2);}else if(operandstrlc==\"am/pm\"||operandstrlc==\"a/p\"){result+=ampmstr;}else if(operandstrlc==\"ss]\"){if(esecs<100){cval=1000+Math.floor(esecs)+\"\";result+=cval.substr(2);}else{cval=Math.floor(esecs);result+=cval+\"\";}}}else if(op==scfn.commands.section){// end of section\n\tbreak;}else if(op==scfn.commands.comparison){// ignore\n\tcontinue;}else{result+=\"!! Parse error !!\";}}if(textcolor){result='<span style=\"color:'+textcolor+';\">'+result+'</span>';}if(textstyle){result='<span style=\"'+textstyle+';\">'+result+'</span>';}return result;};/* *******************\n\t\n\t SocialCalc.FormatNumber.parse_format_string(format_defs, format_string)\n\t\n\t Takes a format string (e.g., \"#,##0.00_);(#,##0.00)\") and fills in format_defs with the parsed info\n\t\n\t format_defs\n\t    [\"#,##0.0\"]->{} - elements in the hash are one hash for each format\n\t       .operators->[] - array of operators from parsing the format string (each a number)\n\t       .operands->[] - array of corresponding operators (each usually a string)\n\t       .sectioninfo->[] - one hash for each section of the format\n\t          .start\n\t          .integerdigits\n\t          .fractiondigits\n\t          .commas\n\t          .percent\n\t          .thousandssep\n\t          .hasdates\n\t       .hascomparison - true if any section has [<100], etc.\n\t\n\t************************* */SocialCalc.FormatNumber.parse_format_string=function(format_defs,format_string){var scfn=SocialCalc.FormatNumber;var thisformat,section,sectionfinfo;var integerpart=1;// start out in integer part\n\tvar lastwasinteger;// last char was an integer placeholder\n\tvar lastwasslash;// last char was a backslash - escaping following character\n\tvar lastwasasterisk;// repeat next char\n\tvar lastwasunderscore;// last char was _ which picks up following char for width\n\tvar inquote,quotestr;// processing a quoted string\n\tvar inbracket,bracketstr,bracketdata;// processing a bracketed string\n\tvar ingeneral,gpos;// checks for characters \"General\"\n\tvar ampmstr,part;// checks for characters \"A/P\" and \"AM/PM\"\n\tvar indate;// keeps track of date/time placeholders\n\tvar chpos;// character position being looked at\n\tvar ch;// character being looked at\n\tif(format_defs[format_string])return;// already defined - nothing to do\n\tthisformat={operators:[],operands:[],sectioninfo:[{}]};// create info structure for this format\n\tformat_defs[format_string]=thisformat;// add to other format definitions\n\tsection=0;// start with section 0\n\tsectioninfo=thisformat.sectioninfo[section];// get reference to info for current section\n\tsectioninfo.sectionstart=0;// position in operands that starts this section\n\tsectioninfo.integerdigits=0;// number of integer-part placeholders\n\tsectioninfo.fractiondigits=0;// fraction placeholders\n\tsectioninfo.commas=0;// commas encountered, to handle scaling\n\tsectioninfo.percent=0;// times to scale by 100\n\tfor(chpos=0;chpos<format_string.length;chpos++){// parse\n\tch=format_string.charAt(chpos);// get next char to examine\n\tif(inquote){if(ch=='\"'){inquote=0;thisformat.operators.push(scfn.commands.copy);thisformat.operands.push(quotestr);continue;}quotestr+=ch;continue;}if(inbracket){if(ch==']'){inbracket=0;bracketdata=SocialCalc.FormatNumber.parse_format_bracket(bracketstr);if(bracketdata.operator==scfn.commands.separator){sectioninfo.thousandssep=1;// explicit [,]\n\tcontinue;}if(bracketdata.operator==scfn.commands.date){sectioninfo.hasdate=1;}if(bracketdata.operator==scfn.commands.comparison){thisformat.hascomparison=1;}thisformat.operators.push(bracketdata.operator);thisformat.operands.push(bracketdata.operand);continue;}bracketstr+=ch;continue;}if(lastwasslash){thisformat.operators.push(scfn.commands.copy);thisformat.operands.push(ch);lastwasslash=false;continue;}if(lastwasasterisk){thisformat.operators.push(scfn.commands.copy);thisformat.operands.push(ch+ch+ch+ch+ch);// do 5 of them since no real tabs\n\tlastwasasterisk=false;continue;}if(lastwasunderscore){thisformat.operators.push(scfn.commands.copy);thisformat.operands.push(\"&nbsp;\");lastwasunderscore=false;continue;}if(ingeneral){if(\"general\".charAt(ingeneral)==ch.toLowerCase()){ingeneral++;if(ingeneral==7){thisformat.operators.push(scfn.commands.general);thisformat.operands.push(ch);ingeneral=0;}continue;}ingeneral=0;}if(indate){// last char was part of a date placeholder\n\tif(indate.charAt(0)==ch){// another of the same char\n\tindate+=ch;// accumulate it\n\tcontinue;}thisformat.operators.push(scfn.commands.date);// something else, save date info\n\tthisformat.operands.push(indate);sectioninfo.hasdate=1;indate=\"\";}if(ampmstr){ampmstr+=ch;part=ampmstr.toLowerCase();if(part!=\"am/pm\".substring(0,part.length)&&part!=\"a/p\".substring(0,part.length)){ampstr=\"\";}else if(part==\"am/pm\"||part==\"a/p\"){thisformat.operators.push(scfn.commands.date);thisformat.operands.push(ampmstr);ampmstr=\"\";}continue;}if(ch==\"#\"||ch==\"0\"||ch==\"?\"){// placeholder\n\tif(integerpart){sectioninfo.integerdigits++;if(sectioninfo.commas){// comma inside of integer placeholders\n\tsectioninfo.thousandssep=1;// any number is thousands separator\n\tsectioninfo.commas=0;// reset count of \"thousand\" factors\n\t}lastwasinteger=1;thisformat.operators.push(scfn.commands.integer_placeholder);thisformat.operands.push(ch);}else{sectioninfo.fractiondigits++;thisformat.operators.push(scfn.commands.fraction_placeholder);thisformat.operands.push(ch);}}else if(ch==\".\"){// decimal point\n\tlastwasinteger=0;thisformat.operators.push(scfn.commands.decimal);thisformat.operands.push(ch);integerpart=0;}else if(ch=='$'){// currency char\n\tlastwasinteger=0;thisformat.operators.push(scfn.commands.currency);thisformat.operands.push(ch);}else if(ch==\",\"){if(lastwasinteger){sectioninfo.commas++;}else{thisformat.operators.push(scfn.commands.copy);thisformat.operands.push(ch);}}else if(ch==\"%\"){lastwasinteger=0;sectioninfo.percent++;thisformat.operators.push(scfn.commands.copy);thisformat.operands.push(ch);}else if(ch=='\"'){lastwasinteger=0;inquote=1;quotestr=\"\";}else if(ch=='['){lastwasinteger=0;inbracket=1;bracketstr=\"\";}else if(ch=='\\\\'){lastwasslash=1;lastwasinteger=0;}else if(ch=='*'){lastwasasterisk=1;lastwasinteger=0;}else if(ch=='_'){lastwasunderscore=1;lastwasinteger=0;}else if(ch==\";\"){section++;// start next section\n\tthisformat.sectioninfo[section]={};// create a new section\n\tsectioninfo=thisformat.sectioninfo[section];// get reference to info for current section\n\tsectioninfo.sectionstart=1+thisformat.operators.length;// remember where it starts\n\tsectioninfo.integerdigits=0;// number of integer-part placeholders\n\tsectioninfo.fractiondigits=0;// fraction placeholders\n\tsectioninfo.commas=0;// commas encountered, to handle scaling\n\tsectioninfo.percent=0;// times to scale by 100\n\tintegerpart=1;// reset for new section\n\tlastwasinteger=0;thisformat.operators.push(scfn.commands.section);thisformat.operands.push(ch);}else if(ch.toLowerCase()==\"g\"){ingeneral=1;lastwasinteger=0;}else if(ch.toLowerCase()==\"a\"){ampmstr=ch;lastwasinteger=0;}else if(\"dmyhHs\".indexOf(ch)>=0){indate=ch;}else{lastwasinteger=0;thisformat.operators.push(scfn.commands.copy);thisformat.operands.push(ch);}}if(indate){// last char was part of unsaved date placeholder\n\tthisformat.operators.push(scfn.commands.date);thisformat.operands.push(indate);sectioninfo.hasdate=1;}return;};/* *******************\n\t\n\t bracketdata = SocialCalc.FormatNumber.parse_format_bracket(bracketstr)\n\t\n\t Takes a bracket contents (e.g., \"RED\", \">10\") and returns an operator and operand\n\t\n\t bracketdata->{}\n\t    .operator\n\t    .operand\n\t\n\t************************* */SocialCalc.FormatNumber.parse_format_bracket=function(bracketstr){var scfn=SocialCalc.FormatNumber;var scc=SocialCalc.Constants;var bracketdata={};var parts;if(bracketstr.charAt(0)=='$'){// currency\n\tbracketdata.operator=scfn.commands.currency;parts=bracketstr.match(/^\\$(.+?)(\\-.+?){0,1}$/);if(parts){bracketdata.operand=parts[1]||scc.FormatNumber_defaultCurrency||'$';}else{bracketdata.operand=bracketstr.substring(1)||scc.FormatNumber_defaultCurrency||'$';}}else if(bracketstr=='?$'){bracketdata.operator=scfn.commands.currency;bracketdata.operand='[?$]';}else if(scfn.allowedcolors[bracketstr.toUpperCase()]){bracketdata.operator=scfn.commands.color;bracketdata.operand=scfn.allowedcolors[bracketstr.toUpperCase()];}else if(parts=bracketstr.match(/^style=([^\"]*)$/)){// [style=...]\n\tbracketdata.operator=scfn.commands.style;bracketdata.operand=parts[1];}else if(bracketstr==\",\"){bracketdata.operator=scfn.commands.separator;bracketdata.operand=bracketstr;}else if(scfn.alloweddates[bracketstr.toUpperCase()]){bracketdata.operator=scfn.commands.date;bracketdata.operand=scfn.alloweddates[bracketstr.toUpperCase()];}else if(parts=bracketstr.match(/^[<>=]/)){// comparison operator\n\tparts=bracketstr.match(/^([<>=]+)(.+)$/);// split operator and value\n\tbracketdata.operator=scfn.commands.comparison;bracketdata.operand=parts[1]+\":\"+parts[2];}else{// unknown bracket\n\tbracketdata.operator=scfn.commands.copy;bracketdata.operand=\"[\"+bracketstr+\"]\";}return bracketdata;};/* *******************\n\t\n\t juliandate = SocialCalc.FormatNumber.convert_date_gregorian_to_julian(year, month, day)\n\t\n\t From: http://aa.usno.navy.mil/faq/docs/JD_Formula.html\n\t Uses: Fliegel, H. F. and van Flandern, T. C. (1968). Communications of the ACM, Vol. 11, No. 10 (October, 1968).\n\t Translated from the FORTRAN\n\t\n\t      I= YEAR\n\t      J= MONTH\n\t      K= DAY\n\tC\n\t      JD= K-32075+1461*(I+4800+(J-14)/12)/4+367*(J-2-(J-14)/12*12)\n\t     2    /12-3*((I+4900+(J-14)/12)/100)/4\n\t\n\t************************* */SocialCalc.FormatNumber.convert_date_gregorian_to_julian=function(year,month,day){var juliandate;juliandate=day-32075+SocialCalc.intFunc(1461*(year+4800+SocialCalc.intFunc((month-14)/12))/4);juliandate+=SocialCalc.intFunc(367*(month-2-SocialCalc.intFunc((month-14)/12)*12)/12);juliandate=juliandate-SocialCalc.intFunc(3*SocialCalc.intFunc((year+4900+SocialCalc.intFunc((month-14)/12))/100)/4);return juliandate;};/* *******************\n\t\n\t ymd = SocialCalc.FormatNumber.convert_date_julian_to_gregorian(juliandate)\n\t\n\t ymd->{}\n\t    .year\n\t    .month\n\t    .day\n\t\n\t From: http://aa.usno.navy.mil/faq/docs/JD_Formula.html\n\t Uses: Fliegel, H. F. and van Flandern, T. C. (1968). Communications of the ACM, Vol. 11, No. 10 (October, 1968).\n\t Translated from the FORTRAN\n\t\n\t************************* */SocialCalc.FormatNumber.convert_date_julian_to_gregorian=function(juliandate){var L,N,I,J,K;L=juliandate+68569;N=Math.floor(4*L/146097);L=L-Math.floor((146097*N+3)/4);I=Math.floor(4000*(L+1)/1461001);L=L-Math.floor(1461*I/4)+31;J=Math.floor(80*L/2447);K=L-Math.floor(2447*J/80);L=Math.floor(J/11);J=J+2-12*L;I=100*(N-49)+I+L;return{year:I,month:J,day:K};};SocialCalc.intFunc=function(n){if(n<0){return-Math.floor(-n);}else{return Math.floor(n);}};//\n\t/*\n\t// SocialCalc Spreadsheet Formula Library\n\t//\n\t// Part of the SocialCalc package\n\t//\n\t// (c) Copyright 2008 Socialtext, Inc.\n\t// All Rights Reserved.\n\t//\n\t// The contents of this file are subject to the Artistic License 2.0; you may not\n\t// use this file except in compliance with the License. You may obtain a copy of \n\t// the License at http://socialcalc.org/licenses/al-20/.\n\t//\n\t// Some of the other files in the SocialCalc package are licensed under\n\t// different licenses. Please note the licenses of the modules you use.\n\t//\n\t// Code History:\n\t//\n\t// Initially coded by Dan Bricklin of Software Garden, Inc., for Socialtext, Inc.\n\t// Based in part on the SocialCalc 1.1.0 code written in Perl.\n\t// The SocialCalc 1.1.0 code was:\n\t//    Portions (c) Copyright 2005, 2006, 2007 Software Garden, Inc.\n\t//    All Rights Reserved.\n\t//    Portions (c) Copyright 2007 Socialtext, Inc.\n\t//    All Rights Reserved.\n\t// The Perl SocialCalc started as modifications to the wikiCalc(R) program, version 1.0.\n\t// wikiCalc 1.0 was written by Software Garden, Inc.\n\t// Unless otherwise specified, referring to \"SocialCalc\" in comments refers to this\n\t// JavaScript version of the code, not the SocialCalc Perl code.\n\t//\n\t*/var SocialCalc;if(!SocialCalc)SocialCalc={};// May be used with other SocialCalc libraries or standalone\n\t// In any case, requires SocialCalc.Constants.\n\tSocialCalc.Formula={};//\n\t// Formula constants for parsing:\n\t//\n\tSocialCalc.Formula.ParseState={num:1,alpha:2,coord:3,string:4,stringquote:5,numexp1:6,numexp2:7,alphanumeric:8,specialvalue:9};SocialCalc.Formula.TokenType={num:1,coord:2,op:3,name:4,error:5,string:6,space:7};SocialCalc.Formula.CharClass={num:1,numstart:2,op:3,eof:4,alpha:5,incoord:6,error:7,quote:8,space:9,specialstart:10};SocialCalc.Formula.CharClassTable={\" \":9,\"!\":3,'\"':8,\"#\":10,\"$\":6,\"%\":3,\"&\":3,\"(\":3,\")\":3,\"*\":3,\"+\":3,\",\":3,\"-\":3,\".\":2,\"/\":3,\"0\":1,\"1\":1,\"2\":1,\"3\":1,\"4\":1,\"5\":1,\"6\":1,\"7\":1,\"8\":1,\"9\":1,\":\":3,\"<\":3,\"=\":3,\">\":3,\"A\":5,\"B\":5,\"C\":5,\"D\":5,\"E\":5,\"F\":5,\"G\":5,\"H\":5,\"I\":5,\"J\":5,\"K\":5,\"L\":5,\"M\":5,\"N\":5,\"O\":5,\"P\":5,\"Q\":5,\"R\":5,\"S\":5,\"T\":5,\"U\":5,\"V\":5,\"W\":5,\"X\":5,\"Y\":5,\"Z\":5,\"^\":3,\"_\":5,\"a\":5,\"b\":5,\"c\":5,\"d\":5,\"e\":5,\"f\":5,\"g\":5,\"h\":5,\"i\":5,\"j\":5,\"k\":5,\"l\":5,\"m\":5,\"n\":5,\"o\":5,\"p\":5,\"q\":5,\"r\":5,\"s\":5,\"t\":5,\"u\":5,\"v\":5,\"w\":5,\"x\":5,\"y\":5,\"z\":5};SocialCalc.Formula.UpperCaseTable={\"a\":\"A\",\"b\":\"B\",\"c\":\"C\",\"d\":\"D\",\"e\":\"E\",\"f\":\"F\",\"g\":\"G\",\"h\":\"H\",\"i\":\"I\",\"j\":\"J\",\"k\":\"K\",\"l\":\"L\",\"m\":\"M\",\"n\":\"N\",\"o\":\"O\",\"p\":\"P\",\"q\":\"Q\",\"r\":\"R\",\"s\":\"S\",\"t\":\"T\",\"u\":\"U\",\"v\":\"V\",\"w\":\"W\",\"x\":\"X\",\"y\":\"Y\",\"z\":\"Z\"};SocialCalc.Formula.SpecialConstants={// names that turn into constants for name lookup\n\t\"#NULL!\":\"0,e#NULL!\",\"#NUM!\":\"0,e#NUM!\",\"#DIV/0!\":\"0,e#DIV/0!\",\"#VALUE!\":\"0,e#VALUE!\",\"#REF!\":\"0,e#REF!\",\"#NAME?\":\"0,e#NAME?\"};// Operator Precedence table\n\t//\n\t// 1- !, 2- : ,, 3- M P, 4- %, 5- ^, 6- * /, 7- + -, 8- &, 9- < > = G(>=) L(<=) N(<>),\n\t// Negative value means Right Associative\n\tSocialCalc.Formula.TokenPrecedence={\"!\":1,\":\":2,\",\":2,\"M\":-3,\"P\":-3,\"%\":4,\"^\":5,\"*\":6,\"/\":6,\"+\":7,\"-\":7,\"&\":8,\"<\":9,\">\":9,\"G\":9,\"L\":9,\"N\":9};// Convert one-char token text to input text:\n\tSocialCalc.Formula.TokenOpExpansion={'G':'>=','L':'<=','M':'-','N':'<>','P':'+'};//\n\t// Information about the resulting value types when doing operations on values (used by LookupResultType)\n\t//\n\t// Each object entry is an object with specific types with result type info as follows:\n\t//\n\t//    'type1a': '|type2a:resulta|type2b:resultb|...\n\t//    Type of t* or n* matches any of those types not listed\n\t//    Results may be a type or the numbers 1 or 2 specifying to return type1 or type2\n\tSocialCalc.Formula.TypeLookupTable={unaryminus:{'n*':'|n*:1|','e*':'|e*:1|','t*':'|t*:e#VALUE!|','b':'|b:n|'},unaryplus:{'n*':'|n*:1|','e*':'|e*:1|','t*':'|t*:e#VALUE!|','b':'|b:n|'},unarypercent:{'n*':'|n:n%|n*:n|','e*':'|e*:1|','t*':'|t*:e#VALUE!|','b':'|b:n|'},plus:{'n%':'|n%:n%|nd:n|nt:n|ndt:n|n$:n|n:n|n*:n|b:n|e*:2|t*:e#VALUE!|','nd':'|n%:n|nd:nd|nt:ndt|ndt:ndt|n$:n|n:nd|n*:n|b:n|e*:2|t*:e#VALUE!|','nt':'|n%:n|nd:ndt|nt:nt|ndt:ndt|n$:n|n:nt|n*:n|b:n|e*:2|t*:e#VALUE!|','ndt':'|n%:n|nd:ndt|nt:ndt|ndt:ndt|n$:n|n:ndt|n*:n|b:n|e*:2|t*:e#VALUE!|','n$':'|n%:n|nd:n|nt:n|ndt:n|n$:n$|n:n$|n*:n|b:n|e*:2|t*:e#VALUE!|','nl':'|n%:n|nd:n|nt:n|ndt:n|n$:n|n:n|n*:n|b:n|e*:2|t*:e#VALUE!|','n':'|n%:n|nd:nd|nt:nt|ndt:ndt|n$:n$|n:n|n*:n|b:n|e*:2|t*:e#VALUE!|','b':'|n%:n%|nd:nd|nt:nt|ndt:ndt|n$:n$|n:n|n*:n|b:n|e*:2|t*:e#VALUE!|','t*':'|n*:e#VALUE!|t*:e#VALUE!|b:e#VALUE!|e*:2|','e*':'|e*:1|n*:1|t*:1|b:1|'},concat:{'t':'|t:t|th:th|tw:tw|tl:t|t*:2|e*:2|','th':'|t:th|th:th|tw:t|tl:th|t*:t|e*:2|','tw':'|t:tw|th:t|tw:tw|tl:tw|t*:t|e*:2|','tl':'|t:tl|th:th|tw:tw|tl:tl|t*:t|e*:2|','e*':'|e*:1|n*:1|t*:1|'},oneargnumeric:{'n*':'|n*:n|','e*':'|e*:1|','t*':'|t*:e#VALUE!|','b':'|b:n|'},twoargnumeric:{'n*':'|n*:n|t*:e#VALUE!|e*:2|','e*':'|e*:1|n*:1|t*:1|','t*':'|t*:e#VALUE!|n*:e#VALUE!|e*:2|'},propagateerror:{'n*':'|n*:2|e*:2|','e*':'|e*:2|','t*':'|t*:2|e*:2|','b':'|b:2|e*:2|'}};/* *******************\n\t\n\t parseinfo = SocialCalc.Formula.ParseFormulaIntoTokens(line)\n\t\n\t Parses a text string as if it was a spreadsheet formula\n\t\n\t This uses a simple state machine run on each character in turn.\n\t States remember whether a number is being gathered, etc.\n\t The result is parseinfo which is an array with one entry for each token:\n\t   parseinfo[i] = {\n\t     text: \"the characters making up the parsed token\",\n\t     type: the type of the token (a number),\n\t     opcode: a single character version of an operator suitable for use in the\n\t                  precedence table and distinguishing between unary and binary + and -.\n\t\n\t************************* */SocialCalc.Formula.ParseFormulaIntoTokens=function(line){var i,ch,chclass,haddecimal,last_token,last_token_type,last_token_text,t;var scf=SocialCalc.Formula;var scc=SocialCalc.Constants;var parsestate=scf.ParseState;var tokentype=scf.TokenType;var charclass=scf.CharClass;var charclasstable=scf.CharClassTable;var uppercasetable=scf.UpperCaseTable;// much faster than toUpperCase function\n\tvar pushtoken=scf.ParsePushToken;var coordregex=/^\\$?[A-Z]{1,2}\\$?[1-9]\\d*$/i;var parseinfo=[];var str=\"\";var state=0;var haddecimal=false;for(i=0;i<=line.length;i++){if(i<line.length){ch=line.charAt(i);cclass=charclasstable[ch];}else{ch=\"\";cclass=charclass.eof;}if(state==parsestate.num){if(cclass==charclass.num){str+=ch;}else if(cclass==charclass.numstart&&!haddecimal){haddecimal=true;str+=ch;}else if(ch==\"E\"||ch==\"e\"){str+=ch;haddecimal=false;state=parsestate.numexp1;}else{// end of number - save it\n\tpushtoken(parseinfo,str,tokentype.num,0);haddecimal=false;state=0;}}if(state==parsestate.numexp1){if(cclass==parsestate.num){state=parsestate.numexp2;}else if((ch=='+'||ch=='-')&&uppercasetable[str.charAt(str.length-1)]=='E'){str+=ch;}else if(ch=='E'||ch=='e'){;}else{pushtoken(parseinfo,scc.s_parseerrexponent,tokentype.error,0);state=0;}}if(state==parsestate.numexp2){if(cclass==charclass.num){str+=ch;}else{// end of number - save it\n\tpushtoken(parseinfo,str,tokentype.num,0);state=0;}}if(state==parsestate.alpha){if(cclass==charclass.num){state=parsestate.coord;}else if(cclass==charclass.alpha||ch==\".\"){// alpha may be letters, numbers, \"_\", or \".\"\n\tstr+=ch;}else if(cclass==charclass.incoord){state=parsestate.coord;}else if(cclass==charclass.op||cclass==charclass.numstart||cclass==charclass.space||cclass==charclass.eof){pushtoken(parseinfo,str.toUpperCase(),tokentype.name,0);state=0;}else{pushtoken(parseinfo,scc.s_parseerrchar,tokentype.error,0);state=0;}}if(state==parsestate.coord){if(cclass==charclass.num){str+=ch;}else if(cclass==charclass.incoord){str+=ch;}else if(cclass==charclass.alpha){state=parsestate.alphanumeric;}else if(cclass==charclass.op||cclass==charclass.numstart||cclass==charclass.eof||cclass==charclass.space){if(coordregex.test(str)){t=tokentype.coord;}else{t=tokentype.name;}pushtoken(parseinfo,str.toUpperCase(),t,0);state=0;}else{pushtoken(parseinfo,scc.s_parseerrchar,tokentype.error,0);state=0;}}if(state==parsestate.alphanumeric){if(cclass==charclass.num||cclass==charclass.alpha){str+=ch;}else if(cclass==charclass.op||cclass==charclass.numstart||cclass==charclass.space||cclass==charclass.eof){pushtoken(parseinfo,str.toUpperCase(),tokentype.name,0);state=0;}else{pushtoken(parseinfo,scc.s_parseerrchar,tokentype.error,0);state=0;}}if(state==parsestate.string){if(cclass==charclass.quote){state=parsestate.stringquote;// got quote in string: is it doubled (quote in string) or by itself (end of string)?\n\t}else if(cclass==charclass.eof){pushtoken(parseinfo,scc.s_parseerrstring,tokentype.error,0);state=0;}else{str+=ch;}}else if(state==parsestate.stringquote){// note else if here\n\tif(cclass==charclass.quote){str+='\"';state=parsestate.string;// double quote: add one then continue getting string\n\t}else{// something else -- end of string\n\tpushtoken(parseinfo,str,tokentype.string,0);state=0;// drop through to process\n\t}}else if(state==parsestate.specialvalue){// special values like #REF!\n\tif(str.charAt(str.length-1)==\"!\"){// done - save value as a name\n\tpushtoken(parseinfo,str,tokentype.name,0);state=0;// drop through to process\n\t}else if(cclass==charclass.eof){pushtoken(parseinfo,scc.s_parseerrspecialvalue,tokentype.error,0);state=0;}else{str+=ch;}}if(state==0){if(cclass==charclass.num){str=ch;state=parsestate.num;}else if(cclass==charclass.numstart){str=ch;haddecimal=true;state=parsestate.num;}else if(cclass==charclass.alpha||cclass==charclass.incoord){str=ch;state=parsestate.alpha;}else if(cclass==charclass.specialstart){str=ch;state=parsestate.specialvalue;}else if(cclass==charclass.op){str=ch;if(parseinfo.length>0){last_token=parseinfo[parseinfo.length-1];last_token_type=last_token.type;last_token_text=last_token.text;if(last_token_type==charclass.op){if(last_token_text=='<'||last_token_text==\">\"){str=last_token_text+str;parseinfo.pop();if(parseinfo.length>0){last_token=parseinfo[parseinfo.length-1];last_token_type=last_token.type;last_token_text=last_token.text;}else{last_token_type=charclass.eof;last_token_text=\"EOF\";}}}}else{last_token_type=charclass.eof;last_token_text=\"EOF\";}t=tokentype.op;if(parseinfo.length==0||last_token_type==charclass.op&&last_token_text!=')'&&last_token_text!='%'){// Unary operator\n\tif(str=='-'){// M is unary minus\n\tstr=\"M\";ch=\"M\";}else if(str=='+'){// P is unary plus\n\tstr=\"P\";ch=\"P\";}else if(str==')'&&last_token_text=='('){// null arg list OK\n\t;}else if(str!='('){// binary-op open-paren OK, others no\n\tt=tokentype.error;str=scc.s_parseerrtwoops;}}else if(str.length>1){if(str=='>='){// G is >=\n\tstr=\"G\";ch=\"G\";}else if(str=='<='){// L is <=\n\tstr=\"L\";ch=\"L\";}else if(str=='<>'){// N is <>\n\tstr=\"N\";ch=\"N\";}else{t=tokentype.error;str=scc.s_parseerrtwoops;}}pushtoken(parseinfo,str,t,ch);state=0;}else if(cclass==charclass.quote){// starting a string\n\tstr=\"\";state=parsestate.string;}else if(cclass==charclass.space){// store so can reconstruct spacing\n\tpushtoken(parseinfo,\" \",tokentype.space,0);}else if(cclass==charclass.eof){// ignore -- needed to have extra loop to close out other things\n\t}else{// unknown class - such as unknown char\n\tpushtoken(parseinfo,scc.s_parseerrchar,tokentype.error,0);}}}return parseinfo;};SocialCalc.Formula.ParsePushToken=function(parseinfo,ttext,ttype,topcode){parseinfo.push({text:ttext,type:ttype,opcode:topcode});};/* *******************\n\t\n\t result = SocialCalc.Formula.evaluate_parsed_formula(parseinfo, sheet, allowrangereturn)\n\t\n\t Does the calculation expressed in a parsed formula, returning a value, its type, and error info\n\t returns: {value: value, type: valuetype, error: errortext}.\n\t\n\t If allowrangereturn is present and true, can return a range (e.g., \"A1:A10\" - translated from \"A1|A10|\")\n\t\n\t************************* */SocialCalc.Formula.evaluate_parsed_formula=function(parseinfo,sheet,allowrangereturn){var result;var scf=SocialCalc.Formula;var tokentype=scf.TokenType;var revpolish;var parsestack=[];var errortext=\"\";revpolish=scf.ConvertInfixToPolish(parseinfo);// result is either an array or a string with error text\n\tresult=scf.EvaluatePolish(parseinfo,revpolish,sheet,allowrangereturn);return result;};//\n\t// revpolish = SocialCalc.Formula.ConvertInfixToPolish(parseinfo)\n\t//\n\t// Convert infix to reverse polish notation\n\t//\n\t// Returns revpolish array with a sequence of references to tokens by number if successful.\n\t// Errors return a string with the error.\n\t//\n\t// Based upon the algorithm shown in Wikipedia \"Reverse Polish notation\" article\n\t// and then enhanced for additional spreadsheet things\n\t//\n\tSocialCalc.Formula.ConvertInfixToPolish=function(parseinfo){var scf=SocialCalc.Formula;var scc=SocialCalc.Constants;var tokentype=scf.TokenType;var token_precedence=scf.TokenPrecedence;var revpolish=[];var parsestack=[];var errortext=\"\";var function_start=-1;var i,pii,ttype,ttext,tprecedence,tstackprecedence;for(i=0;i<parseinfo.length;i++){pii=parseinfo[i];ttype=pii.type;ttext=pii.text;if(ttype==tokentype.num||ttype==tokentype.coord||ttype==tokentype.string){revpolish.push(i);}else if(ttype==tokentype.name){parsestack.push(i);revpolish.push(function_start);}else if(ttype==tokentype.space){// ignore\n\tcontinue;}else if(ttext==','){while(parsestack.length&&parseinfo[parsestack[parsestack.length-1]].text!=\"(\"){revpolish.push(parsestack.pop());}if(parsestack.length==0){// no ( -- error\n\terrortext=scc.s_parseerrmissingopenparen;break;}}else if(ttext=='('){parsestack.push(i);}else if(ttext==')'){while(parsestack.length&&parseinfo[parsestack[parsestack.length-1]].text!=\"(\"){revpolish.push(parsestack.pop());}if(parsestack.length==0){// no ( -- error\n\terrortext=scc.s_parseerrcloseparennoopen;break;}parsestack.pop();if(parsestack.length&&parseinfo[parsestack[parsestack.length-1]].type==tokentype.name){revpolish.push(parsestack.pop());}}else if(ttype==tokentype.op){if(parsestack.length&&parseinfo[parsestack[parsestack.length-1]].type==tokentype.name){revpolish.push(parsestack.pop());}while(parsestack.length&&parseinfo[parsestack[parsestack.length-1]].type==tokentype.op&&parseinfo[parsestack[parsestack.length-1]].text!='('){tprecedence=token_precedence[pii.opcode];tstackprecedence=token_precedence[parseinfo[parsestack[parsestack.length-1]].opcode];if(tprecedence>=0&&tprecedence<tstackprecedence){break;}else if(tprecedence<0){tprecedence=-tprecedence;if(tstackprecedence<0)tstackprecedence=-tstackprecedence;if(tprecedence<=tstackprecedence){break;}}revpolish.push(parsestack.pop());}parsestack.push(i);}else if(ttype==tokentype.error){errortext=ttext;break;}else{errortext=\"Internal error while processing parsed formula. \";break;}}while(parsestack.length>0){if(parseinfo[parsestack[parsestack.length-1]].text=='('){errortext=scc.s_parseerrmissingcloseparen;break;}revpolish.push(parsestack.pop());}if(errortext){return errortext;}return revpolish;};//\n\t// result = SocialCalc.Formula.EvaluatePolish(parseinfo, revpolish, sheet, allowrangereturn)\n\t//\n\t// Execute reverse polish representation of formula\n\t//\n\t// Operand values are objects in the operand array with a \"type\" and an optional \"value\".\n\t// Type can have these values (many are type and sub-type as two or more letters):\n\t//    \"tw\", \"th\", \"t\", \"n\", \"nt\", \"coord\", \"range\", \"start\", \"eErrorType\", \"b\" (blank)\n\t// The value of a coord is in the form A57 or A57!sheetname\n\t// The value of a range is coord|coord|number where number starts at 0 and is\n\t// the offset of the next item to fetch if you are going through the range one by one\n\t// The number starts as a null string (\"A1|B3|\")\n\t//\n\tSocialCalc.Formula.EvaluatePolish=function(parseinfo,revpolish,sheet,allowrangereturn){var scf=SocialCalc.Formula;var scc=SocialCalc.Constants;var tokentype=scf.TokenType;var lookup_result_type=scf.LookupResultType;var typelookup=scf.TypeLookupTable;var operand_as_number=scf.OperandAsNumber;var operand_as_text=scf.OperandAsText;var operand_value_and_type=scf.OperandValueAndType;var operands_as_coord_on_sheet=scf.OperandsAsCoordOnSheet;var format_number_for_display=SocialCalc.format_number_for_display||function(v,t,f){return v+\"\";};var errortext=\"\";var function_start=-1;var missingOperandError={value:\"\",type:\"e#VALUE!\",error:scc.s_parseerrmissingoperand};var operand=[];var PushOperand=function PushOperand(t,v){operand.push({type:t,value:v});};var i,rii,prii,ttype,ttext,value1,value2,tostype,tostype2,resulttype,valuetype,cond,vmatch,smatch;if(!parseinfo.length||!(revpolish instanceof Array)){return{value:\"\",type:\"e#VALUE!\",error:typeof revpolish==\"string\"?revpolish:\"\"};}for(i=0;i<revpolish.length;i++){rii=revpolish[i];if(rii==function_start){// Remember the start of a function argument list\n\tPushOperand(\"start\",0);continue;}prii=parseinfo[rii];ttype=prii.type;ttext=prii.text;if(ttype==tokentype.num){PushOperand(\"n\",ttext-0);}else if(ttype==tokentype.coord){PushOperand(\"coord\",ttext);}else if(ttype==tokentype.string){PushOperand(\"t\",ttext);}else if(ttype==tokentype.op){if(operand.length<=0){// Nothing on the stack...\n\treturn missingOperandError;break;// done\n\t}// Unary minus\n\tif(ttext=='M'){value1=operand_as_number(sheet,operand);resulttype=lookup_result_type(value1.type,value1.type,typelookup.unaryminus);PushOperand(resulttype,-value1.value);}// Unary plus\n\telse if(ttext=='P'){value1=operand_as_number(sheet,operand);resulttype=lookup_result_type(value1.type,value1.type,typelookup.unaryplus);PushOperand(resulttype,value1.value);}// Unary % - percent, left associative\n\telse if(ttext=='%'){value1=operand_as_number(sheet,operand);resulttype=lookup_result_type(value1.type,value1.type,typelookup.unarypercent);PushOperand(resulttype,0.01*value1.value);}// & - string concatenate\n\telse if(ttext=='&'){if(operand.length<=1){// Need at least two things on the stack...\n\treturn missingOperandError;}value2=operand_as_text(sheet,operand);value1=operand_as_text(sheet,operand);resulttype=lookup_result_type(value1.type,value1.type,typelookup.concat);PushOperand(resulttype,value1.value+value2.value);}// : - Range constructor\n\telse if(ttext==':'){if(operand.length<=1){// Need at least two things on the stack...\n\treturn missingOperandError;}value1=scf.OperandsAsRangeOnSheet(sheet,operand);// get coords even if use name on other sheet\n\tif(value1.error){// not available\n\terrortext=errortext||value1.error;}PushOperand(value1.type,value1.value);// push sheetname with range on that sheet\n\t}// ! - sheetname!coord\n\telse if(ttext=='!'){if(operand.length<=1){// Need at least two things on the stack...\n\treturn missingOperandError;}value1=operands_as_coord_on_sheet(sheet,operand);// get coord even if name on other sheet\n\tif(value1.error){// not available\n\terrortext=errortext||value1.error;}PushOperand(value1.type,value1.value);// push sheetname with coord or range on that sheet\n\t}// Comparison operators: < L = G > N (< <= = >= > <>)\n\telse if(ttext==\"<\"||ttext==\"L\"||ttext==\"=\"||ttext==\"G\"||ttext==\">\"||ttext==\"N\"){if(operand.length<=1){// Need at least two things on the stack...\n\terrortext=scc.s_parseerrmissingoperand;// remember error\n\tbreak;}value2=operand_value_and_type(sheet,operand);value1=operand_value_and_type(sheet,operand);if(value1.type.charAt(0)==\"n\"&&value2.type.charAt(0)==\"n\"){// compare two numbers\n\tcond=0;if(ttext==\"<\"){cond=value1.value<value2.value?1:0;}else if(ttext==\"L\"){cond=value1.value<=value2.value?1:0;}else if(ttext==\"=\"){cond=value1.value==value2.value?1:0;}else if(ttext==\"G\"){cond=value1.value>=value2.value?1:0;}else if(ttext==\">\"){cond=value1.value>value2.value?1:0;}else if(ttext==\"N\"){cond=value1.value!=value2.value?1:0;}PushOperand(\"nl\",cond);}else if(value1.type.charAt(0)==\"e\"){// error on left\n\tPushOperand(value1.type,0);}else if(value2.type.charAt(0)==\"e\"){// error on right\n\tPushOperand(value2.type,0);}else{// text maybe mixed with numbers or blank\n\ttostype=value1.type.charAt(0);tostype2=value2.type.charAt(0);if(tostype==\"n\"){value1.value=format_number_for_display(value1.value,\"n\",\"\");}else if(tostype==\"b\"){value1.value=\"\";}if(tostype2==\"n\"){value2.value=format_number_for_display(value2.value,\"n\",\"\");}else if(tostype2==\"b\"){value2.value=\"\";}cond=0;value1.value=value1.value.toLowerCase();// ignore case\n\tvalue2.value=value2.value.toLowerCase();if(ttext==\"<\"){cond=value1.value<value2.value?1:0;}else if(ttext==\"L\"){cond=value1.value<=value2.value?1:0;}else if(ttext==\"=\"){cond=value1.value==value2.value?1:0;}else if(ttext==\"G\"){cond=value1.value>=value2.value?1:0;}else if(ttext==\">\"){cond=value1.value>value2.value?1:0;}else if(ttext==\"N\"){cond=value1.value!=value2.value?1:0;}PushOperand(\"nl\",cond);}}// Normal infix arithmethic operators: +, -. *, /, ^\n\telse{// what's left are the normal infix arithmetic operators\n\tif(operand.length<=1){// Need at least two things on the stack...\n\terrortext=scc.s_parseerrmissingoperand;// remember error\n\tbreak;}value2=operand_as_number(sheet,operand);value1=operand_as_number(sheet,operand);if(ttext=='+'){resulttype=lookup_result_type(value1.type,value2.type,typelookup.plus);PushOperand(resulttype,value1.value+value2.value);}else if(ttext=='-'){resulttype=lookup_result_type(value1.type,value2.type,typelookup.plus);PushOperand(resulttype,value1.value-value2.value);}else if(ttext=='*'){resulttype=lookup_result_type(value1.type,value2.type,typelookup.plus);PushOperand(resulttype,value1.value*value2.value);}else if(ttext=='/'){if(value2.value!=0){PushOperand(\"n\",value1.value/value2.value);// gives plain numeric result type\n\t}else{PushOperand(\"e#DIV/0!\",0);}}else if(ttext=='^'){value1.value=Math.pow(value1.value,value2.value);value1.type=\"n\";// gives plain numeric result type\n\tif(isNaN(value1.value)){value1.value=0;value1.type=\"e#NUM!\";}PushOperand(value1.type,value1.value);}}}// function or name\n\telse if(ttype==tokentype.name){errortext=scf.CalculateFunction(ttext,operand,sheet);if(errortext)break;}else{errortext=scc.s_InternalError+\"Unknown token \"+ttype+\" (\"+ttext+\"). \";break;}}// look at final value and handle special cases\n\tvalue=operand[0]?operand[0].value:\"\";tostype=operand[0]?operand[0].type:\"\";if(tostype==\"name\"){// name - expand it\n\tvalue1=SocialCalc.Formula.LookupName(sheet,value);value=value1.value;tostype=value1.type;errortext=errortext||value1.error;}if(tostype==\"coord\"){// the value is a coord reference, get its value and type\n\tvalue1=operand_value_and_type(sheet,operand);value=value1.value;tostype=value1.type;if(tostype==\"b\"){tostype=\"n\";value=0;}}if(operand.length>1&&!errortext){// something left - error\n\terrortext+=scc.s_parseerrerrorinformula;}// set return type\n\tvaluetype=tostype;if(tostype.charAt(0)==\"e\"){// error value\n\terrortext=errortext||tostype.substring(1)||scc.s_calcerrerrorvalueinformula;}else if(tostype==\"range\"){vmatch=value.match(/^(.*)\\|(.*)\\|/);smatch=vmatch[1].indexOf(\"!\");if(smatch>=0){// swap sheetname\n\tvmatch[1]=vmatch[1].substring(smatch+1)+\"!\"+vmatch[1].substring(0,smatch).toUpperCase();}else{vmatch[1]=vmatch[1].toUpperCase();}value=vmatch[1]+\":\"+vmatch[2].toUpperCase();if(!allowrangereturn){errortext=scc.s_formularangeresult+\" \"+value;}}if(errortext&&valuetype.charAt(0)!=\"e\"){value=errortext;valuetype=\"e\";}// look for overflow\n\tif(valuetype.charAt(0)==\"n\"&&(isNaN(value)||!isFinite(value))){value=0;valuetype=\"e#NUM!\";errortext=isNaN(value)?scc.s_calcerrnumericnan:scc.s_calcerrnumericoverflow;}return{value:value,type:valuetype,error:errortext};};/*\n\t#\n\t# resulttype = SocialCalc.Formula.LookupResultType(type1, type2, typelookup);\n\t#\n\t# typelookup has values of the following form:\n\t#\n\t#    typelookup{\"typespec1\"} = \"|typespec2A:resultA|typespec2B:resultB|...\"\n\t#\n\t# First type1 is looked up. If no match, then the first letter (major type) of type1 plus \"*\" is looked up\n\t# resulttype is type1 if result is \"1\", type2 if result is \"2\", otherwise the value of result.\n\t#\n\t*/SocialCalc.Formula.LookupResultType=function(type1,type2,typelookup){var pos1,pos2,result;var table1=typelookup[type1];if(!table1){table1=typelookup[type1.charAt(0)+'*'];if(!table1){return\"e#VALUE! (internal error, missing LookupResultType \"+type1.charAt(0)+\"*)\";// missing from table -- please add it\n\t}}pos1=table1.indexOf(\"|\"+type2+\":\");if(pos1>=0){pos2=table1.indexOf(\"|\",pos1+1);if(pos2<0)return\"e#VALUE! (internal error, incorrect LookupResultType \"+table1+\")\";result=table1.substring(pos1+type2.length+2,pos2);if(result==\"1\")return type1;if(result==\"2\")return type2;return result;}pos1=table1.indexOf(\"|\"+type2.charAt(0)+\"*:\");if(pos1>=0){pos2=table1.indexOf(\"|\",pos1+1);if(pos2<0)return\"e#VALUE! (internal error, incorrect LookupResultType \"+table1+\")\";result=table1.substring(pos1+4,pos2);if(result==\"1\")return type1;if(result==\"2\")return type2;return result;}return\"e#VALUE!\";};/*\n\t#\n\t# operandinfo = SocialCalc.Formula.TopOfStackValueAndType(sheet, operand)\n\t#\n\t# Returns top of stack value and type and then pops the stack.\n\t# The result is {value: value, type: type, error: \"only if bad error\"}\n\t#\n\t*/SocialCalc.Formula.TopOfStackValueAndType=function(sheet,operand){var cellvtype,cell,pos,coordsheet;var scf=SocialCalc.Formula;var result={type:\"\",value:\"\"};var stacklen=operand.length;if(!stacklen){// make sure something is there\n\tresult.error=SocialCalc.Constants.s_InternalError+\"no operand on stack\";return result;}result.value=operand[stacklen-1].value;// get top of stack\n\tresult.type=operand[stacklen-1].type;operand.pop();// we have data - pop stack\n\tif(result.type==\"name\"){result=scf.LookupName(sheet,result.value);}return result;};/*\n\t#\n\t# operandinfo = OperandAsNumber(sheet, operand)\n\t#\n\t# Uses operand_value_and_type to get top of stack and pops it.\n\t# Returns numeric value and type.\n\t# Text values are treated as 0 if they can't be converted somehow.\n\t#\n\t*/SocialCalc.Formula.OperandAsNumber=function(sheet,operand){var t,valueinfo;var operandinfo=SocialCalc.Formula.OperandValueAndType(sheet,operand);t=operandinfo.type.charAt(0);if(t==\"n\"){operandinfo.value=operandinfo.value-0;}else if(t==\"b\"){// blank cell\n\toperandinfo.type=\"n\";operandinfo.value=0;}else if(t==\"e\"){// error\n\toperandinfo.value=0;}else{valueinfo=SocialCalc.DetermineValueType?SocialCalc.DetermineValueType(operandinfo.value):{value:operandinfo.value-0,type:\"n\"};// if without rest of SocialCalc\n\tif(valueinfo.type.charAt(0)==\"n\"){operandinfo.value=valueinfo.value-0;operandinfo.type=valueinfo.type;}else{operandinfo.value=0;operandinfo.type=valueinfo.type;}}return operandinfo;};/*\n\t#\n\t# operandinfo = OperandAsText(sheet, operand)\n\t#\n\t# Uses operand_value_and_type to get top of stack and pops it.\n\t# Returns text value, preserving sub-type.\n\t#\n\t*/SocialCalc.Formula.OperandAsText=function(sheet,operand){var t,valueinfo;var operandinfo=SocialCalc.Formula.OperandValueAndType(sheet,operand);t=operandinfo.type.charAt(0);if(t==\"t\"){// any flavor of text returns as is\n\t;}else if(t==\"n\"){operandinfo.value=SocialCalc.format_number_for_display?SocialCalc.format_number_for_display(operandinfo.value,operandinfo.type,\"\"):operandinfo.value=operandinfo.value+\"\";operandinfo.type=\"t\";}else if(t==\"b\"){// blank\n\toperandinfo.value=\"\";operandinfo.type=\"t\";}else if(t==\"e\"){// error\n\toperandinfo.value=\"\";}else{operand.value=operandinfo.value+\"\";operand.type=\"t\";}return operandinfo;};/*\n\t#\n\t# result = SocialCalc.Formula.OperandValueAndType(sheet, operand)\n\t#\n\t# Pops the top of stack and returns it, following a coord reference if necessary.\n\t# The result is {value: value, type: type, error: \"only if bad error\"}\n\t# Ranges are returned as if they were pushed onto the stack first coord first\n\t# Also sets type with \"t\", \"n\", \"th\", etc., as appropriate\n\t#\n\t*/SocialCalc.Formula.OperandValueAndType=function(sheet,operand){var cellvtype,cell,pos,coordsheet;var scf=SocialCalc.Formula;var result={type:\"\",value:\"\"};var stacklen=operand.length;if(!stacklen){// make sure something is there\n\tresult.error=SocialCalc.Constants.s_InternalError+\"no operand on stack\";return result;}result.value=operand[stacklen-1].value;// get top of stack\n\tresult.type=operand[stacklen-1].type;operand.pop();// we have data - pop stack\n\tif(result.type==\"name\"){result=scf.LookupName(sheet,result.value);}if(result.type==\"range\"){result=scf.StepThroughRangeDown(operand,result.value);}if(result.type==\"coord\"){// value is a coord reference\n\tcoordsheet=sheet;pos=result.value.indexOf(\"!\");if(pos!=-1){// sheet reference\n\tcoordsheet=scf.FindInSheetCache(result.value.substring(pos+1));// get other sheet\n\tif(coordsheet==null){// unavailable\n\tresult.type=\"e#REF!\";result.error=SocialCalc.Constants.s_sheetunavailable+\" \"+result.value.substring(pos+1);result.value=0;return result;}result.value=result.value.substring(0,pos);// get coord part\n\t}if(coordsheet){cell=coordsheet.cells[SocialCalc.Formula.PlainCoord(result.value)];if(cell){cellvtype=cell.valuetype;// get type of value in the cell it points to\n\tresult.value=cell.datavalue;}else{cellvtype=\"b\";}}else{cellvtype=\"e#N/A\";result.value=0;}result.type=cellvtype||\"b\";if(result.type==\"b\"){// blank\n\tresult.value=0;}}return result;};/*\n\t#\n\t# operandinfo = SocialCalc.Formula.OperandAsCoord(sheet, operand)\n\t#\n\t# Gets top of stack and pops it.\n\t# Returns coord value. All others are treated as an error.\n\t#\n\t*/SocialCalc.Formula.OperandAsCoord=function(sheet,operand){var scf=SocialCalc.Formula;var result={type:\"\",value:\"\"};var stacklen=operand.length;result.value=operand[stacklen-1].value;// get top of stack\n\tresult.type=operand[stacklen-1].type;operand.pop();// we have data - pop stack\n\tif(result.type==\"name\"){result=SocialCalc.Formula.LookupName(sheet,result.value);}if(result.type==\"coord\"){// value is a coord reference\n\treturn result;}else{result.value=SocialCalc.Constants.s_calcerrcellrefmissing;result.type=\"e#REF!\";return result;}};/*\n\t#\n\t# result = SocialCalc.Formula.OperandsAsCoordOnSheet(sheet, operand)\n\t#\n\t# Gets 2 at top of stack and pops them, treating them as sheetname!coord-or-name.\n\t# Returns stack-style coord value (coord!sheetname, or coord!sheetname|coord|) with\n\t# a type of coord or range. All others are treated as an error.\n\t# If sheetname not available, sets result.error.\n\t#\n\t*/SocialCalc.Formula.OperandsAsCoordOnSheet=function(sheet,operand){var sheetname,othersheet,pos1,pos2;var value1={};var result={};var scf=SocialCalc.Formula;var stacklen=operand.length;value1.value=operand[stacklen-1].value;// get top of stack - coord or name\n\tvalue1.type=operand[stacklen-1].type;operand.pop();// we have data - pop stack\n\tsheetname=scf.OperandAsSheetName(sheet,operand);// get sheetname as text\n\tothersheet=scf.FindInSheetCache(sheetname.value);if(othersheet==null){// unavailable\n\tresult.type=\"e#REF!\";result.value=0;result.error=SocialCalc.Constants.s_sheetunavailable+\" \"+sheetname.value;return result;}if(value1.type==\"name\"){value1=scf.LookupName(othersheet,value1.value);}result.type=value1.type;if(value1.type==\"coord\"){// value is a coord reference\n\tresult.value=value1.value+\"!\"+sheetname.value;// return in the format as used on stack\n\t}else if(value1.type==\"range\"){// value is a range reference\n\tpos1=value1.value.indexOf(\"|\");pos2=value1.value.indexOf(\"|\",pos1+1);result.value=value1.value.substring(0,pos1)+\"!\"+sheetname.value+\"|\"+value1.value.substring(pos1+1,pos2)+\"|\";}else if(value1.type.charAt(0)==\"e\"){result.value=value1.value;}else{result.error=SocialCalc.Constants.s_calcerrcellrefmissing;result.type=\"e#REF!\";result.value=0;}return result;};/*\n\t#\n\t# result = SocialCalc.Formula.OperandsAsRangeOnSheet(sheet, operand)\n\t#\n\t# Gets 2 at top of stack and pops them, treating them as coord2-or-name:coord1.\n\t# Name is evaluated on sheet of coord1.\n\t# Returns result with \"value\" of stack-style range value (coord!sheetname|coord|) and\n\t# \"type\" of \"range\". All others are treated as an error.\n\t#\n\t*/SocialCalc.Formula.OperandsAsRangeOnSheet=function(sheet,operand){var value1,othersheet,pos1,pos2;var value2={};var scf=SocialCalc.Formula;var scc=SocialCalc.Constants;var stacklen=operand.length;value2.value=operand[stacklen-1].value;// get top of stack - coord or name for \"right\" side\n\tvalue2.type=operand[stacklen-1].type;operand.pop();// we have data - pop stack\n\tvalue1=scf.OperandAsCoord(sheet,operand);// get \"left\" coord\n\tif(value1.type!=\"coord\"){// not a coord, which it must be\n\treturn{value:0,type:\"e#REF!\"};}othersheet=sheet;pos1=value1.value.indexOf(\"!\");if(pos1!=-1){// sheet reference\n\tpos2=value1.value.indexOf(\"|\",pos1+1);if(pos2<0)pos2=value1.value.length;othersheet=scf.FindInSheetCache(value1.value.substring(pos1+1,pos2));// get other sheet\n\tif(othersheet==null){// unavailable\n\treturn{value:0,type:\"e#REF!\",errortext:scc.s_sheetunavailable+\" \"+value1.value.substring(pos1+1,pos2)};}}if(value2.type==\"name\"){// coord:name is allowed, if name is just one cell\n\tvalue2=scf.LookupName(othersheet,value2.value);}if(value2.type==\"coord\"){// value is a coord reference, so return the combined range\n\treturn{value:value1.value+\"|\"+value2.value+\"|\",type:\"range\"};// return range in the format as used on stack\n\t}else{// bad form\n\treturn{value:scc.s_calcerrcellrefmissing,type:\"e#REF!\"};}};/*\n\t#\n\t# result = SocialCalc.Formula.OperandAsSheetName(sheet, operand)\n\t#\n\t# Gets top of stack and pops it.\n\t# Returns sheetname value. All others are treated as an error.\n\t# Accepts text, cell reference, and named value which is one of those two.\n\t#\n\t*/SocialCalc.Formula.OperandAsSheetName=function(sheet,operand){var nvalue,cell;var scf=SocialCalc.Formula;var result={type:\"\",value:\"\"};var stacklen=operand.length;result.value=operand[stacklen-1].value;// get top of stack\n\tresult.type=operand[stacklen-1].type;operand.pop();// we have data - pop stack\n\tif(result.type==\"name\"){nvalue=SocialCalc.Formula.LookupName(sheet,result.value);if(!nvalue.value){// not a known name - return bare name as the name value\n\treturn result;}result.value=nvalue.value;result.type=nvalue.type;}if(result.type==\"coord\"){// value is a coord reference, follow it to find sheet name\n\tcell=sheet.cells[SocialCalc.Formula.PlainCoord(result.value)];if(cell){result.value=cell.datavalue;result.type=cell.valuetype;}else{result.value=\"\";result.type=\"b\";}}if(result.type.charAt(0)==\"t\"){// value is a string which could be a sheet name\n\treturn result;}else{result.value=\"\";result.error=SocialCalc.Constants.s_calcerrsheetnamemissing;return result;}};//\n\t// value = SocialCalc.Formula.LookupName(sheet, name)\n\t//\n\t// Returns value and type of a named value\n\t// Names are case insensitive\n\t// Names may have a definition which is a coord (A1), a range (A1:B7), or a formula (=OFFSET(A1,0,0,5,1))\n\t// Note: The range must not have sheet names (\"!\") in them.\n\t//\n\tSocialCalc.Formula.LookupName=function(sheet,name){var pos,specialc,parseinfo;var names=sheet.names;var value={};var startedwalk=false;if(names[name.toUpperCase()]){// is name defined?\n\tvalue.value=names[name.toUpperCase()].definition;// yes\n\tif(value.value.charAt(0)==\"=\"){// formula\n\tif(!sheet.checknamecirc){// are we possibly walking the name tree?\n\tsheet.checknamecirc={};// not yet\n\tstartedwalk=true;// remember we are the reference that started it\n\t}else{if(sheet.checknamecirc[name]){// circular reference\n\tvalue.type=\"e#NAME?\";value.error=SocialCalc.Constants.s_circularnameref+' \"'+name+'\".';return value;}}sheet.checknamecirc[name]=true;parseinfo=SocialCalc.Formula.ParseFormulaIntoTokens(value.value.substring(1));value=SocialCalc.Formula.evaluate_parsed_formula(parseinfo,sheet,1);// parse formula, allowing range return\n\tdelete sheet.checknamecirc[name];// done with us\n\tif(startedwalk){delete sheet.checknamecirc;// done with walk\n\t}if(value.type!=\"range\"){return value;}}pos=value.value.indexOf(\":\");if(pos!=-1){// range\n\tvalue.type=\"range\";value.value=value.value.substring(0,pos)+\"|\"+value.value.substring(pos+1)+\"|\";value.value=value.value.toUpperCase();}else{value.type=\"coord\";value.value=value.value.toUpperCase();}return value;}else if(specialc=SocialCalc.Formula.SpecialConstants[name.toUpperCase()]){// special constant, like #REF!\n\tpos=specialc.indexOf(\",\");value.value=specialc.substring(0,pos)-0;value.type=specialc.substring(pos+1);return value;}else{value.value=\"\";value.type=\"e#NAME?\";value.error=SocialCalc.Constants.s_calcerrunknownname+' \"'+name+'\"';return value;}};/*\n\t#\n\t# coord = SocialCalc.Formula.StepThroughRangeDown(operand, rangevalue)\n\t#\n\t# Returns next coord in a range, keeping track on the operand stack\n\t# Goes from upper left across and down to bottom right.\n\t#\n\t*/SocialCalc.Formula.StepThroughRangeDown=function(operand,rangevalue){var value1,value2,sequence,pos1,pos2,sheet1,rp,c,r,count;var scf=SocialCalc.Formula;pos1=rangevalue.indexOf(\"|\");pos2=rangevalue.indexOf(\"|\",pos1+1);value1=rangevalue.substring(0,pos1);value2=rangevalue.substring(pos1+1,pos2);sequence=rangevalue.substring(pos2+1)-0;pos1=value1.indexOf(\"!\");if(pos1!=-1){sheet1=value1.substring(pos1);value1=value1.substring(0,pos1);}else{sheet1=\"\";}pos1=value2.indexOf(\"!\");if(pos1!=-1){value2=value2.substring(0,pos1);}rp=scf.OrderRangeParts(value1,value2);count=0;for(r=rp.r1;r<=rp.r2;r++){for(c=rp.c1;c<=rp.c2;c++){count++;if(count>sequence){if(r!=rp.r2||c!=rp.c2){// keep on stack until done\n\tscf.PushOperand(operand,\"range\",value1+sheet1+\"|\"+value2+\"|\"+count);}return{value:SocialCalc.crToCoord(c,r)+sheet1,type:\"coord\"};}}}};/*\n\t#\n\t# result = SocialCalc.Formula.DecodeRangeParts(sheetdata, range)\n\t#\n\t# Returns sheetdata for the sheet where the range is, as well as\n\t# the number of the first column in the range, the number of columns,\n\t# and equivalent row information:\n\t#\n\t# {sheetdata: sheet, sheetname: name-or-\"\", col1num: n, ncols: n, row1num: n, nrows: n}\n\t#\n\t# If any errors, a null result is returned.\n\t#\n\t*/SocialCalc.Formula.DecodeRangeParts=function(sheetdata,range){var value1,value2,pos1,pos2,sheet1,coordsheetdata,rp;var scf=SocialCalc.Formula;pos1=range.indexOf(\"|\");pos2=range.indexOf(\"|\",pos1+1);value1=range.substring(0,pos1);value2=range.substring(pos1+1,pos2);pos1=value1.indexOf(\"!\");if(pos1!=-1){sheet1=value1.substring(pos1+1);value1=value1.substring(0,pos1);}else{sheet1=\"\";}pos1=value2.indexOf(\"!\");if(pos1!=-1){value2=value2.substring(0,pos1);}coordsheetdata=sheetdata;if(sheet1){// sheet reference\n\tcoordsheetdata=scf.FindInSheetCache(sheet1);if(coordsheetdata==null){// unavailable\n\treturn null;}}rp=scf.OrderRangeParts(value1,value2);return{sheetdata:coordsheetdata,sheetname:sheet1,col1num:rp.c1,ncols:rp.c2-rp.c1+1,row1num:rp.r1,nrows:rp.r2-rp.r1+1};};//*********************\n\t//\n\t// Function Handling\n\t//\n\t//*********************\n\t// List of functions -- Define after functions are defined\n\t//\n\t// SocialCalc.Formula.FunctionList[\"function_name\"] = [function_subroutine, number_of_arguments, arg_def, func_def, func_class]\n\t//   function_subroutine takes arguments (fname, operand, foperand, sheet), returns\n\t//      errortext or null, pushing result on operand stack.\n\t//   number_of_arguments is:\n\t//      0 = no arguments\n\t//      >0 = exactly that many arguments\n\t//      <0 = that many arguments (abs value) or more\n\t//      100 = don't check\n\t//\n\t//   arg_def, if present, is the name of the element in SocialCalc.Formula.FunctionArgDefs.\n\t//   func_def, if present, is a string explaining the function. If not, looked up in SocialCalc.Constants.\n\t//   func_class, if present, is the comma-separated names of the elements in SocialCalc.Formula.FunctionClasses.\n\t//\n\t// To add a function, just add it to this object.\n\tif(!SocialCalc.Formula.FunctionList){// make sure it is defined (could have been in another module)\n\tSocialCalc.Formula.FunctionList={};}// FunctionClasses[classname] = {name: full-name-string, items: [sorted list of function names]};\n\t// filled in by SocialCalc.Formula.FillFunctionInfo\n\tSocialCalc.Formula.FunctionClasses=null;// start null to say needs filling in\n\t// FunctionArgDef[argname] = explicit-string-for-arg-list;\n\t// filled in by SocialCalc.Formula.FillFunctionInfo\n\tSocialCalc.Formula.FunctionArgDefs={};/*\n\t#\n\t# errortext = SocialCalc.Formula.CalculateFunction(fname, operand, sheet)\n\t#\n\t# Dispatches for function fname.\n\t#\n\t*/SocialCalc.Formula.CalculateFunction=function(fname,operand,sheet){var fobj,foperand,ffunc,argnum,ttext;var scf=SocialCalc.Formula;var ok=1;var errortext=\"\";fobj=scf.FunctionList[fname];if(fobj){foperand=[];ffunc=fobj[0];argnum=fobj[1];scf.CopyFunctionArgs(operand,foperand);if(argnum!=100){if(argnum<0){if(foperand.length<-argnum){errortext=scf.FunctionArgsError(fname,operand);return errortext;}}else{if(foperand.length!=argnum){errortext=scf.FunctionArgsError(fname,operand);return errortext;}}}errortext=ffunc(fname,operand,foperand,sheet);}else{ttext=fname;if(operand.length&&operand[operand.length-1].type==\"start\"){// no arguments - name or zero arg function\n\toperand.pop();scf.PushOperand(operand,\"name\",ttext);}else{errortext=SocialCalc.Constants.s_sheetfuncunknownfunction+\" \"+ttext+\". \";}}return errortext;};//\n\t// SocialCalc.Formula.PushOperand(operand, t, v)\n\t//\n\t// Pushes the type and value onto the operand stack\n\t//\n\tSocialCalc.Formula.PushOperand=function(operand,t,v){operand.push({type:t,value:v});};//\n\t// SocialCalc.Formula.CopyFunctionArgs(operand, foperand)\n\t//\n\t// Pops operands from operand and pushes on foperand up to function start\n\t// reversing order in the process.\n\t//\n\tSocialCalc.Formula.CopyFunctionArgs=function(operand,foperand){var fobj,foperand,ffunc,argnum;var scf=SocialCalc.Formula;var ok=1;var errortext=null;while(operand.length>0&&operand[operand.length-1].type!=\"start\"){// get each arg\n\tfoperand.push(operand.pop());// copy it\n\t}operand.pop();// get rid of \"start\"\n\treturn;};//\n\t// errortext = SocialCalc.Formula.FunctionArgsError(fname, operand)\n\t//\n\t// Pushes appropriate error on operand stack and returns errortext, including fname\n\t//\n\tSocialCalc.Formula.FunctionArgsError=function(fname,operand){var errortext=SocialCalc.Constants.s_calcerrincorrectargstofunction+\" \"+fname+\". \";SocialCalc.Formula.PushOperand(operand,\"e#VALUE!\",errortext);return errortext;};//\n\t// errortext = SocialCalc.Formula.FunctionSpecificError(fname, operand, errortype, errortext)\n\t//\n\t// Pushes specified error and text on operand stack.\n\t//\n\tSocialCalc.Formula.FunctionSpecificError=function(fname,operand,errortype,errortext){SocialCalc.Formula.PushOperand(operand,errortype,errortext);return errortext;};//\n\t// haserror = SocialCalc.Formula.CheckForErrorValue(operand, v)\n\t//\n\t// If v.type is an error, push it on operand stack and return true, otherwise return false.\n\t//\n\tSocialCalc.Formula.CheckForErrorValue=function(operand,v){if(v.type.charAt(0)==\"e\"){operand.push(v);return true;}else{return false;}};/////////////////////////\n\t//\n\t// FUNCTION INFORMATION ROUTINES\n\t//\n\t//\n\t// SocialCalc.Formula.FillFunctionInfo()\n\t//\n\t// Goes through function definitions and fills out FunctionArgDefs and FunctionClasses.\n\t// Execute this after any changes to SocialCalc.Constants but before UI is used.\n\t//\n\tSocialCalc.Formula.FillFunctionInfo=function(){var scf=SocialCalc.Formula;var scc=SocialCalc.Constants;var fname,f,classes,cname,i;if(scf.FunctionClasses){// only do once\n\treturn;}for(fname in scf.FunctionList){f=scf.FunctionList[fname];if(f[2]){// has an arg def\n\tscf.FunctionArgDefs[f[2]]=scc[\"s_farg_\"+f[2]]||\"\";// get it from constants\n\t}if(!f[3]){// no text def, see if in constants\n\tif(scc[\"s_fdef_\"+fname]){scf.FunctionList[fname][3]=scc[\"s_fdef_\"+fname];}}}scf.FunctionClasses={};for(i=0;i<scc.function_classlist.length;i++){cname=scc.function_classlist[i];scf.FunctionClasses[cname]={name:scc[\"s_fclass_\"+cname],items:[]};}for(fname in scf.FunctionList){f=scf.FunctionList[fname];classes=f[4]?f[4].split(\",\"):[];// get classes\n\tclasses.push(\"all\");for(i=0;i<classes.length;i++){cname=classes[i];scf.FunctionClasses[cname].items.push(fname);}}for(cname in scf.FunctionClasses){scf.FunctionClasses[cname].items.sort();}};//\n\t// str = SocialCalc.Formula.FunctionArgString(fname)\n\t//\n\t// Returns a string representing the arguments to function fname.\n\t//\n\tSocialCalc.Formula.FunctionArgString=function(fname){var scf=SocialCalc.Formula;var fdata=scf.FunctionList[fname];var nargs,i,str;var adef=fdata[2];if(!adef){nargs=fdata[1];if(nargs==0){adef=\" \";}else if(nargs>0){str=\"v1\";for(i=2;i<=nargs;i++){str+=\", v\"+i;}return str;}else if(nargs<0){str=\"v1\";for(i=2;i<-nargs;i++){str+=\", v\"+i;}return str+\", ...\";}else{return\"nargs: \"+nargs;}}str=scf.FunctionArgDefs[adef]||adef;return str;};/////////////////////////\n\t//\n\t// FUNCTION DEFINITIONS\n\t//\n\t// The standard function definitions follow.\n\t//\n\t// Note that some need SocialCalc.DetermineValueType to be defined.\n\t//\n\t/*\n\t#\n\t# AVERAGE(v1,c1:c2,...)\n\t# COUNT(v1,c1:c2,...)\n\t# COUNTA(v1,c1:c2,...)\n\t# COUNTBLANK(v1,c1:c2,...)\n\t# MAX(v1,c1:c2,...)\n\t# MIN(v1,c1:c2,...)\n\t# PRODUCT(v1,c1:c2,...)\n\t# STDEV(v1,c1:c2,...)\n\t# STDEVP(v1,c1:c2,...)\n\t# SUM(v1,c1:c2,...)\n\t# VAR(v1,c1:c2,...)\n\t# VARP(v1,c1:c2,...)\n\t#\n\t# Calculate all of these and then return the desired one (overhead is in accessing not calculating)\n\t# If this routine is changed, check the dseries_functions, too.\n\t#\n\t*/SocialCalc.Formula.SeriesFunctions=function(fname,operand,foperand,sheet){var value1,t,v1;var scf=SocialCalc.Formula;var operand_value_and_type=scf.OperandValueAndType;var lookup_result_type=scf.LookupResultType;var typelookupplus=scf.TypeLookupTable.plus;var PushOperand=function PushOperand(t,v){operand.push({type:t,value:v});};var sum=0;var resulttypesum=\"\";var count=0;var counta=0;var countblank=0;var product=1;var maxval;var minval;var mk,sk,mk1,sk1;// For variance, etc.: M sub k, k-1, and S sub k-1\n\t// as per Knuth \"The Art of Computer Programming\" Vol. 2 3rd edition, page 232\n\twhile(foperand.length>0){value1=operand_value_and_type(sheet,foperand);t=value1.type.charAt(0);if(t==\"n\")count+=1;if(t!=\"b\")counta+=1;if(t==\"b\")countblank+=1;if(t==\"n\"){v1=value1.value-0;// get it as a number\n\tsum+=v1;product*=v1;maxval=maxval!=undefined?v1>maxval?v1:maxval:v1;minval=minval!=undefined?v1<minval?v1:minval:v1;if(count==1){// initialize with first values for variance used in STDEV, VAR, etc.\n\tmk1=v1;sk1=0;}else{// Accumulate S sub 1 through n as per Knuth noted above\n\tmk=mk1+(v1-mk1)/count;sk=sk1+(v1-mk1)*(v1-mk);sk1=sk;mk1=mk;}resulttypesum=lookup_result_type(value1.type,resulttypesum||value1.type,typelookupplus);}else if(t==\"e\"&&resulttypesum.charAt(0)!=\"e\"){resulttypesum=value1.type;}}resulttypesum=resulttypesum||\"n\";switch(fname){case\"SUM\":PushOperand(resulttypesum,sum);break;case\"PRODUCT\":// may handle cases with text differently than some other spreadsheets\n\tPushOperand(resulttypesum,product);break;case\"MIN\":PushOperand(resulttypesum,minval||0);break;case\"MAX\":PushOperand(resulttypesum,maxval||0);break;case\"COUNT\":PushOperand(\"n\",count);break;case\"COUNTA\":PushOperand(\"n\",counta);break;case\"COUNTBLANK\":PushOperand(\"n\",countblank);break;case\"AVERAGE\":if(count>0){PushOperand(resulttypesum,sum/count);}else{PushOperand(\"e#DIV/0!\",0);}break;case\"STDEV\":if(count>1){PushOperand(resulttypesum,Math.sqrt(sk/(count-1)));// sk is never negative according to Knuth\n\t}else{PushOperand(\"e#DIV/0!\",0);}break;case\"STDEVP\":if(count>1){PushOperand(resulttypesum,Math.sqrt(sk/count));}else{PushOperand(\"e#DIV/0!\",0);}break;case\"VAR\":if(count>1){PushOperand(resulttypesum,sk/(count-1));}else{PushOperand(\"e#DIV/0!\",0);}break;case\"VARP\":if(count>1){PushOperand(resulttypesum,sk/count);}else{PushOperand(\"e#DIV/0!\",0);}break;}return null;};// Add to function list\n\tSocialCalc.Formula.FunctionList[\"AVERAGE\"]=[SocialCalc.Formula.SeriesFunctions,-1,\"vn\",null,\"stat\"];SocialCalc.Formula.FunctionList[\"COUNT\"]=[SocialCalc.Formula.SeriesFunctions,-1,\"vn\",null,\"stat\"];SocialCalc.Formula.FunctionList[\"COUNTA\"]=[SocialCalc.Formula.SeriesFunctions,-1,\"vn\",null,\"stat\"];SocialCalc.Formula.FunctionList[\"COUNTBLANK\"]=[SocialCalc.Formula.SeriesFunctions,-1,\"vn\",null,\"stat\"];SocialCalc.Formula.FunctionList[\"MAX\"]=[SocialCalc.Formula.SeriesFunctions,-1,\"vn\",null,\"stat\"];SocialCalc.Formula.FunctionList[\"MIN\"]=[SocialCalc.Formula.SeriesFunctions,-1,\"vn\",null,\"stat\"];SocialCalc.Formula.FunctionList[\"PRODUCT\"]=[SocialCalc.Formula.SeriesFunctions,-1,\"vn\",null,\"stat\"];SocialCalc.Formula.FunctionList[\"STDEV\"]=[SocialCalc.Formula.SeriesFunctions,-1,\"vn\",null,\"stat\"];SocialCalc.Formula.FunctionList[\"STDEVP\"]=[SocialCalc.Formula.SeriesFunctions,-1,\"vn\",null,\"stat\"];SocialCalc.Formula.FunctionList[\"SUM\"]=[SocialCalc.Formula.SeriesFunctions,-1,\"vn\",null,\"stat\"];SocialCalc.Formula.FunctionList[\"VAR\"]=[SocialCalc.Formula.SeriesFunctions,-1,\"vn\",null,\"stat\"];SocialCalc.Formula.FunctionList[\"VARP\"]=[SocialCalc.Formula.SeriesFunctions,-1,\"vn\",null,\"stat\"];/*\n\t#\n\t# DAVERAGE(databaserange, fieldname, criteriarange)\n\t# DCOUNT(databaserange, fieldname, criteriarange)\n\t# DCOUNTA(databaserange, fieldname, criteriarange)\n\t# DGET(databaserange, fieldname, criteriarange)\n\t# DMAX(databaserange, fieldname, criteriarange)\n\t# DMIN(databaserange, fieldname, criteriarange)\n\t# DPRODUCT(databaserange, fieldname, criteriarange)\n\t# DSTDEV(databaserange, fieldname, criteriarange)\n\t# DSTDEVP(databaserange, fieldname, criteriarange)\n\t# DSUM(databaserange, fieldname, criteriarange)\n\t# DVAR(databaserange, fieldname, criteriarange)\n\t# DVARP(databaserange, fieldname, criteriarange)\n\t#\n\t# Calculate all of these and then return the desired one (overhead is in accessing not calculating)\n\t# If this routine is changed, check the series_functions, too.\n\t#\n\t*/SocialCalc.Formula.DSeriesFunctions=function(fname,operand,foperand,sheet){var value1,tostype,cr,dbrange,fieldname,criteriarange,dbinfo,criteriainfo;var fieldasnum,targetcol,i,j,k,cell,criteriafieldnums;var testok,criteriacr,criteria,testcol,testcr;var t;var scf=SocialCalc.Formula;var operand_value_and_type=scf.OperandValueAndType;var lookup_result_type=scf.LookupResultType;var typelookupplus=scf.TypeLookupTable.plus;var PushOperand=function PushOperand(t,v){operand.push({type:t,value:v});};var value1={};var sum=0;var resulttypesum=\"\";var count=0;var counta=0;var countblank=0;var product=1;var maxval;var minval;var mk,sk,mk1,sk1;// For variance, etc.: M sub k, k-1, and S sub k-1\n\t// as per Knuth \"The Art of Computer Programming\" Vol. 2 3rd edition, page 232\n\tdbrange=scf.TopOfStackValueAndType(sheet,foperand);// get a range\n\tfieldname=scf.OperandValueAndType(sheet,foperand);// get a value\n\tcriteriarange=scf.TopOfStackValueAndType(sheet,foperand);// get a range\n\tif(dbrange.type!=\"range\"||criteriarange.type!=\"range\"){return scf.FunctionArgsError(fname,operand);}dbinfo=scf.DecodeRangeParts(sheet,dbrange.value);criteriainfo=scf.DecodeRangeParts(sheet,criteriarange.value);fieldasnum=scf.FieldToColnum(dbinfo.sheetdata,dbinfo.col1num,dbinfo.ncols,dbinfo.row1num,fieldname.value,fieldname.type);if(fieldasnum<=0){PushOperand(\"e#VALUE!\",0);return;}targetcol=dbinfo.col1num+fieldasnum-1;criteriafieldnums=[];for(i=0;i<criteriainfo.ncols;i++){// get criteria field colnums\n\tcell=criteriainfo.sheetdata.GetAssuredCell(SocialCalc.crToCoord(criteriainfo.col1num+i,criteriainfo.row1num));criterianum=scf.FieldToColnum(dbinfo.sheetdata,dbinfo.col1num,dbinfo.ncols,dbinfo.row1num,cell.datavalue,cell.valuetype);if(criterianum<=0){PushOperand(\"e#VALUE!\",0);return;}criteriafieldnums.push(dbinfo.col1num+criterianum-1);}for(i=1;i<dbinfo.nrows;i++){// go through each row of the database\n\ttestok=false;CRITERIAROW:for(j=1;j<criteriainfo.nrows;j++){// go through each criteria row\n\tfor(k=0;k<criteriainfo.ncols;k++){// look at each column\n\tcriteriacr=SocialCalc.crToCoord(criteriainfo.col1num+k,criteriainfo.row1num+j);// where criteria is\n\tcell=criteriainfo.sheetdata.GetAssuredCell(criteriacr);criteria=cell.datavalue;if(typeof criteria==\"string\"&&criteria.length==0)continue;// blank items are OK\n\ttestcol=criteriafieldnums[k];testcr=SocialCalc.crToCoord(testcol,dbinfo.row1num+i);// cell to check\n\tcell=criteriainfo.sheetdata.GetAssuredCell(testcr);if(!scf.TestCriteria(cell.datavalue,cell.valuetype||\"b\",criteria)){continue CRITERIAROW;// does not meet criteria - check next row\n\t}}testok=true;// met all the criteria\n\tbreak CRITERIAROW;}if(!testok){continue;}cr=SocialCalc.crToCoord(targetcol,dbinfo.row1num+i);// get cell of this row to do the function on\n\tcell=dbinfo.sheetdata.GetAssuredCell(cr);value1.value=cell.datavalue;value1.type=cell.valuetype;t=value1.type.charAt(0);if(t==\"n\")count+=1;if(t!=\"b\")counta+=1;if(t==\"b\")countblank+=1;if(t==\"n\"){v1=value1.value-0;// get it as a number\n\tsum+=v1;product*=v1;maxval=maxval!=undefined?v1>maxval?v1:maxval:v1;minval=minval!=undefined?v1<minval?v1:minval:v1;if(count==1){// initialize with first values for variance used in STDEV, VAR, etc.\n\tmk1=v1;sk1=0;}else{// Accumulate S sub 1 through n as per Knuth noted above\n\tmk=mk1+(v1-mk1)/count;sk=sk1+(v1-mk1)*(v1-mk);sk1=sk;mk1=mk;}resulttypesum=lookup_result_type(value1.type,resulttypesum||value1.type,typelookupplus);}else if(t==\"e\"&&resulttypesum.charAt(0)!=\"e\"){resulttypesum=value1.type;}}resulttypesum=resulttypesum||\"n\";switch(fname){case\"DSUM\":PushOperand(resulttypesum,sum);break;case\"DPRODUCT\":// may handle cases with text differently than some other spreadsheets\n\tPushOperand(resulttypesum,product);break;case\"DMIN\":PushOperand(resulttypesum,minval||0);break;case\"DMAX\":PushOperand(resulttypesum,maxval||0);break;case\"DCOUNT\":PushOperand(\"n\",count);break;case\"DCOUNTA\":PushOperand(\"n\",counta);break;case\"DAVERAGE\":if(count>0){PushOperand(resulttypesum,sum/count);}else{PushOperand(\"e#DIV/0!\",0);}break;case\"DSTDEV\":if(count>1){PushOperand(resulttypesum,Math.sqrt(sk/(count-1)));// sk is never negative according to Knuth\n\t}else{PushOperand(\"e#DIV/0!\",0);}break;case\"DSTDEVP\":if(count>1){PushOperand(resulttypesum,Math.sqrt(sk/count));}else{PushOperand(\"e#DIV/0!\",0);}break;case\"DVAR\":if(count>1){PushOperand(resulttypesum,sk/(count-1));}else{PushOperand(\"e#DIV/0!\",0);}break;case\"DVARP\":if(count>1){PushOperand(resulttypesum,sk/count);}else{PushOperand(\"e#DIV/0!\",0);}break;case\"DGET\":if(count==1){PushOperand(resulttypesum,sum);}else if(count==0){PushOperand(\"e#VALUE!\",0);}else{PushOperand(\"e#NUM!\",0);}break;}return;};SocialCalc.Formula.FunctionList[\"DAVERAGE\"]=[SocialCalc.Formula.DSeriesFunctions,3,\"dfunc\",\"\",\"stat\"];SocialCalc.Formula.FunctionList[\"DCOUNT\"]=[SocialCalc.Formula.DSeriesFunctions,3,\"dfunc\",\"\",\"stat\"];SocialCalc.Formula.FunctionList[\"DCOUNTA\"]=[SocialCalc.Formula.DSeriesFunctions,3,\"dfunc\",\"\",\"stat\"];SocialCalc.Formula.FunctionList[\"DGET\"]=[SocialCalc.Formula.DSeriesFunctions,3,\"dfunc\",\"\",\"stat\"];SocialCalc.Formula.FunctionList[\"DMAX\"]=[SocialCalc.Formula.DSeriesFunctions,3,\"dfunc\",\"\",\"stat\"];SocialCalc.Formula.FunctionList[\"DMIN\"]=[SocialCalc.Formula.DSeriesFunctions,3,\"dfunc\",\"\",\"stat\"];SocialCalc.Formula.FunctionList[\"DPRODUCT\"]=[SocialCalc.Formula.DSeriesFunctions,3,\"dfunc\",\"\",\"stat\"];SocialCalc.Formula.FunctionList[\"DSTDEV\"]=[SocialCalc.Formula.DSeriesFunctions,3,\"dfunc\",\"\",\"stat\"];SocialCalc.Formula.FunctionList[\"DSTDEVP\"]=[SocialCalc.Formula.DSeriesFunctions,3,\"dfunc\",\"\",\"stat\"];SocialCalc.Formula.FunctionList[\"DSUM\"]=[SocialCalc.Formula.DSeriesFunctions,3,\"dfunc\",\"\",\"stat\"];SocialCalc.Formula.FunctionList[\"DVAR\"]=[SocialCalc.Formula.DSeriesFunctions,3,\"dfunc\",\"\",\"stat\"];SocialCalc.Formula.FunctionList[\"DVARP\"]=[SocialCalc.Formula.DSeriesFunctions,3,\"dfunc\",\"\",\"stat\"];/*\n\t#\n\t# colnum = SocialCalc.Formula.FieldToColnum(sheet, col1num, ncols, row1num, fieldname, fieldtype)\n\t#\n\t# If fieldname is a number, uses it, otherwise looks up string in cells in row to find field number\n\t#\n\t# If not found, returns 0.\n\t#\n\t*/SocialCalc.Formula.FieldToColnum=function(sheet,col1num,ncols,row1num,fieldname,fieldtype){var colnum,cell,value;if(fieldtype.charAt(0)==\"n\"){// number - return it if legal\n\tcolnum=fieldname-0;// make sure a number\n\tif(colnum<=0||colnum>ncols){return 0;}return Math.floor(colnum);}if(fieldtype.charAt(0)!=\"t\"){// must be text otherwise\n\treturn 0;}fieldname=fieldname?fieldname.toLowerCase():\"\";for(colnum=0;colnum<ncols;colnum++){// look through column headers for a match\n\tcell=sheet.GetAssuredCell(SocialCalc.crToCoord(col1num+colnum,row1num));value=cell.datavalue;value=(value+\"\").toLowerCase();// ignore case\n\tif(value==fieldname){// match\n\treturn colnum+1;}}return 0;// looked at all and no match\n\t};/*\n\t#\n\t# HLOOKUP(value, range, row, [rangelookup])\n\t# VLOOKUP(value, range, col, [rangelookup])\n\t# MATCH(value, range, [rangelookup])\n\t#\n\t*/SocialCalc.Formula.LookupFunctions=function(fname,operand,foperand,sheet){var lookupvalue,range,offset,rangelookup,offsetvalue,rangeinfo;var c,r,cincr,rincr,previousOK,csave,rsave,cell,value,valuetype,cr,lookupvalue;var scf=SocialCalc.Formula;var operand_value_and_type=scf.OperandValueAndType;var lookup_result_type=scf.LookupResultType;var typelookupplus=scf.TypeLookupTable.plus;var PushOperand=function PushOperand(t,v){operand.push({type:t,value:v});};lookupvalue=operand_value_and_type(sheet,foperand);if(typeof lookupvalue.value==\"string\"){lookupvalue.value=lookupvalue.value.toLowerCase();}range=scf.TopOfStackValueAndType(sheet,foperand);rangelookup=1;// default to true or 1\n\tif(fname==\"MATCH\"){if(foperand.length){rangelookup=scf.OperandAsNumber(sheet,foperand);if(rangelookup.type.charAt(0)!=\"n\"){PushOperand(\"e#VALUE!\",0);return;}if(foperand.length){scf.FunctionArgsError(fname,operand);return 0;}rangelookup=rangelookup.value-0;}}else{offsetvalue=scf.OperandAsNumber(sheet,foperand);if(offsetvalue.type.charAt(0)!=\"n\"){PushOperand(\"e#VALUE!\",0);return;}offsetvalue=Math.floor(offsetvalue.value);if(foperand.length){rangelookup=scf.OperandAsNumber(sheet,foperand);if(rangelookup.type.charAt(0)!=\"n\"){PushOperand(\"e#VALUE!\",0);return;}if(foperand.length){scf.FunctionArgsError(fname,operand);return 0;}rangelookup=rangelookup.value?1:0;// convert to 1 or 0\n\t}}lookupvalue.type=lookupvalue.type.charAt(0);// only deal with general type\n\tif(lookupvalue.type==\"n\"){// if number, make sure a number\n\tlookupvalue.value=lookupvalue.value-0;}if(range.type!=\"range\"){scf.FunctionArgsError(fname,operand);return 0;}rangeinfo=scf.DecodeRangeParts(sheet,range.value,range.type);if(!rangeinfo){PushOperand(\"e#REF!\",0);return;}c=0;r=0;cincr=0;rincr=0;if(fname==\"HLOOKUP\"){cincr=1;if(offsetvalue>rangeinfo.nrows){PushOperand(\"e#REF!\",0);return;}}else if(fname==\"VLOOKUP\"){rincr=1;if(offsetvalue>rangeinfo.ncols){PushOperand(\"e#REF!\",0);return;}}else if(fname==\"MATCH\"){if(rangeinfo.ncols>1){if(rangeinfo.nrows>1){PushOperand(\"e#N/A\",0);return;}cincr=1;}else{rincr=1;}}else{scf.FunctionArgsError(fname,operand);return 0;}if(offsetvalue<1&&fname!=\"MATCH\"){PushOperand(\"e#VALUE!\",0);return 0;}previousOK;// if 1, previous test was <. If 2, also this one wasn't\n\twhile(1){cr=SocialCalc.crToCoord(rangeinfo.col1num+c,rangeinfo.row1num+r);cell=rangeinfo.sheetdata.GetAssuredCell(cr);value=cell.datavalue;valuetype=cell.valuetype?cell.valuetype.charAt(0):\"b\";// only deal with general types\n\tif(valuetype==\"n\"){value=value-0;// make sure number\n\t}if(rangelookup){// rangelookup type 1 or -1: look for within brackets for matches\n\tif(lookupvalue.type==\"n\"&&valuetype==\"n\"){if(lookupvalue.value==value){// match\n\tbreak;}if(rangelookup>0&&lookupvalue.value>value||rangelookup<0&&lookupvalue.value<value){// possible match: wait and see\n\tpreviousOK=1;csave=c;// remember col and row of last OK\n\trsave=r;}else if(previousOK){// last one was OK, this one isn't\n\tpreviousOK=2;break;}}else if(lookupvalue.type==\"t\"&&valuetype==\"t\"){value=typeof value==\"string\"?value.toLowerCase():\"\";if(lookupvalue.value==value){// match\n\tbreak;}if(rangelookup>0&&lookupvalue.value>value||rangelookup<0&&lookupvalue.value<value){// possible match: wait and see\n\tpreviousOK=1;csave=c;rsave=r;}else if(previousOK){// last one was OK, this one isn't\n\tpreviousOK=2;break;}}}else{// exact value matches\n\tif(lookupvalue.type==\"n\"&&valuetype==\"n\"){if(lookupvalue.value==value){// match\n\tbreak;}}else if(lookupvalue.type==\"t\"&&valuetype==\"t\"){value=typeof value==\"string\"?value.toLowerCase():\"\";if(lookupvalue.value==value){// match\n\tbreak;}}}r+=rincr;c+=cincr;if(r>=rangeinfo.nrows||c>=rangeinfo.ncols){// end of range to check, no exact match\n\tif(previousOK){// at least one could have been OK\n\tpreviousOK=2;break;}PushOperand(\"e#N/A\",0);return;}}if(previousOK==2){// back to last OK\n\tr=rsave;c=csave;}if(fname==\"MATCH\"){value=c+r+1;// only one may be <> 0\n\tvaluetype=\"n\";}else{cr=SocialCalc.crToCoord(rangeinfo.col1num+c+(fname==\"VLOOKUP\"?offsetvalue-1:0),rangeinfo.row1num+r+(fname==\"HLOOKUP\"?offsetvalue-1:0));cell=rangeinfo.sheetdata.GetAssuredCell(cr);value=cell.datavalue;valuetype=cell.valuetype;}PushOperand(valuetype,value);return;};SocialCalc.Formula.FunctionList[\"HLOOKUP\"]=[SocialCalc.Formula.LookupFunctions,-3,\"hlookup\",\"\",\"lookup\"];SocialCalc.Formula.FunctionList[\"MATCH\"]=[SocialCalc.Formula.LookupFunctions,-2,\"match\",\"\",\"lookup\"];SocialCalc.Formula.FunctionList[\"VLOOKUP\"]=[SocialCalc.Formula.LookupFunctions,-3,\"vlookup\",\"\",\"lookup\"];/*\n\t#\n\t# INDEX(range, rownum, colnum)\n\t#\n\t*/SocialCalc.Formula.IndexFunction=function(fname,operand,foperand,sheet){var range,sheetname,indexinfo,rowindex,colindex,result,resulttype;var scf=SocialCalc.Formula;var PushOperand=function PushOperand(t,v){operand.push({type:t,value:v});};range=scf.TopOfStackValueAndType(sheet,foperand);// get range\n\tif(range.type!=\"range\"){scf.FunctionArgsError(fname,operand);return 0;}indexinfo=scf.DecodeRangeParts(sheet,range.value,range.type);if(indexinfo.sheetname){sheetname=\"!\"+indexinfo.sheetname;}else{sheetname=\"\";}rowindex={value:0};colindex={value:0};if(foperand.length){// look for row number\n\trowindex=scf.OperandAsNumber(sheet,foperand);if(rowindex.type.charAt(0)!=\"n\"||rowindex.value<0){PushOperand(\"e#VALUE!\",0);return;}if(foperand.length){// look for col number\n\tcolindex=scf.OperandAsNumber(sheet,foperand);if(colindex.type.charAt(0)!=\"n\"||colindex.value<0){PushOperand(\"e#VALUE!\",0);return;}if(foperand.length){scf.FunctionArgsError(fname,operand);return 0;}}else{// col number missing\n\tif(indexinfo.nrows==1){// if only one row, then rowindex is really colindex\n\tcolindex.value=rowindex.value;rowindex.value=0;}}}if(rowindex.value>indexinfo.nrows||colindex.value>indexinfo.ncols){PushOperand(\"e#REF!\",0);return;}if(rowindex.value==0){if(colindex.value==0){if(indexinfo.nrows==1&&indexinfo.ncols==1){result=SocialCalc.crToCoord(indexinfo.col1num,indexinfo.row1num)+sheetname;resulttype=\"coord\";}else{result=SocialCalc.crToCoord(indexinfo.col1num,indexinfo.row1num)+sheetname+\"|\"+SocialCalc.crToCoord(indexinfo.col1num+indexinfo.ncols-1,indexinfo.row1num+indexinfo.nrows-1)+\"|\";resulttype=\"range\";}}else{if(indexinfo.nrows==1){result=SocialCalc.crToCoord(indexinfo.col1num+colindex.value-1,indexinfo.row1num)+sheetname;resulttype=\"coord\";}else{result=SocialCalc.crToCoord(indexinfo.col1num+colindex.value-1,indexinfo.row1num)+sheetname+\"|\"+SocialCalc.crToCoord(indexinfo.col1num+colindex.value-1,indexinfo.row1num+indexinfo.nrows-1)+\"|\";resulttype=\"range\";}}}else{if(colindex.value==0){if(indexinfo.ncols==1){result=SocialCalc.crToCoord(indexinfo.col1num,indexinfo.row1num+rowindex.value-1)+sheetname;resulttype=\"coord\";}else{result=SocialCalc.crToCoord(indexinfo.col1num,indexinfo.row1num+rowindex.value-1)+sheetname+\"|\"+SocialCalc.crToCoord(indexinfo.col1num+indexinfo.ncols-1,indexinfo.row1num+rowindex.value-1)+\"|\";resulttype=\"range\";}}else{result=SocialCalc.crToCoord(indexinfo.col1num+colindex.value-1,indexinfo.row1num+rowindex.value-1)+sheetname;resulttype=\"coord\";}}PushOperand(resulttype,result);return;};SocialCalc.Formula.FunctionList[\"INDEX\"]=[SocialCalc.Formula.IndexFunction,-1,\"index\",\"\",\"lookup\"];/*\n\t#\n\t# COUNTIF(c1:c2,\"criteria\")\n\t# SUMIF(c1:c2,\"criteria\",[range2])\n\t#\n\t*/SocialCalc.Formula.CountifSumifFunctions=function(fname,operand,foperand,sheet){var range,criteria,sumrange,f2operand,result,resulttype,value1,value2;var sum=0;var resulttypesum=\"\";var count=0;var scf=SocialCalc.Formula;var operand_value_and_type=scf.OperandValueAndType;var lookup_result_type=scf.LookupResultType;var typelookupplus=scf.TypeLookupTable.plus;var PushOperand=function PushOperand(t,v){operand.push({type:t,value:v});};range=scf.TopOfStackValueAndType(sheet,foperand);// get range or coord\n\tcriteria=scf.OperandAsText(sheet,foperand);// get criteria\n\tif(fname==\"SUMIF\"){if(foperand.length==1){// three arg form of SUMIF\n\tsumrange=scf.TopOfStackValueAndType(sheet,foperand);}else if(foperand.length==0){// two arg form\n\tsumrange={value:range.value,type:range.type};}else{scf.FunctionArgsError(fname,operand);return 0;}}else{sumrange={value:range.value,type:range.type};}if(criteria.type.charAt(0)==\"n\"){criteria.value=criteria.value+\"\";// make text\n\t}else if(criteria.type.charAt(0)==\"e\"){// error\n\tcriteria.value=null;}else if(criteria.type.charAt(0)==\"b\"){// blank here is undefined\n\tcriteria.value=null;}if(range.type!=\"coord\"&&range.type!=\"range\"){scf.FunctionArgsError(fname,operand);return 0;}if(fname==\"SUMIF\"&&sumrange.type!=\"coord\"&&sumrange.type!=\"range\"){scf.FunctionArgsError(fname,operand);return 0;}foperand.push(range);f2operand=[];// to allow for 3 arg form\n\tf2operand.push(sumrange);while(foperand.length){value1=operand_value_and_type(sheet,foperand);value2=operand_value_and_type(sheet,f2operand);if(!scf.TestCriteria(value1.value,value1.type,criteria.value)){continue;}count+=1;if(value2.type.charAt(0)==\"n\"){sum+=value2.value-0;resulttypesum=lookup_result_type(value2.type,resulttypesum||value2.type,typelookupplus);}else if(value2.type.charAt(0)==\"e\"&&resulttypesum.charAt(0)!=\"e\"){resulttypesum=value2.type;}}resulttypesum=resulttypesum||\"n\";if(fname==\"SUMIF\"){PushOperand(resulttypesum,sum);}else if(fname==\"COUNTIF\"){PushOperand(\"n\",count);}return;};SocialCalc.Formula.FunctionList[\"COUNTIF\"]=[SocialCalc.Formula.CountifSumifFunctions,2,\"rangec\",\"\",\"stat\"];SocialCalc.Formula.FunctionList[\"SUMIF\"]=[SocialCalc.Formula.CountifSumifFunctions,-2,\"sumif\",\"\",\"stat\"];/*\n\t#\n\t# IF(cond,truevalue,falsevalue)\n\t#\n\t*/SocialCalc.Formula.IfFunction=function(fname,operand,foperand,sheet){var cond,t;cond=SocialCalc.Formula.OperandValueAndType(sheet,foperand);t=cond.type.charAt(0);if(t!=\"n\"&&t!=\"b\"){operand.push({type:\"e#VALUE!\",value:0});return;}if(!cond.value)foperand.pop();operand.push(foperand.pop());if(cond.value)foperand.pop();return null;};// Add to function list\n\tSocialCalc.Formula.FunctionList[\"IF\"]=[SocialCalc.Formula.IfFunction,3,\"iffunc\",\"\",\"test\"];/*\n\t#\n\t# DATE(year,month,day)\n\t#\n\t*/SocialCalc.Formula.DateFunction=function(fname,operand,foperand,sheet){var scf=SocialCalc.Formula;var result=0;var year=scf.OperandAsNumber(sheet,foperand);var month=scf.OperandAsNumber(sheet,foperand);var day=scf.OperandAsNumber(sheet,foperand);var resulttype=scf.LookupResultType(year.type,month.type,scf.TypeLookupTable.twoargnumeric);resulttype=scf.LookupResultType(resulttype,day.type,scf.TypeLookupTable.twoargnumeric);if(resulttype.charAt(0)==\"n\"){result=SocialCalc.FormatNumber.convert_date_gregorian_to_julian(Math.floor(year.value),Math.floor(month.value),Math.floor(day.value))-SocialCalc.FormatNumber.datevalues.julian_offset;resulttype=\"nd\";}scf.PushOperand(operand,resulttype,result);return;};SocialCalc.Formula.FunctionList[\"DATE\"]=[SocialCalc.Formula.DateFunction,3,\"date\",\"\",\"datetime\"];/*\n\t#\n\t# TIME(hour,minute,second)\n\t#\n\t*/SocialCalc.Formula.TimeFunction=function(fname,operand,foperand,sheet){var scf=SocialCalc.Formula;var result=0;var hours=scf.OperandAsNumber(sheet,foperand);var minutes=scf.OperandAsNumber(sheet,foperand);var seconds=scf.OperandAsNumber(sheet,foperand);var resulttype=scf.LookupResultType(hours.type,minutes.type,scf.TypeLookupTable.twoargnumeric);resulttype=scf.LookupResultType(resulttype,seconds.type,scf.TypeLookupTable.twoargnumeric);if(resulttype.charAt(0)==\"n\"){result=(hours.value*60*60+minutes.value*60+seconds.value)/(24*60*60);resulttype=\"nt\";}scf.PushOperand(operand,resulttype,result);return;};SocialCalc.Formula.FunctionList[\"TIME\"]=[SocialCalc.Formula.TimeFunction,3,\"hms\",\"\",\"datetime\"];/*\n\t#\n\t# DAY(date)\n\t# MONTH(date)\n\t# YEAR(date)\n\t# WEEKDAY(date, [type])\n\t#\n\t*/SocialCalc.Formula.DMYFunctions=function(fname,operand,foperand,sheet){var ymd,dtype,doffset;var scf=SocialCalc.Formula;var result=0;var datevalue=scf.OperandAsNumber(sheet,foperand);var resulttype=scf.LookupResultType(datevalue.type,datevalue.type,scf.TypeLookupTable.oneargnumeric);if(resulttype.charAt(0)==\"n\"){ymd=SocialCalc.FormatNumber.convert_date_julian_to_gregorian(Math.floor(datevalue.value+SocialCalc.FormatNumber.datevalues.julian_offset));switch(fname){case\"DAY\":result=ymd.day;break;case\"MONTH\":result=ymd.month;break;case\"YEAR\":result=ymd.year;break;case\"WEEKDAY\":dtype={value:1};if(foperand.length){// get type if present\n\tdtype=scf.OperandAsNumber(sheet,foperand);if(dtype.type.charAt(0)!=\"n\"||dtype.value<1||dtype.value>3){scf.PushOperand(operand,\"e#VALUE!\",0);return;}if(foperand.length){// extra args\n\tscf.FunctionArgsError(fname,operand);return;}}doffset=6;if(dtype.value>1){doffset-=1;}result=Math.floor(datevalue.value+doffset)%7+(dtype.value<3?1:0);break;}}scf.PushOperand(operand,resulttype,result);return;};SocialCalc.Formula.FunctionList[\"DAY\"]=[SocialCalc.Formula.DMYFunctions,1,\"v\",\"\",\"datetime\"];SocialCalc.Formula.FunctionList[\"MONTH\"]=[SocialCalc.Formula.DMYFunctions,1,\"v\",\"\",\"datetime\"];SocialCalc.Formula.FunctionList[\"YEAR\"]=[SocialCalc.Formula.DMYFunctions,1,\"v\",\"\",\"datetime\"];SocialCalc.Formula.FunctionList[\"WEEKDAY\"]=[SocialCalc.Formula.DMYFunctions,-1,\"weekday\",\"\",\"datetime\"];/*\n\t#\n\t# HOUR(datetime)\n\t# MINUTE(datetime)\n\t# SECOND(datetime)\n\t#\n\t*/SocialCalc.Formula.HMSFunctions=function(fname,operand,foperand,sheet){var hours,minutes,seconds,fraction;var scf=SocialCalc.Formula;var result=0;var datetime=scf.OperandAsNumber(sheet,foperand);var resulttype=scf.LookupResultType(datetime.type,datetime.type,scf.TypeLookupTable.oneargnumeric);if(resulttype.charAt(0)==\"n\"){if(datetime.value<0){scf.PushOperand(operand,\"e#NUM!\",0);// must be non-negative\n\treturn;}fraction=datetime.value-Math.floor(datetime.value);// fraction of a day\n\tfraction*=24;hours=Math.floor(fraction);fraction-=Math.floor(fraction);fraction*=60;minutes=Math.floor(fraction);fraction-=Math.floor(fraction);fraction*=60;seconds=Math.floor(fraction+(datetime.value>=0?0.5:-0.5));if(fname==\"HOUR\"){result=hours;}else if(fname==\"MINUTE\"){result=minutes;}else if(fname==\"SECOND\"){result=seconds;}}scf.PushOperand(operand,resulttype,result);return;};SocialCalc.Formula.FunctionList[\"HOUR\"]=[SocialCalc.Formula.HMSFunctions,1,\"v\",\"\",\"datetime\"];SocialCalc.Formula.FunctionList[\"MINUTE\"]=[SocialCalc.Formula.HMSFunctions,1,\"v\",\"\",\"datetime\"];SocialCalc.Formula.FunctionList[\"SECOND\"]=[SocialCalc.Formula.HMSFunctions,1,\"v\",\"\",\"datetime\"];/*\n\t#\n\t# EXACT(v1,v2)\n\t#\n\t*/SocialCalc.Formula.ExactFunction=function(fname,operand,foperand,sheet){var scf=SocialCalc.Formula;var result=0;var resulttype=\"nl\";var value1=scf.OperandValueAndType(sheet,foperand);var v1type=value1.type.charAt(0);var value2=scf.OperandValueAndType(sheet,foperand);var v2type=value2.type.charAt(0);if(v1type==\"t\"){if(v2type==\"t\"){result=value1.value==value2.value?1:0;}else if(v2type==\"b\"){result=value1.value.length?0:1;}else if(v2type==\"n\"){result=value1.value==value2.value+\"\"?1:0;}else if(v2type==\"e\"){result=value2.value;resulttype=value2.type;}else{result=0;}}else if(v1type==\"n\"){if(v2type==\"n\"){result=value1.value-0==value2.value-0?1:0;}else if(v2type==\"b\"){result=0;}else if(v2type==\"t\"){result=value1.value+\"\"==value2.value?1:0;}else if(v2type==\"e\"){result=value2.value;resulttype=value2.type;}else{result=0;}}else if(v1type==\"b\"){if(v2type==\"t\"){result=value2.value.length?0:1;}else if(v2type==\"b\"){result=1;}else if(v2type==\"n\"){result=0;}else if(v2type==\"e\"){result=value2.value;resulttype=value2.type;}else{result=0;}}else if(v1type==\"e\"){result=value1.value;resulttype=value1.type;}scf.PushOperand(operand,resulttype,result);return;};SocialCalc.Formula.FunctionList[\"EXACT\"]=[SocialCalc.Formula.ExactFunction,2,\"\",\"\",\"text\"];/*\n\t#\n\t# FIND(key,string,[start])\n\t# LEFT(string,[length])\n\t# LEN(string)\n\t# LOWER(string)\n\t# MID(string,start,length)\n\t# PROPER(string)\n\t# REPLACE(string,start,length,new)\n\t# REPT(string,count)\n\t# RIGHT(string,[length])\n\t# SUBSTITUTE(string,old,new,[which])\n\t# TRIM(string)\n\t# UPPER(string)\n\t#\n\t*/// SocialCalc.Formula.ArgList has an array for each function, one entry for each possible arg (up to max).\n\t// Min args are specified in SocialCalc.Formula.FunctionList.\n\t// If array element is 1 then it's a text argument, if it's 0 then it's numeric, if -1 then just get whatever's there\n\t// Text values are manipulated as UTF-8, converting from and back to byte strings\n\tSocialCalc.Formula.ArgList={FIND:[1,1,0],LEFT:[1,0],LEN:[1],LOWER:[1],MID:[1,0,0],PROPER:[1],REPLACE:[1,0,0,1],REPT:[1,0],RIGHT:[1,0],SUBSTITUTE:[1,1,1,0],TRIM:[1],UPPER:[1]};SocialCalc.Formula.StringFunctions=function(fname,operand,foperand,sheet){var i,value,offset,len,start,count;var scf=SocialCalc.Formula;var result=0;var resulttype=\"e#VALUE!\";var numargs=foperand.length;var argdef=scf.ArgList[fname];var operand_value=[];var operand_type=[];for(i=1;i<=numargs;i++){// go through each arg, get value and type, and check for errors\n\tif(i>argdef.length){// too many args\n\tscf.FunctionArgsError(fname,operand);return;}if(argdef[i-1]==0){value=scf.OperandAsNumber(sheet,foperand);}else if(argdef[i-1]==1){value=scf.OperandAsText(sheet,foperand);}else if(argdef[i-1]==-1){value=scf.OperandValueAndType(sheet,foperand);}operand_value[i]=value.value;operand_type[i]=value.type;if(value.type.charAt(0)==\"e\"){scf.PushOperand(operand,value.type,result);return;}}switch(fname){case\"FIND\":offset=operand_type[3]?operand_value[3]-1:0;if(offset<0){result=\"Start is before string\";// !! not displayed, no need to translate\n\t}else{result=operand_value[2].indexOf(operand_value[1],offset);// (null string matches first char)\n\tif(result>=0){result+=1;resulttype=\"n\";}else{result=\"Not found\";// !! not displayed, error is e#VALUE!\n\t}}break;case\"LEFT\":len=operand_type[2]?operand_value[2]-0:1;if(len<0){result=\"Negative length\";}else{result=operand_value[1].substring(0,len);resulttype=\"t\";}break;case\"LEN\":result=operand_value[1].length;resulttype=\"n\";break;case\"LOWER\":result=operand_value[1].toLowerCase();resulttype=\"t\";break;case\"MID\":start=operand_value[2]-0;len=operand_value[3]-0;if(len<1||start<1){result=\"Bad arguments\";}else{result=operand_value[1].substring(start-1,start+len-1);resulttype=\"t\";}break;case\"PROPER\":result=operand_value[1].replace(/\\b\\w+\\b/g,function(word){return word.substring(0,1).toUpperCase()+word.substring(1);});// uppercase first character of words (see JavaScript, Flanagan, 5th edition, page 704)\n\tresulttype=\"t\";break;case\"REPLACE\":start=operand_value[2]-0;len=operand_value[3]-0;if(len<0||start<1){result=\"Bad arguments\";}else{result=operand_value[1].substring(0,start-1)+operand_value[4]+operand_value[1].substring(start-1+len);resulttype=\"t\";}break;case\"REPT\":count=operand_value[2]-0;if(count<0){result=\"Negative count\";}else{result=\"\";for(;count>0;count--){result+=operand_value[1];}resulttype=\"t\";}break;case\"RIGHT\":len=operand_type[2]?operand_value[2]-0:1;if(len<0){result=\"Negative length\";}else{result=operand_value[1].slice(-len);resulttype=\"t\";}break;case\"SUBSTITUTE\":fulltext=operand_value[1];oldtext=operand_value[2];newtext=operand_value[3];if(operand_value[4]!=null){which=operand_value[4]-0;if(which<=0){result=\"Non-positive instance number\";break;}}else{which=0;}count=0;oldpos=0;result=\"\";while(true){pos=fulltext.indexOf(oldtext,oldpos);if(pos>=0){count++;//!!!!!! old test just in case: if (count>1000) {alert(pos); break;}\n\tresult+=fulltext.substring(oldpos,pos);if(which==0){result+=newtext;// substitute\n\t}else if(which==count){result+=newtext+fulltext.substring(pos+oldtext.length);break;}else{result+=oldtext;// leave as was\n\t}oldpos=pos+oldtext.length;}else{// no more\n\tresult+=fulltext.substring(oldpos);break;}}resulttype=\"t\";break;case\"TRIM\":result=operand_value[1];result=result.replace(/^ */,\"\");result=result.replace(/ *$/,\"\");result=result.replace(/ +/g,\" \");resulttype=\"t\";break;case\"UPPER\":result=operand_value[1].toUpperCase();resulttype=\"t\";break;}scf.PushOperand(operand,resulttype,result);return;};SocialCalc.Formula.FunctionList[\"FIND\"]=[SocialCalc.Formula.StringFunctions,-2,\"find\",\"\",\"text\"];SocialCalc.Formula.FunctionList[\"LEFT\"]=[SocialCalc.Formula.StringFunctions,-2,\"tc\",\"\",\"text\"];SocialCalc.Formula.FunctionList[\"LEN\"]=[SocialCalc.Formula.StringFunctions,1,\"txt\",\"\",\"text\"];SocialCalc.Formula.FunctionList[\"LOWER\"]=[SocialCalc.Formula.StringFunctions,1,\"txt\",\"\",\"text\"];SocialCalc.Formula.FunctionList[\"MID\"]=[SocialCalc.Formula.StringFunctions,3,\"mid\",\"\",\"text\"];SocialCalc.Formula.FunctionList[\"PROPER\"]=[SocialCalc.Formula.StringFunctions,1,\"v\",\"\",\"text\"];SocialCalc.Formula.FunctionList[\"REPLACE\"]=[SocialCalc.Formula.StringFunctions,4,\"replace\",\"\",\"text\"];SocialCalc.Formula.FunctionList[\"REPT\"]=[SocialCalc.Formula.StringFunctions,2,\"tc\",\"\",\"text\"];SocialCalc.Formula.FunctionList[\"RIGHT\"]=[SocialCalc.Formula.StringFunctions,-1,\"tc\",\"\",\"text\"];SocialCalc.Formula.FunctionList[\"SUBSTITUTE\"]=[SocialCalc.Formula.StringFunctions,-3,\"subs\",\"\",\"text\"];SocialCalc.Formula.FunctionList[\"TRIM\"]=[SocialCalc.Formula.StringFunctions,1,\"v\",\"\",\"text\"];SocialCalc.Formula.FunctionList[\"UPPER\"]=[SocialCalc.Formula.StringFunctions,1,\"v\",\"\",\"text\"];/*\n\t#\n\t# is_functions:\n\t#\n\t# ISBLANK(value)\n\t# ISERR(value)\n\t# ISERROR(value)\n\t# ISLOGICAL(value)\n\t# ISNA(value)\n\t# ISNONTEXT(value)\n\t# ISNUMBER(value)\n\t# ISTEXT(value)\n\t#\n\t*/SocialCalc.Formula.IsFunctions=function(fname,operand,foperand,sheet){var scf=SocialCalc.Formula;var result=0;var resulttype=\"nl\";var value=scf.OperandValueAndType(sheet,foperand);var t=value.type.charAt(0);switch(fname){case\"ISBLANK\":result=value.type==\"b\"?1:0;break;case\"ISERR\":result=t==\"e\"?value.type==\"e#N/A\"?0:1:0;break;case\"ISERROR\":result=t==\"e\"?1:0;break;case\"ISLOGICAL\":result=value.type==\"nl\"?1:0;break;case\"ISNA\":result=value.type==\"e#N/A\"?1:0;break;case\"ISNONTEXT\":result=t==\"t\"?0:1;break;case\"ISNUMBER\":result=t==\"n\"?1:0;break;case\"ISTEXT\":result=t==\"t\"?1:0;break;}scf.PushOperand(operand,resulttype,result);return;};SocialCalc.Formula.FunctionList[\"ISBLANK\"]=[SocialCalc.Formula.IsFunctions,1,\"v\",\"\",\"test\"];SocialCalc.Formula.FunctionList[\"ISERR\"]=[SocialCalc.Formula.IsFunctions,1,\"v\",\"\",\"test\"];SocialCalc.Formula.FunctionList[\"ISERROR\"]=[SocialCalc.Formula.IsFunctions,1,\"v\",\"\",\"test\"];SocialCalc.Formula.FunctionList[\"ISLOGICAL\"]=[SocialCalc.Formula.IsFunctions,1,\"v\",\"\",\"test\"];SocialCalc.Formula.FunctionList[\"ISNA\"]=[SocialCalc.Formula.IsFunctions,1,\"v\",\"\",\"test\"];SocialCalc.Formula.FunctionList[\"ISNONTEXT\"]=[SocialCalc.Formula.IsFunctions,1,\"v\",\"\",\"test\"];SocialCalc.Formula.FunctionList[\"ISNUMBER\"]=[SocialCalc.Formula.IsFunctions,1,\"v\",\"\",\"test\"];SocialCalc.Formula.FunctionList[\"ISTEXT\"]=[SocialCalc.Formula.IsFunctions,1,\"v\",\"\",\"test\"];/*\n\t#\n\t# ntv_functions:\n\t#\n\t# N(value)\n\t# T(value)\n\t# VALUE(value)\n\t#\n\t*/SocialCalc.Formula.NTVFunctions=function(fname,operand,foperand,sheet){var scf=SocialCalc.Formula;var result=0;var resulttype=\"e#VALUE!\";var value=scf.OperandValueAndType(sheet,foperand);var t=value.type.charAt(0);switch(fname){case\"N\":result=t==\"n\"?value.value-0:0;resulttype=\"n\";break;case\"T\":result=t==\"t\"?value.value+\"\":\"\";resulttype=\"t\";break;case\"VALUE\":if(t==\"n\"||t==\"b\"){result=value.value||0;resulttype=\"n\";}else if(t==\"t\"){value=SocialCalc.DetermineValueType(value.value);if(value.type.charAt(0)!=\"n\"){result=0;resulttype=\"e#VALUE!\";}else{result=value.value-0;resulttype=\"n\";}}break;}if(t==\"e\"){// error trumps\n\tresulttype=value.type;}scf.PushOperand(operand,resulttype,result);return;};SocialCalc.Formula.FunctionList[\"N\"]=[SocialCalc.Formula.NTVFunctions,1,\"v\",\"\",\"math\"];SocialCalc.Formula.FunctionList[\"T\"]=[SocialCalc.Formula.NTVFunctions,1,\"v\",\"\",\"text\"];SocialCalc.Formula.FunctionList[\"VALUE\"]=[SocialCalc.Formula.NTVFunctions,1,\"v\",\"\",\"text\"];/*\n\t#\n\t# ABS(value)\n\t# ACOS(value)\n\t# ASIN(value)\n\t# ATAN(value)\n\t# COS(value)\n\t# DEGREES(value)\n\t# EVEN(value)\n\t# EXP(value)\n\t# FACT(value)\n\t# INT(value)\n\t# LN(value)\n\t# LOG10(value)\n\t# ODD(value)\n\t# RADIANS(value)\n\t# SIN(value)\n\t# SQRT(value)\n\t# TAN(value)\n\t#\n\t*/SocialCalc.Formula.Math1Functions=function(fname,operand,foperand,sheet){var v1,value,f;var result={};var scf=SocialCalc.Formula;v1=scf.OperandAsNumber(sheet,foperand);value=v1.value;result.type=scf.LookupResultType(v1.type,v1.type,scf.TypeLookupTable.oneargnumeric);if(result.type==\"n\"){switch(fname){case\"ABS\":value=Math.abs(value);break;case\"ACOS\":if(value>=-1&&value<=1){value=Math.acos(value);}else{result.type=\"e#NUM!\";}break;case\"ASIN\":if(value>=-1&&value<=1){value=Math.asin(value);}else{result.type=\"e#NUM!\";}break;case\"ATAN\":value=Math.atan(value);break;case\"COS\":value=Math.cos(value);break;case\"DEGREES\":value=value*180/Math.PI;break;case\"EVEN\":value=value<0?-value:value;if(value!=Math.floor(value)){value=Math.floor(value+1)+Math.floor(value+1)%2;}else{// integer\n\tvalue=value+value%2;}if(v1.value<0)value=-value;break;case\"EXP\":value=Math.exp(value);break;case\"FACT\":f=1;value=Math.floor(value);for(;value>0;value--){f*=value;}value=f;break;case\"INT\":value=Math.floor(value);// spreadsheet INT is floor(), not int()\n\tbreak;case\"LN\":if(value<=0){result.type=\"e#NUM!\";result.error=SocialCalc.Constants.s_sheetfunclnarg;}value=Math.log(value);break;case\"LOG10\":if(value<=0){result.type=\"e#NUM!\";result.error=SocialCalc.Constants.s_sheetfunclog10arg;}value=Math.log(value)/Math.log(10);break;case\"ODD\":value=value<0?-value:value;if(value!=Math.floor(value)){value=Math.floor(value+1)+(1-Math.floor(value+1)%2);}else{// integer\n\tvalue=value+(1-value%2);}if(v1.value<0)value=-value;break;case\"RADIANS\":value=value*Math.PI/180;break;case\"SIN\":value=Math.sin(value);break;case\"SQRT\":if(value>=0){value=Math.sqrt(value);}else{result.type=\"e#NUM!\";}break;case\"TAN\":if(Math.cos(value)!=0){value=Math.tan(value);}else{result.type=\"e#NUM!\";}break;}}result.value=value;operand.push(result);return null;};// Add to function list\n\tSocialCalc.Formula.FunctionList[\"ABS\"]=[SocialCalc.Formula.Math1Functions,1,\"v\",\"\",\"math\"];SocialCalc.Formula.FunctionList[\"ACOS\"]=[SocialCalc.Formula.Math1Functions,1,\"v\",\"\",\"math\"];SocialCalc.Formula.FunctionList[\"ASIN\"]=[SocialCalc.Formula.Math1Functions,1,\"v\",\"\",\"math\"];SocialCalc.Formula.FunctionList[\"ATAN\"]=[SocialCalc.Formula.Math1Functions,1,\"v\",\"\",\"math\"];SocialCalc.Formula.FunctionList[\"COS\"]=[SocialCalc.Formula.Math1Functions,1,\"v\",\"\",\"math\"];SocialCalc.Formula.FunctionList[\"DEGREES\"]=[SocialCalc.Formula.Math1Functions,1,\"v\",\"\",\"math\"];SocialCalc.Formula.FunctionList[\"EVEN\"]=[SocialCalc.Formula.Math1Functions,1,\"v\",\"\",\"math\"];SocialCalc.Formula.FunctionList[\"EXP\"]=[SocialCalc.Formula.Math1Functions,1,\"v\",\"\",\"math\"];SocialCalc.Formula.FunctionList[\"FACT\"]=[SocialCalc.Formula.Math1Functions,1,\"v\",\"\",\"math\"];SocialCalc.Formula.FunctionList[\"INT\"]=[SocialCalc.Formula.Math1Functions,1,\"v\",\"\",\"math\"];SocialCalc.Formula.FunctionList[\"LN\"]=[SocialCalc.Formula.Math1Functions,1,\"v\",\"\",\"math\"];SocialCalc.Formula.FunctionList[\"LOG10\"]=[SocialCalc.Formula.Math1Functions,1,\"v\",\"\",\"math\"];SocialCalc.Formula.FunctionList[\"ODD\"]=[SocialCalc.Formula.Math1Functions,1,\"v\",\"\",\"math\"];SocialCalc.Formula.FunctionList[\"RADIANS\"]=[SocialCalc.Formula.Math1Functions,1,\"v\",\"\",\"math\"];SocialCalc.Formula.FunctionList[\"SIN\"]=[SocialCalc.Formula.Math1Functions,1,\"v\",\"\",\"math\"];SocialCalc.Formula.FunctionList[\"SQRT\"]=[SocialCalc.Formula.Math1Functions,1,\"v\",\"\",\"math\"];SocialCalc.Formula.FunctionList[\"TAN\"]=[SocialCalc.Formula.Math1Functions,1,\"v\",\"\",\"math\"];/*\n\t#\n\t# ATAN2(x, y)\n\t# MOD(a, b)\n\t# POWER(a, b)\n\t# TRUNC(value, precision)\n\t#\n\t*/SocialCalc.Formula.Math2Functions=function(fname,operand,foperand,sheet){var xval,yval,value,quotient,decimalscale,i;var result={};var scf=SocialCalc.Formula;xval=scf.OperandAsNumber(sheet,foperand);yval=scf.OperandAsNumber(sheet,foperand);value=0;result.type=scf.LookupResultType(xval.type,yval.type,scf.TypeLookupTable.twoargnumeric);if(result.type==\"n\"){switch(fname){case\"ATAN2\":if(xval.value==0&&yval.value==0){result.type=\"e#DIV/0!\";}else{result.value=Math.atan2(yval.value,xval.value);}break;case\"POWER\":result.value=Math.pow(xval.value,yval.value);if(isNaN(result.value)){result.value=0;result.type=\"e#NUM!\";}break;case\"MOD\":// en.wikipedia.org/wiki/Modulo_operation, etc.\n\tif(yval.value==0){result.type=\"e#DIV/0!\";}else{quotient=xval.value/yval.value;quotient=Math.floor(quotient);result.value=xval.value-quotient*yval.value;}break;case\"TRUNC\":decimalscale=1;// cut down to required number of decimal digits\n\tif(yval.value>=0){yval.value=Math.floor(yval.value);for(i=0;i<yval.value;i++){decimalscale*=10;}result.value=Math.floor(Math.abs(xval.value)*decimalscale)/decimalscale;}else if(yval.value<0){yval.value=Math.floor(-yval.value);for(i=0;i<yval.value;i++){decimalscale*=10;}result.value=Math.floor(Math.abs(xval.value)/decimalscale)*decimalscale;}if(xval.value<0){result.value=-result.value;}}}operand.push(result);return null;};// Add to function list\n\tSocialCalc.Formula.FunctionList[\"ATAN2\"]=[SocialCalc.Formula.Math2Functions,2,\"xy\",\"\",\"math\"];SocialCalc.Formula.FunctionList[\"MOD\"]=[SocialCalc.Formula.Math2Functions,2,\"\",\"\",\"math\"];SocialCalc.Formula.FunctionList[\"POWER\"]=[SocialCalc.Formula.Math2Functions,2,\"\",\"\",\"math\"];SocialCalc.Formula.FunctionList[\"TRUNC\"]=[SocialCalc.Formula.Math2Functions,2,\"valpre\",\"\",\"math\"];/*\n\t#\n\t# LOG(value,[base])\n\t#\n\t*/SocialCalc.Formula.LogFunction=function(fname,operand,foperand,sheet){var value,value2;var result={};var scf=SocialCalc.Formula;result.value=0;value=scf.OperandAsNumber(sheet,foperand);result.type=scf.LookupResultType(value.type,value.type,scf.TypeLookupTable.oneargnumeric);if(foperand.length==1){value2=scf.OperandAsNumber(sheet,foperand);if(value2.type.charAt(0)!=\"n\"||value2.value<=0){scf.FunctionSpecificError(fname,operand,\"e#NUM!\",SocialCalc.Constants.s_sheetfunclogsecondarg);return 0;}}else if(foperand.length!=0){scf.FunctionArgsError(fname,operand);return 0;}else{value2={value:Math.E,type:\"n\"};}if(result.type==\"n\"){if(value.value<=0){scf.FunctionSpecificError(fname,operand,\"e#NUM!\",SocialCalc.Constants.s_sheetfunclogfirstarg);return 0;}result.value=Math.log(value.value)/Math.log(value2.value);}operand.push(result);return;};SocialCalc.Formula.FunctionList[\"LOG\"]=[SocialCalc.Formula.LogFunction,-1,\"log\",\"\",\"math\"];/*\n\t#\n\t# ROUND(value,[precision])\n\t#\n\t*/SocialCalc.Formula.RoundFunction=function(fname,operand,foperand,sheet){var value2,decimalscale,scaledvalue,i;var scf=SocialCalc.Formula;var result=0;var resulttype=\"e#VALUE!\";var value=scf.OperandValueAndType(sheet,foperand);var resulttype=scf.LookupResultType(value.type,value.type,scf.TypeLookupTable.oneargnumeric);if(foperand.length==1){value2=scf.OperandValueAndType(sheet,foperand);if(value2.type.charAt(0)!=\"n\"){scf.FunctionSpecificError(fname,operand,\"e#NUM!\",SocialCalc.Constants.s_sheetfuncroundsecondarg);return 0;}}else if(foperand.length!=0){scf.FunctionArgsError(fname,operand);return 0;}else{value2={value:0,type:\"n\"};// if no second arg, assume 0 for simple round\n\t}if(resulttype==\"n\"){value2.value=value2.value-0;if(value2.value==0){result=Math.round(value.value);}else if(value2.value>0){decimalscale=1;// cut down to required number of decimal digits\n\tvalue2.value=Math.floor(value2.value);for(i=0;i<value2.value;i++){decimalscale*=10;}scaledvalue=Math.round(value.value*decimalscale);result=scaledvalue/decimalscale;}else if(value2.value<0){decimalscale=1;// cut down to required number of decimal digits\n\tvalue2.value=Math.floor(-value2.value);for(i=0;i<value2.value;i++){decimalscale*=10;}scaledvalue=Math.round(value.value/decimalscale);result=scaledvalue*decimalscale;}}scf.PushOperand(operand,resulttype,result);return;};SocialCalc.Formula.FunctionList[\"ROUND\"]=[SocialCalc.Formula.RoundFunction,-1,\"vp\",\"\",\"math\"];/*\n\t#\n\t# AND(v1,c1:c2,...)\n\t# OR(v1,c1:c2,...)\n\t#\n\t*/SocialCalc.Formula.AndOrFunctions=function(fname,operand,foperand,sheet){var value1,result;var scf=SocialCalc.Formula;var resulttype=\"\";if(fname==\"AND\"){result=1;}else if(fname==\"OR\"){result=0;}while(foperand.length){value1=scf.OperandValueAndType(sheet,foperand);if(value1.type.charAt(0)==\"n\"){value1.value=value1.value-0;if(fname==\"AND\"){result=value1.value!=0?result:0;}else if(fname==\"OR\"){result=value1.value!=0?1:result;}resulttype=scf.LookupResultType(value1.type,resulttype||\"nl\",scf.TypeLookupTable.propagateerror);}else if(value1.type.charAt(0)==\"e\"&&resulttype.charAt(0)!=\"e\"){resulttype=value1.type;}}if(resulttype.length<1){resulttype=\"e#VALUE!\";result=0;}scf.PushOperand(operand,resulttype,result);return;};SocialCalc.Formula.FunctionList[\"AND\"]=[SocialCalc.Formula.AndOrFunctions,-1,\"vn\",\"\",\"test\"];SocialCalc.Formula.FunctionList[\"OR\"]=[SocialCalc.Formula.AndOrFunctions,-1,\"vn\",\"\",\"test\"];/*\n\t#\n\t# NOT(value)\n\t#\n\t*/SocialCalc.Formula.NotFunction=function(fname,operand,foperand,sheet){var result=0;var scf=SocialCalc.Formula;var value=scf.OperandValueAndType(sheet,foperand);var resulttype=scf.LookupResultType(value.type,value.type,scf.TypeLookupTable.propagateerror);if(value.type.charAt(0)==\"n\"||value.type==\"b\"){result=value.value-0!=0?0:1;// do the \"not\" operation\n\tresulttype=\"nl\";}else if(value.type.charAt(0)==\"t\"){resulttype=\"e#VALUE!\";}scf.PushOperand(operand,resulttype,result);return;};SocialCalc.Formula.FunctionList[\"NOT\"]=[SocialCalc.Formula.NotFunction,1,\"v\",\"\",\"test\"];/*\n\t#\n\t# CHOOSE(index,value1,value2,...)\n\t#\n\t*/SocialCalc.Formula.ChooseFunction=function(fname,operand,foperand,sheet){var resulttype,count,value1;var result=0;var scf=SocialCalc.Formula;var cindex=scf.OperandAsNumber(sheet,foperand);if(cindex.type.charAt(0)!=\"n\"){cindex.value=0;}cindex.value=Math.floor(cindex.value);count=0;while(foperand.length){value1=scf.TopOfStackValueAndType(sheet,foperand);count+=1;if(cindex.value==count){result=value1.value;resulttype=value1.type;break;}}if(resulttype){// found something\n\tscf.PushOperand(operand,resulttype,result);}else{scf.PushOperand(operand,\"e#VALUE!\",0);}return;};SocialCalc.Formula.FunctionList[\"CHOOSE\"]=[SocialCalc.Formula.ChooseFunction,-2,\"choose\",\"\",\"lookup\"];/*\n\t#\n\t# COLUMNS(c1:c2)\n\t# ROWS(c1:c2)\n\t#\n\t*/SocialCalc.Formula.ColumnsRowsFunctions=function(fname,operand,foperand,sheet){var resulttype,rangeinfo;var result=0;var scf=SocialCalc.Formula;var value1=scf.TopOfStackValueAndType(sheet,foperand);if(value1.type==\"coord\"){result=1;resulttype=\"n\";}else if(value1.type==\"range\"){rangeinfo=scf.DecodeRangeParts(sheet,value1.value);if(fname==\"COLUMNS\"){result=rangeinfo.ncols;}else if(fname==\"ROWS\"){result=rangeinfo.nrows;}resulttype=\"n\";}else{result=0;resulttype=\"e#VALUE!\";}scf.PushOperand(operand,resulttype,result);return;};SocialCalc.Formula.FunctionList[\"COLUMNS\"]=[SocialCalc.Formula.ColumnsRowsFunctions,1,\"range\",\"\",\"lookup\"];SocialCalc.Formula.FunctionList[\"ROWS\"]=[SocialCalc.Formula.ColumnsRowsFunctions,1,\"range\",\"\",\"lookup\"];/*\n\t#\n\t# FALSE()\n\t# NA()\n\t# NOW()\n\t# PI()\n\t# TODAY()\n\t# TRUE()\n\t#\n\t*/SocialCalc.Formula.ZeroArgFunctions=function(fname,operand,foperand,sheet){var startval,tzoffset,start_1_1_1970,seconds_in_a_day,nowdays;var result={value:0};switch(fname){case\"FALSE\":result.type=\"nl\";result.value=0;break;case\"NA\":result.type=\"e#N/A\";break;case\"NOW\":startval=new Date();tzoffset=startval.getTimezoneOffset();startval=startval.getTime()/1000;// convert to seconds\n\tstart_1_1_1970=25569;// Day number of 1/1/1970 starting with 1/1/1900 as 1\n\tseconds_in_a_day=24*60*60;nowdays=start_1_1_1970+startval/seconds_in_a_day-tzoffset/(24*60);result.value=nowdays;result.type=\"ndt\";SocialCalc.Formula.FreshnessInfo.volatile.NOW=true;// remember\n\tbreak;case\"PI\":result.type=\"n\";result.value=Math.PI;break;case\"TODAY\":startval=new Date();tzoffset=startval.getTimezoneOffset();startval=startval.getTime()/1000;// convert to seconds\n\tstart_1_1_1970=25569;// Day number of 1/1/1970 starting with 1/1/1900 as 1\n\tseconds_in_a_day=24*60*60;nowdays=start_1_1_1970+startval/seconds_in_a_day-tzoffset/(24*60);result.value=Math.floor(nowdays);result.type=\"nd\";SocialCalc.Formula.FreshnessInfo.volatile.TODAY=true;// remember\n\tbreak;case\"TRUE\":result.type=\"nl\";result.value=1;break;}operand.push(result);return null;};// Add to function list\n\tSocialCalc.Formula.FunctionList[\"FALSE\"]=[SocialCalc.Formula.ZeroArgFunctions,0,\"\",\"\",\"test\"];SocialCalc.Formula.FunctionList[\"NA\"]=[SocialCalc.Formula.ZeroArgFunctions,0,\"\",\"\",\"test\"];SocialCalc.Formula.FunctionList[\"NOW\"]=[SocialCalc.Formula.ZeroArgFunctions,0,\"\",\"\",\"datetime\"];SocialCalc.Formula.FunctionList[\"PI\"]=[SocialCalc.Formula.ZeroArgFunctions,0,\"\",\"\",\"math\"];SocialCalc.Formula.FunctionList[\"TODAY\"]=[SocialCalc.Formula.ZeroArgFunctions,0,\"\",\"\",\"datetime\"];SocialCalc.Formula.FunctionList[\"TRUE\"]=[SocialCalc.Formula.ZeroArgFunctions,0,\"\",\"\",\"test\"];//\n\t// * * * * * FINANCIAL FUNCTIONS * * * * *\n\t//\n\t/*\n\t#\n\t# DDB(cost,salvage,lifetime,period,[method])\n\t#\n\t# Depreciation, method defaults to 2 for double-declining balance\n\t# See: http://en.wikipedia.org/wiki/Depreciation\n\t#\n\t*/SocialCalc.Formula.DDBFunction=function(fname,operand,foperand,sheet){var method,depreciation,accumulateddepreciation,i;var scf=SocialCalc.Formula;var cost=scf.OperandAsNumber(sheet,foperand);var salvage=scf.OperandAsNumber(sheet,foperand);var lifetime=scf.OperandAsNumber(sheet,foperand);var period=scf.OperandAsNumber(sheet,foperand);if(scf.CheckForErrorValue(operand,cost))return;if(scf.CheckForErrorValue(operand,salvage))return;if(scf.CheckForErrorValue(operand,lifetime))return;if(scf.CheckForErrorValue(operand,period))return;if(lifetime.value<1){scf.FunctionSpecificError(fname,operand,\"e#NUM!\",SocialCalc.Constants.s_sheetfuncddblife);return 0;}method={value:2,type:\"n\"};if(foperand.length>0){method=scf.OperandAsNumber(sheet,foperand);}if(foperand.length!=0){scf.FunctionArgsError(fname,operand);return 0;}if(scf.CheckForErrorValue(operand,method))return;depreciation=0;// calculated for each period\n\taccumulateddepreciation=0;// accumulated by adding each period's\n\tfor(i=1;i<=period.value-0&&i<=lifetime.value;i++){// calculate for each period based on net from previous\n\tdepreciation=(cost.value-accumulateddepreciation)*(method.value/lifetime.value);if(cost.value-accumulateddepreciation-depreciation<salvage.value){// don't go lower than salvage value\n\tdepreciation=cost.value-accumulateddepreciation-salvage.value;}accumulateddepreciation+=depreciation;}scf.PushOperand(operand,'n$',depreciation);return;};SocialCalc.Formula.FunctionList[\"DDB\"]=[SocialCalc.Formula.DDBFunction,-4,\"ddb\",\"\",\"financial\"];/*\n\t#\n\t# SLN(cost,salvage,lifetime)\n\t#\n\t# Depreciation for each period by straight-line method\n\t# See: http://en.wikipedia.org/wiki/Depreciation\n\t#\n\t*/SocialCalc.Formula.SLNFunction=function(fname,operand,foperand,sheet){var depreciation;var scf=SocialCalc.Formula;var cost=scf.OperandAsNumber(sheet,foperand);var salvage=scf.OperandAsNumber(sheet,foperand);var lifetime=scf.OperandAsNumber(sheet,foperand);if(scf.CheckForErrorValue(operand,cost))return;if(scf.CheckForErrorValue(operand,salvage))return;if(scf.CheckForErrorValue(operand,lifetime))return;if(lifetime.value<1){scf.FunctionSpecificError(fname,operand,\"e#NUM!\",SocialCalc.Constants.s_sheetfuncslnlife);return 0;}depreciation=(cost.value-salvage.value)/lifetime.value;scf.PushOperand(operand,'n$',depreciation);return;};SocialCalc.Formula.FunctionList[\"SLN\"]=[SocialCalc.Formula.SLNFunction,3,\"csl\",\"\",\"financial\"];/*\n\t#\n\t# SYD(cost,salvage,lifetime,period)\n\t#\n\t# Depreciation by Sum of Year's Digits method\n\t#\n\t*/SocialCalc.Formula.SYDFunction=function(fname,operand,foperand,sheet){var depreciation,sumperiods;var scf=SocialCalc.Formula;var cost=scf.OperandAsNumber(sheet,foperand);var salvage=scf.OperandAsNumber(sheet,foperand);var lifetime=scf.OperandAsNumber(sheet,foperand);var period=scf.OperandAsNumber(sheet,foperand);if(scf.CheckForErrorValue(operand,cost))return;if(scf.CheckForErrorValue(operand,salvage))return;if(scf.CheckForErrorValue(operand,lifetime))return;if(scf.CheckForErrorValue(operand,period))return;if(lifetime.value<1||period.value<=0){scf.PushOperand(operand,\"e#NUM!\",0);return 0;}sumperiods=(lifetime.value+1)*lifetime.value/2;// add up 1 through lifetime\n\tdepreciation=(cost.value-salvage.value)*(lifetime.value-period.value+1)/sumperiods;// calc depreciation\n\tscf.PushOperand(operand,'n$',depreciation);return;};SocialCalc.Formula.FunctionList[\"SYD\"]=[SocialCalc.Formula.SYDFunction,4,\"cslp\",\"\",\"financial\"];/*\n\t#\n\t# FV(rate, n, payment, [pv, [paytype]])\n\t# NPER(rate, payment, pv, [fv, [paytype]])\n\t# PMT(rate, n, pv, [fv, [paytype]])\n\t# PV(rate, n, payment, [fv, [paytype]])\n\t# RATE(n, payment, pv, [fv, [paytype, [guess]]])\n\t#\n\t# Following the Open Document Format formula specification:\n\t#\n\t#    PV = - Fv - (Payment * Nper) [if rate equals 0]\n\t#    Pv*(1+Rate)^Nper + Payment * (1 + Rate*PaymentType) * ( (1+Rate)^nper -1)/Rate + Fv = 0\n\t#\n\t# For each function, the formulas are solved for the appropriate value (transformed using\n\t# basic algebra).\n\t#\n\t*/SocialCalc.Formula.InterestFunctions=function(fname,operand,foperand,sheet){var resulttype,result,dval,evalue,fval;var pv,fv,rate,n,payment,paytype,guess,part1,part2,part3,part4,part5;var olddelta,maxloop,tries,deltaepsilon,rate,oldrate,m;var scf=SocialCalc.Formula;var aval=scf.OperandAsNumber(sheet,foperand);var bval=scf.OperandAsNumber(sheet,foperand);var cval=scf.OperandAsNumber(sheet,foperand);resulttype=scf.LookupResultType(aval.type,bval.type,scf.TypeLookupTable.twoargnumeric);resulttype=scf.LookupResultType(resulttype,cval.type,scf.TypeLookupTable.twoargnumeric);if(foperand.length){// optional arguments\n\tdval=scf.OperandAsNumber(sheet,foperand);resulttype=scf.LookupResultType(resulttype,dval.type,scf.TypeLookupTable.twoargnumeric);if(foperand.length){// optional arguments\n\tevalue=scf.OperandAsNumber(sheet,foperand);resulttype=scf.LookupResultType(resulttype,evalue.type,scf.TypeLookupTable.twoargnumeric);if(foperand.length){// optional arguments\n\tif(fname!=\"RATE\"){// only rate has 6 possible args\n\tscf.FunctionArgsError(fname,operand);return 0;}fval=scf.OperandAsNumber(sheet,foperand);resulttype=scf.LookupResultType(resulttype,fval.type,scf.TypeLookupTable.twoargnumeric);}}}if(resulttype==\"n\"){switch(fname){case\"FV\":// FV(rate, n, payment, [pv, [paytype]])\n\trate=aval.value;n=bval.value;payment=cval.value;pv=dval!=null?dval.value:0;// get value if present, or use default\n\tpaytype=evalue!=null?evalue.value?1:0:0;if(rate==0){// simple calculation if no interest\n\tfv=-pv-payment*n;}else{fv=-(pv*Math.pow(1+rate,n)+payment*(1+rate*paytype)*(Math.pow(1+rate,n)-1)/rate);}result=fv;resulttype='n$';break;case\"NPER\":// NPER(rate, payment, pv, [fv, [paytype]])\n\trate=aval.value;payment=bval.value;pv=cval.value;fv=dval!=null?dval.value:0;paytype=evalue!=null?evalue.value?1:0:0;if(rate==0){// simple calculation if no interest\n\tif(payment==0){scf.PushOperand(operand,\"e#NUM!\",0);return;}n=(pv+fv)/-payment;}else{part1=payment*(1+rate*paytype)/rate;part2=pv+part1;if(part2==0||rate<=-1){scf.PushOperand(operand,\"e#NUM!\",0);return;}part3=(part1-fv)/part2;if(part3<=0){scf.PushOperand(operand,\"e#NUM!\",0);return;}part4=Math.log(part3);part5=Math.log(1+rate);// rate > -1\n\tn=part4/part5;}result=n;resulttype='n';break;case\"PMT\":// PMT(rate, n, pv, [fv, [paytype]])\n\trate=aval.value;n=bval.value;pv=cval.value;fv=dval!=null?dval.value:0;paytype=evalue!=null?evalue.value?1:0:0;if(n==0){scf.PushOperand(operand,\"e#NUM!\",0);return;}else if(rate==0){// simple calculation if no interest\n\tpayment=(fv-pv)/n;}else{payment=(0-fv-pv*Math.pow(1+rate,n))/((1+rate*paytype)*(Math.pow(1+rate,n)-1)/rate);}result=payment;resulttype='n$';break;case\"PV\":// PV(rate, n, payment, [fv, [paytype]])\n\trate=aval.value;n=bval.value;payment=cval.value;fv=dval!=null?dval.value:0;paytype=evalue!=null?eval.value?1:0:0;if(rate==-1){scf.PushOperand(operand,\"e#DIV/0!\",0);return;}else if(rate==0){// simple calculation if no interest\n\tpv=-fv-payment*n;}else{pv=(-fv-payment*(1+rate*paytype)*(Math.pow(1+rate,n)-1)/rate)/Math.pow(1+rate,n);}result=pv;resulttype='n$';break;case\"RATE\":// RATE(n, payment, pv, [fv, [paytype, [guess]]])\n\tn=aval.value;payment=bval.value;pv=cval.value;fv=dval!=null?dval.value:0;paytype=evalue!=null?evalue.value?1:0:0;guess=fval!=null?fval.value:0.1;// rate is calculated by repeated approximations\n\t// The deltas are used to calculate new guesses\n\tmaxloop=100;tries=0;delta=1;epsilon=0.0000001;// this is close enough\n\trate=guess||0.00000001;// zero is not allowed\n\twhile((delta>=0?delta:-delta)>epsilon&&rate!=oldrate){delta=fv+pv*Math.pow(1+rate,n)+payment*(1+rate*paytype)*(Math.pow(1+rate,n)-1)/rate;if(olddelta!=null){m=(delta-olddelta)/(rate-oldrate)||.001;// get slope (not zero)\n\toldrate=rate;rate=rate-delta/m;// look for zero crossing\n\tolddelta=delta;}else{// first time - no old values\n\toldrate=rate;rate=1.1*rate;olddelta=delta;}tries++;if(tries>=maxloop){// didn't converge yet\n\tscf.PushOperand(operand,\"e#NUM!\",0);return;}}result=rate;resulttype='n%';break;}}scf.PushOperand(operand,resulttype,result);return;};SocialCalc.Formula.FunctionList[\"FV\"]=[SocialCalc.Formula.InterestFunctions,-3,\"fv\",\"\",\"financial\"];SocialCalc.Formula.FunctionList[\"NPER\"]=[SocialCalc.Formula.InterestFunctions,-3,\"nper\",\"\",\"financial\"];SocialCalc.Formula.FunctionList[\"PMT\"]=[SocialCalc.Formula.InterestFunctions,-3,\"pmt\",\"\",\"financial\"];SocialCalc.Formula.FunctionList[\"PV\"]=[SocialCalc.Formula.InterestFunctions,-3,\"pv\",\"\",\"financial\"];SocialCalc.Formula.FunctionList[\"RATE\"]=[SocialCalc.Formula.InterestFunctions,-3,\"rate\",\"\",\"financial\"];/*\n\t#\n\t# NPV(rate,v1,v2,c1:c2,...)\n\t#\n\t*/SocialCalc.Formula.NPVFunction=function(fname,operand,foperand,sheet){var resulttypenpv,rate,sum,factor,value1;var scf=SocialCalc.Formula;var rate=scf.OperandAsNumber(sheet,foperand);if(scf.CheckForErrorValue(operand,rate))return;sum=0;resulttypenpv=\"n\";factor=1;while(foperand.length){value1=scf.OperandValueAndType(sheet,foperand);if(value1.type.charAt(0)==\"n\"){factor*=1+rate.value;if(factor==0){scf.PushOperand(operand,\"e#DIV/0!\",0);return;}sum+=value1.value/factor;resulttypenpv=scf.LookupResultType(value1.type,resulttypenpv||value1.type,scf.TypeLookupTable.plus);}else if(value1.type.charAt(0)==\"e\"&&resulttypenpv.charAt(0)!=\"e\"){resulttypenpv=value1.type;break;}}if(resulttypenpv.charAt(0)==\"n\"){resulttypenpv='n$';}scf.PushOperand(operand,resulttypenpv,sum);return;};SocialCalc.Formula.FunctionList[\"NPV\"]=[SocialCalc.Formula.NPVFunction,-2,\"npv\",\"\",\"financial\"];/*\n\t#\n\t# IRR(c1:c2,[guess])\n\t#\n\t*/SocialCalc.Formula.IRRFunction=function(fname,operand,foperand,sheet){var value1,guess,oldsum,maxloop,tries,epsilon,rate,oldrate,m,sum,factor,i;var rangeoperand=[];var cashflows=[];var scf=SocialCalc.Formula;rangeoperand.push(foperand.pop());// first operand is a range\n\twhile(rangeoperand.length){// get values from range so we can do iterative approximations\n\tvalue1=scf.OperandValueAndType(sheet,rangeoperand);if(value1.type.charAt(0)==\"n\"){cashflows.push(value1.value);}else if(value1.type.charAt(0)==\"e\"){scf.PushOperand(operand,\"e#VALUE!\",0);return;}}if(!cashflows.length){scf.PushOperand(operand,\"e#NUM!\",0);return;}guess={value:0};if(foperand.length){// guess is provided\n\tguess=scf.OperandAsNumber(sheet,foperand);if(guess.type.charAt(0)!=\"n\"&&guess.type.charAt(0)!=\"b\"){scf.PushOperand(operand,\"e#VALUE!\",0);return;}if(foperand.length){// should be no more args\n\tscf.FunctionArgsError(fname,operand);return;}}guess.value=guess.value||0.1;// rate is calculated by repeated approximations\n\t// The deltas are used to calculate new guesses\n\tmaxloop=20;tries=0;epsilon=0.0000001;// this is close enough\n\trate=guess.value;sum=1;while((sum>=0?sum:-sum)>epsilon&&rate!=oldrate){sum=0;factor=1;for(i=0;i<cashflows.length;i++){factor*=1+rate;if(factor==0){scf.PushOperand(operand,\"e#DIV/0!\",0);return;}sum+=cashflows[i]/factor;}if(oldsum!=null){m=(sum-oldsum)/(rate-oldrate);// get slope\n\toldrate=rate;rate=rate-sum/m;// look for zero crossing\n\toldsum=sum;}else{// first time - no old values\n\toldrate=rate;rate=1.1*rate;oldsum=sum;}tries++;if(tries>=maxloop){// didn't converge yet\n\tscf.PushOperand(operand,\"e#NUM!\",0);return;}}scf.PushOperand(operand,'n%',rate);return;};SocialCalc.Formula.FunctionList[\"IRR\"]=[SocialCalc.Formula.IRRFunction,-1,\"irr\",\"\",\"financial\"];//\n\t// SHEET CACHE\n\t//\n\tSocialCalc.Formula.SheetCache={// Sheet data: Attributes are each sheet in the cache with values of an object with:\n\t//\n\t//    sheet: sheet-obj (or null, meaning not found)\n\t//    recalcstate: constants.asloaded = as loaded\n\t//                 constants.recalcing = being recalced now\n\t//                 constants.recalcdone = recalc done\n\t//    name: name of sheet (in case just have object and don't know name)\n\t//\n\tsheets:{},// Waiting for loading:\n\t// If sheet is not in cache, this is set to the sheetname being loaded\n\t// so it can be tested in the recalc loop to start load and then wait until restarted.\n\t// Reset to null before restarting.\n\twaitingForLoading:null,// Constants to use for setting sheets[*].recalcstate:\n\tconstants:{asloaded:0,recalcing:1,recalcdone:2},loadsheet:null// (deprecated - use SocialCalc.RecalcInfo.LoadSheet)\n\t};//\n\t// othersheet = SocialCalc.Formula.FindInSheetCache(sheetname)\n\t//\n\t// Returns a SocialCalc.Sheet object corresponding to string sheetname\n\t// or null if the sheet is not available or in error.\n\t//\n\t// Each sheet is loaded only once and then stored in a cache.\n\t// Loading is handled elsewhere, e.g., in the recalc loop.\n\t//\n\tSocialCalc.Formula.FindInSheetCache=function(sheetname){var str;var sfsc=SocialCalc.Formula.SheetCache;var nsheetname=SocialCalc.Formula.NormalizeSheetName(sheetname);// normalize different versions\n\tif(sfsc.sheets[nsheetname]){// a sheet by that name is in the cache already\n\treturn sfsc.sheets[nsheetname].sheet;// return it\n\t}if(sfsc.waitingForLoading){// waiting already - only queue up one\n\treturn null;// return not found\n\t}sfsc.waitingForLoading=nsheetname;// let recalc loop know that we have a sheet to load\n\treturn null;// return not found\n\t};//\n\t// newsheet = SocialCalc.Formula.AddSheetToCache(sheetname, str)\n\t//\n\t// Adds a new sheet to the sheet cache.\n\t// Returns the sheet object filled out with the str (a saved sheet).\n\t//\n\tSocialCalc.Formula.AddSheetToCache=function(sheetname,str){var newsheet=null;var sfsc=SocialCalc.Formula.SheetCache;var sfscc=sfsc.constants;var newsheetname=SocialCalc.Formula.NormalizeSheetName(sheetname);if(str){newsheet=new SocialCalc.Sheet();newsheet.ParseSheetSave(str);}sfsc.sheets[newsheetname]={sheet:newsheet,recalcstate:sfscc.asloaded,name:newsheetname};SocialCalc.Formula.FreshnessInfo.sheets[newsheetname]=true;return newsheet;};//\n\t// nsheet = SocialCalc.Formula.NormalizeSheetName(sheetname)\n\t//\n\tSocialCalc.Formula.NormalizeSheetName=function(sheetname){if(SocialCalc.Callbacks.NormalizeSheetName){return SocialCalc.Callbacks.NormalizeSheetName(sheetname);}else{return sheetname.toLowerCase();}};//\n\t// REMOTE FUNCTION INFO\n\t//\n\tSocialCalc.Formula.RemoteFunctionInfo={// Waiting for server:\n\t// If waiting for an XHR response from the server, this is set to some non-blank status text\n\t// so it can be tested in the recalc loop to start load and then wait until restarted.\n\t// Reset to null before restarting.\n\twaitingForServer:null};//\n\t// FRESHNESS INFO\n\t//\n\t// This information is generated during recalc.\n\t// It may be used to help determine when the recalc data in a spreadsheet\n\t// may be out of date.\n\t// For example, it may be used to display a message like:\n\t// \"Dependent on sheet 'FOO' which was updated more recently than this printout\"\n\tSocialCalc.Formula.FreshnessInfo={// For each external sheet referenced successfully an attribute of that name with value true.\n\tsheets:{},// For each volatile function that is called an attribute of that name with value true.\n\tvolatile:{},// Set to false when started and true when recalc completes\n\trecalc_completed:false};SocialCalc.Formula.FreshnessInfoReset=function(){var scffi=SocialCalc.Formula.FreshnessInfo;scffi.sheets={};scffi.volatile={};scffi.recalc_completed=false;};//\n\t// MISC ROUTINES\n\t//\n\t//\n\t// result = SocialCalc.Formula.PlainCoord(coord)\n\t//\n\t// Returns: coord without any $'s\n\t//\n\tSocialCalc.Formula.PlainCoord=function(coord){if(coord.indexOf(\"$\")==-1)return coord;return coord.replace(/\\$/g,\"\");// remove any $'s\n\t};//\n\t// result = SocialCalc.Formula.OrderRangeParts(coord1, coord2)\n\t//\n\t// Returns: {c1: col, r1: row, c2: col, r2 = row} with c1/r1 upper left\n\t//\n\tSocialCalc.Formula.OrderRangeParts=function(coord1,coord2){var cr1,cr2;var result={};cr1=SocialCalc.coordToCr(coord1);cr2=SocialCalc.coordToCr(coord2);if(cr1.col>cr2.col){result.c1=cr2.col;result.c2=cr1.col;}else{result.c1=cr1.col;result.c2=cr2.col;}if(cr1.row>cr2.row){result.r1=cr2.row;result.r2=cr1.row;}else{result.r1=cr1.row;result.r2=cr2.row;}return result;};//\n\t// cond = SocialCalc.Formula.TestCriteria(value, type, criteria)\n\t//\n\t// Determines whether a value/type meets the criteria.\n\t// A criteria can be a numeric value, text beginning with <, <=, =, >=, >, <>, text by itself is start of text to match.\n\t// Used by a variety of functions, including the \"D\" functions (DSUM, etc.).\n\t//\n\t// Returns true or false\n\t//\n\tSocialCalc.Formula.TestCriteria=function(value,type,criteria){var comparitor,basestring,basevalue,cond,testvalue;if(criteria==null){// undefined (e.g., error value) is always false\n\treturn false;}criteria=criteria+\"\";comparitor=criteria.charAt(0);// look for comparitor\n\tif(comparitor==\"=\"||comparitor==\"<\"||comparitor==\">\"){basestring=criteria.substring(1);}else{comparitor=criteria.substring(0,2);if(comparitor==\"<=\"||comparitor==\"<>\"||comparitor==\">=\"){basestring=criteria.substring(2);}else{comparitor=\"none\";basestring=criteria;}}basevalue=SocialCalc.DetermineValueType(basestring);// get type of value being compared\n\tif(!basevalue.type){// no criteria base value given\n\tif(comparitor==\"none\"){// blank criteria matches nothing\n\treturn false;}if(type.charAt(0)==\"b\"){// comparing to empty cell\n\tif(comparitor==\"=\"){// empty equals empty\n\treturn true;}}else{if(comparitor==\"<>\"){// \"something\" does not equal empty\n\treturn true;}}return false;// otherwise false\n\t}cond=false;if(basevalue.type.charAt(0)==\"n\"&&type.charAt(0)==\"t\"){// criteria is number, but value is text\n\ttestvalue=SocialCalc.DetermineValueType(value);if(testvalue.type.charAt(0)==\"n\"){// could be number - make it one\n\tvalue=testvalue.value;type=testvalue.type;}}if(type.charAt(0)==\"n\"&&basevalue.type.charAt(0)==\"n\"){// compare two numbers\n\tvalue=value-0;// make sure numbers\n\tbasevalue.value=basevalue.value-0;switch(comparitor){case\"<\":cond=value<basevalue.value;break;case\"<=\":cond=value<=basevalue.value;break;case\"=\":case\"none\":cond=value==basevalue.value;break;case\">=\":cond=value>=basevalue.value;break;case\">\":cond=value>basevalue.value;break;case\"<>\":cond=value!=basevalue.value;break;}}else if(type.charAt(0)==\"e\"){// error on left\n\tcond=false;}else if(basevalue.type.charAt(0)==\"e\"){// error on right\n\tcond=false;}else{// text, maybe mixed with number or blank\n\tif(type.charAt(0)==\"n\"){value=SocialCalc.format_number_for_display(value,\"n\",\"\");}if(basevalue.type.charAt(0)==\"n\"){return false;// if number and didn't match already, isn't a match\n\t}value=value?value.toLowerCase():\"\";basevalue.value=basevalue.value?basevalue.value.toLowerCase():\"\";switch(comparitor){case\"<\":cond=value<basevalue.value;break;case\"<=\":cond=value<=basevalue.value;break;case\"=\":cond=value==basevalue.value;break;case\"none\":cond=value.substring(0,basevalue.value.length)==basevalue.value;break;case\">=\":cond=value>=basevalue.value;break;case\">\":cond=value>basevalue.value;break;case\"<>\":cond=value!=basevalue.value;break;}}return cond;};//\n\t/*\n\t// The module of the SocialCalc package for the optional popup menus in socialcalcspreadsheetcontrol.js\n\t//\n\t// (c) Copyright 2009 Socialtext, Inc.\n\t// All Rights Reserved.\n\t//\n\t// The contents of this file are subject to the Artistic License 2.0; you may not\n\t// use this file except in compliance with the License. You may obtain a copy of \n\t// the License at http://socialcalc.org/licenses/al-20/.\n\t//\n\t// Some of the other files in the SocialCalc package are licensed under\n\t// different licenses. Please note the licenses of the modules you use.\n\t//\n\t// Code History:\n\t//\n\t// Initially coded by Dan Bricklin of Software Garden, Inc., for Socialtext, Inc.\n\t//\n\t*/var SocialCalc;// All values are stored in the master SocialCalc object\n\tif(!SocialCalc){SocialCalc={};}// The main Popup data -- there is only one set\n\tSocialCalc.Popup={};// Routines and values for each type of control, indexed by type name\n\t// The value for each is an object constructed as follows:\n\t//\n\t//    Create = function(type, id, attribs)\n\t//    Initialize = function(type, id, data)\n\t//    SetValue = function(type, id, value)\n\t//    GetValue = function(type, id) returns value\n\t//    SetDisabled = function(type, id, t/f)\n\t//    Show = function(type, id)\n\t//    Hide = function(type, id)\n\t//    Cancel = function(type, id)\n\t//    Reset = function(type)\n\t//\n\t//    data = object to hold type-specific data\n\t//\n\tSocialCalc.Popup.Types={};// Definitions for each individual control, indexed by id\n\t// The value for each is an object constructed as follows:\n\t//\n\t//    type: type name of the control\n\t//    value: current value of the control (usually a string, but can depend on type)\n\t//    data: object with type-specific items\n\t//\n\tSocialCalc.Popup.Controls={};// System-wide values of currently active control\n\t//\n\t//    id: id of current control or null\n\t//\n\tSocialCalc.Popup.Current={};// Other values used by the Popup system\n\t//\n\tSocialCalc.Popup.imagePrefix=\"www/assets/images/sc_\";// image prefix\n\t// Override this for localization\n\tSocialCalc.Popup.LocalizeString=function(str){return str;};// * * * * * * * * * * * * * * * *\n\t//\n\t// GENERAL ROUTINES\n\t//\n\t// * * * * * * * * * * * * * * * *\n\t//\n\t// SocialCalc.Popup.Create(type, id, attribs)\n\t//\n\t// Creates a control of type \"type\" as the children of document element \"id\" using \"attribs\"\n\t//\n\tSocialCalc.Popup.Create=function(type,id,attribs){var pt=SocialCalc.Popup.Types[type];if(pt&&pt.Create){pt.Create(type,id,attribs);}};//\n\t// SocialCalc.Popup.SetValue(id, value)\n\t//\n\t// Sets the value of control.\n\t//\n\tSocialCalc.Popup.SetValue=function(id,value){var sp=SocialCalc.Popup;var spt=sp.Types;var spc=sp.Controls;if(!spc[id]){alert(\"Unknown control \"+id);return;}var type=spc[id].type;var pt=spt[type];var spcdata=spc[id].data;if(pt&&pt.Create){pt.SetValue(type,id,value);if(spcdata.attribs&&spcdata.attribs.changedcallback){spcdata.attribs.changedcallback(spcdata.attribs,id,value);}}};//\n\t// SocialCalc.Popup.SetDisabled(id, disabled)\n\t//\n\t// Sets whether the control is disabled (true) or not (false).\n\t//\n\tSocialCalc.Popup.SetDisabled=function(id,disabled){var sp=SocialCalc.Popup;var spt=sp.Types;var spc=sp.Controls;if(!spc[id]){alert(\"Unknown control \"+id);return;}var type=spc[id].type;var pt=spt[type];if(pt&&pt.Create){if(sp.Current.id&&id==sp.Current.id){pt.Hide(type,sp.Current.id);sp.Current.id=null;}pt.SetDisabled(type,id,disabled);}};//\n\t// SocialCalc.Popup.GetValue(id)\n\t//\n\t// Returns the value of control.\n\t//\n\tSocialCalc.Popup.GetValue=function(id){var sp=SocialCalc.Popup;var spt=sp.Types;var spc=sp.Controls;if(!spc[id]){alert(\"Unknown control \"+id);return;}var type=spc[id].type;var pt=spt[type];if(pt&&pt.Create){return pt.GetValue(type,id);}return null;};//\n\t// SocialCalc.Popup.Initialize(id, data)\n\t//\n\t// Gives \"data\" to the appropriate initialization code.\n\t//\n\tSocialCalc.Popup.Initialize=function(id,data){var sp=SocialCalc.Popup;var spt=sp.Types;var spc=sp.Controls;if(!spc[id]){alert(\"Unknown control \"+id);return;}var type=spc[id].type;var pt=spt[type];if(pt&&pt.Initialize){pt.Initialize(type,id,data);}};//\n\t// SocialCalc.Popup.Reset(type)\n\t//\n\t// Resets Popup, such as when turning to page.\n\t//\n\tSocialCalc.Popup.Reset=function(type){var sp=SocialCalc.Popup;var spt=sp.Types;var spc=sp.Controls;if(spt[type].Reset)spt[type].Reset(type);};//\n\t// SocialCalc.Popup.CClick(id)\n\t//\n\t// Should be called when the user clicks on a control to do the popup\n\t//\n\tSocialCalc.Popup.CClick=function(id){var sp=SocialCalc.Popup;var spt=sp.Types;var spc=sp.Controls;if(!spc[id]){alert(\"Unknown control \"+id);return;}if(spc[id].data&&spc[id].data.disabled)return;var type=spc[id].type;var pt=spt[type];if(sp.Current.id){spt[spc[sp.Current.id].type].Hide(type,sp.Current.id);if(id==sp.Current.id){// same one - done\n\tsp.Current.id=null;return;}}if(pt&&pt.Show){pt.Show(type,id);}sp.Current.id=id;};//\n\t// SocialCalc.Popup.Close()\n\t//\n\t// Used to close any open popup.\n\t//\n\tSocialCalc.Popup.Close=function(){var sp=SocialCalc.Popup;var spt=sp.Types;var spc=sp.Controls;if(!sp.Current.id)return;sp.CClick(sp.Current.id);};//\n\t// SocialCalc.Popup.Cancel()\n\t//\n\t// Closes Popup and restores old value\n\t//\n\tSocialCalc.Popup.Cancel=function(){var sp=SocialCalc.Popup;var spt=sp.Types;var spc=sp.Controls;if(!sp.Current.id)return;var type=spc[sp.Current.id].type;var pt=spt[type];pt.Cancel(type,sp.Current.id);sp.Current.id=null;};//\n\t// ele = SocialCalc.Popup.CreatePopupDiv(id, attribs)\n\t//\n\t// Utility function to create the main popup div of width attribs.width.\n\t// If attribs.title, create one with that text, and optionally attribs.moveable.\n\t//\n\tSocialCalc.Popup.CreatePopupDiv=function(id,attribs){var pos,ele;var sp=SocialCalc.Popup;var spc=sp.Controls;var spcdata=spc[id].data;var main=document.createElement(\"div\");main.style.position=\"absolute\";pos=SocialCalc.GetElementPositionWithScroll(spcdata.mainele);main.style.top=pos.top+spcdata.mainele.offsetHeight+\"px\";main.style.left=pos.left+\"px\";main.style.zIndex=100;main.style.backgroundColor=\"#FFF\";main.style.border=\"1px solid black\";if(attribs.width){main.style.width=attribs.width;}spcdata.mainele.appendChild(main);if(attribs.title){main.innerHTML='<table cellspacing=\"0\" cellpadding=\"0\" style=\"border-bottom:1px solid black;\"><tr>'+'<td style=\"font-size:10px;cursor:default;width:100%;background-color:#999;color:#FFF;\">'+attribs.title+'</td>'+'<td style=\"font-size:10px;cursor:default;color:#666;\" onclick=\"SocialCalc.Popup.Cancel();\">&nbsp;X&nbsp;</td></tr></table>';if(attribs.moveable){spcdata.dragregistered=main.firstChild.firstChild.firstChild.firstChild;SocialCalc.DragRegister(spcdata.dragregistered,true,true,{MouseDown:SocialCalc.DragFunctionStart,MouseMove:SocialCalc.DragFunctionPosition,MouseUp:SocialCalc.DragFunctionPosition,Disabled:null,positionobj:main});}}return main;};//\n\t// SocialCalc.Popup.EnsurePosition(id, container)\n\t//\n\t// Utility function to make sure popup is positioned completely within container (both element objects)\n\t// and appropriate with respect to the main element controlling the popup.\n\t//\n\tSocialCalc.Popup.EnsurePosition=function(id,container){var sp=SocialCalc.Popup;var spc=sp.Controls;var spcdata=spc[id].data;var main=spcdata.mainele.firstChild;if(!main){alert(\"No main popup element firstChild.\");return;};var popup=spcdata.popupele;function GetLayoutValues(ele){var r=SocialCalc.GetElementPositionWithScroll(ele);r.height=ele.offsetHeight;r.width=ele.offsetWidth;r.bottom=r.top+r.height;r.right=r.left+r.width;return r;}var p=GetLayoutValues(popup);var c=GetLayoutValues(container);var m=GetLayoutValues(main);var t=0;// type of placement\n\t//addmsg(\"popup t/r/b/l/h/w= \"+p.top+\"/\"+p.right+\"/\"+p.bottom+\"/\"+p.left+\"/\"+p.height+\"/\"+p.width);\n\t//addmsg(\"container t/r/b/l/h/w= \"+c.top+\"/\"+c.right+\"/\"+c.bottom+\"/\"+c.left+\"/\"+c.height+\"/\"+c.width);\n\t//addmsg(\"main t/r/b/l/h/w= \"+m.top+\"/\"+m.right+\"/\"+m.bottom+\"/\"+m.left+\"/\"+m.height+\"/\"+m.width);\n\t// Check various layout cases in priority order\n\tif(m.bottom+p.height<c.bottom&&m.left+p.width<c.right){// normal case: room on bottom and right\n\tpopup.style.top=m.bottom+\"px\";popup.style.left=m.left+\"px\";t=1;}else if(m.top-p.height>c.top&&m.left+p.width<c.right){// room on top and right\n\tpopup.style.top=m.top-p.height+\"px\";popup.style.left=m.left+\"px\";t=2;}else if(m.bottom+p.height<c.bottom&&m.right-p.width>c.left){// room on bottom and left\n\tpopup.style.top=m.bottom+\"px\";popup.style.left=m.right-p.width+\"px\";t=3;}else if(m.top-p.height>c.top&&m.right-p.width>c.left){// room on top and left\n\tpopup.style.top=m.top-p.height+\"px\";popup.style.left=m.right-p.width+\"px\";t=4;}else if(m.bottom+p.height<c.bottom&&p.width<c.width){// room on bottom and middle\n\tpopup.style.top=m.bottom+\"px\";popup.style.left=c.left+Math.floor((c.width-p.width)/2)+\"px\";t=5;}else if(m.top-p.height>c.top&&p.width<c.width){// room on top and middle\n\tpopup.style.top=m.top-p.height+\"px\";popup.style.left=c.left+Math.floor((c.width-p.width)/2)+\"px\";t=6;}else if(p.height<c.height&&m.right+p.width<c.right){// room on middle and right\n\tpopup.style.top=c.top+Math.floor((c.height-p.height)/2)+\"px\";popup.style.left=m.right+\"px\";t=7;}else if(p.height<c.height&&m.left-p.width>c.left){// room on middle and left\n\tpopup.style.top=c.top+Math.floor((c.height-p.height)/2)+\"px\";popup.style.left=m.left-p.width+\"px\";t=8;}else{}// nothing works, so leave as it is\n\t//addmsg(\"Popup layout \"+t);\n\t};//\n\t// ele = SocialCalc.Popup.DestroyPopupDiv(ele, dragregistered)\n\t//\n\t// Utility function to get rid of the main popup div.\n\t//\n\tSocialCalc.Popup.DestroyPopupDiv=function(ele,dragregistered){if(!ele)return;ele.innerHTML=\"\";SocialCalc.DragUnregister(dragregistered);// OK to do this even if not registered\n\tif(ele.parentNode){ele.parentNode.removeChild(ele);}};//\n\t// Color Utility Functions\n\t//\n\tSocialCalc.Popup.RGBToHex=function(val){var sp=SocialCalc.Popup;if(val==\"\"){return\"000000\";}var rgbvals=val.match(/(\\d+)\\D+(\\d+)\\D+(\\d+)/);if(rgbvals){return sp.ToHex(rgbvals[1])+sp.ToHex(rgbvals[2])+sp.ToHex(rgbvals[3]);}else{return\"000000\";}};SocialCalc.Popup.HexDigits=\"0123456789ABCDEF\";SocialCalc.Popup.ToHex=function(num){var sp=SocialCalc.Popup;var first=Math.floor(num/16);var second=num%16;return sp.HexDigits.charAt(first)+sp.HexDigits.charAt(second);};SocialCalc.Popup.FromHex=function(str){var sp=SocialCalc.Popup;var first=sp.HexDigits.indexOf(str.charAt(0).toUpperCase());var second=sp.HexDigits.indexOf(str.charAt(1).toUpperCase());return(first>=0?first:0)*16+(second>=0?second:0);};SocialCalc.Popup.HexToRGB=function(val){var sp=SocialCalc.Popup;return\"rgb(\"+sp.FromHex(val.substring(1,3))+\",\"+sp.FromHex(val.substring(3,5))+\",\"+sp.FromHex(val.substring(5,7))+\")\";};SocialCalc.Popup.makeRGB=function(r,g,b){return\"rgb(\"+(r>0?r:0)+\",\"+(g>0?g:0)+\",\"+(b>0?b:0)+\")\";};SocialCalc.Popup.splitRGB=function(rgb){var parts=rgb.match(/(\\d+)\\D+(\\d+)\\D+(\\d+)\\D/);if(!parts){return{r:0,g:0,b:0};}else{return{r:parts[1]-0,g:parts[2]-0,b:parts[3]-0};}};// * * * * * * * * * * * * * * * *\n\t//\n\t// ROUTINES FOR EACH TYPE\n\t//\n\t// * * * * * * * * * * * * * * * *\n\t//\n\t// List\n\t//\n\t// type: List\n\t// value: value of control,\n\t// display: \"value to display\",\n\t// custom: true if custom value,\n\t// disabled: t/f,\n\t// attribs: {\n\t//    title: \"popup title string\",\n\t//    moveable: t/f,\n\t//    width: optional width, e.g., \"100px\",\n\t//    ensureWithin: optional element object to ensure popup fits within if possible\n\t//    changedcallback: optional function(attribs, id, newvalue),\n\t//    ...\n\t//    }\n\t// data: {\n\t//    ncols: calculated number of columns\n\t//    options: [\n\t//       {o: option-name, v: value-to-return,\n\t//        a: {option attribs} // optional: {skip: true, custom: true, cancel: true, newcol: true}\n\t//       },\n\t//       ...]\n\t//    }\n\t//\n\t// popupele: gets popup element object when created\n\t// contentele: gets element created with all the content\n\t// listdiv: gets div with list of items\n\t// customele: gets input element with custom value\n\t// dragregistered: gets element, if any, registered as draggable\n\t//\n\tSocialCalc.Popup.Types.List={};SocialCalc.Popup.Types.List.Create=function(type,id,attribs){var sp=SocialCalc.Popup;var spt=sp.Types;var spc=sp.Controls;var spcid={type:type,value:\"\",display:\"\",data:{}};if(spc[id]){return;}spc[id]=spcid;var spcdata=spcid.data;spcdata.attribs=attribs||{};var ele=document.getElementById(id);if(!ele){alert(\"Missing element \"+id);return;}spcdata.mainele=ele;ele.innerHTML='<input style=\"cursor:pointer;width:'+(spcdata.attribs.inputWidth||'100px')+';font-size:smaller;\" onfocus=\"this.blur();\" onclick=\"SocialCalc.Popup.CClick(\\''+id+'\\');\" value=\"\">';spcdata.options=[];// set to nothing - use Initialize to fill\n\t};SocialCalc.Popup.Types.List.SetValue=function(type,id,value){var i;var sp=SocialCalc.Popup;var spt=sp.Types;var spc=sp.Controls;var spcdata=spc[id].data;spcdata.value=value;spcdata.custom=false;for(i=0;i<spcdata.options.length;i++){o=spcdata.options[i];if(o.a){if(o.a.skip||o.a.custom||o.a.cancel){continue;}}if(o.v==spcdata.value){// matches value\n\tspcdata.display=o.o;break;}}if(i==spcdata.options.length){// none found\n\tspcdata.display=\"Custom\";spcdata.custom=true;}if(spcdata.mainele&&spcdata.mainele.firstChild){spcdata.mainele.firstChild.value=spcdata.display;}};SocialCalc.Popup.Types.List.SetDisabled=function(type,id,disabled){var i;var sp=SocialCalc.Popup;var spt=sp.Types;var spc=sp.Controls;var spcdata=spc[id].data;spcdata.disabled=disabled;if(spcdata.mainele&&spcdata.mainele.firstChild){spcdata.mainele.firstChild.disabled=disabled;}};SocialCalc.Popup.Types.List.GetValue=function(type,id){var sp=SocialCalc.Popup;var spt=sp.Types;var spc=sp.Controls;var spcdata=spc[id].data;return spcdata.value;};// data is: {value: initial value, attribs: {attribs stuff}, options: [{o: option-name, v: value-to-return, a: optional-attribs}, ...]}\n\tSocialCalc.Popup.Types.List.Initialize=function(type,id,data){var a;var sp=SocialCalc.Popup;var spt=sp.Types;var spc=sp.Controls;var spcdata=spc[id].data;for(a in data.attribs){spcdata.attribs[a]=data.attribs[a];}spcdata.options=data?data.options:[];if(data.value){// if has a value, set to it\n\tsp.SetValue(id,data.value);}};SocialCalc.Popup.Types.List.Reset=function(type){var sp=SocialCalc.Popup;var spt=sp.Types;var spc=sp.Controls;if(sp.Current.id&&spc[sp.Current.id].type==type){// we have a popup\n\tspt[type].Hide(type,sp.Current.id);sp.Current.id=null;}};SocialCalc.Popup.Types.List.Show=function(type,id){var i,ele,o,bg;var sp=SocialCalc.Popup;var spt=sp.Types;var spc=sp.Controls;var spcdata=spc[id].data;var str=\"\";spcdata.popupele=sp.CreatePopupDiv(id,spcdata.attribs);if(spcdata.custom){str=SocialCalc.Popup.Types.List.MakeCustom(type,id);ele=document.createElement(\"div\");ele.innerHTML='<div style=\"cursor:default;padding:4px;background-color:#CCC;\">'+str+'</div>';spcdata.customele=ele.firstChild.firstChild.childNodes[1];spcdata.listdiv=null;spcdata.contentele=ele;}else{str=SocialCalc.Popup.Types.List.MakeList(type,id);ele=document.createElement(\"div\");ele.innerHTML='<div style=\"cursor:default;padding:4px;\">'+str+'</div>';spcdata.customele=null;spcdata.listdiv=ele.firstChild;spcdata.contentele=ele;}if(spcdata.mainele&&spcdata.mainele.firstChild){spcdata.mainele.firstChild.disabled=true;}spcdata.popupele.appendChild(ele);if(spcdata.attribs.ensureWithin){SocialCalc.Popup.EnsurePosition(id,spcdata.attribs.ensureWithin);}};SocialCalc.Popup.Types.List.MakeList=function(type,id){var i,ele,o,bg;var sp=SocialCalc.Popup;var spt=sp.Types;var spc=sp.Controls;var spcdata=spc[id].data;var str='<table cellspacing=\"0\" cellpadding=\"0\"><tr>';var td='<td style=\"vertical-align:top;\">';str+=td;spcdata.ncols=1;for(i=0;i<spcdata.options.length;i++){o=spcdata.options[i];if(o.a){if(o.a.newcol){str+='</td>'+td+\"&nbsp;&nbsp;&nbsp;&nbsp;\"+'</td>'+td;spcdata.ncols+=1;continue;}if(o.a.skip){str+='<div style=\"font-size:x-small;white-space:nowrap;\">'+o.o+'</div>';continue;}}if(o.v==spcdata.value&&!(o.a&&(o.a.custom||o.a.cancel))){// matches value\n\tbg=\"background-color:#DDF;\";}else{bg=\"\";}str+='<div style=\"font-size:x-small;white-space:nowrap;'+bg+'\" onclick=\"SocialCalc.Popup.Types.List.ItemClicked(\\''+id+'\\',\\''+i+'\\');\" onmousemove=\"SocialCalc.Popup.Types.List.MouseMove(\\''+id+'\\',this);\">'+o.o+'</div>';}str+=\"</td></tr></table>\";return str;};SocialCalc.Popup.Types.List.MakeCustom=function(type,id){var SPLoc=SocialCalc.Popup.LocalizeString;var i,ele,o,bg;var sp=SocialCalc.Popup;var spt=sp.Types;var spc=sp.Controls;var spcdata=spc[id].data;var style='style=\"font-size:smaller;\"';var str=\"\";var val=spcdata.value;val=SocialCalc.special_chars(val);str='<div style=\"white-space:nowrap;\"><br>'+'<input id=\"customvalue\" value=\"'+val+'\"><br><br>'+'<input '+style+' type=\"button\" value=\"'+SPLoc(\"OK\")+'\" onclick=\"SocialCalc.Popup.Types.List.CustomOK(\\''+id+'\\');return false;\">'+'<input '+style+' type=\"button\" value=\"'+SPLoc(\"List\")+'\" onclick=\"SocialCalc.Popup.Types.List.CustomToList(\\''+id+'\\');\">'+'<input '+style+' type=\"button\" value=\"'+SPLoc(\"Cancel\")+'\" onclick=\"SocialCalc.Popup.Close();\">'+'<br></div>';return str;};SocialCalc.Popup.Types.List.ItemClicked=function(id,num){var oele,str,nele;var sp=SocialCalc.Popup;var spt=sp.Types;var spc=sp.Controls;var spcdata=spc[id].data;var a=spcdata.options[num].a;if(a&&a.custom){oele=spcdata.contentele;str=SocialCalc.Popup.Types.List.MakeCustom(\"List\",id);nele=document.createElement(\"div\");nele.innerHTML='<div style=\"cursor:default;padding:4px;background-color:#CCC;\">'+str+'</div>';spcdata.customele=nele.firstChild.firstChild.childNodes[1];spcdata.listdiv=null;spcdata.contentele=nele;spcdata.popupele.replaceChild(nele,oele);if(spcdata.attribs.ensureWithin){SocialCalc.Popup.EnsurePosition(id,spcdata.attribs.ensureWithin);}return;}if(a&&a.cancel){SocialCalc.Popup.Close();return;}SocialCalc.Popup.SetValue(id,spcdata.options[num].v);SocialCalc.Popup.Close();};SocialCalc.Popup.Types.List.CustomToList=function(id){var oele,str,nele;var sp=SocialCalc.Popup;var spt=sp.Types;var spc=sp.Controls;var spcdata=spc[id].data;oele=spcdata.contentele;str=SocialCalc.Popup.Types.List.MakeList(\"List\",id);nele=document.createElement(\"div\");nele.innerHTML='<div style=\"cursor:default;padding:4px;\">'+str+'</div>';spcdata.customele=null;spcdata.listdiv=nele.firstChild;spcdata.contentele=nele;spcdata.popupele.replaceChild(nele,oele);if(spcdata.attribs.ensureWithin){SocialCalc.Popup.EnsurePosition(id,spcdata.attribs.ensureWithin);}};SocialCalc.Popup.Types.List.CustomOK=function(id){var i,c;var sp=SocialCalc.Popup;var spt=sp.Types;var spc=sp.Controls;var spcdata=spc[id].data;SocialCalc.Popup.SetValue(id,spcdata.customele.value);SocialCalc.Popup.Close();};SocialCalc.Popup.Types.List.MouseMove=function(id,ele){var col,i,c;var sp=SocialCalc.Popup;var spt=sp.Types;var spc=sp.Controls;var spcdata=spc[id].data;var list=spcdata.listdiv;if(!list)return;var rowele=list.firstChild.firstChild.firstChild;// div.table.tbody.tr\n\tfor(col=0;col<spcdata.ncols;col++){for(i=0;i<rowele.childNodes[col*2].childNodes.length;i++){rowele.childNodes[col*2].childNodes[i].style.backgroundColor=\"#FFF\";}}ele.style.backgroundColor=\"#DDF\";};SocialCalc.Popup.Types.List.Hide=function(type,id){var sp=SocialCalc.Popup;var spt=sp.Types;var spc=sp.Controls;var spcdata=spc[id].data;sp.DestroyPopupDiv(spcdata.popupele,spcdata.dragregistered);spcdata.popupele=null;if(spcdata.mainele&&spcdata.mainele.firstChild){spcdata.mainele.firstChild.disabled=false;}};SocialCalc.Popup.Types.List.Cancel=function(type,id){SocialCalc.Popup.Types.List.Hide(type,id);};//\n\t// ColorChooser\n\t//\n\t// type: ColorChooser\n\t// value: value of control as \"rgb(r,g,b)\" or \"\" if default,\n\t// oldvalue: starting value to reset to on close,\n\t// display: \"value to display\" as hex color value,\n\t// custom: true if custom value,\n\t// disabled: t/f,\n\t// attribs: {\n\t//    title: \"popup title string\",\n\t//    moveable: t/f,\n\t//    width: optional width, e.g., \"100px\", of popup chooser\n\t//    ensureWithin: optional element object to ensure popup fits within if possible\n\t//    sampleWidth: optional width, e.g., \"20px\",\n\t//    sampleHeight: optional height, e.g., \"20px\",\n\t//    backgroundImage: optional background image for sample (transparent where want to show current color), e.g., \"colorbg.gif\"\n\t//    backgroundImageDefault: optional background image for sample when default (transparent shows white)\n\t//    backgroundImageDisabled: optional background image for sample when disabled (transparent shows gray)\n\t//    changedcallback: optional function(attribs, id, newvalue),\n\t//    ...\n\t//    }\n\t// data: {\n\t//    }\n\t//\n\t// popupele: gets popup element object when created\n\t// contentele: gets element created with all the content\n\t// customele: gets input element with custom value\n\t//\n\tSocialCalc.Popup.Types.ColorChooser={};SocialCalc.Popup.Types.ColorChooser.Create=function(type,id,attribs){var sp=SocialCalc.Popup;var spt=sp.Types;var spc=sp.Controls;var spcid={type:type,value:\"\",display:\"\",data:{}};if(spc[id]){return;}spc[id]=spcid;var spcdata=spcid.data;spcdata.attribs=attribs||{};var spca=spcdata.attribs;spcdata.value=\"\";var ele=document.getElementById(id);if(!ele){alert(\"Missing element \"+id);return;}spcdata.mainele=ele;ele.innerHTML='<div style=\"cursor:pointer;border:1px solid black;vertical-align:top;width:'+(spca.sampleWidth||'15px')+';height:'+(spca.sampleHeight||'15px')+';\" onclick=\"SocialCalc.Popup.Types.ColorChooser.ControlClicked(\\''+id+'\\');\">&nbsp;</div>';};SocialCalc.Popup.Types.ColorChooser.SetValue=function(type,id,value){var i,img,pos;var sp=SocialCalc.Popup;var spt=sp.Types;var spc=sp.Controls;var spcdata=spc[id].data;var spca=spcdata.attribs;spcdata.value=value;spcdata.custom=false;if(spcdata.mainele&&spcdata.mainele.firstChild){if(spcdata.value){spcdata.mainele.firstChild.style.backgroundColor=spcdata.value;if(spca.backgroundImage){img=\"url(\"+sp.imagePrefix+spca.backgroundImage+\")\";}else{img=\"\";}pos=\"center center\";}else{spcdata.mainele.firstChild.style.backgroundColor=\"#FFF\";if(spca.backgroundImageDefault){img=\"url(\"+sp.imagePrefix+spca.backgroundImageDefault+\")\";pos=\"center center\";}else{img=\"url(\"+sp.imagePrefix+\"defaultcolor.gif)\";pos=\"left top\";}}spcdata.mainele.firstChild.style.backgroundPosition=pos;spcdata.mainele.firstChild.style.backgroundImage=img;}};SocialCalc.Popup.Types.ColorChooser.SetDisabled=function(type,id,disabled){var i;var sp=SocialCalc.Popup;var spt=sp.Types;var spc=sp.Controls;var spcdata=spc[id].data;var spca=spcdata.attribs;spcdata.disabled=disabled;if(spcdata.mainele&&spcdata.mainele.firstChild){if(disabled){spcdata.mainele.firstChild.style.backgroundColor=\"#DDD\";if(spca.backgroundImageDisabled){img=\"url(\"+sp.imagePrefix+spca.backgroundImageDisabled+\")\";pos=\"center center\";}else{img=\"url(\"+sp.imagePrefix+\"defaultcolor.gif)\";pos=\"left top\";}spcdata.mainele.firstChild.style.backgroundPosition=pos;spcdata.mainele.firstChild.style.backgroundImage=img;}else{sp.SetValue(id,spcdata.value);}}};SocialCalc.Popup.Types.ColorChooser.GetValue=function(type,id){var sp=SocialCalc.Popup;var spt=sp.Types;var spc=sp.Controls;var spcdata=spc[id].data;return spcdata.value;};SocialCalc.Popup.Types.ColorChooser.Initialize=function(type,id,data){var a;var sp=SocialCalc.Popup;var spt=sp.Types;var spc=sp.Controls;var spcdata=spc[id].data;for(a in data.attribs){spcdata.attribs[a]=data.attribs[a];}if(data.value){// if has a value, set to it\n\tsp.SetValue(id,data.value);}};SocialCalc.Popup.Types.ColorChooser.Reset=function(type){var sp=SocialCalc.Popup;var spt=sp.Types;var spc=sp.Controls;if(sp.Current.id&&spc[sp.Current.id].type==type){// we have a popup\n\tspt[type].Hide(type,sp.Current.id);sp.Current.id=null;}};SocialCalc.Popup.Types.ColorChooser.Show=function(type,id){var i,ele,mainele;var sp=SocialCalc.Popup;var spt=sp.Types;var spc=sp.Controls;var spcdata=spc[id].data;var str=\"\";spcdata.oldvalue=spcdata.value;// remember starting value\n\tspcdata.popupele=sp.CreatePopupDiv(id,spcdata.attribs);if(spcdata.custom){str=SocialCalc.Popup.Types.ColorChooser.MakeCustom(type,id);ele=document.createElement(\"div\");ele.innerHTML='<div style=\"cursor:default;padding:4px;background-color:#CCC;\">'+str+'</div>';spcdata.customele=ele.firstChild.firstChild.childNodes[2];spcdata.contentele=ele;}else{mainele=SocialCalc.Popup.Types.ColorChooser.CreateGrid(type,id);ele=document.createElement(\"div\");ele.style.padding=\"3px\";ele.style.backgroundColor=\"#CCC\";ele.appendChild(mainele);spcdata.customele=null;spcdata.contentele=ele;}spcdata.popupele.appendChild(ele);if(spcdata.attribs.ensureWithin){SocialCalc.Popup.EnsurePosition(id,spcdata.attribs.ensureWithin);}};SocialCalc.Popup.Types.ColorChooser.MakeCustom=function(type,id){var i,ele,o,bg;var sp=SocialCalc.Popup;var spt=sp.Types;var spc=sp.Controls;var spcdata=spc[id].data;var SPLoc=sp.LocalizeString;var style='style=\"font-size:smaller;\"';var str=\"\";str='<div style=\"white-space:nowrap;\"><br>'+'#<input id=\"customvalue\" style=\"width:75px;\" value=\"'+spcdata.value+'\"><br><br>'+'<input '+style+' type=\"button\" value=\"'+SPLoc(\"OK\")+'\" onclick=\"SocialCalc.Popup.Types.ColorChooser.CustomOK(\\''+id+'\\');return false;\">'+'<input '+style+' type=\"button\" value=\"'+SPLoc(\"Grid\")+'\" onclick=\"SocialCalc.Popup.Types.ColorChooser.CustomToGrid(\\''+id+'\\');\">'+'<br></div>';return str;};SocialCalc.Popup.Types.ColorChooser.ItemClicked=function(id,num){var oele,str,nele;var sp=SocialCalc.Popup;var spt=sp.Types;var spc=sp.Controls;var spcdata=spc[id].data;SocialCalc.Popup.Close();};SocialCalc.Popup.Types.ColorChooser.CustomToList=function(id){var oele,str,nele;var sp=SocialCalc.Popup;var spt=sp.Types;var spc=sp.Controls;var spcdata=spc[id].data;};SocialCalc.Popup.Types.ColorChooser.CustomOK=function(id){var i,c;var sp=SocialCalc.Popup;var spt=sp.Types;var spc=sp.Controls;var spcdata=spc[id].data;sp.SetValue(id,spcdata.customele.value);sp.Close();};SocialCalc.Popup.Types.ColorChooser.Hide=function(type,id){var sp=SocialCalc.Popup;var spt=sp.Types;var spc=sp.Controls;var spcdata=spc[id].data;sp.DestroyPopupDiv(spcdata.popupele,spcdata.dragregistered);spcdata.popupele=null;};SocialCalc.Popup.Types.ColorChooser.Cancel=function(type,id){var sp=SocialCalc.Popup;var spt=sp.Types;var spc=sp.Controls;var spcdata=spc[id].data;sp.SetValue(id,spcdata.oldvalue);// reset to old value\n\tSocialCalc.Popup.Types.ColorChooser.Hide(type,id);};SocialCalc.Popup.Types.ColorChooser.CreateGrid=function(type,id){var ele,pos,row,rowele,col,g;var sp=SocialCalc.Popup;var spt=sp.Types;var spc=sp.Controls;var SPLoc=sp.LocalizeString;var spcdata=spc[id].data;spcdata.grid={};var grid=spcdata.grid;var mainele=document.createElement(\"div\");ele=document.createElement(\"table\");ele.cellSpacing=0;ele.cellPadding=0;ele.style.width=\"100px\";grid.table=ele;ele=document.createElement(\"tbody\");grid.table.appendChild(ele);grid.tbody=ele;for(row=0;row<16;row++){rowele=document.createElement(\"tr\");for(col=0;col<5;col++){g={};grid[row+\",\"+col]=g;ele=document.createElement(\"td\");ele.style.fontSize=\"1px\";ele.innerHTML=\"&nbsp;\";ele.style.height=\"10px\";if(col<=1){ele.style.width=\"17px\";ele.style.borderRight=\"3px solid white\";}else{ele.style.width=\"20px\";ele.style.backgroundRepeat=\"no-repeat\";}rowele.appendChild(ele);g.ele=ele;}grid.tbody.appendChild(rowele);}mainele.appendChild(grid.table);ele=document.createElement(\"div\");ele.style.marginTop=\"3px\";ele.innerHTML='<table cellspacing=\"0\" cellpadding=\"0\"><tr>'+'<td style=\"width:17px;background-color:#FFF;background-image:url('+sp.imagePrefix+'defaultcolor.gif);height:16px;font-size:10px;cursor:pointer;\" title=\"'+SPLoc(\"Default\")+'\">&nbsp;</td>'+'<td style=\"width:23px;height:16px;font-size:10px;text-align:center;cursor:pointer;\" title=\"'+SPLoc(\"Custom\")+'\">#</td>'+'<td style=\"width:60px;height:16px;font-size:10px;text-align:center;cursor:pointer;\">'+SPLoc(\"OK\")+'</td>'+'</tr></table>';grid.defaultbox=ele.firstChild.firstChild.firstChild.childNodes[0];grid.defaultbox.onclick=spt.ColorChooser.DefaultClicked;grid.custom=ele.firstChild.firstChild.firstChild.childNodes[1];grid.custom.onclick=spt.ColorChooser.CustomClicked;grid.msg=ele.firstChild.firstChild.firstChild.childNodes[2];grid.msg.onclick=spt.ColorChooser.CloseOK;mainele.appendChild(ele);grid.table.onmousedown=spt.ColorChooser.GridMouseDown;spt.ColorChooser.DetermineColors(id);spt.ColorChooser.SetColors(id);return mainele;};SocialCalc.Popup.Types.ColorChooser.gridToG=function(grid,row,col){return grid[row+\",\"+col];};SocialCalc.Popup.Types.ColorChooser.DetermineColors=function(id){var sp=SocialCalc.Popup;var spt=sp.Types;var sptc=spt.ColorChooser;var spc=sp.Controls;var spcdata=spc[id].data;var grid=spcdata.grid;var col,row;var rgb=sp.splitRGB(spcdata.value);var color;col=2;row=16-Math.floor((rgb.r+16)/16);grid[\"selectedrow\"+col]=row;for(row=0;row<16;row++){sptc.gridToG(grid,row,col).rgb=sp.makeRGB(17*(15-row),0,0);}col=3;row=16-Math.floor((rgb.g+16)/16);grid[\"selectedrow\"+col]=row;for(row=0;row<16;row++){sptc.gridToG(grid,row,col).rgb=sp.makeRGB(0,17*(15-row),0);}col=4;row=16-Math.floor((rgb.b+16)/16);grid[\"selectedrow\"+col]=row;for(row=0;row<16;row++){sptc.gridToG(grid,row,col).rgb=sp.makeRGB(0,0,17*(15-row));}col=1;for(row=0;row<16;row++){sptc.gridToG(grid,row,col).rgb=sp.makeRGB(17*(15-row),17*(15-row),17*(15-row));}col=0;var steps=[0,68,153,204,255];var commonrgb=[\"400\",\"310\",\"420\",\"440\",\"442\",\"340\",\"040\",\"042\",\"032\",\"044\",\"024\",\"004\",\"204\",\"314\",\"402\",\"414\"];var x;for(row=0;row<16;row++){x=commonrgb[row];sptc.gridToG(grid,row,col).rgb=\"rgb(\"+steps[x.charAt(0)-0]+\",\"+steps[x.charAt(1)-0]+\",\"+steps[x.charAt(2)-0]+\")\";}};SocialCalc.Popup.Types.ColorChooser.SetColors=function(id){var row,col,g,ele,rgb;var sp=SocialCalc.Popup;var spt=sp.Types;var sptc=spt.ColorChooser;var spc=sp.Controls;var spcdata=spc[id].data;var grid=spcdata.grid;for(row=0;row<16;row++){for(col=0;col<5;col++){g=sptc.gridToG(grid,row,col);g.ele.style.backgroundColor=g.rgb;g.ele.title=sp.RGBToHex(g.rgb);if(grid[\"selectedrow\"+col]==row){g.ele.style.backgroundImage=\"url(\"+sp.imagePrefix+\"chooserarrow.gif)\";}else{g.ele.style.backgroundImage=\"\";}}}sp.SetValue(id,spcdata.value);grid.msg.style.backgroundColor=spcdata.value;rgb=sp.splitRGB(spcdata.value||\"rgb(255,255,255)\");if(rgb.r+rgb.g+rgb.b<220){grid.msg.style.color=\"#FFF\";}else{grid.msg.style.color=\"#000\";}if(!spcdata.value){// default\n\tgrid.msg.style.backgroundColor=\"#FFF\";grid.msg.style.backgroundImage=\"url(\"+sp.imagePrefix+\"defaultcolor.gif)\";grid.msg.title=\"Default\";}else{grid.msg.style.backgroundImage=\"\";grid.msg.title=sp.RGBToHex(spcdata.value);}};SocialCalc.Popup.Types.ColorChooser.GridMouseDown=function(e){var event=e||window.event;var sp=SocialCalc.Popup;var spt=sp.Types;var sptc=spt.ColorChooser;var spc=sp.Controls;var id=sp.Current.id;if(!id)return;var spcdata=spc[id].data;var grid=spcdata.grid;switch(event.type){case\"mousedown\":grid.mousedown=true;break;case\"mouseup\":grid.mousedown=false;break;case\"mousemove\":if(!grid.mousedown){return;}break;}var viewport=SocialCalc.GetViewportInfo();var clientX=event.clientX+viewport.horizontalScroll;var clientY=event.clientY+viewport.verticalScroll;var gpos=SocialCalc.GetElementPosition(grid.table);var row=Math.floor((clientY-gpos.top-2)/10);// -2 is to split the diff btw IE & FF\n\trow=row<0?0:row;var col=Math.floor((clientX-gpos.left)/20);row=row<0?0:row>15?15:row;col=col<0?0:col>4?4:col;var color=sptc.gridToG(grid,row,col).ele.style.backgroundColor;var newrgb=sp.splitRGB(color);var oldrgb=sp.splitRGB(spcdata.value);switch(col){case 2:spcdata.value=sp.makeRGB(newrgb.r,oldrgb.g,oldrgb.b);break;case 3:spcdata.value=sp.makeRGB(oldrgb.r,newrgb.g,oldrgb.b);break;case 4:spcdata.value=sp.makeRGB(oldrgb.r,oldrgb.g,newrgb.b);break;case 0:case 1:spcdata.value=color;}sptc.DetermineColors(id);sptc.SetColors(id);};SocialCalc.Popup.Types.ColorChooser.ControlClicked=function(id){var sp=SocialCalc.Popup;var spt=sp.Types;var sptc=spt.ColorChooser;var spc=sp.Controls;var cid=sp.Current.id;if(!cid||id!=cid){sp.CClick(id);return;}sptc.CloseOK();};SocialCalc.Popup.Types.ColorChooser.DefaultClicked=function(e){var event=e||window.event;var sp=SocialCalc.Popup;var spt=sp.Types;var sptc=spt.ColorChooser;var spc=sp.Controls;var id=sp.Current.id;if(!id)return;var spcdata=spc[id].data;spcdata.value=\"\";SocialCalc.Popup.SetValue(id,spcdata.value);SocialCalc.Popup.Close();};SocialCalc.Popup.Types.ColorChooser.CustomClicked=function(e){var event=e||window.event;var sp=SocialCalc.Popup;var spt=sp.Types;var sptc=spt.ColorChooser;var spc=sp.Controls;var id=sp.Current.id;if(!id)return;var spcdata=spc[id].data;var oele,str,nele;oele=spcdata.contentele;str=SocialCalc.Popup.Types.ColorChooser.MakeCustom(\"ColorChooser\",id);nele=document.createElement(\"div\");nele.innerHTML='<div style=\"cursor:default;padding:4px;background-color:#CCC;\">'+str+'</div>';spcdata.customele=nele.firstChild.firstChild.childNodes[2];spcdata.contentele=nele;spcdata.popupele.replaceChild(nele,oele);spcdata.customele.value=sp.RGBToHex(spcdata.value);if(spcdata.attribs.ensureWithin){SocialCalc.Popup.EnsurePosition(id,spcdata.attribs.ensureWithin);}};SocialCalc.Popup.Types.ColorChooser.CustomToGrid=function(id){var oele,str,nele;var sp=SocialCalc.Popup;var spt=sp.Types;var spc=sp.Controls;var spcdata=spc[id].data;SocialCalc.Popup.SetValue(id,sp.HexToRGB(\"#\"+spcdata.customele.value));var oele,mainele,nele;oele=spcdata.contentele;mainele=SocialCalc.Popup.Types.ColorChooser.CreateGrid(\"ColorChooser\",id);nele=document.createElement(\"div\");nele.style.padding=\"3px\";nele.style.backgroundColor=\"#CCC\";nele.appendChild(mainele);spcdata.customele=null;spcdata.contentele=nele;spcdata.popupele.replaceChild(nele,oele);if(spcdata.attribs.ensureWithin){SocialCalc.Popup.EnsurePosition(id,spcdata.attribs.ensureWithin);}};SocialCalc.Popup.Types.ColorChooser.CustomOK=function(id){var i,c;var sp=SocialCalc.Popup;var spt=sp.Types;var spc=sp.Controls;var spcdata=spc[id].data;SocialCalc.Popup.SetValue(id,sp.HexToRGB(\"#\"+spcdata.customele.value));SocialCalc.Popup.Close();};SocialCalc.Popup.Types.ColorChooser.CloseOK=function(e){var event=e||window.event;var sp=SocialCalc.Popup;var spt=sp.Types;var sptc=spt.ColorChooser;var spc=sp.Controls;var id=sp.Current.id;if(!id)return;var spcdata=spc[id].data;SocialCalc.Popup.SetValue(id,spcdata.value);SocialCalc.Popup.Close();};//\n\t// SocialCalcSpreadsheetControl\n\t//\n\t/*\n\t// The code module of the SocialCalc package that lets you embed a spreadsheet\n\t// control with toolbar, etc., into a web page.\n\t//\n\t// (c) Copyright 2008, 2009, 2010 Socialtext, Inc.\n\t// All Rights Reserved.\n\t//\n\t*//*\n\t\n\tLEGAL NOTICES REQUIRED BY THE COMMON PUBLIC ATTRIBUTION LICENSE:\n\t\n\tEXHIBIT A. Common Public Attribution License Version 1.0.\n\t\n\tThe contents of this file are subject to the Common Public Attribution License Version 1.0 (the \n\t\"License\"); you may not use this file except in compliance with the License. You may obtain a copy \n\tof the License at http://socialcalc.org. The License is based on the Mozilla Public License Version 1.1 but \n\tSections 14 and 15 have been added to cover use of software over a computer network and provide for \n\tlimited attribution for the Original Developer. In addition, Exhibit A has been modified to be \n\tconsistent with Exhibit B.\n\t\n\tSoftware distributed under the License is distributed on an \"AS IS\" basis, WITHOUT WARRANTY OF ANY \n\tKIND, either express or implied. See the License for the specific language governing rights and \n\tlimitations under the License.\n\t\n\tThe Original Code is SocialCalc JavaScript SpreadsheetControl.\n\t\n\tThe Original Developer is the Initial Developer.\n\t\n\tThe Initial Developer of the Original Code is Socialtext, Inc. All portions of the code written by \n\tSocialtext, Inc., are Copyright (c) Socialtext, Inc. All Rights Reserved.\n\t\n\tContributor: Dan Bricklin.\n\t\n\t\n\tEXHIBIT B. Attribution Information\n\t\n\tWhen the SpreadsheetControl is producing and/or controlling the display the Graphic Image must be\n\tdisplayed on the screen visible to the user in a manner comparable to that in the \n\tOriginal Code. The Attribution Phrase must be displayed as a \"tooltip\" or \"hover-text\" for\n\tthat image. The image must be linked to the Attribution URL so as to access that page\n\twhen clicked. If the user interface includes a prominent \"about\" display which includes\n\tfactual prominent attribution in a form similar to that in the \"about\" display included\n\twith the Original Code, including Socialtext copyright notices and URLs, then the image\n\tneed not be linked to the Attribution URL but the \"tool-tip\" is still required.\n\t\n\tAttribution Copyright Notice:\n\t\n\t Copyright (C) 2010 Socialtext, Inc.\n\t All Rights Reserved.\n\t\n\tAttribution Phrase (not exceeding 10 words): SocialCalc\n\t\n\tAttribution URL: http://www.socialcalc.org/\n\t\n\tGraphic Image: The contents of the sc-logo.gif file in the Original Code or\n\ta suitable replacement from http://www.socialcalc.org/licenses specified as\n\tbeing for SocialCalc.\n\t\n\tDisplay of Attribution Information is required in Larger Works which are defined \n\tin the CPAL as a work which combines Covered Code or portions thereof with code \n\tnot governed by the terms of the CPAL.\n\t\n\t*///\n\t// Some of the other files in the SocialCalc package are licensed under\n\t// different licenses. Please note the licenses of the modules you use.\n\t//\n\t// Code History:\n\t//\n\t// Initially coded by Dan Bricklin of Software Garden, Inc., for Socialtext, Inc.\n\t// Unless otherwise specified, referring to \"SocialCalc\" in comments refers to this\n\t// JavaScript version of the code, not the SocialCalc Perl code.\n\t//\n\t/*\n\t\n\tSee the comments in the main SocialCalc code module file of the SocialCalc package.\n\t\n\t*/var SocialCalc;if(!SocialCalc){alert(\"Main SocialCalc code module needed\");SocialCalc={};}if(!SocialCalc.TableEditor){alert(\"SocialCalc TableEditor code module needed\");}// *************************************\n\t//\n\t// SpreadsheetControl class:\n\t//\n\t// *************************************\n\t// Global constants:\n\tSocialCalc.CurrentSpreadsheetControlObject=null;// right now there can only be one active at a time\n\t// Constructor:\n\tSocialCalc.SpreadsheetControl=function(){var scc=SocialCalc.Constants;// Properties:\n\tthis.parentNode=null;this.spreadsheetDiv=null;this.requestedHeight=0;this.requestedWidth=0;this.requestedSpaceBelow=0;this.height=0;this.width=0;this.viewheight=0;// calculated amount for views below toolbar, etc.\n\t// Tab definitions: An array where each tab is an object of the form:\n\t//\n\t//    name: \"name\",\n\t//    text: \"text-on-tab\",\n\t//    html: \"html-to-create div\",\n\t//       replacements:\n\t//         \"%s.\": \"SocialCalc\", \"%id.\": spreadsheet.idPrefix, \"%tbt.\": spreadsheet.toolbartext\n\t//         Other replacements from spreadsheet.tabreplacements:\n\t//            replacementname: {regex: regular-expression-to-match-with-g, replacement: string}\n\t//    view: \"viewname\", // view to show when selected; \"sheet\" or missing/null is spreadsheet\n\t//    oncreate: function(spreadsheet, tab-name), // called when first created to initialize\n\t//    onclick: function(spreadsheet, tab-name), missing/null is sheet default\n\t//    onclickFocus: text, // spreadsheet.idPrefix+text is given the focus if present instead of normal KeyboardFocus\n\t//       or if text isn't a string, that value (e.g., true) is used for SocialCalc.CmdGotFocus\n\t//    onunclick: function(spreadsheet, tab-name), missing/null is sheet default\n\tthis.tabs=[];this.tabnums={};// when adding tabs, add tab-name: array-index to this object\n\tthis.tabreplacements={};// see use above\n\tthis.currentTab=-1;// currently selected tab index in this.tabs or -1 (maintained by SocialCalc.SetTab)\n\t// View definitions: An object where each view is an object of the form:\n\t//\n\t//    name: \"name\", // localized when first set using SocialCalc.LocalizeString\n\t//    element: node-in-the-dom, // filled in when initialized\n\t//    replacements: {}, // see below\n\t//    html: \"html-to-create div\",\n\t//       replacements:\n\t//         \"%s.\": \"SocialCalc\", \"%id.\": spreadsheet.idPrefix, \"%tbt.\": spreadsheet.toolbartext, \"%img.\": spreadsheet.imagePrefix,\n\t//         SocialCalc.LocalizeSubstring replacements (\"%loc!string!\" and \"%ssc!constant-name!\")\n\t//         Other replacements from viewobject.replacements:\n\t//            replacementname: {regex: regular-expression-to-match-with-g, replacement: string}\n\t//    divStyle: attributes for sheet div (SocialCalc.setStyles format)\n\t//    oncreate: function(spreadsheet, viewobject), // called when first created to initialize\n\t//    needsresize: true/false/null, // if true, do resize calc after displaying\n\t//    onresize: function(spreadsheet, viewobject), // called if needs resize\n\t//    values: {} // optional values to share with onclick handlers, etc.\n\t//\n\t// There is always a \"sheet\" view.\n\tthis.views={};// {viewname: view-object, ...}\n\t// Dynamic properties:\n\tthis.sheet=null;this.context=null;this.editor=null;this.spreadsheetDiv=null;this.editorDiv=null;this.sortrange=\"\";// remembered range for sort tab\n\tthis.moverange=\"\";// remembered range from movefrom used by movepaste/moveinsert\n\t// Constants:\n\tthis.idPrefix=\"SocialCalc-\";// prefix added to element ids used here, should end in \"-\"\n\tthis.multipartBoundary=\"SocialCalcSpreadsheetControlSave\";// boundary used by SpreadsheetControlCreateSpreadsheetSave\n\tthis.imagePrefix=scc.defaultImagePrefix;// prefix added to img src\n\tthis.toolbarbackground=scc.SCToolbarbackground;this.tabbackground=scc.SCTabbackground;// \"background-color:#CCC;\";\n\tthis.tabselectedCSS=scc.SCTabselectedCSS;this.tabplainCSS=scc.SCTabplainCSS;this.toolbartext=scc.SCToolbartext;this.formulabarheight=scc.SCFormulabarheight;// in pixels, will contain a text input box\n\tif(scc.doWorkBook){this.sheetbarheight=scc.SCSheetBarHeight;this.sheetbarCSS=scc.SCSheetBarCSS;}else{this.sheetbarheight=0;}this.statuslineheight=scc.SCStatuslineheight;// in pixels\n\tthis.statuslineCSS=scc.SCStatuslineCSS;// Callbacks:\n\tthis.ExportCallback=null;// a function called for Clipboard Export button: this.ExportCallback(spreadsheet_control_object)\n\t// Initialization Code:\n\tthis.sheet=new SocialCalc.Sheet();this.context=new SocialCalc.RenderContext(this.sheet);this.context.showGrid=true;this.context.showRCHeaders=true;this.editor=new SocialCalc.TableEditor(this.context);this.editor.StatusCallback.statusline={func:SocialCalc.SpreadsheetControlStatuslineCallback,params:{statuslineid:this.idPrefix+\"statusline\",recalcid1:this.idPrefix+\"divider_recalc\",recalcid2:this.idPrefix+\"button_recalc\"}};SocialCalc.CurrentSpreadsheetControlObject=this;// remember this for rendezvousing on events\n\tthis.editor.MoveECellCallback.movefrom=function(editor){var cr;var spreadsheet=SocialCalc.GetSpreadsheetControlObject();spreadsheet.context.cursorsuffix=\"\";if(editor.range2.hasrange&&!editor.cellhandles.noCursorSuffix){if(editor.ecell.row==editor.range2.top&&(editor.ecell.col<editor.range2.left||editor.ecell.col>editor.range2.right+1)){spreadsheet.context.cursorsuffix=\"insertleft\";}if(editor.ecell.col==editor.range2.left&&(editor.ecell.row<editor.range2.top||editor.ecell.row>editor.range2.bottom+1)){spreadsheet.context.cursorsuffix=\"insertup\";}}};// formula bar buttons\n\tthis.formulabuttons={formulafunctions:{image:\"formuladialog.gif\",tooltip:\"Functions\",// tooltips are localized when set below\n\tcommand:SocialCalc.SpreadsheetControl.DoFunctionList},multilineinput:{image:\"multilinedialog.gif\",tooltip:\"Multi-line Input Box\",command:SocialCalc.SpreadsheetControl.DoMultiline},link:{image:\"linkdialog.gif\",tooltip:\"Link Input Box\",command:SocialCalc.SpreadsheetControl.DoLink},sum:{image:\"sumdialog.gif\",tooltip:\"Auto Sum\",command:SocialCalc.SpreadsheetControl.DoSum}/*   image: {image: \"sumdialog.gif\", tooltip: \"Insert\",\n\t                   command: SocialCalc.Images.Insert }*/// Default tabs:\n\t// Edit\n\t};this.tabnums.edit=this.tabs.length;this.tabs.push({name:\"edit\",text:\"Edit\",html:' <div id=\"%id.edittools\" style=\"padding:10px 0px 0px 0px;\">'+'&nbsp;<img id=\"%id.button_undo\" src=\"%img.undo.gif\" style=\"vertical-align:bottom;\">'+' <img id=\"%id.button_redo\" src=\"%img.redo.gif\" style=\"vertical-align:bottom;\">'+' &nbsp;<img src=\"%img.divider1.gif\" style=\"vertical-align:bottom;\">&nbsp; '+'<img id=\"%id.button_copy\" src=\"%img.copy.gif\" style=\"vertical-align:bottom;\">'+' <img id=\"%id.button_cut\" src=\"%img.cut.gif\" style=\"vertical-align:bottom;\">'+' <img id=\"%id.button_paste\" src=\"%img.paste.gif\" style=\"vertical-align:bottom;\">'+' &nbsp;<img src=\"%img.divider1.gif\" style=\"vertical-align:bottom;\">&nbsp; '+'<img id=\"%id.button_delete\" src=\"%img.delete.gif\" style=\"vertical-align:bottom;\">'+' <img id=\"%id.button_pasteformats\" src=\"%img.pasteformats.gif\" style=\"vertical-align:bottom;\">'+' &nbsp;<img src=\"%img.divider1.gif\" style=\"vertical-align:bottom;\">&nbsp; '+'<img id=\"%id.button_filldown\" src=\"%img.filldown.gif\" style=\"vertical-align:bottom;\">'+' <img id=\"%id.button_fillright\" src=\"%img.fillright.gif\" style=\"vertical-align:bottom;\">'+' &nbsp;<img src=\"%img.divider1.gif\" style=\"vertical-align:bottom;\">&nbsp; '+'<img id=\"%id.button_movefrom\" src=\"%img.movefromoff.gif\" style=\"vertical-align:bottom;\">'+' <img id=\"%id.button_movepaste\" src=\"%img.movepasteoff.gif\" style=\"vertical-align:bottom;\">'+' <img id=\"%id.button_moveinsert\" src=\"%img.moveinsertoff.gif\" style=\"vertical-align:bottom;\">'+' &nbsp;<img src=\"%img.divider1.gif\" style=\"vertical-align:bottom;\">&nbsp; '+'<img id=\"%id.button_alignleft\" src=\"%img.alignleft.gif\" style=\"vertical-align:bottom;\">'+' <img id=\"%id.button_aligncenter\" src=\"%img.aligncenter.gif\" style=\"vertical-align:bottom;\">'+' <img id=\"%id.button_alignright\" src=\"%img.alignright.gif\" style=\"vertical-align:bottom;\">'+' &nbsp;<img src=\"%img.divider1.gif\" style=\"vertical-align:bottom;\">&nbsp; '+'<img id=\"%id.button_borderon\" src=\"%img.borderson.gif\" style=\"vertical-align:bottom;\"> '+' <img id=\"%id.button_borderoff\" src=\"%img.bordersoff.gif\" style=\"vertical-align:bottom;\"> '+' <img id=\"%id.button_swapcolors\" src=\"%img.swapcolors.gif\" style=\"vertical-align:bottom;\"> '+' &nbsp;<img src=\"%img.divider1.gif\" style=\"vertical-align:bottom;\">&nbsp; '+'<img id=\"%id.button_merge\" src=\"%img.merge.gif\" style=\"vertical-align:bottom;\"> '+' <img id=\"%id.button_unmerge\" src=\"%img.unmerge.gif\" style=\"vertical-align:bottom;\"> '+' &nbsp;<img src=\"%img.divider1.gif\" style=\"vertical-align:bottom;\">&nbsp; '+'<img id=\"%id.button_insertrow\" src=\"%img.insertrow.gif\" style=\"vertical-align:bottom;\"> '+' <img id=\"%id.button_insertcol\" src=\"%img.insertcol.gif\" style=\"vertical-align:bottom;\"> '+'&nbsp; <img id=\"%id.button_deleterow\" src=\"%img.deleterow.gif\" style=\"vertical-align:bottom;\"> '+' <img id=\"%id.button_deletecol\" src=\"%img.deletecol.gif\" style=\"vertical-align:bottom;\"> '+' &nbsp;<img id=\"%id.divider_recalc\" src=\"%img.divider1.gif\" style=\"vertical-align:bottom;\">&nbsp; '+'<img id=\"%id.button_recalc\" src=\"%img.recalc.gif\" style=\"vertical-align:bottom;\"> '+' </div>',oncreate:null,//function(spreadsheet, viewobject) {SocialCalc.DoCmd(null, \"fill-rowcolstuff\");},\n\tonclick:null});// Settings (Format)\n\tthis.tabnums.settings=this.tabs.length;this.tabs.push({name:\"settings\",text:\"Format\",html:'<div id=\"%id.settingstools\" style=\"display:none;\">'+' <div id=\"%id.sheetsettingstoolbar\" style=\"display:none;\">'+'  <table cellspacing=\"0\" cellpadding=\"0\"><tr><td>'+'   <div style=\"%tbt.\">%loc!SHEET SETTINGS!:</div>'+'   </td></tr><tr><td>'+'   <input id=\"%id.settings-savesheet\" type=\"button\" value=\"%loc!Save!\" onclick=\"SocialCalc.SettingsControlSave(\\'sheet\\');\">'+'   <input type=\"button\" value=\"%loc!Cancel!\" onclick=\"SocialCalc.SettingsControlSave(\\'cancel\\');\">'+'   <input type=\"button\" value=\"%loc!Show Cell Settings!\" onclick=\"SocialCalc.SpreadsheetControlSettingsSwitch(\\'cell\\');return false;\">'+'   </td></tr></table>'+' </div>'+' <div id=\"%id.cellsettingstoolbar\" style=\"display:none;\">'+'  <table cellspacing=\"0\" cellpadding=\"0\"><tr><td>'+'   <div style=\"%tbt.\">%loc!CELL SETTINGS!: <span id=\"%id.settingsecell\">&nbsp;</span></div>'+'   </td></tr><tr><td>'+'  <input id=\"%id.settings-savecell\" type=\"button\" value=\"%loc!Save!\" onclick=\"SocialCalc.SettingsControlSave(\\'cell\\');\">'+'  <input type=\"button\" value=\"%loc!Cancel!\" onclick=\"SocialCalc.SettingsControlSave(\\'cancel\\');\">'+'  <input type=\"button\" value=\"%loc!Show Sheet Settings!\" onclick=\"SocialCalc.SpreadsheetControlSettingsSwitch(\\'sheet\\');return false;\">'+'  </td></tr></table>'+' </div>'+'</div>',view:\"settings\",onclick:function onclick(s,t){SocialCalc.SettingsControls.idPrefix=s.idPrefix;// used to get color chooser div\n\tSocialCalc.SettingControlReset();var sheetattribs=s.sheet.EncodeSheetAttributes();var cellattribs=s.sheet.EncodeCellAttributes(s.editor.ecell.coord);SocialCalc.SettingsControlLoadPanel(s.views.settings.values.sheetspanel,sheetattribs);SocialCalc.SettingsControlLoadPanel(s.views.settings.values.cellspanel,cellattribs);document.getElementById(s.idPrefix+\"settingsecell\").innerHTML=s.editor.ecell.coord;SocialCalc.SpreadsheetControlSettingsSwitch(\"cell\");s.views.settings.element.style.height=s.viewheight+\"px\";s.views.settings.element.firstChild.style.height=s.viewheight+\"px\";var range;// set save message\n\tif(s.editor.range.hasrange){range=SocialCalc.crToCoord(s.editor.range.left,s.editor.range.top)+\":\"+SocialCalc.crToCoord(s.editor.range.right,s.editor.range.bottom);}else{range=s.editor.ecell.coord;}document.getElementById(s.idPrefix+\"settings-savecell\").value=SocialCalc.LocalizeString(\"Save to\")+\": \"+range;},onclickFocus:true});this.views[\"settings\"]={name:\"settings\",values:{},oncreate:function oncreate(s,viewobj){var scc=SocialCalc.Constants;viewobj.values.sheetspanel={//            name: \"sheet\",\n\tcolorchooser:{id:s.idPrefix+\"scolorchooser\"},formatnumber:{setting:\"numberformat\",type:\"PopupList\",id:s.idPrefix+\"formatnumber\",initialdata:scc.SCFormatNumberFormats},formattext:{setting:\"textformat\",type:\"PopupList\",id:s.idPrefix+\"formattext\",initialdata:scc.SCFormatTextFormats},fontfamily:{setting:\"fontfamily\",type:\"PopupList\",id:s.idPrefix+\"fontfamily\",initialdata:scc.SCFormatFontfamilies},fontlook:{setting:\"fontlook\",type:\"PopupList\",id:s.idPrefix+\"fontlook\",initialdata:scc.SCFormatFontlook},fontsize:{setting:\"fontsize\",type:\"PopupList\",id:s.idPrefix+\"fontsize\",initialdata:scc.SCFormatFontsizes},textalignhoriz:{setting:\"textalignhoriz\",type:\"PopupList\",id:s.idPrefix+\"textalignhoriz\",initialdata:scc.SCFormatTextAlignhoriz},numberalignhoriz:{setting:\"numberalignhoriz\",type:\"PopupList\",id:s.idPrefix+\"numberalignhoriz\",initialdata:scc.SCFormatNumberAlignhoriz},alignvert:{setting:\"alignvert\",type:\"PopupList\",id:s.idPrefix+\"alignvert\",initialdata:scc.SCFormatAlignVertical},textcolor:{setting:\"textcolor\",type:\"ColorChooser\",id:s.idPrefix+\"textcolor\"},bgcolor:{setting:\"bgcolor\",type:\"ColorChooser\",id:s.idPrefix+\"bgcolor\"},padtop:{setting:\"padtop\",type:\"PopupList\",id:s.idPrefix+\"padtop\",initialdata:scc.SCFormatPadsizes},padright:{setting:\"padright\",type:\"PopupList\",id:s.idPrefix+\"padright\",initialdata:scc.SCFormatPadsizes},padbottom:{setting:\"padbottom\",type:\"PopupList\",id:s.idPrefix+\"padbottom\",initialdata:scc.SCFormatPadsizes},padleft:{setting:\"padleft\",type:\"PopupList\",id:s.idPrefix+\"padleft\",initialdata:scc.SCFormatPadsizes},colwidth:{setting:\"colwidth\",type:\"PopupList\",id:s.idPrefix+\"colwidth\",initialdata:scc.SCFormatColwidth},recalc:{setting:\"recalc\",type:\"PopupList\",id:s.idPrefix+\"recalc\",initialdata:scc.SCFormatRecalc}};viewobj.values.cellspanel={name:\"cell\",colorchooser:{id:s.idPrefix+\"scolorchooser\"},cformatnumber:{setting:\"numberformat\",type:\"PopupList\",id:s.idPrefix+\"cformatnumber\",initialdata:scc.SCFormatNumberFormats},cformattext:{setting:\"textformat\",type:\"PopupList\",id:s.idPrefix+\"cformattext\",initialdata:scc.SCFormatTextFormats},cfontfamily:{setting:\"fontfamily\",type:\"PopupList\",id:s.idPrefix+\"cfontfamily\",initialdata:scc.SCFormatFontfamilies},cfontlook:{setting:\"fontlook\",type:\"PopupList\",id:s.idPrefix+\"cfontlook\",initialdata:scc.SCFormatFontlook},cfontsize:{setting:\"fontsize\",type:\"PopupList\",id:s.idPrefix+\"cfontsize\",initialdata:scc.SCFormatFontsizes},calignhoriz:{setting:\"alignhoriz\",type:\"PopupList\",id:s.idPrefix+\"calignhoriz\",initialdata:scc.SCFormatTextAlignhoriz},calignvert:{setting:\"alignvert\",type:\"PopupList\",id:s.idPrefix+\"calignvert\",initialdata:scc.SCFormatAlignVertical},ctextcolor:{setting:\"textcolor\",type:\"ColorChooser\",id:s.idPrefix+\"ctextcolor\"},cbgcolor:{setting:\"bgcolor\",type:\"ColorChooser\",id:s.idPrefix+\"cbgcolor\"},cbt:{setting:\"bt\",type:\"BorderSide\",id:s.idPrefix+\"cbt\"},cbr:{setting:\"br\",type:\"BorderSide\",id:s.idPrefix+\"cbr\"},cbb:{setting:\"bb\",type:\"BorderSide\",id:s.idPrefix+\"cbb\"},cbl:{setting:\"bl\",type:\"BorderSide\",id:s.idPrefix+\"cbl\"},cpadtop:{setting:\"padtop\",type:\"PopupList\",id:s.idPrefix+\"cpadtop\",initialdata:scc.SCFormatPadsizes},cpadright:{setting:\"padright\",type:\"PopupList\",id:s.idPrefix+\"cpadright\",initialdata:scc.SCFormatPadsizes},cpadbottom:{setting:\"padbottom\",type:\"PopupList\",id:s.idPrefix+\"cpadbottom\",initialdata:scc.SCFormatPadsizes},cpadleft:{setting:\"padleft\",type:\"PopupList\",id:s.idPrefix+\"cpadleft\",initialdata:scc.SCFormatPadsizes}};SocialCalc.SettingsControlInitializePanel(viewobj.values.sheetspanel);SocialCalc.SettingsControlInitializePanel(viewobj.values.cellspanel);},replacements:{itemtitle:{regex:/\\%itemtitle\\./g,replacement:'style=\"padding:12px 10px 0px 10px;font-weight:bold;text-align:right;vertical-align:top;font-size:small;\"'},sectiontitle:{regex:/\\%sectiontitle\\./g,replacement:'style=\"padding:16px 10px 0px 0px;font-weight:bold;vertical-align:top;font-size:small;color:#C00;\"'},parttitle:{regex:/\\%parttitle\\./g,replacement:'style=\"font-weight:bold;font-size:x-small;padding:0px 0px 3px 0px;\"'},itembody:{regex:/\\%itembody\\./g,replacement:'style=\"padding:12px 0px 0px 0px;vertical-align:top;font-size:small;\"'},bodypart:{regex:/\\%bodypart\\./g,replacement:'style=\"padding:0px 10px 0px 0px;font-size:small;vertical-align:top;\"'}},divStyle:\"border:1px solid black;overflow:auto;\",html:'<div id=\"%id.scolorchooser\" style=\"display:none;position:absolute;z-index:20;\"></div>'+'<table cellspacing=\"0\" cellpadding=\"0\">'+' <tr><td style=\"vertical-align:top;\">'+'<table id=\"%id.sheetsettingstable\" style=\"display:none;\" cellspacing=\"0\" cellpadding=\"0\">'+'<tr>'+' <td %itemtitle.><br>%loc!Default Format!:</td>'+' <td %itembody.>'+'   <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+'    <td %bodypart.>'+'     <div %parttitle.>%loc!Number!</div>'+'     <span id=\"%id.formatnumber\"></span>'+'    </td>'+'    <td %bodypart.>'+'     <div %parttitle.>%loc!Text!</div>'+'     <span id=\"%id.formattext\"></span>'+'    </td>'+'   </tr></table>'+' </td>'+'</tr>'+'<tr>'+' <td %itemtitle.><br>%loc!Default Alignment!:</td>'+' <td %itembody.>'+'   <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+'    <td %bodypart.>'+'     <div %parttitle.>%loc!Text Horizontal!</div>'+'     <span id=\"%id.textalignhoriz\"></span>'+'    </td>'+'    <td %bodypart.>'+'     <div %parttitle.>%loc!Number Horizontal!</div>'+'     <span id=\"%id.numberalignhoriz\"></span>'+'    </td>'+'    <td %bodypart.>'+'     <div %parttitle.>%loc!Vertical!</div>'+'     <span id=\"%id.alignvert\"></span>'+'    </td>'+'   </tr></table>'+' </td>'+'</tr>'+'<tr>'+' <td %itemtitle.><br>%loc!Default Font!:</td>'+' <td %itembody.>'+'   <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+'    <td %bodypart.>'+'     <div %parttitle.>%loc!Family!</div>'+'     <span id=\"%id.fontfamily\"></span>'+'    </td>'+'    <td %bodypart.>'+'     <div %parttitle.>%loc!Bold &amp; Italics!</div>'+'     <span id=\"%id.fontlook\"></span>'+'    </td>'+'    <td %bodypart.>'+'     <div %parttitle.>%loc!Size!</div>'+'     <span id=\"%id.fontsize\"></span>'+'    </td>'+'    <td %bodypart.>'+'     <div %parttitle.>%loc!Color!</div>'+'     <div id=\"%id.textcolor\"></div>'+'    </td>'+'    <td %bodypart.>'+'     <div %parttitle.>%loc!Background!</div>'+'     <div id=\"%id.bgcolor\"></div>'+'    </td>'+'   </tr></table>'+' </td>'+'</tr>'+'<tr>'+' <td %itemtitle.><br>%loc!Default Padding!:</td>'+' <td %itembody.>'+'   <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+'    <td %bodypart.>'+'     <div %parttitle.>%loc!Top!</div>'+'     <span id=\"%id.padtop\"></span>'+'    </td>'+'    <td %bodypart.>'+'     <div %parttitle.>%loc!Right!</div>'+'     <span id=\"%id.padright\"></span>'+'    </td>'+'    <td %bodypart.>'+'     <div %parttitle.>%loc!Bottom!</div>'+'     <span id=\"%id.padbottom\"></span>'+'    </td>'+'    <td %bodypart.>'+'     <div %parttitle.>%loc!Left!</div>'+'     <span id=\"%id.padleft\"></span>'+'    </td>'+'   </tr></table>'+' </td>'+'</tr>'+'<tr>'+' <td %itemtitle.><br>%loc!Default Column Width!:</td>'+' <td %itembody.>'+'   <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+'    <td %bodypart.>'+'     <div %parttitle.>&nbsp;</div>'+'     <span id=\"%id.colwidth\"></span>'+'    </td>'+'   </tr></table>'+' </td>'+'</tr>'+'<tr>'+' <td %itemtitle.><br>%loc!Recalculation!:</td>'+' <td %itembody.>'+'   <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+'    <td %bodypart.>'+'     <div %parttitle.>&nbsp;</div>'+'     <span id=\"%id.recalc\"></span>'+'    </td>'+'   </tr></table>'+' </td>'+'</tr>'+'</table>'+'<table id=\"%id.cellsettingstable\" cellspacing=\"0\" cellpadding=\"0\">'+'<tr>'+' <td %itemtitle.><br>%loc!Format!:</td>'+' <td %itembody.>'+'   <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+'    <td %bodypart.>'+'     <div %parttitle.>%loc!Number!</div>'+'     <span id=\"%id.cformatnumber\"></span>'+'    </td>'+'    <td %bodypart.>'+'     <div %parttitle.>%loc!Text!</div>'+'     <span id=\"%id.cformattext\"></span>'+'    </td>'+'   </tr></table>'+' </td>'+'</tr>'+'<tr>'+' <td %itemtitle.><br>%loc!Alignment!:</td>'+' <td %itembody.>'+'   <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+'    <td %bodypart.>'+'     <div %parttitle.>%loc!Horizontal!</div>'+'     <span id=\"%id.calignhoriz\"></span>'+'    </td>'+'    <td %bodypart.>'+'     <div %parttitle.>%loc!Vertical!</div>'+'     <span id=\"%id.calignvert\"></span>'+'    </td>'+'   </tr></table>'+' </td>'+'</tr>'+'<tr>'+' <td %itemtitle.><br>%loc!Font!:</td>'+' <td %itembody.>'+'   <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+'    <td %bodypart.>'+'     <div %parttitle.>%loc!Family!</div>'+'     <span id=\"%id.cfontfamily\"></span>'+'    </td>'+'    <td %bodypart.>'+'     <div %parttitle.>%loc!Bold &amp; Italics!</div>'+'     <span id=\"%id.cfontlook\"></span>'+'    </td>'+'    <td %bodypart.>'+'     <div %parttitle.>%loc!Size!</div>'+'     <span id=\"%id.cfontsize\"></span>'+'    </td>'+'    <td %bodypart.>'+'     <div %parttitle.>%loc!Color!</div>'+'     <div id=\"%id.ctextcolor\"></div>'+'    </td>'+'    <td %bodypart.>'+'     <div %parttitle.>%loc!Background!</div>'+'     <div id=\"%id.cbgcolor\"></div>'+'    </td>'+'   </tr></table>'+' </td>'+'</tr>'+'<tr>'+' <td %itemtitle.><br>%loc!Borders!:</td>'+' <td %itembody.>'+'   <table cellspacing=\"0\" cellpadding=\"0\">'+'    <tr><td %bodypart. colspan=\"3\"><div %parttitle.>%loc!Top Border!</div></td>'+'     <td %bodypart. colspan=\"3\"><div %parttitle.>%loc!Right Border!</div></td>'+'     <td %bodypart. colspan=\"3\"><div %parttitle.>%loc!Bottom Border!</div></td>'+'     <td %bodypart. colspan=\"3\"><div %parttitle.>%loc!Left Border!</div></td>'+'    </tr><tr>'+'    <td %bodypart.>'+'     <input id=\"%id.cbt-onoff-bcb\" onclick=\"SocialCalc.SettingsControlOnchangeBorder(this);\" type=\"checkbox\">'+'    </td>'+'    <td %bodypart.>'+'     <div id=\"%id.cbt-color\"></div>'+'    </td>'+'    <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>'+'    <td %bodypart.>'+'     <input id=\"%id.cbr-onoff-bcb\" onclick=\"SocialCalc.SettingsControlOnchangeBorder(this);\" type=\"checkbox\">'+'    </td>'+'    <td %bodypart.>'+'     <div id=\"%id.cbr-color\"></div>'+'    </td>'+'    <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>'+'    <td %bodypart.>'+'     <input id=\"%id.cbb-onoff-bcb\" onclick=\"SocialCalc.SettingsControlOnchangeBorder(this);\" type=\"checkbox\">'+'    </td>'+'    <td %bodypart.>'+'     <div id=\"%id.cbb-color\"></div>'+'    </td>'+'    <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>'+'    <td %bodypart.>'+'     <input id=\"%id.cbl-onoff-bcb\" onclick=\"SocialCalc.SettingsControlOnchangeBorder(this);\" type=\"checkbox\">'+'    </td>'+'    <td %bodypart.>'+'     <div id=\"%id.cbl-color\"></div>'+'    </td>'+'    <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>'+'   </tr></table>'+' </td>'+'</tr>'+'<tr>'+' <td %itemtitle.><br>%loc!Padding!:</td>'+' <td %itembody.>'+'   <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+'    <td %bodypart.>'+'     <div %parttitle.>%loc!Top!</div>'+'     <span id=\"%id.cpadtop\"></span>'+'    </td>'+'    <td %bodypart.>'+'     <div %parttitle.>%loc!Right!</div>'+'     <span id=\"%id.cpadright\"></span>'+'    </td>'+'    <td %bodypart.>'+'     <div %parttitle.>%loc!Bottom!</div>'+'     <span id=\"%id.cpadbottom\"></span>'+'    </td>'+'    <td %bodypart.>'+'     <div %parttitle.>%loc!Left!</div>'+'     <span id=\"%id.cpadleft\"></span>'+'    </td>'+'   </tr></table>'+' </td>'+'</tr>'+'</table>'+' </td><td style=\"vertical-align:top;padding:12px 0px 0px 12px;\">'+'  <div style=\"width:100px;height:100px;overflow:hidden;border:1px solid black;background-color:#EEE;padding:6px;\">'+'   <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+'    <td id=\"sample-text\" style=\"height:100px;width:100px;\"><div>%loc!This is a<br>sample!</div><div>-1234.5</div></td>'+'   </tr></table>'+'  </div>'+' </td></tr></table>'+'<br>'};// Sort\n\tthis.tabnums.sort=this.tabs.length;this.tabs.push({name:\"sort\",text:\"Sort\",html:' <div id=\"%id.sorttools\" style=\"display:none;\">'+'  <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+'   <td style=\"vertical-align:top;padding-right:4px;width:160px;\">'+'    <div style=\"%tbt.\">%loc!Set Cells To Sort!</div>'+'    <select id=\"%id.sortlist\" size=\"1\" onfocus=\"%s.CmdGotFocus(this);\"><option selected>[select range]</option></select>'+'    <input type=\"button\" value=\"%loc!OK!\" onclick=\"%s.DoCmd(this, \\'ok-setsort\\');\" style=\"font-size:x-small;\">'+'   </td>'+'   <td style=\"vertical-align:middle;padding-right:16px;width:100px;text-align:right;\">'+'    <div style=\"%tbt.\">&nbsp;</div>'+'    <input type=\"button\" id=\"%id.sortbutton\" value=\"%loc!Sort Cells! A1:A1\" onclick=\"%s.DoCmd(this, \\'dosort\\');\" style=\"visibility:hidden;\">'+'   </td>'+'   <td style=\"vertical-align:top;padding-right:16px;\">'+'    <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+'     <td style=\"vertical-align:top;\">'+'      <div style=\"%tbt.\">%loc!Major Sort!</div>'+'      <select id=\"%id.majorsort\" size=\"1\" onfocus=\"%s.CmdGotFocus(this);\"></select>'+'     </td><td>'+'      <input type=\"radio\" name=\"majorsort\" id=\"%id.majorsortup\" value=\"up\" checked><span style=\"font-size:x-small;color:#FFF;\">%loc!Up!</span><br>'+'      <input type=\"radio\" name=\"majorsort\" id=\"%id.majorsortdown\" value=\"down\"><span style=\"font-size:x-small;color:#FFF;\">%loc!Down!</span>'+'     </td>'+'    </tr></table>'+'   </td>'+'   <td style=\"vertical-align:top;padding-right:16px;\">'+'    <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+'     <td style=\"vertical-align:top;\">'+'      <div style=\"%tbt.\">%loc!Minor Sort!</div>'+'      <select id=\"%id.minorsort\" size=\"1\" onfocus=\"%s.CmdGotFocus(this);\"></select>'+'     </td><td>'+'      <input type=\"radio\" name=\"minorsort\" id=\"%id.minorsortup\" value=\"up\" checked><span style=\"font-size:x-small;color:#FFF;\">%loc!Up!</span><br>'+'      <input type=\"radio\" name=\"minorsort\" id=\"%id.minorsortdown\" value=\"down\"><span style=\"font-size:x-small;color:#FFF;\">%loc!Down!</span>'+'     </td>'+'    </tr></table>'+'   </td>'+'   <td style=\"vertical-align:top;padding-right:16px;\">'+'    <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+'     <td style=\"vertical-align:top;\">'+'      <div style=\"%tbt.\">%loc!Last Sort!</div>'+'      <select id=\"%id.lastsort\" size=\"1\" onfocus=\"%s.CmdGotFocus(this);\"></select>'+'     </td><td>'+'      <input type=\"radio\" name=\"lastsort\" id=\"%id.lastsortup\" value=\"up\" checked><span style=\"font-size:x-small;color:#FFF;\">%loc!Up!</span><br>'+'      <input type=\"radio\" name=\"lastsort\" id=\"%id.lastsortdown\" value=\"down\"><span style=\"font-size:x-small;color:#FFF;\">%loc!Down!</span>'+'     </td>'+'    </tr></table>'+'   </td>'+'  </tr></table>'+' </div>',onclick:SocialCalc.SpreadsheetControlSortOnclick});this.editor.SettingsCallbacks.sort={save:SocialCalc.SpreadsheetControlSortSave,load:SocialCalc.SpreadsheetControlSortLoad};// Audit\n\tthis.tabnums.audit=this.tabs.length;this.tabs.push({name:\"audit\",text:\"Audit\",html:'<div id=\"%id.audittools\" style=\"display:none;\">'+' <div style=\"%tbt.\">&nbsp;</div>'+'</div>',view:\"audit\",onclick:function onclick(s,t){var SCLoc=SocialCalc.LocalizeString;var i,j;var str='<table cellspacing=\"0\" cellpadding=\"0\" style=\"margin-bottom:10px;\"><tr><td style=\"font-size:small;padding:6px;\"><b>'+SCLoc(\"Audit Trail This Session\")+':</b><br><br>';var stack=s.sheet.changes.stack;var tos=s.sheet.changes.tos;for(i=0;i<stack.length;i++){if(i==tos+1)str+='<br></td></tr><tr><td style=\"font-size:small;background-color:#EEE;padding:6px;\">'+SCLoc(\"UNDONE STEPS\")+':<br>';for(j=0;j<stack[i].command.length;j++){str+=SocialCalc.special_chars(stack[i].command[j])+\"<br>\";}}s.views.audit.element.innerHTML=str+\"</td></tr></table>\";SocialCalc.CmdGotFocus(true);},onclickFocus:true});this.views[\"audit\"]={name:\"audit\",divStyle:\"border:1px solid black;overflow:auto;\",html:'Audit Trail'};// Comment\n\tthis.tabnums.comment=this.tabs.length;this.tabs.push({name:\"comment\",text:\"Comment\",html:'<div id=\"%id.commenttools\" style=\"display:none;\">'+'<table cellspacing=\"0\" cellpadding=\"0\"><tr><td>'+'<textarea id=\"%id.commenttext\" style=\"font-size:small;height:32px;width:600px;overflow:auto;\" onfocus=\"%s.CmdGotFocus(this);\"></textarea>'+'</td><td style=\"vertical-align:top;\">'+'&nbsp;<input type=\"button\" value=\"%loc!Save!\" onclick=\"%s.SpreadsheetControlCommentSet();\" style=\"font-size:x-small;\">'+'</td></tr></table>'+'</div>',view:\"sheet\",onclick:SocialCalc.SpreadsheetControlCommentOnclick,onunclick:SocialCalc.SpreadsheetControlCommentOnunclick});// Names\n\tthis.tabnums.names=this.tabs.length;this.tabs.push({name:\"names\",text:\"Names\",html:'<div id=\"%id.namestools\" style=\"display:none;\">'+'  <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+'   <td style=\"vertical-align:top;padding-right:24px;\">'+'    <div style=\"%tbt.\">%loc!Existing Names!</div>'+'    <select id=\"%id.nameslist\" size=\"1\" onchange=\"%s.SpreadsheetControlNamesChangedName();\" onfocus=\"%s.CmdGotFocus(this);\"><option selected>[New]</option></select>'+'   </td>'+'   <td style=\"vertical-align:top;padding-right:6px;\">'+'    <div style=\"%tbt.\">%loc!Name!</div>'+'    <input type=\"text\" id=\"%id.namesname\" style=\"font-size:x-small;width:75px;\" onfocus=\"%s.CmdGotFocus(this);\">'+'   </td>'+'   <td style=\"vertical-align:top;padding-right:6px;\">'+'    <div style=\"%tbt.\">%loc!Description!</div>'+'    <input type=\"text\" id=\"%id.namesdesc\" style=\"font-size:x-small;width:150px;\" onfocus=\"%s.CmdGotFocus(this);\">'+'   </td>'+'   <td style=\"vertical-align:top;padding-right:6px;\">'+'    <div style=\"%tbt.\">%loc!Value!</div>'+'    <input type=\"text\" id=\"%id.namesvalue\" width=\"16\" style=\"font-size:x-small;width:100px;\" onfocus=\"%s.CmdGotFocus(this);\">'+'   </td>'+'   <td style=\"vertical-align:top;padding-right:12px;width:100px;\">'+'    <div style=\"%tbt.\">%loc!Set Value To!</div>'+'    <input type=\"button\" id=\"%id.namesrangeproposal\" value=\"A1\" onclick=\"%s.SpreadsheetControlNamesSetValue();\" style=\"font-size:x-small;\">'+'   </td>'+'   <td style=\"vertical-align:top;padding-right:6px;\">'+'    <div style=\"%tbt.\">&nbsp;</div>'+'    <input type=\"button\" value=\"%loc!Save!\" onclick=\"%s.SpreadsheetControlNamesSave();\" style=\"font-size:x-small;\">'+'    <input type=\"button\" value=\"%loc!Delete!\" onclick=\"%s.SpreadsheetControlNamesDelete()\" style=\"font-size:x-small;\">'+'   </td>'+'  </tr></table>'+'</div>',view:\"sheet\",onclick:SocialCalc.SpreadsheetControlNamesOnclick,onunclick:SocialCalc.SpreadsheetControlNamesOnunclick});// Clipboard\n\tthis.tabnums.clipboard=this.tabs.length;this.tabs.push({name:\"clipboard\",text:\"Clipboard\",html:'<div id=\"%id.clipboardtools\" style=\"display:none;\">'+'  <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+'   <td style=\"vertical-align:top;padding-right:24px;\">'+'    <div style=\"%tbt.\">'+'     &nbsp;'+'    </div>'+'   </td>'+'  </tr></table>'+'</div>',view:\"clipboard\",onclick:SocialCalc.SpreadsheetControlClipboardOnclick,onclickFocus:\"clipboardtext\"});this.views[\"clipboard\"]={name:\"clipboard\",divStyle:\"overflow:auto;\",html:' <div style=\"font-size:x-small;padding:5px 0px 10px 0px;\">'+'  <b>%loc!Display Clipboard in!:</b>'+'  <input type=\"radio\" id=\"%id.clipboardformat-tab\" name=\"%id.clipboardformat\" checked onclick=\"%s.SpreadsheetControlClipboardFormat(\\'tab\\');\"> %loc!Tab-delimited format! &nbsp;'+'  <input type=\"radio\" id=\"%id.clipboardformat-csv\" name=\"%id.clipboardformat\" onclick=\"%s.SpreadsheetControlClipboardFormat(\\'csv\\');\"> %loc!CSV format! &nbsp;'+'  <input type=\"radio\" id=\"%id.clipboardformat-scsave\" name=\"%id.clipboardformat\" onclick=\"%s.SpreadsheetControlClipboardFormat(\\'scsave\\');\"> %loc!SocialCalc-save format!'+' </div>'+' <input type=\"button\" value=\"%loc!Load SocialCalc Clipboard With This!\" style=\"font-size:x-small;\" onclick=\"%s.SpreadsheetControlClipboardLoad();\">&nbsp; '+' <input type=\"button\" value=\"%loc!Clear SocialCalc Clipboard!\" style=\"font-size:x-small;\" onclick=\"%s.SpreadsheetControlClipboardClear();\">&nbsp; '+' <br>'+' <textarea id=\"%id.clipboardtext\" style=\"font-size:small;height:350px;width:800px;overflow:auto;\" onfocus=\"%s.CmdGotFocus(this);\"></textarea>'};return;};// Methods:\n\tSocialCalc.SpreadsheetControl.prototype.InitializeSpreadsheetControl=function(node,height,width,spacebelow){return SocialCalc.InitializeSpreadsheetControl(this,node,height,width,spacebelow);};SocialCalc.SpreadsheetControl.prototype.DoOnResize=function(){return SocialCalc.DoOnResize(this);};SocialCalc.SpreadsheetControl.prototype.SizeSSDiv=function(){return SocialCalc.SizeSSDiv(this);};SocialCalc.SpreadsheetControl.prototype.ExecuteCommand=function(combostr,sstr){return SocialCalc.SpreadsheetControlExecuteCommand(this,combostr,sstr);};SocialCalc.SpreadsheetControl.prototype.CreateSheetHTML=function(){return SocialCalc.SpreadsheetControlCreateSheetHTML(this);};SocialCalc.SpreadsheetControl.prototype.CreateSpreadsheetSave=function(otherparts){return SocialCalc.SpreadsheetControlCreateSpreadsheetSave(this,otherparts);};SocialCalc.SpreadsheetControl.prototype.DecodeSpreadsheetSave=function(str){return SocialCalc.SpreadsheetControlDecodeSpreadsheetSave(this,str);};SocialCalc.SpreadsheetControl.prototype.CreateCellHTML=function(coord){return SocialCalc.SpreadsheetControlCreateCellHTML(this,coord);};SocialCalc.SpreadsheetControl.prototype.CreateCellHTMLSave=function(range){return SocialCalc.SpreadsheetControlCreateCellHTMLSave(this,range);};// Sheet Methods to make things a little easier:\n\tSocialCalc.SpreadsheetControl.prototype.ParseSheetSave=function(str){return this.sheet.ParseSheetSave(str);};SocialCalc.SpreadsheetControl.prototype.CreateSheetSave=function(){return this.sheet.CreateSheetSave();};// Functions:\n\t//\n\t// InitializeSpreadsheetControl(spreadsheet, node, height, width, spacebelow)\n\t//\n\t// Creates the control elements and makes them the child of node (string or element).\n\t// If present, height and width specify size.\n\t// If either is 0 or null (missing), the maximum that fits on the screen\n\t// (taking spacebelow into account) is used.\n\t//\n\t// Displays the tabs and creates the views (other than \"sheet\").\n\t// The first tab is set as selected, but onclick is not invoked.\n\t//\n\t// You should do a redisplay or recalc (which redisplays) after running this.\n\t//\n\tSocialCalc.InitializeSpreadsheetControl=function(spreadsheet,node,height,width,spacebelow){var scc=SocialCalc.Constants;var SCLoc=SocialCalc.LocalizeString;var SCLocSS=SocialCalc.LocalizeSubstrings;var html,child,i,vname,v,style,button,bele;var tabs=spreadsheet.tabs;var views=spreadsheet.views;spreadsheet.requestedHeight=height;spreadsheet.requestedWidth=width;spreadsheet.requestedSpaceBelow=spacebelow;if(typeof node==\"string\")node=document.getElementById(node);if(node==null){alert(\"SocialCalc.SpreadsheetControl not given parent node.\");}spreadsheet.parentNode=node;// create node to hold spreadsheet control\n\tspreadsheet.spreadsheetDiv=document.createElement(\"div\");spreadsheet.SizeSSDiv();// calculate and fill in the size values\n\tfor(child=node.firstChild;child!=null;child=node.firstChild){node.removeChild(child);}// create the tabbed UI at the top\n\thtml='<div><div style=\"'+spreadsheet.toolbarbackground+'padding:12px 10px 10px 4px;height:0px;display:none;\">';for(i=0;i<tabs.length;i++){html+=tabs[i].html;}html+='</div>'+'<div style=\"'+spreadsheet.tabbackground+'padding-bottom:4px;margin:0px 0px 8px 0px;display:none;\">'+'<table cellpadding=\"0\" cellspacing=\"0\"><tr>';for(i=0;i<tabs.length;i++){html+='  <td id=\"%id.'+tabs[i].name+'tab\" style=\"'+(i==0?spreadsheet.tabselectedCSS:spreadsheet.tabplainCSS)+'\" onclick=\"%s.SetTab(this);\">'+SCLoc(tabs[i].text)+'</td>';}html+=' </tr></table></div></div>';spreadsheet.currentTab=0;// this is where we started\n\tfor(style in spreadsheet.tabreplacements){html=html.replace(spreadsheet.tabreplacements[style].regex,spreadsheet.tabreplacements[style].replacement);}html=html.replace(/\\%s\\./g,\"SocialCalc.\");html=html.replace(/\\%id\\./g,spreadsheet.idPrefix);html=html.replace(/\\%tbt\\./g,spreadsheet.toolbartext);html=html.replace(/\\%img\\./g,spreadsheet.imagePrefix);html=SCLocSS(html);// localize with %loc!string! and %scc!constant!\n\tspreadsheet.spreadsheetDiv.innerHTML=html;node.appendChild(spreadsheet.spreadsheetDiv);// Initialize SocialCalc buttons\n\tspreadsheet.Buttons={button_undo:{tooltip:\"Undo\",command:\"undo\"},button_redo:{tooltip:\"Redo\",command:\"redo\"},button_copy:{tooltip:\"Copy\",command:\"copy\"},button_cut:{tooltip:\"Cut\",command:\"cut\"},button_paste:{tooltip:\"Paste\",command:\"paste\"},button_pasteformats:{tooltip:\"Paste Formats\",command:\"pasteformats\"},button_delete:{tooltip:\"Delete Contents\",command:\"delete\"},button_filldown:{tooltip:\"Fill Down\",command:\"filldown\"},button_fillright:{tooltip:\"Fill Right\",command:\"fillright\"},button_movefrom:{tooltip:\"Set/Clear Move From\",command:\"movefrom\"},button_movepaste:{tooltip:\"Move Paste\",command:\"movepaste\"},button_moveinsert:{tooltip:\"Move Insert\",command:\"moveinsert\"},button_alignleft:{tooltip:\"Align Left\",command:\"align-left\"},button_aligncenter:{tooltip:\"Align Center\",command:\"align-center\"},button_alignright:{tooltip:\"Align Right\",command:\"align-right\"},button_borderon:{tooltip:\"Borders On\",command:\"borderon\"},button_borderoff:{tooltip:\"Borders Off\",command:\"borderoff\"},button_swapcolors:{tooltip:\"Swap Colors\",command:\"swapcolors\"},button_merge:{tooltip:\"Merge Cells\",command:\"merge\"},button_unmerge:{tooltip:\"Unmerge Cells\",command:\"unmerge\"},button_insertrow:{tooltip:\"Insert Row\",command:\"insertrow\"},button_insertcol:{tooltip:\"Insert Column\",command:\"insertcol\"},button_deleterow:{tooltip:\"Delete Row\",command:\"deleterow\"},button_deletecol:{tooltip:\"Delete Column\",command:\"deletecol\"},button_recalc:{tooltip:\"Recalc\",command:\"recalc\"}};for(button in spreadsheet.Buttons){bele=document.getElementById(spreadsheet.idPrefix+button);if(!bele){/*alert(\"Button \"+(spreadsheet.idPrefix+button)+\" missing\");*/continue;}bele.style.border=\"1px solid \"+scc.ISCButtonBorderNormal;SocialCalc.TooltipRegister(bele,SCLoc(spreadsheet.Buttons[button].tooltip),{});SocialCalc.ButtonRegister(bele,{normalstyle:\"border:1px solid \"+scc.ISCButtonBorderNormal+\";backgroundColor:\"+scc.ISCButtonBorderNormal+\";\",hoverstyle:\"border:1px solid \"+scc.ISCButtonBorderHover+\";backgroundColor:\"+scc.ISCButtonBorderNormal+\";\",downstyle:\"border:1px solid \"+scc.ISCButtonBorderDown+\";backgroundColor:\"+scc.ISCButtonDownBackground+\";\"},{MouseDown:SocialCalc.DoButtonCmd,command:spreadsheet.Buttons[button].command});}// create formula bar\n\tspreadsheet.dummyFormulaDiv=document.createElement(\"div\");spreadsheet.dummyFormulaDiv.style.height=spreadsheet.formulabarheight+\"px\";spreadsheet.spreadsheetDiv.appendChild(spreadsheet.dummyFormulaDiv);spreadsheet.formulabarDiv=document.createElement(\"div\");spreadsheet.formulabarDiv.id=\"formulabardiv\";spreadsheet.formulabarDiv.style.height=spreadsheet.formulabarheight+\"px\";spreadsheet.formulabarDiv.innerHTML='<input type=\"text\" size=\"20\" value=\"\" disabled=\"true\">';//'<textarea rows=\"4\" cols=\"60\" style=\"z-index:5;background-color:white;position:relative;\"></textarea>&nbsp;';\n\t//spreadsheet.spreadsheetDiv.appendChild(spreadsheet.formulabarDiv);\n\tvar inputbox=new SocialCalc.InputBox(spreadsheet.formulabarDiv.firstChild,spreadsheet.editor);bele=document.createElement(\"img\");bele.id=\"testtest\";bele.src=\"lib/aspiring/www/assets/images/delete24.png\";bele.style.verticalAlign=\"middle\";//bele.style.border = \"1px solid #FFF\";\n\t//bele.style.marginLeft = \"4px\";   \n\tbele.style.display=\"none\";SocialCalc.ButtonRegister(bele,{normalstyle:\"\",hoverstyle:\"\",downstyle:\"\"},{MouseDown:SocialCalc.InputLineClearText});// spreadsheet.formulabarDiv.appendChild(bele);\n\t/*\n\t   for (button in spreadsheet.formulabuttons) {\n\t      bele = document.createElement(\"img\");\n\t      bele.id = spreadsheet.idPrefix+button;\n\t      bele.src = spreadsheet.imagePrefix+spreadsheet.formulabuttons[button].image;\n\t      bele.style.verticalAlign = \"middle\";\n\t      bele.style.border = \"1px solid #FFF\";\n\t      bele.style.marginLeft = \"4px\";\n\t      SocialCalc.TooltipRegister(bele, SCLoc(spreadsheet.formulabuttons[button].tooltip), {});\n\t      SocialCalc.ButtonRegister(bele,\n\t         {normalstyle: \"border:1px solid #FFF;backgroundColor:#FFF;\",\n\t          hoverstyle: \"border:1px solid #CCC;backgroundColor:#FFF;\",\n\t          downstyle: \"border:1px solid #000;backgroundColor:#FFF;\"}, \n\t         {MouseDown: spreadsheet.formulabuttons[button].command});\n\t      spreadsheet.formulabarDiv.appendChild(bele);\n\t      }\n\t   */// initialize tabs that need it\n\tfor(i=0;i<tabs.length;i++){// execute any tab-specific initialization code\n\tif(tabs[i].oncreate){tabs[i].oncreate(spreadsheet,tabs[i].name);}}// create sheet view and others\n\tif(!scc.doWorkBook){spreadsheet.nonviewheight=spreadsheet.statuslineheight+spreadsheet.spreadsheetDiv.firstChild.offsetHeight+spreadsheet.spreadsheetDiv.lastChild.offsetHeight;}else{spreadsheet.nonviewheight=28+spreadsheet.sheetbarheight+spreadsheet.spreadsheetDiv.firstChild.offsetHeight+spreadsheet.spreadsheetDiv.lastChild.offsetHeight;}spreadsheet.viewheight=spreadsheet.height-spreadsheet.nonviewheight;spreadsheet.editorDiv=spreadsheet.editor.CreateTableEditor(spreadsheet.width,spreadsheet.viewheight);spreadsheet.spreadsheetDiv.appendChild(spreadsheet.editorDiv);for(vname in views){html=views[vname].html;for(style in views[vname].replacements){html=html.replace(views[vname].replacements[style].regex,views[vname].replacements[style].replacement);}html=html.replace(/\\%s\\./g,\"SocialCalc.\");html=html.replace(/\\%id\\./g,spreadsheet.idPrefix);html=html.replace(/\\%tbt\\./g,spreadsheet.toolbartext);html=html.replace(/\\%img\\./g,spreadsheet.imagePrefix);v=document.createElement(\"div\");SocialCalc.setStyles(v,views[vname].divStyle);v.style.display=\"none\";v.style.width=spreadsheet.width+\"px\";v.style.height=spreadsheet.viewheight+\"px\";html=SCLocSS(html);// localize with %loc!string!, etc.\n\tv.innerHTML=html;spreadsheet.spreadsheetDiv.appendChild(v);views[vname].element=v;if(views[vname].oncreate){views[vname].oncreate(spreadsheet,views[vname]);}}views.sheet={name:\"sheet\",element:spreadsheet.editorDiv};// create statusline\n\tif(!scc.doWorkBook){spreadsheet.statuslineDiv=document.createElement(\"div\");spreadsheet.statuslineDiv.style.cssText=spreadsheet.statuslineCSS;//   spreadsheet.statuslineDiv.style.height = spreadsheet.statuslineheight + \"px\"; // didn't take padding into account!\n\tspreadsheet.statuslineDiv.style.height=spreadsheet.statuslineheight-(spreadsheet.statuslineDiv.style.paddingTop.slice(0,-2)-0)-(spreadsheet.statuslineDiv.style.paddingBottom.slice(0,-2)-0)+\"px\";spreadsheet.statuslineDiv.id=spreadsheet.idPrefix+\"statusline\";spreadsheet.spreadsheetDiv.appendChild(spreadsheet.statuslineDiv);}else{SocialCalc.CreateSheetStatusBar(spreadsheet,scc);}// done - refresh screen needed\n\treturn;};SocialCalc.CreateSheetStatusBar=function(spreadsheet,scc){// create sheetbar\n\tif(!scc.doWorkBook){return;}// create a table with 1 row, containing 3 columns, 1 for sheetbar, 1 for separator, 1 for statusline\n\tspreadsheet.sheetstatusbarDiv=document.createElement(\"div\");spreadsheet.sheetstatusbarDiv.style.height=spreadsheet.sheetbarheight+3+\"px\";spreadsheet.sheetstatusbarDiv.style.backgroundColor=\"#CCC\";spreadsheet.sheetstatusbarDiv.id=spreadsheet.idPrefix+\"sheetstatusbar\";spreadsheet.sheetbarDiv=document.createElement(\"div\");//spreadsheet.sheetbarDiv.style.cssText = spreadsheet.sheetbarCSS;\n\tspreadsheet.sheetbarDiv.id=spreadsheet.idPrefix+\"sheetbar\";spreadsheet.statuslineDiv=document.createElement(\"div\");spreadsheet.statuslineDiv.style.cssText=spreadsheet.statuslineCSS;spreadsheet.statuslineDiv.id=spreadsheet.idPrefix+\"statusline\";var table=document.createElement(\"table\");spreadsheet.sheetstatusbartable=table;table.cellSpacing=0;table.cellPadding=0;table.width=\"100%\";var tbody=document.createElement(\"tbody\");table.appendChild(tbody);var tr=document.createElement(\"tr\");tbody.appendChild(tr);var td=document.createElement(\"td\");td.appendChild(spreadsheet.sheetbarDiv);td.width=scc.SCSheetBarWidth;tr.appendChild(td);td=document.createElement(\"td\");td.innerHTML=\"<span>&nbsp|&nbsp</span>\";td.width=\"1%\";tr.appendChild(td);td=document.createElement(\"td\");td.appendChild(spreadsheet.statuslineDiv);tr.appendChild(td);spreadsheet.sheetstatusbarDiv.appendChild(table);spreadsheet.spreadsheetDiv.appendChild(spreadsheet.sheetstatusbarDiv);spreadsheet.sheetstatusbarDiv.style.display=\"none\";};//\n\t// outstr = SocialCalc.LocalizeString(str)\n\t//\n\t// SocialCalc function to make localization easier.\n\t// If str is \"Text to localize\", it returns\n\t// SocialCalc.Constants.s_loc_text_to_localize if\n\t// it exists, or else with just \"Text to localize\".\n\t// Note that spaces are replaced with \"_\" and other special\n\t// chars with \"X\" in the name of the constant (e.g., \"A & B\"\n\t// would look for SocialCalc.Constants.s_loc_a_X_b.\n\t//\n\tSocialCalc.LocalizeString=function(str){var cstr=SocialCalc.LocalizeStringList[str];// found already this session?\n\tif(!cstr){// no - look up\n\tcstr=SocialCalc.Constants[\"s_loc_\"+str.toLowerCase().replace(/\\s/g,\"_\").replace(/\\W/g,\"X\")]||str;SocialCalc.LocalizeStringList[str]=cstr;}return cstr;};SocialCalc.LocalizeStringList={};// a list of strings to localize accumulated by the routine\n\t//\n\t// outstr = SocialCalc.LocalizeSubstrings(str)\n\t//\n\t// SocialCalc function to make localization easier using %loc and %scc.\n\t//\n\t// Replaces sections of str with:\n\t//    %loc!Text to localize!\n\t// with SocialCalc.Constants.s_loc_text_to_localize if\n\t// it exists, or else with just \"Text to localize\".\n\t// Note that spaces are replaced with \"_\" and other special\n\t// chars with \"X\" in the name of the constant (e.g., %loc!A & B!\n\t// would look for SocialCalc.Constants.s_loc_a_X_b.\n\t// Uses SocialCalc.LocalizeString for this.\n\t//\n\t// Replaces sections of str with:\n\t//    %ssc!constant-name!\n\t// with SocialCalc.Constants.constant-name.\n\t// If the constant doesn't exist, throws and alert.\n\t//\n\tSocialCalc.LocalizeSubstrings=function(str){var SCLoc=SocialCalc.LocalizeString;return str.replace(/%(loc|ssc)!(.*?)!/g,function(a,t,c){if(t==\"ssc\"){return SocialCalc.Constants[c]||alert(\"Missing constant: \"+c);}else{return SCLoc(c);}});};//\n\t// obj = GetSpreadsheetControlObject()\n\t//\n\t// Returns the current spreadsheet control object\n\t//\n\tSocialCalc.GetSpreadsheetControlObject=function(){var csco=SocialCalc.CurrentSpreadsheetControlObject;if(csco)return csco;//   throw (\"No current SpreadsheetControl object.\");\n\t};//\n\t// SocialCalc.DoOnResize(spreadsheet)\n\t//\n\t// Processes an onResize event, setting the different views.\n\t//\n\tSocialCalc.DoOnResize=function(spreadsheet){var v;var views=spreadsheet.views;var needresize=spreadsheet.SizeSSDiv();if(!needresize)return;for(vname in views){v=views[vname].element;v.style.width=spreadsheet.width+\"px\";v.style.height=spreadsheet.height-spreadsheet.nonviewheight+\"px\";}spreadsheet.editor.ResizeTableEditor(spreadsheet.width,spreadsheet.height-spreadsheet.nonviewheight);};//\n\t// resized = SocialCalc.SizeSSDiv(spreadsheet)\n\t//\n\t// Figures out a reasonable size for the spreadsheet, given any requested values and viewport.\n\t// Sets ssdiv to that.\n\t// Return true if different than existing values.\n\t//\n\tSocialCalc.SizeSSDiv=function(spreadsheet){var sizes,pos,resized,nodestyle,newval;var fudgefactorX=10;// for IE\n\tvar fudgefactorY=10;resized=false;sizes=SocialCalc.GetViewportInfo();pos=SocialCalc.GetElementPosition(spreadsheet.parentNode);pos.bottom=0;pos.right=0;nodestyle=spreadsheet.parentNode.style;if(nodestyle.marginTop){pos.top+=nodestyle.marginTop.slice(0,-2)-0;}if(nodestyle.marginBottom){pos.bottom+=nodestyle.marginBottom.slice(0,-2)-0;}if(nodestyle.marginLeft){pos.left+=nodestyle.marginLeft.slice(0,-2)-0;}if(nodestyle.marginRight){pos.right+=nodestyle.marginRight.slice(0,-2)-0;}newval=spreadsheet.requestedHeight||sizes.height-(pos.top+pos.bottom+fudgefactorY)-(spreadsheet.requestedSpaceBelow||0);if(spreadsheet.height!=newval){spreadsheet.height=newval;spreadsheet.spreadsheetDiv.style.height=newval+\"px\";resized=true;}newval=spreadsheet.requestedWidth||sizes.width-(pos.left+pos.right+fudgefactorX)||700;if(spreadsheet.width!=newval){spreadsheet.width=newval;spreadsheet.spreadsheetDiv.style.width=newval+\"px\";resized=true;}return resized;};//\n\t// SocialCalc.SetTab(obj)\n\t//\n\t// The obj argument is either a string with the tab name or a DOM element with an ID\n\t//\n\tSocialCalc.SetTab=function(obj){var newtab,tname,newtabnum,newview,i,vname,ele;var menutabs={};var tools={};var spreadsheet=SocialCalc.GetSpreadsheetControlObject();var tabs=spreadsheet.tabs;var views=spreadsheet.views;if(typeof obj==\"string\"){newtab=obj;}else{newtab=obj.id.slice(spreadsheet.idPrefix.length,-3);}if(spreadsheet.editor.busy&&(// if busy and switching from \"sheet\", ignore\n\t!tabs[spreadsheet.currentTab].view||tabs[spreadsheet.currentTab].view==\"sheet\")){for(i=0;i<tabs.length;i++){if(tabs[i].name==newtab&&tabs[i].view&&tabs[i].view!=\"sheet\"){return;}}}if(spreadsheet.tabs[spreadsheet.currentTab].onunclick){spreadsheet.tabs[spreadsheet.currentTab].onunclick(spreadsheet,spreadsheet.tabs[spreadsheet.currentTab].name);}for(i=0;i<tabs.length;i++){tname=tabs[i].name;menutabs[tname]=document.getElementById(spreadsheet.idPrefix+tname+\"tab\");tools[tname]=document.getElementById(spreadsheet.idPrefix+tname+\"tools\");if(tname==newtab){newtabnum=i;tools[tname].style.display=\"block\";menutabs[tname].style.cssText=spreadsheet.tabselectedCSS;}else{tools[tname].style.display=\"none\";menutabs[tname].style.cssText=spreadsheet.tabplainCSS;}}spreadsheet.currentTab=newtabnum;if(tabs[newtabnum].onclick){tabs[newtabnum].onclick(spreadsheet,newtab);}for(vname in views){if(!tabs[newtabnum].view&&vname==\"sheet\"||tabs[newtabnum].view==vname){views[vname].element.style.display=\"block\";newview=vname;}else{views[vname].element.style.display=\"none\";}}if(tabs[newtabnum].onclickFocus){ele=tabs[newtabnum].onclickFocus;if(typeof ele==\"string\"){ele=document.getElementById(spreadsheet.idPrefix+ele);ele.focus();}SocialCalc.CmdGotFocus(ele);}else{SocialCalc.KeyboardFocus();}if(views[newview].needsresize&&views[newview].onresize){views[newview].needsresize=false;views[newview].onresize(spreadsheet,views[newview]);}if(newview==\"sheet\"){spreadsheet.statuslineDiv.style.display=\"block\";spreadsheet.editor.ScheduleRender();}else{spreadsheet.statuslineDiv.style.display=\"none\";}return;};//\n\t// SocialCalc.SpreadsheetControlStatuslineCallback\n\t//\n\tSocialCalc.SpreadsheetControlStatuslineCallback=function(editor,status,arg,params){var rele1,rele2;var ele=document.getElementById(params.statuslineid);if(ele){ele.innerHTML=editor.GetStatuslineString(status,arg,params);}switch(status){case\"cmdendnorender\":case\"calcfinished\":case\"doneposcalc\":rele1=document.getElementById(params.recalcid1);rele2=document.getElementById(params.recalcid2);if(!rele1||!rele2)break;if(editor.context.sheetobj.attribs.needsrecalc==\"yes\"){rele1.style.display=\"inline\";rele2.style.display=\"inline\";}else{rele1.style.display=\"none\";rele2.style.display=\"none\";}break;default:break;}};//\n\t// SocialCalc.UpdateSortRangeProposal(editor)\n\t//\n\t// Updates sort range proposed in the UI in element idPrefix+sortlist\n\t//\n\tSocialCalc.UpdateSortRangeProposal=function(editor){var ele=document.getElementById(SocialCalc.GetSpreadsheetControlObject().idPrefix+\"sortlist\");if(editor.range.hasrange){ele.options[0].text=SocialCalc.crToCoord(editor.range.left,editor.range.top)+\":\"+SocialCalc.crToCoord(editor.range.right,editor.range.bottom);}else{ele.options[0].text=SocialCalc.LocalizeString(\"[select range]\");}};//\n\t// SocialCalc.LoadColumnChoosers(spreadsheet)\n\t//\n\t// Updates list of columns for choosing which to sort for Major, Minor, and Last sort\n\t//\n\tSocialCalc.LoadColumnChoosers=function(spreadsheet){var SCLoc=SocialCalc.LocalizeString;var sortrange,nrange,rparts,col,colname,sele,oldindex;if(spreadsheet.sortrange&&spreadsheet.sortrange.indexOf(\":\")==-1){// sortrange is a named range\n\tnrange=SocialCalc.Formula.LookupName(spreadsheet.sheet,spreadsheet.sortrange||\"\");if(nrange.type==\"range\"){rparts=nrange.value.match(/^(.*)\\|(.*)\\|$/);sortrange=rparts[1]+\":\"+rparts[2];}else{sortrange=\"A1:A1\";}}else{sortrange=spreadsheet.sortrange;}var range=SocialCalc.ParseRange(sortrange);sele=document.getElementById(spreadsheet.idPrefix+\"majorsort\");oldindex=sele.selectedIndex;sele.options.length=0;sele.options[sele.options.length]=new Option(SCLoc(\"[None]\"),\"\");for(var col=range.cr1.col;col<=range.cr2.col;col++){colname=SocialCalc.rcColname(col);sele.options[sele.options.length]=new Option(SCLoc(\"Column \")+colname,colname);}sele.selectedIndex=oldindex>1&&oldindex<=range.cr2.col-range.cr1.col+1?oldindex:1;// restore what was there if reasonable\n\tsele=document.getElementById(spreadsheet.idPrefix+\"minorsort\");oldindex=sele.selectedIndex;sele.options.length=0;sele.options[sele.options.length]=new Option(SCLoc(\"[None]\"),\"\");for(var col=range.cr1.col;col<=range.cr2.col;col++){colname=SocialCalc.rcColname(col);sele.options[sele.options.length]=new Option(colname,colname);}sele.selectedIndex=oldindex>0&&oldindex<=range.cr2.col-range.cr1.col+1?oldindex:0;// default to [none]\n\tsele=document.getElementById(spreadsheet.idPrefix+\"lastsort\");oldindex=sele.selectedIndex;sele.options.length=0;sele.options[sele.options.length]=new Option(SCLoc(\"[None]\"),\"\");for(var col=range.cr1.col;col<=range.cr2.col;col++){colname=SocialCalc.rcColname(col);sele.options[sele.options.length]=new Option(colname,colname);}sele.selectedIndex=oldindex>0&&oldindex<=range.cr2.col-range.cr1.col+1?oldindex:0;// default to [none]\n\t};//\n\t// SocialCalc.CmdGotFocus(obj)\n\t//\n\t// Sets SocialCalc.Keyboard.passThru: obj should be element with focus or \"true\"\n\t//\n\tSocialCalc.CmdGotFocus=function(obj){SocialCalc.Keyboard.passThru=obj;};//\n\t// SocialCalc.DoButtonCmd(e, buttoninfo, bobj)\n\t//\n\tSocialCalc.DoButtonCmd=function(e,buttoninfo,bobj){SocialCalc.DoCmd(bobj.element,bobj.functionobj.command);};//\n\t// SocialCalc.DoCmd(obj, which)\n\t//\n\t// xxx\n\t//\n\tSocialCalc.DoCmd=function(obj,which){var combostr,sstr,cl,i,clele,slist,slistele,str,sele,rele,lele,ele,sortrange,nrange,rparts;var sheet,cell,color,bgcolor,defaultcolor,defaultbgcolor;var spreadsheet=SocialCalc.GetSpreadsheetControlObject();var editor=spreadsheet.editor;switch(which){case\"undo\":spreadsheet.ExecuteCommand(\"undo\",\"\");break;case\"redo\":spreadsheet.ExecuteCommand(\"redo\",\"\");break;case\"fill-rowcolstuff\":case\"fill-text\":cl=which.substring(5);clele=document.getElementById(spreadsheet.idPrefix+cl+\"list\");clele.length=0;for(i=0;i<SocialCalc.SpreadsheetCmdTable[cl].length;i++){clele.options[i]=new Option(SocialCalc.SpreadsheetCmdTable[cl][i].t);}which=\"changed-\"+cl;// fall through to changed code\n\tcase\"changed-rowcolstuff\":case\"changed-text\":cl=which.substring(8);clele=document.getElementById(spreadsheet.idPrefix+cl+\"list\");slist=SocialCalc.SpreadsheetCmdTable.slists[SocialCalc.SpreadsheetCmdTable[cl][clele.selectedIndex].s];// get sList for this command\n\tslistele=document.getElementById(spreadsheet.idPrefix+cl+\"slist\");slistele.length=0;// reset\n\tfor(i=0;i<(slist.length||0);i++){slistele.options[i]=new Option(slist[i].t,slist[i].s);}return;// nothing else to do\n\tcase\"ok-rowcolstuff\":case\"ok-text\":cl=which.substring(3);clele=document.getElementById(spreadsheet.idPrefix+cl+\"list\");slistele=document.getElementById(spreadsheet.idPrefix+cl+\"slist\");combostr=SocialCalc.SpreadsheetCmdTable[cl][clele.selectedIndex].c;sstr=slistele[slistele.selectedIndex].value;SocialCalc.SpreadsheetControlExecuteCommand(obj,combostr,sstr);break;case\"ok-setsort\":lele=document.getElementById(spreadsheet.idPrefix+\"sortlist\");if(lele.selectedIndex==0){if(editor.range.hasrange){spreadsheet.sortrange=SocialCalc.crToCoord(editor.range.left,editor.range.top)+\":\"+SocialCalc.crToCoord(editor.range.right,editor.range.bottom);}else{spreadsheet.sortrange=editor.ecell.coord+\":\"+editor.ecell.coord;}}else{spreadsheet.sortrange=lele.options[lele.selectedIndex].value;}ele=document.getElementById(spreadsheet.idPrefix+\"sortbutton\");ele.value=SocialCalc.LocalizeString(\"Sort \")+spreadsheet.sortrange;ele.style.visibility=\"visible\";SocialCalc.LoadColumnChoosers(spreadsheet);if(obj&&obj.blur)obj.blur();SocialCalc.KeyboardFocus();return;case\"dosort\":if(spreadsheet.sortrange&&spreadsheet.sortrange.indexOf(\":\")==-1){// sortrange is a named range\n\tnrange=SocialCalc.Formula.LookupName(spreadsheet.sheet,spreadsheet.sortrange||\"\");if(nrange.type!=\"range\")return;rparts=nrange.value.match(/^(.*)\\|(.*)\\|$/);sortrange=rparts[1]+\":\"+rparts[2];}else{sortrange=spreadsheet.sortrange;}if(sortrange==\"A1:A1\")return;str=\"sort \"+sortrange+\" \";sele=document.getElementById(spreadsheet.idPrefix+\"majorsort\");rele=document.getElementById(spreadsheet.idPrefix+\"majorsortup\");str+=sele.options[sele.selectedIndex].value+(rele.checked?\" up\":\" down\");sele=document.getElementById(spreadsheet.idPrefix+\"minorsort\");if(sele.selectedIndex>0){rele=document.getElementById(spreadsheet.idPrefix+\"minorsortup\");str+=\" \"+sele.options[sele.selectedIndex].value+(rele.checked?\" up\":\" down\");}sele=document.getElementById(spreadsheet.idPrefix+\"lastsort\");if(sele.selectedIndex>0){rele=document.getElementById(spreadsheet.idPrefix+\"lastsortup\");str+=\" \"+sele.options[sele.selectedIndex].value+(rele.checked?\" up\":\" down\");}spreadsheet.ExecuteCommand(str,\"\");break;case\"merge\":combostr=SocialCalc.SpreadsheetCmdLookup[which]||\"\";sstr=SocialCalc.SpreadsheetCmdSLookup[which]||\"\";spreadsheet.ExecuteCommand(combostr,sstr);if(editor.range.hasrange){// set ecell to upper left\n\teditor.MoveECell(SocialCalc.crToCoord(editor.range.left,editor.range.top));editor.RangeRemove();}break;case\"movefrom\":if(editor.range2.hasrange){// toggle if already there\n\tspreadsheet.context.cursorsuffix=\"\";editor.Range2Remove();spreadsheet.ExecuteCommand(\"redisplay\",\"\");}else if(editor.range.hasrange){// set range2 to range or one cell\n\teditor.range2.top=editor.range.top;editor.range2.right=editor.range.right;editor.range2.bottom=editor.range.bottom;editor.range2.left=editor.range.left;editor.range2.hasrange=true;editor.MoveECell(SocialCalc.crToCoord(editor.range.left,editor.range.top));}else{editor.range2.top=editor.ecell.row;editor.range2.right=editor.ecell.col;editor.range2.bottom=editor.ecell.row;editor.range2.left=editor.ecell.col;editor.range2.hasrange=true;}str=editor.range2.hasrange?\"\":\"off\";ele=document.getElementById(spreadsheet.idPrefix+\"button_movefrom\");ele.src=spreadsheet.imagePrefix+\"movefrom\"+str+\".gif\";ele=document.getElementById(spreadsheet.idPrefix+\"button_movepaste\");ele.src=spreadsheet.imagePrefix+\"movepaste\"+str+\".gif\";ele=document.getElementById(spreadsheet.idPrefix+\"button_moveinsert\");ele.src=spreadsheet.imagePrefix+\"moveinsert\"+str+\".gif\";if(editor.range2.hasrange)editor.RangeRemove();break;case\"movepaste\":case\"moveinsert\":if(editor.range2.hasrange){spreadsheet.context.cursorsuffix=\"\";combostr=which+\" \"+SocialCalc.crToCoord(editor.range2.left,editor.range2.top)+\":\"+SocialCalc.crToCoord(editor.range2.right,editor.range2.bottom)+\" \"+editor.ecell.coord;spreadsheet.ExecuteCommand(combostr,\"\");editor.Range2Remove();ele=document.getElementById(spreadsheet.idPrefix+\"button_movefrom\");ele.src=spreadsheet.imagePrefix+\"movefromoff.gif\";ele=document.getElementById(spreadsheet.idPrefix+\"button_movepaste\");ele.src=spreadsheet.imagePrefix+\"movepasteoff.gif\";ele=document.getElementById(spreadsheet.idPrefix+\"button_moveinsert\");ele.src=spreadsheet.imagePrefix+\"moveinsertoff.gif\";}break;case\"swapcolors\":sheet=spreadsheet.sheet;cell=sheet.GetAssuredCell(editor.ecell.coord);defaultcolor=sheet.attribs.defaultcolor?sheet.colors[sheet.attribs.defaultcolor]:\"rgb(0,0,0)\";defaultbgcolor=sheet.attribs.defaultbgcolor?sheet.colors[sheet.attribs.defaultbgcolor]:\"rgb(255,255,255)\";color=cell.color?sheet.colors[cell.color]:defaultcolor;// get color\n\tif(color==defaultbgcolor)color=\"\";// going to swap, so if same as background default, use default\n\tbgcolor=cell.bgcolor?sheet.colors[cell.bgcolor]:defaultbgcolor;if(bgcolor==defaultcolor)bgcolor=\"\";// going to swap, so if same as foreground default, use default\n\tspreadsheet.ExecuteCommand(\"set %C color \"+bgcolor+\"%Nset %C bgcolor \"+color,\"\");break;default:combostr=SocialCalc.SpreadsheetCmdLookup[which]||\"\";sstr=SocialCalc.SpreadsheetCmdSLookup[which]||\"\";spreadsheet.ExecuteCommand(combostr,sstr);break;}if(obj&&obj.blur)obj.blur();SocialCalc.KeyboardFocus();};SocialCalc.SpreadsheetCmdLookup={'copy':'copy %C all','cut':'cut %C all','paste':'paste %C all','pasteformats':'paste %C formats','delete':'erase %C formulas','filldown':'filldown %C all','fillright':'fillright %C all','erase':'erase %C all','borderon':'set %C bt %S%Nset %C br %S%Nset %C bb %S%Nset %C bl %S','borderoff':'set %C bt %S%Nset %C br %S%Nset %C bb %S%Nset %C bl %S','merge':'merge %C','unmerge':'unmerge %C','align-left':'set %C cellformat left','align-center':'set %C cellformat center','align-right':'set %C cellformat right','align-default':'set %C cellformat','insertrow':'insertrow %C','insertcol':'insertcol %C','deleterow':'deleterow %C','deletecol':'deletecol %C','undo':'undo','redo':'redo','recalc':'recalc'};SocialCalc.SpreadsheetCmdSLookup={'borderon':'1px solid rgb(0,0,0)','borderoff':''/******* NO LONGER USED\n\t\n\tSocialCalc.SpreadsheetCmdTable = {\n\t cmd: [\n\t  {t:\"Fill Right\", s:\"ffal\", c:\"fillright %C %S\"},\n\t  {t:\"Fill Down\", s:\"ffal\", c:\"filldown %C %S\"},\n\t  {t:\"Copy\", s:\"all\", c:\"copy %C %S\"},\n\t  {t:\"Cut\", s:\"all\", c:\"cut %C %S\"},\n\t  {t:\"Paste\", s:\"ffal\", c:\"paste %C %S\"},\n\t  {t:\"Erase\", s:\"ffal\", c:\"erase %C %S\"},\n\t  {t:\"Insert\", s:\"rowcol\", c:\"insert%S %C\"},\n\t  {t:\"Delete\", s:\"rowcol\", c:\"delete%S %C\"},\n\t  {t:\"Merge Cells\", s:\"none\", c:\"merge %C\"},\n\t  {t:\"Unmerge\", s:\"none\", c:\"unmerge %C\"},\n\t  {t:\"Sort\", s:\"sortcol\", c:\"sort %R %S\"},\n\t  {t:\"Cell Color\", s:\"colors\", c:\"set %C color %S\"},\n\t  {t:\"Cell Background\", s:\"colors\", c:\"set %C bgcolor %S\"},\n\t  {t:\"Cell Number Format\", s:\"ntvf\", c:\"set %C nontextvalueformat %S\"},\n\t  {t:\"Cell Font\", s:\"fonts\", c:\"set %C font %S\"},\n\t  {t:\"Cell Align\", s:\"cellformat\", c:\"set %C cellformat %S\"},\n\t  {t:\"Cell Borders\", s:\"borderOnOff\", c:\"set %C bt %S%Nset %C br %S%Nset %C bb %S%Nset %C bl %S\"},\n\t  {t:\"Column Width\", s:\"colWidths\", c:\"set %W width %S\"},\n\t  {t:\"Default Color\", s:\"colors\", c:\"set sheet defaultcolor %S\"},\n\t  {t:\"Default Background\", s:\"colors\", c:\"set sheet defaultbgcolor %S\"},\n\t  {t:\"Default Number Format\", s:\"ntvf\", c:\"set sheet defaultnontextvalueformat %S\"},\n\t  {t:\"Default Font\", s:\"fonts\", c:\"set sheet defaultfont %S\"},\n\t  {t:\"Default Text Align\", s:\"cellformat\", c:\"set sheet defaulttextformat %S\"},\n\t  {t:\"Default Number Align\", s:\"cellformat\", c:\"set sheet defaultnontextformat %S\"},\n\t  {t:\"Default Column Width\", s:\"colWidths\", c:\"set sheet defaultcolwidth %S\"}\n\t  ],\n\t rowcolstuff: [\n\t  {t:\"Insert\", s:\"rowcol\", c:\"insert%S %C\"},\n\t  {t:\"Delete\", s:\"rowcol\", c:\"delete%S %C\"},\n\t  {t:\"Paste\", s:\"ffal\", c:\"paste %C %S\"},\n\t  {t:\"Erase\", s:\"ffal\", c:\"erase %C %S\"},\n\t  {t:\"Fill Right\", s:\"ffal\", c:\"fillright %C %S\"},\n\t  {t:\"Fill Down\", s:\"ffal\", c:\"filldown %C %S\"}\n\t  ],\n\t text: [\n\t  {t:\"Cell Color\", s:\"colors\", c:\"set %C color %S\"},\n\t  {t:\"Cell Background\", s:\"colors\", c:\"set %C bgcolor %S\"},\n\t  {t:\"Cell Number Format\", s:\"ntvf\", c:\"set %C nontextvalueformat %S\"},\n\t  {t:\"Cell Text Format\", s:\"tvf\", c:\"set %C textvalueformat %S\"},\n\t  {t:\"Cell Font\", s:\"fonts\", c:\"set %C font %S\"},\n\t  {t:\"Cell Align\", s:\"cellformat\", c:\"set %C cellformat %S\"},\n\t  {t:\"Default Color\", s:\"colors\", c:\"set sheet defaultcolor %S\"},\n\t  {t:\"Default Background\", s:\"colors\", c:\"set sheet defaultbgcolor %S\"},\n\t  {t:\"Default Number Format\", s:\"ntvf\", c:\"set sheet defaultnontextvalueformat %S\"},\n\t  {t:\"Default Text Format\", s:\"tvf\", c:\"set sheet defaulttextvalueformat %S\"},\n\t  {t:\"Default Font\", s:\"fonts\", c:\"set sheet defaultfont %S\"},\n\t  {t:\"Default Text Align\", s:\"cellformat\", c:\"set sheet defaulttextformat %S\"},\n\t  {t:\"Default Number Align\", s:\"cellformat\", c:\"set sheet defaultnontextformat %S\"}\n\t  ],\n\t slists: {\n\t  \"colors\": [\n\t   {t:\"Default\", s:\"\"},\n\t   {t:\"Black\", s:\"rgb(0,0,0)\"},\n\t   {t:\"Dark Gray\", s:\"rgb(102,102,102)\"}, // #666\n\t   {t:\"Gray\", s:\"rgb(204,204,204)\"}, // #CCC\n\t   {t:\"White\", s:\"rgb(255,255,255)\"},\n\t   {t:\"Red\", s:\"rgb(255,0,0)\"},\n\t   {t:\"Dark Red\", s:\"rgb(153,0,0)\"},\n\t   {t:\"Orange\", s:\"rgb(255,153,0)\"},\n\t   {t:\"Yellow\", s:\"rgb(255,255,0)\"},\n\t   {t:\"Light Yellow\", s:\"rgb(255,255,204)\"},\n\t   {t:\"Green\", s:\"rgb(0,255,0)\"},\n\t   {t:\"Dark Green\", s:\"rgb(0,153,0)\"},\n\t   {t:\"Blue\", s:\"rgb(0,0,255)\"},\n\t   {t:\"Dark Blue\", s:\"rgb(0,0,153)\"},\n\t   {t:\"Light Blue\", s:\"rgb(204,204,255)\"}\n\t   ],\n\t  \"fonts\": [ // style weight size family\n\t   {t:\"Default\", s:\"\"},\n\t   {t:\"Bold\", s:\"normal bold * *\"},\n\t   {t:\"Italic\", s:\"italic normal * *\"},\n\t   {t:\"Small\", s:\"* small *\"},\n\t   {t:\"Medium\", s:\"* medium *\"},\n\t   {t:\"Large\", s:\"* large *\"},\n\t   {t:\"Bold Small\", s:\"normal bold small *\"},\n\t   {t:\"Bold Medium\", s:\"normal bold medium *\"},\n\t   {t:\"Bold Large\", s:\"normal bold large *\"}\n\t   ],\n\t  \"cellformat\": [\n\t   {t:\"Default\", s:\"\"},\n\t   {t:\"Left\", s:\"left\"},\n\t   {t:\"Right\", s:\"right\"},\n\t   {t:\"Center\", s:\"center\"}\n\t   ],\n\t  \"borderOnOff\": [\n\t   {t:\"On\", s:\"1px solid rgb(0,0,0)\"},\n\t   {t:\"Off\", s:\"\"}\n\t   ],\n\t  \"colWidths\": [\n\t   {t:\"Default\", s:\"\"},\n\t   {t:\"20\", s:\"20\"},\n\t   {t:\"40\", s:\"40\"},\n\t   {t:\"60\", s:\"60\"},\n\t   {t:\"80\", s:\"80\"},\n\t   {t:\"100\", s:\"100\"},\n\t   {t:\"120\", s:\"120\"},\n\t   {t:\"140\", s:\"140\"},\n\t   {t:\"160\", s:\"160\"},\n\t   {t:\"180\", s:\"180\"},\n\t   {t:\"200\", s:\"200\"},\n\t   {t:\"220\", s:\"220\"},\n\t   {t:\"240\", s:\"240\"},\n\t   {t:\"260\", s:\"260\"},\n\t   {t:\"280\", s:\"280\"},\n\t   {t:\"300\", s:\"300\"}\n\t   ],\n\t  \"ntvf\": [\n\t   {t:\"Default\", s:\"\"},\n\t   {t:\"1234\", s:\"0\"},\n\t   {t:\"1,234\", s:\"#,##0\"},\n\t   {t:\"1,234.5\", s:\"#,##0.0\"},\n\t   {t:\"1,234.56\", s:\"#,##0.00\"},\n\t   {t:\"1,234.567\", s:\"#,##0.000\"},\n\t   {t:\"1,234%\", s:\"#,##0%\"},\n\t   {t:\"1,234.5%\", s:\"#,##0.0%\"},\n\t   {t:\"(1,234)\", s:\"#,##0_);(#,##0)\"},\n\t   {t:\"(1,234.5)\", s:\"#,##0.0_);(#,##0.0)\"},\n\t   {t:\"(1,234.56)\", s:\"#,##0.00_);(#,##0.00)\"},\n\t   {t:\"00\", s:\"00\"},\n\t   {t:\"000\", s:\"000\"},\n\t   {t:\"0000\", s:\"0000\"},\n\t   {t:\"$1,234.56\", s:\"$#,##0.00\"},\n\t   {t:\"2006-01-04\", s:\"yyyy-mm-dd\"},\n\t   {t:\"01:23:45\", s:\"hh:mm:ss\"},\n\t   {t:\"2006-01-04 01:23:45\", s:\"yyyy-mm-dd hh:mm:ss\"},\n\t   {t:\"Hidden\", s:\"hidden\"}\n\t   ],\n\t  \"tvf\": [\n\t   {t:\"Default\", s:\"\"},\n\t   {t:\"Automatic\", s:\"general\"},\n\t   {t:\"Plain Text\", s:\"text-plain\"},\n\t   {t:\"HTML\", s:\"text-html\"},\n\t   {t:\"Wiki\", s:\"text-wiki\"},\n\t   {t:\"Hidden\", s:\"hidden\"}\n\t   ],\n\t  \"ffal\": [ // Formulas, Formats, All\n\t   {t:\"All\", s:\"all\"},\n\t   {t:\"Contents\", s:\"formulas\"},\n\t   {t:\"Formats\", s:\"formats\"}\n\t   ],\n\t  \"all\": [ // All\n\t   {t:\"All\", s:\"all\"}\n\t   ],\n\t  \"rowcol\": [\n\t   {t:\"Row\", s:\"row\"},\n\t   {t:\"Column\", s:\"col\"}\n\t   ],\n\t  \"sortcol\": [\n\t   {t:\"A up\", s:\"A up\"},\n\t   {t:\"B up\", s:\"B up\"},\n\t   {t:\"C up\", s:\"C up\"},\n\t   {t:\"A down\", s:\"A down\"},\n\t   {t:\"B down\", s:\"B down\"},\n\t   {t:\"C down\", s:\"C down\"},\n\t   {t:\"A, B, C up\", s:\"A up B up C up\"}\n\t   ],\n\t  \"none\": [ // nothing\n\t   {t:\" \", s:\" \"}\n\t   ]\n\t  }\n\t }\n\t*********///\n\t// SocialCalc.SpreadsheetControlExecuteCommand(obj, combostr, sstr)\n\t//\n\t// xxx\n\t//\n\t};SocialCalc.SpreadsheetControlExecuteCommand=function(obj,combostr,sstr){var i,commands;var spreadsheet=SocialCalc.GetSpreadsheetControlObject();var eobj=spreadsheet.editor;var str={};str.P=\"%\";str.N=\"\\n\";if(eobj.range.hasrange){str.R=SocialCalc.crToCoord(eobj.range.left,eobj.range.top)+\":\"+SocialCalc.crToCoord(eobj.range.right,eobj.range.bottom);str.C=str.R;str.W=SocialCalc.rcColname(eobj.range.left)+\":\"+SocialCalc.rcColname(eobj.range.right);}else{str.C=eobj.ecell.coord;str.R=eobj.ecell.coord+\":\"+eobj.ecell.coord;str.W=SocialCalc.rcColname(SocialCalc.coordToCr(eobj.ecell.coord).col);}str.S=sstr;combostr=combostr.replace(/%C/g,str.C);combostr=combostr.replace(/%R/g,str.R);combostr=combostr.replace(/%N/g,str.N);combostr=combostr.replace(/%S/g,str.S);combostr=combostr.replace(/%W/g,str.W);combostr=combostr.replace(/%P/g,str.P);eobj.EditorScheduleSheetCommands(combostr,true,false);};//\n\t// result = SocialCalc.SpreadsheetControlCreateSheetHTML(spreadsheet)\n\t//\n\t// Returns the HTML representation of the whole spreadsheet\n\t//\n\tSocialCalc.SpreadsheetControlCreateSheetHTML=function(spreadsheet){var context,div,ele;var result=\"\";context=new SocialCalc.RenderContext(spreadsheet.sheet);div=document.createElement(\"div\");ele=context.RenderSheet(null,{type:\"html\"});div.appendChild(ele);context=undefined;result=div.innerHTML;ele=undefined;div=undefined;return result;};//\n\t// result = SocialCalc.SpreadsheetControlCreateCellHTML(spreadsheet, coord, linkstyle)\n\t//\n\t// Returns the HTML representation of a cell. Blank is \"\", not \"&nbsp;\".\n\t//\n\tSocialCalc.SpreadsheetControlCreateCellHTML=function(spreadsheet,coord,linkstyle){var result=\"\";var cell=spreadsheet.sheet.cells[coord];if(!cell)return\"\";if(cell.displaystring==undefined){result=SocialCalc.FormatValueForDisplay(spreadsheet.sheet,cell.datavalue,coord,linkstyle||spreadsheet.context.defaultHTMLlinkstyle);}else{result=cell.displaystring;}if(result==\"&nbsp;\")result=\"\";return result;};//\n\t// result = SocialCalc.SpreadsheetControlCreateCellHTMLSave(spreadsheet, range, linkstyle)\n\t//\n\t// Returns the HTML representation of a range of cells, or the whole sheet if range is null.\n\t// The form is:\n\t//    version:1.0\n\t//    coord:cell-HTML\n\t//    coord:cell-HTML\n\t//    ...\n\t//\n\t// Empty cells are skipped. The cell-HTML is encoded with \":\"=>\"\\c\", newline=>\"\\n\", and \"\\\"=>\"\\b\".\n\t//\n\tSocialCalc.SpreadsheetControlCreateCellHTMLSave=function(spreadsheet,range,linkstyle){var cr1,cr2,row,col,coord,cell,cellHTML;var result=[];var prange;if(range){prange=SocialCalc.ParseRange(range);}else{prange={cr1:{row:1,col:1},cr2:{row:spreadsheet.sheet.attribs.lastrow,col:spreadsheet.sheet.attribs.lastcol}};}cr1=prange.cr1;cr2=prange.cr2;result.push(\"version:1.0\");for(row=cr1.row;row<=cr2.row;row++){for(col=cr1.col;col<=cr2.col;col++){coord=SocialCalc.crToCoord(col,row);cell=spreadsheet.sheet.cells[coord];if(!cell)continue;if(cell.displaystring==undefined){cellHTML=SocialCalc.FormatValueForDisplay(spreadsheet.sheet,cell.datavalue,coord,linkstyle||spreadsheet.context.defaultHTMLlinkstyle);}else{cellHTML=cell.displaystring;}if(cellHTML==\"&nbsp;\")continue;result.push(coord+\":\"+SocialCalc.encodeForSave(cellHTML));}}result.push(\"\");// one extra to get extra \\n\n\treturn result.join(\"\\n\");};//\n\t// Formula Bar Button Routines\n\t//\n\tSocialCalc.SpreadsheetControl.DoFunctionList=function(){var i,cname,str,f,ele;var scf=SocialCalc.Formula;var scc=SocialCalc.Constants;var fcl=scc.function_classlist;var spreadsheet=SocialCalc.GetSpreadsheetControlObject();var idp=spreadsheet.idPrefix+\"function\";ele=document.getElementById(idp+\"dialog\");if(ele)return;// already have one\n\tscf.FillFunctionInfo();str='<table><tr><td><span style=\"font-size:x-small;font-weight:bold\">%loc!Category!</span><br>'+'<select id=\"'+idp+'class\" size=\"'+fcl.length+'\" style=\"width:120px;\" onchange=\"SocialCalc.SpreadsheetControl.FunctionClassChosen(this.options[this.selectedIndex].value);\">';for(i=0;i<fcl.length;i++){str+='<option value=\"'+fcl[i]+'\"'+(i==0?' selected>':'>')+SocialCalc.special_chars(scf.FunctionClasses[fcl[i]].name)+'</option>';}str+='</select></td><td>&nbsp;&nbsp;</td><td id=\"'+idp+'list\"><span style=\"font-size:x-small;font-weight:bold\">%loc!Functions!</span><br>'+'<select id=\"'+idp+'name\" size=\"'+fcl.length+'\" style=\"width:240px;\" '+'onchange=\"SocialCalc.SpreadsheetControl.FunctionChosen(this.options[this.selectedIndex].value);\" ondblclick=\"SocialCalc.SpreadsheetControl.DoFunctionPaste();\">';str+=SocialCalc.SpreadsheetControl.GetFunctionNamesStr(\"all\");str+='</td></tr><tr><td colspan=\"3\">'+'<div id=\"'+idp+'desc\" style=\"width:380px;height:80px;overflow:auto;font-size:x-small;\">'+SocialCalc.SpreadsheetControl.GetFunctionInfoStr(scf.FunctionClasses[fcl[0]].items[0])+'</div>'+'<div style=\"width:380px;text-align:right;padding-top:6px;font-size:small;\">'+'<input type=\"button\" value=\"%loc!Paste!\" style=\"font-size:smaller;\" onclick=\"SocialCalc.SpreadsheetControl.DoFunctionPaste();\">&nbsp;'+'<input type=\"button\" value=\"%loc!Cancel!\" style=\"font-size:smaller;\" onclick=\"SocialCalc.SpreadsheetControl.HideFunctions();\"></div>'+'</td></tr></table>';var main=document.createElement(\"div\");main.id=idp+\"dialog\";main.style.position=\"absolute\";var vp=SocialCalc.GetViewportInfo();main.style.top=vp.height/3+\"px\";main.style.left=vp.width/3+\"px\";main.style.zIndex=100;main.style.backgroundColor=\"#FFF\";main.style.border=\"1px solid black\";main.style.width=\"400px\";str='<table cellspacing=\"0\" cellpadding=\"0\" style=\"border-bottom:1px solid black;\"><tr>'+'<td style=\"font-size:10px;cursor:default;width:100%;background-color:#999;color:#FFF;\">'+\"&nbsp;%loc!Function List!\"+'</td>'+'<td style=\"font-size:10px;cursor:default;color:#666;\" onclick=\"SocialCalc.SpreadsheetControl.HideFunctions();\">&nbsp;X&nbsp;</td></tr></table>'+'<div style=\"background-color:#DDD;\">'+str+'</div>';str=SocialCalc.LocalizeSubstrings(str);main.innerHTML=str;SocialCalc.DragRegister(main.firstChild.firstChild.firstChild.firstChild,true,true,{MouseDown:SocialCalc.DragFunctionStart,MouseMove:SocialCalc.DragFunctionPosition,MouseUp:SocialCalc.DragFunctionPosition,Disabled:null,positionobj:main});spreadsheet.spreadsheetDiv.appendChild(main);ele=document.getElementById(idp+\"name\");ele.focus();SocialCalc.CmdGotFocus(ele);//!!! need to do keyboard handling: if esc, hide; if All, letter scrolls to there\n\t};SocialCalc.SpreadsheetControl.GetFunctionNamesStr=function(cname){var i,f;var scf=SocialCalc.Formula;var str=\"\";f=scf.FunctionClasses[cname];for(i=0;i<f.items.length;i++){str+='<option value=\"'+f.items[i]+'\"'+(i==0?' selected>':'>')+f.items[i]+'</option>';}return str;};SocialCalc.SpreadsheetControl.FillFunctionNames=function(cname,ele){var i,f;var scf=SocialCalc.Formula;ele.length=0;f=scf.FunctionClasses[cname];for(i=0;i<f.items.length;i++){ele.options[i]=new Option(f.items[i],f.items[i]);if(i==0){ele.options[i].selected=true;}}};SocialCalc.SpreadsheetControl.GetFunctionInfoStr=function(fname){var scf=SocialCalc.Formula;var f=scf.FunctionList[fname];var scsc=SocialCalc.special_chars;var str=\"<b>\"+fname+\"(\"+scsc(scf.FunctionArgString(fname))+\")</b><br>\";str+=scsc(f[3]);return str;};SocialCalc.SpreadsheetControl.FunctionClassChosen=function(cname){var spreadsheet=SocialCalc.GetSpreadsheetControlObject();var idp=spreadsheet.idPrefix+\"function\";var scf=SocialCalc.Formula;SocialCalc.SpreadsheetControl.FillFunctionNames(cname,document.getElementById(idp+\"name\"));SocialCalc.SpreadsheetControl.FunctionChosen(scf.FunctionClasses[cname].items[0]);};SocialCalc.SpreadsheetControl.FunctionChosen=function(fname){var spreadsheet=SocialCalc.GetSpreadsheetControlObject();var idp=spreadsheet.idPrefix+\"function\";document.getElementById(idp+\"desc\").innerHTML=SocialCalc.SpreadsheetControl.GetFunctionInfoStr(fname);};SocialCalc.SpreadsheetControl.HideFunctions=function(){var spreadsheet=SocialCalc.GetSpreadsheetControlObject();var ele=document.getElementById(spreadsheet.idPrefix+\"functiondialog\");ele.innerHTML=\"\";SocialCalc.DragUnregister(ele);SocialCalc.KeyboardFocus();if(ele.parentNode){ele.parentNode.removeChild(ele);}};SocialCalc.SpreadsheetControl.DoFunctionPaste=function(){var spreadsheet=SocialCalc.GetSpreadsheetControlObject();var editor=spreadsheet.editor;var ele=document.getElementById(spreadsheet.idPrefix+\"functionname\");var mele=document.getElementById(spreadsheet.idPrefix+\"multilinetextarea\");var text=ele.value+\"(\";SocialCalc.SpreadsheetControl.HideFunctions();if(mele){// multi-line editing is in progress\n\tmele.value+=text;mele.focus();SocialCalc.CmdGotFocus(mele);}else{editor.EditorAddToInput(text,\"=\");}};SocialCalc.SpreadsheetControl.DoMultiline=function(){var SCLocSS=SocialCalc.LocalizeSubstrings;var str,ele,text;var scc=SocialCalc.Constants;var spreadsheet=SocialCalc.GetSpreadsheetControlObject();var editor=spreadsheet.editor;var wval=editor.workingvalues;var spreadsheet=SocialCalc.GetSpreadsheetControlObject();var idp=spreadsheet.idPrefix+\"multiline\";ele=document.getElementById(idp+\"dialog\");if(ele)return;// already have one\n\tswitch(editor.state){case\"start\":wval.ecoord=editor.ecell.coord;wval.erow=editor.ecell.row;wval.ecol=editor.ecell.col;editor.RangeRemove();text=SocialCalc.GetCellContents(editor.context.sheetobj,wval.ecoord);break;case\"input\":case\"inputboxdirect\":text=editor.inputBox.GetText();break;}editor.inputBox.element.disabled=true;text=SocialCalc.special_chars(text);str='<textarea id=\"'+idp+'textarea\" style=\"width:380px;height:120px;margin:10px 0px 0px 6px;\">'+text+'</textarea>'+'<div style=\"width:380px;text-align:right;padding:6px 0px 4px 6px;font-size:small;\">'+SCLocSS('<input type=\"button\" value=\"%loc!Set Cell Contents!\" style=\"font-size:smaller;\" onclick=\"SocialCalc.SpreadsheetControl.DoMultilinePaste();\">&nbsp;'+'<input type=\"button\" value=\"%loc!Clear!\" style=\"font-size:smaller;\" onclick=\"SocialCalc.SpreadsheetControl.DoMultilineClear();\">&nbsp;'+'<input type=\"button\" value=\"%loc!Cancel!\" style=\"font-size:smaller;\" onclick=\"SocialCalc.SpreadsheetControl.HideMultiline();\"></div>'+'</div>');var main=document.createElement(\"div\");main.id=idp+\"dialog\";main.style.position=\"absolute\";var vp=SocialCalc.GetViewportInfo();main.style.top=vp.height/3+\"px\";main.style.left=vp.width/3+\"px\";main.style.zIndex=100;main.style.backgroundColor=\"#FFF\";main.style.border=\"1px solid black\";main.style.width=\"400px\";main.innerHTML='<table cellspacing=\"0\" cellpadding=\"0\" style=\"border-bottom:1px solid black;\"><tr>'+'<td style=\"font-size:10px;cursor:default;width:100%;background-color:#999;color:#FFF;\">'+SCLocSS(\"&nbsp;%loc!Multi-line Input Box!\")+'</td>'+'<td style=\"font-size:10px;cursor:default;color:#666;\" onclick=\"SocialCalc.SpreadsheetControl.HideMultiline();\">&nbsp;X&nbsp;</td></tr></table>'+'<div style=\"background-color:#DDD;\">'+str+'</div>';SocialCalc.DragRegister(main.firstChild.firstChild.firstChild.firstChild,true,true,{MouseDown:SocialCalc.DragFunctionStart,MouseMove:SocialCalc.DragFunctionPosition,MouseUp:SocialCalc.DragFunctionPosition,Disabled:null,positionobj:main});spreadsheet.spreadsheetDiv.appendChild(main);ele=document.getElementById(idp+\"textarea\");ele.focus();SocialCalc.CmdGotFocus(ele);//!!! need to do keyboard handling: if esc, hide?\n\t};SocialCalc.SpreadsheetControl.HideMultiline=function(){var scc=SocialCalc.Constants;var spreadsheet=SocialCalc.GetSpreadsheetControlObject();var editor=spreadsheet.editor;var ele=document.getElementById(spreadsheet.idPrefix+\"multilinedialog\");ele.innerHTML=\"\";SocialCalc.DragUnregister(ele);SocialCalc.KeyboardFocus();if(ele.parentNode){ele.parentNode.removeChild(ele);}switch(editor.state){case\"start\":editor.inputBox.DisplayCellContents(null);break;case\"input\":case\"inputboxdirect\":editor.inputBox.element.disabled=false;editor.inputBox.Focus();break;}};SocialCalc.SpreadsheetControl.DoMultilineClear=function(){var spreadsheet=SocialCalc.GetSpreadsheetControlObject();var ele=document.getElementById(spreadsheet.idPrefix+\"multilinetextarea\");ele.value=\"\";ele.focus();};SocialCalc.SpreadsheetControl.DoMultilinePaste=function(){var spreadsheet=SocialCalc.GetSpreadsheetControlObject();var editor=spreadsheet.editor;var wval=editor.workingvalues;var ele=document.getElementById(spreadsheet.idPrefix+\"multilinetextarea\");var text=ele.value;SocialCalc.SpreadsheetControl.HideMultiline();switch(editor.state){case\"start\":wval.partialexpr=\"\";wval.ecoord=editor.ecell.coord;wval.erow=editor.ecell.row;wval.ecol=editor.ecell.col;break;case\"input\":case\"inputboxdirect\":editor.inputBox.Blur();editor.inputBox.ShowInputBox(false);editor.state=\"start\";break;}editor.EditorSaveEdit(text);};SocialCalc.SpreadsheetControl.DoLink=function(){var SCLoc=SocialCalc.LocalizeString;var str,ele,text,cell,setformat,popup;var scc=SocialCalc.Constants;var spreadsheet=SocialCalc.GetSpreadsheetControlObject();var editor=spreadsheet.editor;var wval=editor.workingvalues;var spreadsheet=SocialCalc.GetSpreadsheetControlObject();var idp=spreadsheet.idPrefix+\"link\";ele=document.getElementById(idp+\"dialog\");if(ele)return;// already have one\n\tswitch(editor.state){case\"start\":wval.ecoord=editor.ecell.coord;wval.erow=editor.ecell.row;wval.ecol=editor.ecell.col;editor.RangeRemove();text=SocialCalc.GetCellContents(editor.context.sheetobj,wval.ecoord);break;case\"input\":case\"inputboxdirect\":text=editor.inputBox.GetText();break;}editor.inputBox.element.disabled=true;if(text.charAt(0)==\"'\"){text=text.slice(1);}var parts=SocialCalc.ParseCellLinkText(text);text=SocialCalc.special_chars(text);cell=spreadsheet.sheet.cells[editor.ecell.coord];if(!cell||!cell.textvalueformat){// set to link format, but don't override\n\tsetformat=\" checked\";}else{setformat=\"\";}popup=parts.newwin?\" checked\":\"\";str='<div style=\"padding:6px 0px 4px 6px;\">'+'<span style=\"font-size:smaller;\">'+SCLoc(\"Description\")+'</span><br>'+'<input type=\"text\" id=\"'+idp+'desc\" style=\"width:380px;\" value=\"'+SocialCalc.special_chars(parts.desc)+'\"><br>'+'<span style=\"font-size:smaller;\">'+SCLoc(\"URL\")+'</span><br>'+'<input type=\"text\" id=\"'+idp+'url\" style=\"width:380px;\" value=\"'+SocialCalc.special_chars(parts.url)+'\"><br>';if(SocialCalc.Callbacks.MakePageLink){// only show if handling pagenames here\n\tstr+='<span style=\"font-size:smaller;\">'+SCLoc(\"Page Name\")+'</span><br>'+'<input type=\"text\" id=\"'+idp+'pagename\" style=\"width:380px;\" value=\"'+SocialCalc.special_chars(parts.pagename)+'\"><br>'+'<span style=\"font-size:smaller;\">'+SCLoc(\"Workspace\")+'</span><br>'+'<input type=\"text\" id=\"'+idp+'workspace\" style=\"width:380px;\" value=\"'+SocialCalc.special_chars(parts.workspace)+'\"><br>';}str+=SocialCalc.LocalizeSubstrings('<input type=\"checkbox\" id=\"'+idp+'format\"'+setformat+'>&nbsp;'+'<span style=\"font-size:smaller;\">%loc!Set to Link format!</span><br>'+'<input type=\"checkbox\" id=\"'+idp+'popup\"'+popup+'>&nbsp;'+'<span style=\"font-size:smaller;\">%loc!Show in new browser window!</span>'+'</div>'+'<div style=\"width:380px;text-align:right;padding:6px 0px 4px 6px;font-size:small;\">'+'<input type=\"button\" value=\"%loc!Set Cell Contents!\" style=\"font-size:smaller;\" onclick=\"SocialCalc.SpreadsheetControl.DoLinkPaste();\">&nbsp;'+'<input type=\"button\" value=\"%loc!Clear!\" style=\"font-size:smaller;\" onclick=\"SocialCalc.SpreadsheetControl.DoLinkClear();\">&nbsp;'+'<input type=\"button\" value=\"%loc!Cancel!\" style=\"font-size:smaller;\" onclick=\"SocialCalc.SpreadsheetControl.HideLink();\"></div>'+'</div>');var main=document.createElement(\"div\");main.id=idp+\"dialog\";main.style.position=\"absolute\";var vp=SocialCalc.GetViewportInfo();main.style.top=vp.height/3+\"px\";main.style.left=vp.width/3+\"px\";main.style.zIndex=100;main.style.backgroundColor=\"#FFF\";main.style.border=\"1px solid black\";main.style.width=\"400px\";main.innerHTML='<table cellspacing=\"0\" cellpadding=\"0\" style=\"border-bottom:1px solid black;\"><tr>'+'<td style=\"font-size:10px;cursor:default;width:100%;background-color:#999;color:#FFF;\">'+\"&nbsp;\"+SCLoc(\"Link Input Box\")+'</td>'+'<td style=\"font-size:10px;cursor:default;color:#666;\" onclick=\"SocialCalc.SpreadsheetControl.HideLink();\">&nbsp;X&nbsp;</td></tr></table>'+'<div style=\"background-color:#DDD;\">'+str+'</div>';SocialCalc.DragRegister(main.firstChild.firstChild.firstChild.firstChild,true,true,{MouseDown:SocialCalc.DragFunctionStart,MouseMove:SocialCalc.DragFunctionPosition,MouseUp:SocialCalc.DragFunctionPosition,Disabled:null,positionobj:main});spreadsheet.spreadsheetDiv.appendChild(main);ele=document.getElementById(idp+\"url\");ele.focus();SocialCalc.CmdGotFocus(ele);//!!! need to do keyboard handling: if esc, hide?\n\t};SocialCalc.SpreadsheetControl.HideLink=function(){var scc=SocialCalc.Constants;var spreadsheet=SocialCalc.GetSpreadsheetControlObject();var editor=spreadsheet.editor;var ele=document.getElementById(spreadsheet.idPrefix+\"linkdialog\");ele.innerHTML=\"\";SocialCalc.DragUnregister(ele);SocialCalc.KeyboardFocus();if(ele.parentNode){ele.parentNode.removeChild(ele);}switch(editor.state){case\"start\":editor.inputBox.DisplayCellContents(null);break;case\"input\":case\"inputboxdirect\":editor.inputBox.element.disabled=false;editor.inputBox.Focus();break;}};SocialCalc.SpreadsheetControl.DoLinkClear=function(){var spreadsheet=SocialCalc.GetSpreadsheetControlObject();document.getElementById(spreadsheet.idPrefix+\"linkdesc\").value=\"\";document.getElementById(spreadsheet.idPrefix+\"linkpagename\").value=\"\";document.getElementById(spreadsheet.idPrefix+\"linkworkspace\").value=\"\";var ele=document.getElementById(spreadsheet.idPrefix+\"linkurl\");ele.value=\"\";ele.focus();};SocialCalc.SpreadsheetControl.DoLinkPaste=function(){var spreadsheet=SocialCalc.GetSpreadsheetControlObject();var editor=spreadsheet.editor;var wval=editor.workingvalues;var descele=document.getElementById(spreadsheet.idPrefix+\"linkdesc\");var urlele=document.getElementById(spreadsheet.idPrefix+\"linkurl\");var pagenameele=document.getElementById(spreadsheet.idPrefix+\"linkpagename\");var workspaceele=document.getElementById(spreadsheet.idPrefix+\"linkworkspace\");var formatele=document.getElementById(spreadsheet.idPrefix+\"linkformat\");var popupele=document.getElementById(spreadsheet.idPrefix+\"linkpopup\");var text=\"\";var ltsym,gtsym,obsym,cbsym;if(popupele.checked){ltsym=\"<<\";gtsym=\">>\";obsym=\"[[\";cbsym=\"]]\";}else{ltsym=\"<\";gtsym=\">\";obsym=\"[\";cbsym=\"]\";}if(pagenameele&&pagenameele.value){if(workspaceele.value){text=descele.value+\"{\"+workspaceele.value+obsym+pagenameele.value+cbsym+\"}\";}else{text=descele.value+obsym+pagenameele.value+cbsym;}}else{text=descele.value+ltsym+urlele.value+gtsym;}SocialCalc.SpreadsheetControl.HideLink();switch(editor.state){case\"start\":wval.partialexpr=\"\";wval.ecoord=editor.ecell.coord;wval.erow=editor.ecell.row;wval.ecol=editor.ecell.col;break;case\"input\":case\"inputboxdirect\":editor.inputBox.Blur();editor.inputBox.ShowInputBox(false);editor.state=\"start\";break;}if(formatele.checked){SocialCalc.SpreadsheetControlExecuteCommand(null,\"set %C textvalueformat text-link\",\"\");}editor.EditorSaveEdit(text);};SocialCalc.SpreadsheetControl.DoSum=function(){var cmd,cell,row,col,sel,cr,foundvalue;var spreadsheet=SocialCalc.GetSpreadsheetControlObject();var editor=spreadsheet.editor;var sheet=editor.context.sheetobj;if(editor.range.hasrange){sel=SocialCalc.crToCoord(editor.range.left,editor.range.top)+\":\"+SocialCalc.crToCoord(editor.range.right,editor.range.bottom);cmd=\"set \"+SocialCalc.crToCoord(editor.range.right,editor.range.bottom+1)+\" formula sum(\"+sel+\")\";}else{row=editor.ecell.row-1;col=editor.ecell.col;if(row<=1){cmd=\"set \"+editor.ecell.coord+\" constant e#REF! 0 #REF!\";}else{foundvalue=false;while(row>0){cr=SocialCalc.crToCoord(col,row);cell=sheet.GetAssuredCell(cr);if(!cell.datatype||cell.datatype==\"t\"){if(foundvalue){row++;break;}}else{foundvalue=true;}row--;}cmd=\"set \"+editor.ecell.coord+\" formula sum(\"+SocialCalc.crToCoord(col,row)+\":\"+SocialCalc.crToCoord(col,editor.ecell.row-1)+\")\";}}editor.EditorScheduleSheetCommands(cmd,true,false);};//\n\t// TAB Routines\n\t//\n\t// Sort\n\tSocialCalc.SpreadsheetControlSortOnclick=function(s,t){var name,i;var namelist=[];var nl=document.getElementById(s.idPrefix+\"sortlist\");SocialCalc.LoadColumnChoosers(s);s.editor.RangeChangeCallback.sort=SocialCalc.UpdateSortRangeProposal;for(name in s.sheet.names){namelist.push(name);}namelist.sort();nl.length=0;nl.options[0]=new Option(SocialCalc.LocalizeString(\"[select range]\"));for(i=0;i<namelist.length;i++){name=namelist[i];nl.options[i+1]=new Option(name,name);if(name==s.sortrange){nl.options[i+1].selected=true;}}if(s.sortrange==\"\"){nl.options[0].selected=true;}SocialCalc.UpdateSortRangeProposal(s.editor);SocialCalc.KeyboardFocus();return;};SocialCalc.SpreadsheetControlSortSave=function(editor,setting){// Format is:\n\t//    sort:sortrange:major:up/down:minor:up/down:last:up/down\n\tvar spreadsheet=SocialCalc.GetSpreadsheetControlObject();var str,sele,rele;str=\"sort:\"+SocialCalc.encodeForSave(spreadsheet.sortrange)+\":\";sele=document.getElementById(spreadsheet.idPrefix+\"majorsort\");rele=document.getElementById(spreadsheet.idPrefix+\"majorsortup\");str+=sele.selectedIndex+(rele.checked?\":up\":\":down\");sele=document.getElementById(spreadsheet.idPrefix+\"minorsort\");if(sele.selectedIndex>0){rele=document.getElementById(spreadsheet.idPrefix+\"minorsortup\");str+=\":\"+sele.selectedIndex+(rele.checked?\":up\":\":down\");}else{str+=\"::\";}sele=document.getElementById(spreadsheet.idPrefix+\"lastsort\");if(sele.selectedIndex>0){rele=document.getElementById(spreadsheet.idPrefix+\"lastsortup\");str+=\":\"+sele.selectedIndex+(rele.checked?\":up\":\":down\");}else{str+=\"::\";}return str+\"\\n\";};SocialCalc.SpreadsheetControlSortLoad=function(editor,setting,line,flags){var parts,ele;var spreadsheet=SocialCalc.GetSpreadsheetControlObject();parts=line.split(\":\");spreadsheet.sortrange=SocialCalc.decodeFromSave(parts[1]);ele=document.getElementById(spreadsheet.idPrefix+\"sortbutton\");if(spreadsheet.sortrange){ele.value=SocialCalc.LocalizeString(\"Sort \")+spreadsheet.sortrange;ele.style.visibility=\"visible\";}else{ele.style.visibility=\"hidden\";}SocialCalc.LoadColumnChoosers(spreadsheet);sele=document.getElementById(spreadsheet.idPrefix+\"majorsort\");sele.selectedIndex=parts[2]-0;document.getElementById(spreadsheet.idPrefix+\"majorsort\"+parts[3]).checked=true;sele=document.getElementById(spreadsheet.idPrefix+\"minorsort\");if(parts[4]){sele.selectedIndex=parts[4]-0;document.getElementById(spreadsheet.idPrefix+\"minorsort\"+parts[5]).checked=true;}else{sele.selectedIndex=0;document.getElementById(spreadsheet.idPrefix+\"minorsortup\").checked=true;}sele=document.getElementById(spreadsheet.idPrefix+\"lastsort\");if(parts[6]){sele.selectedIndex=parts[6]-0;document.getElementById(spreadsheet.idPrefix+\"lastsort\"+parts[7]).checked=true;}else{sele.selectedIndex=0;document.getElementById(spreadsheet.idPrefix+\"lastsortup\").checked=true;}return true;};// Comment\n\tSocialCalc.SpreadsheetControlCommentOnclick=function(s,t){s.editor.MoveECellCallback.comment=SocialCalc.SpreadsheetControlCommentMoveECell;SocialCalc.SpreadsheetControlCommentDisplay(s,t);SocialCalc.KeyboardFocus();return;};SocialCalc.SpreadsheetControlCommentDisplay=function(s,t){var c=\"\";if(s.editor.ecell&&s.editor.ecell.coord&&s.sheet.cells[s.editor.ecell.coord]){c=s.sheet.cells[s.editor.ecell.coord].comment||\"\";}document.getElementById(s.idPrefix+\"commenttext\").value=c;};SocialCalc.SpreadsheetControlCommentMoveECell=function(editor){SocialCalc.SpreadsheetControlCommentDisplay(SocialCalc.GetSpreadsheetControlObject(),\"comment\");};SocialCalc.SpreadsheetControlCommentSet=function(){var s=SocialCalc.GetSpreadsheetControlObject();s.ExecuteCommand(\"set %C comment \"+SocialCalc.encodeForSave(document.getElementById(s.idPrefix+\"commenttext\").value));var cell=SocialCalc.GetEditorCellElement(s.editor,s.editor.ecell.row,s.editor.ecell.col);s.editor.UpdateCellCSS(cell,s.editor.ecell.row,s.editor.ecell.col);SocialCalc.KeyboardFocus();};SocialCalc.SpreadsheetControlCommentOnunclick=function(s,t){delete s.editor.MoveECellCallback.comment;};// Names\n\tSocialCalc.SpreadsheetControlNamesOnclick=function(s,t){document.getElementById(s.idPrefix+\"namesname\").value=\"\";document.getElementById(s.idPrefix+\"namesdesc\").value=\"\";document.getElementById(s.idPrefix+\"namesvalue\").value=\"\";s.editor.RangeChangeCallback.names=SocialCalc.SpreadsheetControlNamesRangeChange;s.editor.MoveECellCallback.names=SocialCalc.SpreadsheetControlNamesRangeChange;SocialCalc.SpreadsheetControlNamesRangeChange(s.editor);SocialCalc.SpreadsheetControlNamesFillNameList();SocialCalc.SpreadsheetControlNamesChangedName();};SocialCalc.SpreadsheetControlNamesFillNameList=function(){var SCLoc=SocialCalc.LocalizeString;var name,i;var namelist=[];var s=SocialCalc.GetSpreadsheetControlObject();var nl=document.getElementById(s.idPrefix+\"nameslist\");var currentname=document.getElementById(s.idPrefix+\"namesname\").value.toUpperCase().replace(/[^A-Z0-9_\\.]/g,\"\");for(name in s.sheet.names){namelist.push(name);}namelist.sort();nl.length=0;if(namelist.length>0){nl.options[0]=new Option(SCLoc(\"[New]\"));}else{nl.options[0]=new Option(SCLoc(\"[None]\"));}for(i=0;i<namelist.length;i++){name=namelist[i];nl.options[i+1]=new Option(name,name);if(name==currentname){nl.options[i+1].selected=true;}}if(currentname==\"\"){nl.options[0].selected=true;}};SocialCalc.SpreadsheetControlNamesChangedName=function(){var s=SocialCalc.GetSpreadsheetControlObject();var nl=document.getElementById(s.idPrefix+\"nameslist\");var name=nl.options[nl.selectedIndex].value;if(s.sheet.names[name]){document.getElementById(s.idPrefix+\"namesname\").value=name;document.getElementById(s.idPrefix+\"namesdesc\").value=s.sheet.names[name].desc||\"\";document.getElementById(s.idPrefix+\"namesvalue\").value=s.sheet.names[name].definition||\"\";}else{document.getElementById(s.idPrefix+\"namesname\").value=\"\";document.getElementById(s.idPrefix+\"namesdesc\").value=\"\";document.getElementById(s.idPrefix+\"namesvalue\").value=\"\";}};SocialCalc.SpreadsheetControlNamesRangeChange=function(editor){var s=SocialCalc.GetSpreadsheetControlObject();var ele=document.getElementById(s.idPrefix+\"namesrangeproposal\");if(editor.range.hasrange){ele.value=SocialCalc.crToCoord(editor.range.left,editor.range.top)+\":\"+SocialCalc.crToCoord(editor.range.right,editor.range.bottom);}else{ele.value=editor.ecell.coord;}};SocialCalc.SpreadsheetControlNamesOnunclick=function(s,t){delete s.editor.RangeChangeCallback.names;delete s.editor.MoveECellCallback.names;};SocialCalc.SpreadsheetControlNamesSetValue=function(){var s=SocialCalc.GetSpreadsheetControlObject();document.getElementById(s.idPrefix+\"namesvalue\").value=document.getElementById(s.idPrefix+\"namesrangeproposal\").value;SocialCalc.KeyboardFocus();};SocialCalc.SpreadsheetControlNamesSave=function(){var s=SocialCalc.GetSpreadsheetControlObject();var name=document.getElementById(s.idPrefix+\"namesname\").value;SocialCalc.SetTab(s.tabs[0].name);// return to first tab\n\tSocialCalc.KeyboardFocus();if(name!=\"\"){s.ExecuteCommand(\"name define \"+name+\" \"+document.getElementById(s.idPrefix+\"namesvalue\").value+\"\\n\"+\"name desc \"+name+\" \"+document.getElementById(s.idPrefix+\"namesdesc\").value);}};SocialCalc.SpreadsheetControlNamesDelete=function(){var s=SocialCalc.GetSpreadsheetControlObject();var name=document.getElementById(s.idPrefix+\"namesname\").value;SocialCalc.SetTab(s.tabs[0].name);// return to first tab\n\tSocialCalc.KeyboardFocus();if(name!=\"\"){s.ExecuteCommand(\"name delete \"+name);//      document.getElementById(s.idPrefix+\"namesname\").value = \"\";\n\t//      document.getElementById(s.idPrefix+\"namesvalue\").value = \"\";\n\t//      document.getElementById(s.idPrefix+\"namesdesc\").value = \"\";\n\t//      SocialCalc.SpreadsheetControlNamesFillNameList();\n\t}SocialCalc.KeyboardFocus();};// Clipboard\n\tSocialCalc.SpreadsheetControlClipboardOnclick=function(s,t){var s=SocialCalc.GetSpreadsheetControlObject();clipele=document.getElementById(s.idPrefix+\"clipboardtext\");document.getElementById(s.idPrefix+\"clipboardformat-tab\").checked=true;clipele.value=SocialCalc.ConvertSaveToOtherFormat(SocialCalc.Clipboard.clipboard,\"tab\");return;};SocialCalc.SpreadsheetControlClipboardFormat=function(which){var s=SocialCalc.GetSpreadsheetControlObject();clipele=document.getElementById(s.idPrefix+\"clipboardtext\");clipele.value=SocialCalc.ConvertSaveToOtherFormat(SocialCalc.Clipboard.clipboard,which);};SocialCalc.SpreadsheetControlClipboardLoad=function(){var s=SocialCalc.GetSpreadsheetControlObject();var savetype=\"tab\";SocialCalc.SetTab(s.tabs[0].name);// return to first tab\n\tSocialCalc.KeyboardFocus();if(document.getElementById(s.idPrefix+\"clipboardformat-csv\").checked){savetype=\"csv\";}else if(document.getElementById(s.idPrefix+\"clipboardformat-scsave\").checked){savetype=\"scsave\";}s.editor.EditorScheduleSheetCommands(\"loadclipboard \"+SocialCalc.encodeForSave(SocialCalc.ConvertOtherFormatToSave(document.getElementById(s.idPrefix+\"clipboardtext\").value,savetype)),true,false);};SocialCalc.SpreadsheetControlClipboardClear=function(){var s=SocialCalc.GetSpreadsheetControlObject();var clipele=document.getElementById(s.idPrefix+\"clipboardtext\");clipele.value=\"\";s.editor.EditorScheduleSheetCommands(\"clearclipboard\",true,false);clipele.focus();};SocialCalc.SpreadsheetControlClipboardExport=function(){var s=SocialCalc.GetSpreadsheetControlObject();if(s.ExportCallback){s.ExportCallback(s);}SocialCalc.SetTab(s.tabs[0].name);// return to first tab\n\tSocialCalc.KeyboardFocus();};// Settings\n\tSocialCalc.SpreadsheetControlSettingsSwitch=function(target){SocialCalc.SettingControlReset();var s=SocialCalc.GetSpreadsheetControlObject();var sheettable=document.getElementById(s.idPrefix+\"sheetsettingstable\");var celltable=document.getElementById(s.idPrefix+\"cellsettingstable\");var sheettoolbar=document.getElementById(s.idPrefix+\"sheetsettingstoolbar\");var celltoolbar=document.getElementById(s.idPrefix+\"cellsettingstoolbar\");if(target==\"sheet\"){sheettable.style.display=\"block\";celltable.style.display=\"none\";sheettoolbar.style.display=\"block\";celltoolbar.style.display=\"none\";SocialCalc.SettingsControlSetCurrentPanel(s.views.settings.values.sheetspanel);}else{sheettable.style.display=\"none\";celltable.style.display=\"block\";sheettoolbar.style.display=\"none\";celltoolbar.style.display=\"block\";SocialCalc.SettingsControlSetCurrentPanel(s.views.settings.values.cellspanel);}};SocialCalc.SettingsControlSave=function(target){var range,cmdstr;var s=SocialCalc.GetSpreadsheetControlObject();var sc=SocialCalc.SettingsControls;var panelobj=sc.CurrentPanel;var attribs=SocialCalc.SettingsControlUnloadPanel(panelobj);SocialCalc.SetTab(s.tabs[0].name);// return to first tab\n\tSocialCalc.KeyboardFocus();if(target==\"sheet\"){cmdstr=s.sheet.DecodeSheetAttributes(attribs);}else if(target==\"cell\"){if(s.editor.range.hasrange){range=SocialCalc.crToCoord(s.editor.range.left,s.editor.range.top)+\":\"+SocialCalc.crToCoord(s.editor.range.right,s.editor.range.bottom);}cmdstr=s.sheet.DecodeCellAttributes(s.editor.ecell.coord,attribs,range);}else{// Cancel\n\t}if(cmdstr){s.editor.EditorScheduleSheetCommands(cmdstr,true,false);}};///////////////////////\n\t//\n\t// SAVE / LOAD ROUTINES\n\t//\n\t///////////////////////\n\t//\n\t// result = SocialCalc.SpreadsheetControlCreateSpreadsheetSave(spreadsheet, otherparts)\n\t//\n\t// Saves the spreadsheet's sheet data, editor settings, and audit trail (redo stack).\n\t// The serialized data strings are concatenated together in multi-part MIME format.\n\t// The first part lists the types of the subsequent parts (e.g., \"sheet\", \"editor\", and \"audit\")\n\t// in this format:\n\t//   # comments\n\t//   version:1.0\n\t//   part:type1\n\t//   part:type2\n\t//   ...\n\t//\n\t// If otherparts is non-null, it is an object with:\n\t//   partname1: \"part contents - should end with \\n\",\n\t//   partname2: \"part contents - should end with \\n\"\n\t//\n\tSocialCalc.SpreadsheetControlCreateSpreadsheetSave=function(spreadsheet,otherparts){var result;var otherpartsstr=\"\";var otherpartsnames=\"\";var partname,extranl;if(otherparts){for(partname in otherparts){if(otherparts[partname].charAt(otherparts[partname]-1)!=\"\\n\"){extranl=\"\\n\";}else{extranl=\"\";}otherpartsstr+=\"--\"+spreadsheet.multipartBoundary+\"\\nContent-type: text/plain; charset=UTF-8\\n\\n\"+otherparts[partname]+extranl;otherpartsnames+=\"part:\"+partname+\"\\n\";}}result=\"socialcalc:version:1.0\\n\"+\"MIME-Version: 1.0\\nContent-Type: multipart/mixed; boundary=\"+spreadsheet.multipartBoundary+\"\\n\"+\"--\"+spreadsheet.multipartBoundary+\"\\nContent-type: text/plain; charset=UTF-8\\n\\n\"+\"# SocialCalc Spreadsheet Control Save\\nversion:1.0\\npart:sheet\\npart:edit\\npart:audit\\n\"+otherpartsnames+\"--\"+spreadsheet.multipartBoundary+\"\\nContent-type: text/plain; charset=UTF-8\\n\\n\"+spreadsheet.CreateSheetSave()+\"--\"+spreadsheet.multipartBoundary+\"\\nContent-type: text/plain; charset=UTF-8\\n\\n\"+spreadsheet.editor.SaveEditorSettings()+\"--\"+spreadsheet.multipartBoundary+\"\\nContent-type: text/plain; charset=UTF-8\\n\\n\"+spreadsheet.sheet.CreateAuditString()+otherpartsstr+\"--\"+spreadsheet.multipartBoundary+\"--\\n\";return result;};//\n\t// parts = SocialCalc.SpreadsheetControlDecodeSpreadsheetSave(spreadsheet, str)\n\t//\n\t// Separates the parts from a spreadsheet save string, returning an object with the sub-strings.\n\t//\n\t//    {type1: {start: startpos, end: endpos}, type2:...}\n\t//\n\tSocialCalc.SpreadsheetControlDecodeSpreadsheetSave=function(spreadsheet,str){var pos1,mpregex,searchinfo,boundary,boundaryregex,blanklineregex,start,ending,lines,i,lines,p,pnun;var parts={};var partlist=[];pos1=str.search(/^MIME-Version:\\s1\\.0/mi);if(pos1<0)return parts;mpregex=/^Content-Type:\\s*multipart\\/mixed;\\s*boundary=(\\S+)/mig;mpregex.lastIndex=pos1;searchinfo=mpregex.exec(str);if(mpregex.lastIndex<=0)return parts;boundary=searchinfo[1];boundaryregex=new RegExp(\"^--\"+boundary+\"(?:\\r\\n|\\n)\",\"mg\");boundaryregex.lastIndex=mpregex.lastIndex;searchinfo=boundaryregex.exec(str);// find header top boundary\n\tblanklineregex=/(?:\\r\\n|\\n)(?:\\r\\n|\\n)/gm;blanklineregex.lastIndex=boundaryregex.lastIndex;searchinfo=blanklineregex.exec(str);// skip to after blank line\n\tif(!searchinfo)return parts;start=blanklineregex.lastIndex;boundaryregex.lastIndex=start;searchinfo=boundaryregex.exec(str);// find end of header\n\tif(!searchinfo)return parts;ending=searchinfo.index;lines=str.substring(start,ending).split(/\\r\\n|\\n/);// get header as lines\n\tfor(i=0;i<lines.length;i++){line=lines[i];p=line.split(\":\");switch(p[0]){case\"version\":break;case\"part\":partlist.push(p[1]);break;}}for(pnum=0;pnum<partlist.length;pnum++){// get each part\n\tblanklineregex.lastIndex=ending;searchinfo=blanklineregex.exec(str);// find blank line ending mime-part header\n\tif(!searchinfo)return parts;start=blanklineregex.lastIndex;if(pnum==partlist.length-1){// last one has different boundary\n\tboundaryregex=new RegExp(\"^--\"+boundary+\"--$\",\"mg\");}boundaryregex.lastIndex=start;searchinfo=boundaryregex.exec(str);// find ending boundary\n\tif(!searchinfo)return parts;ending=searchinfo.index;parts[partlist[pnum]]={start:start,end:ending};// return position within full string\n\t}return parts;};/*\n\t* SettingsControls\n\t*\n\t* Each settings panel has an object in the following form:\n\t*\n\t*    {ctrl-name1: {setting: setting-nameA, type: ctrl-type, id: id-component},\n\t*     ctrl-name2: {setting: setting-nameB, type: ctrl-type, id: id-component, initialdata: optional-initialdata-override},\n\t*     ...}\n\t*\n\t* The ctrl-types are names that correspond to:\n\t*\n\t*    SocialCalc.SettingsControls.Controls = {\n\t*       ctrl-type1: {\n\t*          SetValue: function(panel-obj, ctrl-name, {def: true/false, val: value}) {...;},\n\t*          ColorValues: if true, Onchanged converts between hex and RGB\n\t*          GetValue: function(panel-obj, ctrl-name) {...return {def: true/false, val: value};},\n\t*          Initialize: function(panel-obj, ctrl-name) {...;}, // used to fill dropdowns, etc.\n\t*          InitialData: control-dependent, // used by Initialize (if no panel ctrlname.initialdata)\n\t*          OnReset: function(ctrl-name) {...;}, // called to put down popups, etc.\n\t*          ChangedCallback: function(ctrl-name) {...;} // if not null, called by control when user changes value\n\t*       }\n\t*\n\t*/SocialCalc.SettingsControls={Controls:{},CurrentPanel:null// panel object to search on events\n\t};//\n\t// SocialCalc.SettingsControlSetCurrentPanel(panel-object)\n\t//\n\tSocialCalc.SettingsControlSetCurrentPanel=function(panelobj){SocialCalc.SettingsControls.CurrentPanel=panelobj;SocialCalc.SettingsControls.PopupChangeCallback({panelobj:panelobj},\"\",null);};//\n\t// SocialCalc.SettingsControlInitializePanel(panel-object)\n\t//\n\tSocialCalc.SettingsControlInitializePanel=function(panelobj){var ctrlname;var sc=SocialCalc.SettingsControls;for(ctrlname in panelobj){if(ctrlname==\"name\")continue;ctrl=sc.Controls[panelobj[ctrlname].type];if(ctrl&&ctrl.Initialize)ctrl.Initialize(panelobj,ctrlname);}};//\n\t// SocialCalc.SettingsControlLoadPanel(panel-object, attribs)\n\t//\n\tSocialCalc.SettingsControlLoadPanel=function(panelobj,attribs){var ctrlname;var sc=SocialCalc.SettingsControls;for(ctrlname in panelobj){if(ctrlname==\"name\")continue;ctrl=sc.Controls[panelobj[ctrlname].type];if(ctrl&&ctrl.SetValue)ctrl.SetValue(panelobj,ctrlname,attribs[panelobj[ctrlname].setting]);}};//\n\t// attribs = SocialCalc.SettingsControlUnloadPanel(panel-object)\n\t//\n\tSocialCalc.SettingsControlUnloadPanel=function(panelobj){var ctrlname;var sc=SocialCalc.SettingsControls;var attribs={};for(ctrlname in panelobj){if(ctrlname==\"name\")continue;ctrl=sc.Controls[panelobj[ctrlname].type];if(ctrl&&ctrl.GetValue)attribs[panelobj[ctrlname].setting]=ctrl.GetValue(panelobj,ctrlname);}return attribs;};//\n\t// SocialCalc.SettingsControls.PopupChangeCallback\n\t//\n\tSocialCalc.SettingsControls.PopupChangeCallback=function(attribs,id,value){var sc=SocialCalc.Constants;var ele=document.getElementById(\"sample-text\");if(!ele||!attribs||!attribs.panelobj)return;var idPrefix=SocialCalc.CurrentSpreadsheetControlObject.idPrefix;var c=attribs.panelobj.name==\"cell\"?\"c\":\"\";var v,a,parts,str1,str2,i;parts=sc.defaultCellLayout.match(/^padding.(\\S+) (\\S+) (\\S+) (\\S+).vertical.align.(\\S+);$/)||[];var cv={color:[\"textcolor\"],backgroundColor:[\"bgcolor\",\"#FFF\"],fontSize:[\"fontsize\",sc.defaultCellFontSize],fontFamily:[\"fontfamily\"],paddingTop:[\"padtop\",parts[1]],paddingRight:[\"padright\",parts[2]],paddingBottom:[\"padbottom\",parts[3]],paddingLeft:[\"padleft\",parts[4]],verticalAlign:[\"alignvert\",parts[5]]};for(a in cv){v=SocialCalc.Popup.GetValue(idPrefix+c+cv[a][0])||cv[a][1]||\"\";ele.style[a]=v;}if(c==\"c\"){cv={borderTop:\"cbt\",borderRight:\"cbr\",borderBottom:\"cbb\",borderLeft:\"cbl\"};for(a in cv){v=SocialCalc.SettingsControls.BorderSideGetValue(attribs.panelobj,cv[a]);ele.style[a]=v?v.val||\"\":\"\";}v=SocialCalc.Popup.GetValue(idPrefix+\"calignhoriz\");ele.style.textAlign=v||\"left\";ele.childNodes[1].style.textAlign=v||\"right\";}else{ele.style.border=\"\";v=SocialCalc.Popup.GetValue(idPrefix+\"textalignhoriz\");ele.style.textAlign=v||\"left\";v=SocialCalc.Popup.GetValue(idPrefix+\"numberalignhoriz\");ele.childNodes[1].style.textAlign=v||\"right\";}v=SocialCalc.Popup.GetValue(idPrefix+c+\"fontlook\");parts=v?v.match(/^(\\S+) (\\S+)$/)||[]:[];ele.style.fontStyle=parts[1]||\"\";ele.style.fontWeight=parts[2]||\"\";v=SocialCalc.Popup.GetValue(idPrefix+c+\"formatnumber\")||\"General\";str1=SocialCalc.FormatNumber.formatNumberWithFormat(9.8765,v,\"\");str2=SocialCalc.FormatNumber.formatNumberWithFormat(-1234.5,v,\"\");if(str2!=\"??-???-??&nbsp;??:??:??\"){// not bad date from negative number\n\tstr1+=\"<br>\"+str2;}ele.childNodes[1].innerHTML=str1;};//\n\t// PopupList Control\n\t//\n\tSocialCalc.SettingsControls.PopupListSetValue=function(panelobj,ctrlname,value){if(!value){alert(ctrlname+\" no value\");return;}var sp=SocialCalc.Popup;if(!value.def){sp.SetValue(panelobj[ctrlname].id,value.val);}else{sp.SetValue(panelobj[ctrlname].id,\"\");}};//\n\t// SocialCalc.SettingsControls.PopupListGetValue\n\t//\n\tSocialCalc.SettingsControls.PopupListGetValue=function(panelobj,ctrlname){var ctl=panelobj[ctrlname];if(!ctl)return null;var value=SocialCalc.Popup.GetValue(ctl.id);if(value){return{def:false,val:value};}else{return{def:true,val:0};}};//\n\t// SocialCalc.SettingsControls.PopupListInitialize\n\t//\n\tSocialCalc.SettingsControls.PopupListInitialize=function(panelobj,ctrlname){var i,val,pos,otext;var sc=SocialCalc.SettingsControls;var initialdata=panelobj[ctrlname].initialdata||sc.Controls[panelobj[ctrlname].type].InitialData||\"\";initialdata=SocialCalc.LocalizeSubstrings(initialdata);var optionvals=initialdata.split(/\\|/);var options=[];for(i=0;i<(optionvals.length||0);i++){val=optionvals[i];pos=val.indexOf(\":\");otext=val.substring(0,pos);if(otext.indexOf(\"\\\\\")!=-1){// escape any colons\n\totext=otext.replace(/\\\\c/g,\":\");otext=otext.replace(/\\\\b/g,\"\\\\\");}otext=SocialCalc.special_chars(otext);if(otext==\"[custom]\"){options[i]={o:SocialCalc.Constants.s_PopupListCustom,v:val.substring(pos+1),a:{custom:true}};}else if(otext==\"[cancel]\"){options[i]={o:SocialCalc.Constants.s_PopupListCancel,v:\"\",a:{cancel:true}};}else if(otext==\"[break]\"){options[i]={o:\"-----\",v:\"\",a:{skip:true}};}else if(otext==\"[newcol]\"){options[i]={o:\"\",v:\"\",a:{newcol:true}};}else{options[i]={o:otext,v:val.substring(pos+1)};}}SocialCalc.Popup.Create(\"List\",panelobj[ctrlname].id,{});SocialCalc.Popup.Initialize(panelobj[ctrlname].id,{options:options,attribs:{changedcallback:SocialCalc.SettingsControls.PopupChangeCallback,panelobj:panelobj}});};//\n\t// SocialCalc.SettingsControls.PopupListReset\n\t//\n\tSocialCalc.SettingsControls.PopupListReset=function(ctrlname){SocialCalc.Popup.Reset(\"List\");};SocialCalc.SettingsControls.Controls.PopupList={SetValue:SocialCalc.SettingsControls.PopupListSetValue,GetValue:SocialCalc.SettingsControls.PopupListGetValue,Initialize:SocialCalc.SettingsControls.PopupListInitialize,OnReset:SocialCalc.SettingsControls.PopupListReset,ChangedCallback:null//\n\t// ColorChooser Control\n\t//\n\t};SocialCalc.SettingsControls.ColorChooserSetValue=function(panelobj,ctrlname,value){if(!value){alert(ctrlname+\" no value\");return;}var sp=SocialCalc.Popup;if(!value.def){sp.SetValue(panelobj[ctrlname].id,value.val);}else{sp.SetValue(panelobj[ctrlname].id,\"\");}};//\n\t// SocialCalc.SettingsControls.ColorChooserGetValue\n\t//\n\tSocialCalc.SettingsControls.ColorChooserGetValue=function(panelobj,ctrlname){var value=SocialCalc.Popup.GetValue(panelobj[ctrlname].id);if(value){return{def:false,val:value};}else{return{def:true,val:0};}};//\n\t// SocialCalc.SettingsControls.ColorChooserInitialize\n\t//\n\tSocialCalc.SettingsControls.ColorChooserInitialize=function(panelobj,ctrlname){var i,val,pos,otext;var sc=SocialCalc.SettingsControls;SocialCalc.Popup.Create(\"ColorChooser\",panelobj[ctrlname].id,{});SocialCalc.Popup.Initialize(panelobj[ctrlname].id,{attribs:{title:\"&nbsp;\",moveable:true,width:\"106px\",changedcallback:SocialCalc.SettingsControls.PopupChangeCallback,panelobj:panelobj}});};//\n\t// SocialCalc.SettingsControls.ColorChooserReset\n\t//\n\tSocialCalc.SettingsControls.ColorChooserReset=function(ctrlname){SocialCalc.Popup.Reset(\"ColorChooser\");};SocialCalc.SettingsControls.Controls.ColorChooser={SetValue:SocialCalc.SettingsControls.ColorChooserSetValue,GetValue:SocialCalc.SettingsControls.ColorChooserGetValue,Initialize:SocialCalc.SettingsControls.ColorChooserInitialize,OnReset:SocialCalc.SettingsControls.ColorChooserReset,ChangedCallback:null//\n\t// SocialCalc.SettingsControls.BorderSideSetValue\n\t//\n\t};SocialCalc.SettingsControls.BorderSideSetValue=function(panelobj,ctrlname,value){var sc=SocialCalc.SettingsControls;var ele,found,idname,parts;var idstart=panelobj[ctrlname].id;if(!value){alert(ctrlname+\" no value\");return;}ele=document.getElementById(idstart+\"-onoff-bcb\");// border checkbox\n\tif(!ele)return;if(value.val){// border does not use default: it looks only to the value currently\n\tele.checked=true;ele.value=value.val;parts=value.val.match(/(\\S+)\\s+(\\S+)\\s+(\\S.+)/);idname=idstart+\"-color\";SocialCalc.Popup.SetValue(idname,parts[3]);SocialCalc.Popup.SetDisabled(idname,false);}else{ele.checked=false;ele.value=value.val;idname=idstart+\"-color\";SocialCalc.Popup.SetValue(idname,\"\");SocialCalc.Popup.SetDisabled(idname,true);}};//\n\t// SocialCalc.SettingsControls.BorderSideGetValue\n\t//\n\tSocialCalc.SettingsControls.BorderSideGetValue=function(panelobj,ctrlname){var sc=SocialCalc.SettingsControls;var ele,value;var idstart=panelobj[ctrlname].id;ele=document.getElementById(idstart+\"-onoff-bcb\");// border checkbox\n\tif(!ele)return;if(ele.checked){// on\n\tvalue=SocialCalc.Popup.GetValue(idstart+\"-color\");value=\"1px solid \"+(value||\"rgb(0,0,0)\");return{def:false,val:value};}else{// off\n\treturn{def:false,val:\"\"};}};//\n\t// SocialCalc.SettingsControls.BorderSideInitialize\n\t//\n\tSocialCalc.SettingsControls.BorderSideInitialize=function(panelobj,ctrlname){var sc=SocialCalc.SettingsControls;var idstart=panelobj[ctrlname].id;SocialCalc.Popup.Create(\"ColorChooser\",idstart+\"-color\",{});SocialCalc.Popup.Initialize(idstart+\"-color\",{attribs:{title:\"&nbsp;\",width:\"106px\",moveable:true,changedcallback:SocialCalc.SettingsControls.PopupChangeCallback,panelobj:panelobj}});};//\n\t// SocialCalc.SettingsControlOnchangeBorder = function(ele)\n\t//\n\tSocialCalc.SettingsControlOnchangeBorder=function(ele){var idname,value,found,ele2;var sc=SocialCalc.SettingsControls;var panelobj=sc.CurrentPanel;var nameparts=ele.id.match(/(^.*\\-)(\\w+)\\-(\\w+)\\-(\\w+)$/);if(!nameparts)return;var prefix=nameparts[1];var ctrlname=nameparts[2];var ctrlsubid=nameparts[3];var ctrlidsuffix=nameparts[4];var ctrltype=panelobj[ctrlname].type;switch(ctrlidsuffix){case\"bcb\":// border checkbox\n\tif(ele.checked){sc.Controls[ctrltype].SetValue(sc.CurrentPanel,ctrlname,{def:false,val:ele.value||\"1px solid rgb(0,0,0)\"});}else{sc.Controls[ctrltype].SetValue(sc.CurrentPanel,ctrlname,{def:false,val:\"\"});}break;}};SocialCalc.SettingsControls.Controls.BorderSide={SetValue:SocialCalc.SettingsControls.BorderSideSetValue,GetValue:SocialCalc.SettingsControls.BorderSideGetValue,OnClick:SocialCalc.SettingsControls.ColorComboOnClick,Initialize:SocialCalc.SettingsControls.BorderSideInitialize,InitialData:{thickness:\"1 pixel:1px\",style:\"Solid:solid\"},ChangedCallback:null};SocialCalc.SettingControlReset=function(){var sc=SocialCalc.SettingsControls;var ctrlname;for(ctrlname in sc.Controls){if(sc.Controls[ctrlname].OnReset)sc.Controls[ctrlname].OnReset(ctrlname);}};/**********************\n\t*\n\t* CtrlSEditor implementation for editing SocialCalc.OtherSaveParts\n\t*\n\t*/SocialCalc.OtherSaveParts={};// holds other parts to save - must be set when loaded if you want to keep\n\tSocialCalc.CtrlSEditor=function(whichpart){var strtoedit,partname;if(whichpart.length>0){strtoedit=SocialCalc.special_chars(SocialCalc.OtherSaveParts[whichpart]||\"\");}else{strtoedit=\"Listing of Parts\\n\";for(partname in SocialCalc.OtherSaveParts){strtoedit+=SocialCalc.special_chars(\"\\nPart: \"+partname+\"\\n=====\\n\"+SocialCalc.OtherSaveParts[partname]+\"\\n\");}}var editbox=document.createElement(\"div\");editbox.style.cssText=\"position:absolute;z-index:500;width:300px;height:300px;left:100px;top:200px;border:1px solid black;background-color:#EEE;text-align:center;\";editbox.id=\"socialcalc-editbox\";editbox.innerHTML=whichpart+'<br><br><textarea id=\"socialcalc-editbox-textarea\" style=\"width:250px;height:200px;\">'+strtoedit+'</textarea><br><br><input type=button '+'onclick=\"SocialCalc.CtrlSEditorDone (\\'socialcalc-editbox\\', \\''+whichpart+'\\');\" value=\"OK\">';document.body.appendChild(editbox);var ebta=document.getElementById(\"socialcalc-editbox-textarea\");ebta.focus();SocialCalc.CmdGotFocus(ebta);};SocialCalc.CtrlSEditorDone=function(idprefix,whichpart){var edittextarea=document.getElementById(idprefix+\"-textarea\");var text=edittextarea.value;if(whichpart.length>0){if(text.length>0){SocialCalc.OtherSaveParts[whichpart]=text;}else{delete SocialCalc.OtherSaveParts[whichpart];}}var editbox=document.getElementById(idprefix);SocialCalc.KeyboardFocus();editbox.parentNode.removeChild(editbox);};//\n\t// Workbook is a collection of sheets that are worked upon together\n\t// \n\t// The WorkBook class models and manages the collection of sheets\n\t//\n\t// Author: Ramu Ramamurthy\n\t//\n\t//\n\tvar SocialCalc;if(!SocialCalc){alert(\"Main SocialCalc code module needed\");SocialCalc={};}// Constructor:\n\tSocialCalc.WorkBook=function(spread){this.spreadsheet=spread;// this is the spreadsheet control\n\tthis.defaultsheetname=null;this.sheetArr={};// misnomer, this is not really an array\n\tthis.clipsheet={};// for copy paste of sheets\n\t};// Methods\n\tSocialCalc.WorkBook.prototype.InitializeWorkBook=function(defaultsheet){return SocialCalc.InitializeWorkBook(this,defaultsheet);};SocialCalc.WorkBook.prototype.AddNewWorkBookSheetNoSwitch=function(sheetid,sheetname,savestr){return SocialCalc.AddNewWorkBookSheetNoSwitch(this,sheetid,sheetname,savestr);};SocialCalc.WorkBook.prototype.AddNewWorkBookSheet=function(sheetname,oldsheetname,fromclip,spread){return SocialCalc.AddNewWorkBookSheet(this,sheetname,oldsheetname,fromclip,spread);};SocialCalc.WorkBook.prototype.ActivateWorkBookSheet=function(sheetname,oldsheetname){return SocialCalc.ActivateWorkBookSheet(this,sheetname,oldsheetname);};SocialCalc.WorkBook.prototype.DeleteWorkBookSheet=function(sheetname,cursheetname){return SocialCalc.DeleteWorkBookSheet(this,sheetname,cursheetname);};SocialCalc.WorkBook.prototype.SaveWorkBookSheet=function(sheetid){return SocialCalc.SaveWorkBookSheet(this,sheetid);};SocialCalc.WorkBook.prototype.LoadRenameWorkBookSheet=function(sheetid,savestr,newname){return SocialCalc.LoadRenameWorkBookSheet(this,sheetid,savestr,newname);};SocialCalc.WorkBook.prototype.RenameWorkBookSheet=function(oldname,newname,sheetid){return SocialCalc.RenameWorkBookSheet(this,oldname,newname,sheetid);};SocialCalc.WorkBook.prototype.CopyWorkBookSheet=function(sheetid){return SocialCalc.CopyWorkBookSheet(this,sheetid);};SocialCalc.WorkBook.prototype.PasteWorkBookSheet=function(newid,oldid){return SocialCalc.PasteWorkBookSheet(this,newid,oldid);};SocialCalc.WorkBook.prototype.RenderWorkBookSheet=function(){return SocialCalc.RenderWorkBookSheet(this);};SocialCalc.WorkBook.prototype.SheetNameExistsInWorkBook=function(name){return SocialCalc.SheetNameExistsInWorkBook(this,name);};SocialCalc.WorkBook.prototype.WorkbookScheduleCommand=function(cmd,isremote){return SocialCalc.WorkbookScheduleCommand(this,cmd,isremote);};SocialCalc.WorkBook.prototype.WorkbookScheduleSheetCommand=function(cmd,isremote){return SocialCalc.WorkbookScheduleSheetCommand(this,cmd,isremote);};// schedule some command - could be for sheet or for the workbook itself\n\tSocialCalc.WorkbookScheduleCommand=function WorkbookScheduleCommand(workbook,cmd,isremote){//console.log(\"cmd \", cmd.cmdstr, cmd.cmdtype);\n\tif(cmd.cmdtype==\"scmd\"){workbook.WorkbookScheduleSheetCommand(cmd,isremote);}};SocialCalc.WorkbookScheduleSheetCommand=function WorkbookScheduleSheetCommand(workbook,cmd,isremote){//console.log(cmd.cmdtype,cmd.id,cmd.cmdstr);\n\t// check if sheet exists first\n\tif(workbook.sheetArr[cmd.id]){workbook.sheetArr[cmd.id].sheet.ScheduleSheetCommands(cmd.cmdstr,cmd.saveundo,isremote);}};SocialCalc.InitializeWorkBook=function InitializeWorkBook(workbook,defaultsheet){workbook.defaultsheetname=defaultsheet;var spreadsheet=workbook.spreadsheet;var defaultsheetname=workbook.defaultsheetname;// Initialize the Spreadsheet Control and display it\n\tSocialCalc.Formula.SheetCache.sheets[defaultsheetname]={sheet:spreadsheet.sheet,name:defaultsheetname};spreadsheet.sheet.sheetid=defaultsheetname;spreadsheet.sheet.sheetname=defaultsheetname;workbook.sheetArr[defaultsheetname]={};workbook.sheetArr[defaultsheetname].sheet=spreadsheet.sheet;workbook.sheetArr[defaultsheetname].context=spreadsheet.context;// if these were properties of the sheet, then we wouldnt need to do this !\n\tworkbook.sheetArr[defaultsheetname].editorprop={};workbook.sheetArr[defaultsheetname].editorprop.ecell=null;workbook.sheetArr[defaultsheetname].editorprop.range=null;workbook.sheetArr[defaultsheetname].editorprop.range2=null;workbook.clipsheet.savestr=null;workbook.clipsheet.copiedfrom=null;workbook.clipsheet.editorprop={};spreadsheet.editor.workingvalues.currentsheet=spreadsheet.sheet.sheetname;spreadsheet.editor.workingvalues.startsheet=spreadsheet.editor.workingvalues.currentsheet;spreadsheet.editor.workingvalues.currentsheetid=spreadsheet.sheet.sheetid;};SocialCalc.AddNewWorkBookSheetNoSwitch=function AddNewWorkBookSheetNoSwitch(workbook,sheetid,sheetname,savestr){//alert(sheetid+\",\"+sheetname+\",\"+savestr);\n\tvar spreadsheet=workbook.spreadsheet;var newsheet=new SocialCalc.Sheet();SocialCalc.Formula.SheetCache.sheets[sheetname]={sheet:newsheet,name:sheetname};newsheet.sheetid=sheetid;newsheet.sheetname=sheetname;if(savestr){newsheet.ParseSheetSave(savestr);}workbook.sheetArr[sheetid]={};workbook.sheetArr[sheetid].sheet=newsheet;workbook.sheetArr[sheetid].context=null;if(workbook.sheetArr[sheetid].sheet.attribs){workbook.sheetArr[sheetid].sheet.attribs.needsrecalc=\"yes\";}workbook.sheetArr[sheetid].editorprop={};workbook.sheetArr[sheetid].editorprop.ecell={coord:\"A1\",row:1,col:1};workbook.sheetArr[sheetid].editorprop.range=null;workbook.sheetArr[sheetid].editorprop.range2=null;};SocialCalc.AddNewWorkBookSheet=function AddNewWorkBookSheet(workbook,sheetid,oldsheetid,fromclip,spread){var spreadsheet=workbook.spreadsheet;//alert(\"create new sheet \"+sheetid+\" old=\"+oldsheetid+\" def=\"+workbook.defaultsheetname);\n\tif(spread==null){spreadsheet.sheet=new SocialCalc.Sheet();SocialCalc.Formula.SheetCache.sheets[sheetid]={sheet:spreadsheet.sheet,name:sheetid};spreadsheet.sheet.sheetid=sheetid;spreadsheet.sheet.sheetname=sheetid;}else{//alert(\"existing spread\")\n\tspreadsheet.sheet=spread;}spreadsheet.context=new SocialCalc.RenderContext(spreadsheet.sheet);spreadsheet.sheet.statuscallback=SocialCalc.EditorSheetStatusCallback;spreadsheet.sheet.statuscallbackparams=spreadsheet.editor;workbook.sheetArr[sheetid]={};workbook.sheetArr[sheetid].sheet=spreadsheet.sheet;workbook.sheetArr[sheetid].context=spreadsheet.context;workbook.sheetArr[sheetid].editorprop={};workbook.sheetArr[sheetid].editorprop.ecell=null;workbook.sheetArr[sheetid].editorprop.range=null;workbook.sheetArr[sheetid].editorprop.range2=null;if(oldsheetid!=null){workbook.sheetArr[oldsheetid].editorprop.ecell=spreadsheet.editor.ecell;workbook.sheetArr[oldsheetid].editorprop.range=spreadsheet.editor.range;workbook.sheetArr[oldsheetid].editorprop.range2=spreadsheet.editor.range2;}spreadsheet.context.showGrid=true;spreadsheet.context.showRCHeaders=true;spreadsheet.editor.context=spreadsheet.context;if(!fromclip){spreadsheet.editor.ecell={coord:\"A1\",row:1,col:1};spreadsheet.editor.range={hasrange:false};spreadsheet.editor.range2={hasrange:false};}// set highlights\n\tspreadsheet.context.highlights[spreadsheet.editor.ecell.coord]=\"cursor\";if(fromclip){// this is the result of a paste sheet\n\t//alert(\"from clip\");\n\tif(workbook.clipsheet.savestr!=null){//alert(\"sheetdata = \"+workbook.clipsheet.savestr);\n\tspreadsheet.sheet.ParseSheetSave(workbook.clipsheet.savestr);}spreadsheet.editor.ecell=workbook.clipsheet.editorprop.ecell;spreadsheet.context.highlights[spreadsheet.editor.ecell.coord]=\"cursor\";// range is not pasted ??!??\n\t}spreadsheet.editor.workingvalues.currentsheet=spreadsheet.sheet.sheetname;spreadsheet.editor.workingvalues.startsheet=spreadsheet.editor.workingvalues.currentsheet;spreadsheet.editor.workingvalues.currentsheetid=spreadsheet.sheet.sheetid;spreadsheet.editor.FitToEditTable();spreadsheet.editor.ScheduleRender();//spreadsheet.ExecuteCommand('recalc', '');\n\t};SocialCalc.ActivateWorkBookSheet=function ActivateWorkBookSheet(workbook,sheetnamestr,oldsheetnamestr){var spreadsheet=workbook.spreadsheet;//alert(\"activate \"+sheetnamestr+\" old=\"+oldsheetnamestr);\n\tspreadsheet.sheet=workbook.sheetArr[sheetnamestr].sheet;spreadsheet.context=workbook.sheetArr[sheetnamestr].context;if(spreadsheet.context==null){//alert(\"context null\")\n\t//for (var sheet in workbook.sheetArr) alert(sheet+spreadsheet.sheet )\n\tworkbook.AddNewWorkBookSheet(sheetnamestr,oldsheetnamestr,false,spreadsheet.sheet);return;}spreadsheet.editor.context=spreadsheet.context;if(oldsheetnamestr!=null){workbook.sheetArr[oldsheetnamestr].editorprop.ecell=spreadsheet.editor.ecell;}spreadsheet.editor.ecell=workbook.sheetArr[sheetnamestr].editorprop.ecell;if(oldsheetnamestr!=null){workbook.sheetArr[oldsheetnamestr].editorprop.range=spreadsheet.editor.range;}spreadsheet.editor.range=workbook.sheetArr[sheetnamestr].editorprop.range;if(oldsheetnamestr!=null){workbook.sheetArr[oldsheetnamestr].editorprop.range2=spreadsheet.editor.range2;}spreadsheet.editor.range2=workbook.sheetArr[sheetnamestr].editorprop.range2;spreadsheet.sheet.statuscallback=SocialCalc.EditorSheetStatusCallback;spreadsheet.sheet.statuscallbackparams=spreadsheet.editor;// reset highlights ??\n\t//spreadsheet.editor.FitToEditTable();             \n\tspreadsheet.editor.workingvalues.currentsheet=spreadsheet.sheet.sheetname;spreadsheet.editor.workingvalues.currentsheetid=spreadsheet.sheet.sheetid;if(spreadsheet.editor.state!=\"start\"&&spreadsheet.editor.inputBox)spreadsheet.editor.inputBox.element.focus();if(spreadsheet.editor.state==\"start\"){spreadsheet.editor.workingvalues.startsheet=spreadsheet.editor.workingvalues.currentsheet;}//spreadsheet.editor.ScheduleRender();\n\tif(spreadsheet.editor.state!=\"start\"&&spreadsheet.editor.inputBox){spreadsheet.editor.ScheduleRender();}else{if(spreadsheet.sheet.attribs){spreadsheet.sheet.attribs.needsrecalc=\"yes\";}else{spreadsheet.sheet.attribs={};spreadsheet.sheet.attribs.needsrecalc=\"yes\";}spreadsheet.ExecuteCommand('redisplay','');}};SocialCalc.DeleteWorkBookSheet=function DeleteWorkBookSheet(workbook,oldname,curname){//alert(\"delete \"+oldname+\",\"+curname);\n\tdelete workbook.sheetArr[oldname].context;delete workbook.sheetArr[oldname].sheet;delete workbook.sheetArr[oldname];// take sheet out of the formula cache\n\tdelete SocialCalc.Formula.SheetCache.sheets[curname];};SocialCalc.SaveWorkBookSheet=function CreateSaveWorkBook(workbook,sheetid){var sheetstr={};sheetstr.savestr=workbook.sheetArr[sheetid].sheet.CreateSheetSave();return sheetstr;};SocialCalc.LoadRenameWorkBookSheet=function LoadRenameWorkBookSheet(workbook,sheetid,savestr,newname){workbook.sheetArr[sheetid].sheet.ResetSheet();workbook.sheetArr[sheetid].sheet.ParseSheetSave(savestr);if(workbook.sheetArr[sheetid].sheet.attribs){workbook.sheetArr[sheetid].sheet.attribs.needsrecalc=\"yes\";}delete SocialCalc.Formula.SheetCache.sheets[workbook.sheetArr[sheetid].sheet.sheetname];workbook.sheetArr[sheetid].sheet.sheetname=newname;SocialCalc.Formula.SheetCache.sheets[newname]={sheet:workbook.sheetArr[sheetid].sheet,name:newname};};SocialCalc.RenderWorkBookSheet=function RenderWorkBookSheet(workbook){workbook.spreadsheet.editor.ScheduleRender();};SocialCalc.RenameWorkBookSheetCell=function(formula,oldname,newname){var ttype,ttext,i,newcr;var updatedformula=\"\";var sheetref=false;var scf=SocialCalc.Formula;if(!scf){return\"Need SocialCalc.Formula\";}var tokentype=scf.TokenType;var token_op=tokentype.op;var token_string=tokentype.string;var token_coord=tokentype.coord;var tokenOpExpansion=scf.TokenOpExpansion;var parseinfo=SocialCalc.Formula.ParseFormulaIntoTokens(formula);for(i=0;i<parseinfo.length;i++){ttype=parseinfo[i].type;ttext=parseinfo[i].text;//alert(ttype+\",\"+ttext);\n\t//console.log (scf.NormalizeSheetName(ttext) + \"   \" + oldname);\n\tif(ttype==tokentype.name&&scf.NormalizeSheetName(ttext)==oldname&&i<parseinfo.length){if(parseinfo[i+1].type==token_op&&parseinfo[i+1].text==\"!\"){updatedformula+=newname;//console.log (updatedformula);\n\t}else{updatedformula+=ttext;//console.log (updatedformula);\n\t}}else{updatedformula+=ttext;}}//alert(updatedformula);\n\treturn updatedformula;};SocialCalc.RenameWorkBookSheet=function RenameWorkBookSheet(workbook,oldname,newname,sheetid){// for each sheet, fix up all the formula references\n\t//\n\t//alert (sheetid);\n\tvar oldsheet=SocialCalc.Formula.SheetCache.sheets[oldname].sheet;delete SocialCalc.Formula.SheetCache.sheets[oldname];//alert (newname); // to check the newname\n\tSocialCalc.Formula.SheetCache.sheets[newname]={sheet:oldsheet,name:newname};workbook.sheetArr[sheetid].sheet.sheetname=newname;//\n\t// fix up formulas for sheet rename\n\t// if formulas should not be fixed up upon sheet rename, then comment out the following\n\t// block\n\t//\n\tfor(var sheet in workbook.sheetArr){//alert(\"found sheet-\"+sheet)\n\tfor(var cr in workbook.sheetArr[sheet].sheet.cells){// update cell references to sheet name\n\t//alert(cr);\n\tvar cell=workbook.sheetArr[sheet].sheet.cells[cr];//if (cell) alert(cell.datatype)\n\tif(cell&&cell.datatype==\"f\"){cell.formula=SocialCalc.RenameWorkBookSheetCell(cell.formula,oldname,newname);if(cell.parseinfo){delete cell.parseinfo;}}}}// recalculate\n\tworkbook.spreadsheet.ExecuteCommand('recalc','');};SocialCalc.CopyWorkBookSheet=function CopyWorkBookSheet(workbook,sheetid){//alert(\"in copy \"+sheetid);\n\tworkbook.clipsheet.savestr=workbook.sheetArr[sheetid].sheet.CreateSheetSave();//alert(\"in copy save=\"+workbook.clipsheet.savestr);\n\tworkbook.clipsheet.copiedfrom=sheetid;workbook.clipsheet.editorprop={};workbook.clipsheet.editorprop.ecell=workbook.spreadsheet.editor.ecell;//workbook.clipsheet.editorprop.range = workbook.spreadsheet.editor.range;\n\t//workbook.clipsheet.editorprop.range2 = workbook.spreadsheet.editor.range2;\n\t//workbook.clipsheet.highlights = workbook.spreadsheet.context.highlights;\n\t//alert(\"copied \"+sheetid);\n\t};SocialCalc.PasteWorkBookSheet=function PasteWorkBookSheet(workbook,newsheetid,oldsheetid){//alert(newsheetid+oldsheetid);\n\tworkbook.AddNewWorkBookSheet(newsheetid,oldsheetid,true);// clear the clip ?\n\t};SocialCalc.SheetNameExistsInWorkBook=function SheetNameExistsInWorkBook(workbook,name){for(var sheet in workbook.sheetArr){if(workbook.sheetArr[sheet].sheet.sheetname==name){return sheet;}}return null;};//\n\t// Workbook Control controls workbook actions (add/del/rename etc) and can appear at the\n\t// bottom of the screen (?). Right now its just a proof of concept \n\t// and appears at the top of the screen\n\t//\n\t// Author: Ramu Ramamurthy\n\t//\n\t//\n\tvar SocialCalc;if(!SocialCalc){alert(\"Main SocialCalc code module needed\");SocialCalc={};}SocialCalc.CurrentWorkbookControlObject=null;SocialCalc.TestWorkBookSaveStr=\"\";// Constructor:\n\tSocialCalc.WorkBookControl=function(book,divid,defaultsheetname){this.workbook=book;this.div=divid;this.defaultsheetname=defaultsheetname;this.sheetButtonArr={};this.sheetCnt=0;this.numSheets=0;this.currentSheetButton=null;this.renameDialogId=\"sheetRenameDialog\";this.deleteDialogId=\"sheetDeleteDialog\";this.hideDialogId=\"sheetHideDialog\";this.unhideDialogId=\"sheetUnhideDialog\";this.sheetshtml='<div id=\"fooBar\" style=\"background-color:#80A9F3;display:none\"></div>';//this.buttonshtml = \n\t//'<form>'+\n\t//'<div id=\"workbookControls\" style=\"padding:6px;background-color:#80A9F3;\">'+\n\t//'<input type=\"button\" value=\"add sheet\" onclick=\"SocialCalc.WorkBookControlAddSheet(true)\" class=\"smaller\">'+\n\t//'<input type=\"button\" value=\"delete sheet\" onclick=\"SocialCalc.WorkBookControlDelSheet()\" class=\"smaller\">'+\n\t//'<input type=\"button\" value=\"rename sheet\" onclick=\"SocialCalc.WorkBookControlRenameSheet()\" class=\"smaller\">'+\n\t// '<input type=\"button\" value=\"save workbook\" onclick=\"SocialCalc.WorkBookControlSaveSheet()\" class=\"smaller\">'+\n\t// '<input type=\"button\" value=\"new workbook\" onclick=\"SocialCalc.WorkBookControlNewBook()\" class=\"smaller\">'+\n\t// '<input type=\"button\" value=\"load workbook\" onclick=\"SocialCalc.WorkBookControlLoad()\" class=\"smaller\">'+\n\t//'<input type=\"button\" value=\"copy sheet\" onclick=\"SocialCalc.WorkBookControlCopySheet()\" class=\"smaller\">'+\n\t//'<input type=\"button\" value=\"paste sheet\" onclick=\"SocialCalc.WorkBookControlPasteSheet()\" class=\"smaller\">'+\n\t//'</div>'+\n\t//'</form>';\n\tSocialCalc.CurrentWorkbookControlObject=this;this.sheetbar=new SocialCalc.SheetBar();};// methods\n\tSocialCalc.WorkBookControl.prototype.GetCurrentWorkBookControl=function(){return SocialCalc.GetCurrentWorkBookControl();};SocialCalc.WorkBookControl.prototype.InitializeWorkBookControl=function(){return SocialCalc.InitializeWorkBookControl(this);};SocialCalc.WorkBookControl.prototype.ExecuteWorkBookControlCommand=function(cmd,isremote){return SocialCalc.ExecuteWorkBookControlCommand(this,cmd,isremote);};SocialCalc.ExecuteWorkBookControlCommand=function(control,cmd,isremote){//console.log(\"cmd \", cmd.cmdstr, cmd.cmdtype);\n\t//if (!isremote) {\n\t// return;\n\t//}\n\tif(cmd.cmdtype==\"scmd\"){// dispatch a sheet command\n\tcontrol.workbook.WorkbookScheduleCommand(cmd,isremote);return;}if(cmd.cmdtype!=\"wcmd\"){return;}var parseobj=new SocialCalc.Parse(cmd.cmdstr);var cmd1=parseobj.NextToken();switch(cmd1){case\"addsheet\":SocialCalc.WorkBookControlAddSheetRemote(null);break;case\"addsheetstr\":var sheetstr=cmd.sheetstr;SocialCalc.WorkBookControlAddSheetRemote(sheetstr);break;case\"delsheet\":var sheetid=parseobj.NextToken();SocialCalc.WorkBookControlDelSheetRemote(sheetid);break;case\"rensheet\":var sheetid=parseobj.NextToken();var oldname=parseobj.NextToken();var newname=parseobj.NextToken();SocialCalc.WorkBookControlRenameSheetRemote(sheetid,oldname,newname);break;case\"activatesheet\":var sheetid=parseobj.NextToken();SocialCalc.WorkBookControlActivateSheet(sheetid);break;case\"hidesheet\":var sheetid=parseobj.NextToken();break;case\"unhidesheet\":var sheetid=parseobj.NextToken();break;}};SocialCalc.GetCurrentWorkBookControl=function(){return SocialCalc.CurrentWorkbookControlObject;};SocialCalc.InitializeWorkBookControl=function(control){var element=document.createElement(\"div\");element.innerHTML=control.sheetshtml;var foo=document.getElementById(control.div);foo.appendChild(element);//var element2 = document.createElement(\"div\");\n\t//element2.innerHTML = control.buttonshtml;\n\t//foo.appendChild(element2);\n\tSocialCalc.WorkBookControlAddSheet(false);// this is for the default sheet\n\t};SocialCalc.WorkBookControlDelSheetRemote=function(sheetid){var control=SocialCalc.GetCurrentWorkBookControl();if(sheetid==control.currentSheetButton.id){// the active sheet is being deleted\n\tSocialCalc.WorkBookControlDelSheet();return;}// some non active sheet is being deleted\n\tvar foo=document.getElementById(\"fooBar\");var deletedbutton=document.getElementById(sheetid);var did=deletedbutton.id;var dname=deletedbutton.value;delete control.sheetButtonArr[did];foo.removeChild(deletedbutton);var sheetbar=document.getElementById(\"SocialCalc-sheetbar-buttons\");var sheetbarbutton=document.getElementById(\"sbsb-\"+did);// unregister with mouse ? etc\n\tsheetbar.removeChild(sheetbarbutton);// delete the sheet\n\tcontrol.workbook.DeleteWorkBookSheet(did,dname);control.numSheets=control.numSheets-1;};// assumes that the current active sheet is being deleted\n\tSocialCalc.WorkBookControlDelSheet=function(){var control=SocialCalc.GetCurrentWorkBookControl();if(control.workbook.spreadsheet.editor.state!=\"start\"){// if in edit mode return\n\treturn;}if(control.numSheets==1){//disallow this\n\tvar str='<div style=\"padding:6px 0px 4px 6px;\">'+'<span>'+'<b> A workbook must contain at least one worksheet </b>'+'</span><br/><br/>';str+='<span>To delete the selected sheet, you must first insert a new sheet. </span><br/></div>';str+='<div style=\"width:380px;text-align:right;padding:6px 0px 4px 6px;font-size:small;\">'+'<input type=\"button\" value=\"Ok\" style=\"font-size:smaller;\" onclick=\"SocialCalc.WorkBookControlDeleteSheetHide();\"></div>';var main=document.createElement(\"div\");main.id=control.deleteDialogId;main.style.position=\"absolute\";var vp=SocialCalc.GetViewportInfo();main.style.top=vp.height/3+\"px\";main.style.left=vp.width/3+\"px\";main.style.zIndex=100;main.style.backgroundColor=\"#FFF\";main.style.border=\"1px solid black\";main.style.width=\"400px\";main.innerHTML='<table cellspacing=\"0\" cellpadding=\"0\" style=\"border-bottom:1px solid black;\"><tr>'+'<td style=\"font-size:10px;cursor:default;width:100%;background-color:#999;color:#FFF;\">'+\"&nbsp;\"+'</td>'+'<td style=\"font-size:10px;cursor:default;color:#666;\" onclick=\"SocialCalc.WorkBookControlDeleteSheetHide();\">&nbsp;X&nbsp;</td></tr></table>'+'<div style=\"background-color:#DDD;\">'+str+'</div>';//alert(main.innerHTML);\n\tSocialCalc.DragRegister(main.firstChild.firstChild.firstChild.firstChild,true,true,{MouseDown:SocialCalc.DragFunctionStart,MouseMove:SocialCalc.DragFunctionPosition,MouseUp:SocialCalc.DragFunctionPosition,Disabled:null,positionobj:main});control.workbook.spreadsheet.spreadsheetDiv.appendChild(main);return;}// do a popup to reaffirm the deletion of the sheet\n\t// the popup has two buttons : Confirm and Cancel\n\tvar element=document.getElementById(control.deleteDialogId);if(element)return;var currentsheet=control.currentSheetButton.value;var str='<div style=\"padding:6px 0px 4px 6px;\">'+'<span>'+'<b>The selected sheet will be permanently deleted.</b>'+'</span><br/>';str+='<span><ul>';str+='<li> To delete the selected sheet, click OK.</li>';str+='<li> To cancel the deletion, click cancel.</li>';str+='</ul></span></div>';str+='<div style=\"width:380px;text-align:right;padding:6px 0px 4px 6px;font-size:small;\">'+'<input type=\"button\" value=\"Cancel\" style=\"font-size:smaller;\" onclick=\"SocialCalc.WorkBookControlDeleteSheetHide();\">&nbsp;'+'<input type=\"button\" value=\"OK\" style=\"font-size:smaller;\" onclick=\"SocialCalc.WorkBookControlDeleteSheetSubmit();\"></div>';var main=document.createElement(\"div\");main.id=control.deleteDialogId;main.style.position=\"absolute\";var vp=SocialCalc.GetViewportInfo();main.style.top=vp.height/3+\"px\";main.style.left=vp.width/3+\"px\";main.style.zIndex=100;main.style.backgroundColor=\"#FFF\";main.style.border=\"1px solid black\";main.style.width=\"400px\";main.innerHTML='<table cellspacing=\"0\" cellpadding=\"0\" style=\"border-bottom:1px solid black;\"><tr>'+'<td style=\"font-size:10px;cursor:default;width:100%;background-color:#999;color:#FFF;\">'+\"&nbsp;\"+'</td>'+'<td style=\"font-size:10px;cursor:default;color:#666;\" onclick=\"SocialCalc.WorkBookControlDeleteSheetHide();\">&nbsp;X&nbsp;</td></tr></table>'+'<div style=\"background-color:#DDD;\">'+str+'</div>';//alert(main.innerHTML);\n\tSocialCalc.DragRegister(main.firstChild.firstChild.firstChild.firstChild,true,true,{MouseDown:SocialCalc.DragFunctionStart,MouseMove:SocialCalc.DragFunctionPosition,MouseUp:SocialCalc.DragFunctionPosition,Disabled:null,positionobj:main});control.workbook.spreadsheet.spreadsheetDiv.appendChild(main);};SocialCalc.WorkBookControlDeleteSheetHide=function(){var control=SocialCalc.GetCurrentWorkBookControl();var spreadsheet=control.workbook.spreadsheet;var ele=document.getElementById(control.deleteDialogId);ele.innerHTML=\"\";SocialCalc.DragUnregister(ele);SocialCalc.KeyboardFocus();if(ele.parentNode){ele.parentNode.removeChild(ele);}};SocialCalc.WorkBookControlDeleteSheetSubmit=function(){var control=SocialCalc.GetCurrentWorkBookControl();SocialCalc.WorkBookControlDeleteSheetHide();var foo=document.getElementById(\"fooBar\");var current=document.getElementById(control.currentSheetButton.id);var name=current.id;var curname=control.currentSheetButton.value;delete control.sheetButtonArr[name];foo.removeChild(current);var sheetbar=document.getElementById(\"SocialCalc-sheetbar-buttons\");var sheetbarbutton=document.getElementById(\"sbsb-\"+current.id);// unregister with mouse ? etc\n\tsheetbar.removeChild(sheetbarbutton);control.currentSheetButton=null;// delete the sheets\n\tcontrol.workbook.DeleteWorkBookSheet(name,curname);control.numSheets=control.numSheets-1;var cmdstr=\"delsheet \"+name;SocialCalc.Callbacks.broadcast('execute',{cmdtype:\"wcmd\",id:\"0\",cmdstr:cmdstr});// reset current sheet\n\tfor(var sheet in control.sheetButtonArr){if(sheet!=null){control.currentSheetButton=control.sheetButtonArr[sheet];control.currentSheetButton.setAttribute(\"style\",\"background-color:lightgreen\");SocialCalc.SheetBarButtonActivate(control.currentSheetButton.id,true);break;}}if(control.currentSheetButton!=null){control.workbook.ActivateWorkBookSheet(control.currentSheetButton.id,null);}};// assumes that the current active sheet is being hidden\n\tSocialCalc.WorkBookControlHideSheet=function(){var control=SocialCalc.GetCurrentWorkBookControl();var control=SocialCalc.GetCurrentWorkBookControl();if(control.workbook.spreadsheet.editor.state!=\"start\"){// if in edit mode return\n\treturn;}if(control.numSheets==1){//disallow this\n\tvar str='<div style=\"padding:6px 0px 4px 6px;\">'+'<span>'+'<b> A workbook must contain at least one worksheet </b>'+'</span><br/><br/>';str+='<span>Before hiding the selected sheet, you must first insert a new sheet. </span><br/></div>';str+='<div style=\"width:380px;text-align:right;padding:6px 0px 4px 6px;font-size:small;\">'+'<input type=\"button\" value=\"Ok\" style=\"font-size:smaller;\" onclick=\"SocialCalc.WorkBookControlHideSheetHide();\"></div>';var main=document.createElement(\"div\");main.id=control.hideDialogId;main.style.position=\"absolute\";var vp=SocialCalc.GetViewportInfo();main.style.top=vp.height/3+\"px\";main.style.left=vp.width/3+\"px\";main.style.zIndex=100;main.style.backgroundColor=\"#FFF\";main.style.border=\"1px solid black\";main.style.width=\"400px\";main.innerHTML='<table cellspacing=\"0\" cellpadding=\"0\" style=\"border-bottom:1px solid black;\"><tr>'+'<td style=\"font-size:10px;cursor:default;width:100%;background-color:#999;color:#FFF;\">'+\"&nbsp;\"+'</td>'+'<td style=\"font-size:10px;cursor:default;color:#666;\" onclick=\"SocialCalc.WorkBookControlHideSheetHide();\">&nbsp;X&nbsp;</td></tr></table>'+'<div style=\"background-color:#DDD;\">'+str+'</div>';//alert(main.innerHTML);\n\tSocialCalc.DragRegister(main.firstChild.firstChild.firstChild.firstChild,true,true,{MouseDown:SocialCalc.DragFunctionStart,MouseMove:SocialCalc.DragFunctionPosition,MouseUp:SocialCalc.DragFunctionPosition,Disabled:null,positionobj:main});control.workbook.spreadsheet.spreadsheetDiv.appendChild(main);return;}// do a popup to reaffirm the hiding of the sheet\n\t// the popup has two buttons : Confirm and Cancel\n\tvar element=document.getElementById(control.hideDialogId);if(element)return;var currentsheet=control.currentSheetButton.value;var str='<div style=\"padding:6px 0px 4px 6px;\">'+'<span>'+'<b>The selected sheet will be hidden.</b>'+'</span><br/>';str+='<span><ul>';str+='<li> To hide the selected sheet, click OK.</li>';str+='<li> To cancel the hiding, click cancel.</li>';str+='</ul></span></div>';str+='<div style=\"width:380px;text-align:right;padding:6px 0px 4px 6px;font-size:small;\">'+'<input type=\"button\" value=\"Cancel\" style=\"font-size:smaller;\" onclick=\"SocialCalc.WorkBookControlHideSheetHide();\">&nbsp;'+'<input type=\"button\" value=\"OK\" style=\"font-size:smaller;\" onclick=\"SocialCalc.WorkBookControlHideSheetSubmit();\"></div>';var main=document.createElement(\"div\");main.id=control.hideDialogId;main.style.position=\"absolute\";var vp=SocialCalc.GetViewportInfo();main.style.top=vp.height/3+\"px\";main.style.left=vp.width/3+\"px\";main.style.zIndex=100;main.style.backgroundColor=\"#FFF\";main.style.border=\"1px solid black\";main.style.width=\"400px\";main.innerHTML='<table cellspacing=\"0\" cellpadding=\"0\" style=\"border-bottom:1px solid black;\"><tr>'+'<td style=\"font-size:10px;cursor:default;width:100%;background-color:#999;color:#FFF;\">'+\"&nbsp;\"+'</td>'+'<td style=\"font-size:10px;cursor:default;color:#666;\" onclick=\"SocialCalc.WorkBookControlHideSheetHide();\">&nbsp;X&nbsp;</td></tr></table>'+'<div style=\"background-color:#DDD;\">'+str+'</div>';//alert(main.innerHTML);\n\tSocialCalc.DragRegister(main.firstChild.firstChild.firstChild.firstChild,true,true,{MouseDown:SocialCalc.DragFunctionStart,MouseMove:SocialCalc.DragFunctionPosition,MouseUp:SocialCalc.DragFunctionPosition,Disabled:null,positionobj:main});control.workbook.spreadsheet.spreadsheetDiv.appendChild(main);};SocialCalc.WorkBookControlHideSheetHide=function(){var control=SocialCalc.GetCurrentWorkBookControl();var spreadsheet=control.workbook.spreadsheet;var ele=document.getElementById(control.hideDialogId);ele.innerHTML=\"\";SocialCalc.DragUnregister(ele);SocialCalc.KeyboardFocus();if(ele.parentNode){ele.parentNode.removeChild(ele);}};SocialCalc.WorkBookControlHideSheetSubmit=function(){var control=SocialCalc.GetCurrentWorkBookControl();SocialCalc.WorkBookControlHideSheetHide();var foo=document.getElementById(\"fooBar\");var current=document.getElementById(control.currentSheetButton.id);var name=current.id;var curname=control.currentSheetButton.value;var sheetbar=document.getElementById(\"SocialCalc-sheetbar-buttons\");var sheetbarbutton=document.getElementById(\"sbsb-\"+current.id);// unregister with mouse ? etc\n\tSocialCalc.SheetBarButtonActivate(control.currentSheetButton.id,false);sheetbarbutton.style.display=\"none\";control.currentSheetButton=null;// delete the sheets\n\tcontrol.numSheets=control.numSheets-1;var cmdstr=\"hidesheet \"+name;SocialCalc.Callbacks.broadcast('execute',{cmdtype:\"wcmd\",id:\"0\",cmdstr:cmdstr});// reset current sheet\n\tfor(var sheet in control.sheetButtonArr){if(sheet!=null&&document.getElementById(\"sbsb-\"+sheet).style.display!=\"none\"){control.currentSheetButton=control.sheetButtonArr[sheet];break;}}if(control.currentSheetButton!=null){control.currentSheetButton.setAttribute(\"style\",\"background-color:lightgreen\");SocialCalc.SheetBarButtonActivate(control.currentSheetButton.id,true);control.workbook.ActivateWorkBookSheet(control.currentSheetButton.id,null);}};// displays all hidden sheets, and then unhides whatever is selected\n\tSocialCalc.WorkBookControlUnhideSheet=function(){var control=SocialCalc.GetCurrentWorkBookControl();if(control.workbook.spreadsheet.editor.state!=\"start\"){// if in edit mode return\n\treturn;}var unhiddencount=0;for(var sheet in control.sheetButtonArr){if(document.getElementById(\"sbsb-\"+sheet).style.display==\"none\"){unhiddencount++;}}if(unhiddencount==0){//no hidden sheets, error message here\n\tvar str='<div style=\"padding:6px 0px 4px 6px;\">'+'<span>'+'<b> There are no hidden worksheets. </b>'+'</span><br/><br/>';str+='<span>Before unhiding any sheets, you must first hide a sheet. </span><br/></div>';str+='<div style=\"width:380px;text-align:right;padding:6px 0px 4px 6px;font-size:small;\">'+'<input type=\"button\" value=\"Ok\" style=\"font-size:smaller;\" onclick=\"SocialCalc.WorkBookControlUnhideSheetHide();\"></div>';var main=document.createElement(\"div\");main.id=control.unhideDialogId;main.style.position=\"absolute\";var vp=SocialCalc.GetViewportInfo();main.style.top=vp.height/3+\"px\";main.style.left=vp.width/3+\"px\";main.style.zIndex=100;main.style.backgroundColor=\"#FFF\";main.style.border=\"1px solid black\";main.style.width=\"400px\";main.innerHTML='<table cellspacing=\"0\" cellpadding=\"0\" style=\"border-bottom:1px solid black;\"><tr>'+'<td style=\"font-size:10px;cursor:default;width:100%;background-color:#999;color:#FFF;\">'+\"&nbsp;\"+'</td>'+'<td style=\"font-size:10px;cursor:default;color:#666;\" onclick=\"SocialCalc.WorkBookControlUnhideSheetHide();\">&nbsp;<b>X</b>&nbsp;</td></tr></table>'+'<div style=\"background-color:#DDD;\">'+str+'</div>';//alert(main.innerHTML);\n\tSocialCalc.DragRegister(main.firstChild.firstChild.firstChild.firstChild,true,true,{MouseDown:SocialCalc.DragFunctionStart,MouseMove:SocialCalc.DragFunctionPosition,MouseUp:SocialCalc.DragFunctionPosition,Disabled:null,positionobj:main});control.workbook.spreadsheet.spreadsheetDiv.appendChild(main);return;}var element=document.getElementById(control.unhideDialogId);if(element)return;var currentsheet=control.currentSheetButton.value;var str='<div style=\"padding:6px 0px 4px 6px;\">'+'<span>'+'<b>The following sheets are hidden.</b>'+'</span><br/><form id=\"unhidesheetform\"><ul>'+'<input type=\"hidden\" name=\"unhidesheet\" value=\"\"/>';for(var sheet in control.sheetButtonArr){if(document.getElementById(\"sbsb-\"+sheet).style.display==\"none\"){str+='<input type=\"radio\" value=\"'+sheet+'\" onclick=\"document.getElementById(&quot;unhidesheetform&quot;).unhidesheet.value=&quot;'+sheet+'&quot;;\"/>'+control.sheetButtonArr[sheet].value+'<br/>';}}str+='</ul></form>\\n<span><ul>';str+='<li> To unhide the selected sheet, click OK.</li>';str+='<li> To cancel the unhiding, click cancel.</li>';str+='</ul></span></div>';str+='<div style=\"width:380px;text-align:right;padding:6px 0px 4px 6px;font-size:small;\">'+'<input type=\"button\" value=\"Cancel\" style=\"font-size:smaller;\" onclick=\"SocialCalc.WorkBookControlUnhideSheetHide();\">&nbsp;'+'<input type=\"button\" value=\"OK\" style=\"font-size:smaller;\" onclick=\"SocialCalc.WorkBookControlUnhideSheetSubmit(document.getElementById(&quot;unhidesheetform&quot;).unhidesheet.value);\"></div>';var main=document.createElement(\"div\");main.id=control.unhideDialogId;main.style.position=\"absolute\";var vp=SocialCalc.GetViewportInfo();main.style.top=vp.height/3+\"px\";main.style.left=vp.width/3+\"px\";main.style.zIndex=100;main.style.backgroundColor=\"#FFF\";main.style.border=\"1px solid black\";main.style.width=\"400px\";main.innerHTML='<table cellspacing=\"0\" cellpadding=\"0\" style=\"border-bottom:1px solid black;\"><tr>'+'<td style=\"font-size:10px;cursor:default;width:100%;background-color:#999;color:#FFF;\">'+\"&nbsp;\"+'</td>'+'<td style=\"font-size:10px;cursor:default;color:#666;\" onclick=\"SocialCalc.WorkBookControlUnhideSheetHide();\">&nbsp;X&nbsp;</td></tr></table>'+'<div style=\"background-color:#DDD;\">'+str+'</div>';//alert(main.innerHTML);\n\tSocialCalc.DragRegister(main.firstChild.firstChild.firstChild.firstChild,true,true,{MouseDown:SocialCalc.DragFunctionStart,MouseMove:SocialCalc.DragFunctionPosition,MouseUp:SocialCalc.DragFunctionPosition,Disabled:null,positionobj:main});control.workbook.spreadsheet.spreadsheetDiv.appendChild(main);};SocialCalc.WorkBookControlUnhideSheetHide=function(){var control=SocialCalc.GetCurrentWorkBookControl();var spreadsheet=control.workbook.spreadsheet;var ele=document.getElementById(control.unhideDialogId);ele.innerHTML=\"\";SocialCalc.DragUnregister(ele);SocialCalc.KeyboardFocus();if(ele.parentNode){ele.parentNode.removeChild(ele);}};SocialCalc.WorkBookControlUnhideSheetSubmit=function(name){var control=SocialCalc.GetCurrentWorkBookControl();SocialCalc.WorkBookControlUnhideSheetHide();var current=document.getElementById(control.currentSheetButton.id);var curid=current.id;var curname=control.currentSheetButton.value;control.currentSheetButton.setAttribute(\"style\",\"\");var old=control.currentSheetButton.id;console.log(old);SocialCalc.SheetBarButtonActivate(old,false);var sheetbarbutton=document.getElementById(\"sbsb-\"+name);// unhide the button\n\tsheetbarbutton.style.display=\"inline\";control.currentSheetButton=null;control.numSheets=control.numSheets+1;var cmdstr=\"unhidesheet \"+name;SocialCalc.Callbacks.broadcast('execute',{cmdtype:\"wcmd\",id:\"0\",cmdstr:cmdstr});// reset current sheet\n\tfor(var sheet in control.sheetButtonArr){if(sheet!=null&&document.getElementById(\"sbsb-\"+sheet).style.display!=\"none\"){control.currentSheetButton=control.sheetButtonArr[sheet];break;}}if(control.currentSheetButton!=null){control.currentSheetButton.setAttribute(\"style\",\"background-color:lightgreen\");SocialCalc.SheetBarButtonActivate(control.currentSheetButton.id,true);control.workbook.ActivateWorkBookSheet(control.currentSheetButton.id,null);}};SocialCalc.WorkBookControlAddSheetButton=function(sheetname,sheetid){var control=SocialCalc.GetCurrentWorkBookControl();//Create an input type dynamically.\n\tvar element=document.createElement(\"input\");var name=null;if(sheetid!=null){name=sheetid;}else{name=\"sheet\"+(control.sheetCnt+1).toString();control.sheetCnt=control.sheetCnt+1;}//Assign different attributes to the element.\n\telement.setAttribute(\"type\",\"button\");if(sheetname==null){element.setAttribute(\"value\",name);}else{element.setAttribute(\"value\",sheetname);}element.setAttribute(\"id\",name);element.setAttribute(\"name\",name);var fnname=\"SocialCalc.WorkBookControlActivateSheet(\"+\"'\"+name+\"'\"+\")\";element.setAttribute(\"onclick\",fnname);control.sheetButtonArr[name]=element;var foo=document.getElementById(\"fooBar\");//Append the element in page (in span).\n\tfoo.appendChild(element);control.numSheets=control.numSheets+1;var el=new SocialCalc.SheetBarSheetButton(\"sbsb-\"+name,sheetname?sheetname:name,document.getElementById(\"SocialCalc-sheetbar-buttons\"),{//normalstyle: \"border:1px solid #000;backgroundColor:#FFF;\",\n\t//downstyle: \"border:1px solid #000;backgroundColor:#CCC;\",\n\t//hoverstyle: \"border:1px solid #000;backgroundColor:#FFF;\"\n\t},{MouseDown:function MouseDown(){SocialCalc.SheetBarSheetButtonPress(name);},Repeat:function Repeat(){},Disabled:function Disabled(){}});return element;};SocialCalc.WorkBookControlAddSheet=function(addworksheet,sheetname){var control=SocialCalc.GetCurrentWorkBookControl();if(control.workbook.spreadsheet.editor.state!=\"start\"){// if in edit return\n\treturn;}// first add the button\n\tvar element=SocialCalc.WorkBookControlAddSheetButton(sheetname);// then change the highlight\n\tvar old=\"sheet1\";if(control.currentSheetButton!=null){control.currentSheetButton.setAttribute(\"style\",\"\");old=control.currentSheetButton.id;SocialCalc.SheetBarButtonActivate(old,false);}element.setAttribute(\"style\",\"background-color:lightgreen\");control.currentSheetButton=element;var newsheetid=element.id;SocialCalc.SheetBarButtonActivate(newsheetid,true);// create the sheet\n\tif(addworksheet){control.workbook.AddNewWorkBookSheet(newsheetid,old,false);// broadcast an add command here\n\tvar cmdstr=\"addsheet\";SocialCalc.Callbacks.broadcast('execute',{cmdtype:\"wcmd\",id:\"0\",cmdstr:cmdstr});}};SocialCalc.WorkBookControlAddSheetRemote=function(savestr){var control=SocialCalc.GetCurrentWorkBookControl();// first add the button\n\tvar element=SocialCalc.WorkBookControlAddSheetButton();// add the sheet, dont switch to it\n\tcontrol.workbook.AddNewWorkBookSheetNoSwitch(element.id,element.value,savestr);};SocialCalc.WorkBookControlActivateSheet=function(name){//alert(\"in activate sheet=\"+name)\n\tvar control=SocialCalc.GetCurrentWorkBookControl();var foo=document.getElementById(name);foo.setAttribute(\"style\",\"background-color:lightgreen;\");SocialCalc.SheetBarButtonActivate(name,true);var old=control.currentSheetButton.id;if(control.currentSheetButton.id!=foo.id){control.currentSheetButton.setAttribute(\"style\",\"\");SocialCalc.SheetBarButtonActivate(old,false);}control.currentSheetButton=foo;control.workbook.ActivateWorkBookSheet(name,old);};SocialCalc.WorkBookControlHttpRequest=null;SocialCalc.WorkBookControlAlertContents=function(){var loadedstr=\"\";var http_request=SocialCalc.WorkBookControlHttpRequest;if(http_request.readyState==4){//addmsg(\"received:\" + http_request.responseText.length + \" chars\");\n\ttry{if(http_request.status==200){loadedstr=http_request.responseText||\"\";http_request=null;}else{;}}catch(e){}// do something with loaded str\n\t//alert(\"loaded=\"+loadedstr);\n\tSocialCalc.TestWorkBookSaveStr=loadedstr;SocialCalc.Clipboard.clipboard=loadedstr;}};SocialCalc.WorkBookControlAjaxCall=function(url,contents){var http_request=null;alert(\"in ajax\");if(window.XMLHttpRequest){// Mozilla, Safari,...\n\thttp_request=new XMLHttpRequest();}else if(window.ActiveXObject){// IE\n\ttry{http_request=new ActiveXObject(\"Msxml2.XMLHTTP\");}catch(e){try{http_request=new ActiveXObject(\"Microsoft.XMLHTTP\");}catch(e){}}}if(!http_request){alert('Giving up :( Cannot create an XMLHTTP instance');return false;}// Make the actual request\n\tSocialCalc.WorkBookControlHttpRequest=http_request;http_request.onreadystatechange=SocialCalc.WorkBookControlAlertContents;http_request.open('POST',document.URL,true);// async\n\thttp_request.setRequestHeader('Content-Type','application/x-www-form-urlencoded');http_request.send(contents);return true;};SocialCalc.WorkBookControlSaveSheet=function(){var control=SocialCalc.GetCurrentWorkBookControl();var sheetsave={};sheetsave.numsheets=control.numSheets;sheetsave.currentid=control.currentSheetButton.id;sheetsave.currentname=control.currentSheetButton.value;sheetsave.sheetArr={};for(var sheet in control.sheetButtonArr){var sheetstr=control.workbook.SaveWorkBookSheet(sheet);sheetsave.sheetArr[sheet]={};sheetsave.sheetArr[sheet].sheetstr=sheetstr;sheetsave.sheetArr[sheet].name=control.sheetButtonArr[sheet].value;sheetsave.sheetArr[sheet].hidden=document.getElementById(\"sbsb-\"+sheet).style.display==\"none\"?\"1\":\"0\";}// Save the editable cells if specified\n\tif(SocialCalc.EditableCells&&SocialCalc.EditableCells.allow){sheetsave.EditableCells={};for(var i in SocialCalc.EditableCells){sheetsave.EditableCells[i]=SocialCalc.EditableCells[i];}}var d=new Date();sheetsave[\"timestamp\"]=d.toString();SocialCalc.TestWorkBookSaveStr=JSON.stringify(sheetsave);//alert(SocialCalc.TestWorkBookSaveStr);\n\t// send it to the backend\n\t// SocialCalc.WorkBookControlAjaxCall(\"/\", \"&sheetdata=\"+encodeURIComponent(SocialCalc.TestWorkBookSaveStr));\n\treturn SocialCalc.TestWorkBookSaveStr;};// insert another workbook into an existing workbook \n\t// assumption is at least 1 sheet exists in existing workbook\n\t// sheets with same names will be overwritten !\n\tSocialCalc.WorkBookControlInsertWorkbook=function(savestr){var sheetsave;if(savestr){sheetsave=JSON.parse(savestr);}var control=SocialCalc.GetCurrentWorkBookControl();for(var sheet in sheetsave.sheetArr){var savestr=sheetsave.sheetArr[sheet].sheetstr.savestr;var parts=control.workbook.spreadsheet.DecodeSpreadsheetSave(savestr);if(parts){if(parts.sheet){savestr=savestr.substring(parts.sheet.start,parts.sheet.end);}}// check if sheetname already exists\n\tvar sheetname=sheetsave.sheetArr[sheet].name;var sheetid=control.workbook.SheetNameExistsInWorkBook(sheetname);if(sheetid){console.log(sheetname+\"exists\");control.workbook.LoadRenameWorkBookSheet(sheetid,savestr,sheetname);}else{//just test-brand new insert first\n\tsheetid=\"sheet\"+(control.sheetCnt+1).toString();control.sheetCnt=control.sheetCnt+1;SocialCalc.WorkBookControlAddSheetButton(sheetsave.sheetArr[sheet].name,sheetid);// create the sheet\n\tcontrol.workbook.AddNewWorkBookSheetNoSwitch(sheetid,sheetsave.sheetArr[sheet].name,savestr);}}};SocialCalc.WorkBookControlLoad=function(savestr){var sheetsave;if(savestr==\"\")return;if(savestr){sheetsave=JSON.parse(savestr);}else{sheetsave=JSON.parse(SocialCalc.TestWorkBookSaveStr);}//alert(sheetsave.currentid+\",\"+sheetsave.currentname)\n\t// first create a new workbook\n\tvar control=SocialCalc.GetCurrentWorkBookControl();SocialCalc.WorkBookControlCreateNewBook();// at this point there is one sheet, and 1 button\n\t// create the sequence of buttons, and sheets\n\tvar firstrun=true;var newbuttons=0;var sheetid=null;var currentsheetid=sheetsave.currentid;//alert(\"button=\"+newbuttons)\n\tfor(var sheet in sheetsave.sheetArr){//alert(sheet);\n\tif(newbuttons>sheetsave.numsheets){break;}//alert(\"button=\"+newbuttons)\n\tvar savestr=sheetsave.sheetArr[sheet].sheetstr.savestr;var parts=control.workbook.spreadsheet.DecodeSpreadsheetSave(savestr);if(parts){if(parts.sheet){savestr=savestr.substring(parts.sheet.start,parts.sheet.end);}}if(firstrun){firstrun=false;// set the first button's name correctly\n\tsheetid=control.currentSheetButton.id;control.currentSheetButton.value=sheetsave.sheetArr[sheet].name;SocialCalc.SheetBarButtonSetName(sheetid,sheetsave.sheetArr[sheet].name);// set the sheet data for the first sheet which already exists\n\tcontrol.workbook.LoadRenameWorkBookSheet(sheetid,savestr,control.currentSheetButton.value);// need to also set the formula cache\n\tcurrentsheetid=sheetid;}else{sheetid=\"sheet\"+(control.sheetCnt+1).toString();control.sheetCnt=control.sheetCnt+1;SocialCalc.WorkBookControlAddSheetButton(sheetsave.sheetArr[sheet].name,sheetid);// create the sheet\n\tcontrol.workbook.AddNewWorkBookSheetNoSwitch(sheetid,sheetsave.sheetArr[sheet].name,savestr);}if(sheetsave.sheetArr[sheet].hidden==\"1\"){// unregister with mouse ? etc\n\tvar sheetbarbutton=document.getElementById(\"sbsb-\"+sheetid);sheetbarbutton.style.display=\"none\";SocialCalc.SheetBarButtonActivate(sheet,false);newbuttons=newbuttons-1;}if(sheet==sheetsave.currentid){currentsheetid=sheetid;}newbuttons=newbuttons+1;}// Save the user script data\n\tif(sheetsave.EditableCells){SocialCalc.EditableCells={};for(var i in sheetsave.EditableCells){SocialCalc.EditableCells[i]=sheetsave.EditableCells[i];}}var timeoutFn=function timeoutFn(){SocialCalc.WorkBookControlActivateSheet(currentsheetid);};window.setTimeout(timeoutFn,200);};SocialCalc.WorkBookControlRenameSheet=function(){var control=SocialCalc.GetCurrentWorkBookControl();if(control.workbook.spreadsheet.editor.state!=\"start\"){// if in edit return\n\treturn;}// do a popup to get the new name of the sheet\n\t// the popup has an input element with submit, and cancel buttons\n\tvar element=document.getElementById(control.renameDialogId);if(element)return;var currentsheet=control.currentSheetButton.value;var str='<div style=\"padding:6px 0px 4px 6px;\">'+'<span style=\"font-size:smaller;\">'+'Rename-'+currentsheet+'</span><br>'+'<span style=\"font-size:smaller;\">'+'Please ensure that you DO NOT have ANY spaces in the sheet name.'+'</span>'+'<input type=\"text\" id=\"newSheetName\" style=\"width:380px;\" value=\"'+currentsheet+'\"><br>'+'</div>';str+='<div style=\"width:380px;text-align:right;padding:6px 0px 4px 6px;font-size:small;\">'+'<input type=\"button\" value=\"Submit\" style=\"font-size:smaller;\" onclick=\"SocialCalc.WorkBookControlRenameSheetSubmit();\">&nbsp;'+'<input type=\"button\" value=\"Cancel\" style=\"font-size:smaller;\" onclick=\"SocialCalc.WorkBookControlRenameSheetHide();\"></div>';var main=document.createElement(\"div\");main.id=control.renameDialogId;main.style.position=\"absolute\";var vp=SocialCalc.GetViewportInfo();main.style.top=vp.height/3+\"px\";main.style.left=vp.width/3+\"px\";main.style.zIndex=100;main.style.backgroundColor=\"#FFF\";main.style.border=\"1px solid black\";main.style.width=\"400px\";main.innerHTML='<table cellspacing=\"0\" cellpadding=\"0\" style=\"border-bottom:1px solid black;\"><tr>'+'<td style=\"font-size:10px;cursor:default;width:100%;background-color:#999;color:#FFF;\">'+\"&nbsp;\"+'</td>'+'<td style=\"font-size:10px;cursor:default;color:#666;\" onclick=\"SocialCalc.WorkBookControlRenameSheetHide();\">&nbsp;X&nbsp;</td></tr></table>'+'<div style=\"background-color:#DDD;\">'+str+'</div>';SocialCalc.DragRegister(main.firstChild.firstChild.firstChild.firstChild,true,true,{MouseDown:SocialCalc.DragFunctionStart,MouseMove:SocialCalc.DragFunctionPosition,MouseUp:SocialCalc.DragFunctionPosition,Disabled:null,positionobj:main});control.workbook.spreadsheet.spreadsheetDiv.appendChild(main);var ele=document.getElementById(\"newSheetName\");ele.focus();SocialCalc.CmdGotFocus(ele);};SocialCalc.WorkBookControlRenameSheetHide=function(){var control=SocialCalc.GetCurrentWorkBookControl();var spreadsheet=control.workbook.spreadsheet;var ele=document.getElementById(control.renameDialogId);ele.innerHTML=\"\";SocialCalc.DragUnregister(ele);SocialCalc.KeyboardFocus();if(ele.parentNode){ele.parentNode.removeChild(ele);}};SocialCalc.WorkBookControlRenameSheetSubmit=function(){// this handles all the rename action\n\tvar ele=document.getElementById(\"newSheetName\");//console.log(ele.value);\n\tvar control=SocialCalc.GetCurrentWorkBookControl();if(ele.value.length==0){ele.focus();return;}var oldname=control.currentSheetButton.value;var newname=ele.value;if(newname.indexOf(\" \")!=-1){alert(\"A space was found in the new name. Please ensure that the new name has no sapces\");return;}SocialCalc.WorkBookControlRenameSheetHide();// verify newname does not clash with any existing sheet name\n\t// if so reject\n\tvar smallname=newname.toLowerCase();//converting to lower case to normalise\n\t//console.log(smallname + \" old \" + ele.value);\n\tfor(var sheet in workbook.sheetArr){console.log(workbook.sheetArr[sheet].sheet.sheetname);//checking in sheetarr for repeated names\n\tif(workbook.sheetArr[sheet].sheet.sheetname==smallname){alert(newname+\" already exists\");return;}}// variation of Case in letters of a sheet name will give an error if smallname is used.\n\tcontrol.currentSheetButton.value=smallname;SocialCalc.SheetBarButtonSetName(control.currentSheetButton.id,newname);// perform a rename for formula references to this sheet in all the \n\t// sheets in the workbook\n\tcontrol.workbook.RenameWorkBookSheet(oldname,smallname,control.currentSheetButton.id);var cmdstr=\"rensheet \"+control.currentSheetButton.id+\" \"+oldname+\" \"+newname;//console.log(cmdstr);\n\tSocialCalc.Callbacks.broadcast('execute',{cmdtype:\"wcmd\",id:\"0\",cmdstr:cmdstr});};SocialCalc.WorkBookControlRenameSheetRemote=function(sheetid,oldname,newname){//console.log(\"rename sheet \",sheetid, oldname, newname)\n\tvar control=SocialCalc.GetCurrentWorkBookControl();var foo=document.getElementById(\"fooBar\");var renbutton=document.getElementById(sheetid);renbutton.value=newname;SocialCalc.SheetBarButtonSetName(sheetid,newname);control.workbook.RenameWorkBookSheet(oldname,newname,sheetid);};SocialCalc.WorkBookControlCreateNewBook=function(){var control=SocialCalc.GetCurrentWorkBookControl();// delete all the sheets except 1\n\tfor(var sheet in control.sheetButtonArr){if(sheet!=control.currentSheetButton.id){control.workbook.DeleteWorkBookSheet(control.sheetButtonArr[sheet].id,control.sheetButtonArr[sheet].value);}}// Reset that 1 sheet\n\tcontrol.workbook.LoadRenameWorkBookSheet(control.currentSheetButton.id,\"\",control.workbook.defaultsheetname);// delete all the buttons except 1\n\tfor(var sheet in control.sheetButtonArr){if(sheet!=control.currentSheetButton.id){var foo=document.getElementById(\"fooBar\");var current=document.getElementById(control.sheetButtonArr[sheet].id);var name=current.id;delete control.sheetButtonArr[name];foo.removeChild(current);var sheetbar=document.getElementById(\"SocialCalc-sheetbar-buttons\");var sheetbarbutton=document.getElementById(\"sbsb-\"+name);// unregister with mouse ? etc\n\tsheetbar.removeChild(sheetbarbutton);control.numSheets=control.numSheets-1;}}// rename that button\n\tcontrol.currentSheetButton.value=control.workbook.defaultsheetname;//alert(\"done new workbook\")\n\t};SocialCalc.WorkBookControlNewBook=function(){var control=SocialCalc.GetCurrentWorkBookControl();SocialCalc.WorkBookControlCreateNewBook();control.workbook.RenderWorkBookSheet();};SocialCalc.WorkBookControlMove=function(direction){var control=SocialCalc.GetCurrentWorkBookControl();if(control.workbook.spreadsheet.editor.state!=\"start\"){return;}var sheetArr=control.sheetButtonArr;var newSheetArr={};var sheetid=control.currentSheetButton.id;var curr_button=document.getElementById(sheetid);var curr_sb_button=document.getElementById(\"sbsb-\"+sheetid);var sib_button=null;var sib_sb_button=null;if(direction==\"left\"){sib_button=curr_button.previousSibling;sib_sb_button=curr_sb_button.previousSibling;if(!sib_sb_button){alert(\"Cannot move leftmost Sheet further to the left\");return;}}else{sib_button=curr_button.nextSibling;sib_sb_button=curr_sb_button.nextSibling;if(!sib_sb_button){alert(\"Cannot move rightmost Sheet further to the right\");return;}}var currid=sheetid;var sibid=sib_button.id;var parent=curr_button.parentNode;var sb_parent=curr_sb_button.parentNode;var cloned={};var clonedsb={};for(button in sheetArr){clonedsb[button]=document.getElementById(\"sbsb-\"+button);cloned[button]=document.getElementById(button);sb_parent.removeChild(document.getElementById(\"sbsb-\"+button));parent.removeChild(document.getElementById(button));}for(button in sheetArr){if(button!=currid&&button!=sibid){newSheetArr[button]=sheetArr[button];sb_parent.appendChild(clonedsb[button]);parent.appendChild(cloned[button]);}else if(button==currid){if(direction==\"left\"){newSheetArr[currid]=sheetArr[currid];newSheetArr[sibid]=sheetArr[sibid];sb_parent.appendChild(clonedsb[currid]);parent.appendChild(cloned[currid]);sb_parent.appendChild(clonedsb[sibid]);parent.appendChild(cloned[sibid]);}else{newSheetArr[sibid]=sheetArr[sibid];newSheetArr[currid]=sheetArr[currid];sb_parent.appendChild(clonedsb[sibid]);parent.appendChild(cloned[sibid]);sb_parent.appendChild(clonedsb[currid]);parent.appendChild(cloned[currid]);}}}control.sheetButtonArr=newSheetArr;SocialCalc.SheetBarButtonActivate(currid,true);};SocialCalc.WorkBookControlMoveLeft=function(){SocialCalc.WorkBookControlMove(\"left\");};SocialCalc.WorkBookControlMoveRight=function(){SocialCalc.WorkBookControlMove(\"right\");};SocialCalc.WorkBookControlCopySheet=function(){//alert(\"in copy\");\n\tvar control=SocialCalc.GetCurrentWorkBookControl();if(control.workbook.spreadsheet.editor.state!=\"start\"){// if in edit return\n\treturn;}control.workbook.CopyWorkBookSheet(control.currentSheetButton.id);alert(\"copied sheet:\"+control.currentSheetButton.value);};SocialCalc.WorkBookControlPasteSheet=function(){//alert(\"in paste\");\n\tvar control=SocialCalc.GetCurrentWorkBookControl();if(control.workbook.spreadsheet.editor.state!=\"start\"){// if in edit return\n\treturn;}var oldid=control.currentSheetButton.id;SocialCalc.WorkBookControlAddSheet(false);var newid=control.currentSheetButton.id;//alert(newid+oldid);\n\tcontrol.workbook.PasteWorkBookSheet(newid,oldid);var cmdstr=\"addsheetstr\";SocialCalc.Callbacks.broadcast('execute',{cmdtype:\"wcmd\",id:\"0\",cmdstr:cmdstr,sheetstr:control.workbook.clipsheet.savestr});};SocialCalc.SheetBar=function(){this.baseDiv=document.getElementById(\"SocialCalc-sheetbar\");this.prebuttonsDiv=document.createElement(\"div\");this.prebuttonsDiv.style.cssText=\"display:inline;\";this.prebuttonsDiv.innerHTML=\"&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp\";this.prebuttonsDiv.id=\"SocialCalc-sheetbar-prebuttons\";this.buttonsDiv=document.createElement(\"div\");this.buttonsDiv.id=\"SocialCalc-sheetbar-buttons\";this.buttonsDiv.style.cssText=\"display:inline;\";this.buttonActionsDiv=document.createElement(\"div\");this.buttonActionsDiv.id=\"SocialCalc-sheetbar-buttonactions\";this.buttonActionsDiv.style.display=\"inline\";var addbutton=new SocialCalc.SheetBarSheetButton(\"sbsba-add\",\"sbsba-add\",this.buttonActionsDiv,{},{MouseDown:function MouseDown(){var abc=SocialCalc.WorkBookControlAddSheet(true);}},\"add-2.png\");this.baseDiv.appendChild(this.prebuttonsDiv);this.baseDiv.appendChild(this.buttonsDiv);this.baseDiv.appendChild(this.buttonActionsDiv);};// define a new class for sheetbarsheetbutton\n\tSocialCalc.SheetBarSheetButton=function(id,name,parentdiv,params,functions,img){this.ele=document.createElement(\"div\");this.ele.id=id;this.ele.name=name;if(!img){this.ele.innerHTML=name;this.ele.style.cssText=\"font-size:small;display:inline;padding:5px 5px 2px 5px;border:1px solid #000;\";imgele=document.createElement(\"img\");imgele.id=id+\"-img\";imgele.src=SocialCalc.Constants.defaultImagePrefix+\"menu-dropdown.png\";imgele.style.cssText=\"padding:0px 2px;width:16px;height:16px;vertical-align:middle;\";this.ele.appendChild(imgele);SocialCalc.ButtonRegister(this.ele,params,functions);SocialCalc.ButtonRegister(imgele,params,functions);}else{var imgele=document.createElement(\"img\");imgele.src=SocialCalc.Constants.defaultImagePrefix+img;imgele.style.cssText=\"width:16px;height:16px;vertical-align:middle;\";this.ele.appendChild(imgele);this.ele.style.cssText=\"display:inline;padding:5px 5px 2px 5px;\";SocialCalc.ButtonRegister(imgele,params,functions);}parentdiv.appendChild(this.ele);};SocialCalc.SheetBarButtonActivate=function(id,active){var sbbutton=document.getElementById(\"sbsb-\"+id);sbbutton.isactive=active;if(active){sbbutton.style.backgroundColor=\"#FFF\";var imgele=document.getElementById(\"sbsb-\"+id+\"-img\");if(!imgele){imgele=document.createElement(\"img\");imgele.id=\"sbsb-\"+id+\"-img\";imgele.src=SocialCalc.Constants.defaultImagePrefix+\"menu-dropdown.png\";imgele.style.cssText=\"padding:0px 2px;width:16px;height:16px;vertical-align:middle;\";}sbbutton.appendChild(imgele);SocialCalc.ButtonRegister(imgele,{},{MouseDown:function MouseDown(){SocialCalc.SheetBarSheetButtonPress(id);},Repeat:function Repeat(){},Disabled:function Disabled(){}});}else{sbbutton.style.backgroundColor=\"#CCC\";var imgele=document.getElementById(\"sbsb-\"+id+\"-img\");if(imgele){sbbutton.removeChild(imgele);}}var menu=document.getElementById(\"sbsb-menu\");if(menu&&menu.style.display!=\"none\"){menu.style.display=\"none\";}};SocialCalc.SheetBarButtonSetName=function(id,name){var sbbutton=document.getElementById(\"sbsb-\"+id);sbbutton.name=name;sbbutton.innerHTML=name;if(sbbutton.isactive){SocialCalc.SheetBarButtonActivate(id,true);}};SocialCalc.SheetBarSheetButtonPress=function(id){//console.log(\"button press\")\n\tvar sbbutton=document.getElementById(\"sbsb-\"+id);if(sbbutton&&sbbutton.isactive){var menu=document.getElementById(\"sbsb-menu\");if(!menu){var sbsbm=new SocialCalc.SheetBarSheetButtonMenu(\"sbsb-menu\",id);}else{menu.clickedsheetid=id;if(menu.style.display==\"none\"){menu.style.display=\"inline\";SocialCalc.SheetBarSheetButtonMenuPosition(menu,id);}else{menu.style.display=\"none\";}}}else if(sbbutton){SocialCalc.WorkBookControlActivateSheet(id);}};// define a new class for sheetbarsheet button menu item\n\tSocialCalc.SheetBarSheetButtonMenuItem=function(id,t){this.ele=document.createElement(\"div\");this.ele.id=id;this.ele.innerHTML=t;this.ele.className=\"\";this.ele.style.cssText=\"padding:3px 4px;width:100px;height:20px;background-color:#FFF;\";var params={normalstyle:\"backgroundColor:#FFF;\",downstyle:\"backgroundColor:#CCC;\",hoverstyle:\"backgroundColor:#CCC;\"};var functions={MouseDown:function MouseDown(){SocialCalc.SheetBarMenuItemPress(id);},Repeat:function Repeat(){},Disabled:function Disabled(){}};SocialCalc.ButtonRegister(this.ele,params,functions);SocialCalc.TouchRegister(this.ele,{SingleTap:functions.MouseDown});return this.ele;};SocialCalc.SheetBarMenuItemPress=function(id){var menu=document.getElementById(\"sbsb-menu\");if(!menu)return;var clickedsheetid=menu.clickedsheetid;switch(id){case\"sbsb_deletesheet\"://console.log(\"delete \"+clickedsheetid);\n\tSocialCalc.WorkBookControlDelSheet();break;case\"sbsb_hidesheet\"://console.log(\"hide\" +clickedsheetid);\n\tSocialCalc.WorkBookControlHideSheet();break;case\"sbsb_unhidesheet\"://console.log(\"hide\" +clickedsheetid);\n\tSocialCalc.WorkBookControlUnhideSheet();break;case\"sbsb_copysheet\"://console.log(\"copy \"+clickedsheetid);\n\tSocialCalc.WorkBookControlCopySheet();break;case\"sbsb_moveleft\"://console.log(\"rename \"+clickedsheetid);  \n\tSocialCalc.WorkBookControlMoveLeft();break;case\"sbsb_moveright\"://console.log(\"rename \"+clickedsheetid);  \n\tSocialCalc.WorkBookControlMoveRight();break;case\"sbsb_pastesheet\"://console.log(\"paste \"+clickedsheetid);\n\tSocialCalc.WorkBookControlPasteSheet();break;case\"sbsb_renamesheet\"://console.log(\"rename \"+clickedsheetid);  \n\tSocialCalc.WorkBookControlRenameSheet();break;case\"sbsb_closemenu\"://console.log(\"rename \"+clickedsheetid);  \n\tmenu.style.display=\"none\";break;default:break;}menu.style.display=\"none\";};// define a new class for sheetbarsheet button menu \n\tSocialCalc.SheetBarSheetButtonMenu=function(id,clickedsheetid){this.ele=document.createElement(\"div\");this.ele.id=id;this.ele.className=\"\";this.ele.clickedsheetid=clickedsheetid;this.ele.style.cssText=\"border:1px solid #000;position:absolute;top:200px;left:0px;width=100px;z-index:120\";var ele1=new SocialCalc.SheetBarSheetButtonMenuItem(\"sbsb_deletesheet\",\" Delete Sheet\");this.ele.appendChild(ele1);ele1=new SocialCalc.SheetBarSheetButtonMenuItem(\"sbsb_hidesheet\",\" Hide Sheet \");this.ele.appendChild(ele1);ele1=new SocialCalc.SheetBarSheetButtonMenuItem(\"sbsb_unhidesheet\",\" Unhide Sheet \");this.ele.appendChild(ele1);ele1=new SocialCalc.SheetBarSheetButtonMenuItem(\"sbsb_renamesheet\",\" Rename Sheet \");this.ele.appendChild(ele1);ele1=new SocialCalc.SheetBarSheetButtonMenuItem(\"sbsb_moveleft\",\" Move Left \");this.ele.appendChild(ele1);ele1=new SocialCalc.SheetBarSheetButtonMenuItem(\"sbsb_moveright\",\" Move Right \");this.ele.appendChild(ele1);ele1=new SocialCalc.SheetBarSheetButtonMenuItem(\"sbsb_copysheet\",\" Copy Sheet \");this.ele.appendChild(ele1);ele1=new SocialCalc.SheetBarSheetButtonMenuItem(\"sbsb_pastesheet\",\" Paste Sheet \");this.ele.appendChild(ele1);ele1=new SocialCalc.SheetBarSheetButtonMenuItem(\"sbsb_closemenu\",\" Cancel\");this.ele.appendChild(ele1);SocialCalc.SheetBarSheetButtonMenuPosition(this.ele,clickedsheetid);//var clickedsheet = document.getElementById(clickedsheetid);\n\t//var position = SocialCalc.GetElementPosition(clickedsheet);\n\t//console.log(clickedsheet.offsetHeight,clickedsheet.offsetWidth,clickedsheet.offsetLeft, clickedsheet.offsetTop);\n\tvar control=SocialCalc.GetCurrentWorkBookControl();control.workbook.spreadsheet.editor.toplevel.appendChild(this.ele);};// position the sheet menu\n\tSocialCalc.SheetBarSheetButtonMenuPosition=function(menu,clickedsheetid){var hlessbutton=document.getElementById(\"te_lessbuttonh\");//console.log(hlessbutton.style.top, hlessbutton.style.left);\n\tvar sbbutton=document.getElementById(\"sbsb-\"+clickedsheetid);//console.log(sbbutton.offsetLeft,clickedsheetid);\n\tvar top=hlessbutton.style.top.slice(0,-2)-220;var left=sbbutton.offsetLeft+7;menu.style.top=top+\"px\";menu.style.left=left+\"px\";//console.log(menu.style.top, menu.style.left);    \n\t};SocialCalc.ScriptInfo={scripts:{},handle:null};SocialCalc.ScriptCheck=function(sheetid,coord,text){var commentstart=text.indexOf(\"<!--script\");var commentend=text.indexOf(\"script-->\");if(commentstart!=-1&&commentend!=-1){script=text.slice(commentstart+10,commentend);//alert(script);\n\tSocialCalc.ScriptInfo.scripts[coord]=script;if(SocialCalc.ScriptInfo.handle==null){SocialCalc.ScriptInfo.handle=window.setTimeout(SocialCalc.EvalUserScripts,500);}//alert(coord+\"-\"+sheetid);\n\t}};SocialCalc.EvalUserScript=function(data){var head=document.getElementsByTagName(\"head\")[0]||document.documentElement;if(data==\"\")return;var script=document.createElement(\"script\");script.type=\"text/javascript\";try{// doesn't work on ie...\n\tscript.appendChild(document.createTextNode(data));}catch(e){// IE has funky script nodes\n\tscript.text=data;}head.insertBefore(script,head.firstChild);head.removeChild(script);};SocialCalc.EvalUserScripts=function(){for(var cr in SocialCalc.ScriptInfo.scripts){SocialCalc.EvalUserScript(SocialCalc.ScriptInfo.scripts[cr]);//console.log(cr,SocialCalc.ScriptInfo.scripts[cr])\n\t}SocialCalc.ScriptInfo.handle=null;SocialCalc.ScriptInfo.scripts={};};SocialCalc.CallOutOnRenderCell=function(sheetobj,value,cr){var cell=sheetobj.cells[cr];if(!cell)return;var valuetype=cell.valuetype||\"\";// get type of value to determine formatting\n\tvar valuesubtype=valuetype.substring(1);var sheetattribs=sheetobj.attribs;valuetype=valuetype.charAt(0);if(valuetype==\"t\"){valueformat=sheetobj.valueformats[cell.textvalueformat-0]||sheetobj.valueformats[sheetattribs.defaulttextvalueformat-0]||\"\";if(valueformat==\"text-html\"){SocialCalc.ScriptCheck(sheetobj.sheetid,cr,value);}}};SocialCalc.GetCellDataValue=function(coord){var sheetname=null;var sheetid=\"\";var bindex=coord.indexOf(\"!\");if(bindex!=-1){sheetname=coord.slice(0,bindex);coord=coord.slice(bindex+1);//console.log(sheetname,coord)\n\t}var control=SocialCalc.GetCurrentWorkBookControl();if(sheetname==null){sheetid=control.currentSheetButton.id;}else{sheetid=control.workbook.SheetNameExistsInWorkBook(sheetname);}if(sheetid==null||sheetid==\"\"){return\"0\";}var sheetobj=control.workbook.sheetArr[sheetid].sheet;var cell=sheetobj.cells[coord];if(cell){return cell.datavalue;}else{return 0;}};SocialCalc.GetCellDataArray=function(coordstr,sheetname){var vals=[];var coords=coordstr.split(\",\");if(sheetname==null){sheetname=\"\";}else{sheetname=sheetname+\"!\";}for(var c in coords){vals.push(SocialCalc.GetCellDataValue(sheetname+coords[c]));}return vals;};SocialCalc.UserScriptData={};SocialCalc.WorkBookRecalculateInfo={sheets:[],calcorder:[],current:0,pass:0};SocialCalc.WorkBookRecalculateAll=function(){// do it from the last sheet to the first sheet\n\t// using the recalc-done signal to trigger the next sheet\n\t// if already in the middle of a recalculate-all, ignore this.\n\tif(SocialCalc.WorkBookRecalculateInfo.current!=0||SocialCalc.WorkBookRecalculateInfo.calcorder.length!=0||SocialCalc.WorkBookRecalculateInfo.sheets.length!=0){return;}var control=SocialCalc.GetCurrentWorkBookControl();if(control.workbook.spreadsheet.editor.state!=\"start\"){// if in edit return\n\treturn;}SocialCalc.WorkBookRecalculateInfo.current=0;for(var sheet in control.workbook.sheetArr){SocialCalc.WorkBookRecalculateInfo.sheets.push(sheet);}var i=0;for(var c=SocialCalc.WorkBookRecalculateInfo.sheets.length;c>0;c--){SocialCalc.WorkBookRecalculateInfo.calcorder[i]=SocialCalc.WorkBookRecalculateInfo.sheets[c-1];i++;}window.setTimeout(SocialCalc.WorkBookRecalculateStep,500);};SocialCalc.WorkBookRecalculateStep=function(){if(SocialCalc.WorkBookRecalculateInfo.current==SocialCalc.WorkBookRecalculateInfo.calcorder.length){SocialCalc.WorkBookRecalculateInfo.current=0;SocialCalc.WorkBookRecalculateInfo.calcorder=[];SocialCalc.WorkBookRecalculateInfo.sheets=[];if(SocialCalc.WorkBookRecalculateInfo.pass==1){SocialCalc.WorkBookRecalculateInfo.pass=0;SocialCalc.SpinnerWaitHide();//alert(\"load done\");\n\treturn;}else{SocialCalc.WorkBookRecalculateInfo.pass++;SocialCalc.WorkBookRecalculateAll();return;}}var control=SocialCalc.GetCurrentWorkBookControl();//alert(\"recalculate \"+\n\t//   SocialCalc.WorkBookRecalculateInfo.calcorder[\n\t//     SocialCalc.WorkBookRecalculateInfo.current]\n\t//   );\n\tvar sheetid=SocialCalc.WorkBookRecalculateInfo.calcorder[SocialCalc.WorkBookRecalculateInfo.current];SocialCalc.WorkBookControlActivateSheet(sheetid);SocialCalc.WorkBookRecalculateInfo.current++;window.setTimeout(SocialCalc.WorkBookRecalculateStep,1000);};SocialCalc.SpinnerWaitCreate=function(){// if the div exists already just use it\n\tvar ele=document.getElementById(\"waitloadingspinner\");if(ele){return;}var main=document.createElement(\"div\");main.id=\"waitloadingspinner\";main.style.position=\"absolute\";var vp=SocialCalc.GetViewportInfo();main.style.top=vp.height/2+\"px\";main.style.left=vp.width/2+\"px\";main.style.zIndex=110;main.style.width='50px';main.style.height='50px';main.innerHTML='<img src=\"static/www/assets/images/spinner.gif\" alt=\"Loading...\" />';var control=SocialCalc.GetCurrentWorkBookControl();control.workbook.spreadsheet.spreadsheetDiv.appendChild(main);};SocialCalc.SpinnerWaitHide=function(){// if the div exists already just use it\n\tvar ele=document.getElementById(\"waitloadingspinner\");if(ele){ele.innerHTML=\"\";if(ele.parentNode){ele.parentNode.removeChild(ele);}}};SocialCalc.EditableCells={};SocialCalc.EditableCells.allow=false;SocialCalc.EditableCells.cells={};SocialCalc.Callbacks.IsCoordEditable=function(sheetcoord){if(!SocialCalc.EditableCells.allow){// by default all cells are editable\n\treturn true;}if(SocialCalc.EditableCells.cells[sheetcoord]){// by default all cells are editable\n\treturn true;}return false;};SocialCalc.Callbacks.IsCellEditable=function(editor){var cellname=editor.workingvalues.currentsheet+\"!\"+editor.ecell.coord;if(!SocialCalc.EditableCells.allow){// by default all cells are editable\n\treturn true;}if(SocialCalc.EditableCells.cells[cellname]){// by default all cells are editable\n\treturn true;}return false;};SocialCalc.IsScrollPossible=function(lastrow,lastcol,curr_vpos,curr_hpos,vamount,hamount){//return false;\n\t//console.log(lastrow+\",\"+lastcol);\n\t//console.log(curr_vpos+\",\"+curr_hpos);    \n\t//console.log(vamount+\",\"+hamount);    \n\tif(curr_vpos+10+vamount>lastrow){return false;}if(curr_hpos+hamount>lastcol){return false;}return true;};// this is for checkmark toggling\n\tSocialCalc.Callbacks.ToggleCell=function(cellname){var control=SocialCalc.GetCurrentWorkBookControl();var sheetid=control.currentSheetButton.id;var sheetobj=control.workbook.sheetArr[sheetid].sheet;var cell=sheetobj.cells[cellname];var sheetname=sheetobj.sheetname;// check if cell is in constraints\n\t//console.log(sheetname);\n\t//console.log(cellname);\n\tvar constraint=SocialCalc.EditableCells.constraints[sheetname+\"!\"+cellname];if(!constraint||constraint[0]!=\"tc\"){return;}var cellinner=document.getElementById(\"cell_\"+cellname);if(cellinner.innerHTML.indexOf(\"&nbsp;\")!=-1){// set the value to the img value\n\tcellinner.innerHTML='<div><img src=\"http://imageshack.com/a/img924/3599/c5fBZx.png\" height=\"15\" width=\"15\"></img></div>';if(cell){//cell.displaystring = '<div><img src=\"http://img689.imageshack.us/img689/9234/checkmark.png\"></img></div>'    ;\n\t//cell.datavalue = '<div><img src=\"http://img689.imageshack.us/img689/9234/checkmark.png\"></img></div>'   ;\n\t//console.log(\"found cell\")\n\tcell.displaystring='<div><img src=\"http://imageshack.com/a/img924/3599/c5fBZx.png\" height=\"15\" width=\"15\"></img></div>';cell.datavalue='<div><img src=\"http://imageshack.com/a/img924/3599/c5fBZx.png\" height=\"15\" width=\"15\"></img></div>';//http://img689.imageshack.us/img689/9234/checkmark.png\n\t}}else{// set the value to a space\n\tcellinner.innerHTML=\"<div>&nbsp;</div>\";if(cell){cell.datavalue=\"<div>&nbsp;</div>\";cell.displaystring=\"<div>&nbsp;</div>\";}}};SocialCalc.WorkbookControlCreateSheetHTML=function(sheetlist){var context,div,ele;var result=\"\";var control=SocialCalc.GetCurrentWorkBookControl();div=document.createElement(\"div\");if(!sheetlist){context=new SocialCalc.RenderContext(spreadsheet.sheet);ele=context.RenderSheet(null,{type:\"html\"});div.appendChild(ele);context=undefined;}else{for(var sheetid in sheetlist){context=new SocialCalc.RenderContext(control.workbook.sheetArr[sheetid].sheet);ele=context.RenderSheet(null,{type:\"html\"});context=undefined;div.appendChild(ele);if(sheetid.substring(5)==control.sheetCnt){ele.style.pageBreakAfter=\"auto\";}else{ele.style.pageBreakAfter=\"always\";}}}result=div.innerHTML;ele=undefined;div=undefined;//console.log(result);\n\treturn result;};/*\n\t    http://www.JSON.org/json2.js\n\t    2010-08-25\n\t\n\t    Public Domain.\n\t\n\t    NO WARRANTY EXPRESSED OR IMPLIED. USE AT YOUR OWN RISK.\n\t\n\t    See http://www.JSON.org/js.html\n\t\n\t\n\t    This code should be minified before deployment.\n\t    See http://javascript.crockford.com/jsmin.html\n\t\n\t    USE YOUR OWN COPY. IT IS EXTREMELY UNWISE TO LOAD CODE FROM SERVERS YOU DO\n\t    NOT CONTROL.\n\t\n\t\n\t    This file creates a global JSON object containing two methods: stringify\n\t    and parse.\n\t\n\t        JSON.stringify(value, replacer, space)\n\t            value       any JavaScript value, usually an object or array.\n\t\n\t            replacer    an optional parameter that determines how object\n\t                        values are stringified for objects. It can be a\n\t                        function or an array of strings.\n\t\n\t            space       an optional parameter that specifies the indentation\n\t                        of nested structures. If it is omitted, the text will\n\t                        be packed without extra whitespace. If it is a number,\n\t                        it will specify the number of spaces to indent at each\n\t                        level. If it is a string (such as '\\t' or '&nbsp;'),\n\t                        it contains the characters used to indent at each level.\n\t\n\t            This method produces a JSON text from a JavaScript value.\n\t\n\t            When an object value is found, if the object contains a toJSON\n\t            method, its toJSON method will be called and the result will be\n\t            stringified. A toJSON method does not serialize: it returns the\n\t            value represented by the name/value pair that should be serialized,\n\t            or undefined if nothing should be serialized. The toJSON method\n\t            will be passed the key associated with the value, and this will be\n\t            bound to the value\n\t\n\t            For example, this would serialize Dates as ISO strings.\n\t\n\t                Date.prototype.toJSON = function (key) {\n\t                    function f(n) {\n\t                        // Format integers to have at least two digits.\n\t                        return n < 10 ? '0' + n : n;\n\t                    }\n\t\n\t                    return this.getUTCFullYear()   + '-' +\n\t                         f(this.getUTCMonth() + 1) + '-' +\n\t                         f(this.getUTCDate())      + 'T' +\n\t                         f(this.getUTCHours())     + ':' +\n\t                         f(this.getUTCMinutes())   + ':' +\n\t                         f(this.getUTCSeconds())   + 'Z';\n\t                };\n\t\n\t            You can provide an optional replacer method. It will be passed the\n\t            key and value of each member, with this bound to the containing\n\t            object. The value that is returned from your method will be\n\t            serialized. If your method returns undefined, then the member will\n\t            be excluded from the serialization.\n\t\n\t            If the replacer parameter is an array of strings, then it will be\n\t            used to select the members to be serialized. It filters the results\n\t            such that only members with keys listed in the replacer array are\n\t            stringified.\n\t\n\t            Values that do not have JSON representations, such as undefined or\n\t            functions, will not be serialized. Such values in objects will be\n\t            dropped; in arrays they will be replaced with null. You can use\n\t            a replacer function to replace those with JSON values.\n\t            JSON.stringify(undefined) returns undefined.\n\t\n\t            The optional space parameter produces a stringification of the\n\t            value that is filled with line breaks and indentation to make it\n\t            easier to read.\n\t\n\t            If the space parameter is a non-empty string, then that string will\n\t            be used for indentation. If the space parameter is a number, then\n\t            the indentation will be that many spaces.\n\t\n\t            Example:\n\t\n\t            text = JSON.stringify(['e', {pluribus: 'unum'}]);\n\t            // text is '[\"e\",{\"pluribus\":\"unum\"}]'\n\t\n\t\n\t            text = JSON.stringify(['e', {pluribus: 'unum'}], null, '\\t');\n\t            // text is '[\\n\\t\"e\",\\n\\t{\\n\\t\\t\"pluribus\": \"unum\"\\n\\t}\\n]'\n\t\n\t            text = JSON.stringify([new Date()], function (key, value) {\n\t                return this[key] instanceof Date ?\n\t                    'Date(' + this[key] + ')' : value;\n\t            });\n\t            // text is '[\"Date(---current time---)\"]'\n\t\n\t\n\t        JSON.parse(text, reviver)\n\t            This method parses a JSON text to produce an object or array.\n\t            It can throw a SyntaxError exception.\n\t\n\t            The optional reviver parameter is a function that can filter and\n\t            transform the results. It receives each of the keys and values,\n\t            and its return value is used instead of the original value.\n\t            If it returns what it received, then the structure is not modified.\n\t            If it returns undefined then the member is deleted.\n\t\n\t            Example:\n\t\n\t            // Parse the text. Values that look like ISO date strings will\n\t            // be converted to Date objects.\n\t\n\t            myData = JSON.parse(text, function (key, value) {\n\t                var a;\n\t                if (typeof value === 'string') {\n\t                    a =\n\t/^(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2}(?:\\.\\d*)?)Z$/.exec(value);\n\t                    if (a) {\n\t                        return new Date(Date.UTC(+a[1], +a[2] - 1, +a[3], +a[4],\n\t                            +a[5], +a[6]));\n\t                    }\n\t                }\n\t                return value;\n\t            });\n\t\n\t            myData = JSON.parse('[\"Date(09/09/2001)\"]', function (key, value) {\n\t                var d;\n\t                if (typeof value === 'string' &&\n\t                        value.slice(0, 5) === 'Date(' &&\n\t                        value.slice(-1) === ')') {\n\t                    d = new Date(value.slice(5, -1));\n\t                    if (d) {\n\t                        return d;\n\t                    }\n\t                }\n\t                return value;\n\t            });\n\t\n\t\n\t    This is a reference implementation. You are free to copy, modify, or\n\t    redistribute.\n\t*//*jslint evil: true, strict: false *//*members \"\", \"\\b\", \"\\t\", \"\\n\", \"\\f\", \"\\r\", \"\\\"\", JSON, \"\\\\\", apply,\n\t    call, charCodeAt, getUTCDate, getUTCFullYear, getUTCHours,\n\t    getUTCMinutes, getUTCMonth, getUTCSeconds, hasOwnProperty, join,\n\t    lastIndex, length, parse, prototype, push, replace, slice, stringify,\n\t    test, toJSON, toString, valueOf\n\t*/// Create a JSON object only if one does not already exist. We create the\n\t// methods in a closure to avoid creating global variables.\n\tif(!this.JSON){this.JSON={};}(function(){function f(n){// Format integers to have at least two digits.\n\treturn n<10?'0'+n:n;}if(typeof Date.prototype.toJSON!=='function'){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+'-'+f(this.getUTCMonth()+1)+'-'+f(this.getUTCDate())+'T'+f(this.getUTCHours())+':'+f(this.getUTCMinutes())+':'+f(this.getUTCSeconds())+'Z':null;};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf();};}var cx=/[\\u0000\\u00ad\\u0600-\\u0604\\u070f\\u17b4\\u17b5\\u200c-\\u200f\\u2028-\\u202f\\u2060-\\u206f\\ufeff\\ufff0-\\uffff]/g,escapable=/[\\\\\\\"\\x00-\\x1f\\x7f-\\x9f\\u00ad\\u0600-\\u0604\\u070f\\u17b4\\u17b5\\u200c-\\u200f\\u2028-\\u202f\\u2060-\\u206f\\ufeff\\ufff0-\\uffff]/g,gap,indent,meta={// table of character substitutions\n\t'\\b':'\\\\b','\\t':'\\\\t','\\n':'\\\\n','\\f':'\\\\f','\\r':'\\\\r','\"':'\\\\\"','\\\\':'\\\\\\\\'},rep;function quote(string){// If the string contains no control characters, no quote characters, and no\n\t// backslash characters, then we can safely slap some quotes around it.\n\t// Otherwise we must also replace the offending characters with safe escape\n\t// sequences.\n\tescapable.lastIndex=0;return escapable.test(string)?'\"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==='string'?c:'\\\\u'+('0000'+a.charCodeAt(0).toString(16)).slice(-4);})+'\"':'\"'+string+'\"';}function str(key,holder){// Produce a string from holder[key].\n\tvar i,// The loop counter.\n\tk,// The member key.\n\tv,// The member value.\n\tlength,mind=gap,partial,value=holder[key];// If the value has a toJSON method, call it to obtain a replacement value.\n\tif(value&&(typeof value==='undefined'?'undefined':_typeof(value))==='object'&&typeof value.toJSON==='function'){value=value.toJSON(key);}// If we were called with a replacer function, then call the replacer to\n\t// obtain a replacement value.\n\tif(typeof rep==='function'){value=rep.call(holder,key,value);}// What happens next depends on the value's type.\n\tswitch(typeof value==='undefined'?'undefined':_typeof(value)){case'string':return quote(value);case'number':// JSON numbers must be finite. Encode non-finite numbers as null.\n\treturn isFinite(value)?String(value):'null';case'boolean':case'null':// If the value is a boolean or null, convert it to a string. Note:\n\t// typeof null does not produce 'null'. The case is included here in\n\t// the remote chance that this gets fixed someday.\n\treturn String(value);// If the type is 'object', we might be dealing with an object or an array or\n\t// null.\n\tcase'object':// Due to a specification blunder in ECMAScript, typeof null is 'object',\n\t// so watch out for that case.\n\tif(!value){return'null';}// Make an array to hold the partial results of stringifying this object value.\n\tgap+=indent;partial=[];// Is the value an array?\n\tif(Object.prototype.toString.apply(value)==='[object Array]'){// The value is an array. Stringify every element. Use null as a placeholder\n\t// for non-JSON values.\n\tlength=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||'null';}// Join all of the elements together, separated with commas, and wrap them in\n\t// brackets.\n\tv=partial.length===0?'[]':gap?'[\\n'+gap+partial.join(',\\n'+gap)+'\\n'+mind+']':'['+partial.join(',')+']';gap=mind;return v;}// If the replacer is an array, use it to select the members to be stringified.\n\tif(rep&&(typeof rep==='undefined'?'undefined':_typeof(rep))==='object'){length=rep.length;for(i=0;i<length;i+=1){k=rep[i];if(typeof k==='string'){v=str(k,value);if(v){partial.push(quote(k)+(gap?': ':':')+v);}}}}else{// Otherwise, iterate through all of the keys in the object.\n\tfor(k in value){if(Object.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?': ':':')+v);}}}}// Join all of the member texts together, separated with commas,\n\t// and wrap them in braces.\n\tv=partial.length===0?'{}':gap?'{\\n'+gap+partial.join(',\\n'+gap)+'\\n'+mind+'}':'{'+partial.join(',')+'}';gap=mind;return v;}}// If the JSON object does not yet have a stringify method, give it one.\n\tif(typeof JSON.stringify!=='function'){JSON.stringify=function(value,replacer,space){// The stringify method takes a value and an optional replacer, and an optional\n\t// space parameter, and returns a JSON text. The replacer can be a function\n\t// that can replace values, or an array of strings that will select the keys.\n\t// A default replacer method can be provided. Use of the space parameter can\n\t// produce text that is more easily readable.\n\tvar i;gap='';indent='';// If the space parameter is a number, make an indent string containing that\n\t// many spaces.\n\tif(typeof space==='number'){for(i=0;i<space;i+=1){indent+=' ';}// If the space parameter is a string, it will be used as the indent string.\n\t}else if(typeof space==='string'){indent=space;}// If there is a replacer, it must be a function or an array.\n\t// Otherwise, throw an error.\n\trep=replacer;if(replacer&&typeof replacer!=='function'&&((typeof replacer==='undefined'?'undefined':_typeof(replacer))!=='object'||typeof replacer.length!=='number')){throw new Error('JSON.stringify');}// Make a fake root object containing our value under the key of ''.\n\t// Return the result of stringifying the value.\n\treturn str('',{'':value});};}// If the JSON object does not yet have a parse method, give it one.\n\tif(typeof JSON.parse!=='function'){JSON.parse=function(text,reviver){// The parse method takes a text and an optional reviver function, and returns\n\t// a JavaScript value if the text is a valid JSON text.\n\tvar j;function walk(holder,key){// The walk method is used to recursively walk the resulting structure so\n\t// that modifications can be made.\n\tvar k,v,value=holder[key];if(value&&(typeof value==='undefined'?'undefined':_typeof(value))==='object'){for(k in value){if(Object.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v;}else{delete value[k];}}}}return reviver.call(holder,key,value);}// Parsing happens in four stages. In the first stage, we replace certain\n\t// Unicode characters with escape sequences. JavaScript handles many characters\n\t// incorrectly, either silently deleting them, or treating them as line endings.\n\ttext=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return'\\\\u'+('0000'+a.charCodeAt(0).toString(16)).slice(-4);});}// In the second stage, we run the text against regular expressions that look\n\t// for non-JSON patterns. We are especially concerned with '()' and 'new'\n\t// because they can cause invocation, and '=' because it can cause mutation.\n\t// But just to be safe, we want to reject all unexpected forms.\n\t// We split the second stage into 4 regexp operations in order to work around\n\t// crippling inefficiencies in IE's and Safari's regexp engines. First we\n\t// replace the JSON backslash pairs with '@' (a non-JSON character). Second, we\n\t// replace all simple value tokens with ']' characters. Third, we delete all\n\t// open brackets that follow a colon or comma or that begin the text. Finally,\n\t// we look to see that the remaining characters are only whitespace or ']' or\n\t// ',' or ':' or '{' or '}'. If that is so, then the text is safe for eval.\n\tif(/^[\\],:{}\\s]*$/.test(text.replace(/\\\\(?:[\"\\\\\\/bfnrt]|u[0-9a-fA-F]{4})/g,'@').replace(/\"[^\"\\\\\\n\\r]*\"|true|false|null|-?\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d+)?/g,']').replace(/(?:^|:|,)(?:\\s*\\[)+/g,''))){// In the third stage we use the eval function to compile the text into a\n\t// JavaScript structure. The '{' operator is subject to a syntactic ambiguity\n\t// in JavaScript: it can begin a block or an object literal. We wrap the text\n\t// in parens to eliminate the ambiguity.\n\tj=eval('('+text+')');// In the optional fourth stage, we recursively walk the new structure, passing\n\t// each name/value pair to a reviver function for possible transformation.\n\treturn typeof reviver==='function'?walk({'':j},''):j;}// If the text is not JSON parseable, then a SyntaxError is thrown.\n\tthrow new SyntaxError('JSON.parse');};}})();SocialCalc.oldBtnActive=1;SocialCalc.Constants.defaultImagePrefix=\"www/assets/images/sc_\";SocialCalc.Constants.defaultGridCSS=\"\";SocialCalc.Constants.SCNoColNames=true;SocialCalc.Constants.SCNoRowName=true;SocialCalc.Constants.defaultRownameStyle=\"\";SocialCalc.Constants.defaultSelectedRownameStyle=\"\";SocialCalc.Popup.imagePrefix=\"www/assets/images/sc_\";SocialCalc.ToggleInputLineButtons=function(show){var bele=document.getElementById(\"testtest\");if(!bele)return;if(show){bele.style.display=\"inline\";}else{bele.style.display=\"none\";}};SocialCalc.InputLineClearText=function(){spreadsheet.editor.inputBox.SetText(\"\");};SocialCalc.Callbacks.broadcast=function(type,data){};// END OF FILE\n\tif('undefined'===typeof document){// We don't really need a DOM-based presentation layer on the server\n\tSocialCalc.GetEditorCellElement=function(){};SocialCalc.ReplaceCell=function(){};SocialCalc.EditorRenderSheet=function(){};SocialCalc.SpreadsheetControlSortSave=function(){return\"\";};SocialCalc.SpreadsheetControlStatuslineCallback=function(){};SocialCalc.DoPositionCalculations=function(editor){SocialCalc.EditorSheetStatusCallback(null,\"doneposcalc\",null,editor);};}// Compatibility with webworker-threads\n\tif(typeof self!=='undefined'&&self.thread){window.setTimeout=function(cb,ms){if(ms<=1){self.thread.nextTick(cb);}};window.clearTimeout=function(){};}// Just return a value to define the module export.\n\treturn SocialCalc;});\n\n/***/ },\n/* 14 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\texports.Cloud = undefined;\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\t__webpack_require__(29);\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar BASE_URL = 'http://aspiringapps.com/api';\n\t\n\tvar Cloud = exports.Cloud = function () {\n\t\tfunction Cloud() {\n\t\t\t_classCallCheck(this, Cloud);\n\t\t}\n\t\n\t\t_createClass(Cloud, [{\n\t\t\tkey: '_auth',\n\t\t\tvalue: function _auth(data) {\n\t\t\t\tvar url = BASE_URL + \"/login\";\n\t\t\t\tvar body = JSON.stringify({ data: data });\n\t\t\t\treturn fetch(url, {\n\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\theaders: {\n\t\t\t\t\t\t'Content-Type': 'application/json'\n\t\t\t\t\t},\n\t\t\t\t\tbody: body\n\t\t\t\t}).then(function (response) {\n\t\t\t\t\tconsole.log('request succeeded with JSON response', response);\n\t\t\t\t});\n\t\t\t}\n\t\t}, {\n\t\t\tkey: '_checkStatus',\n\t\t\tvalue: function _checkStatus(response) {\n\t\t\t\tif (response.status >= 200 && response.status < 300) {\n\t\t\t\t\treturn response;\n\t\t\t\t} else {\n\t\t\t\t\tvar error = new Error(response.statusText);\n\t\t\t\t\terror.response = response;\n\t\t\t\t\tthrow error;\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: '_parseJSON',\n\t\t\tvalue: function _parseJSON(response) {\n\t\t\t\treturn response.json();\n\t\t\t}\n\t\t}]);\n\n\t\treturn Cloud;\n\t}();\n\n/***/ },\n/* 15 */\n/***/ function(module, exports) {\n\n\t// removed by extract-text-webpack-plugin\n\n/***/ },\n/* 16 */\n15,\n/* 17 */\n15,\n/* 18 */\n15,\n/* 19 */\n15,\n/* 20 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\t//This file contains the ES6 extensions to the core Promises/A+ API\n\t\n\tvar Promise = __webpack_require__(6);\n\t\n\tmodule.exports = Promise;\n\t\n\t/* Static Functions */\n\t\n\tvar TRUE = valuePromise(true);\n\tvar FALSE = valuePromise(false);\n\tvar NULL = valuePromise(null);\n\tvar UNDEFINED = valuePromise(undefined);\n\tvar ZERO = valuePromise(0);\n\tvar EMPTYSTRING = valuePromise('');\n\t\n\tfunction valuePromise(value) {\n\t  var p = new Promise(Promise._61);\n\t  p._81 = 1;\n\t  p._65 = value;\n\t  return p;\n\t}\n\tPromise.resolve = function (value) {\n\t  if (value instanceof Promise) return value;\n\t\n\t  if (value === null) return NULL;\n\t  if (value === undefined) return UNDEFINED;\n\t  if (value === true) return TRUE;\n\t  if (value === false) return FALSE;\n\t  if (value === 0) return ZERO;\n\t  if (value === '') return EMPTYSTRING;\n\t\n\t  if (typeof value === 'object' || typeof value === 'function') {\n\t    try {\n\t      var then = value.then;\n\t      if (typeof then === 'function') {\n\t        return new Promise(then.bind(value));\n\t      }\n\t    } catch (ex) {\n\t      return new Promise(function (resolve, reject) {\n\t        reject(ex);\n\t      });\n\t    }\n\t  }\n\t  return valuePromise(value);\n\t};\n\t\n\tPromise.all = function (arr) {\n\t  var args = Array.prototype.slice.call(arr);\n\t\n\t  return new Promise(function (resolve, reject) {\n\t    if (args.length === 0) return resolve([]);\n\t    var remaining = args.length;\n\t    function res(i, val) {\n\t      if (val && (typeof val === 'object' || typeof val === 'function')) {\n\t        if (val instanceof Promise && val.then === Promise.prototype.then) {\n\t          while (val._81 === 3) {\n\t            val = val._65;\n\t          }\n\t          if (val._81 === 1) return res(i, val._65);\n\t          if (val._81 === 2) reject(val._65);\n\t          val.then(function (val) {\n\t            res(i, val);\n\t          }, reject);\n\t          return;\n\t        } else {\n\t          var then = val.then;\n\t          if (typeof then === 'function') {\n\t            var p = new Promise(then.bind(val));\n\t            p.then(function (val) {\n\t              res(i, val);\n\t            }, reject);\n\t            return;\n\t          }\n\t        }\n\t      }\n\t      args[i] = val;\n\t      if (--remaining === 0) {\n\t        resolve(args);\n\t      }\n\t    }\n\t    for (var i = 0; i < args.length; i++) {\n\t      res(i, args[i]);\n\t    }\n\t  });\n\t};\n\t\n\tPromise.reject = function (value) {\n\t  return new Promise(function (resolve, reject) {\n\t    reject(value);\n\t  });\n\t};\n\t\n\tPromise.race = function (values) {\n\t  return new Promise(function (resolve, reject) {\n\t    values.forEach(function(value){\n\t      Promise.resolve(value).then(resolve, reject);\n\t    });\n\t  });\n\t};\n\t\n\t/* Prototype Methods */\n\t\n\tPromise.prototype['catch'] = function (onRejected) {\n\t  return this.then(null, onRejected);\n\t};\n\n\n/***/ },\n/* 21 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar Promise = __webpack_require__(6);\n\t\n\tvar DEFAULT_WHITELIST = [\n\t  ReferenceError,\n\t  TypeError,\n\t  RangeError\n\t];\n\t\n\tvar enabled = false;\n\texports.disable = disable;\n\tfunction disable() {\n\t  enabled = false;\n\t  Promise._10 = null;\n\t  Promise._97 = null;\n\t}\n\t\n\texports.enable = enable;\n\tfunction enable(options) {\n\t  options = options || {};\n\t  if (enabled) disable();\n\t  enabled = true;\n\t  var id = 0;\n\t  var displayId = 0;\n\t  var rejections = {};\n\t  Promise._10 = function (promise) {\n\t    if (\n\t      promise._81 === 2 && // IS REJECTED\n\t      rejections[promise._72]\n\t    ) {\n\t      if (rejections[promise._72].logged) {\n\t        onHandled(promise._72);\n\t      } else {\n\t        clearTimeout(rejections[promise._72].timeout);\n\t      }\n\t      delete rejections[promise._72];\n\t    }\n\t  };\n\t  Promise._97 = function (promise, err) {\n\t    if (promise._45 === 0) { // not yet handled\n\t      promise._72 = id++;\n\t      rejections[promise._72] = {\n\t        displayId: null,\n\t        error: err,\n\t        timeout: setTimeout(\n\t          onUnhandled.bind(null, promise._72),\n\t          // For reference errors and type errors, this almost always\n\t          // means the programmer made a mistake, so log them after just\n\t          // 100ms\n\t          // otherwise, wait 2 seconds to see if they get handled\n\t          matchWhitelist(err, DEFAULT_WHITELIST)\n\t            ? 100\n\t            : 2000\n\t        ),\n\t        logged: false\n\t      };\n\t    }\n\t  };\n\t  function onUnhandled(id) {\n\t    if (\n\t      options.allRejections ||\n\t      matchWhitelist(\n\t        rejections[id].error,\n\t        options.whitelist || DEFAULT_WHITELIST\n\t      )\n\t    ) {\n\t      rejections[id].displayId = displayId++;\n\t      if (options.onUnhandled) {\n\t        rejections[id].logged = true;\n\t        options.onUnhandled(\n\t          rejections[id].displayId,\n\t          rejections[id].error\n\t        );\n\t      } else {\n\t        rejections[id].logged = true;\n\t        logError(\n\t          rejections[id].displayId,\n\t          rejections[id].error\n\t        );\n\t      }\n\t    }\n\t  }\n\t  function onHandled(id) {\n\t    if (rejections[id].logged) {\n\t      if (options.onHandled) {\n\t        options.onHandled(rejections[id].displayId, rejections[id].error);\n\t      } else if (!rejections[id].onUnhandled) {\n\t        console.warn(\n\t          'Promise Rejection Handled (id: ' + rejections[id].displayId + '):'\n\t        );\n\t        console.warn(\n\t          '  This means you can ignore any previous messages of the form \"Possible Unhandled Promise Rejection\" with id ' +\n\t          rejections[id].displayId + '.'\n\t        );\n\t      }\n\t    }\n\t  }\n\t}\n\t\n\tfunction logError(id, error) {\n\t  console.warn('Possible Unhandled Promise Rejection (id: ' + id + '):');\n\t  var errStr = (error && (error.stack || error)) + '';\n\t  errStr.split('\\n').forEach(function (line) {\n\t    console.warn('  ' + line);\n\t  });\n\t}\n\t\n\tfunction matchWhitelist(error, list) {\n\t  return list.some(function (cls) {\n\t    return error instanceof cls;\n\t  });\n\t}\n\n/***/ },\n/* 22 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t/** @license React v16.14.0\n\t * react-dom.production.min.js\n\t *\n\t * Copyright (c) Facebook, Inc. and its affiliates.\n\t *\n\t * This source code is licensed under the MIT license found in the\n\t * LICENSE file in the root directory of this source tree.\n\t */\n\t\n\t/*\n\t Modernizr 3.0.0pre (Custom Build) | MIT\n\t*/\n\t'use strict';var aa=__webpack_require__(1),n=__webpack_require__(4),r=__webpack_require__(28);function u(a){for(var b=\"https://reactjs.org/docs/error-decoder.html?invariant=\"+a,c=1;c<arguments.length;c++)b+=\"&args[]=\"+encodeURIComponent(arguments[c]);return\"Minified React error #\"+a+\"; visit \"+b+\" for the full message or use the non-minified dev environment for full errors and additional helpful warnings.\"}if(!aa)throw Error(u(227));\n\tfunction ba(a,b,c,d,e,f,g,h,k){var l=Array.prototype.slice.call(arguments,3);try{b.apply(c,l)}catch(m){this.onError(m)}}var da=!1,ea=null,fa=!1,ha=null,ia={onError:function(a){da=!0;ea=a}};function ja(a,b,c,d,e,f,g,h,k){da=!1;ea=null;ba.apply(ia,arguments)}function ka(a,b,c,d,e,f,g,h,k){ja.apply(this,arguments);if(da){if(da){var l=ea;da=!1;ea=null}else throw Error(u(198));fa||(fa=!0,ha=l)}}var la=null,ma=null,na=null;\n\tfunction oa(a,b,c){var d=a.type||\"unknown-event\";a.currentTarget=na(c);ka(d,b,void 0,a);a.currentTarget=null}var pa=null,qa={};\n\tfunction ra(){if(pa)for(var a in qa){var b=qa[a],c=pa.indexOf(a);if(!(-1<c))throw Error(u(96,a));if(!sa[c]){if(!b.extractEvents)throw Error(u(97,a));sa[c]=b;c=b.eventTypes;for(var d in c){var e=void 0;var f=c[d],g=b,h=d;if(ta.hasOwnProperty(h))throw Error(u(99,h));ta[h]=f;var k=f.phasedRegistrationNames;if(k){for(e in k)k.hasOwnProperty(e)&&ua(k[e],g,h);e=!0}else f.registrationName?(ua(f.registrationName,g,h),e=!0):e=!1;if(!e)throw Error(u(98,d,a));}}}}\n\tfunction ua(a,b,c){if(va[a])throw Error(u(100,a));va[a]=b;wa[a]=b.eventTypes[c].dependencies}var sa=[],ta={},va={},wa={};function xa(a){var b=!1,c;for(c in a)if(a.hasOwnProperty(c)){var d=a[c];if(!qa.hasOwnProperty(c)||qa[c]!==d){if(qa[c])throw Error(u(102,c));qa[c]=d;b=!0}}b&&ra()}var ya=!(\"undefined\"===typeof window||\"undefined\"===typeof window.document||\"undefined\"===typeof window.document.createElement),za=null,Aa=null,Ba=null;\n\tfunction Ca(a){if(a=ma(a)){if(\"function\"!==typeof za)throw Error(u(280));var b=a.stateNode;b&&(b=la(b),za(a.stateNode,a.type,b))}}function Da(a){Aa?Ba?Ba.push(a):Ba=[a]:Aa=a}function Ea(){if(Aa){var a=Aa,b=Ba;Ba=Aa=null;Ca(a);if(b)for(a=0;a<b.length;a++)Ca(b[a])}}function Fa(a,b){return a(b)}function Ga(a,b,c,d,e){return a(b,c,d,e)}function Ha(){}var Ia=Fa,Ja=!1,Ka=!1;function La(){if(null!==Aa||null!==Ba)Ha(),Ea()}\n\tfunction Ma(a,b,c){if(Ka)return a(b,c);Ka=!0;try{return Ia(a,b,c)}finally{Ka=!1,La()}}var Na=/^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$/,Oa=Object.prototype.hasOwnProperty,Pa={},Qa={};\n\tfunction Ra(a){if(Oa.call(Qa,a))return!0;if(Oa.call(Pa,a))return!1;if(Na.test(a))return Qa[a]=!0;Pa[a]=!0;return!1}function Sa(a,b,c,d){if(null!==c&&0===c.type)return!1;switch(typeof b){case \"function\":case \"symbol\":return!0;case \"boolean\":if(d)return!1;if(null!==c)return!c.acceptsBooleans;a=a.toLowerCase().slice(0,5);return\"data-\"!==a&&\"aria-\"!==a;default:return!1}}\n\tfunction Ta(a,b,c,d){if(null===b||\"undefined\"===typeof b||Sa(a,b,c,d))return!0;if(d)return!1;if(null!==c)switch(c.type){case 3:return!b;case 4:return!1===b;case 5:return isNaN(b);case 6:return isNaN(b)||1>b}return!1}function v(a,b,c,d,e,f){this.acceptsBooleans=2===b||3===b||4===b;this.attributeName=d;this.attributeNamespace=e;this.mustUseProperty=c;this.propertyName=a;this.type=b;this.sanitizeURL=f}var C={};\n\t\"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style\".split(\" \").forEach(function(a){C[a]=new v(a,0,!1,a,null,!1)});[[\"acceptCharset\",\"accept-charset\"],[\"className\",\"class\"],[\"htmlFor\",\"for\"],[\"httpEquiv\",\"http-equiv\"]].forEach(function(a){var b=a[0];C[b]=new v(b,1,!1,a[1],null,!1)});[\"contentEditable\",\"draggable\",\"spellCheck\",\"value\"].forEach(function(a){C[a]=new v(a,2,!1,a.toLowerCase(),null,!1)});\n\t[\"autoReverse\",\"externalResourcesRequired\",\"focusable\",\"preserveAlpha\"].forEach(function(a){C[a]=new v(a,2,!1,a,null,!1)});\"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope\".split(\" \").forEach(function(a){C[a]=new v(a,3,!1,a.toLowerCase(),null,!1)});\n\t[\"checked\",\"multiple\",\"muted\",\"selected\"].forEach(function(a){C[a]=new v(a,3,!0,a,null,!1)});[\"capture\",\"download\"].forEach(function(a){C[a]=new v(a,4,!1,a,null,!1)});[\"cols\",\"rows\",\"size\",\"span\"].forEach(function(a){C[a]=new v(a,6,!1,a,null,!1)});[\"rowSpan\",\"start\"].forEach(function(a){C[a]=new v(a,5,!1,a.toLowerCase(),null,!1)});var Ua=/[\\-:]([a-z])/g;function Va(a){return a[1].toUpperCase()}\n\t\"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height\".split(\" \").forEach(function(a){var b=a.replace(Ua,\n\tVa);C[b]=new v(b,1,!1,a,null,!1)});\"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type\".split(\" \").forEach(function(a){var b=a.replace(Ua,Va);C[b]=new v(b,1,!1,a,\"http://www.w3.org/1999/xlink\",!1)});[\"xml:base\",\"xml:lang\",\"xml:space\"].forEach(function(a){var b=a.replace(Ua,Va);C[b]=new v(b,1,!1,a,\"http://www.w3.org/XML/1998/namespace\",!1)});[\"tabIndex\",\"crossOrigin\"].forEach(function(a){C[a]=new v(a,1,!1,a.toLowerCase(),null,!1)});\n\tC.xlinkHref=new v(\"xlinkHref\",1,!1,\"xlink:href\",\"http://www.w3.org/1999/xlink\",!0);[\"src\",\"href\",\"action\",\"formAction\"].forEach(function(a){C[a]=new v(a,1,!1,a.toLowerCase(),null,!0)});var Wa=aa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;Wa.hasOwnProperty(\"ReactCurrentDispatcher\")||(Wa.ReactCurrentDispatcher={current:null});Wa.hasOwnProperty(\"ReactCurrentBatchConfig\")||(Wa.ReactCurrentBatchConfig={suspense:null});\n\tfunction Xa(a,b,c,d){var e=C.hasOwnProperty(b)?C[b]:null;var f=null!==e?0===e.type:d?!1:!(2<b.length)||\"o\"!==b[0]&&\"O\"!==b[0]||\"n\"!==b[1]&&\"N\"!==b[1]?!1:!0;f||(Ta(b,c,e,d)&&(c=null),d||null===e?Ra(b)&&(null===c?a.removeAttribute(b):a.setAttribute(b,\"\"+c)):e.mustUseProperty?a[e.propertyName]=null===c?3===e.type?!1:\"\":c:(b=e.attributeName,d=e.attributeNamespace,null===c?a.removeAttribute(b):(e=e.type,c=3===e||4===e&&!0===c?\"\":\"\"+c,d?a.setAttributeNS(d,b,c):a.setAttribute(b,c))))}\n\tvar Ya=/^(.*)[\\\\\\/]/,E=\"function\"===typeof Symbol&&Symbol.for,Za=E?Symbol.for(\"react.element\"):60103,$a=E?Symbol.for(\"react.portal\"):60106,ab=E?Symbol.for(\"react.fragment\"):60107,bb=E?Symbol.for(\"react.strict_mode\"):60108,cb=E?Symbol.for(\"react.profiler\"):60114,db=E?Symbol.for(\"react.provider\"):60109,eb=E?Symbol.for(\"react.context\"):60110,fb=E?Symbol.for(\"react.concurrent_mode\"):60111,gb=E?Symbol.for(\"react.forward_ref\"):60112,hb=E?Symbol.for(\"react.suspense\"):60113,ib=E?Symbol.for(\"react.suspense_list\"):\n\t60120,jb=E?Symbol.for(\"react.memo\"):60115,kb=E?Symbol.for(\"react.lazy\"):60116,lb=E?Symbol.for(\"react.block\"):60121,mb=\"function\"===typeof Symbol&&Symbol.iterator;function nb(a){if(null===a||\"object\"!==typeof a)return null;a=mb&&a[mb]||a[\"@@iterator\"];return\"function\"===typeof a?a:null}function ob(a){if(-1===a._status){a._status=0;var b=a._ctor;b=b();a._result=b;b.then(function(b){0===a._status&&(b=b.default,a._status=1,a._result=b)},function(b){0===a._status&&(a._status=2,a._result=b)})}}\n\tfunction pb(a){if(null==a)return null;if(\"function\"===typeof a)return a.displayName||a.name||null;if(\"string\"===typeof a)return a;switch(a){case ab:return\"Fragment\";case $a:return\"Portal\";case cb:return\"Profiler\";case bb:return\"StrictMode\";case hb:return\"Suspense\";case ib:return\"SuspenseList\"}if(\"object\"===typeof a)switch(a.$$typeof){case eb:return\"Context.Consumer\";case db:return\"Context.Provider\";case gb:var b=a.render;b=b.displayName||b.name||\"\";return a.displayName||(\"\"!==b?\"ForwardRef(\"+b+\")\":\n\t\"ForwardRef\");case jb:return pb(a.type);case lb:return pb(a.render);case kb:if(a=1===a._status?a._result:null)return pb(a)}return null}function qb(a){var b=\"\";do{a:switch(a.tag){case 3:case 4:case 6:case 7:case 10:case 9:var c=\"\";break a;default:var d=a._debugOwner,e=a._debugSource,f=pb(a.type);c=null;d&&(c=pb(d.type));d=f;f=\"\";e?f=\" (at \"+e.fileName.replace(Ya,\"\")+\":\"+e.lineNumber+\")\":c&&(f=\" (created by \"+c+\")\");c=\"\\n    in \"+(d||\"Unknown\")+f}b+=c;a=a.return}while(a);return b}\n\tfunction rb(a){switch(typeof a){case \"boolean\":case \"number\":case \"object\":case \"string\":case \"undefined\":return a;default:return\"\"}}function sb(a){var b=a.type;return(a=a.nodeName)&&\"input\"===a.toLowerCase()&&(\"checkbox\"===b||\"radio\"===b)}\n\tfunction tb(a){var b=sb(a)?\"checked\":\"value\",c=Object.getOwnPropertyDescriptor(a.constructor.prototype,b),d=\"\"+a[b];if(!a.hasOwnProperty(b)&&\"undefined\"!==typeof c&&\"function\"===typeof c.get&&\"function\"===typeof c.set){var e=c.get,f=c.set;Object.defineProperty(a,b,{configurable:!0,get:function(){return e.call(this)},set:function(a){d=\"\"+a;f.call(this,a)}});Object.defineProperty(a,b,{enumerable:c.enumerable});return{getValue:function(){return d},setValue:function(a){d=\"\"+a},stopTracking:function(){a._valueTracker=\n\tnull;delete a[b]}}}}function xb(a){a._valueTracker||(a._valueTracker=tb(a))}function yb(a){if(!a)return!1;var b=a._valueTracker;if(!b)return!0;var c=b.getValue();var d=\"\";a&&(d=sb(a)?a.checked?\"true\":\"false\":a.value);a=d;return a!==c?(b.setValue(a),!0):!1}function zb(a,b){var c=b.checked;return n({},b,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=c?c:a._wrapperState.initialChecked})}\n\tfunction Ab(a,b){var c=null==b.defaultValue?\"\":b.defaultValue,d=null!=b.checked?b.checked:b.defaultChecked;c=rb(null!=b.value?b.value:c);a._wrapperState={initialChecked:d,initialValue:c,controlled:\"checkbox\"===b.type||\"radio\"===b.type?null!=b.checked:null!=b.value}}function Bb(a,b){b=b.checked;null!=b&&Xa(a,\"checked\",b,!1)}\n\tfunction Cb(a,b){Bb(a,b);var c=rb(b.value),d=b.type;if(null!=c)if(\"number\"===d){if(0===c&&\"\"===a.value||a.value!=c)a.value=\"\"+c}else a.value!==\"\"+c&&(a.value=\"\"+c);else if(\"submit\"===d||\"reset\"===d){a.removeAttribute(\"value\");return}b.hasOwnProperty(\"value\")?Db(a,b.type,c):b.hasOwnProperty(\"defaultValue\")&&Db(a,b.type,rb(b.defaultValue));null==b.checked&&null!=b.defaultChecked&&(a.defaultChecked=!!b.defaultChecked)}\n\tfunction Eb(a,b,c){if(b.hasOwnProperty(\"value\")||b.hasOwnProperty(\"defaultValue\")){var d=b.type;if(!(\"submit\"!==d&&\"reset\"!==d||void 0!==b.value&&null!==b.value))return;b=\"\"+a._wrapperState.initialValue;c||b===a.value||(a.value=b);a.defaultValue=b}c=a.name;\"\"!==c&&(a.name=\"\");a.defaultChecked=!!a._wrapperState.initialChecked;\"\"!==c&&(a.name=c)}\n\tfunction Db(a,b,c){if(\"number\"!==b||a.ownerDocument.activeElement!==a)null==c?a.defaultValue=\"\"+a._wrapperState.initialValue:a.defaultValue!==\"\"+c&&(a.defaultValue=\"\"+c)}function Fb(a){var b=\"\";aa.Children.forEach(a,function(a){null!=a&&(b+=a)});return b}function Gb(a,b){a=n({children:void 0},b);if(b=Fb(b.children))a.children=b;return a}\n\tfunction Hb(a,b,c,d){a=a.options;if(b){b={};for(var e=0;e<c.length;e++)b[\"$\"+c[e]]=!0;for(c=0;c<a.length;c++)e=b.hasOwnProperty(\"$\"+a[c].value),a[c].selected!==e&&(a[c].selected=e),e&&d&&(a[c].defaultSelected=!0)}else{c=\"\"+rb(c);b=null;for(e=0;e<a.length;e++){if(a[e].value===c){a[e].selected=!0;d&&(a[e].defaultSelected=!0);return}null!==b||a[e].disabled||(b=a[e])}null!==b&&(b.selected=!0)}}\n\tfunction Ib(a,b){if(null!=b.dangerouslySetInnerHTML)throw Error(u(91));return n({},b,{value:void 0,defaultValue:void 0,children:\"\"+a._wrapperState.initialValue})}function Jb(a,b){var c=b.value;if(null==c){c=b.children;b=b.defaultValue;if(null!=c){if(null!=b)throw Error(u(92));if(Array.isArray(c)){if(!(1>=c.length))throw Error(u(93));c=c[0]}b=c}null==b&&(b=\"\");c=b}a._wrapperState={initialValue:rb(c)}}\n\tfunction Kb(a,b){var c=rb(b.value),d=rb(b.defaultValue);null!=c&&(c=\"\"+c,c!==a.value&&(a.value=c),null==b.defaultValue&&a.defaultValue!==c&&(a.defaultValue=c));null!=d&&(a.defaultValue=\"\"+d)}function Lb(a){var b=a.textContent;b===a._wrapperState.initialValue&&\"\"!==b&&null!==b&&(a.value=b)}var Mb={html:\"http://www.w3.org/1999/xhtml\",mathml:\"http://www.w3.org/1998/Math/MathML\",svg:\"http://www.w3.org/2000/svg\"};\n\tfunction Nb(a){switch(a){case \"svg\":return\"http://www.w3.org/2000/svg\";case \"math\":return\"http://www.w3.org/1998/Math/MathML\";default:return\"http://www.w3.org/1999/xhtml\"}}function Ob(a,b){return null==a||\"http://www.w3.org/1999/xhtml\"===a?Nb(b):\"http://www.w3.org/2000/svg\"===a&&\"foreignObject\"===b?\"http://www.w3.org/1999/xhtml\":a}\n\tvar Pb,Qb=function(a){return\"undefined\"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(b,c,d,e){MSApp.execUnsafeLocalFunction(function(){return a(b,c,d,e)})}:a}(function(a,b){if(a.namespaceURI!==Mb.svg||\"innerHTML\"in a)a.innerHTML=b;else{Pb=Pb||document.createElement(\"div\");Pb.innerHTML=\"<svg>\"+b.valueOf().toString()+\"</svg>\";for(b=Pb.firstChild;a.firstChild;)a.removeChild(a.firstChild);for(;b.firstChild;)a.appendChild(b.firstChild)}});\n\tfunction Rb(a,b){if(b){var c=a.firstChild;if(c&&c===a.lastChild&&3===c.nodeType){c.nodeValue=b;return}}a.textContent=b}function Sb(a,b){var c={};c[a.toLowerCase()]=b.toLowerCase();c[\"Webkit\"+a]=\"webkit\"+b;c[\"Moz\"+a]=\"moz\"+b;return c}var Tb={animationend:Sb(\"Animation\",\"AnimationEnd\"),animationiteration:Sb(\"Animation\",\"AnimationIteration\"),animationstart:Sb(\"Animation\",\"AnimationStart\"),transitionend:Sb(\"Transition\",\"TransitionEnd\")},Ub={},Vb={};\n\tya&&(Vb=document.createElement(\"div\").style,\"AnimationEvent\"in window||(delete Tb.animationend.animation,delete Tb.animationiteration.animation,delete Tb.animationstart.animation),\"TransitionEvent\"in window||delete Tb.transitionend.transition);function Wb(a){if(Ub[a])return Ub[a];if(!Tb[a])return a;var b=Tb[a],c;for(c in b)if(b.hasOwnProperty(c)&&c in Vb)return Ub[a]=b[c];return a}\n\tvar Xb=Wb(\"animationend\"),Yb=Wb(\"animationiteration\"),Zb=Wb(\"animationstart\"),$b=Wb(\"transitionend\"),ac=\"abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting\".split(\" \"),bc=new (\"function\"===typeof WeakMap?WeakMap:Map);function cc(a){var b=bc.get(a);void 0===b&&(b=new Map,bc.set(a,b));return b}\n\tfunction dc(a){var b=a,c=a;if(a.alternate)for(;b.return;)b=b.return;else{a=b;do b=a,0!==(b.effectTag&1026)&&(c=b.return),a=b.return;while(a)}return 3===b.tag?c:null}function ec(a){if(13===a.tag){var b=a.memoizedState;null===b&&(a=a.alternate,null!==a&&(b=a.memoizedState));if(null!==b)return b.dehydrated}return null}function fc(a){if(dc(a)!==a)throw Error(u(188));}\n\tfunction gc(a){var b=a.alternate;if(!b){b=dc(a);if(null===b)throw Error(u(188));return b!==a?null:a}for(var c=a,d=b;;){var e=c.return;if(null===e)break;var f=e.alternate;if(null===f){d=e.return;if(null!==d){c=d;continue}break}if(e.child===f.child){for(f=e.child;f;){if(f===c)return fc(e),a;if(f===d)return fc(e),b;f=f.sibling}throw Error(u(188));}if(c.return!==d.return)c=e,d=f;else{for(var g=!1,h=e.child;h;){if(h===c){g=!0;c=e;d=f;break}if(h===d){g=!0;d=e;c=f;break}h=h.sibling}if(!g){for(h=f.child;h;){if(h===\n\tc){g=!0;c=f;d=e;break}if(h===d){g=!0;d=f;c=e;break}h=h.sibling}if(!g)throw Error(u(189));}}if(c.alternate!==d)throw Error(u(190));}if(3!==c.tag)throw Error(u(188));return c.stateNode.current===c?a:b}function hc(a){a=gc(a);if(!a)return null;for(var b=a;;){if(5===b.tag||6===b.tag)return b;if(b.child)b.child.return=b,b=b.child;else{if(b===a)break;for(;!b.sibling;){if(!b.return||b.return===a)return null;b=b.return}b.sibling.return=b.return;b=b.sibling}}return null}\n\tfunction ic(a,b){if(null==b)throw Error(u(30));if(null==a)return b;if(Array.isArray(a)){if(Array.isArray(b))return a.push.apply(a,b),a;a.push(b);return a}return Array.isArray(b)?[a].concat(b):[a,b]}function jc(a,b,c){Array.isArray(a)?a.forEach(b,c):a&&b.call(c,a)}var kc=null;\n\tfunction lc(a){if(a){var b=a._dispatchListeners,c=a._dispatchInstances;if(Array.isArray(b))for(var d=0;d<b.length&&!a.isPropagationStopped();d++)oa(a,b[d],c[d]);else b&&oa(a,b,c);a._dispatchListeners=null;a._dispatchInstances=null;a.isPersistent()||a.constructor.release(a)}}function mc(a){null!==a&&(kc=ic(kc,a));a=kc;kc=null;if(a){jc(a,lc);if(kc)throw Error(u(95));if(fa)throw a=ha,fa=!1,ha=null,a;}}\n\tfunction nc(a){a=a.target||a.srcElement||window;a.correspondingUseElement&&(a=a.correspondingUseElement);return 3===a.nodeType?a.parentNode:a}function oc(a){if(!ya)return!1;a=\"on\"+a;var b=a in document;b||(b=document.createElement(\"div\"),b.setAttribute(a,\"return;\"),b=\"function\"===typeof b[a]);return b}var pc=[];function qc(a){a.topLevelType=null;a.nativeEvent=null;a.targetInst=null;a.ancestors.length=0;10>pc.length&&pc.push(a)}\n\tfunction rc(a,b,c,d){if(pc.length){var e=pc.pop();e.topLevelType=a;e.eventSystemFlags=d;e.nativeEvent=b;e.targetInst=c;return e}return{topLevelType:a,eventSystemFlags:d,nativeEvent:b,targetInst:c,ancestors:[]}}\n\tfunction sc(a){var b=a.targetInst,c=b;do{if(!c){a.ancestors.push(c);break}var d=c;if(3===d.tag)d=d.stateNode.containerInfo;else{for(;d.return;)d=d.return;d=3!==d.tag?null:d.stateNode.containerInfo}if(!d)break;b=c.tag;5!==b&&6!==b||a.ancestors.push(c);c=tc(d)}while(c);for(c=0;c<a.ancestors.length;c++){b=a.ancestors[c];var e=nc(a.nativeEvent);d=a.topLevelType;var f=a.nativeEvent,g=a.eventSystemFlags;0===c&&(g|=64);for(var h=null,k=0;k<sa.length;k++){var l=sa[k];l&&(l=l.extractEvents(d,b,f,e,g))&&(h=\n\tic(h,l))}mc(h)}}function uc(a,b,c){if(!c.has(a)){switch(a){case \"scroll\":vc(b,\"scroll\",!0);break;case \"focus\":case \"blur\":vc(b,\"focus\",!0);vc(b,\"blur\",!0);c.set(\"blur\",null);c.set(\"focus\",null);break;case \"cancel\":case \"close\":oc(a)&&vc(b,a,!0);break;case \"invalid\":case \"submit\":case \"reset\":break;default:-1===ac.indexOf(a)&&F(a,b)}c.set(a,null)}}\n\tvar wc,xc,yc,zc=!1,Ac=[],Bc=null,Cc=null,Dc=null,Ec=new Map,Fc=new Map,Gc=[],Hc=\"mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput close cancel copy cut paste click change contextmenu reset submit\".split(\" \"),Ic=\"focus blur dragenter dragleave mouseover mouseout pointerover pointerout gotpointercapture lostpointercapture\".split(\" \");\n\tfunction Jc(a,b){var c=cc(b);Hc.forEach(function(a){uc(a,b,c)});Ic.forEach(function(a){uc(a,b,c)})}function Kc(a,b,c,d,e){return{blockedOn:a,topLevelType:b,eventSystemFlags:c|32,nativeEvent:e,container:d}}\n\tfunction Lc(a,b){switch(a){case \"focus\":case \"blur\":Bc=null;break;case \"dragenter\":case \"dragleave\":Cc=null;break;case \"mouseover\":case \"mouseout\":Dc=null;break;case \"pointerover\":case \"pointerout\":Ec.delete(b.pointerId);break;case \"gotpointercapture\":case \"lostpointercapture\":Fc.delete(b.pointerId)}}function Mc(a,b,c,d,e,f){if(null===a||a.nativeEvent!==f)return a=Kc(b,c,d,e,f),null!==b&&(b=Nc(b),null!==b&&xc(b)),a;a.eventSystemFlags|=d;return a}\n\tfunction Oc(a,b,c,d,e){switch(b){case \"focus\":return Bc=Mc(Bc,a,b,c,d,e),!0;case \"dragenter\":return Cc=Mc(Cc,a,b,c,d,e),!0;case \"mouseover\":return Dc=Mc(Dc,a,b,c,d,e),!0;case \"pointerover\":var f=e.pointerId;Ec.set(f,Mc(Ec.get(f)||null,a,b,c,d,e));return!0;case \"gotpointercapture\":return f=e.pointerId,Fc.set(f,Mc(Fc.get(f)||null,a,b,c,d,e)),!0}return!1}\n\tfunction Pc(a){var b=tc(a.target);if(null!==b){var c=dc(b);if(null!==c)if(b=c.tag,13===b){if(b=ec(c),null!==b){a.blockedOn=b;r.unstable_runWithPriority(a.priority,function(){yc(c)});return}}else if(3===b&&c.stateNode.hydrate){a.blockedOn=3===c.tag?c.stateNode.containerInfo:null;return}}a.blockedOn=null}function Qc(a){if(null!==a.blockedOn)return!1;var b=Rc(a.topLevelType,a.eventSystemFlags,a.container,a.nativeEvent);if(null!==b){var c=Nc(b);null!==c&&xc(c);a.blockedOn=b;return!1}return!0}\n\tfunction Sc(a,b,c){Qc(a)&&c.delete(b)}function Tc(){for(zc=!1;0<Ac.length;){var a=Ac[0];if(null!==a.blockedOn){a=Nc(a.blockedOn);null!==a&&wc(a);break}var b=Rc(a.topLevelType,a.eventSystemFlags,a.container,a.nativeEvent);null!==b?a.blockedOn=b:Ac.shift()}null!==Bc&&Qc(Bc)&&(Bc=null);null!==Cc&&Qc(Cc)&&(Cc=null);null!==Dc&&Qc(Dc)&&(Dc=null);Ec.forEach(Sc);Fc.forEach(Sc)}function Uc(a,b){a.blockedOn===b&&(a.blockedOn=null,zc||(zc=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,Tc)))}\n\tfunction Vc(a){function b(b){return Uc(b,a)}if(0<Ac.length){Uc(Ac[0],a);for(var c=1;c<Ac.length;c++){var d=Ac[c];d.blockedOn===a&&(d.blockedOn=null)}}null!==Bc&&Uc(Bc,a);null!==Cc&&Uc(Cc,a);null!==Dc&&Uc(Dc,a);Ec.forEach(b);Fc.forEach(b);for(c=0;c<Gc.length;c++)d=Gc[c],d.blockedOn===a&&(d.blockedOn=null);for(;0<Gc.length&&(c=Gc[0],null===c.blockedOn);)Pc(c),null===c.blockedOn&&Gc.shift()}\n\tvar Wc={},Yc=new Map,Zc=new Map,$c=[\"abort\",\"abort\",Xb,\"animationEnd\",Yb,\"animationIteration\",Zb,\"animationStart\",\"canplay\",\"canPlay\",\"canplaythrough\",\"canPlayThrough\",\"durationchange\",\"durationChange\",\"emptied\",\"emptied\",\"encrypted\",\"encrypted\",\"ended\",\"ended\",\"error\",\"error\",\"gotpointercapture\",\"gotPointerCapture\",\"load\",\"load\",\"loadeddata\",\"loadedData\",\"loadedmetadata\",\"loadedMetadata\",\"loadstart\",\"loadStart\",\"lostpointercapture\",\"lostPointerCapture\",\"playing\",\"playing\",\"progress\",\"progress\",\"seeking\",\n\t\"seeking\",\"stalled\",\"stalled\",\"suspend\",\"suspend\",\"timeupdate\",\"timeUpdate\",$b,\"transitionEnd\",\"waiting\",\"waiting\"];function ad(a,b){for(var c=0;c<a.length;c+=2){var d=a[c],e=a[c+1],f=\"on\"+(e[0].toUpperCase()+e.slice(1));f={phasedRegistrationNames:{bubbled:f,captured:f+\"Capture\"},dependencies:[d],eventPriority:b};Zc.set(d,b);Yc.set(d,f);Wc[e]=f}}\n\tad(\"blur blur cancel cancel click click close close contextmenu contextMenu copy copy cut cut auxclick auxClick dblclick doubleClick dragend dragEnd dragstart dragStart drop drop focus focus input input invalid invalid keydown keyDown keypress keyPress keyup keyUp mousedown mouseDown mouseup mouseUp paste paste pause pause play play pointercancel pointerCancel pointerdown pointerDown pointerup pointerUp ratechange rateChange reset reset seeked seeked submit submit touchcancel touchCancel touchend touchEnd touchstart touchStart volumechange volumeChange\".split(\" \"),0);\n\tad(\"drag drag dragenter dragEnter dragexit dragExit dragleave dragLeave dragover dragOver mousemove mouseMove mouseout mouseOut mouseover mouseOver pointermove pointerMove pointerout pointerOut pointerover pointerOver scroll scroll toggle toggle touchmove touchMove wheel wheel\".split(\" \"),1);ad($c,2);for(var bd=\"change selectionchange textInput compositionstart compositionend compositionupdate\".split(\" \"),cd=0;cd<bd.length;cd++)Zc.set(bd[cd],0);\n\tvar dd=r.unstable_UserBlockingPriority,ed=r.unstable_runWithPriority,fd=!0;function F(a,b){vc(b,a,!1)}function vc(a,b,c){var d=Zc.get(b);switch(void 0===d?2:d){case 0:d=gd.bind(null,b,1,a);break;case 1:d=hd.bind(null,b,1,a);break;default:d=id.bind(null,b,1,a)}c?a.addEventListener(b,d,!0):a.addEventListener(b,d,!1)}function gd(a,b,c,d){Ja||Ha();var e=id,f=Ja;Ja=!0;try{Ga(e,a,b,c,d)}finally{(Ja=f)||La()}}function hd(a,b,c,d){ed(dd,id.bind(null,a,b,c,d))}\n\tfunction id(a,b,c,d){if(fd)if(0<Ac.length&&-1<Hc.indexOf(a))a=Kc(null,a,b,c,d),Ac.push(a);else{var e=Rc(a,b,c,d);if(null===e)Lc(a,d);else if(-1<Hc.indexOf(a))a=Kc(e,a,b,c,d),Ac.push(a);else if(!Oc(e,a,b,c,d)){Lc(a,d);a=rc(a,d,null,b);try{Ma(sc,a)}finally{qc(a)}}}}\n\tfunction Rc(a,b,c,d){c=nc(d);c=tc(c);if(null!==c){var e=dc(c);if(null===e)c=null;else{var f=e.tag;if(13===f){c=ec(e);if(null!==c)return c;c=null}else if(3===f){if(e.stateNode.hydrate)return 3===e.tag?e.stateNode.containerInfo:null;c=null}else e!==c&&(c=null)}}a=rc(a,d,c,b);try{Ma(sc,a)}finally{qc(a)}return null}\n\tvar jd={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,\n\tfloodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},kd=[\"Webkit\",\"ms\",\"Moz\",\"O\"];Object.keys(jd).forEach(function(a){kd.forEach(function(b){b=b+a.charAt(0).toUpperCase()+a.substring(1);jd[b]=jd[a]})});function ld(a,b,c){return null==b||\"boolean\"===typeof b||\"\"===b?\"\":c||\"number\"!==typeof b||0===b||jd.hasOwnProperty(a)&&jd[a]?(\"\"+b).trim():b+\"px\"}\n\tfunction md(a,b){a=a.style;for(var c in b)if(b.hasOwnProperty(c)){var d=0===c.indexOf(\"--\"),e=ld(c,b[c],d);\"float\"===c&&(c=\"cssFloat\");d?a.setProperty(c,e):a[c]=e}}var nd=n({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});\n\tfunction od(a,b){if(b){if(nd[a]&&(null!=b.children||null!=b.dangerouslySetInnerHTML))throw Error(u(137,a,\"\"));if(null!=b.dangerouslySetInnerHTML){if(null!=b.children)throw Error(u(60));if(!(\"object\"===typeof b.dangerouslySetInnerHTML&&\"__html\"in b.dangerouslySetInnerHTML))throw Error(u(61));}if(null!=b.style&&\"object\"!==typeof b.style)throw Error(u(62,\"\"));}}\n\tfunction pd(a,b){if(-1===a.indexOf(\"-\"))return\"string\"===typeof b.is;switch(a){case \"annotation-xml\":case \"color-profile\":case \"font-face\":case \"font-face-src\":case \"font-face-uri\":case \"font-face-format\":case \"font-face-name\":case \"missing-glyph\":return!1;default:return!0}}var qd=Mb.html;function rd(a,b){a=9===a.nodeType||11===a.nodeType?a:a.ownerDocument;var c=cc(a);b=wa[b];for(var d=0;d<b.length;d++)uc(b[d],a,c)}function sd(){}\n\tfunction td(a){a=a||(\"undefined\"!==typeof document?document:void 0);if(\"undefined\"===typeof a)return null;try{return a.activeElement||a.body}catch(b){return a.body}}function ud(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function vd(a,b){var c=ud(a);a=0;for(var d;c;){if(3===c.nodeType){d=a+c.textContent.length;if(a<=b&&d>=b)return{node:c,offset:b-a};a=d}a:{for(;c;){if(c.nextSibling){c=c.nextSibling;break a}c=c.parentNode}c=void 0}c=ud(c)}}\n\tfunction wd(a,b){return a&&b?a===b?!0:a&&3===a.nodeType?!1:b&&3===b.nodeType?wd(a,b.parentNode):\"contains\"in a?a.contains(b):a.compareDocumentPosition?!!(a.compareDocumentPosition(b)&16):!1:!1}function xd(){for(var a=window,b=td();b instanceof a.HTMLIFrameElement;){try{var c=\"string\"===typeof b.contentWindow.location.href}catch(d){c=!1}if(c)a=b.contentWindow;else break;b=td(a.document)}return b}\n\tfunction yd(a){var b=a&&a.nodeName&&a.nodeName.toLowerCase();return b&&(\"input\"===b&&(\"text\"===a.type||\"search\"===a.type||\"tel\"===a.type||\"url\"===a.type||\"password\"===a.type)||\"textarea\"===b||\"true\"===a.contentEditable)}var zd=\"$\",Ad=\"/$\",Bd=\"$?\",Cd=\"$!\",Dd=null,Ed=null;function Fd(a,b){switch(a){case \"button\":case \"input\":case \"select\":case \"textarea\":return!!b.autoFocus}return!1}\n\tfunction Gd(a,b){return\"textarea\"===a||\"option\"===a||\"noscript\"===a||\"string\"===typeof b.children||\"number\"===typeof b.children||\"object\"===typeof b.dangerouslySetInnerHTML&&null!==b.dangerouslySetInnerHTML&&null!=b.dangerouslySetInnerHTML.__html}var Hd=\"function\"===typeof setTimeout?setTimeout:void 0,Id=\"function\"===typeof clearTimeout?clearTimeout:void 0;function Jd(a){for(;null!=a;a=a.nextSibling){var b=a.nodeType;if(1===b||3===b)break}return a}\n\tfunction Kd(a){a=a.previousSibling;for(var b=0;a;){if(8===a.nodeType){var c=a.data;if(c===zd||c===Cd||c===Bd){if(0===b)return a;b--}else c===Ad&&b++}a=a.previousSibling}return null}var Ld=Math.random().toString(36).slice(2),Md=\"__reactInternalInstance$\"+Ld,Nd=\"__reactEventHandlers$\"+Ld,Od=\"__reactContainere$\"+Ld;\n\tfunction tc(a){var b=a[Md];if(b)return b;for(var c=a.parentNode;c;){if(b=c[Od]||c[Md]){c=b.alternate;if(null!==b.child||null!==c&&null!==c.child)for(a=Kd(a);null!==a;){if(c=a[Md])return c;a=Kd(a)}return b}a=c;c=a.parentNode}return null}function Nc(a){a=a[Md]||a[Od];return!a||5!==a.tag&&6!==a.tag&&13!==a.tag&&3!==a.tag?null:a}function Pd(a){if(5===a.tag||6===a.tag)return a.stateNode;throw Error(u(33));}function Qd(a){return a[Nd]||null}\n\tfunction Rd(a){do a=a.return;while(a&&5!==a.tag);return a?a:null}\n\tfunction Sd(a,b){var c=a.stateNode;if(!c)return null;var d=la(c);if(!d)return null;c=d[b];a:switch(b){case \"onClick\":case \"onClickCapture\":case \"onDoubleClick\":case \"onDoubleClickCapture\":case \"onMouseDown\":case \"onMouseDownCapture\":case \"onMouseMove\":case \"onMouseMoveCapture\":case \"onMouseUp\":case \"onMouseUpCapture\":case \"onMouseEnter\":(d=!d.disabled)||(a=a.type,d=!(\"button\"===a||\"input\"===a||\"select\"===a||\"textarea\"===a));a=!d;break a;default:a=!1}if(a)return null;if(c&&\"function\"!==typeof c)throw Error(u(231,\n\tb,typeof c));return c}function Td(a,b,c){if(b=Sd(a,c.dispatchConfig.phasedRegistrationNames[b]))c._dispatchListeners=ic(c._dispatchListeners,b),c._dispatchInstances=ic(c._dispatchInstances,a)}function Ud(a){if(a&&a.dispatchConfig.phasedRegistrationNames){for(var b=a._targetInst,c=[];b;)c.push(b),b=Rd(b);for(b=c.length;0<b--;)Td(c[b],\"captured\",a);for(b=0;b<c.length;b++)Td(c[b],\"bubbled\",a)}}\n\tfunction Vd(a,b,c){a&&c&&c.dispatchConfig.registrationName&&(b=Sd(a,c.dispatchConfig.registrationName))&&(c._dispatchListeners=ic(c._dispatchListeners,b),c._dispatchInstances=ic(c._dispatchInstances,a))}function Wd(a){a&&a.dispatchConfig.registrationName&&Vd(a._targetInst,null,a)}function Xd(a){jc(a,Ud)}var Yd=null,Zd=null,$d=null;\n\tfunction ae(){if($d)return $d;var a,b=Zd,c=b.length,d,e=\"value\"in Yd?Yd.value:Yd.textContent,f=e.length;for(a=0;a<c&&b[a]===e[a];a++);var g=c-a;for(d=1;d<=g&&b[c-d]===e[f-d];d++);return $d=e.slice(a,1<d?1-d:void 0)}function be(){return!0}function ce(){return!1}\n\tfunction G(a,b,c,d){this.dispatchConfig=a;this._targetInst=b;this.nativeEvent=c;a=this.constructor.Interface;for(var e in a)a.hasOwnProperty(e)&&((b=a[e])?this[e]=b(c):\"target\"===e?this.target=d:this[e]=c[e]);this.isDefaultPrevented=(null!=c.defaultPrevented?c.defaultPrevented:!1===c.returnValue)?be:ce;this.isPropagationStopped=ce;return this}\n\tn(G.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():\"unknown\"!==typeof a.returnValue&&(a.returnValue=!1),this.isDefaultPrevented=be)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():\"unknown\"!==typeof a.cancelBubble&&(a.cancelBubble=!0),this.isPropagationStopped=be)},persist:function(){this.isPersistent=be},isPersistent:ce,destructor:function(){var a=this.constructor.Interface,\n\tb;for(b in a)this[b]=null;this.nativeEvent=this._targetInst=this.dispatchConfig=null;this.isPropagationStopped=this.isDefaultPrevented=ce;this._dispatchInstances=this._dispatchListeners=null}});G.Interface={type:null,target:null,currentTarget:function(){return null},eventPhase:null,bubbles:null,cancelable:null,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:null,isTrusted:null};\n\tG.extend=function(a){function b(){}function c(){return d.apply(this,arguments)}var d=this;b.prototype=d.prototype;var e=new b;n(e,c.prototype);c.prototype=e;c.prototype.constructor=c;c.Interface=n({},d.Interface,a);c.extend=d.extend;de(c);return c};de(G);function ee(a,b,c,d){if(this.eventPool.length){var e=this.eventPool.pop();this.call(e,a,b,c,d);return e}return new this(a,b,c,d)}\n\tfunction fe(a){if(!(a instanceof this))throw Error(u(279));a.destructor();10>this.eventPool.length&&this.eventPool.push(a)}function de(a){a.eventPool=[];a.getPooled=ee;a.release=fe}var ge=G.extend({data:null}),he=G.extend({data:null}),ie=[9,13,27,32],je=ya&&\"CompositionEvent\"in window,ke=null;ya&&\"documentMode\"in document&&(ke=document.documentMode);\n\tvar le=ya&&\"TextEvent\"in window&&!ke,me=ya&&(!je||ke&&8<ke&&11>=ke),ne=String.fromCharCode(32),oe={beforeInput:{phasedRegistrationNames:{bubbled:\"onBeforeInput\",captured:\"onBeforeInputCapture\"},dependencies:[\"compositionend\",\"keypress\",\"textInput\",\"paste\"]},compositionEnd:{phasedRegistrationNames:{bubbled:\"onCompositionEnd\",captured:\"onCompositionEndCapture\"},dependencies:\"blur compositionend keydown keypress keyup mousedown\".split(\" \")},compositionStart:{phasedRegistrationNames:{bubbled:\"onCompositionStart\",\n\tcaptured:\"onCompositionStartCapture\"},dependencies:\"blur compositionstart keydown keypress keyup mousedown\".split(\" \")},compositionUpdate:{phasedRegistrationNames:{bubbled:\"onCompositionUpdate\",captured:\"onCompositionUpdateCapture\"},dependencies:\"blur compositionupdate keydown keypress keyup mousedown\".split(\" \")}},pe=!1;\n\tfunction qe(a,b){switch(a){case \"keyup\":return-1!==ie.indexOf(b.keyCode);case \"keydown\":return 229!==b.keyCode;case \"keypress\":case \"mousedown\":case \"blur\":return!0;default:return!1}}function re(a){a=a.detail;return\"object\"===typeof a&&\"data\"in a?a.data:null}var se=!1;function te(a,b){switch(a){case \"compositionend\":return re(b);case \"keypress\":if(32!==b.which)return null;pe=!0;return ne;case \"textInput\":return a=b.data,a===ne&&pe?null:a;default:return null}}\n\tfunction ue(a,b){if(se)return\"compositionend\"===a||!je&&qe(a,b)?(a=ae(),$d=Zd=Yd=null,se=!1,a):null;switch(a){case \"paste\":return null;case \"keypress\":if(!(b.ctrlKey||b.altKey||b.metaKey)||b.ctrlKey&&b.altKey){if(b.char&&1<b.char.length)return b.char;if(b.which)return String.fromCharCode(b.which)}return null;case \"compositionend\":return me&&\"ko\"!==b.locale?null:b.data;default:return null}}\n\tvar ve={eventTypes:oe,extractEvents:function(a,b,c,d){var e;if(je)b:{switch(a){case \"compositionstart\":var f=oe.compositionStart;break b;case \"compositionend\":f=oe.compositionEnd;break b;case \"compositionupdate\":f=oe.compositionUpdate;break b}f=void 0}else se?qe(a,c)&&(f=oe.compositionEnd):\"keydown\"===a&&229===c.keyCode&&(f=oe.compositionStart);f?(me&&\"ko\"!==c.locale&&(se||f!==oe.compositionStart?f===oe.compositionEnd&&se&&(e=ae()):(Yd=d,Zd=\"value\"in Yd?Yd.value:Yd.textContent,se=!0)),f=ge.getPooled(f,\n\tb,c,d),e?f.data=e:(e=re(c),null!==e&&(f.data=e)),Xd(f),e=f):e=null;(a=le?te(a,c):ue(a,c))?(b=he.getPooled(oe.beforeInput,b,c,d),b.data=a,Xd(b)):b=null;return null===e?b:null===b?e:[e,b]}},we={color:!0,date:!0,datetime:!0,\"datetime-local\":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function xe(a){var b=a&&a.nodeName&&a.nodeName.toLowerCase();return\"input\"===b?!!we[a.type]:\"textarea\"===b?!0:!1}\n\tvar ye={change:{phasedRegistrationNames:{bubbled:\"onChange\",captured:\"onChangeCapture\"},dependencies:\"blur change click focus input keydown keyup selectionchange\".split(\" \")}};function ze(a,b,c){a=G.getPooled(ye.change,a,b,c);a.type=\"change\";Da(c);Xd(a);return a}var Ae=null,Be=null;function Ce(a){mc(a)}function De(a){var b=Pd(a);if(yb(b))return a}function Ee(a,b){if(\"change\"===a)return b}var Fe=!1;ya&&(Fe=oc(\"input\")&&(!document.documentMode||9<document.documentMode));\n\tfunction Ge(){Ae&&(Ae.detachEvent(\"onpropertychange\",He),Be=Ae=null)}function He(a){if(\"value\"===a.propertyName&&De(Be))if(a=ze(Be,a,nc(a)),Ja)mc(a);else{Ja=!0;try{Fa(Ce,a)}finally{Ja=!1,La()}}}function Ie(a,b,c){\"focus\"===a?(Ge(),Ae=b,Be=c,Ae.attachEvent(\"onpropertychange\",He)):\"blur\"===a&&Ge()}function Je(a){if(\"selectionchange\"===a||\"keyup\"===a||\"keydown\"===a)return De(Be)}function Ke(a,b){if(\"click\"===a)return De(b)}function Le(a,b){if(\"input\"===a||\"change\"===a)return De(b)}\n\tvar Me={eventTypes:ye,_isInputEventSupported:Fe,extractEvents:function(a,b,c,d){var e=b?Pd(b):window,f=e.nodeName&&e.nodeName.toLowerCase();if(\"select\"===f||\"input\"===f&&\"file\"===e.type)var g=Ee;else if(xe(e))if(Fe)g=Le;else{g=Je;var h=Ie}else(f=e.nodeName)&&\"input\"===f.toLowerCase()&&(\"checkbox\"===e.type||\"radio\"===e.type)&&(g=Ke);if(g&&(g=g(a,b)))return ze(g,c,d);h&&h(a,e,b);\"blur\"===a&&(a=e._wrapperState)&&a.controlled&&\"number\"===e.type&&Db(e,\"number\",e.value)}},Ne=G.extend({view:null,detail:null}),\n\tOe={Alt:\"altKey\",Control:\"ctrlKey\",Meta:\"metaKey\",Shift:\"shiftKey\"};function Pe(a){var b=this.nativeEvent;return b.getModifierState?b.getModifierState(a):(a=Oe[a])?!!b[a]:!1}function Qe(){return Pe}\n\tvar Re=0,Se=0,Te=!1,Ue=!1,Ve=Ne.extend({screenX:null,screenY:null,clientX:null,clientY:null,pageX:null,pageY:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,getModifierState:Qe,button:null,buttons:null,relatedTarget:function(a){return a.relatedTarget||(a.fromElement===a.srcElement?a.toElement:a.fromElement)},movementX:function(a){if(\"movementX\"in a)return a.movementX;var b=Re;Re=a.screenX;return Te?\"mousemove\"===a.type?a.screenX-b:0:(Te=!0,0)},movementY:function(a){if(\"movementY\"in a)return a.movementY;\n\tvar b=Se;Se=a.screenY;return Ue?\"mousemove\"===a.type?a.screenY-b:0:(Ue=!0,0)}}),We=Ve.extend({pointerId:null,width:null,height:null,pressure:null,tangentialPressure:null,tiltX:null,tiltY:null,twist:null,pointerType:null,isPrimary:null}),Xe={mouseEnter:{registrationName:\"onMouseEnter\",dependencies:[\"mouseout\",\"mouseover\"]},mouseLeave:{registrationName:\"onMouseLeave\",dependencies:[\"mouseout\",\"mouseover\"]},pointerEnter:{registrationName:\"onPointerEnter\",dependencies:[\"pointerout\",\"pointerover\"]},pointerLeave:{registrationName:\"onPointerLeave\",\n\tdependencies:[\"pointerout\",\"pointerover\"]}},Ye={eventTypes:Xe,extractEvents:function(a,b,c,d,e){var f=\"mouseover\"===a||\"pointerover\"===a,g=\"mouseout\"===a||\"pointerout\"===a;if(f&&0===(e&32)&&(c.relatedTarget||c.fromElement)||!g&&!f)return null;f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window;if(g){if(g=b,b=(b=c.relatedTarget||c.toElement)?tc(b):null,null!==b){var h=dc(b);if(b!==h||5!==b.tag&&6!==b.tag)b=null}}else g=null;if(g===b)return null;if(\"mouseout\"===a||\"mouseover\"===\n\ta){var k=Ve;var l=Xe.mouseLeave;var m=Xe.mouseEnter;var p=\"mouse\"}else if(\"pointerout\"===a||\"pointerover\"===a)k=We,l=Xe.pointerLeave,m=Xe.pointerEnter,p=\"pointer\";a=null==g?f:Pd(g);f=null==b?f:Pd(b);l=k.getPooled(l,g,c,d);l.type=p+\"leave\";l.target=a;l.relatedTarget=f;c=k.getPooled(m,b,c,d);c.type=p+\"enter\";c.target=f;c.relatedTarget=a;d=g;p=b;if(d&&p)a:{k=d;m=p;g=0;for(a=k;a;a=Rd(a))g++;a=0;for(b=m;b;b=Rd(b))a++;for(;0<g-a;)k=Rd(k),g--;for(;0<a-g;)m=Rd(m),a--;for(;g--;){if(k===m||k===m.alternate)break a;\n\tk=Rd(k);m=Rd(m)}k=null}else k=null;m=k;for(k=[];d&&d!==m;){g=d.alternate;if(null!==g&&g===m)break;k.push(d);d=Rd(d)}for(d=[];p&&p!==m;){g=p.alternate;if(null!==g&&g===m)break;d.push(p);p=Rd(p)}for(p=0;p<k.length;p++)Vd(k[p],\"bubbled\",l);for(p=d.length;0<p--;)Vd(d[p],\"captured\",c);return 0===(e&64)?[l]:[l,c]}};function Ze(a,b){return a===b&&(0!==a||1/a===1/b)||a!==a&&b!==b}var $e=\"function\"===typeof Object.is?Object.is:Ze,af=Object.prototype.hasOwnProperty;\n\tfunction bf(a,b){if($e(a,b))return!0;if(\"object\"!==typeof a||null===a||\"object\"!==typeof b||null===b)return!1;var c=Object.keys(a),d=Object.keys(b);if(c.length!==d.length)return!1;for(d=0;d<c.length;d++)if(!af.call(b,c[d])||!$e(a[c[d]],b[c[d]]))return!1;return!0}\n\tvar cf=ya&&\"documentMode\"in document&&11>=document.documentMode,df={select:{phasedRegistrationNames:{bubbled:\"onSelect\",captured:\"onSelectCapture\"},dependencies:\"blur contextmenu dragend focus keydown keyup mousedown mouseup selectionchange\".split(\" \")}},ef=null,ff=null,gf=null,hf=!1;\n\tfunction jf(a,b){var c=b.window===b?b.document:9===b.nodeType?b:b.ownerDocument;if(hf||null==ef||ef!==td(c))return null;c=ef;\"selectionStart\"in c&&yd(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset});return gf&&bf(gf,c)?null:(gf=c,a=G.getPooled(df.select,ff,a,b),a.type=\"select\",a.target=ef,Xd(a),a)}\n\tvar kf={eventTypes:df,extractEvents:function(a,b,c,d,e,f){e=f||(d.window===d?d.document:9===d.nodeType?d:d.ownerDocument);if(!(f=!e)){a:{e=cc(e);f=wa.onSelect;for(var g=0;g<f.length;g++)if(!e.has(f[g])){e=!1;break a}e=!0}f=!e}if(f)return null;e=b?Pd(b):window;switch(a){case \"focus\":if(xe(e)||\"true\"===e.contentEditable)ef=e,ff=b,gf=null;break;case \"blur\":gf=ff=ef=null;break;case \"mousedown\":hf=!0;break;case \"contextmenu\":case \"mouseup\":case \"dragend\":return hf=!1,jf(c,d);case \"selectionchange\":if(cf)break;\n\tcase \"keydown\":case \"keyup\":return jf(c,d)}return null}},lf=G.extend({animationName:null,elapsedTime:null,pseudoElement:null}),mf=G.extend({clipboardData:function(a){return\"clipboardData\"in a?a.clipboardData:window.clipboardData}}),nf=Ne.extend({relatedTarget:null});function of(a){var b=a.keyCode;\"charCode\"in a?(a=a.charCode,0===a&&13===b&&(a=13)):a=b;10===a&&(a=13);return 32<=a||13===a?a:0}\n\tvar pf={Esc:\"Escape\",Spacebar:\" \",Left:\"ArrowLeft\",Up:\"ArrowUp\",Right:\"ArrowRight\",Down:\"ArrowDown\",Del:\"Delete\",Win:\"OS\",Menu:\"ContextMenu\",Apps:\"ContextMenu\",Scroll:\"ScrollLock\",MozPrintableKey:\"Unidentified\"},qf={8:\"Backspace\",9:\"Tab\",12:\"Clear\",13:\"Enter\",16:\"Shift\",17:\"Control\",18:\"Alt\",19:\"Pause\",20:\"CapsLock\",27:\"Escape\",32:\" \",33:\"PageUp\",34:\"PageDown\",35:\"End\",36:\"Home\",37:\"ArrowLeft\",38:\"ArrowUp\",39:\"ArrowRight\",40:\"ArrowDown\",45:\"Insert\",46:\"Delete\",112:\"F1\",113:\"F2\",114:\"F3\",115:\"F4\",\n\t116:\"F5\",117:\"F6\",118:\"F7\",119:\"F8\",120:\"F9\",121:\"F10\",122:\"F11\",123:\"F12\",144:\"NumLock\",145:\"ScrollLock\",224:\"Meta\"},rf=Ne.extend({key:function(a){if(a.key){var b=pf[a.key]||a.key;if(\"Unidentified\"!==b)return b}return\"keypress\"===a.type?(a=of(a),13===a?\"Enter\":String.fromCharCode(a)):\"keydown\"===a.type||\"keyup\"===a.type?qf[a.keyCode]||\"Unidentified\":\"\"},location:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,repeat:null,locale:null,getModifierState:Qe,charCode:function(a){return\"keypress\"===\n\ta.type?of(a):0},keyCode:function(a){return\"keydown\"===a.type||\"keyup\"===a.type?a.keyCode:0},which:function(a){return\"keypress\"===a.type?of(a):\"keydown\"===a.type||\"keyup\"===a.type?a.keyCode:0}}),sf=Ve.extend({dataTransfer:null}),tf=Ne.extend({touches:null,targetTouches:null,changedTouches:null,altKey:null,metaKey:null,ctrlKey:null,shiftKey:null,getModifierState:Qe}),uf=G.extend({propertyName:null,elapsedTime:null,pseudoElement:null}),vf=Ve.extend({deltaX:function(a){return\"deltaX\"in a?a.deltaX:\"wheelDeltaX\"in\n\ta?-a.wheelDeltaX:0},deltaY:function(a){return\"deltaY\"in a?a.deltaY:\"wheelDeltaY\"in a?-a.wheelDeltaY:\"wheelDelta\"in a?-a.wheelDelta:0},deltaZ:null,deltaMode:null}),wf={eventTypes:Wc,extractEvents:function(a,b,c,d){var e=Yc.get(a);if(!e)return null;switch(a){case \"keypress\":if(0===of(c))return null;case \"keydown\":case \"keyup\":a=rf;break;case \"blur\":case \"focus\":a=nf;break;case \"click\":if(2===c.button)return null;case \"auxclick\":case \"dblclick\":case \"mousedown\":case \"mousemove\":case \"mouseup\":case \"mouseout\":case \"mouseover\":case \"contextmenu\":a=\n\tVe;break;case \"drag\":case \"dragend\":case \"dragenter\":case \"dragexit\":case \"dragleave\":case \"dragover\":case \"dragstart\":case \"drop\":a=sf;break;case \"touchcancel\":case \"touchend\":case \"touchmove\":case \"touchstart\":a=tf;break;case Xb:case Yb:case Zb:a=lf;break;case $b:a=uf;break;case \"scroll\":a=Ne;break;case \"wheel\":a=vf;break;case \"copy\":case \"cut\":case \"paste\":a=mf;break;case \"gotpointercapture\":case \"lostpointercapture\":case \"pointercancel\":case \"pointerdown\":case \"pointermove\":case \"pointerout\":case \"pointerover\":case \"pointerup\":a=\n\tWe;break;default:a=G}b=a.getPooled(e,b,c,d);Xd(b);return b}};if(pa)throw Error(u(101));pa=Array.prototype.slice.call(\"ResponderEventPlugin SimpleEventPlugin EnterLeaveEventPlugin ChangeEventPlugin SelectEventPlugin BeforeInputEventPlugin\".split(\" \"));ra();var xf=Nc;la=Qd;ma=xf;na=Pd;xa({SimpleEventPlugin:wf,EnterLeaveEventPlugin:Ye,ChangeEventPlugin:Me,SelectEventPlugin:kf,BeforeInputEventPlugin:ve});var yf=[],zf=-1;function H(a){0>zf||(a.current=yf[zf],yf[zf]=null,zf--)}\n\tfunction I(a,b){zf++;yf[zf]=a.current;a.current=b}var Af={},J={current:Af},K={current:!1},Bf=Af;function Cf(a,b){var c=a.type.contextTypes;if(!c)return Af;var d=a.stateNode;if(d&&d.__reactInternalMemoizedUnmaskedChildContext===b)return d.__reactInternalMemoizedMaskedChildContext;var e={},f;for(f in c)e[f]=b[f];d&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=b,a.__reactInternalMemoizedMaskedChildContext=e);return e}function L(a){a=a.childContextTypes;return null!==a&&void 0!==a}\n\tfunction Df(){H(K);H(J)}function Ef(a,b,c){if(J.current!==Af)throw Error(u(168));I(J,b);I(K,c)}function Ff(a,b,c){var d=a.stateNode;a=b.childContextTypes;if(\"function\"!==typeof d.getChildContext)return c;d=d.getChildContext();for(var e in d)if(!(e in a))throw Error(u(108,pb(b)||\"Unknown\",e));return n({},c,{},d)}function Gf(a){a=(a=a.stateNode)&&a.__reactInternalMemoizedMergedChildContext||Af;Bf=J.current;I(J,a);I(K,K.current);return!0}\n\tfunction Hf(a,b,c){var d=a.stateNode;if(!d)throw Error(u(169));c?(a=Ff(a,b,Bf),d.__reactInternalMemoizedMergedChildContext=a,H(K),H(J),I(J,a)):H(K);I(K,c)}\n\tvar If=r.unstable_runWithPriority,Jf=r.unstable_scheduleCallback,Kf=r.unstable_cancelCallback,Lf=r.unstable_requestPaint,Mf=r.unstable_now,Nf=r.unstable_getCurrentPriorityLevel,Of=r.unstable_ImmediatePriority,Pf=r.unstable_UserBlockingPriority,Qf=r.unstable_NormalPriority,Rf=r.unstable_LowPriority,Sf=r.unstable_IdlePriority,Tf={},Uf=r.unstable_shouldYield,Vf=void 0!==Lf?Lf:function(){},Wf=null,Xf=null,Yf=!1,Zf=Mf(),$f=1E4>Zf?Mf:function(){return Mf()-Zf};\n\tfunction ag(){switch(Nf()){case Of:return 99;case Pf:return 98;case Qf:return 97;case Rf:return 96;case Sf:return 95;default:throw Error(u(332));}}function bg(a){switch(a){case 99:return Of;case 98:return Pf;case 97:return Qf;case 96:return Rf;case 95:return Sf;default:throw Error(u(332));}}function cg(a,b){a=bg(a);return If(a,b)}function dg(a,b,c){a=bg(a);return Jf(a,b,c)}function eg(a){null===Wf?(Wf=[a],Xf=Jf(Of,fg)):Wf.push(a);return Tf}function gg(){if(null!==Xf){var a=Xf;Xf=null;Kf(a)}fg()}\n\tfunction fg(){if(!Yf&&null!==Wf){Yf=!0;var a=0;try{var b=Wf;cg(99,function(){for(;a<b.length;a++){var c=b[a];do c=c(!0);while(null!==c)}});Wf=null}catch(c){throw null!==Wf&&(Wf=Wf.slice(a+1)),Jf(Of,gg),c;}finally{Yf=!1}}}function hg(a,b,c){c/=10;return 1073741821-(((1073741821-a+b/10)/c|0)+1)*c}function ig(a,b){if(a&&a.defaultProps){b=n({},b);a=a.defaultProps;for(var c in a)void 0===b[c]&&(b[c]=a[c])}return b}var jg={current:null},kg=null,lg=null,mg=null;function ng(){mg=lg=kg=null}\n\tfunction og(a){var b=jg.current;H(jg);a.type._context._currentValue=b}function pg(a,b){for(;null!==a;){var c=a.alternate;if(a.childExpirationTime<b)a.childExpirationTime=b,null!==c&&c.childExpirationTime<b&&(c.childExpirationTime=b);else if(null!==c&&c.childExpirationTime<b)c.childExpirationTime=b;else break;a=a.return}}function qg(a,b){kg=a;mg=lg=null;a=a.dependencies;null!==a&&null!==a.firstContext&&(a.expirationTime>=b&&(rg=!0),a.firstContext=null)}\n\tfunction sg(a,b){if(mg!==a&&!1!==b&&0!==b){if(\"number\"!==typeof b||1073741823===b)mg=a,b=1073741823;b={context:a,observedBits:b,next:null};if(null===lg){if(null===kg)throw Error(u(308));lg=b;kg.dependencies={expirationTime:0,firstContext:b,responders:null}}else lg=lg.next=b}return a._currentValue}var tg=!1;function ug(a){a.updateQueue={baseState:a.memoizedState,baseQueue:null,shared:{pending:null},effects:null}}\n\tfunction vg(a,b){a=a.updateQueue;b.updateQueue===a&&(b.updateQueue={baseState:a.baseState,baseQueue:a.baseQueue,shared:a.shared,effects:a.effects})}function wg(a,b){a={expirationTime:a,suspenseConfig:b,tag:0,payload:null,callback:null,next:null};return a.next=a}function xg(a,b){a=a.updateQueue;if(null!==a){a=a.shared;var c=a.pending;null===c?b.next=b:(b.next=c.next,c.next=b);a.pending=b}}\n\tfunction yg(a,b){var c=a.alternate;null!==c&&vg(c,a);a=a.updateQueue;c=a.baseQueue;null===c?(a.baseQueue=b.next=b,b.next=b):(b.next=c.next,c.next=b)}\n\tfunction zg(a,b,c,d){var e=a.updateQueue;tg=!1;var f=e.baseQueue,g=e.shared.pending;if(null!==g){if(null!==f){var h=f.next;f.next=g.next;g.next=h}f=g;e.shared.pending=null;h=a.alternate;null!==h&&(h=h.updateQueue,null!==h&&(h.baseQueue=g))}if(null!==f){h=f.next;var k=e.baseState,l=0,m=null,p=null,x=null;if(null!==h){var z=h;do{g=z.expirationTime;if(g<d){var ca={expirationTime:z.expirationTime,suspenseConfig:z.suspenseConfig,tag:z.tag,payload:z.payload,callback:z.callback,next:null};null===x?(p=x=\n\tca,m=k):x=x.next=ca;g>l&&(l=g)}else{null!==x&&(x=x.next={expirationTime:1073741823,suspenseConfig:z.suspenseConfig,tag:z.tag,payload:z.payload,callback:z.callback,next:null});Ag(g,z.suspenseConfig);a:{var D=a,t=z;g=b;ca=c;switch(t.tag){case 1:D=t.payload;if(\"function\"===typeof D){k=D.call(ca,k,g);break a}k=D;break a;case 3:D.effectTag=D.effectTag&-4097|64;case 0:D=t.payload;g=\"function\"===typeof D?D.call(ca,k,g):D;if(null===g||void 0===g)break a;k=n({},k,g);break a;case 2:tg=!0}}null!==z.callback&&\n\t(a.effectTag|=32,g=e.effects,null===g?e.effects=[z]:g.push(z))}z=z.next;if(null===z||z===h)if(g=e.shared.pending,null===g)break;else z=f.next=g.next,g.next=h,e.baseQueue=f=g,e.shared.pending=null}while(1)}null===x?m=k:x.next=p;e.baseState=m;e.baseQueue=x;Bg(l);a.expirationTime=l;a.memoizedState=k}}\n\tfunction Cg(a,b,c){a=b.effects;b.effects=null;if(null!==a)for(b=0;b<a.length;b++){var d=a[b],e=d.callback;if(null!==e){d.callback=null;d=e;e=c;if(\"function\"!==typeof d)throw Error(u(191,d));d.call(e)}}}var Dg=Wa.ReactCurrentBatchConfig,Eg=(new aa.Component).refs;function Fg(a,b,c,d){b=a.memoizedState;c=c(d,b);c=null===c||void 0===c?b:n({},b,c);a.memoizedState=c;0===a.expirationTime&&(a.updateQueue.baseState=c)}\n\tvar Jg={isMounted:function(a){return(a=a._reactInternalFiber)?dc(a)===a:!1},enqueueSetState:function(a,b,c){a=a._reactInternalFiber;var d=Gg(),e=Dg.suspense;d=Hg(d,a,e);e=wg(d,e);e.payload=b;void 0!==c&&null!==c&&(e.callback=c);xg(a,e);Ig(a,d)},enqueueReplaceState:function(a,b,c){a=a._reactInternalFiber;var d=Gg(),e=Dg.suspense;d=Hg(d,a,e);e=wg(d,e);e.tag=1;e.payload=b;void 0!==c&&null!==c&&(e.callback=c);xg(a,e);Ig(a,d)},enqueueForceUpdate:function(a,b){a=a._reactInternalFiber;var c=Gg(),d=Dg.suspense;\n\tc=Hg(c,a,d);d=wg(c,d);d.tag=2;void 0!==b&&null!==b&&(d.callback=b);xg(a,d);Ig(a,c)}};function Kg(a,b,c,d,e,f,g){a=a.stateNode;return\"function\"===typeof a.shouldComponentUpdate?a.shouldComponentUpdate(d,f,g):b.prototype&&b.prototype.isPureReactComponent?!bf(c,d)||!bf(e,f):!0}\n\tfunction Lg(a,b,c){var d=!1,e=Af;var f=b.contextType;\"object\"===typeof f&&null!==f?f=sg(f):(e=L(b)?Bf:J.current,d=b.contextTypes,f=(d=null!==d&&void 0!==d)?Cf(a,e):Af);b=new b(c,f);a.memoizedState=null!==b.state&&void 0!==b.state?b.state:null;b.updater=Jg;a.stateNode=b;b._reactInternalFiber=a;d&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=e,a.__reactInternalMemoizedMaskedChildContext=f);return b}\n\tfunction Mg(a,b,c,d){a=b.state;\"function\"===typeof b.componentWillReceiveProps&&b.componentWillReceiveProps(c,d);\"function\"===typeof b.UNSAFE_componentWillReceiveProps&&b.UNSAFE_componentWillReceiveProps(c,d);b.state!==a&&Jg.enqueueReplaceState(b,b.state,null)}\n\tfunction Ng(a,b,c,d){var e=a.stateNode;e.props=c;e.state=a.memoizedState;e.refs=Eg;ug(a);var f=b.contextType;\"object\"===typeof f&&null!==f?e.context=sg(f):(f=L(b)?Bf:J.current,e.context=Cf(a,f));zg(a,c,e,d);e.state=a.memoizedState;f=b.getDerivedStateFromProps;\"function\"===typeof f&&(Fg(a,b,f,c),e.state=a.memoizedState);\"function\"===typeof b.getDerivedStateFromProps||\"function\"===typeof e.getSnapshotBeforeUpdate||\"function\"!==typeof e.UNSAFE_componentWillMount&&\"function\"!==typeof e.componentWillMount||\n\t(b=e.state,\"function\"===typeof e.componentWillMount&&e.componentWillMount(),\"function\"===typeof e.UNSAFE_componentWillMount&&e.UNSAFE_componentWillMount(),b!==e.state&&Jg.enqueueReplaceState(e,e.state,null),zg(a,c,e,d),e.state=a.memoizedState);\"function\"===typeof e.componentDidMount&&(a.effectTag|=4)}var Og=Array.isArray;\n\tfunction Pg(a,b,c){a=c.ref;if(null!==a&&\"function\"!==typeof a&&\"object\"!==typeof a){if(c._owner){c=c._owner;if(c){if(1!==c.tag)throw Error(u(309));var d=c.stateNode}if(!d)throw Error(u(147,a));var e=\"\"+a;if(null!==b&&null!==b.ref&&\"function\"===typeof b.ref&&b.ref._stringRef===e)return b.ref;b=function(a){var b=d.refs;b===Eg&&(b=d.refs={});null===a?delete b[e]:b[e]=a};b._stringRef=e;return b}if(\"string\"!==typeof a)throw Error(u(284));if(!c._owner)throw Error(u(290,a));}return a}\n\tfunction Qg(a,b){if(\"textarea\"!==a.type)throw Error(u(31,\"[object Object]\"===Object.prototype.toString.call(b)?\"object with keys {\"+Object.keys(b).join(\", \")+\"}\":b,\"\"));}\n\tfunction Rg(a){function b(b,c){if(a){var d=b.lastEffect;null!==d?(d.nextEffect=c,b.lastEffect=c):b.firstEffect=b.lastEffect=c;c.nextEffect=null;c.effectTag=8}}function c(c,d){if(!a)return null;for(;null!==d;)b(c,d),d=d.sibling;return null}function d(a,b){for(a=new Map;null!==b;)null!==b.key?a.set(b.key,b):a.set(b.index,b),b=b.sibling;return a}function e(a,b){a=Sg(a,b);a.index=0;a.sibling=null;return a}function f(b,c,d){b.index=d;if(!a)return c;d=b.alternate;if(null!==d)return d=d.index,d<c?(b.effectTag=\n\t2,c):d;b.effectTag=2;return c}function g(b){a&&null===b.alternate&&(b.effectTag=2);return b}function h(a,b,c,d){if(null===b||6!==b.tag)return b=Tg(c,a.mode,d),b.return=a,b;b=e(b,c);b.return=a;return b}function k(a,b,c,d){if(null!==b&&b.elementType===c.type)return d=e(b,c.props),d.ref=Pg(a,b,c),d.return=a,d;d=Ug(c.type,c.key,c.props,null,a.mode,d);d.ref=Pg(a,b,c);d.return=a;return d}function l(a,b,c,d){if(null===b||4!==b.tag||b.stateNode.containerInfo!==c.containerInfo||b.stateNode.implementation!==\n\tc.implementation)return b=Vg(c,a.mode,d),b.return=a,b;b=e(b,c.children||[]);b.return=a;return b}function m(a,b,c,d,f){if(null===b||7!==b.tag)return b=Wg(c,a.mode,d,f),b.return=a,b;b=e(b,c);b.return=a;return b}function p(a,b,c){if(\"string\"===typeof b||\"number\"===typeof b)return b=Tg(\"\"+b,a.mode,c),b.return=a,b;if(\"object\"===typeof b&&null!==b){switch(b.$$typeof){case Za:return c=Ug(b.type,b.key,b.props,null,a.mode,c),c.ref=Pg(a,null,b),c.return=a,c;case $a:return b=Vg(b,a.mode,c),b.return=a,b}if(Og(b)||\n\tnb(b))return b=Wg(b,a.mode,c,null),b.return=a,b;Qg(a,b)}return null}function x(a,b,c,d){var e=null!==b?b.key:null;if(\"string\"===typeof c||\"number\"===typeof c)return null!==e?null:h(a,b,\"\"+c,d);if(\"object\"===typeof c&&null!==c){switch(c.$$typeof){case Za:return c.key===e?c.type===ab?m(a,b,c.props.children,d,e):k(a,b,c,d):null;case $a:return c.key===e?l(a,b,c,d):null}if(Og(c)||nb(c))return null!==e?null:m(a,b,c,d,null);Qg(a,c)}return null}function z(a,b,c,d,e){if(\"string\"===typeof d||\"number\"===typeof d)return a=\n\ta.get(c)||null,h(b,a,\"\"+d,e);if(\"object\"===typeof d&&null!==d){switch(d.$$typeof){case Za:return a=a.get(null===d.key?c:d.key)||null,d.type===ab?m(b,a,d.props.children,e,d.key):k(b,a,d,e);case $a:return a=a.get(null===d.key?c:d.key)||null,l(b,a,d,e)}if(Og(d)||nb(d))return a=a.get(c)||null,m(b,a,d,e,null);Qg(b,d)}return null}function ca(e,g,h,k){for(var l=null,t=null,m=g,y=g=0,A=null;null!==m&&y<h.length;y++){m.index>y?(A=m,m=null):A=m.sibling;var q=x(e,m,h[y],k);if(null===q){null===m&&(m=A);break}a&&\n\tm&&null===q.alternate&&b(e,m);g=f(q,g,y);null===t?l=q:t.sibling=q;t=q;m=A}if(y===h.length)return c(e,m),l;if(null===m){for(;y<h.length;y++)m=p(e,h[y],k),null!==m&&(g=f(m,g,y),null===t?l=m:t.sibling=m,t=m);return l}for(m=d(e,m);y<h.length;y++)A=z(m,e,y,h[y],k),null!==A&&(a&&null!==A.alternate&&m.delete(null===A.key?y:A.key),g=f(A,g,y),null===t?l=A:t.sibling=A,t=A);a&&m.forEach(function(a){return b(e,a)});return l}function D(e,g,h,l){var k=nb(h);if(\"function\"!==typeof k)throw Error(u(150));h=k.call(h);\n\tif(null==h)throw Error(u(151));for(var m=k=null,t=g,y=g=0,A=null,q=h.next();null!==t&&!q.done;y++,q=h.next()){t.index>y?(A=t,t=null):A=t.sibling;var D=x(e,t,q.value,l);if(null===D){null===t&&(t=A);break}a&&t&&null===D.alternate&&b(e,t);g=f(D,g,y);null===m?k=D:m.sibling=D;m=D;t=A}if(q.done)return c(e,t),k;if(null===t){for(;!q.done;y++,q=h.next())q=p(e,q.value,l),null!==q&&(g=f(q,g,y),null===m?k=q:m.sibling=q,m=q);return k}for(t=d(e,t);!q.done;y++,q=h.next())q=z(t,e,y,q.value,l),null!==q&&(a&&null!==\n\tq.alternate&&t.delete(null===q.key?y:q.key),g=f(q,g,y),null===m?k=q:m.sibling=q,m=q);a&&t.forEach(function(a){return b(e,a)});return k}return function(a,d,f,h){var k=\"object\"===typeof f&&null!==f&&f.type===ab&&null===f.key;k&&(f=f.props.children);var l=\"object\"===typeof f&&null!==f;if(l)switch(f.$$typeof){case Za:a:{l=f.key;for(k=d;null!==k;){if(k.key===l){switch(k.tag){case 7:if(f.type===ab){c(a,k.sibling);d=e(k,f.props.children);d.return=a;a=d;break a}break;default:if(k.elementType===f.type){c(a,\n\tk.sibling);d=e(k,f.props);d.ref=Pg(a,k,f);d.return=a;a=d;break a}}c(a,k);break}else b(a,k);k=k.sibling}f.type===ab?(d=Wg(f.props.children,a.mode,h,f.key),d.return=a,a=d):(h=Ug(f.type,f.key,f.props,null,a.mode,h),h.ref=Pg(a,d,f),h.return=a,a=h)}return g(a);case $a:a:{for(k=f.key;null!==d;){if(d.key===k)if(4===d.tag&&d.stateNode.containerInfo===f.containerInfo&&d.stateNode.implementation===f.implementation){c(a,d.sibling);d=e(d,f.children||[]);d.return=a;a=d;break a}else{c(a,d);break}else b(a,d);d=\n\td.sibling}d=Vg(f,a.mode,h);d.return=a;a=d}return g(a)}if(\"string\"===typeof f||\"number\"===typeof f)return f=\"\"+f,null!==d&&6===d.tag?(c(a,d.sibling),d=e(d,f),d.return=a,a=d):(c(a,d),d=Tg(f,a.mode,h),d.return=a,a=d),g(a);if(Og(f))return ca(a,d,f,h);if(nb(f))return D(a,d,f,h);l&&Qg(a,f);if(\"undefined\"===typeof f&&!k)switch(a.tag){case 1:case 0:throw a=a.type,Error(u(152,a.displayName||a.name||\"Component\"));}return c(a,d)}}var Xg=Rg(!0),Yg=Rg(!1),Zg={},$g={current:Zg},ah={current:Zg},bh={current:Zg};\n\tfunction ch(a){if(a===Zg)throw Error(u(174));return a}function dh(a,b){I(bh,b);I(ah,a);I($g,Zg);a=b.nodeType;switch(a){case 9:case 11:b=(b=b.documentElement)?b.namespaceURI:Ob(null,\"\");break;default:a=8===a?b.parentNode:b,b=a.namespaceURI||null,a=a.tagName,b=Ob(b,a)}H($g);I($g,b)}function eh(){H($g);H(ah);H(bh)}function fh(a){ch(bh.current);var b=ch($g.current);var c=Ob(b,a.type);b!==c&&(I(ah,a),I($g,c))}function gh(a){ah.current===a&&(H($g),H(ah))}var M={current:0};\n\tfunction hh(a){for(var b=a;null!==b;){if(13===b.tag){var c=b.memoizedState;if(null!==c&&(c=c.dehydrated,null===c||c.data===Bd||c.data===Cd))return b}else if(19===b.tag&&void 0!==b.memoizedProps.revealOrder){if(0!==(b.effectTag&64))return b}else if(null!==b.child){b.child.return=b;b=b.child;continue}if(b===a)break;for(;null===b.sibling;){if(null===b.return||b.return===a)return null;b=b.return}b.sibling.return=b.return;b=b.sibling}return null}function ih(a,b){return{responder:a,props:b}}\n\tvar jh=Wa.ReactCurrentDispatcher,kh=Wa.ReactCurrentBatchConfig,lh=0,N=null,O=null,P=null,mh=!1;function Q(){throw Error(u(321));}function nh(a,b){if(null===b)return!1;for(var c=0;c<b.length&&c<a.length;c++)if(!$e(a[c],b[c]))return!1;return!0}\n\tfunction oh(a,b,c,d,e,f){lh=f;N=b;b.memoizedState=null;b.updateQueue=null;b.expirationTime=0;jh.current=null===a||null===a.memoizedState?ph:qh;a=c(d,e);if(b.expirationTime===lh){f=0;do{b.expirationTime=0;if(!(25>f))throw Error(u(301));f+=1;P=O=null;b.updateQueue=null;jh.current=rh;a=c(d,e)}while(b.expirationTime===lh)}jh.current=sh;b=null!==O&&null!==O.next;lh=0;P=O=N=null;mh=!1;if(b)throw Error(u(300));return a}\n\tfunction th(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};null===P?N.memoizedState=P=a:P=P.next=a;return P}function uh(){if(null===O){var a=N.alternate;a=null!==a?a.memoizedState:null}else a=O.next;var b=null===P?N.memoizedState:P.next;if(null!==b)P=b,O=a;else{if(null===a)throw Error(u(310));O=a;a={memoizedState:O.memoizedState,baseState:O.baseState,baseQueue:O.baseQueue,queue:O.queue,next:null};null===P?N.memoizedState=P=a:P=P.next=a}return P}\n\tfunction vh(a,b){return\"function\"===typeof b?b(a):b}\n\tfunction wh(a){var b=uh(),c=b.queue;if(null===c)throw Error(u(311));c.lastRenderedReducer=a;var d=O,e=d.baseQueue,f=c.pending;if(null!==f){if(null!==e){var g=e.next;e.next=f.next;f.next=g}d.baseQueue=e=f;c.pending=null}if(null!==e){e=e.next;d=d.baseState;var h=g=f=null,k=e;do{var l=k.expirationTime;if(l<lh){var m={expirationTime:k.expirationTime,suspenseConfig:k.suspenseConfig,action:k.action,eagerReducer:k.eagerReducer,eagerState:k.eagerState,next:null};null===h?(g=h=m,f=d):h=h.next=m;l>N.expirationTime&&\n\t(N.expirationTime=l,Bg(l))}else null!==h&&(h=h.next={expirationTime:1073741823,suspenseConfig:k.suspenseConfig,action:k.action,eagerReducer:k.eagerReducer,eagerState:k.eagerState,next:null}),Ag(l,k.suspenseConfig),d=k.eagerReducer===a?k.eagerState:a(d,k.action);k=k.next}while(null!==k&&k!==e);null===h?f=d:h.next=g;$e(d,b.memoizedState)||(rg=!0);b.memoizedState=d;b.baseState=f;b.baseQueue=h;c.lastRenderedState=d}return[b.memoizedState,c.dispatch]}\n\tfunction xh(a){var b=uh(),c=b.queue;if(null===c)throw Error(u(311));c.lastRenderedReducer=a;var d=c.dispatch,e=c.pending,f=b.memoizedState;if(null!==e){c.pending=null;var g=e=e.next;do f=a(f,g.action),g=g.next;while(g!==e);$e(f,b.memoizedState)||(rg=!0);b.memoizedState=f;null===b.baseQueue&&(b.baseState=f);c.lastRenderedState=f}return[f,d]}\n\tfunction yh(a){var b=th();\"function\"===typeof a&&(a=a());b.memoizedState=b.baseState=a;a=b.queue={pending:null,dispatch:null,lastRenderedReducer:vh,lastRenderedState:a};a=a.dispatch=zh.bind(null,N,a);return[b.memoizedState,a]}function Ah(a,b,c,d){a={tag:a,create:b,destroy:c,deps:d,next:null};b=N.updateQueue;null===b?(b={lastEffect:null},N.updateQueue=b,b.lastEffect=a.next=a):(c=b.lastEffect,null===c?b.lastEffect=a.next=a:(d=c.next,c.next=a,a.next=d,b.lastEffect=a));return a}\n\tfunction Bh(){return uh().memoizedState}function Ch(a,b,c,d){var e=th();N.effectTag|=a;e.memoizedState=Ah(1|b,c,void 0,void 0===d?null:d)}function Dh(a,b,c,d){var e=uh();d=void 0===d?null:d;var f=void 0;if(null!==O){var g=O.memoizedState;f=g.destroy;if(null!==d&&nh(d,g.deps)){Ah(b,c,f,d);return}}N.effectTag|=a;e.memoizedState=Ah(1|b,c,f,d)}function Eh(a,b){return Ch(516,4,a,b)}function Fh(a,b){return Dh(516,4,a,b)}function Gh(a,b){return Dh(4,2,a,b)}\n\tfunction Hh(a,b){if(\"function\"===typeof b)return a=a(),b(a),function(){b(null)};if(null!==b&&void 0!==b)return a=a(),b.current=a,function(){b.current=null}}function Ih(a,b,c){c=null!==c&&void 0!==c?c.concat([a]):null;return Dh(4,2,Hh.bind(null,b,a),c)}function Jh(){}function Kh(a,b){th().memoizedState=[a,void 0===b?null:b];return a}function Lh(a,b){var c=uh();b=void 0===b?null:b;var d=c.memoizedState;if(null!==d&&null!==b&&nh(b,d[1]))return d[0];c.memoizedState=[a,b];return a}\n\tfunction Mh(a,b){var c=uh();b=void 0===b?null:b;var d=c.memoizedState;if(null!==d&&null!==b&&nh(b,d[1]))return d[0];a=a();c.memoizedState=[a,b];return a}function Nh(a,b,c){var d=ag();cg(98>d?98:d,function(){a(!0)});cg(97<d?97:d,function(){var d=kh.suspense;kh.suspense=void 0===b?null:b;try{a(!1),c()}finally{kh.suspense=d}})}\n\tfunction zh(a,b,c){var d=Gg(),e=Dg.suspense;d=Hg(d,a,e);e={expirationTime:d,suspenseConfig:e,action:c,eagerReducer:null,eagerState:null,next:null};var f=b.pending;null===f?e.next=e:(e.next=f.next,f.next=e);b.pending=e;f=a.alternate;if(a===N||null!==f&&f===N)mh=!0,e.expirationTime=lh,N.expirationTime=lh;else{if(0===a.expirationTime&&(null===f||0===f.expirationTime)&&(f=b.lastRenderedReducer,null!==f))try{var g=b.lastRenderedState,h=f(g,c);e.eagerReducer=f;e.eagerState=h;if($e(h,g))return}catch(k){}finally{}Ig(a,\n\td)}}\n\tvar sh={readContext:sg,useCallback:Q,useContext:Q,useEffect:Q,useImperativeHandle:Q,useLayoutEffect:Q,useMemo:Q,useReducer:Q,useRef:Q,useState:Q,useDebugValue:Q,useResponder:Q,useDeferredValue:Q,useTransition:Q},ph={readContext:sg,useCallback:Kh,useContext:sg,useEffect:Eh,useImperativeHandle:function(a,b,c){c=null!==c&&void 0!==c?c.concat([a]):null;return Ch(4,2,Hh.bind(null,b,a),c)},useLayoutEffect:function(a,b){return Ch(4,2,a,b)},useMemo:function(a,b){var c=th();b=void 0===b?null:b;a=a();c.memoizedState=[a,\n\tb];return a},useReducer:function(a,b,c){var d=th();b=void 0!==c?c(b):b;d.memoizedState=d.baseState=b;a=d.queue={pending:null,dispatch:null,lastRenderedReducer:a,lastRenderedState:b};a=a.dispatch=zh.bind(null,N,a);return[d.memoizedState,a]},useRef:function(a){var b=th();a={current:a};return b.memoizedState=a},useState:yh,useDebugValue:Jh,useResponder:ih,useDeferredValue:function(a,b){var c=yh(a),d=c[0],e=c[1];Eh(function(){var c=kh.suspense;kh.suspense=void 0===b?null:b;try{e(a)}finally{kh.suspense=\n\tc}},[a,b]);return d},useTransition:function(a){var b=yh(!1),c=b[0];b=b[1];return[Kh(Nh.bind(null,b,a),[b,a]),c]}},qh={readContext:sg,useCallback:Lh,useContext:sg,useEffect:Fh,useImperativeHandle:Ih,useLayoutEffect:Gh,useMemo:Mh,useReducer:wh,useRef:Bh,useState:function(){return wh(vh)},useDebugValue:Jh,useResponder:ih,useDeferredValue:function(a,b){var c=wh(vh),d=c[0],e=c[1];Fh(function(){var c=kh.suspense;kh.suspense=void 0===b?null:b;try{e(a)}finally{kh.suspense=c}},[a,b]);return d},useTransition:function(a){var b=\n\twh(vh),c=b[0];b=b[1];return[Lh(Nh.bind(null,b,a),[b,a]),c]}},rh={readContext:sg,useCallback:Lh,useContext:sg,useEffect:Fh,useImperativeHandle:Ih,useLayoutEffect:Gh,useMemo:Mh,useReducer:xh,useRef:Bh,useState:function(){return xh(vh)},useDebugValue:Jh,useResponder:ih,useDeferredValue:function(a,b){var c=xh(vh),d=c[0],e=c[1];Fh(function(){var c=kh.suspense;kh.suspense=void 0===b?null:b;try{e(a)}finally{kh.suspense=c}},[a,b]);return d},useTransition:function(a){var b=xh(vh),c=b[0];b=b[1];return[Lh(Nh.bind(null,\n\tb,a),[b,a]),c]}},Oh=null,Ph=null,Qh=!1;function Rh(a,b){var c=Sh(5,null,null,0);c.elementType=\"DELETED\";c.type=\"DELETED\";c.stateNode=b;c.return=a;c.effectTag=8;null!==a.lastEffect?(a.lastEffect.nextEffect=c,a.lastEffect=c):a.firstEffect=a.lastEffect=c}\n\tfunction Th(a,b){switch(a.tag){case 5:var c=a.type;b=1!==b.nodeType||c.toLowerCase()!==b.nodeName.toLowerCase()?null:b;return null!==b?(a.stateNode=b,!0):!1;case 6:return b=\"\"===a.pendingProps||3!==b.nodeType?null:b,null!==b?(a.stateNode=b,!0):!1;case 13:return!1;default:return!1}}\n\tfunction Uh(a){if(Qh){var b=Ph;if(b){var c=b;if(!Th(a,b)){b=Jd(c.nextSibling);if(!b||!Th(a,b)){a.effectTag=a.effectTag&-1025|2;Qh=!1;Oh=a;return}Rh(Oh,c)}Oh=a;Ph=Jd(b.firstChild)}else a.effectTag=a.effectTag&-1025|2,Qh=!1,Oh=a}}function Vh(a){for(a=a.return;null!==a&&5!==a.tag&&3!==a.tag&&13!==a.tag;)a=a.return;Oh=a}\n\tfunction Wh(a){if(a!==Oh)return!1;if(!Qh)return Vh(a),Qh=!0,!1;var b=a.type;if(5!==a.tag||\"head\"!==b&&\"body\"!==b&&!Gd(b,a.memoizedProps))for(b=Ph;b;)Rh(a,b),b=Jd(b.nextSibling);Vh(a);if(13===a.tag){a=a.memoizedState;a=null!==a?a.dehydrated:null;if(!a)throw Error(u(317));a:{a=a.nextSibling;for(b=0;a;){if(8===a.nodeType){var c=a.data;if(c===Ad){if(0===b){Ph=Jd(a.nextSibling);break a}b--}else c!==zd&&c!==Cd&&c!==Bd||b++}a=a.nextSibling}Ph=null}}else Ph=Oh?Jd(a.stateNode.nextSibling):null;return!0}\n\tfunction Xh(){Ph=Oh=null;Qh=!1}var Yh=Wa.ReactCurrentOwner,rg=!1;function R(a,b,c,d){b.child=null===a?Yg(b,null,c,d):Xg(b,a.child,c,d)}function Zh(a,b,c,d,e){c=c.render;var f=b.ref;qg(b,e);d=oh(a,b,c,d,f,e);if(null!==a&&!rg)return b.updateQueue=a.updateQueue,b.effectTag&=-517,a.expirationTime<=e&&(a.expirationTime=0),$h(a,b,e);b.effectTag|=1;R(a,b,d,e);return b.child}\n\tfunction ai(a,b,c,d,e,f){if(null===a){var g=c.type;if(\"function\"===typeof g&&!bi(g)&&void 0===g.defaultProps&&null===c.compare&&void 0===c.defaultProps)return b.tag=15,b.type=g,ci(a,b,g,d,e,f);a=Ug(c.type,null,d,null,b.mode,f);a.ref=b.ref;a.return=b;return b.child=a}g=a.child;if(e<f&&(e=g.memoizedProps,c=c.compare,c=null!==c?c:bf,c(e,d)&&a.ref===b.ref))return $h(a,b,f);b.effectTag|=1;a=Sg(g,d);a.ref=b.ref;a.return=b;return b.child=a}\n\tfunction ci(a,b,c,d,e,f){return null!==a&&bf(a.memoizedProps,d)&&a.ref===b.ref&&(rg=!1,e<f)?(b.expirationTime=a.expirationTime,$h(a,b,f)):di(a,b,c,d,f)}function ei(a,b){var c=b.ref;if(null===a&&null!==c||null!==a&&a.ref!==c)b.effectTag|=128}function di(a,b,c,d,e){var f=L(c)?Bf:J.current;f=Cf(b,f);qg(b,e);c=oh(a,b,c,d,f,e);if(null!==a&&!rg)return b.updateQueue=a.updateQueue,b.effectTag&=-517,a.expirationTime<=e&&(a.expirationTime=0),$h(a,b,e);b.effectTag|=1;R(a,b,c,e);return b.child}\n\tfunction fi(a,b,c,d,e){if(L(c)){var f=!0;Gf(b)}else f=!1;qg(b,e);if(null===b.stateNode)null!==a&&(a.alternate=null,b.alternate=null,b.effectTag|=2),Lg(b,c,d),Ng(b,c,d,e),d=!0;else if(null===a){var g=b.stateNode,h=b.memoizedProps;g.props=h;var k=g.context,l=c.contextType;\"object\"===typeof l&&null!==l?l=sg(l):(l=L(c)?Bf:J.current,l=Cf(b,l));var m=c.getDerivedStateFromProps,p=\"function\"===typeof m||\"function\"===typeof g.getSnapshotBeforeUpdate;p||\"function\"!==typeof g.UNSAFE_componentWillReceiveProps&&\n\t\"function\"!==typeof g.componentWillReceiveProps||(h!==d||k!==l)&&Mg(b,g,d,l);tg=!1;var x=b.memoizedState;g.state=x;zg(b,d,g,e);k=b.memoizedState;h!==d||x!==k||K.current||tg?(\"function\"===typeof m&&(Fg(b,c,m,d),k=b.memoizedState),(h=tg||Kg(b,c,h,d,x,k,l))?(p||\"function\"!==typeof g.UNSAFE_componentWillMount&&\"function\"!==typeof g.componentWillMount||(\"function\"===typeof g.componentWillMount&&g.componentWillMount(),\"function\"===typeof g.UNSAFE_componentWillMount&&g.UNSAFE_componentWillMount()),\"function\"===\n\ttypeof g.componentDidMount&&(b.effectTag|=4)):(\"function\"===typeof g.componentDidMount&&(b.effectTag|=4),b.memoizedProps=d,b.memoizedState=k),g.props=d,g.state=k,g.context=l,d=h):(\"function\"===typeof g.componentDidMount&&(b.effectTag|=4),d=!1)}else g=b.stateNode,vg(a,b),h=b.memoizedProps,g.props=b.type===b.elementType?h:ig(b.type,h),k=g.context,l=c.contextType,\"object\"===typeof l&&null!==l?l=sg(l):(l=L(c)?Bf:J.current,l=Cf(b,l)),m=c.getDerivedStateFromProps,(p=\"function\"===typeof m||\"function\"===\n\ttypeof g.getSnapshotBeforeUpdate)||\"function\"!==typeof g.UNSAFE_componentWillReceiveProps&&\"function\"!==typeof g.componentWillReceiveProps||(h!==d||k!==l)&&Mg(b,g,d,l),tg=!1,k=b.memoizedState,g.state=k,zg(b,d,g,e),x=b.memoizedState,h!==d||k!==x||K.current||tg?(\"function\"===typeof m&&(Fg(b,c,m,d),x=b.memoizedState),(m=tg||Kg(b,c,h,d,k,x,l))?(p||\"function\"!==typeof g.UNSAFE_componentWillUpdate&&\"function\"!==typeof g.componentWillUpdate||(\"function\"===typeof g.componentWillUpdate&&g.componentWillUpdate(d,\n\tx,l),\"function\"===typeof g.UNSAFE_componentWillUpdate&&g.UNSAFE_componentWillUpdate(d,x,l)),\"function\"===typeof g.componentDidUpdate&&(b.effectTag|=4),\"function\"===typeof g.getSnapshotBeforeUpdate&&(b.effectTag|=256)):(\"function\"!==typeof g.componentDidUpdate||h===a.memoizedProps&&k===a.memoizedState||(b.effectTag|=4),\"function\"!==typeof g.getSnapshotBeforeUpdate||h===a.memoizedProps&&k===a.memoizedState||(b.effectTag|=256),b.memoizedProps=d,b.memoizedState=x),g.props=d,g.state=x,g.context=l,d=m):\n\t(\"function\"!==typeof g.componentDidUpdate||h===a.memoizedProps&&k===a.memoizedState||(b.effectTag|=4),\"function\"!==typeof g.getSnapshotBeforeUpdate||h===a.memoizedProps&&k===a.memoizedState||(b.effectTag|=256),d=!1);return gi(a,b,c,d,f,e)}\n\tfunction gi(a,b,c,d,e,f){ei(a,b);var g=0!==(b.effectTag&64);if(!d&&!g)return e&&Hf(b,c,!1),$h(a,b,f);d=b.stateNode;Yh.current=b;var h=g&&\"function\"!==typeof c.getDerivedStateFromError?null:d.render();b.effectTag|=1;null!==a&&g?(b.child=Xg(b,a.child,null,f),b.child=Xg(b,null,h,f)):R(a,b,h,f);b.memoizedState=d.state;e&&Hf(b,c,!0);return b.child}function hi(a){var b=a.stateNode;b.pendingContext?Ef(a,b.pendingContext,b.pendingContext!==b.context):b.context&&Ef(a,b.context,!1);dh(a,b.containerInfo)}\n\tvar ii={dehydrated:null,retryTime:0};\n\tfunction ji(a,b,c){var d=b.mode,e=b.pendingProps,f=M.current,g=!1,h;(h=0!==(b.effectTag&64))||(h=0!==(f&2)&&(null===a||null!==a.memoizedState));h?(g=!0,b.effectTag&=-65):null!==a&&null===a.memoizedState||void 0===e.fallback||!0===e.unstable_avoidThisFallback||(f|=1);I(M,f&1);if(null===a){void 0!==e.fallback&&Uh(b);if(g){g=e.fallback;e=Wg(null,d,0,null);e.return=b;if(0===(b.mode&2))for(a=null!==b.memoizedState?b.child.child:b.child,e.child=a;null!==a;)a.return=e,a=a.sibling;c=Wg(g,d,c,null);c.return=\n\tb;e.sibling=c;b.memoizedState=ii;b.child=e;return c}d=e.children;b.memoizedState=null;return b.child=Yg(b,null,d,c)}if(null!==a.memoizedState){a=a.child;d=a.sibling;if(g){e=e.fallback;c=Sg(a,a.pendingProps);c.return=b;if(0===(b.mode&2)&&(g=null!==b.memoizedState?b.child.child:b.child,g!==a.child))for(c.child=g;null!==g;)g.return=c,g=g.sibling;d=Sg(d,e);d.return=b;c.sibling=d;c.childExpirationTime=0;b.memoizedState=ii;b.child=c;return d}c=Xg(b,a.child,e.children,c);b.memoizedState=null;return b.child=\n\tc}a=a.child;if(g){g=e.fallback;e=Wg(null,d,0,null);e.return=b;e.child=a;null!==a&&(a.return=e);if(0===(b.mode&2))for(a=null!==b.memoizedState?b.child.child:b.child,e.child=a;null!==a;)a.return=e,a=a.sibling;c=Wg(g,d,c,null);c.return=b;e.sibling=c;c.effectTag|=2;e.childExpirationTime=0;b.memoizedState=ii;b.child=e;return c}b.memoizedState=null;return b.child=Xg(b,a,e.children,c)}\n\tfunction ki(a,b){a.expirationTime<b&&(a.expirationTime=b);var c=a.alternate;null!==c&&c.expirationTime<b&&(c.expirationTime=b);pg(a.return,b)}function li(a,b,c,d,e,f){var g=a.memoizedState;null===g?a.memoizedState={isBackwards:b,rendering:null,renderingStartTime:0,last:d,tail:c,tailExpiration:0,tailMode:e,lastEffect:f}:(g.isBackwards=b,g.rendering=null,g.renderingStartTime=0,g.last=d,g.tail=c,g.tailExpiration=0,g.tailMode=e,g.lastEffect=f)}\n\tfunction mi(a,b,c){var d=b.pendingProps,e=d.revealOrder,f=d.tail;R(a,b,d.children,c);d=M.current;if(0!==(d&2))d=d&1|2,b.effectTag|=64;else{if(null!==a&&0!==(a.effectTag&64))a:for(a=b.child;null!==a;){if(13===a.tag)null!==a.memoizedState&&ki(a,c);else if(19===a.tag)ki(a,c);else if(null!==a.child){a.child.return=a;a=a.child;continue}if(a===b)break a;for(;null===a.sibling;){if(null===a.return||a.return===b)break a;a=a.return}a.sibling.return=a.return;a=a.sibling}d&=1}I(M,d);if(0===(b.mode&2))b.memoizedState=\n\tnull;else switch(e){case \"forwards\":c=b.child;for(e=null;null!==c;)a=c.alternate,null!==a&&null===hh(a)&&(e=c),c=c.sibling;c=e;null===c?(e=b.child,b.child=null):(e=c.sibling,c.sibling=null);li(b,!1,e,c,f,b.lastEffect);break;case \"backwards\":c=null;e=b.child;for(b.child=null;null!==e;){a=e.alternate;if(null!==a&&null===hh(a)){b.child=e;break}a=e.sibling;e.sibling=c;c=e;e=a}li(b,!0,c,null,f,b.lastEffect);break;case \"together\":li(b,!1,null,null,void 0,b.lastEffect);break;default:b.memoizedState=null}return b.child}\n\tfunction $h(a,b,c){null!==a&&(b.dependencies=a.dependencies);var d=b.expirationTime;0!==d&&Bg(d);if(b.childExpirationTime<c)return null;if(null!==a&&b.child!==a.child)throw Error(u(153));if(null!==b.child){a=b.child;c=Sg(a,a.pendingProps);b.child=c;for(c.return=b;null!==a.sibling;)a=a.sibling,c=c.sibling=Sg(a,a.pendingProps),c.return=b;c.sibling=null}return b.child}var ni,oi,pi,qi;\n\tni=function(a,b){for(var c=b.child;null!==c;){if(5===c.tag||6===c.tag)a.appendChild(c.stateNode);else if(4!==c.tag&&null!==c.child){c.child.return=c;c=c.child;continue}if(c===b)break;for(;null===c.sibling;){if(null===c.return||c.return===b)return;c=c.return}c.sibling.return=c.return;c=c.sibling}};oi=function(){};\n\tpi=function(a,b,c,d,e){var f=a.memoizedProps;if(f!==d){var g=b.stateNode;ch($g.current);a=null;switch(c){case \"input\":f=zb(g,f);d=zb(g,d);a=[];break;case \"option\":f=Gb(g,f);d=Gb(g,d);a=[];break;case \"select\":f=n({},f,{value:void 0});d=n({},d,{value:void 0});a=[];break;case \"textarea\":f=Ib(g,f);d=Ib(g,d);a=[];break;default:\"function\"!==typeof f.onClick&&\"function\"===typeof d.onClick&&(g.onclick=sd)}od(c,d);var h,k;c=null;for(h in f)if(!d.hasOwnProperty(h)&&f.hasOwnProperty(h)&&null!=f[h])if(\"style\"===\n\th)for(k in g=f[h],g)g.hasOwnProperty(k)&&(c||(c={}),c[k]=\"\");else\"dangerouslySetInnerHTML\"!==h&&\"children\"!==h&&\"suppressContentEditableWarning\"!==h&&\"suppressHydrationWarning\"!==h&&\"autoFocus\"!==h&&(va.hasOwnProperty(h)?a||(a=[]):(a=a||[]).push(h,null));for(h in d){var l=d[h];g=null!=f?f[h]:void 0;if(d.hasOwnProperty(h)&&l!==g&&(null!=l||null!=g))if(\"style\"===h)if(g){for(k in g)!g.hasOwnProperty(k)||l&&l.hasOwnProperty(k)||(c||(c={}),c[k]=\"\");for(k in l)l.hasOwnProperty(k)&&g[k]!==l[k]&&(c||(c={}),\n\tc[k]=l[k])}else c||(a||(a=[]),a.push(h,c)),c=l;else\"dangerouslySetInnerHTML\"===h?(l=l?l.__html:void 0,g=g?g.__html:void 0,null!=l&&g!==l&&(a=a||[]).push(h,l)):\"children\"===h?g===l||\"string\"!==typeof l&&\"number\"!==typeof l||(a=a||[]).push(h,\"\"+l):\"suppressContentEditableWarning\"!==h&&\"suppressHydrationWarning\"!==h&&(va.hasOwnProperty(h)?(null!=l&&rd(e,h),a||g===l||(a=[])):(a=a||[]).push(h,l))}c&&(a=a||[]).push(\"style\",c);e=a;if(b.updateQueue=e)b.effectTag|=4}};\n\tqi=function(a,b,c,d){c!==d&&(b.effectTag|=4)};function ri(a,b){switch(a.tailMode){case \"hidden\":b=a.tail;for(var c=null;null!==b;)null!==b.alternate&&(c=b),b=b.sibling;null===c?a.tail=null:c.sibling=null;break;case \"collapsed\":c=a.tail;for(var d=null;null!==c;)null!==c.alternate&&(d=c),c=c.sibling;null===d?b||null===a.tail?a.tail=null:a.tail.sibling=null:d.sibling=null}}\n\tfunction si(a,b,c){var d=b.pendingProps;switch(b.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:return L(b.type)&&Df(),null;case 3:return eh(),H(K),H(J),c=b.stateNode,c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),null!==a&&null!==a.child||!Wh(b)||(b.effectTag|=4),oi(b),null;case 5:gh(b);c=ch(bh.current);var e=b.type;if(null!==a&&null!=b.stateNode)pi(a,b,e,d,c),a.ref!==b.ref&&(b.effectTag|=128);else{if(!d){if(null===b.stateNode)throw Error(u(166));\n\treturn null}a=ch($g.current);if(Wh(b)){d=b.stateNode;e=b.type;var f=b.memoizedProps;d[Md]=b;d[Nd]=f;switch(e){case \"iframe\":case \"object\":case \"embed\":F(\"load\",d);break;case \"video\":case \"audio\":for(a=0;a<ac.length;a++)F(ac[a],d);break;case \"source\":F(\"error\",d);break;case \"img\":case \"image\":case \"link\":F(\"error\",d);F(\"load\",d);break;case \"form\":F(\"reset\",d);F(\"submit\",d);break;case \"details\":F(\"toggle\",d);break;case \"input\":Ab(d,f);F(\"invalid\",d);rd(c,\"onChange\");break;case \"select\":d._wrapperState=\n\t{wasMultiple:!!f.multiple};F(\"invalid\",d);rd(c,\"onChange\");break;case \"textarea\":Jb(d,f),F(\"invalid\",d),rd(c,\"onChange\")}od(e,f);a=null;for(var g in f)if(f.hasOwnProperty(g)){var h=f[g];\"children\"===g?\"string\"===typeof h?d.textContent!==h&&(a=[\"children\",h]):\"number\"===typeof h&&d.textContent!==\"\"+h&&(a=[\"children\",\"\"+h]):va.hasOwnProperty(g)&&null!=h&&rd(c,g)}switch(e){case \"input\":xb(d);Eb(d,f,!0);break;case \"textarea\":xb(d);Lb(d);break;case \"select\":case \"option\":break;default:\"function\"===typeof f.onClick&&\n\t(d.onclick=sd)}c=a;b.updateQueue=c;null!==c&&(b.effectTag|=4)}else{g=9===c.nodeType?c:c.ownerDocument;a===qd&&(a=Nb(e));a===qd?\"script\"===e?(a=g.createElement(\"div\"),a.innerHTML=\"<script>\\x3c/script>\",a=a.removeChild(a.firstChild)):\"string\"===typeof d.is?a=g.createElement(e,{is:d.is}):(a=g.createElement(e),\"select\"===e&&(g=a,d.multiple?g.multiple=!0:d.size&&(g.size=d.size))):a=g.createElementNS(a,e);a[Md]=b;a[Nd]=d;ni(a,b,!1,!1);b.stateNode=a;g=pd(e,d);switch(e){case \"iframe\":case \"object\":case \"embed\":F(\"load\",\n\ta);h=d;break;case \"video\":case \"audio\":for(h=0;h<ac.length;h++)F(ac[h],a);h=d;break;case \"source\":F(\"error\",a);h=d;break;case \"img\":case \"image\":case \"link\":F(\"error\",a);F(\"load\",a);h=d;break;case \"form\":F(\"reset\",a);F(\"submit\",a);h=d;break;case \"details\":F(\"toggle\",a);h=d;break;case \"input\":Ab(a,d);h=zb(a,d);F(\"invalid\",a);rd(c,\"onChange\");break;case \"option\":h=Gb(a,d);break;case \"select\":a._wrapperState={wasMultiple:!!d.multiple};h=n({},d,{value:void 0});F(\"invalid\",a);rd(c,\"onChange\");break;case \"textarea\":Jb(a,\n\td);h=Ib(a,d);F(\"invalid\",a);rd(c,\"onChange\");break;default:h=d}od(e,h);var k=h;for(f in k)if(k.hasOwnProperty(f)){var l=k[f];\"style\"===f?md(a,l):\"dangerouslySetInnerHTML\"===f?(l=l?l.__html:void 0,null!=l&&Qb(a,l)):\"children\"===f?\"string\"===typeof l?(\"textarea\"!==e||\"\"!==l)&&Rb(a,l):\"number\"===typeof l&&Rb(a,\"\"+l):\"suppressContentEditableWarning\"!==f&&\"suppressHydrationWarning\"!==f&&\"autoFocus\"!==f&&(va.hasOwnProperty(f)?null!=l&&rd(c,f):null!=l&&Xa(a,f,l,g))}switch(e){case \"input\":xb(a);Eb(a,d,!1);\n\tbreak;case \"textarea\":xb(a);Lb(a);break;case \"option\":null!=d.value&&a.setAttribute(\"value\",\"\"+rb(d.value));break;case \"select\":a.multiple=!!d.multiple;c=d.value;null!=c?Hb(a,!!d.multiple,c,!1):null!=d.defaultValue&&Hb(a,!!d.multiple,d.defaultValue,!0);break;default:\"function\"===typeof h.onClick&&(a.onclick=sd)}Fd(e,d)&&(b.effectTag|=4)}null!==b.ref&&(b.effectTag|=128)}return null;case 6:if(a&&null!=b.stateNode)qi(a,b,a.memoizedProps,d);else{if(\"string\"!==typeof d&&null===b.stateNode)throw Error(u(166));\n\tc=ch(bh.current);ch($g.current);Wh(b)?(c=b.stateNode,d=b.memoizedProps,c[Md]=b,c.nodeValue!==d&&(b.effectTag|=4)):(c=(9===c.nodeType?c:c.ownerDocument).createTextNode(d),c[Md]=b,b.stateNode=c)}return null;case 13:H(M);d=b.memoizedState;if(0!==(b.effectTag&64))return b.expirationTime=c,b;c=null!==d;d=!1;null===a?void 0!==b.memoizedProps.fallback&&Wh(b):(e=a.memoizedState,d=null!==e,c||null===e||(e=a.child.sibling,null!==e&&(f=b.firstEffect,null!==f?(b.firstEffect=e,e.nextEffect=f):(b.firstEffect=b.lastEffect=\n\te,e.nextEffect=null),e.effectTag=8)));if(c&&!d&&0!==(b.mode&2))if(null===a&&!0!==b.memoizedProps.unstable_avoidThisFallback||0!==(M.current&1))S===ti&&(S=ui);else{if(S===ti||S===ui)S=vi;0!==wi&&null!==T&&(xi(T,U),yi(T,wi))}if(c||d)b.effectTag|=4;return null;case 4:return eh(),oi(b),null;case 10:return og(b),null;case 17:return L(b.type)&&Df(),null;case 19:H(M);d=b.memoizedState;if(null===d)return null;e=0!==(b.effectTag&64);f=d.rendering;if(null===f)if(e)ri(d,!1);else{if(S!==ti||null!==a&&0!==(a.effectTag&\n\t64))for(f=b.child;null!==f;){a=hh(f);if(null!==a){b.effectTag|=64;ri(d,!1);e=a.updateQueue;null!==e&&(b.updateQueue=e,b.effectTag|=4);null===d.lastEffect&&(b.firstEffect=null);b.lastEffect=d.lastEffect;for(d=b.child;null!==d;)e=d,f=c,e.effectTag&=2,e.nextEffect=null,e.firstEffect=null,e.lastEffect=null,a=e.alternate,null===a?(e.childExpirationTime=0,e.expirationTime=f,e.child=null,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null):(e.childExpirationTime=a.childExpirationTime,\n\te.expirationTime=a.expirationTime,e.child=a.child,e.memoizedProps=a.memoizedProps,e.memoizedState=a.memoizedState,e.updateQueue=a.updateQueue,f=a.dependencies,e.dependencies=null===f?null:{expirationTime:f.expirationTime,firstContext:f.firstContext,responders:f.responders}),d=d.sibling;I(M,M.current&1|2);return b.child}f=f.sibling}}else{if(!e)if(a=hh(f),null!==a){if(b.effectTag|=64,e=!0,c=a.updateQueue,null!==c&&(b.updateQueue=c,b.effectTag|=4),ri(d,!0),null===d.tail&&\"hidden\"===d.tailMode&&!f.alternate)return b=\n\tb.lastEffect=d.lastEffect,null!==b&&(b.nextEffect=null),null}else 2*$f()-d.renderingStartTime>d.tailExpiration&&1<c&&(b.effectTag|=64,e=!0,ri(d,!1),b.expirationTime=b.childExpirationTime=c-1);d.isBackwards?(f.sibling=b.child,b.child=f):(c=d.last,null!==c?c.sibling=f:b.child=f,d.last=f)}return null!==d.tail?(0===d.tailExpiration&&(d.tailExpiration=$f()+500),c=d.tail,d.rendering=c,d.tail=c.sibling,d.lastEffect=b.lastEffect,d.renderingStartTime=$f(),c.sibling=null,b=M.current,I(M,e?b&1|2:b&1),c):null}throw Error(u(156,\n\tb.tag));}function zi(a){switch(a.tag){case 1:L(a.type)&&Df();var b=a.effectTag;return b&4096?(a.effectTag=b&-4097|64,a):null;case 3:eh();H(K);H(J);b=a.effectTag;if(0!==(b&64))throw Error(u(285));a.effectTag=b&-4097|64;return a;case 5:return gh(a),null;case 13:return H(M),b=a.effectTag,b&4096?(a.effectTag=b&-4097|64,a):null;case 19:return H(M),null;case 4:return eh(),null;case 10:return og(a),null;default:return null}}function Ai(a,b){return{value:a,source:b,stack:qb(b)}}\n\tvar Bi=\"function\"===typeof WeakSet?WeakSet:Set;function Ci(a,b){var c=b.source,d=b.stack;null===d&&null!==c&&(d=qb(c));null!==c&&pb(c.type);b=b.value;null!==a&&1===a.tag&&pb(a.type);try{console.error(b)}catch(e){setTimeout(function(){throw e;})}}function Di(a,b){try{b.props=a.memoizedProps,b.state=a.memoizedState,b.componentWillUnmount()}catch(c){Ei(a,c)}}function Fi(a){var b=a.ref;if(null!==b)if(\"function\"===typeof b)try{b(null)}catch(c){Ei(a,c)}else b.current=null}\n\tfunction Gi(a,b){switch(b.tag){case 0:case 11:case 15:case 22:return;case 1:if(b.effectTag&256&&null!==a){var c=a.memoizedProps,d=a.memoizedState;a=b.stateNode;b=a.getSnapshotBeforeUpdate(b.elementType===b.type?c:ig(b.type,c),d);a.__reactInternalSnapshotBeforeUpdate=b}return;case 3:case 5:case 6:case 4:case 17:return}throw Error(u(163));}\n\tfunction Hi(a,b){b=b.updateQueue;b=null!==b?b.lastEffect:null;if(null!==b){var c=b=b.next;do{if((c.tag&a)===a){var d=c.destroy;c.destroy=void 0;void 0!==d&&d()}c=c.next}while(c!==b)}}function Ii(a,b){b=b.updateQueue;b=null!==b?b.lastEffect:null;if(null!==b){var c=b=b.next;do{if((c.tag&a)===a){var d=c.create;c.destroy=d()}c=c.next}while(c!==b)}}\n\tfunction Ji(a,b,c){switch(c.tag){case 0:case 11:case 15:case 22:Ii(3,c);return;case 1:a=c.stateNode;if(c.effectTag&4)if(null===b)a.componentDidMount();else{var d=c.elementType===c.type?b.memoizedProps:ig(c.type,b.memoizedProps);a.componentDidUpdate(d,b.memoizedState,a.__reactInternalSnapshotBeforeUpdate)}b=c.updateQueue;null!==b&&Cg(c,b,a);return;case 3:b=c.updateQueue;if(null!==b){a=null;if(null!==c.child)switch(c.child.tag){case 5:a=c.child.stateNode;break;case 1:a=c.child.stateNode}Cg(c,b,a)}return;\n\tcase 5:a=c.stateNode;null===b&&c.effectTag&4&&Fd(c.type,c.memoizedProps)&&a.focus();return;case 6:return;case 4:return;case 12:return;case 13:null===c.memoizedState&&(c=c.alternate,null!==c&&(c=c.memoizedState,null!==c&&(c=c.dehydrated,null!==c&&Vc(c))));return;case 19:case 17:case 20:case 21:return}throw Error(u(163));}\n\tfunction Ki(a,b,c){\"function\"===typeof Li&&Li(b);switch(b.tag){case 0:case 11:case 14:case 15:case 22:a=b.updateQueue;if(null!==a&&(a=a.lastEffect,null!==a)){var d=a.next;cg(97<c?97:c,function(){var a=d;do{var c=a.destroy;if(void 0!==c){var g=b;try{c()}catch(h){Ei(g,h)}}a=a.next}while(a!==d)})}break;case 1:Fi(b);c=b.stateNode;\"function\"===typeof c.componentWillUnmount&&Di(b,c);break;case 5:Fi(b);break;case 4:Mi(a,b,c)}}\n\tfunction Ni(a){var b=a.alternate;a.return=null;a.child=null;a.memoizedState=null;a.updateQueue=null;a.dependencies=null;a.alternate=null;a.firstEffect=null;a.lastEffect=null;a.pendingProps=null;a.memoizedProps=null;a.stateNode=null;null!==b&&Ni(b)}function Oi(a){return 5===a.tag||3===a.tag||4===a.tag}\n\tfunction Pi(a){a:{for(var b=a.return;null!==b;){if(Oi(b)){var c=b;break a}b=b.return}throw Error(u(160));}b=c.stateNode;switch(c.tag){case 5:var d=!1;break;case 3:b=b.containerInfo;d=!0;break;case 4:b=b.containerInfo;d=!0;break;default:throw Error(u(161));}c.effectTag&16&&(Rb(b,\"\"),c.effectTag&=-17);a:b:for(c=a;;){for(;null===c.sibling;){if(null===c.return||Oi(c.return)){c=null;break a}c=c.return}c.sibling.return=c.return;for(c=c.sibling;5!==c.tag&&6!==c.tag&&18!==c.tag;){if(c.effectTag&2)continue b;\n\tif(null===c.child||4===c.tag)continue b;else c.child.return=c,c=c.child}if(!(c.effectTag&2)){c=c.stateNode;break a}}d?Qi(a,c,b):Ri(a,c,b)}\n\tfunction Qi(a,b,c){var d=a.tag,e=5===d||6===d;if(e)a=e?a.stateNode:a.stateNode.instance,b?8===c.nodeType?c.parentNode.insertBefore(a,b):c.insertBefore(a,b):(8===c.nodeType?(b=c.parentNode,b.insertBefore(a,c)):(b=c,b.appendChild(a)),c=c._reactRootContainer,null!==c&&void 0!==c||null!==b.onclick||(b.onclick=sd));else if(4!==d&&(a=a.child,null!==a))for(Qi(a,b,c),a=a.sibling;null!==a;)Qi(a,b,c),a=a.sibling}\n\tfunction Ri(a,b,c){var d=a.tag,e=5===d||6===d;if(e)a=e?a.stateNode:a.stateNode.instance,b?c.insertBefore(a,b):c.appendChild(a);else if(4!==d&&(a=a.child,null!==a))for(Ri(a,b,c),a=a.sibling;null!==a;)Ri(a,b,c),a=a.sibling}\n\tfunction Mi(a,b,c){for(var d=b,e=!1,f,g;;){if(!e){e=d.return;a:for(;;){if(null===e)throw Error(u(160));f=e.stateNode;switch(e.tag){case 5:g=!1;break a;case 3:f=f.containerInfo;g=!0;break a;case 4:f=f.containerInfo;g=!0;break a}e=e.return}e=!0}if(5===d.tag||6===d.tag){a:for(var h=a,k=d,l=c,m=k;;)if(Ki(h,m,l),null!==m.child&&4!==m.tag)m.child.return=m,m=m.child;else{if(m===k)break a;for(;null===m.sibling;){if(null===m.return||m.return===k)break a;m=m.return}m.sibling.return=m.return;m=m.sibling}g?(h=\n\tf,k=d.stateNode,8===h.nodeType?h.parentNode.removeChild(k):h.removeChild(k)):f.removeChild(d.stateNode)}else if(4===d.tag){if(null!==d.child){f=d.stateNode.containerInfo;g=!0;d.child.return=d;d=d.child;continue}}else if(Ki(a,d,c),null!==d.child){d.child.return=d;d=d.child;continue}if(d===b)break;for(;null===d.sibling;){if(null===d.return||d.return===b)return;d=d.return;4===d.tag&&(e=!1)}d.sibling.return=d.return;d=d.sibling}}\n\tfunction Si(a,b){switch(b.tag){case 0:case 11:case 14:case 15:case 22:Hi(3,b);return;case 1:return;case 5:var c=b.stateNode;if(null!=c){var d=b.memoizedProps,e=null!==a?a.memoizedProps:d;a=b.type;var f=b.updateQueue;b.updateQueue=null;if(null!==f){c[Nd]=d;\"input\"===a&&\"radio\"===d.type&&null!=d.name&&Bb(c,d);pd(a,e);b=pd(a,d);for(e=0;e<f.length;e+=2){var g=f[e],h=f[e+1];\"style\"===g?md(c,h):\"dangerouslySetInnerHTML\"===g?Qb(c,h):\"children\"===g?Rb(c,h):Xa(c,g,h,b)}switch(a){case \"input\":Cb(c,d);break;\n\tcase \"textarea\":Kb(c,d);break;case \"select\":b=c._wrapperState.wasMultiple,c._wrapperState.wasMultiple=!!d.multiple,a=d.value,null!=a?Hb(c,!!d.multiple,a,!1):b!==!!d.multiple&&(null!=d.defaultValue?Hb(c,!!d.multiple,d.defaultValue,!0):Hb(c,!!d.multiple,d.multiple?[]:\"\",!1))}}}return;case 6:if(null===b.stateNode)throw Error(u(162));b.stateNode.nodeValue=b.memoizedProps;return;case 3:b=b.stateNode;b.hydrate&&(b.hydrate=!1,Vc(b.containerInfo));return;case 12:return;case 13:c=b;null===b.memoizedState?\n\td=!1:(d=!0,c=b.child,Ti=$f());if(null!==c)a:for(a=c;;){if(5===a.tag)f=a.stateNode,d?(f=f.style,\"function\"===typeof f.setProperty?f.setProperty(\"display\",\"none\",\"important\"):f.display=\"none\"):(f=a.stateNode,e=a.memoizedProps.style,e=void 0!==e&&null!==e&&e.hasOwnProperty(\"display\")?e.display:null,f.style.display=ld(\"display\",e));else if(6===a.tag)a.stateNode.nodeValue=d?\"\":a.memoizedProps;else if(13===a.tag&&null!==a.memoizedState&&null===a.memoizedState.dehydrated){f=a.child.sibling;f.return=a;a=\n\tf;continue}else if(null!==a.child){a.child.return=a;a=a.child;continue}if(a===c)break;for(;null===a.sibling;){if(null===a.return||a.return===c)break a;a=a.return}a.sibling.return=a.return;a=a.sibling}Ui(b);return;case 19:Ui(b);return;case 17:return}throw Error(u(163));}function Ui(a){var b=a.updateQueue;if(null!==b){a.updateQueue=null;var c=a.stateNode;null===c&&(c=a.stateNode=new Bi);b.forEach(function(b){var d=Vi.bind(null,a,b);c.has(b)||(c.add(b),b.then(d,d))})}}\n\tvar Wi=\"function\"===typeof WeakMap?WeakMap:Map;function Xi(a,b,c){c=wg(c,null);c.tag=3;c.payload={element:null};var d=b.value;c.callback=function(){Yi||(Yi=!0,Zi=d);Ci(a,b)};return c}\n\tfunction $i(a,b,c){c=wg(c,null);c.tag=3;var d=a.type.getDerivedStateFromError;if(\"function\"===typeof d){var e=b.value;c.payload=function(){Ci(a,b);return d(e)}}var f=a.stateNode;null!==f&&\"function\"===typeof f.componentDidCatch&&(c.callback=function(){\"function\"!==typeof d&&(null===aj?aj=new Set([this]):aj.add(this),Ci(a,b));var c=b.stack;this.componentDidCatch(b.value,{componentStack:null!==c?c:\"\"})});return c}\n\tvar bj=Math.ceil,cj=Wa.ReactCurrentDispatcher,dj=Wa.ReactCurrentOwner,V=0,ej=8,fj=16,gj=32,ti=0,hj=1,ij=2,ui=3,vi=4,jj=5,W=V,T=null,X=null,U=0,S=ti,kj=null,lj=1073741823,mj=1073741823,nj=null,wi=0,oj=!1,Ti=0,pj=500,Y=null,Yi=!1,Zi=null,aj=null,qj=!1,rj=null,sj=90,tj=null,uj=0,vj=null,wj=0;function Gg(){return(W&(fj|gj))!==V?1073741821-($f()/10|0):0!==wj?wj:wj=1073741821-($f()/10|0)}\n\tfunction Hg(a,b,c){b=b.mode;if(0===(b&2))return 1073741823;var d=ag();if(0===(b&4))return 99===d?1073741823:1073741822;if((W&fj)!==V)return U;if(null!==c)a=hg(a,c.timeoutMs|0||5E3,250);else switch(d){case 99:a=1073741823;break;case 98:a=hg(a,150,100);break;case 97:case 96:a=hg(a,5E3,250);break;case 95:a=2;break;default:throw Error(u(326));}null!==T&&a===U&&--a;return a}\n\tfunction Ig(a,b){if(50<uj)throw uj=0,vj=null,Error(u(185));a=xj(a,b);if(null!==a){var c=ag();1073741823===b?(W&ej)!==V&&(W&(fj|gj))===V?yj(a):(Z(a),W===V&&gg()):Z(a);(W&4)===V||98!==c&&99!==c||(null===tj?tj=new Map([[a,b]]):(c=tj.get(a),(void 0===c||c>b)&&tj.set(a,b)))}}\n\tfunction xj(a,b){a.expirationTime<b&&(a.expirationTime=b);var c=a.alternate;null!==c&&c.expirationTime<b&&(c.expirationTime=b);var d=a.return,e=null;if(null===d&&3===a.tag)e=a.stateNode;else for(;null!==d;){c=d.alternate;d.childExpirationTime<b&&(d.childExpirationTime=b);null!==c&&c.childExpirationTime<b&&(c.childExpirationTime=b);if(null===d.return&&3===d.tag){e=d.stateNode;break}d=d.return}null!==e&&(T===e&&(Bg(b),S===vi&&xi(e,U)),yi(e,b));return e}\n\tfunction zj(a){var b=a.lastExpiredTime;if(0!==b)return b;b=a.firstPendingTime;if(!Aj(a,b))return b;var c=a.lastPingedTime;a=a.nextKnownPendingLevel;a=c>a?c:a;return 2>=a&&b!==a?0:a}\n\tfunction Z(a){if(0!==a.lastExpiredTime)a.callbackExpirationTime=1073741823,a.callbackPriority=99,a.callbackNode=eg(yj.bind(null,a));else{var b=zj(a),c=a.callbackNode;if(0===b)null!==c&&(a.callbackNode=null,a.callbackExpirationTime=0,a.callbackPriority=90);else{var d=Gg();1073741823===b?d=99:1===b||2===b?d=95:(d=10*(1073741821-b)-10*(1073741821-d),d=0>=d?99:250>=d?98:5250>=d?97:95);if(null!==c){var e=a.callbackPriority;if(a.callbackExpirationTime===b&&e>=d)return;c!==Tf&&Kf(c)}a.callbackExpirationTime=\n\tb;a.callbackPriority=d;b=1073741823===b?eg(yj.bind(null,a)):dg(d,Bj.bind(null,a),{timeout:10*(1073741821-b)-$f()});a.callbackNode=b}}}\n\tfunction Bj(a,b){wj=0;if(b)return b=Gg(),Cj(a,b),Z(a),null;var c=zj(a);if(0!==c){b=a.callbackNode;if((W&(fj|gj))!==V)throw Error(u(327));Dj();a===T&&c===U||Ej(a,c);if(null!==X){var d=W;W|=fj;var e=Fj();do try{Gj();break}catch(h){Hj(a,h)}while(1);ng();W=d;cj.current=e;if(S===hj)throw b=kj,Ej(a,c),xi(a,c),Z(a),b;if(null===X)switch(e=a.finishedWork=a.current.alternate,a.finishedExpirationTime=c,d=S,T=null,d){case ti:case hj:throw Error(u(345));case ij:Cj(a,2<c?2:c);break;case ui:xi(a,c);d=a.lastSuspendedTime;\n\tc===d&&(a.nextKnownPendingLevel=Ij(e));if(1073741823===lj&&(e=Ti+pj-$f(),10<e)){if(oj){var f=a.lastPingedTime;if(0===f||f>=c){a.lastPingedTime=c;Ej(a,c);break}}f=zj(a);if(0!==f&&f!==c)break;if(0!==d&&d!==c){a.lastPingedTime=d;break}a.timeoutHandle=Hd(Jj.bind(null,a),e);break}Jj(a);break;case vi:xi(a,c);d=a.lastSuspendedTime;c===d&&(a.nextKnownPendingLevel=Ij(e));if(oj&&(e=a.lastPingedTime,0===e||e>=c)){a.lastPingedTime=c;Ej(a,c);break}e=zj(a);if(0!==e&&e!==c)break;if(0!==d&&d!==c){a.lastPingedTime=\n\td;break}1073741823!==mj?d=10*(1073741821-mj)-$f():1073741823===lj?d=0:(d=10*(1073741821-lj)-5E3,e=$f(),c=10*(1073741821-c)-e,d=e-d,0>d&&(d=0),d=(120>d?120:480>d?480:1080>d?1080:1920>d?1920:3E3>d?3E3:4320>d?4320:1960*bj(d/1960))-d,c<d&&(d=c));if(10<d){a.timeoutHandle=Hd(Jj.bind(null,a),d);break}Jj(a);break;case jj:if(1073741823!==lj&&null!==nj){f=lj;var g=nj;d=g.busyMinDurationMs|0;0>=d?d=0:(e=g.busyDelayMs|0,f=$f()-(10*(1073741821-f)-(g.timeoutMs|0||5E3)),d=f<=e?0:e+d-f);if(10<d){xi(a,c);a.timeoutHandle=\n\tHd(Jj.bind(null,a),d);break}}Jj(a);break;default:throw Error(u(329));}Z(a);if(a.callbackNode===b)return Bj.bind(null,a)}}return null}\n\tfunction yj(a){var b=a.lastExpiredTime;b=0!==b?b:1073741823;if((W&(fj|gj))!==V)throw Error(u(327));Dj();a===T&&b===U||Ej(a,b);if(null!==X){var c=W;W|=fj;var d=Fj();do try{Kj();break}catch(e){Hj(a,e)}while(1);ng();W=c;cj.current=d;if(S===hj)throw c=kj,Ej(a,b),xi(a,b),Z(a),c;if(null!==X)throw Error(u(261));a.finishedWork=a.current.alternate;a.finishedExpirationTime=b;T=null;Jj(a);Z(a)}return null}function Lj(){if(null!==tj){var a=tj;tj=null;a.forEach(function(a,c){Cj(c,a);Z(c)});gg()}}\n\tfunction Mj(a,b){var c=W;W|=1;try{return a(b)}finally{W=c,W===V&&gg()}}function Nj(a,b){var c=W;W&=-2;W|=ej;try{return a(b)}finally{W=c,W===V&&gg()}}\n\tfunction Ej(a,b){a.finishedWork=null;a.finishedExpirationTime=0;var c=a.timeoutHandle;-1!==c&&(a.timeoutHandle=-1,Id(c));if(null!==X)for(c=X.return;null!==c;){var d=c;switch(d.tag){case 1:d=d.type.childContextTypes;null!==d&&void 0!==d&&Df();break;case 3:eh();H(K);H(J);break;case 5:gh(d);break;case 4:eh();break;case 13:H(M);break;case 19:H(M);break;case 10:og(d)}c=c.return}T=a;X=Sg(a.current,null);U=b;S=ti;kj=null;mj=lj=1073741823;nj=null;wi=0;oj=!1}\n\tfunction Hj(a,b){do{try{ng();jh.current=sh;if(mh)for(var c=N.memoizedState;null!==c;){var d=c.queue;null!==d&&(d.pending=null);c=c.next}lh=0;P=O=N=null;mh=!1;if(null===X||null===X.return)return S=hj,kj=b,X=null;a:{var e=a,f=X.return,g=X,h=b;b=U;g.effectTag|=2048;g.firstEffect=g.lastEffect=null;if(null!==h&&\"object\"===typeof h&&\"function\"===typeof h.then){var k=h;if(0===(g.mode&2)){var l=g.alternate;l?(g.updateQueue=l.updateQueue,g.memoizedState=l.memoizedState,g.expirationTime=l.expirationTime):(g.updateQueue=\n\tnull,g.memoizedState=null)}var m=0!==(M.current&1),p=f;do{var x;if(x=13===p.tag){var z=p.memoizedState;if(null!==z)x=null!==z.dehydrated?!0:!1;else{var ca=p.memoizedProps;x=void 0===ca.fallback?!1:!0!==ca.unstable_avoidThisFallback?!0:m?!1:!0}}if(x){var D=p.updateQueue;if(null===D){var t=new Set;t.add(k);p.updateQueue=t}else D.add(k);if(0===(p.mode&2)){p.effectTag|=64;g.effectTag&=-2981;if(1===g.tag)if(null===g.alternate)g.tag=17;else{var y=wg(1073741823,null);y.tag=2;xg(g,y)}g.expirationTime=1073741823;\n\tbreak a}h=void 0;g=b;var A=e.pingCache;null===A?(A=e.pingCache=new Wi,h=new Set,A.set(k,h)):(h=A.get(k),void 0===h&&(h=new Set,A.set(k,h)));if(!h.has(g)){h.add(g);var q=Oj.bind(null,e,k,g);k.then(q,q)}p.effectTag|=4096;p.expirationTime=b;break a}p=p.return}while(null!==p);h=Error((pb(g.type)||\"A React component\")+\" suspended while rendering, but no fallback UI was specified.\\n\\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display.\"+qb(g))}S!==\n\tjj&&(S=ij);h=Ai(h,g);p=f;do{switch(p.tag){case 3:k=h;p.effectTag|=4096;p.expirationTime=b;var B=Xi(p,k,b);yg(p,B);break a;case 1:k=h;var w=p.type,ub=p.stateNode;if(0===(p.effectTag&64)&&(\"function\"===typeof w.getDerivedStateFromError||null!==ub&&\"function\"===typeof ub.componentDidCatch&&(null===aj||!aj.has(ub)))){p.effectTag|=4096;p.expirationTime=b;var vb=$i(p,k,b);yg(p,vb);break a}}p=p.return}while(null!==p)}X=Pj(X)}catch(Xc){b=Xc;continue}break}while(1)}\n\tfunction Fj(){var a=cj.current;cj.current=sh;return null===a?sh:a}function Ag(a,b){a<lj&&2<a&&(lj=a);null!==b&&a<mj&&2<a&&(mj=a,nj=b)}function Bg(a){a>wi&&(wi=a)}function Kj(){for(;null!==X;)X=Qj(X)}function Gj(){for(;null!==X&&!Uf();)X=Qj(X)}function Qj(a){var b=Rj(a.alternate,a,U);a.memoizedProps=a.pendingProps;null===b&&(b=Pj(a));dj.current=null;return b}\n\tfunction Pj(a){X=a;do{var b=X.alternate;a=X.return;if(0===(X.effectTag&2048)){b=si(b,X,U);if(1===U||1!==X.childExpirationTime){for(var c=0,d=X.child;null!==d;){var e=d.expirationTime,f=d.childExpirationTime;e>c&&(c=e);f>c&&(c=f);d=d.sibling}X.childExpirationTime=c}if(null!==b)return b;null!==a&&0===(a.effectTag&2048)&&(null===a.firstEffect&&(a.firstEffect=X.firstEffect),null!==X.lastEffect&&(null!==a.lastEffect&&(a.lastEffect.nextEffect=X.firstEffect),a.lastEffect=X.lastEffect),1<X.effectTag&&(null!==\n\ta.lastEffect?a.lastEffect.nextEffect=X:a.firstEffect=X,a.lastEffect=X))}else{b=zi(X);if(null!==b)return b.effectTag&=2047,b;null!==a&&(a.firstEffect=a.lastEffect=null,a.effectTag|=2048)}b=X.sibling;if(null!==b)return b;X=a}while(null!==X);S===ti&&(S=jj);return null}function Ij(a){var b=a.expirationTime;a=a.childExpirationTime;return b>a?b:a}function Jj(a){var b=ag();cg(99,Sj.bind(null,a,b));return null}\n\tfunction Sj(a,b){do Dj();while(null!==rj);if((W&(fj|gj))!==V)throw Error(u(327));var c=a.finishedWork,d=a.finishedExpirationTime;if(null===c)return null;a.finishedWork=null;a.finishedExpirationTime=0;if(c===a.current)throw Error(u(177));a.callbackNode=null;a.callbackExpirationTime=0;a.callbackPriority=90;a.nextKnownPendingLevel=0;var e=Ij(c);a.firstPendingTime=e;d<=a.lastSuspendedTime?a.firstSuspendedTime=a.lastSuspendedTime=a.nextKnownPendingLevel=0:d<=a.firstSuspendedTime&&(a.firstSuspendedTime=\n\td-1);d<=a.lastPingedTime&&(a.lastPingedTime=0);d<=a.lastExpiredTime&&(a.lastExpiredTime=0);a===T&&(X=T=null,U=0);1<c.effectTag?null!==c.lastEffect?(c.lastEffect.nextEffect=c,e=c.firstEffect):e=c:e=c.firstEffect;if(null!==e){var f=W;W|=gj;dj.current=null;Dd=fd;var g=xd();if(yd(g)){if(\"selectionStart\"in g)var h={start:g.selectionStart,end:g.selectionEnd};else a:{h=(h=g.ownerDocument)&&h.defaultView||window;var k=h.getSelection&&h.getSelection();if(k&&0!==k.rangeCount){h=k.anchorNode;var l=k.anchorOffset,\n\tm=k.focusNode;k=k.focusOffset;try{h.nodeType,m.nodeType}catch(wb){h=null;break a}var p=0,x=-1,z=-1,ca=0,D=0,t=g,y=null;b:for(;;){for(var A;;){t!==h||0!==l&&3!==t.nodeType||(x=p+l);t!==m||0!==k&&3!==t.nodeType||(z=p+k);3===t.nodeType&&(p+=t.nodeValue.length);if(null===(A=t.firstChild))break;y=t;t=A}for(;;){if(t===g)break b;y===h&&++ca===l&&(x=p);y===m&&++D===k&&(z=p);if(null!==(A=t.nextSibling))break;t=y;y=t.parentNode}t=A}h=-1===x||-1===z?null:{start:x,end:z}}else h=null}h=h||{start:0,end:0}}else h=\n\tnull;Ed={activeElementDetached:null,focusedElem:g,selectionRange:h};fd=!1;Y=e;do try{Tj()}catch(wb){if(null===Y)throw Error(u(330));Ei(Y,wb);Y=Y.nextEffect}while(null!==Y);Y=e;do try{for(g=a,h=b;null!==Y;){var q=Y.effectTag;q&16&&Rb(Y.stateNode,\"\");if(q&128){var B=Y.alternate;if(null!==B){var w=B.ref;null!==w&&(\"function\"===typeof w?w(null):w.current=null)}}switch(q&1038){case 2:Pi(Y);Y.effectTag&=-3;break;case 6:Pi(Y);Y.effectTag&=-3;Si(Y.alternate,Y);break;case 1024:Y.effectTag&=-1025;break;case 1028:Y.effectTag&=\n\t-1025;Si(Y.alternate,Y);break;case 4:Si(Y.alternate,Y);break;case 8:l=Y,Mi(g,l,h),Ni(l)}Y=Y.nextEffect}}catch(wb){if(null===Y)throw Error(u(330));Ei(Y,wb);Y=Y.nextEffect}while(null!==Y);w=Ed;B=xd();q=w.focusedElem;h=w.selectionRange;if(B!==q&&q&&q.ownerDocument&&wd(q.ownerDocument.documentElement,q)){null!==h&&yd(q)&&(B=h.start,w=h.end,void 0===w&&(w=B),\"selectionStart\"in q?(q.selectionStart=B,q.selectionEnd=Math.min(w,q.value.length)):(w=(B=q.ownerDocument||document)&&B.defaultView||window,w.getSelection&&\n\t(w=w.getSelection(),l=q.textContent.length,g=Math.min(h.start,l),h=void 0===h.end?g:Math.min(h.end,l),!w.extend&&g>h&&(l=h,h=g,g=l),l=vd(q,g),m=vd(q,h),l&&m&&(1!==w.rangeCount||w.anchorNode!==l.node||w.anchorOffset!==l.offset||w.focusNode!==m.node||w.focusOffset!==m.offset)&&(B=B.createRange(),B.setStart(l.node,l.offset),w.removeAllRanges(),g>h?(w.addRange(B),w.extend(m.node,m.offset)):(B.setEnd(m.node,m.offset),w.addRange(B))))));B=[];for(w=q;w=w.parentNode;)1===w.nodeType&&B.push({element:w,left:w.scrollLeft,\n\ttop:w.scrollTop});\"function\"===typeof q.focus&&q.focus();for(q=0;q<B.length;q++)w=B[q],w.element.scrollLeft=w.left,w.element.scrollTop=w.top}fd=!!Dd;Ed=Dd=null;a.current=c;Y=e;do try{for(q=a;null!==Y;){var ub=Y.effectTag;ub&36&&Ji(q,Y.alternate,Y);if(ub&128){B=void 0;var vb=Y.ref;if(null!==vb){var Xc=Y.stateNode;switch(Y.tag){case 5:B=Xc;break;default:B=Xc}\"function\"===typeof vb?vb(B):vb.current=B}}Y=Y.nextEffect}}catch(wb){if(null===Y)throw Error(u(330));Ei(Y,wb);Y=Y.nextEffect}while(null!==Y);Y=\n\tnull;Vf();W=f}else a.current=c;if(qj)qj=!1,rj=a,sj=b;else for(Y=e;null!==Y;)b=Y.nextEffect,Y.nextEffect=null,Y=b;b=a.firstPendingTime;0===b&&(aj=null);1073741823===b?a===vj?uj++:(uj=0,vj=a):uj=0;\"function\"===typeof Uj&&Uj(c.stateNode,d);Z(a);if(Yi)throw Yi=!1,a=Zi,Zi=null,a;if((W&ej)!==V)return null;gg();return null}function Tj(){for(;null!==Y;){var a=Y.effectTag;0!==(a&256)&&Gi(Y.alternate,Y);0===(a&512)||qj||(qj=!0,dg(97,function(){Dj();return null}));Y=Y.nextEffect}}\n\tfunction Dj(){if(90!==sj){var a=97<sj?97:sj;sj=90;return cg(a,Vj)}}function Vj(){if(null===rj)return!1;var a=rj;rj=null;if((W&(fj|gj))!==V)throw Error(u(331));var b=W;W|=gj;for(a=a.current.firstEffect;null!==a;){try{var c=a;if(0!==(c.effectTag&512))switch(c.tag){case 0:case 11:case 15:case 22:Hi(5,c),Ii(5,c)}}catch(d){if(null===a)throw Error(u(330));Ei(a,d)}c=a.nextEffect;a.nextEffect=null;a=c}W=b;gg();return!0}\n\tfunction Wj(a,b,c){b=Ai(c,b);b=Xi(a,b,1073741823);xg(a,b);a=xj(a,1073741823);null!==a&&Z(a)}function Ei(a,b){if(3===a.tag)Wj(a,a,b);else for(var c=a.return;null!==c;){if(3===c.tag){Wj(c,a,b);break}else if(1===c.tag){var d=c.stateNode;if(\"function\"===typeof c.type.getDerivedStateFromError||\"function\"===typeof d.componentDidCatch&&(null===aj||!aj.has(d))){a=Ai(b,a);a=$i(c,a,1073741823);xg(c,a);c=xj(c,1073741823);null!==c&&Z(c);break}}c=c.return}}\n\tfunction Oj(a,b,c){var d=a.pingCache;null!==d&&d.delete(b);T===a&&U===c?S===vi||S===ui&&1073741823===lj&&$f()-Ti<pj?Ej(a,U):oj=!0:Aj(a,c)&&(b=a.lastPingedTime,0!==b&&b<c||(a.lastPingedTime=c,Z(a)))}function Vi(a,b){var c=a.stateNode;null!==c&&c.delete(b);b=0;0===b&&(b=Gg(),b=Hg(b,a,null));a=xj(a,b);null!==a&&Z(a)}var Rj;\n\tRj=function(a,b,c){var d=b.expirationTime;if(null!==a){var e=b.pendingProps;if(a.memoizedProps!==e||K.current)rg=!0;else{if(d<c){rg=!1;switch(b.tag){case 3:hi(b);Xh();break;case 5:fh(b);if(b.mode&4&&1!==c&&e.hidden)return b.expirationTime=b.childExpirationTime=1,null;break;case 1:L(b.type)&&Gf(b);break;case 4:dh(b,b.stateNode.containerInfo);break;case 10:d=b.memoizedProps.value;e=b.type._context;I(jg,e._currentValue);e._currentValue=d;break;case 13:if(null!==b.memoizedState){d=b.child.childExpirationTime;\n\tif(0!==d&&d>=c)return ji(a,b,c);I(M,M.current&1);b=$h(a,b,c);return null!==b?b.sibling:null}I(M,M.current&1);break;case 19:d=b.childExpirationTime>=c;if(0!==(a.effectTag&64)){if(d)return mi(a,b,c);b.effectTag|=64}e=b.memoizedState;null!==e&&(e.rendering=null,e.tail=null);I(M,M.current);if(!d)return null}return $h(a,b,c)}rg=!1}}else rg=!1;b.expirationTime=0;switch(b.tag){case 2:d=b.type;null!==a&&(a.alternate=null,b.alternate=null,b.effectTag|=2);a=b.pendingProps;e=Cf(b,J.current);qg(b,c);e=oh(null,\n\tb,d,a,e,c);b.effectTag|=1;if(\"object\"===typeof e&&null!==e&&\"function\"===typeof e.render&&void 0===e.$$typeof){b.tag=1;b.memoizedState=null;b.updateQueue=null;if(L(d)){var f=!0;Gf(b)}else f=!1;b.memoizedState=null!==e.state&&void 0!==e.state?e.state:null;ug(b);var g=d.getDerivedStateFromProps;\"function\"===typeof g&&Fg(b,d,g,a);e.updater=Jg;b.stateNode=e;e._reactInternalFiber=b;Ng(b,d,a,c);b=gi(null,b,d,!0,f,c)}else b.tag=0,R(null,b,e,c),b=b.child;return b;case 16:a:{e=b.elementType;null!==a&&(a.alternate=\n\tnull,b.alternate=null,b.effectTag|=2);a=b.pendingProps;ob(e);if(1!==e._status)throw e._result;e=e._result;b.type=e;f=b.tag=Xj(e);a=ig(e,a);switch(f){case 0:b=di(null,b,e,a,c);break a;case 1:b=fi(null,b,e,a,c);break a;case 11:b=Zh(null,b,e,a,c);break a;case 14:b=ai(null,b,e,ig(e.type,a),d,c);break a}throw Error(u(306,e,\"\"));}return b;case 0:return d=b.type,e=b.pendingProps,e=b.elementType===d?e:ig(d,e),di(a,b,d,e,c);case 1:return d=b.type,e=b.pendingProps,e=b.elementType===d?e:ig(d,e),fi(a,b,d,e,c);\n\tcase 3:hi(b);d=b.updateQueue;if(null===a||null===d)throw Error(u(282));d=b.pendingProps;e=b.memoizedState;e=null!==e?e.element:null;vg(a,b);zg(b,d,null,c);d=b.memoizedState.element;if(d===e)Xh(),b=$h(a,b,c);else{if(e=b.stateNode.hydrate)Ph=Jd(b.stateNode.containerInfo.firstChild),Oh=b,e=Qh=!0;if(e)for(c=Yg(b,null,d,c),b.child=c;c;)c.effectTag=c.effectTag&-3|1024,c=c.sibling;else R(a,b,d,c),Xh();b=b.child}return b;case 5:return fh(b),null===a&&Uh(b),d=b.type,e=b.pendingProps,f=null!==a?a.memoizedProps:\n\tnull,g=e.children,Gd(d,e)?g=null:null!==f&&Gd(d,f)&&(b.effectTag|=16),ei(a,b),b.mode&4&&1!==c&&e.hidden?(b.expirationTime=b.childExpirationTime=1,b=null):(R(a,b,g,c),b=b.child),b;case 6:return null===a&&Uh(b),null;case 13:return ji(a,b,c);case 4:return dh(b,b.stateNode.containerInfo),d=b.pendingProps,null===a?b.child=Xg(b,null,d,c):R(a,b,d,c),b.child;case 11:return d=b.type,e=b.pendingProps,e=b.elementType===d?e:ig(d,e),Zh(a,b,d,e,c);case 7:return R(a,b,b.pendingProps,c),b.child;case 8:return R(a,\n\tb,b.pendingProps.children,c),b.child;case 12:return R(a,b,b.pendingProps.children,c),b.child;case 10:a:{d=b.type._context;e=b.pendingProps;g=b.memoizedProps;f=e.value;var h=b.type._context;I(jg,h._currentValue);h._currentValue=f;if(null!==g)if(h=g.value,f=$e(h,f)?0:(\"function\"===typeof d._calculateChangedBits?d._calculateChangedBits(h,f):1073741823)|0,0===f){if(g.children===e.children&&!K.current){b=$h(a,b,c);break a}}else for(h=b.child,null!==h&&(h.return=b);null!==h;){var k=h.dependencies;if(null!==\n\tk){g=h.child;for(var l=k.firstContext;null!==l;){if(l.context===d&&0!==(l.observedBits&f)){1===h.tag&&(l=wg(c,null),l.tag=2,xg(h,l));h.expirationTime<c&&(h.expirationTime=c);l=h.alternate;null!==l&&l.expirationTime<c&&(l.expirationTime=c);pg(h.return,c);k.expirationTime<c&&(k.expirationTime=c);break}l=l.next}}else g=10===h.tag?h.type===b.type?null:h.child:h.child;if(null!==g)g.return=h;else for(g=h;null!==g;){if(g===b){g=null;break}h=g.sibling;if(null!==h){h.return=g.return;g=h;break}g=g.return}h=\n\tg}R(a,b,e.children,c);b=b.child}return b;case 9:return e=b.type,f=b.pendingProps,d=f.children,qg(b,c),e=sg(e,f.unstable_observedBits),d=d(e),b.effectTag|=1,R(a,b,d,c),b.child;case 14:return e=b.type,f=ig(e,b.pendingProps),f=ig(e.type,f),ai(a,b,e,f,d,c);case 15:return ci(a,b,b.type,b.pendingProps,d,c);case 17:return d=b.type,e=b.pendingProps,e=b.elementType===d?e:ig(d,e),null!==a&&(a.alternate=null,b.alternate=null,b.effectTag|=2),b.tag=1,L(d)?(a=!0,Gf(b)):a=!1,qg(b,c),Lg(b,d,e),Ng(b,d,e,c),gi(null,\n\tb,d,!0,a,c);case 19:return mi(a,b,c)}throw Error(u(156,b.tag));};var Uj=null,Li=null;function Yj(a){if(\"undefined\"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__)return!1;var b=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(b.isDisabled||!b.supportsFiber)return!0;try{var c=b.inject(a);Uj=function(a){try{b.onCommitFiberRoot(c,a,void 0,64===(a.current.effectTag&64))}catch(e){}};Li=function(a){try{b.onCommitFiberUnmount(c,a)}catch(e){}}}catch(d){}return!0}\n\tfunction Zj(a,b,c,d){this.tag=a;this.key=c;this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null;this.index=0;this.ref=null;this.pendingProps=b;this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null;this.mode=d;this.effectTag=0;this.lastEffect=this.firstEffect=this.nextEffect=null;this.childExpirationTime=this.expirationTime=0;this.alternate=null}function Sh(a,b,c,d){return new Zj(a,b,c,d)}\n\tfunction bi(a){a=a.prototype;return!(!a||!a.isReactComponent)}function Xj(a){if(\"function\"===typeof a)return bi(a)?1:0;if(void 0!==a&&null!==a){a=a.$$typeof;if(a===gb)return 11;if(a===jb)return 14}return 2}\n\tfunction Sg(a,b){var c=a.alternate;null===c?(c=Sh(a.tag,b,a.key,a.mode),c.elementType=a.elementType,c.type=a.type,c.stateNode=a.stateNode,c.alternate=a,a.alternate=c):(c.pendingProps=b,c.effectTag=0,c.nextEffect=null,c.firstEffect=null,c.lastEffect=null);c.childExpirationTime=a.childExpirationTime;c.expirationTime=a.expirationTime;c.child=a.child;c.memoizedProps=a.memoizedProps;c.memoizedState=a.memoizedState;c.updateQueue=a.updateQueue;b=a.dependencies;c.dependencies=null===b?null:{expirationTime:b.expirationTime,\n\tfirstContext:b.firstContext,responders:b.responders};c.sibling=a.sibling;c.index=a.index;c.ref=a.ref;return c}\n\tfunction Ug(a,b,c,d,e,f){var g=2;d=a;if(\"function\"===typeof a)bi(a)&&(g=1);else if(\"string\"===typeof a)g=5;else a:switch(a){case ab:return Wg(c.children,e,f,b);case fb:g=8;e|=7;break;case bb:g=8;e|=1;break;case cb:return a=Sh(12,c,b,e|8),a.elementType=cb,a.type=cb,a.expirationTime=f,a;case hb:return a=Sh(13,c,b,e),a.type=hb,a.elementType=hb,a.expirationTime=f,a;case ib:return a=Sh(19,c,b,e),a.elementType=ib,a.expirationTime=f,a;default:if(\"object\"===typeof a&&null!==a)switch(a.$$typeof){case db:g=\n\t10;break a;case eb:g=9;break a;case gb:g=11;break a;case jb:g=14;break a;case kb:g=16;d=null;break a;case lb:g=22;break a}throw Error(u(130,null==a?a:typeof a,\"\"));}b=Sh(g,c,b,e);b.elementType=a;b.type=d;b.expirationTime=f;return b}function Wg(a,b,c,d){a=Sh(7,a,d,b);a.expirationTime=c;return a}function Tg(a,b,c){a=Sh(6,a,null,b);a.expirationTime=c;return a}\n\tfunction Vg(a,b,c){b=Sh(4,null!==a.children?a.children:[],a.key,b);b.expirationTime=c;b.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation};return b}\n\tfunction ak(a,b,c){this.tag=b;this.current=null;this.containerInfo=a;this.pingCache=this.pendingChildren=null;this.finishedExpirationTime=0;this.finishedWork=null;this.timeoutHandle=-1;this.pendingContext=this.context=null;this.hydrate=c;this.callbackNode=null;this.callbackPriority=90;this.lastExpiredTime=this.lastPingedTime=this.nextKnownPendingLevel=this.lastSuspendedTime=this.firstSuspendedTime=this.firstPendingTime=0}\n\tfunction Aj(a,b){var c=a.firstSuspendedTime;a=a.lastSuspendedTime;return 0!==c&&c>=b&&a<=b}function xi(a,b){var c=a.firstSuspendedTime,d=a.lastSuspendedTime;c<b&&(a.firstSuspendedTime=b);if(d>b||0===c)a.lastSuspendedTime=b;b<=a.lastPingedTime&&(a.lastPingedTime=0);b<=a.lastExpiredTime&&(a.lastExpiredTime=0)}\n\tfunction yi(a,b){b>a.firstPendingTime&&(a.firstPendingTime=b);var c=a.firstSuspendedTime;0!==c&&(b>=c?a.firstSuspendedTime=a.lastSuspendedTime=a.nextKnownPendingLevel=0:b>=a.lastSuspendedTime&&(a.lastSuspendedTime=b+1),b>a.nextKnownPendingLevel&&(a.nextKnownPendingLevel=b))}function Cj(a,b){var c=a.lastExpiredTime;if(0===c||c>b)a.lastExpiredTime=b}\n\tfunction bk(a,b,c,d){var e=b.current,f=Gg(),g=Dg.suspense;f=Hg(f,e,g);a:if(c){c=c._reactInternalFiber;b:{if(dc(c)!==c||1!==c.tag)throw Error(u(170));var h=c;do{switch(h.tag){case 3:h=h.stateNode.context;break b;case 1:if(L(h.type)){h=h.stateNode.__reactInternalMemoizedMergedChildContext;break b}}h=h.return}while(null!==h);throw Error(u(171));}if(1===c.tag){var k=c.type;if(L(k)){c=Ff(c,k,h);break a}}c=h}else c=Af;null===b.context?b.context=c:b.pendingContext=c;b=wg(f,g);b.payload={element:a};d=void 0===\n\td?null:d;null!==d&&(b.callback=d);xg(e,b);Ig(e,f);return f}function ck(a){a=a.current;if(!a.child)return null;switch(a.child.tag){case 5:return a.child.stateNode;default:return a.child.stateNode}}function dk(a,b){a=a.memoizedState;null!==a&&null!==a.dehydrated&&a.retryTime<b&&(a.retryTime=b)}function ek(a,b){dk(a,b);(a=a.alternate)&&dk(a,b)}\n\tfunction fk(a,b,c){c=null!=c&&!0===c.hydrate;var d=new ak(a,b,c),e=Sh(3,null,null,2===b?7:1===b?3:0);d.current=e;e.stateNode=d;ug(e);a[Od]=d.current;c&&0!==b&&Jc(a,9===a.nodeType?a:a.ownerDocument);this._internalRoot=d}fk.prototype.render=function(a){bk(a,this._internalRoot,null,null)};fk.prototype.unmount=function(){var a=this._internalRoot,b=a.containerInfo;bk(null,a,null,function(){b[Od]=null})};\n\tfunction gk(a){return!(!a||1!==a.nodeType&&9!==a.nodeType&&11!==a.nodeType&&(8!==a.nodeType||\" react-mount-point-unstable \"!==a.nodeValue))}function hk(a,b){b||(b=a?9===a.nodeType?a.documentElement:a.firstChild:null,b=!(!b||1!==b.nodeType||!b.hasAttribute(\"data-reactroot\")));if(!b)for(var c;c=a.lastChild;)a.removeChild(c);return new fk(a,0,b?{hydrate:!0}:void 0)}\n\tfunction ik(a,b,c,d,e){var f=c._reactRootContainer;if(f){var g=f._internalRoot;if(\"function\"===typeof e){var h=e;e=function(){var a=ck(g);h.call(a)}}bk(b,g,a,e)}else{f=c._reactRootContainer=hk(c,d);g=f._internalRoot;if(\"function\"===typeof e){var k=e;e=function(){var a=ck(g);k.call(a)}}Nj(function(){bk(b,g,a,e)})}return ck(g)}function jk(a,b,c){var d=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:$a,key:null==d?null:\"\"+d,children:a,containerInfo:b,implementation:c}}\n\twc=function(a){if(13===a.tag){var b=hg(Gg(),150,100);Ig(a,b);ek(a,b)}};xc=function(a){13===a.tag&&(Ig(a,3),ek(a,3))};yc=function(a){if(13===a.tag){var b=Gg();b=Hg(b,a,null);Ig(a,b);ek(a,b)}};\n\tza=function(a,b,c){switch(b){case \"input\":Cb(a,c);b=c.name;if(\"radio\"===c.type&&null!=b){for(c=a;c.parentNode;)c=c.parentNode;c=c.querySelectorAll(\"input[name=\"+JSON.stringify(\"\"+b)+'][type=\"radio\"]');for(b=0;b<c.length;b++){var d=c[b];if(d!==a&&d.form===a.form){var e=Qd(d);if(!e)throw Error(u(90));yb(d);Cb(d,e)}}}break;case \"textarea\":Kb(a,c);break;case \"select\":b=c.value,null!=b&&Hb(a,!!c.multiple,b,!1)}};Fa=Mj;\n\tGa=function(a,b,c,d,e){var f=W;W|=4;try{return cg(98,a.bind(null,b,c,d,e))}finally{W=f,W===V&&gg()}};Ha=function(){(W&(1|fj|gj))===V&&(Lj(),Dj())};Ia=function(a,b){var c=W;W|=2;try{return a(b)}finally{W=c,W===V&&gg()}};function kk(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!gk(b))throw Error(u(200));return jk(a,b,null,c)}var lk={Events:[Nc,Pd,Qd,xa,ta,Xd,function(a){jc(a,Wd)},Da,Ea,id,mc,Dj,{current:!1}]};\n\t(function(a){var b=a.findFiberByHostInstance;return Yj(n({},a,{overrideHookState:null,overrideProps:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Wa.ReactCurrentDispatcher,findHostInstanceByFiber:function(a){a=hc(a);return null===a?null:a.stateNode},findFiberByHostInstance:function(a){return b?b(a):null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null}))})({findFiberByHostInstance:tc,bundleType:0,version:\"16.14.0\",\n\trendererPackageName:\"react-dom\"});exports.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=lk;exports.createPortal=kk;exports.findDOMNode=function(a){if(null==a)return null;if(1===a.nodeType)return a;var b=a._reactInternalFiber;if(void 0===b){if(\"function\"===typeof a.render)throw Error(u(188));throw Error(u(268,Object.keys(a)));}a=hc(b);a=null===a?null:a.stateNode;return a};\n\texports.flushSync=function(a,b){if((W&(fj|gj))!==V)throw Error(u(187));var c=W;W|=1;try{return cg(99,a.bind(null,b))}finally{W=c,gg()}};exports.hydrate=function(a,b,c){if(!gk(b))throw Error(u(200));return ik(null,a,b,!0,c)};exports.render=function(a,b,c){if(!gk(b))throw Error(u(200));return ik(null,a,b,!1,c)};\n\texports.unmountComponentAtNode=function(a){if(!gk(a))throw Error(u(40));return a._reactRootContainer?(Nj(function(){ik(null,null,a,!1,function(){a._reactRootContainer=null;a[Od]=null})}),!0):!1};exports.unstable_batchedUpdates=Mj;exports.unstable_createPortal=function(a,b){return kk(a,b,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null)};\n\texports.unstable_renderSubtreeIntoContainer=function(a,b,c,d){if(!gk(c))throw Error(u(200));if(null==a||void 0===a._reactInternalFiber)throw Error(u(38));return ik(a,b,c,!1,d)};exports.version=\"16.14.0\";\n\n\n/***/ },\n/* 23 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tfunction checkDCE() {\n\t  /* global __REACT_DEVTOOLS_GLOBAL_HOOK__ */\n\t  if (\n\t    typeof __REACT_DEVTOOLS_GLOBAL_HOOK__ === 'undefined' ||\n\t    typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE !== 'function'\n\t  ) {\n\t    return;\n\t  }\n\t  if (false) {\n\t    // This branch is unreachable because this function is only called\n\t    // in production, but the condition is true only in development.\n\t    // Therefore if the branch is still here, dead code elimination wasn't\n\t    // properly applied.\n\t    // Don't change the message. React DevTools relies on it. Also make sure\n\t    // this message doesn't occur elsewhere in this function, or it will cause\n\t    // a false positive.\n\t    throw new Error('^_^');\n\t  }\n\t  try {\n\t    // Verify that the code above has been dead code eliminated (DCE'd).\n\t    __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(checkDCE);\n\t  } catch (err) {\n\t    // DevTools shouldn't crash React, no matter what.\n\t    // We should still report in case we break this code.\n\t    console.error(err);\n\t  }\n\t}\n\t\n\tif (true) {\n\t  // DCE check should happen before ReactDOM bundle executes so that\n\t  // DevTools can report bad minification during injection.\n\t  checkDCE();\n\t  module.exports = __webpack_require__(22);\n\t} else {\n\t  module.exports = require('./cjs/react-dom.development.js');\n\t}\n\n\n/***/ },\n/* 24 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t// @remove-on-eject-begin\n\t/**\n\t * Copyright (c) 2015-present, Facebook, Inc.\n\t * All rights reserved.\n\t *\n\t * This source code is licensed under the BSD-style license found in the\n\t * LICENSE file in the root directory of this source tree. An additional grant\n\t * of patent rights can be found in the PATENTS file in the same directory.\n\t */\n\t// @remove-on-eject-end\n\t'use strict';\n\t\n\tif (typeof Promise === 'undefined') {\n\t  // Rejection tracking prevents a common issue where React gets into an\n\t  // inconsistent state due to an error, but it gets swallowed by a Promise,\n\t  // and the user has no idea what causes React's erratic future behavior.\n\t  __webpack_require__(21).enable();\n\t  window.Promise = __webpack_require__(20);\n\t}\n\t\n\t// fetch() polyfill for making API calls.\n\t__webpack_require__(25);\n\t\n\t// Object.assign() is commonly used with React.\n\t// It will use the native implementation if it's present and isn't buggy.\n\tObject.assign = __webpack_require__(4);\n\n\n/***/ },\n/* 25 */\n/***/ function(module, exports) {\n\n\t(function(self) {\n\t  'use strict';\n\t\n\t  if (self.fetch) {\n\t    return\n\t  }\n\t\n\t  var support = {\n\t    searchParams: 'URLSearchParams' in self,\n\t    iterable: 'Symbol' in self && 'iterator' in Symbol,\n\t    blob: 'FileReader' in self && 'Blob' in self && (function() {\n\t      try {\n\t        new Blob()\n\t        return true\n\t      } catch(e) {\n\t        return false\n\t      }\n\t    })(),\n\t    formData: 'FormData' in self,\n\t    arrayBuffer: 'ArrayBuffer' in self\n\t  }\n\t\n\t  if (support.arrayBuffer) {\n\t    var viewClasses = [\n\t      '[object Int8Array]',\n\t      '[object Uint8Array]',\n\t      '[object Uint8ClampedArray]',\n\t      '[object Int16Array]',\n\t      '[object Uint16Array]',\n\t      '[object Int32Array]',\n\t      '[object Uint32Array]',\n\t      '[object Float32Array]',\n\t      '[object Float64Array]'\n\t    ]\n\t\n\t    var isDataView = function(obj) {\n\t      return obj && DataView.prototype.isPrototypeOf(obj)\n\t    }\n\t\n\t    var isArrayBufferView = ArrayBuffer.isView || function(obj) {\n\t      return obj && viewClasses.indexOf(Object.prototype.toString.call(obj)) > -1\n\t    }\n\t  }\n\t\n\t  function normalizeName(name) {\n\t    if (typeof name !== 'string') {\n\t      name = String(name)\n\t    }\n\t    if (/[^a-z0-9\\-#$%&'*+.\\^_`|~]/i.test(name)) {\n\t      throw new TypeError('Invalid character in header field name')\n\t    }\n\t    return name.toLowerCase()\n\t  }\n\t\n\t  function normalizeValue(value) {\n\t    if (typeof value !== 'string') {\n\t      value = String(value)\n\t    }\n\t    return value\n\t  }\n\t\n\t  // Build a destructive iterator for the value list\n\t  function iteratorFor(items) {\n\t    var iterator = {\n\t      next: function() {\n\t        var value = items.shift()\n\t        return {done: value === undefined, value: value}\n\t      }\n\t    }\n\t\n\t    if (support.iterable) {\n\t      iterator[Symbol.iterator] = function() {\n\t        return iterator\n\t      }\n\t    }\n\t\n\t    return iterator\n\t  }\n\t\n\t  function Headers(headers) {\n\t    this.map = {}\n\t\n\t    if (headers instanceof Headers) {\n\t      headers.forEach(function(value, name) {\n\t        this.append(name, value)\n\t      }, this)\n\t\n\t    } else if (headers) {\n\t      Object.getOwnPropertyNames(headers).forEach(function(name) {\n\t        this.append(name, headers[name])\n\t      }, this)\n\t    }\n\t  }\n\t\n\t  Headers.prototype.append = function(name, value) {\n\t    name = normalizeName(name)\n\t    value = normalizeValue(value)\n\t    var oldValue = this.map[name]\n\t    this.map[name] = oldValue ? oldValue+','+value : value\n\t  }\n\t\n\t  Headers.prototype['delete'] = function(name) {\n\t    delete this.map[normalizeName(name)]\n\t  }\n\t\n\t  Headers.prototype.get = function(name) {\n\t    name = normalizeName(name)\n\t    return this.has(name) ? this.map[name] : null\n\t  }\n\t\n\t  Headers.prototype.has = function(name) {\n\t    return this.map.hasOwnProperty(normalizeName(name))\n\t  }\n\t\n\t  Headers.prototype.set = function(name, value) {\n\t    this.map[normalizeName(name)] = normalizeValue(value)\n\t  }\n\t\n\t  Headers.prototype.forEach = function(callback, thisArg) {\n\t    for (var name in this.map) {\n\t      if (this.map.hasOwnProperty(name)) {\n\t        callback.call(thisArg, this.map[name], name, this)\n\t      }\n\t    }\n\t  }\n\t\n\t  Headers.prototype.keys = function() {\n\t    var items = []\n\t    this.forEach(function(value, name) { items.push(name) })\n\t    return iteratorFor(items)\n\t  }\n\t\n\t  Headers.prototype.values = function() {\n\t    var items = []\n\t    this.forEach(function(value) { items.push(value) })\n\t    return iteratorFor(items)\n\t  }\n\t\n\t  Headers.prototype.entries = function() {\n\t    var items = []\n\t    this.forEach(function(value, name) { items.push([name, value]) })\n\t    return iteratorFor(items)\n\t  }\n\t\n\t  if (support.iterable) {\n\t    Headers.prototype[Symbol.iterator] = Headers.prototype.entries\n\t  }\n\t\n\t  function consumed(body) {\n\t    if (body.bodyUsed) {\n\t      return Promise.reject(new TypeError('Already read'))\n\t    }\n\t    body.bodyUsed = true\n\t  }\n\t\n\t  function fileReaderReady(reader) {\n\t    return new Promise(function(resolve, reject) {\n\t      reader.onload = function() {\n\t        resolve(reader.result)\n\t      }\n\t      reader.onerror = function() {\n\t        reject(reader.error)\n\t      }\n\t    })\n\t  }\n\t\n\t  function readBlobAsArrayBuffer(blob) {\n\t    var reader = new FileReader()\n\t    var promise = fileReaderReady(reader)\n\t    reader.readAsArrayBuffer(blob)\n\t    return promise\n\t  }\n\t\n\t  function readBlobAsText(blob) {\n\t    var reader = new FileReader()\n\t    var promise = fileReaderReady(reader)\n\t    reader.readAsText(blob)\n\t    return promise\n\t  }\n\t\n\t  function readArrayBufferAsText(buf) {\n\t    var view = new Uint8Array(buf)\n\t    var chars = new Array(view.length)\n\t\n\t    for (var i = 0; i < view.length; i++) {\n\t      chars[i] = String.fromCharCode(view[i])\n\t    }\n\t    return chars.join('')\n\t  }\n\t\n\t  function bufferClone(buf) {\n\t    if (buf.slice) {\n\t      return buf.slice(0)\n\t    } else {\n\t      var view = new Uint8Array(buf.byteLength)\n\t      view.set(new Uint8Array(buf))\n\t      return view.buffer\n\t    }\n\t  }\n\t\n\t  function Body() {\n\t    this.bodyUsed = false\n\t\n\t    this._initBody = function(body) {\n\t      this._bodyInit = body\n\t      if (!body) {\n\t        this._bodyText = ''\n\t      } else if (typeof body === 'string') {\n\t        this._bodyText = body\n\t      } else if (support.blob && Blob.prototype.isPrototypeOf(body)) {\n\t        this._bodyBlob = body\n\t      } else if (support.formData && FormData.prototype.isPrototypeOf(body)) {\n\t        this._bodyFormData = body\n\t      } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {\n\t        this._bodyText = body.toString()\n\t      } else if (support.arrayBuffer && support.blob && isDataView(body)) {\n\t        this._bodyArrayBuffer = bufferClone(body.buffer)\n\t        // IE 10-11 can't handle a DataView body.\n\t        this._bodyInit = new Blob([this._bodyArrayBuffer])\n\t      } else if (support.arrayBuffer && (ArrayBuffer.prototype.isPrototypeOf(body) || isArrayBufferView(body))) {\n\t        this._bodyArrayBuffer = bufferClone(body)\n\t      } else {\n\t        throw new Error('unsupported BodyInit type')\n\t      }\n\t\n\t      if (!this.headers.get('content-type')) {\n\t        if (typeof body === 'string') {\n\t          this.headers.set('content-type', 'text/plain;charset=UTF-8')\n\t        } else if (this._bodyBlob && this._bodyBlob.type) {\n\t          this.headers.set('content-type', this._bodyBlob.type)\n\t        } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {\n\t          this.headers.set('content-type', 'application/x-www-form-urlencoded;charset=UTF-8')\n\t        }\n\t      }\n\t    }\n\t\n\t    if (support.blob) {\n\t      this.blob = function() {\n\t        var rejected = consumed(this)\n\t        if (rejected) {\n\t          return rejected\n\t        }\n\t\n\t        if (this._bodyBlob) {\n\t          return Promise.resolve(this._bodyBlob)\n\t        } else if (this._bodyArrayBuffer) {\n\t          return Promise.resolve(new Blob([this._bodyArrayBuffer]))\n\t        } else if (this._bodyFormData) {\n\t          throw new Error('could not read FormData body as blob')\n\t        } else {\n\t          return Promise.resolve(new Blob([this._bodyText]))\n\t        }\n\t      }\n\t\n\t      this.arrayBuffer = function() {\n\t        if (this._bodyArrayBuffer) {\n\t          return consumed(this) || Promise.resolve(this._bodyArrayBuffer)\n\t        } else {\n\t          return this.blob().then(readBlobAsArrayBuffer)\n\t        }\n\t      }\n\t    }\n\t\n\t    this.text = function() {\n\t      var rejected = consumed(this)\n\t      if (rejected) {\n\t        return rejected\n\t      }\n\t\n\t      if (this._bodyBlob) {\n\t        return readBlobAsText(this._bodyBlob)\n\t      } else if (this._bodyArrayBuffer) {\n\t        return Promise.resolve(readArrayBufferAsText(this._bodyArrayBuffer))\n\t      } else if (this._bodyFormData) {\n\t        throw new Error('could not read FormData body as text')\n\t      } else {\n\t        return Promise.resolve(this._bodyText)\n\t      }\n\t    }\n\t\n\t    if (support.formData) {\n\t      this.formData = function() {\n\t        return this.text().then(decode)\n\t      }\n\t    }\n\t\n\t    this.json = function() {\n\t      return this.text().then(JSON.parse)\n\t    }\n\t\n\t    return this\n\t  }\n\t\n\t  // HTTP methods whose capitalization should be normalized\n\t  var methods = ['DELETE', 'GET', 'HEAD', 'OPTIONS', 'POST', 'PUT']\n\t\n\t  function normalizeMethod(method) {\n\t    var upcased = method.toUpperCase()\n\t    return (methods.indexOf(upcased) > -1) ? upcased : method\n\t  }\n\t\n\t  function Request(input, options) {\n\t    options = options || {}\n\t    var body = options.body\n\t\n\t    if (input instanceof Request) {\n\t      if (input.bodyUsed) {\n\t        throw new TypeError('Already read')\n\t      }\n\t      this.url = input.url\n\t      this.credentials = input.credentials\n\t      if (!options.headers) {\n\t        this.headers = new Headers(input.headers)\n\t      }\n\t      this.method = input.method\n\t      this.mode = input.mode\n\t      if (!body && input._bodyInit != null) {\n\t        body = input._bodyInit\n\t        input.bodyUsed = true\n\t      }\n\t    } else {\n\t      this.url = String(input)\n\t    }\n\t\n\t    this.credentials = options.credentials || this.credentials || 'omit'\n\t    if (options.headers || !this.headers) {\n\t      this.headers = new Headers(options.headers)\n\t    }\n\t    this.method = normalizeMethod(options.method || this.method || 'GET')\n\t    this.mode = options.mode || this.mode || null\n\t    this.referrer = null\n\t\n\t    if ((this.method === 'GET' || this.method === 'HEAD') && body) {\n\t      throw new TypeError('Body not allowed for GET or HEAD requests')\n\t    }\n\t    this._initBody(body)\n\t  }\n\t\n\t  Request.prototype.clone = function() {\n\t    return new Request(this, { body: this._bodyInit })\n\t  }\n\t\n\t  function decode(body) {\n\t    var form = new FormData()\n\t    body.trim().split('&').forEach(function(bytes) {\n\t      if (bytes) {\n\t        var split = bytes.split('=')\n\t        var name = split.shift().replace(/\\+/g, ' ')\n\t        var value = split.join('=').replace(/\\+/g, ' ')\n\t        form.append(decodeURIComponent(name), decodeURIComponent(value))\n\t      }\n\t    })\n\t    return form\n\t  }\n\t\n\t  function parseHeaders(rawHeaders) {\n\t    var headers = new Headers()\n\t    rawHeaders.split(/\\r?\\n/).forEach(function(line) {\n\t      var parts = line.split(':')\n\t      var key = parts.shift().trim()\n\t      if (key) {\n\t        var value = parts.join(':').trim()\n\t        headers.append(key, value)\n\t      }\n\t    })\n\t    return headers\n\t  }\n\t\n\t  Body.call(Request.prototype)\n\t\n\t  function Response(bodyInit, options) {\n\t    if (!options) {\n\t      options = {}\n\t    }\n\t\n\t    this.type = 'default'\n\t    this.status = 'status' in options ? options.status : 200\n\t    this.ok = this.status >= 200 && this.status < 300\n\t    this.statusText = 'statusText' in options ? options.statusText : 'OK'\n\t    this.headers = new Headers(options.headers)\n\t    this.url = options.url || ''\n\t    this._initBody(bodyInit)\n\t  }\n\t\n\t  Body.call(Response.prototype)\n\t\n\t  Response.prototype.clone = function() {\n\t    return new Response(this._bodyInit, {\n\t      status: this.status,\n\t      statusText: this.statusText,\n\t      headers: new Headers(this.headers),\n\t      url: this.url\n\t    })\n\t  }\n\t\n\t  Response.error = function() {\n\t    var response = new Response(null, {status: 0, statusText: ''})\n\t    response.type = 'error'\n\t    return response\n\t  }\n\t\n\t  var redirectStatuses = [301, 302, 303, 307, 308]\n\t\n\t  Response.redirect = function(url, status) {\n\t    if (redirectStatuses.indexOf(status) === -1) {\n\t      throw new RangeError('Invalid status code')\n\t    }\n\t\n\t    return new Response(null, {status: status, headers: {location: url}})\n\t  }\n\t\n\t  self.Headers = Headers\n\t  self.Request = Request\n\t  self.Response = Response\n\t\n\t  self.fetch = function(input, init) {\n\t    return new Promise(function(resolve, reject) {\n\t      var request = new Request(input, init)\n\t      var xhr = new XMLHttpRequest()\n\t\n\t      xhr.onload = function() {\n\t        var options = {\n\t          status: xhr.status,\n\t          statusText: xhr.statusText,\n\t          headers: parseHeaders(xhr.getAllResponseHeaders() || '')\n\t        }\n\t        options.url = 'responseURL' in xhr ? xhr.responseURL : options.headers.get('X-Request-URL')\n\t        var body = 'response' in xhr ? xhr.response : xhr.responseText\n\t        resolve(new Response(body, options))\n\t      }\n\t\n\t      xhr.onerror = function() {\n\t        reject(new TypeError('Network request failed'))\n\t      }\n\t\n\t      xhr.ontimeout = function() {\n\t        reject(new TypeError('Network request failed'))\n\t      }\n\t\n\t      xhr.open(request.method, request.url, true)\n\t\n\t      if (request.credentials === 'include') {\n\t        xhr.withCredentials = true\n\t      }\n\t\n\t      if ('responseType' in xhr && support.blob) {\n\t        xhr.responseType = 'blob'\n\t      }\n\t\n\t      request.headers.forEach(function(value, name) {\n\t        xhr.setRequestHeader(name, value)\n\t      })\n\t\n\t      xhr.send(typeof request._bodyInit === 'undefined' ? null : request._bodyInit)\n\t    })\n\t  }\n\t  self.fetch.polyfill = true\n\t})(typeof self !== 'undefined' ? self : this);\n\n\n/***/ },\n/* 26 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t/** @license React v16.14.0\n\t * react.production.min.js\n\t *\n\t * Copyright (c) Facebook, Inc. and its affiliates.\n\t *\n\t * This source code is licensed under the MIT license found in the\n\t * LICENSE file in the root directory of this source tree.\n\t */\n\t\n\t'use strict';var l=__webpack_require__(4),n=\"function\"===typeof Symbol&&Symbol.for,p=n?Symbol.for(\"react.element\"):60103,q=n?Symbol.for(\"react.portal\"):60106,r=n?Symbol.for(\"react.fragment\"):60107,t=n?Symbol.for(\"react.strict_mode\"):60108,u=n?Symbol.for(\"react.profiler\"):60114,v=n?Symbol.for(\"react.provider\"):60109,w=n?Symbol.for(\"react.context\"):60110,x=n?Symbol.for(\"react.forward_ref\"):60112,y=n?Symbol.for(\"react.suspense\"):60113,z=n?Symbol.for(\"react.memo\"):60115,A=n?Symbol.for(\"react.lazy\"):\n\t60116,B=\"function\"===typeof Symbol&&Symbol.iterator;function C(a){for(var b=\"https://reactjs.org/docs/error-decoder.html?invariant=\"+a,c=1;c<arguments.length;c++)b+=\"&args[]=\"+encodeURIComponent(arguments[c]);return\"Minified React error #\"+a+\"; visit \"+b+\" for the full message or use the non-minified dev environment for full errors and additional helpful warnings.\"}\n\tvar D={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},E={};function F(a,b,c){this.props=a;this.context=b;this.refs=E;this.updater=c||D}F.prototype.isReactComponent={};F.prototype.setState=function(a,b){if(\"object\"!==typeof a&&\"function\"!==typeof a&&null!=a)throw Error(C(85));this.updater.enqueueSetState(this,a,b,\"setState\")};F.prototype.forceUpdate=function(a){this.updater.enqueueForceUpdate(this,a,\"forceUpdate\")};\n\tfunction G(){}G.prototype=F.prototype;function H(a,b,c){this.props=a;this.context=b;this.refs=E;this.updater=c||D}var I=H.prototype=new G;I.constructor=H;l(I,F.prototype);I.isPureReactComponent=!0;var J={current:null},K=Object.prototype.hasOwnProperty,L={key:!0,ref:!0,__self:!0,__source:!0};\n\tfunction M(a,b,c){var e,d={},g=null,k=null;if(null!=b)for(e in void 0!==b.ref&&(k=b.ref),void 0!==b.key&&(g=\"\"+b.key),b)K.call(b,e)&&!L.hasOwnProperty(e)&&(d[e]=b[e]);var f=arguments.length-2;if(1===f)d.children=c;else if(1<f){for(var h=Array(f),m=0;m<f;m++)h[m]=arguments[m+2];d.children=h}if(a&&a.defaultProps)for(e in f=a.defaultProps,f)void 0===d[e]&&(d[e]=f[e]);return{$$typeof:p,type:a,key:g,ref:k,props:d,_owner:J.current}}\n\tfunction N(a,b){return{$$typeof:p,type:a.type,key:b,ref:a.ref,props:a.props,_owner:a._owner}}function O(a){return\"object\"===typeof a&&null!==a&&a.$$typeof===p}function escape(a){var b={\"=\":\"=0\",\":\":\"=2\"};return\"$\"+(\"\"+a).replace(/[=:]/g,function(a){return b[a]})}var P=/\\/+/g,Q=[];function R(a,b,c,e){if(Q.length){var d=Q.pop();d.result=a;d.keyPrefix=b;d.func=c;d.context=e;d.count=0;return d}return{result:a,keyPrefix:b,func:c,context:e,count:0}}\n\tfunction S(a){a.result=null;a.keyPrefix=null;a.func=null;a.context=null;a.count=0;10>Q.length&&Q.push(a)}\n\tfunction T(a,b,c,e){var d=typeof a;if(\"undefined\"===d||\"boolean\"===d)a=null;var g=!1;if(null===a)g=!0;else switch(d){case \"string\":case \"number\":g=!0;break;case \"object\":switch(a.$$typeof){case p:case q:g=!0}}if(g)return c(e,a,\"\"===b?\".\"+U(a,0):b),1;g=0;b=\"\"===b?\".\":b+\":\";if(Array.isArray(a))for(var k=0;k<a.length;k++){d=a[k];var f=b+U(d,k);g+=T(d,f,c,e)}else if(null===a||\"object\"!==typeof a?f=null:(f=B&&a[B]||a[\"@@iterator\"],f=\"function\"===typeof f?f:null),\"function\"===typeof f)for(a=f.call(a),k=\n\t0;!(d=a.next()).done;)d=d.value,f=b+U(d,k++),g+=T(d,f,c,e);else if(\"object\"===d)throw c=\"\"+a,Error(C(31,\"[object Object]\"===c?\"object with keys {\"+Object.keys(a).join(\", \")+\"}\":c,\"\"));return g}function V(a,b,c){return null==a?0:T(a,\"\",b,c)}function U(a,b){return\"object\"===typeof a&&null!==a&&null!=a.key?escape(a.key):b.toString(36)}function W(a,b){a.func.call(a.context,b,a.count++)}\n\tfunction aa(a,b,c){var e=a.result,d=a.keyPrefix;a=a.func.call(a.context,b,a.count++);Array.isArray(a)?X(a,e,c,function(a){return a}):null!=a&&(O(a)&&(a=N(a,d+(!a.key||b&&b.key===a.key?\"\":(\"\"+a.key).replace(P,\"$&/\")+\"/\")+c)),e.push(a))}function X(a,b,c,e,d){var g=\"\";null!=c&&(g=(\"\"+c).replace(P,\"$&/\")+\"/\");b=R(b,g,e,d);V(a,aa,b);S(b)}var Y={current:null};function Z(){var a=Y.current;if(null===a)throw Error(C(321));return a}\n\tvar ba={ReactCurrentDispatcher:Y,ReactCurrentBatchConfig:{suspense:null},ReactCurrentOwner:J,IsSomeRendererActing:{current:!1},assign:l};exports.Children={map:function(a,b,c){if(null==a)return a;var e=[];X(a,e,null,b,c);return e},forEach:function(a,b,c){if(null==a)return a;b=R(null,null,b,c);V(a,W,b);S(b)},count:function(a){return V(a,function(){return null},null)},toArray:function(a){var b=[];X(a,b,null,function(a){return a});return b},only:function(a){if(!O(a))throw Error(C(143));return a}};\n\texports.Component=F;exports.Fragment=r;exports.Profiler=u;exports.PureComponent=H;exports.StrictMode=t;exports.Suspense=y;exports.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ba;\n\texports.cloneElement=function(a,b,c){if(null===a||void 0===a)throw Error(C(267,a));var e=l({},a.props),d=a.key,g=a.ref,k=a._owner;if(null!=b){void 0!==b.ref&&(g=b.ref,k=J.current);void 0!==b.key&&(d=\"\"+b.key);if(a.type&&a.type.defaultProps)var f=a.type.defaultProps;for(h in b)K.call(b,h)&&!L.hasOwnProperty(h)&&(e[h]=void 0===b[h]&&void 0!==f?f[h]:b[h])}var h=arguments.length-2;if(1===h)e.children=c;else if(1<h){f=Array(h);for(var m=0;m<h;m++)f[m]=arguments[m+2];e.children=f}return{$$typeof:p,type:a.type,\n\tkey:d,ref:g,props:e,_owner:k}};exports.createContext=function(a,b){void 0===b&&(b=null);a={$$typeof:w,_calculateChangedBits:b,_currentValue:a,_currentValue2:a,_threadCount:0,Provider:null,Consumer:null};a.Provider={$$typeof:v,_context:a};return a.Consumer=a};exports.createElement=M;exports.createFactory=function(a){var b=M.bind(null,a);b.type=a;return b};exports.createRef=function(){return{current:null}};exports.forwardRef=function(a){return{$$typeof:x,render:a}};exports.isValidElement=O;\n\texports.lazy=function(a){return{$$typeof:A,_ctor:a,_status:-1,_result:null}};exports.memo=function(a,b){return{$$typeof:z,type:a,compare:void 0===b?null:b}};exports.useCallback=function(a,b){return Z().useCallback(a,b)};exports.useContext=function(a,b){return Z().useContext(a,b)};exports.useDebugValue=function(){};exports.useEffect=function(a,b){return Z().useEffect(a,b)};exports.useImperativeHandle=function(a,b,c){return Z().useImperativeHandle(a,b,c)};\n\texports.useLayoutEffect=function(a,b){return Z().useLayoutEffect(a,b)};exports.useMemo=function(a,b){return Z().useMemo(a,b)};exports.useReducer=function(a,b,c){return Z().useReducer(a,b,c)};exports.useRef=function(a){return Z().useRef(a)};exports.useState=function(a){return Z().useState(a)};exports.version=\"16.14.0\";\n\n\n/***/ },\n/* 27 */\n/***/ function(module, exports) {\n\n\t/** @license React v0.19.1\n\t * scheduler.production.min.js\n\t *\n\t * Copyright (c) Facebook, Inc. and its affiliates.\n\t *\n\t * This source code is licensed under the MIT license found in the\n\t * LICENSE file in the root directory of this source tree.\n\t */\n\t\n\t'use strict';var f,g,h,k,l;\n\tif(\"undefined\"===typeof window||\"function\"!==typeof MessageChannel){var p=null,q=null,t=function(){if(null!==p)try{var a=exports.unstable_now();p(!0,a);p=null}catch(b){throw setTimeout(t,0),b;}},u=Date.now();exports.unstable_now=function(){return Date.now()-u};f=function(a){null!==p?setTimeout(f,0,a):(p=a,setTimeout(t,0))};g=function(a,b){q=setTimeout(a,b)};h=function(){clearTimeout(q)};k=function(){return!1};l=exports.unstable_forceFrameRate=function(){}}else{var w=window.performance,x=window.Date,\n\ty=window.setTimeout,z=window.clearTimeout;if(\"undefined\"!==typeof console){var A=window.cancelAnimationFrame;\"function\"!==typeof window.requestAnimationFrame&&console.error(\"This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills\");\"function\"!==typeof A&&console.error(\"This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills\")}if(\"object\"===\n\ttypeof w&&\"function\"===typeof w.now)exports.unstable_now=function(){return w.now()};else{var B=x.now();exports.unstable_now=function(){return x.now()-B}}var C=!1,D=null,E=-1,F=5,G=0;k=function(){return exports.unstable_now()>=G};l=function(){};exports.unstable_forceFrameRate=function(a){0>a||125<a?console.error(\"forceFrameRate takes a positive int between 0 and 125, forcing framerates higher than 125 fps is not unsupported\"):F=0<a?Math.floor(1E3/a):5};var H=new MessageChannel,I=H.port2;H.port1.onmessage=\n\tfunction(){if(null!==D){var a=exports.unstable_now();G=a+F;try{D(!0,a)?I.postMessage(null):(C=!1,D=null)}catch(b){throw I.postMessage(null),b;}}else C=!1};f=function(a){D=a;C||(C=!0,I.postMessage(null))};g=function(a,b){E=y(function(){a(exports.unstable_now())},b)};h=function(){z(E);E=-1}}function J(a,b){var c=a.length;a.push(b);a:for(;;){var d=c-1>>>1,e=a[d];if(void 0!==e&&0<K(e,b))a[d]=b,a[c]=e,c=d;else break a}}function L(a){a=a[0];return void 0===a?null:a}\n\tfunction M(a){var b=a[0];if(void 0!==b){var c=a.pop();if(c!==b){a[0]=c;a:for(var d=0,e=a.length;d<e;){var m=2*(d+1)-1,n=a[m],v=m+1,r=a[v];if(void 0!==n&&0>K(n,c))void 0!==r&&0>K(r,n)?(a[d]=r,a[v]=c,d=v):(a[d]=n,a[m]=c,d=m);else if(void 0!==r&&0>K(r,c))a[d]=r,a[v]=c,d=v;else break a}}return b}return null}function K(a,b){var c=a.sortIndex-b.sortIndex;return 0!==c?c:a.id-b.id}var N=[],O=[],P=1,Q=null,R=3,S=!1,T=!1,U=!1;\n\tfunction V(a){for(var b=L(O);null!==b;){if(null===b.callback)M(O);else if(b.startTime<=a)M(O),b.sortIndex=b.expirationTime,J(N,b);else break;b=L(O)}}function W(a){U=!1;V(a);if(!T)if(null!==L(N))T=!0,f(X);else{var b=L(O);null!==b&&g(W,b.startTime-a)}}\n\tfunction X(a,b){T=!1;U&&(U=!1,h());S=!0;var c=R;try{V(b);for(Q=L(N);null!==Q&&(!(Q.expirationTime>b)||a&&!k());){var d=Q.callback;if(null!==d){Q.callback=null;R=Q.priorityLevel;var e=d(Q.expirationTime<=b);b=exports.unstable_now();\"function\"===typeof e?Q.callback=e:Q===L(N)&&M(N);V(b)}else M(N);Q=L(N)}if(null!==Q)var m=!0;else{var n=L(O);null!==n&&g(W,n.startTime-b);m=!1}return m}finally{Q=null,R=c,S=!1}}\n\tfunction Y(a){switch(a){case 1:return-1;case 2:return 250;case 5:return 1073741823;case 4:return 1E4;default:return 5E3}}var Z=l;exports.unstable_IdlePriority=5;exports.unstable_ImmediatePriority=1;exports.unstable_LowPriority=4;exports.unstable_NormalPriority=3;exports.unstable_Profiling=null;exports.unstable_UserBlockingPriority=2;exports.unstable_cancelCallback=function(a){a.callback=null};exports.unstable_continueExecution=function(){T||S||(T=!0,f(X))};\n\texports.unstable_getCurrentPriorityLevel=function(){return R};exports.unstable_getFirstCallbackNode=function(){return L(N)};exports.unstable_next=function(a){switch(R){case 1:case 2:case 3:var b=3;break;default:b=R}var c=R;R=b;try{return a()}finally{R=c}};exports.unstable_pauseExecution=function(){};exports.unstable_requestPaint=Z;exports.unstable_runWithPriority=function(a,b){switch(a){case 1:case 2:case 3:case 4:case 5:break;default:a=3}var c=R;R=a;try{return b()}finally{R=c}};\n\texports.unstable_scheduleCallback=function(a,b,c){var d=exports.unstable_now();if(\"object\"===typeof c&&null!==c){var e=c.delay;e=\"number\"===typeof e&&0<e?d+e:d;c=\"number\"===typeof c.timeout?c.timeout:Y(a)}else c=Y(a),e=d;c=e+c;a={id:P++,callback:b,priorityLevel:a,startTime:e,expirationTime:c,sortIndex:-1};e>d?(a.sortIndex=e,J(O,a),null===L(N)&&a===L(O)&&(U?h():U=!0,g(W,e-d))):(a.sortIndex=c,J(N,a),T||S||(T=!0,f(X)));return a};\n\texports.unstable_shouldYield=function(){var a=exports.unstable_now();V(a);var b=L(N);return b!==Q&&null!==Q&&null!==b&&null!==b.callback&&b.startTime<=a&&b.expirationTime<Q.expirationTime||k()};exports.unstable_wrapCallback=function(a){var b=R;return function(){var c=R;R=b;try{return a.apply(this,arguments)}finally{R=c}}};\n\n\n/***/ },\n/* 28 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tif (true) {\n\t  module.exports = __webpack_require__(27);\n\t} else {\n\t  module.exports = require('./cjs/scheduler.development.js');\n\t}\n\n\n/***/ },\n/* 29 */\n/***/ function(module, exports) {\n\n\t(function(self) {\n\t  'use strict';\n\t\n\t  if (self.fetch) {\n\t    return\n\t  }\n\t\n\t  var support = {\n\t    searchParams: 'URLSearchParams' in self,\n\t    iterable: 'Symbol' in self && 'iterator' in Symbol,\n\t    blob: 'FileReader' in self && 'Blob' in self && (function() {\n\t      try {\n\t        new Blob()\n\t        return true\n\t      } catch(e) {\n\t        return false\n\t      }\n\t    })(),\n\t    formData: 'FormData' in self,\n\t    arrayBuffer: 'ArrayBuffer' in self\n\t  }\n\t\n\t  if (support.arrayBuffer) {\n\t    var viewClasses = [\n\t      '[object Int8Array]',\n\t      '[object Uint8Array]',\n\t      '[object Uint8ClampedArray]',\n\t      '[object Int16Array]',\n\t      '[object Uint16Array]',\n\t      '[object Int32Array]',\n\t      '[object Uint32Array]',\n\t      '[object Float32Array]',\n\t      '[object Float64Array]'\n\t    ]\n\t\n\t    var isDataView = function(obj) {\n\t      return obj && DataView.prototype.isPrototypeOf(obj)\n\t    }\n\t\n\t    var isArrayBufferView = ArrayBuffer.isView || function(obj) {\n\t      return obj && viewClasses.indexOf(Object.prototype.toString.call(obj)) > -1\n\t    }\n\t  }\n\t\n\t  function normalizeName(name) {\n\t    if (typeof name !== 'string') {\n\t      name = String(name)\n\t    }\n\t    if (/[^a-z0-9\\-#$%&'*+.\\^_`|~]/i.test(name)) {\n\t      throw new TypeError('Invalid character in header field name')\n\t    }\n\t    return name.toLowerCase()\n\t  }\n\t\n\t  function normalizeValue(value) {\n\t    if (typeof value !== 'string') {\n\t      value = String(value)\n\t    }\n\t    return value\n\t  }\n\t\n\t  // Build a destructive iterator for the value list\n\t  function iteratorFor(items) {\n\t    var iterator = {\n\t      next: function() {\n\t        var value = items.shift()\n\t        return {done: value === undefined, value: value}\n\t      }\n\t    }\n\t\n\t    if (support.iterable) {\n\t      iterator[Symbol.iterator] = function() {\n\t        return iterator\n\t      }\n\t    }\n\t\n\t    return iterator\n\t  }\n\t\n\t  function Headers(headers) {\n\t    this.map = {}\n\t\n\t    if (headers instanceof Headers) {\n\t      headers.forEach(function(value, name) {\n\t        this.append(name, value)\n\t      }, this)\n\t    } else if (Array.isArray(headers)) {\n\t      headers.forEach(function(header) {\n\t        this.append(header[0], header[1])\n\t      }, this)\n\t    } else if (headers) {\n\t      Object.getOwnPropertyNames(headers).forEach(function(name) {\n\t        this.append(name, headers[name])\n\t      }, this)\n\t    }\n\t  }\n\t\n\t  Headers.prototype.append = function(name, value) {\n\t    name = normalizeName(name)\n\t    value = normalizeValue(value)\n\t    var oldValue = this.map[name]\n\t    this.map[name] = oldValue ? oldValue+','+value : value\n\t  }\n\t\n\t  Headers.prototype['delete'] = function(name) {\n\t    delete this.map[normalizeName(name)]\n\t  }\n\t\n\t  Headers.prototype.get = function(name) {\n\t    name = normalizeName(name)\n\t    return this.has(name) ? this.map[name] : null\n\t  }\n\t\n\t  Headers.prototype.has = function(name) {\n\t    return this.map.hasOwnProperty(normalizeName(name))\n\t  }\n\t\n\t  Headers.prototype.set = function(name, value) {\n\t    this.map[normalizeName(name)] = normalizeValue(value)\n\t  }\n\t\n\t  Headers.prototype.forEach = function(callback, thisArg) {\n\t    for (var name in this.map) {\n\t      if (this.map.hasOwnProperty(name)) {\n\t        callback.call(thisArg, this.map[name], name, this)\n\t      }\n\t    }\n\t  }\n\t\n\t  Headers.prototype.keys = function() {\n\t    var items = []\n\t    this.forEach(function(value, name) { items.push(name) })\n\t    return iteratorFor(items)\n\t  }\n\t\n\t  Headers.prototype.values = function() {\n\t    var items = []\n\t    this.forEach(function(value) { items.push(value) })\n\t    return iteratorFor(items)\n\t  }\n\t\n\t  Headers.prototype.entries = function() {\n\t    var items = []\n\t    this.forEach(function(value, name) { items.push([name, value]) })\n\t    return iteratorFor(items)\n\t  }\n\t\n\t  if (support.iterable) {\n\t    Headers.prototype[Symbol.iterator] = Headers.prototype.entries\n\t  }\n\t\n\t  function consumed(body) {\n\t    if (body.bodyUsed) {\n\t      return Promise.reject(new TypeError('Already read'))\n\t    }\n\t    body.bodyUsed = true\n\t  }\n\t\n\t  function fileReaderReady(reader) {\n\t    return new Promise(function(resolve, reject) {\n\t      reader.onload = function() {\n\t        resolve(reader.result)\n\t      }\n\t      reader.onerror = function() {\n\t        reject(reader.error)\n\t      }\n\t    })\n\t  }\n\t\n\t  function readBlobAsArrayBuffer(blob) {\n\t    var reader = new FileReader()\n\t    var promise = fileReaderReady(reader)\n\t    reader.readAsArrayBuffer(blob)\n\t    return promise\n\t  }\n\t\n\t  function readBlobAsText(blob) {\n\t    var reader = new FileReader()\n\t    var promise = fileReaderReady(reader)\n\t    reader.readAsText(blob)\n\t    return promise\n\t  }\n\t\n\t  function readArrayBufferAsText(buf) {\n\t    var view = new Uint8Array(buf)\n\t    var chars = new Array(view.length)\n\t\n\t    for (var i = 0; i < view.length; i++) {\n\t      chars[i] = String.fromCharCode(view[i])\n\t    }\n\t    return chars.join('')\n\t  }\n\t\n\t  function bufferClone(buf) {\n\t    if (buf.slice) {\n\t      return buf.slice(0)\n\t    } else {\n\t      var view = new Uint8Array(buf.byteLength)\n\t      view.set(new Uint8Array(buf))\n\t      return view.buffer\n\t    }\n\t  }\n\t\n\t  function Body() {\n\t    this.bodyUsed = false\n\t\n\t    this._initBody = function(body) {\n\t      this._bodyInit = body\n\t      if (!body) {\n\t        this._bodyText = ''\n\t      } else if (typeof body === 'string') {\n\t        this._bodyText = body\n\t      } else if (support.blob && Blob.prototype.isPrototypeOf(body)) {\n\t        this._bodyBlob = body\n\t      } else if (support.formData && FormData.prototype.isPrototypeOf(body)) {\n\t        this._bodyFormData = body\n\t      } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {\n\t        this._bodyText = body.toString()\n\t      } else if (support.arrayBuffer && support.blob && isDataView(body)) {\n\t        this._bodyArrayBuffer = bufferClone(body.buffer)\n\t        // IE 10-11 can't handle a DataView body.\n\t        this._bodyInit = new Blob([this._bodyArrayBuffer])\n\t      } else if (support.arrayBuffer && (ArrayBuffer.prototype.isPrototypeOf(body) || isArrayBufferView(body))) {\n\t        this._bodyArrayBuffer = bufferClone(body)\n\t      } else {\n\t        throw new Error('unsupported BodyInit type')\n\t      }\n\t\n\t      if (!this.headers.get('content-type')) {\n\t        if (typeof body === 'string') {\n\t          this.headers.set('content-type', 'text/plain;charset=UTF-8')\n\t        } else if (this._bodyBlob && this._bodyBlob.type) {\n\t          this.headers.set('content-type', this._bodyBlob.type)\n\t        } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {\n\t          this.headers.set('content-type', 'application/x-www-form-urlencoded;charset=UTF-8')\n\t        }\n\t      }\n\t    }\n\t\n\t    if (support.blob) {\n\t      this.blob = function() {\n\t        var rejected = consumed(this)\n\t        if (rejected) {\n\t          return rejected\n\t        }\n\t\n\t        if (this._bodyBlob) {\n\t          return Promise.resolve(this._bodyBlob)\n\t        } else if (this._bodyArrayBuffer) {\n\t          return Promise.resolve(new Blob([this._bodyArrayBuffer]))\n\t        } else if (this._bodyFormData) {\n\t          throw new Error('could not read FormData body as blob')\n\t        } else {\n\t          return Promise.resolve(new Blob([this._bodyText]))\n\t        }\n\t      }\n\t\n\t      this.arrayBuffer = function() {\n\t        if (this._bodyArrayBuffer) {\n\t          return consumed(this) || Promise.resolve(this._bodyArrayBuffer)\n\t        } else {\n\t          return this.blob().then(readBlobAsArrayBuffer)\n\t        }\n\t      }\n\t    }\n\t\n\t    this.text = function() {\n\t      var rejected = consumed(this)\n\t      if (rejected) {\n\t        return rejected\n\t      }\n\t\n\t      if (this._bodyBlob) {\n\t        return readBlobAsText(this._bodyBlob)\n\t      } else if (this._bodyArrayBuffer) {\n\t        return Promise.resolve(readArrayBufferAsText(this._bodyArrayBuffer))\n\t      } else if (this._bodyFormData) {\n\t        throw new Error('could not read FormData body as text')\n\t      } else {\n\t        return Promise.resolve(this._bodyText)\n\t      }\n\t    }\n\t\n\t    if (support.formData) {\n\t      this.formData = function() {\n\t        return this.text().then(decode)\n\t      }\n\t    }\n\t\n\t    this.json = function() {\n\t      return this.text().then(JSON.parse)\n\t    }\n\t\n\t    return this\n\t  }\n\t\n\t  // HTTP methods whose capitalization should be normalized\n\t  var methods = ['DELETE', 'GET', 'HEAD', 'OPTIONS', 'POST', 'PUT']\n\t\n\t  function normalizeMethod(method) {\n\t    var upcased = method.toUpperCase()\n\t    return (methods.indexOf(upcased) > -1) ? upcased : method\n\t  }\n\t\n\t  function Request(input, options) {\n\t    options = options || {}\n\t    var body = options.body\n\t\n\t    if (input instanceof Request) {\n\t      if (input.bodyUsed) {\n\t        throw new TypeError('Already read')\n\t      }\n\t      this.url = input.url\n\t      this.credentials = input.credentials\n\t      if (!options.headers) {\n\t        this.headers = new Headers(input.headers)\n\t      }\n\t      this.method = input.method\n\t      this.mode = input.mode\n\t      if (!body && input._bodyInit != null) {\n\t        body = input._bodyInit\n\t        input.bodyUsed = true\n\t      }\n\t    } else {\n\t      this.url = String(input)\n\t    }\n\t\n\t    this.credentials = options.credentials || this.credentials || 'omit'\n\t    if (options.headers || !this.headers) {\n\t      this.headers = new Headers(options.headers)\n\t    }\n\t    this.method = normalizeMethod(options.method || this.method || 'GET')\n\t    this.mode = options.mode || this.mode || null\n\t    this.referrer = null\n\t\n\t    if ((this.method === 'GET' || this.method === 'HEAD') && body) {\n\t      throw new TypeError('Body not allowed for GET or HEAD requests')\n\t    }\n\t    this._initBody(body)\n\t  }\n\t\n\t  Request.prototype.clone = function() {\n\t    return new Request(this, { body: this._bodyInit })\n\t  }\n\t\n\t  function decode(body) {\n\t    var form = new FormData()\n\t    body.trim().split('&').forEach(function(bytes) {\n\t      if (bytes) {\n\t        var split = bytes.split('=')\n\t        var name = split.shift().replace(/\\+/g, ' ')\n\t        var value = split.join('=').replace(/\\+/g, ' ')\n\t        form.append(decodeURIComponent(name), decodeURIComponent(value))\n\t      }\n\t    })\n\t    return form\n\t  }\n\t\n\t  function parseHeaders(rawHeaders) {\n\t    var headers = new Headers()\n\t    // Replace instances of \\r\\n and \\n followed by at least one space or horizontal tab with a space\n\t    // https://tools.ietf.org/html/rfc7230#section-3.2\n\t    var preProcessedHeaders = rawHeaders.replace(/\\r?\\n[\\t ]+/g, ' ')\n\t    preProcessedHeaders.split(/\\r?\\n/).forEach(function(line) {\n\t      var parts = line.split(':')\n\t      var key = parts.shift().trim()\n\t      if (key) {\n\t        var value = parts.join(':').trim()\n\t        headers.append(key, value)\n\t      }\n\t    })\n\t    return headers\n\t  }\n\t\n\t  Body.call(Request.prototype)\n\t\n\t  function Response(bodyInit, options) {\n\t    if (!options) {\n\t      options = {}\n\t    }\n\t\n\t    this.type = 'default'\n\t    this.status = options.status === undefined ? 200 : options.status\n\t    this.ok = this.status >= 200 && this.status < 300\n\t    this.statusText = 'statusText' in options ? options.statusText : 'OK'\n\t    this.headers = new Headers(options.headers)\n\t    this.url = options.url || ''\n\t    this._initBody(bodyInit)\n\t  }\n\t\n\t  Body.call(Response.prototype)\n\t\n\t  Response.prototype.clone = function() {\n\t    return new Response(this._bodyInit, {\n\t      status: this.status,\n\t      statusText: this.statusText,\n\t      headers: new Headers(this.headers),\n\t      url: this.url\n\t    })\n\t  }\n\t\n\t  Response.error = function() {\n\t    var response = new Response(null, {status: 0, statusText: ''})\n\t    response.type = 'error'\n\t    return response\n\t  }\n\t\n\t  var redirectStatuses = [301, 302, 303, 307, 308]\n\t\n\t  Response.redirect = function(url, status) {\n\t    if (redirectStatuses.indexOf(status) === -1) {\n\t      throw new RangeError('Invalid status code')\n\t    }\n\t\n\t    return new Response(null, {status: status, headers: {location: url}})\n\t  }\n\t\n\t  self.Headers = Headers\n\t  self.Request = Request\n\t  self.Response = Response\n\t\n\t  self.fetch = function(input, init) {\n\t    return new Promise(function(resolve, reject) {\n\t      var request = new Request(input, init)\n\t      var xhr = new XMLHttpRequest()\n\t\n\t      xhr.onload = function() {\n\t        var options = {\n\t          status: xhr.status,\n\t          statusText: xhr.statusText,\n\t          headers: parseHeaders(xhr.getAllResponseHeaders() || '')\n\t        }\n\t        options.url = 'responseURL' in xhr ? xhr.responseURL : options.headers.get('X-Request-URL')\n\t        var body = 'response' in xhr ? xhr.response : xhr.responseText\n\t        resolve(new Response(body, options))\n\t      }\n\t\n\t      xhr.onerror = function() {\n\t        reject(new TypeError('Network request failed'))\n\t      }\n\t\n\t      xhr.ontimeout = function() {\n\t        reject(new TypeError('Network request failed'))\n\t      }\n\t\n\t      xhr.open(request.method, request.url, true)\n\t\n\t      if (request.credentials === 'include') {\n\t        xhr.withCredentials = true\n\t      } else if (request.credentials === 'omit') {\n\t        xhr.withCredentials = false\n\t      }\n\t\n\t      if ('responseType' in xhr && support.blob) {\n\t        xhr.responseType = 'blob'\n\t      }\n\t\n\t      request.headers.forEach(function(value, name) {\n\t        xhr.setRequestHeader(name, value)\n\t      })\n\t\n\t      xhr.send(typeof request._bodyInit === 'undefined' ? null : request._bodyInit)\n\t    })\n\t  }\n\t  self.fetch.polyfill = true\n\t})(typeof self !== 'undefined' ? self : this);\n\n\n/***/ }\n/******/ ])));\n\n\n// WEBPACK FOOTER //\n// static/js/main.fa9dcaf2.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 9b28139110d784bedd41","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('./cjs/react.production.min.js');\n} else {\n  module.exports = require('./cjs/react.development.js');\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/react/index.js\n// module id = 1\n// module chunks = 0","export let APP_NAME = \"Invoice Suite\";\n\nexport let DATA = \n{\n    \"ledger\":{\n        \"iPad\":{\n        \t\"msc\": {\"numsheets\":4,\"currentid\":\"sheet1\",\"currentname\":\"typei\",\"sheetArr\":{\"sheet1\":{\"sheetstr\":{\"savestr\":\"version:1.5\\ncell:A2:b::2:::l:1:f:7\\ncell:B2:t:INVOICE:b:1:1:1:1:f:6:cf:1:colspan:6\\ncell:C2:t::b:2::2::l:1:f:7\\ncell:D2:t::b:2::2::l:1:f:7\\ncell:E2:t::b:2::2::l:1:f:7\\ncell:F2:t::b:2::2::l:1:f:7\\ncell:G2:t::b:2::2::l:1:f:7\\ncell:A3:b::2:::l:3:f:7\\ncell:B3:b:2:::2:l:3:f:7\\ncell:C3:b:2::::l:1:f:7\\ncell:D3:b:2::::l:1:f:7\\ncell:E3:b:2::::l:1:f:7\\ncell:F3:b:2::::l:1:f:7\\ncell:G3:b:2:2:::l:3:f:7\\ncell:A4:b::2:::l:3:f:7\\ncell:B4:b::::2:l:3:f:3\\ncell:C4:t:INVOICE # \\\\c:f:2:cf:2\\ncell:D4:v:1:f:2:cf:2\\ncell:F4:tvf:4:rowspan:4\\ncell:G4:b::2:::l:3:f:7\\ncell:A5:b::2:::l:3:f:7\\ncell:B5:b::::2:l:3:f:4\\ncell:F5:t::l:2:f:7\\ncell:G5:t::b::1:::l:2:f:7\\ncell:A6:b::2:::l:3:f:7\\ncell:B6:b::::2:l:3:f:4\\ncell:C6:t:INVOICE DATE\\\\c:f:2:cf:2\\ncell:D6:f:2:cf:2:ntvf:3\\ncell:F6:l:2:f:7\\ncell:G6:b::1:::l:2:f:7\\ncell:A7:b::2:::l:3:f:7\\ncell:B7:b::::2:l:3:f:4\\ncell:G7:b::2:::l:3:f:7\\ncell:A8:b::2:::l:3:f:7\\ncell:B8:b::::2:l:3:f:4\\ncell:G8:b::2:::l:3:f:7\\ncell:A9:b::2:::l:3:f:7\\ncell:B9:b::::2:l:3:f:4\\ncell:C9:t:BILL TO\\\\c:l:3:f:2\\ncell:E9:t:FROM\\\\c:f:2:cf:2\\ncell:G9:b::2:::l:3:f:7\\ncell:A10:b::2:::l:3:f:7\\ncell:B10:b::::2:l:3:f:3\\ncell:C10:t:[Name]:f:1:cf:2:colspan:2\\ncell:E10:t:[Name]:f:1:cf:2:colspan:2\\ncell:G10:b::2:::l:3:f:7\\ncell:A11:b::2:::l:3:f:7\\ncell:B11:b::::2:l:3:f:7\\ncell:C11:t:[Street Address]:f:1:cf:2:colspan:2\\ncell:E11:t:[Street Address]:f:1:cf:2:colspan:2\\ncell:G11:b::2:::l:3:f:7\\ncell:A12:b::2:::l:3:f:7\\ncell:B12:b::::2:l:3:f:7\\ncell:C12:t:[City, State, Zip]:f:1:cf:2:colspan:2\\ncell:E12:t:[City, State, Zip]:f:1:cf:2:colspan:2\\ncell:G12:b::2:::l:3:f:7\\ncell:A13:b::2:::l:3:f:7\\ncell:B13:b::::2:l:3:f:7\\ncell:C13:t:Phone\\\\c:f:1:cf:2:colspan:2\\ncell:E13:t:Phone\\\\c:f:1:cf:2:colspan:2\\ncell:G13:b::2:::l:3:f:7\\ncell:A14:b::2:::l:3:f:7\\ncell:B14:b::::2:l:3:f:3:cf:2\\ncell:C14:b:::2::l:1:f:7\\ncell:D14:b:::2::l:3:f:3:cf:2\\ncell:E14:b:::2::l:1:f:7\\ncell:F14:b:::2::l:1:f:7\\ncell:G14:b::2:::l:3:f:7\\ncell:A15:b::2:::l:3:f:7\\ncell:B15:b::2::2:l:3:f:7\\ncell:C15:t:Description:b:1::1:1:f:2:cf:1:colspan:3\\ncell:D15:t:Description:b:1::1::l:3:f:3:cf:2:colspan:2:rowspan:1\\ncell:E15:t::b:2:2:2::l:1:f:7\\ncell:F15:t:Amount:b:1:1:1:1:f:2:cf:1\\ncell:G15:b::2::2:l:3:f:7\\ncell:A16:b::2:::l:3:f:7\\ncell:B16:b::2::2:l:3:f:7\\ncell:C16:b:1:1::1:f:1:cf:2:colspan:3\\ncell:D16:b:1:1:::l:3:f:7:cf:2:colspan:2:rowspan:1\\ncell:E16:t::b:2:2:2::l:1:f:7\\ncell:F16:b:1:1:::f:1:ntvf:1\\ncell:G16:b::2::2:l:3:f:7\\ncell:A17:b::2:::l:3:f:7\\ncell:B17:b::2::2:l:3:f:7:cf:2\\ncell:C17:b::1::1:f:1:cf:2:colspan:3\\ncell:D17:b::1:::l:1:f:7:colspan:2\\ncell:E17:l:1:f:7\\ncell:F17:b::1:::f:1:ntvf:1\\ncell:G17:b::2::2:l:3:f:7\\ncell:A18:b::2:::l:3:f:7\\ncell:B18:b::2::2:l:3:f:7:cf:2:ntvf:2\\ncell:C18:b::1::1:f:1:cf:2:colspan:3\\ncell:D18:b::1:::colspan:2\\ncell:F18:b::1:::f:1:ntvf:1\\ncell:G18:b::2::2:l:3:f:7\\ncell:A19:b::2:::l:3:f:7\\ncell:B19:b::2::2:l:3:f:7:cf:2:ntvf:2\\ncell:C19:b::1::1:f:1:cf:2:colspan:3\\ncell:D19:b::1:::colspan:2\\ncell:F19:b::1:::f:1:ntvf:1\\ncell:G19:b::2::2:l:3:f:7\\ncell:A20:b::2:::l:3:f:7\\ncell:B20:b::2::2:l:3:f:7:cf:2:ntvf:2\\ncell:C20:b::1::1:f:1:cf:2:colspan:3\\ncell:D20:b::1:::colspan:2\\ncell:F20:b::1:::f:1:ntvf:1\\ncell:G20:b::2::2:l:3:f:7\\ncell:A21:b::2:::l:3:f:7\\ncell:B21:b::2::2:l:3:f:7:cf:2:ntvf:2\\ncell:C21:b::1::1:f:1:cf:2:colspan:3\\ncell:D21:b::1:::colspan:2\\ncell:F21:b::1:::f:1:ntvf:1\\ncell:G21:b::2::2:l:3:f:7\\ncell:A22:b::2:::l:3:f:7\\ncell:B22:b::2::2:l:3:f:7:cf:2:ntvf:2\\ncell:C22:b::1::1:f:1:cf:2:colspan:3\\ncell:D22:b::1:::colspan:2\\ncell:F22:b::1:::f:1:ntvf:1\\ncell:G22:b::2::2:l:3:f:7\\ncell:A23:b::2:::l:3:f:7\\ncell:B23:b::2::2:l:3:f:7:cf:2\\ncell:C23:b::1::1:f:1:cf:2:colspan:3\\ncell:D23:b::1:::colspan:2\\ncell:F23:b::1:::f:1:ntvf:1\\ncell:G23:b::2::2:l:3:f:7\\ncell:A24:b::2:::l:3:f:7\\ncell:B24:b::2::2:l:3:f:7:cf:2\\ncell:C24:b::1::1:f:1:cf:2:colspan:3\\ncell:D24:b::1:::colspan:2\\ncell:F24:b::1:::f:1:ntvf:1\\ncell:G24:b::2::2:l:3:f:7\\ncell:A25:b::2:::l:3:f:7\\ncell:B25:b::2::2:l:3:f:7:cf:2\\ncell:C25:b::1::1:f:1:cf:2:colspan:3\\ncell:D25:b::1:::colspan:2\\ncell:F25:b::1:::f:1:ntvf:1\\ncell:G25:b::2::2:l:3:f:7\\ncell:A26:b::2:::l:3:f:7\\ncell:B26:b::2::2:l:3:f:7:cf:2\\ncell:C26:b::1::1:f:1:cf:2:colspan:3\\ncell:D26:b::1:::colspan:2\\ncell:F26:b::1:::f:1:ntvf:1\\ncell:G26:b::2::2:l:3:f:7\\ncell:A27:b::2:::l:3:f:7\\ncell:B27:b::2::2:l:3:f:7:cf:2\\ncell:C27:b::1::1:f:1:cf:2:colspan:3\\ncell:D27:b::1:::colspan:2\\ncell:F27:b::1:::f:1:ntvf:1\\ncell:G27:b::2::2:l:3:f:7\\ncell:A28:b::2:::l:3:f:4\\ncell:B28:b::2::2:l:3:f:7:cf:2\\ncell:C28:b::1:1:1:f:1:cf:2:colspan:3\\ncell:D28:b::1:1::l:3:f:7:cf:2:colspan:2\\ncell:E28:b:::2::l:3:f:7:cf:2\\ncell:F28:b::1:1::f:1:ntvf:1\\ncell:G28:b::2::2:l:3:f:7\\ncell:A29:b::2:::l:3:f:3\\ncell:B29:b::2::2:l:3:f:3\\ncell:C29:t:TOTAL:b:1:1:1:1:f:5:cf:2:colspan:3\\ncell:D29:b:2::2::l:3:f:8:cf:2\\ncell:E29:b:2:2:2::l:3:f:8:cf:2\\ncell:F29:vtf:n:0:SUM(F16\\\\cF28):b:1:1:1::f:5:ntvf:1\\ncell:G29:b::2::2:l:3:f:4\\ncell:A30:b::2:::l:3:f:7\\ncell:B30:b::::2:l:3:f:3:cf:2\\ncell:C30:b:2::::l:1:f:7\\ncell:D30:b:2::::l:1:f:7\\ncell:E30:b:2::::l:1:f:7\\ncell:F30:b:2::::l:1:f:7\\ncell:G30:b::2:::l:3:f:3\\ncell:A31:b::2:::l:3:f:7\\ncell:B31:b::::2:l:3:f:7\\ncell:D31:tvf:4:rowspan:4\\ncell:G31:b::2:::l:3:f:7\\ncell:A32:b::2:::l:3:f:7\\ncell:B32:b::::2:l:3:f:7\\ncell:G32:b::2:::l:3:f:7\\ncell:A33:b::2:::l:3:f:7\\ncell:B33:b::::2:l:3:f:7\\ncell:G33:b::2:::l:3:f:7\\ncell:A34:b::2:::l:3:f:7\\ncell:B34:b::::2:l:3:f:7\\ncell:G34:b::2:::l:3:f:7\\ncell:A35:b::2:::l:3:f:7\\ncell:B35:b:::2:2:l:3:f:7\\ncell:C35:b:::2::l:3:f:7\\ncell:D35:b:::2::l:3:f:7\\ncell:E35:b:::2::l:3:f:7\\ncell:F35:b:::2::l:3:f:7\\ncell:G35:b::2:2::l:3:f:7\\ncell:B36:b:1:::\\ncell:C36:b:1:::\\ncell:D36:b:1:::\\ncell:E36:b:1:::\\ncell:F36:b:1:::\\ncell:G36:b:1:::\\ncol:A:w:10\\ncol:B:w:42\\ncol:C:w:105\\ncol:D:w:182\\ncol:E:w:110\\ncol:F:w:115\\ncol:G:w:65\\nrow:1:h:14.25\\nrow:2:h:18.75\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:15.75\\nrow:6:h:15.75\\nrow:7:h:15.75\\nrow:8:h:15.75\\nrow:9:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:13:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:16:h:14.25\\nrow:17:h:14.25\\nrow:18:h:14.25\\nrow:19:h:14.25\\nrow:20:h:14.25\\nrow:21:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nrow:24:h:14.25\\nrow:25:h:14.25\\nrow:26:h:14.25\\nrow:27:h:14.25\\nrow:28:h:15.75\\nrow:29:h:15.75\\nrow:30:h:14.25\\nrow:31:h:14.25\\nrow:32:h:14.25\\nrow:33:h:14.25\\nrow:34:h:14.25\\nrow:35:h:14.25\\nsheet:c:7:r:36:h:12.75\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\nfont:1:* * Trebuchet MS\\nfont:2:normal bold * Trebuchet MS\\nfont:3:normal bold 10pt Arial\\nfont:4:normal bold 12pt Arial\\nfont:5:normal bold 12pt Trebuchet MS\\nfont:6:normal bold 14pt Trebuchet MS\\nfont:7:normal normal 10pt Arial\\nfont:8:normal normal 12pt Arial\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nlayout:3:padding:* * * *;vertical-align:top;\\nvalueformat:1:#,##0.00\\nvalueformat:2:d-mmm\\nvalueformat:3:m/d/yy\\nvalueformat:4:text-html\\n\"},\"name\":\"typei\",\"hidden\":\"0\"},\"sheet2\":{\"sheetstr\":{\"savestr\":\"version:1.5\\ncell:A2:b::2:::l:1:f:7\\ncell:B2:t:INVOICE:b:1:1:1:1:l:3:f:6:cf:1:colspan:8\\ncell:C2:t::b:2::2::l:1:f:7\\ncell:D2:t::b:2::2::l:1:f:7\\ncell:E2:t::b:2::2::l:1:f:7\\ncell:F2:t::b:2::2::l:1:f:7\\ncell:G2:b:2::2::l:1:f:7\\ncell:H2:b:2::2::l:1:f:7\\ncell:I2:t::b:2::2::l:1:f:7\\ncell:A3:b::2:::l:3:f:7\\ncell:B3:b:2:::2:l:3:f:7\\ncell:E3:b:2::::l:1:f:7\\ncell:F3:b:2::::l:1:f:7\\ncell:G3:b:2::::l:1:f:7\\ncell:H3:b:2::::l:1:f:7\\ncell:I3:b:2:2:::l:3:f:7\\ncell:A4:b::2:::l:3:f:7\\ncell:B4:b::::2:l:3:f:3\\ncell:C4:t:INVOICE # \\\\c:f:2:cf:2\\ncell:D4:v:1:f:2:cf:2\\ncell:F4:tvf:5:colspan:2:rowspan:4\\ncell:I4:b::2:::l:3:f:7\\ncell:A5:b::2:::l:3:f:7\\ncell:B5:b::::2:l:3:f:4\\ncell:F5:t::l:2:f:7\\ncell:G5:l:2:f:7\\ncell:H5:l:2:f:7\\ncell:I5:t::b::1:::l:2:f:7\\ncell:A6:b::2:::l:3:f:7\\ncell:B6:b::::2:l:3:f:4\\ncell:C6:t:INVOICE DATE\\\\c:f:2:cf:2\\ncell:D6:f:2:cf:2:ntvf:4\\ncell:F6:l:2:f:7\\ncell:G6:l:2:f:7\\ncell:H6:l:2:f:7\\ncell:I6:b::1:::l:2:f:7\\ncell:A7:b::2:::l:3:f:7\\ncell:B7:b::::2:l:3:f:4\\ncell:I7:b::2:::l:3:f:7\\ncell:A8:b::2:::l:3:f:7\\ncell:B8:b::::2:l:3:f:4\\ncell:I8:b::2:::l:3:f:7\\ncell:A9:b::2:::l:3:f:7\\ncell:B9:b::::2:l:3:f:4\\ncell:C9:t:BILL TO\\\\c:f:2\\ncell:E9:t:FROM\\\\c:f:2:cf:2\\ncell:F9:colspan:3\\ncell:I9:b::2:::l:3:f:7\\ncell:A10:b::2:::l:3:f:7\\ncell:B10:b::::2:l:3:f:3\\ncell:C10:t:[Name]:f:1:cf:2:colspan:2\\ncell:E10:t:[Name]:f:1:cf:2:colspan:4\\ncell:I10:b::2:::l:3:f:7\\ncell:A11:b::2:::l:3:f:7\\ncell:B11:b::::2:l:3:f:7\\ncell:C11:t:[Street Address]:f:1:cf:2:colspan:2\\ncell:E11:t:[Street Address]:f:1:colspan:4\\ncell:I11:b::2:::l:3:f:7\\ncell:A12:b::2:::l:3:f:7\\ncell:B12:b::::2:l:3:f:7\\ncell:C12:t:[City, State, Zip]:f:1:cf:2:colspan:2\\ncell:E12:t:[City, State, Zip]:f:1:cf:2:colspan:4\\ncell:I12:b::2:::l:3:f:7\\ncell:A13:b::2:::l:3:f:7\\ncell:B13:b::::2:l:3:f:7\\ncell:C13:t:Phone\\\\c :f:1:cf:2:colspan:2\\ncell:E13:t:Phone\\\\c :f:1:cf:2:colspan:4\\ncell:I13:b::2:::l:3:f:7\\ncell:A14:b::2:::l:3:f:7\\ncell:B14:b::::2:l:3:f:3:cf:2\\ncell:C14:b:::2::l:1:f:7\\ncell:D14:b:::2::l:3:f:3:cf:2\\ncell:E14:b:::2::l:1:f:7\\ncell:F14:b:::2::l:1:f:7\\ncell:G14:b:::2::l:1:f:7\\ncell:H14:b:::2::l:1:f:7\\ncell:I14:b::2:::l:3:f:7\\ncell:A15:b::2:::l:3:f:7\\ncell:B15:b::2::2:l:3:f:7\\ncell:C15:t:Description:b:1:1:1:1:f:2:cf:1:colspan:3\\ncell:D15:t:Description:b:2::2:2:l:3:f:3:cf:2:colspan:2:rowspan:1\\ncell:E15:t::b:2:2:2::l:1:f:7\\ncell:F15:t:Hours:b:1:1:1:1:f:2:cf:1\\ncell:G15:t:Rate:b:1:1:1:1:f:2:cf:1\\ncell:H15:t:Amount:b:1:1:1:1:f:2:cf:1\\ncell:I15:b::2::2:l:3:f:7\\ncell:A16:b::2:::l:3:f:7\\ncell:B16:b::2::2:l:3:f:7\\ncell:C16:b:1:1::1:f:1:cf:2:colspan:3\\ncell:D16:b:1:1::1:l:3:f:7:cf:2:colspan:2:rowspan:1\\ncell:E16:t::b:2:2:2::l:1:f:7\\ncell:F16:b:1:1:::f:1:ntvf:1\\ncell:G16:b:1:1:::f:1:ntvf:1\\ncell:H16:vtf:t::IF(F16*G16>0,F16*G16,\\\"\\\"):b:1:1:::f:1:ntvf:1\\ncell:I16:b::2::2:l:3:f:7\\ncell:A17:b::2:::l:3:f:7\\ncell:B17:b::2::2:l:3:f:7:cf:2\\ncell:C17:b::1::1:f:1:cf:2:colspan:3\\ncell:D17:b::1::1:l:1:f:7:colspan:2\\ncell:E17:l:1:f:7\\ncell:F17:b::1:::f:1:ntvf:1\\ncell:G17:b::1:::f:1:ntvf:1\\ncell:H17:vtf:t::IF(F17*G17>0,F17*G17,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I17:b::2::2:l:3:f:7\\ncell:A18:b::2:::l:3:f:7\\ncell:B18:b::2::2:l:3:f:7:cf:2:ntvf:3\\ncell:C18:b::1::1:f:1:cf:2:colspan:3\\ncell:D18:b::1::1:colspan:2\\ncell:F18:b::1:::f:1:ntvf:1\\ncell:G18:b::1:::f:1:ntvf:1\\ncell:H18:vtf:t::IF(F18*G18>0,F18*G18,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I18:b::2::2:l:3:f:7\\ncell:A19:b::2:::l:3:f:7\\ncell:B19:b::2::2:l:3:f:7:cf:2:ntvf:3\\ncell:C19:b::1::1:f:1:cf:2:colspan:3\\ncell:D19:b::1::1:colspan:2\\ncell:F19:b::1:::f:1:ntvf:1\\ncell:G19:b::1:::f:1:ntvf:1\\ncell:H19:vtf:t::IF(F19*G19>0,F19*G19,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I19:b::2::2:l:3:f:7\\ncell:A20:b::2:::l:3:f:7\\ncell:B20:b::2::2:l:3:f:7:cf:2:ntvf:3\\ncell:C20:b::1::1:f:1:cf:2:colspan:3\\ncell:D20:b::1::1:colspan:2\\ncell:F20:b::1:::f:1:ntvf:1\\ncell:G20:b::1:::f:1:ntvf:1\\ncell:H20:vtf:t::IF(F20*G20>0,F20*G20,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I20:b::2::2:l:3:f:7\\ncell:A21:b::2:::l:3:f:7\\ncell:B21:b::2::2:l:3:f:7:cf:2:ntvf:3\\ncell:C21:b::1::1:f:1:cf:2:colspan:3\\ncell:D21:b::1::1:colspan:2\\ncell:F21:b::1:::f:1:ntvf:1\\ncell:G21:b::1:::f:1:ntvf:1\\ncell:H21:vtf:t::IF(F21*G21>0,F21*G21,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I21:b::2::2:l:3:f:7\\ncell:A22:b::2:::l:3:f:7\\ncell:B22:b::2::2:l:3:f:7:cf:2:ntvf:3\\ncell:C22:b::1::1:f:1:cf:2:colspan:3\\ncell:D22:b::1::1:colspan:2\\ncell:F22:b::1:::f:1:ntvf:1\\ncell:G22:b::1:::f:1:ntvf:1\\ncell:H22:vtf:t::IF(F22*G22>0,F22*G22,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I22:b::2::2:l:3:f:7\\ncell:A23:b::2:::l:3:f:7\\ncell:B23:b::2::2:l:3:f:7:cf:2\\ncell:C23:b::1::1:f:1:cf:2:colspan:3\\ncell:D23:b::1::1:colspan:2\\ncell:F23:b::1:::f:1:ntvf:1\\ncell:G23:b::1:::f:1:ntvf:1\\ncell:H23:vtf:t::IF(F23*G23>0,F23*G23,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I23:b::2::2:l:3:f:7\\ncell:A24:b::2:::l:3:f:7\\ncell:B24:b::2::2:l:3:f:7:cf:2\\ncell:C24:b::1::1:f:1:cf:2:colspan:3\\ncell:D24:b::1::1:colspan:2\\ncell:F24:b::1:::f:1:ntvf:1\\ncell:G24:b::1:::f:1:ntvf:1\\ncell:H24:vtf:t::IF(F24*G24>0,F24*G24,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I24:b::2::2:l:3:f:7\\ncell:A25:b::2:::l:3:f:7\\ncell:B25:b::2::2:l:3:f:7:cf:2\\ncell:C25:b::1::1:f:1:cf:2:colspan:3\\ncell:D25:b::1::1:colspan:2\\ncell:F25:b::1:::f:1:ntvf:1\\ncell:G25:b::1:::f:1:ntvf:1\\ncell:H25:vtf:t::IF(F25*G25>0,F25*G25,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I25:b::2::2:l:3:f:7\\ncell:A26:b::2:::l:3:f:7\\ncell:B26:b::2::2:l:3:f:7:cf:2\\ncell:C26:b::1::1:f:1:cf:2:colspan:3\\ncell:D26:b::1::1:colspan:2\\ncell:F26:b::1:::f:1:ntvf:1\\ncell:G26:b::1:::f:1:ntvf:1\\ncell:H26:vtf:t::IF(F26*G26>0,F26*G26,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I26:b::2::2:l:3:f:7\\ncell:A27:b::2:::l:3:f:7\\ncell:B27:b::2::2:l:3:f:7:cf:2\\ncell:C27:b::1::1:f:1:cf:2:colspan:3\\ncell:D27:b::1::1:colspan:2\\ncell:F27:b::1:::f:1:ntvf:1\\ncell:G27:b::1:::f:1:ntvf:1\\ncell:H27:vtf:t::IF(F27*G27>0,F27*G27,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I27:b::2::2:l:3:f:7\\ncell:A28:b::2:::l:3:f:4\\ncell:B28:b::2::2:l:3:f:7:cf:2\\ncell:C28:b::1:1:1:f:1:cf:2:colspan:3\\ncell:D28:b::1:1:1:l:3:f:7:cf:2:colspan:2\\ncell:E28:b:::2::l:3:f:7:cf:2\\ncell:F28:b::1:1::f:1:ntvf:1\\ncell:G28:b::1:1::f:1:ntvf:1\\ncell:H28:vtf:t::IF(F28*G28>0,F28*G28,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I28:b::2::2:l:3:f:7\\ncell:A29:b::2:::l:3:f:3\\ncell:B29:b::2::2:l:3:f:3\\ncell:C29:t:TOTAL:b:1:1:1:1:l:3:f:5:cf:2:colspan:5\\ncell:D29:b:2::2::l:3:f:8:cf:2\\ncell:E29:b:2:2:2::l:3:f:8:cf:2\\ncell:F29:vtf:n:0:SUM(F16\\\\cF28):b:2:2:2::l:3:f:4:ntvf:2\\ncell:G29:b:2:2:2::l:3:f:4:ntvf:2\\ncell:H29:vtf:n:0:SUM(H16\\\\cH28):b:1:1:1::f:5:ntvf:1\\ncell:I29:b::2::2:l:3:f:4\\ncell:A30:b::2:::l:3:f:7\\ncell:B30:b::::2:l:3:f:3:cf:2\\ncell:C30:b:2::::l:1:f:7\\ncell:D30:b:2::::l:1:f:7\\ncell:E30:b:2::::l:1:f:7\\ncell:F30:b:2::::l:1:f:7\\ncell:G30:b:2::::l:1:f:7\\ncell:H30:b:2::::l:1:f:7\\ncell:I30:b::2:::l:3:f:3\\ncell:A31:b::2:::l:3:f:7\\ncell:B31:b::::2:l:3:f:7\\ncell:D31:tvf:5:rowspan:4\\ncell:I31:b::2:::l:3:f:7\\ncell:A32:b::2:::l:3:f:7\\ncell:B32:b::::2:l:3:f:7\\ncell:I32:b::2:::l:3:f:7\\ncell:A33:b::2:::l:3:f:7\\ncell:B33:b::::2:l:3:f:7\\ncell:I33:b::2:::l:3:f:7\\ncell:A34:b::2:::l:3:f:7\\ncell:B34:b::::2:l:3:f:7\\ncell:I34:b::2:::l:3:f:7\\ncell:A35:b::2:::l:3:f:7\\ncell:B35:b:::2:2:l:3:f:7\\ncell:C35:b:::2::l:3:f:7\\ncell:D35:b:::2::l:3:f:7\\ncell:E35:b:::2::l:3:f:7\\ncell:F35:b:::2::l:3:f:7\\ncell:G35:b:::2::l:3:f:7\\ncell:H35:b:::2::l:3:f:7\\ncell:I35:b::2:2::l:3:f:7\\ncell:B36:b:1:::\\ncell:C36:b:1:::\\ncell:D36:b:1:::\\ncell:E36:b:1:::\\ncell:F36:b:1:::\\ncell:G36:b:1:::\\ncell:H36:b:1:::\\ncell:I36:b:1:::\\ncol:A:w:26\\ncol:B:w:28\\ncol:C:w:96\\ncol:D:w:203\\ncol:E:w:51\\ncol:F:w:50\\ncol:G:w:58\\ncol:H:w:80\\ncol:I:w:28\\nrow:1:h:14.25\\nrow:2:h:18.75\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:15.75\\nrow:6:h:15.75\\nrow:7:h:15.75\\nrow:8:h:15.75\\nrow:9:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:13:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:16:h:14.25\\nrow:17:h:14.25\\nrow:18:h:14.25\\nrow:19:h:14.25\\nrow:20:h:14.25\\nrow:21:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nrow:24:h:14.25\\nrow:25:h:14.25\\nrow:26:h:14.25\\nrow:27:h:14.25\\nrow:28:h:15.75\\nrow:29:h:15.75\\nrow:30:h:14.25\\nrow:31:h:14.25\\nrow:32:h:14.25\\nrow:33:h:14.25\\nrow:34:h:14.25\\nrow:35:h:14.25\\nsheet:c:9:r:36:h:12.75\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\nfont:1:* * Trebuchet MS\\nfont:2:normal bold * Trebuchet MS\\nfont:3:normal bold 10pt Arial\\nfont:4:normal bold 12pt Arial\\nfont:5:normal bold 12pt Trebuchet MS\\nfont:6:normal bold 14pt Trebuchet MS\\nfont:7:normal normal 10pt Arial\\nfont:8:normal normal 12pt Arial\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nlayout:3:padding:* * * *;vertical-align:top;\\nvalueformat:1:#,##0.00\\nvalueformat:2:#,##0.00;(#,##0.00)\\nvalueformat:3:d-mmm\\nvalueformat:4:m/d/yy\\nvalueformat:5:text-html\\n\"},\"name\":\"typeii\",\"hidden\":\"0\"},\"sheet3\":{\"sheetstr\":{\"savestr\":\"version:1.5\\ncell:A1:l:3\\ncell:B2:t:[Company Name]:l:1:f:3:cf:2:colspan:3\\ncell:C2:t::l:2:f:9\\ncell:D2:t::l:2:f:9\\ncell:E2:l:1:f:7:c:2:cf:3\\ncell:F2:t:INVOICE:l:1:f:7:c:2:cf:2:colspan:2\\ncell:G2:t::l:2:f:9\\ncell:B3:t:[Company Slogan]:f:4:cf:2:colspan:3\\ncell:C3:t::l:2:f:9\\ncell:D3:t::l:2:f:9\\ncell:B4:f:2:colspan:2\\ncell:F4:tvf:4:rowspan:4\\ncell:B5:t:[Street Address]:f:1:cf:2:colspan:2\\ncell:F5:l:1:f:6\\ncell:G5:l:1:f:10:cf:1\\ncell:B6:t:[City, State,  Zip]:f:1:cf:2:colspan:2\\ncell:G6:l:1:f:9\\ncell:B7:t:Phone\\\\c :f:1:cf:2:colspan:2\\ncell:B8:t:Email\\\\c:f:1:cf:2:colspan:2\\ncell:B9:colspan:2\\ncell:F9:t:DATE \\\\c:l:1:f:6:cf:2\\ncell:G9:l:1:f:10:cf:2:ntvf:3\\ncell:B10:t:BILL TO\\\\c:f:5:c:1:bg:3:cf:2:colspan:2\\ncell:F10:t:INVOICE # \\\\c:l:1:f:6:cf:2\\ncell:G10:v:1:l:1:f:10:cf:2\\ncell:B11:t:[Name]:f:1:cf:2:colspan:2\\ncell:B12:t:[Company Name]:f:1:cf:2:colspan:2\\ncell:F12:t:  \\ncell:B13:t:[Street Address]:f:1:cf:2:colspan:2\\ncell:B14:t:[City, State,  Zip]:f:1:cf:2:colspan:2\\ncell:B15:t:Phone\\\\c :f:1:cf:2:colspan:2\\ncell:A17:b::1::\\ncell:B17:t:DESCRIPTION:b:1:1:1:1:l:1:f:6:c:1:bg:3:cf:1:colspan:5:rowspan:1\\ncell:C17:t::l:2:f:9\\ncell:D17:t::l:2:f:9\\ncell:E17:t::l:2:f:9\\ncell:F17:t::l:2:f:9\\ncell:G17:t:AMOUNT:b:1:1:1::l:1:f:6:c:1:bg:3:cf:1\\ncell:A18:b::1::\\ncell:B18:b:1:1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C18:t::l:2:f:9\\ncell:D18:t::l:2:f:9\\ncell:E18:t::l:2:f:9\\ncell:F18:t::b::2:::l:1:f:9\\ncell:G18:b::1::1:f:1:ntvf:1\\ncell:A19:b::1::\\ncell:B19:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C19:t::l:2:f:9\\ncell:D19:t::l:2:f:9\\ncell:E19:t::l:2:f:9\\ncell:F19:t::b::2:::l:1:f:9\\ncell:G19:b::1::1:f:1:ntvf:1\\ncell:A20:b::1::\\ncell:B20:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C20:t::l:2:f:9\\ncell:D20:t::l:2:f:9\\ncell:E20:t::l:2:f:9\\ncell:F20:t::b::2:::l:1:f:9\\ncell:G20:b::1::1:f:1:ntvf:1\\ncell:A21:b::1::\\ncell:B21:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C21:t::l:2:f:9\\ncell:D21:t::l:2:f:9\\ncell:E21:t::l:2:f:9\\ncell:F21:t::b::2:::l:1:f:9\\ncell:G21:b::1::1:f:1:ntvf:1\\ncell:A22:b::1::\\ncell:B22:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C22:t::l:2:f:9\\ncell:D22:t::l:2:f:9\\ncell:E22:t::l:2:f:9\\ncell:F22:t::b::2:::l:1:f:9\\ncell:G22:b::1::1:f:1:ntvf:1\\ncell:A23:b::1::\\ncell:B23:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C23:t::l:2:f:9\\ncell:D23:t::l:2:f:9\\ncell:E23:t::l:2:f:9\\ncell:F23:t::b::2:::l:1:f:9\\ncell:G23:b::1::1:f:1:ntvf:1\\ncell:A24:b::1::\\ncell:B24:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C24:t::l:2:f:9\\ncell:D24:t::l:2:f:9\\ncell:E24:t::l:2:f:9\\ncell:F24:t::b::2:::l:1:f:9\\ncell:G24:b::1::1:f:1:ntvf:1\\ncell:A25:b::1::\\ncell:B25:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C25:t::l:2:f:9\\ncell:D25:t::l:2:f:9\\ncell:E25:t::l:2:f:9\\ncell:F25:t::b::2:::l:1:f:9\\ncell:G25:b::1::1:f:1:ntvf:1\\ncell:A26:b::1::\\ncell:B26:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C26:t::l:2:f:9\\ncell:D26:t::l:2:f:9\\ncell:E26:t::l:2:f:9\\ncell:F26:t::b::2:::l:1:f:9\\ncell:G26:b::1::1:f:1:ntvf:1\\ncell:A27:b::1::\\ncell:B27:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C27:t::l:2:f:9\\ncell:D27:t::l:2:f:9\\ncell:E27:t::l:2:f:9\\ncell:F27:t::b::2:::l:1:f:9\\ncell:G27:b::1::1:f:1:ntvf:1\\ncell:A28:b::1::\\ncell:B28:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C28:t::l:2:f:9\\ncell:D28:t::l:2:f:9\\ncell:E28:t::l:2:f:9\\ncell:F28:t::b::2:::l:1:f:9\\ncell:G28:b::1::1:f:1:ntvf:1\\ncell:A29:b::1::\\ncell:B29:b::1:1:1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C29:t::b:::2::l:1:f:9\\ncell:D29:t::b:::2::l:1:f:9\\ncell:E29:t::b:::2::l:1:f:9\\ncell:F29:t::b::2:2::l:1:f:9\\ncell:G29:b::1:1:1:f:1:ntvf:1\\ncell:B30:b:2::::l:1:f:9\\ncell:C30:b:2::::l:1:f:9\\ncell:D30:b:2::::l:1:f:9\\ncell:E30:b:2::::l:1:f:10\\ncell:F30:t:Subtotal:b:2::::l:1:f:10\\ncell:G30:vtf:n:0:SUM(G18\\\\cG29):b:1::::f:8:ntvf:1\\ncell:B31:t:NOTES:b:::2::l:1:f:6:cf:2:colspan:3:rowspan:1\\ncell:C31:t::b:::2::l:1:f:9\\ncell:D31:t::b:::2::l:1:f:9\\ncell:F31:t:Tax Rate:l:1:f:1\\ncell:G31:v:0:f:1:ntvf:2\\ncell:B32:b:1::::f:1:cf:2:colspan:3\\ncell:C32:t::b:2::::l:1:f:9\\ncell:D32:t::b:2::::l:1:f:9\\ncell:F32:t:Tax:l:1:f:1\\ncell:G32:vtf:n:0:G31*G30:f:1:ntvf:1\\ncell:B33:f:1:cf:2:colspan:3\\ncell:C33:t::l:2:f:9\\ncell:D33:t::l:2:f:9\\ncell:F33:t:Other:b:::1::l:1:f:1\\ncell:G33:v:0:b:::1::f:1:ntvf:1\\ncell:B34:b:::1::f:1:cf:2:colspan:3:rowspan:1\\ncell:C34:t::l:2:f:9\\ncell:D34:t::l:2:f:9\\ncell:F34:t:TOTAL:b:2::::l:1:f:6\\ncell:G34:vtf:n:0:(G30+G32)+G33:b:1::::f:5:ntvf:1\\ncell:C36:tvf:4:colspan:5:rowspan:7\\ncol:A:w:40\\ncol:B:w:232\\ncol:C:w:53\\ncol:D:w:90\\ncol:E:w:54\\ncol:F:w:91\\ncol:G:w:99\\nrow:1:h:34.5\\nrow:2:h:34.5\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:14.25\\nrow:6:h:14.25\\nrow:7:h:14.25\\nrow:8:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:13:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:17:h:14.25\\nrow:18:h:14.25\\nrow:19:h:14.25\\nrow:20:h:14.25\\nrow:21:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nrow:24:h:14.25\\nrow:25:h:14.25\\nrow:26:h:14.25\\nrow:27:h:14.25\\nrow:28:h:14.25\\nrow:29:h:14.25\\nrow:30:h:14.25\\nrow:31:h:14.25\\nrow:32:h:14.25\\nrow:33:h:14.25\\nrow:34:h:14.25\\nsheet:c:7:r:36:h:12.75:needsrecalc:yes\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\ncellformat:3:right\\ncolor:1:rgb(0, 0, 0)\\ncolor:2:rgb(0,0,0)\\ncolor:3:rgb(221, 221, 221)\\nfont:1:* * Trebuchet MS\\nfont:2:* 10pt *\\nfont:3:* 16pt Trebuchet MS\\nfont:4:italic normal * Trebuchet MS\\nfont:5:normal bold * Trebuchet MS\\nfont:6:normal bold 10pt Trebuchet MS\\nfont:7:normal bold 28pt Trebuchet MS\\nfont:8:normal normal * Trebuchet MS\\nfont:9:normal normal 10pt Arial\\nfont:10:normal normal 10pt Trebuchet MS\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nlayout:3:padding:36px * 28px *;vertical-align:*;\\nvalueformat:1:#,##0.00\\nvalueformat:2:#,##0.00%\\nvalueformat:3:m/d/yy\\nvalueformat:4:text-html\\n\"},\"name\":\"typeiii\",\"hidden\":\"0\"},\"sheet4\":{\"sheetstr\":{\"savestr\":\"version:1.5\\ncell:A1:l:3\\ncell:B2:t:[Company Name]:l:1:f:2:cf:2:colspan:3:rowspan:1\\ncell:C2:t::l:2:f:7\\ncell:D2:t::l:2:f:7\\ncell:F2:t:INVOICE:l:1:f:6:c:1:cf:2:colspan:2\\ncell:G2:t::l:2:f:7\\ncell:B3:t:[Company slogan]:f:3:cf:2:colspan:3:rowspan:1\\ncell:C3:t::l:2:f:7\\ncell:D3:t::l:2:f:7\\ncell:B4:cf:2:colspan:3:rowspan:1\\ncell:F4:tvf:4:rowspan:4\\ncell:B5:t:[Street Address]:f:1:cf:2:colspan:3:rowspan:1\\ncell:F5:l:1:f:5\\ncell:G5:l:1:f:8:cf:1\\ncell:B6:t:[City, State,  Zip]:f:1:cf:2:colspan:3:rowspan:1\\ncell:G6:l:1:f:7\\ncell:B7:t:Phone\\\\c :f:1:cf:2:colspan:3:rowspan:1\\ncell:B8:t:Email\\\\c:f:1:cf:2:colspan:3:rowspan:1\\ncell:B9:cf:2:colspan:3:rowspan:1\\ncell:B10:t:BILL TO\\\\c:l:1:f:5:bg:2:cf:2:colspan:2\\ncell:F10:t:DATE\\\\c:l:1:f:5:cf:2\\ncell:G10:l:1:f:8:cf:2:ntvf:3\\ncell:B11:t:[Name]:f:1:cf:2:colspan:3:rowspan:1\\ncell:F11:t:INVOICE # \\\\c:l:1:f:5:cf:2\\ncell:G11:v:1:l:1:f:8:cf:2\\ncell:B12:t:[Company Name]:f:1:cf:2:colspan:3:rowspan:1\\ncell:J12:tvf:4\\ncell:B13:t:[Street Address]:f:1:cf:2:colspan:3:rowspan:1\\ncell:B14:t:[City, State,  Zip]:f:1:cf:2:colspan:3:rowspan:1\\ncell:B15:t:Phone\\\\c :f:1:cf:2:colspan:3:rowspan:1\\ncell:B16:cf:2:colspan:3:rowspan:1\\ncell:A17:b::1::\\ncell:B17:t:DESCRIPTION:b:1:1:1:1:l:1:f:5:bg:2:cf:1:colspan:3:rowspan:1\\ncell:C17:t::b:1::1::l:1:f:7:bg:2\\ncell:D17:t::b:1::1::l:1:f:7:bg:2\\ncell:E17:t:HOURS:b:1:1:1::l:1:f:5:bg:2:cf:1\\ncell:F17:t:RATE:b:1:1:1::l:1:f:5:bg:2:cf:1\\ncell:G17:t:AMOUNT:b:1:1:1::l:1:f:5:bg:2:cf:1\\ncell:A18:b::1::\\ncell:B18:b:1:1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C18:t::b:2::::l:1:f:7\\ncell:D18:t::b:2:2:::l:1:f:7\\ncell:E18:b:1:1::1:f:1:ntvf:1\\ncell:F18:b:1:1::1:f:1:ntvf:1\\ncell:G18:vtf:t::IF(E18*F18>0,E18*F18,\\\"\\\"):b:1:1:::f:1:ntvf:1\\ncell:A19:b::1::\\ncell:B19:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C19:t::l:2:f:7\\ncell:D19:t::b::2:::l:1:f:7\\ncell:E19:b::1::1:f:1:ntvf:1\\ncell:F19:b::1::1:f:1:ntvf:1\\ncell:G19:vtf:t::IF(E19*F19>0,E19*F19,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A20:b::1::\\ncell:B20:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C20:t::l:2:f:7\\ncell:D20:t::b::2:::l:1:f:7\\ncell:E20:b::1::1:f:1:ntvf:1\\ncell:F20:b::1::1:f:1:ntvf:1\\ncell:G20:vtf:t::IF(E20*F20>0,E20*F20,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A21:b::1::\\ncell:B21:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C21:t::l:2:f:7\\ncell:D21:t::b::2:::l:1:f:7\\ncell:E21:b::1::1:f:1:ntvf:1\\ncell:F21:b::1::1:f:1:ntvf:1\\ncell:G21:vtf:t::IF(E21*F21>0,E21*F21,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A22:b::1::\\ncell:B22:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C22:t::l:2:f:7\\ncell:D22:t::b::2:::l:1:f:7\\ncell:E22:b::1::1:f:1:ntvf:1\\ncell:F22:b::1::1:f:1:ntvf:1\\ncell:G22:vtf:t::IF(E22*F22>0,E22*F22,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A23:b::1::\\ncell:B23:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C23:t::l:2:f:7\\ncell:D23:t::b::2:::l:1:f:7\\ncell:E23:b::1::1:f:1:ntvf:1\\ncell:F23:b::1::1:f:1:ntvf:1\\ncell:G23:vtf:t::IF(E23*F23>0,E23*F23,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A24:b::1::\\ncell:B24:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C24:t::l:2:f:7\\ncell:D24:t::b::2:::l:1:f:7\\ncell:E24:b::1::1:f:1:ntvf:1\\ncell:F24:b::1::1:f:1:ntvf:1\\ncell:G24:vtf:t::IF(E24*F24>0,E24*F24,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A25:b::1::\\ncell:B25:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C25:t::l:2:f:7\\ncell:D25:t::b::2:::l:1:f:7\\ncell:E25:b::1::1:f:1:ntvf:1\\ncell:F25:b::1::1:f:1:ntvf:1\\ncell:G25:vtf:t::IF(E25*F25>0,E25*F25,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A26:b::1::\\ncell:B26:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C26:t::l:2:f:7\\ncell:D26:t::b::2:::l:1:f:7\\ncell:E26:b::1::1:f:1:ntvf:1\\ncell:F26:b::1::1:f:1:ntvf:1\\ncell:G26:vtf:t::IF(E26*F26>0,E26*F26,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A27:b::1::\\ncell:B27:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C27:t::l:2:f:7\\ncell:D27:t::b::2:::l:1:f:7\\ncell:E27:b::1::1:f:1:ntvf:1\\ncell:F27:b::1::1:f:1:ntvf:1\\ncell:G27:vtf:t::IF(E27*F27>0,E27*F27,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A28:b::1::\\ncell:B28:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C28:t::l:2:f:7\\ncell:D28:t::b::2:::l:1:f:7\\ncell:E28:b::1::1:f:1:ntvf:1\\ncell:F28:b::1::1:f:1:ntvf:1\\ncell:G28:vtf:t::IF(E28*F28>0,E28*F28,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A29:b::1::\\ncell:B29:b::1:1:1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C29:t::b:::2::l:1:f:7\\ncell:D29:t::b::2:2::l:1:f:7\\ncell:E29:b::1:1:1:f:1:ntvf:1\\ncell:F29:b::1:1:1:f:1:ntvf:1\\ncell:G29:vtf:t::IF(E29*F29>0,E29*F29,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:B30:b:2::::l:1:f:8:cf:1:colspan:3:rowspan:1\\ncell:C30:t::b:2::::l:1:f:7\\ncell:D30:t::b:2::::l:1:f:7\\ncell:E30:b:2::::l:1:f:8\\ncell:F30:t:Subtotal:b:1::::f:1\\ncell:G30:vtf:n:0:SUM(G18\\\\cG29):b:1::::f:1:ntvf:1\\ncell:B31:t:NOTES:b:::2::l:1:f:5:cf:2:colspan:3:rowspan:1\\ncell:C31:t::b:::2::l:1:f:7\\ncell:D31:t::b:::2::l:1:f:7\\ncell:F31:t:Tax Rate:f:1\\ncell:G31:v:0:f:1:ntvf:2\\ncell:B32:b:1::::f:1:cf:2:colspan:3:rowspan:1\\ncell:C32:t::b:2::::l:1:f:7\\ncell:D32:t::b:2::::l:1:f:7\\ncell:F32:t:Tax:f:1\\ncell:G32:vtf:n:0:G31*G30:f:1:ntvf:1\\ncell:B33:f:1:cf:2:colspan:3:rowspan:1\\ncell:C33:t::l:2:f:7\\ncell:D33:t::l:2:f:7\\ncell:F33:t:Other:b:::1::l:1:f:1\\ncell:G33:v:0:b:::1::f:1:ntvf:1\\ncell:B34:f:1:cf:2:colspan:3:rowspan:1\\ncell:C34:t::l:2:f:7\\ncell:D34:t::l:2:f:7\\ncell:F34:t:TOTAL:b:1::::l:1:f:4\\ncell:G34:vtf:n:0:(G30+G32)+G33:b:1::::f:4:ntvf:1\\ncell:B35:b:2::::l:1:f:7\\ncell:C35:b:2::::l:1:f:7\\ncell:D35:b:2::::l:1:f:7\\ncell:C36:tvf:4:colspan:5:rowspan:7\\ncol:A:w:40\\ncol:B:w:194\\ncol:C:w:128\\ncol:D:w:60\\ncol:E:w:65\\ncol:F:w:95\\ncol:G:w:90\\nrow:1:h:34.5\\nrow:2:h:34.5\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:14.25\\nrow:6:h:14.25\\nrow:7:h:14.25\\nrow:8:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:13:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:17:h:14.25\\nrow:18:h:14.25\\nrow:19:h:14.25\\nrow:20:h:14.25\\nrow:21:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nrow:24:h:14.25\\nrow:25:h:14.25\\nrow:26:h:14.25\\nrow:27:h:14.25\\nrow:28:h:14.25\\nrow:29:h:14.25\\nrow:30:h:14.25\\nrow:31:h:14.25\\nrow:32:h:14.25\\nrow:33:h:14.25\\nrow:34:h:14.25\\nrow:35:h:14.25\\nsheet:c:10:r:36:h:12.75:needsrecalc:yes\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\ncolor:1:rgb(0,0,0)\\ncolor:2:rgb(221, 221, 221)\\nfont:1:* * Trebuchet MS\\nfont:2:* 16pt Trebuchet MS\\nfont:3:italic normal * Trebuchet MS\\nfont:4:normal bold * Trebuchet MS\\nfont:5:normal bold 10pt Trebuchet MS\\nfont:6:normal bold 28pt Trebuchet MS\\nfont:7:normal normal 10pt Arial\\nfont:8:normal normal 10pt Trebuchet MS\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nlayout:3:padding:36px * 28px *;vertical-align:*;\\nvalueformat:1:#,##0.00\\nvalueformat:2:#,##0.00%\\nvalueformat:3:m/d/yy\\nvalueformat:4:text-html\\n\"},\"name\":\"typeiv\",\"hidden\":\"0\"}},\"EditableCells\":{\"allow\":true,\"cells\":{\"typei!C10\":true,\"typei!B2\":true,\"typei!C11\":true,\"typei!C12\":true,\"typei!C13\":true,\"typei!D9\":true,\"typei!D4\":true,\"typei!D6\":true,\"typei!E10\":true,\"typei!E11\":true,\"typei!E12\":true,\"typei!E13\":true,\"typei!F9\":true,\"typei!C16\":true,\"typei!C17\":true,\"typei!C18\":true,\"typei!C19\":true,\"typei!C20\":true,\"typei!C21\":true,\"typei!C22\":true,\"typei!C23\":true,\"typei!C24\":true,\"typei!C25\":true,\"typei!C26\":true,\"typei!C27\":true,\"typei!C28\":true,\"typei!F16\":true,\"typei!F17\":true,\"typei!F18\":true,\"typei!F19\":true,\"typei!F20\":true,\"typei!F21\":true,\"typei!F22\":true,\"typei!F23\":true,\"typei!F24\":true,\"typei!F25\":true,\"typei!F26\":true,\"typei!F27\":true,\"typei!F28\":true,\"typei!E35\":true,\"typeii!B2\":true,\"typeii!D4\":true,\"typeii!C10\":true,\"typeii!C11\":true,\"typeii!C12\":true,\"typeii!C13\":true,\"typeii!D9\":true,\"typeii!E10\":true,\"typeii!E11\":true,\"typeii!E12\":true,\"typeii!E13\":true,\"typeii!F9\":true,\"typeii!C16\":true,\"typeii!C17\":true,\"typeii!C18\":true,\"typeii!C19\":true,\"typeii!C20\":true,\"typeii!C21\":true,\"typeii!C22\":true,\"typeii!C23\":true,\"typeii!C24\":true,\"typeii!C25\":true,\"typeii!C26\":true,\"typeii!C27\":true,\"typeii!C28\":true,\"typeii!F16\":true,\"typeii!F17\":true,\"typeii!F18\":true,\"typeii!F19\":true,\"typeii!F20\":true,\"typeii!F21\":true,\"typeii!F22\":true,\"typeii!F23\":true,\"typeii!F24\":true,\"typeii!F25\":true,\"typeii!F26\":true,\"typeii!F27\":true,\"typeii!F28\":true,\"typeii!G16\":true,\"typeii!G17\":true,\"typeii!G18\":true,\"typeii!G19\":true,\"typeii!G20\":true,\"typeii!G21\":true,\"typeii!G22\":true,\"typeii!G23\":true,\"typeii!G24\":true,\"typeii!G25\":true,\"typeii!G26\":true,\"typeii!G27\":true,\"typeii!G28\":true,\"typeii!E35\":true,\"typeiii!G9\":true,\"typeiii!G10\":true,\"typeiii!B2\":true,\"typeiii!B3\":true,\"typeiii!B4\":true,\"typeiii!B5\":true,\"typeiii!B6\":true,\"typeiii!B7\":true,\"typeiii!B8\":true,\"typeiii!B9\":true,\"typeiii!B11\":true,\"typeiii!B12\":true,\"typeiii!B13\":true,\"typeiii!B14\":true,\"typeiii!B15\":true,\"typeiii!B18\":true,\"typeiii!B19\":true,\"typeiii!B20\":true,\"typeiii!B21\":true,\"typeiii!B22\":true,\"typeiii!B23\":true,\"typeiii!B24\":true,\"typeiii!B25\":true,\"typeiii!B26\":true,\"typeiii!B27\":true,\"typeiii!B28\":true,\"typeiii!B29\":true,\"typeiii!G18\":true,\"typeiii!G19\":true,\"typeiii!G20\":true,\"typeiii!G21\":true,\"typeiii!G22\":true,\"typeiii!G23\":true,\"typeiii!G24\":true,\"typeiii!G25\":true,\"typeiii!G26\":true,\"typeiii!G27\":true,\"typeiii!G28\":true,\"typeiii!G29\":true,\"typeiii!B32\":true,\"typeiii!B33\":true,\"typeiii!B34\":true,\"typeiii!G31\":true,\"typeiii!G33\":true,\"typeiii!B37\":true,\"typeiv!G9\":true,\"typeiv!G10\":true,\"typeiv!B2\":true,\"typeiv!B3\":true,\"typeiv!B4\":true,\"typeiv!B5\":true,\"typeiv!B6\":true,\"typeiv!B7\":true,\"typeiv!B8\":true,\"typeiv!B11\":true,\"typeiv!B12\":true,\"typeiv!B13\":true,\"typeiv!B14\":true,\"typeiv!B15\":true,\"typeiv!B16\":true,\"typeiv!B18\":true,\"typeiv!B19\":true,\"typeiv!B20\":true,\"typeiv!B21\":true,\"typeiv!B22\":true,\"typeiv!B23\":true,\"typeiv!B24\":true,\"typeiv!B25\":true,\"typeiv!B26\":true,\"typeiv!B27\":true,\"typeiv!B28\":true,\"typeiv!B29\":true,\"typeiv!E18\":true,\"typeiv!E19\":true,\"typeiv!E20\":true,\"typeiv!E21\":true,\"typeiv!E22\":true,\"typeiv!E23\":true,\"typeiv!E24\":true,\"typeiv!E25\":true,\"typeiv!E26\":true,\"typeiv!E27\":true,\"typeiv!E28\":true,\"typeiv!E29\":true,\"typeiv!F18\":true,\"typeiv!F19\":true,\"typeiv!F2\":true,\"typeiv!F20\":true,\"typeiv!F21\":true,\"typeiv!F22\":true,\"typeiv!F23\":true,\"typeiv!F24\":true,\"typeiv!F25\":true,\"typeiv!F26\":true,\"typeiv!F27\":true,\"typeiv!F28\":true,\"typeiv!F29\":true,\"typeiv!B32\":true,\"typeiv!B33\":true,\"typeiv!B34\":true,\"typeiv!G31\":true,\"typeiv!G33\":true,\"typeiv!B37\":true,\"typeii!F15\":true,\"typeii!G15\":true,\"typeiv!E17\":true,\"typeiv!F17\":true,\"typeii!D6\":true,\"typeiv!G11\":true,\"typei!C4\":true,\"typeii!C4\":true,\"typeiii!F10\":true,\"typeiv!F11\":true,\"typeiv!F10\":true,\"typeiii!F9\":true,\"typeii!C6\":true,\"typei!C6\":true,\"typei!F4\":true,\"typeii!F4\":true,\"typeiii!F4\":true,\"typeiii!F2\":true,\"typeiv!F4\":true,\"typei!F29\":true,\"typeii!H29\":true,\"typeiii!G30\":true,\"typeiii!G34\":true,\"typeiv!G30\":true,\"typeiv!G34\":true},\"constraints\":{}}},\n        \t\"footers\": [{name: 'Invoice 1' , index: 1, isActive: true }, {name: 'Invoice 2' , index: 2, isActive: false}, \n                        {name: 'Company Invoice 1' , index: 3, isActive: false}, {name: 'Company Invoice 2' , index: 4, isActive: false}]\n        },\n        \"default\":{\n        \t\"msc\": {\"numsheets\":4,\"currentid\":\"sheet1\",\"currentname\":\"typei\",\"sheetArr\":{\"sheet1\":{\"sheetstr\":{\"savestr\":\"version:1.5\\ncell:A2:b::2:::l:1:f:7\\ncell:B2:t:INVOICE:b:1:1:1:1:f:6:cf:1:colspan:6\\ncell:C2:t::b:2::2::l:1:f:7\\ncell:D2:t::b:2::2::l:1:f:7\\ncell:E2:t::b:2::2::l:1:f:7\\ncell:F2:t::b:2::2::l:1:f:7\\ncell:G2:t::b:2::2::l:1:f:7\\ncell:A3:b::2:::l:3:f:7\\ncell:B3:b:2:::2:l:3:f:7\\ncell:C3:b:2::::l:1:f:7\\ncell:D3:b:2::::l:1:f:7\\ncell:E3:b:2::::l:1:f:7\\ncell:F3:b:2::::l:1:f:7\\ncell:G3:b:2:2:::l:3:f:7\\ncell:A4:b::2:::l:3:f:7\\ncell:B4:b::::2:l:3:f:3\\ncell:C4:t:INVOICE # \\\\c:f:2:cf:2\\ncell:D4:v:1:f:2:cf:2\\ncell:F4:tvf:4:rowspan:4\\ncell:G4:b::2:::l:3:f:7\\ncell:A5:b::2:::l:3:f:7\\ncell:B5:b::::2:l:3:f:4\\ncell:F5:t::l:2:f:7\\ncell:G5:t::b::1:::l:2:f:7\\ncell:A6:b::2:::l:3:f:7\\ncell:B6:b::::2:l:3:f:4\\ncell:C6:t:INVOICE DATE\\\\c:f:2:cf:2\\ncell:D6:f:2:cf:2:ntvf:3\\ncell:F6:l:2:f:7\\ncell:G6:b::1:::l:2:f:7\\ncell:A7:b::2:::l:3:f:7\\ncell:B7:b::::2:l:3:f:4\\ncell:G7:b::2:::l:3:f:7\\ncell:A8:b::2:::l:3:f:7\\ncell:B8:b::::2:l:3:f:4\\ncell:G8:b::2:::l:3:f:7\\ncell:A9:b::2:::l:3:f:7\\ncell:B9:b::::2:l:3:f:4\\ncell:C9:t:BILL TO\\\\c:l:3:f:2\\ncell:E9:t:FROM\\\\c:f:2:cf:2\\ncell:G9:b::2:::l:3:f:7\\ncell:A10:b::2:::l:3:f:7\\ncell:B10:b::::2:l:3:f:3\\ncell:C10:t:[Name]:f:1:cf:2:colspan:2\\ncell:E10:t:[Name]:f:1:cf:2:colspan:2\\ncell:G10:b::2:::l:3:f:7\\ncell:A11:b::2:::l:3:f:7\\ncell:B11:b::::2:l:3:f:7\\ncell:C11:t:[Street Address]:f:1:cf:2:colspan:2\\ncell:E11:t:[Street Address]:f:1:cf:2:colspan:2\\ncell:G11:b::2:::l:3:f:7\\ncell:A12:b::2:::l:3:f:7\\ncell:B12:b::::2:l:3:f:7\\ncell:C12:t:[City, State, Zip]:f:1:cf:2:colspan:2\\ncell:E12:t:[City, State, Zip]:f:1:cf:2:colspan:2\\ncell:G12:b::2:::l:3:f:7\\ncell:A13:b::2:::l:3:f:7\\ncell:B13:b::::2:l:3:f:7\\ncell:C13:t:Phone\\\\c:f:1:cf:2:colspan:2\\ncell:E13:t:Phone\\\\c:f:1:cf:2:colspan:2\\ncell:G13:b::2:::l:3:f:7\\ncell:A14:b::2:::l:3:f:7\\ncell:B14:b::::2:l:3:f:3:cf:2\\ncell:C14:b:::2::l:1:f:7\\ncell:D14:b:::2::l:3:f:3:cf:2\\ncell:E14:b:::2::l:1:f:7\\ncell:F14:b:::2::l:1:f:7\\ncell:G14:b::2:::l:3:f:7\\ncell:A15:b::2:::l:3:f:7\\ncell:B15:b::2::2:l:3:f:7\\ncell:C15:t:Description:b:1::1:1:f:2:cf:1:colspan:3\\ncell:D15:t:Description:b:1::1::l:3:f:3:cf:2:colspan:2:rowspan:1\\ncell:E15:t::b:2:2:2::l:1:f:7\\ncell:F15:t:Amount:b:1:1:1:1:f:2:cf:1\\ncell:G15:b::2::2:l:3:f:7\\ncell:A16:b::2:::l:3:f:7\\ncell:B16:b::2::2:l:3:f:7\\ncell:C16:b:1:1::1:f:1:cf:2:colspan:3\\ncell:D16:b:1:1:::l:3:f:7:cf:2:colspan:2:rowspan:1\\ncell:E16:t::b:2:2:2::l:1:f:7\\ncell:F16:b:1:1:::f:1:ntvf:1\\ncell:G16:b::2::2:l:3:f:7\\ncell:A17:b::2:::l:3:f:7\\ncell:B17:b::2::2:l:3:f:7:cf:2\\ncell:C17:b::1::1:f:1:cf:2:colspan:3\\ncell:D17:b::1:::l:1:f:7:colspan:2\\ncell:E17:l:1:f:7\\ncell:F17:b::1:::f:1:ntvf:1\\ncell:G17:b::2::2:l:3:f:7\\ncell:A18:b::2:::l:3:f:7\\ncell:B18:b::2::2:l:3:f:7:cf:2:ntvf:2\\ncell:C18:b::1::1:f:1:cf:2:colspan:3\\ncell:D18:b::1:::colspan:2\\ncell:F18:b::1:::f:1:ntvf:1\\ncell:G18:b::2::2:l:3:f:7\\ncell:A19:b::2:::l:3:f:7\\ncell:B19:b::2::2:l:3:f:7:cf:2:ntvf:2\\ncell:C19:b::1::1:f:1:cf:2:colspan:3\\ncell:D19:b::1:::colspan:2\\ncell:F19:b::1:::f:1:ntvf:1\\ncell:G19:b::2::2:l:3:f:7\\ncell:A20:b::2:::l:3:f:7\\ncell:B20:b::2::2:l:3:f:7:cf:2:ntvf:2\\ncell:C20:b::1::1:f:1:cf:2:colspan:3\\ncell:D20:b::1:::colspan:2\\ncell:F20:b::1:::f:1:ntvf:1\\ncell:G20:b::2::2:l:3:f:7\\ncell:A21:b::2:::l:3:f:7\\ncell:B21:b::2::2:l:3:f:7:cf:2:ntvf:2\\ncell:C21:b::1::1:f:1:cf:2:colspan:3\\ncell:D21:b::1:::colspan:2\\ncell:F21:b::1:::f:1:ntvf:1\\ncell:G21:b::2::2:l:3:f:7\\ncell:A22:b::2:::l:3:f:7\\ncell:B22:b::2::2:l:3:f:7:cf:2:ntvf:2\\ncell:C22:b::1::1:f:1:cf:2:colspan:3\\ncell:D22:b::1:::colspan:2\\ncell:F22:b::1:::f:1:ntvf:1\\ncell:G22:b::2::2:l:3:f:7\\ncell:A23:b::2:::l:3:f:7\\ncell:B23:b::2::2:l:3:f:7:cf:2\\ncell:C23:b::1::1:f:1:cf:2:colspan:3\\ncell:D23:b::1:::colspan:2\\ncell:F23:b::1:::f:1:ntvf:1\\ncell:G23:b::2::2:l:3:f:7\\ncell:A24:b::2:::l:3:f:7\\ncell:B24:b::2::2:l:3:f:7:cf:2\\ncell:C24:b::1::1:f:1:cf:2:colspan:3\\ncell:D24:b::1:::colspan:2\\ncell:F24:b::1:::f:1:ntvf:1\\ncell:G24:b::2::2:l:3:f:7\\ncell:A25:b::2:::l:3:f:7\\ncell:B25:b::2::2:l:3:f:7:cf:2\\ncell:C25:b::1::1:f:1:cf:2:colspan:3\\ncell:D25:b::1:::colspan:2\\ncell:F25:b::1:::f:1:ntvf:1\\ncell:G25:b::2::2:l:3:f:7\\ncell:A26:b::2:::l:3:f:7\\ncell:B26:b::2::2:l:3:f:7:cf:2\\ncell:C26:b::1::1:f:1:cf:2:colspan:3\\ncell:D26:b::1:::colspan:2\\ncell:F26:b::1:::f:1:ntvf:1\\ncell:G26:b::2::2:l:3:f:7\\ncell:A27:b::2:::l:3:f:7\\ncell:B27:b::2::2:l:3:f:7:cf:2\\ncell:C27:b::1::1:f:1:cf:2:colspan:3\\ncell:D27:b::1:::colspan:2\\ncell:F27:b::1:::f:1:ntvf:1\\ncell:G27:b::2::2:l:3:f:7\\ncell:A28:b::2:::l:3:f:4\\ncell:B28:b::2::2:l:3:f:7:cf:2\\ncell:C28:b::1:1:1:f:1:cf:2:colspan:3\\ncell:D28:b::1:1::l:3:f:7:cf:2:colspan:2\\ncell:E28:b:::2::l:3:f:7:cf:2\\ncell:F28:b::1:1::f:1:ntvf:1\\ncell:G28:b::2::2:l:3:f:7\\ncell:A29:b::2:::l:3:f:3\\ncell:B29:b::2::2:l:3:f:3\\ncell:C29:t:TOTAL:b:1:1:1:1:f:5:cf:2:colspan:3\\ncell:D29:b:2::2::l:3:f:8:cf:2\\ncell:E29:b:2:2:2::l:3:f:8:cf:2\\ncell:F29:vtf:n:0:SUM(F16\\\\cF28):b:1:1:1::f:5:ntvf:1\\ncell:G29:b::2::2:l:3:f:4\\ncell:A30:b::2:::l:3:f:7\\ncell:B30:b::::2:l:3:f:3:cf:2\\ncell:C30:b:2::::l:1:f:7\\ncell:D30:b:2::::l:1:f:7\\ncell:E30:b:2::::l:1:f:7\\ncell:F30:b:2::::l:1:f:7\\ncell:G30:b::2:::l:3:f:3\\ncell:A31:b::2:::l:3:f:7\\ncell:B31:b::::2:l:3:f:7\\ncell:D31:tvf:4:rowspan:4\\ncell:G31:b::2:::l:3:f:7\\ncell:A32:b::2:::l:3:f:7\\ncell:B32:b::::2:l:3:f:7\\ncell:G32:b::2:::l:3:f:7\\ncell:A33:b::2:::l:3:f:7\\ncell:B33:b::::2:l:3:f:7\\ncell:G33:b::2:::l:3:f:7\\ncell:A34:b::2:::l:3:f:7\\ncell:B34:b::::2:l:3:f:7\\ncell:G34:b::2:::l:3:f:7\\ncell:A35:b::2:::l:3:f:7\\ncell:B35:b:::2:2:l:3:f:7\\ncell:C35:b:::2::l:3:f:7\\ncell:D35:b:::2::l:3:f:7\\ncell:E35:b:::2::l:3:f:7\\ncell:F35:b:::2::l:3:f:7\\ncell:G35:b::2:2::l:3:f:7\\ncell:B36:b:1:::\\ncell:C36:b:1:::\\ncell:D36:b:1:::\\ncell:E36:b:1:::\\ncell:F36:b:1:::\\ncell:G36:b:1:::\\ncol:A:w:10\\ncol:B:w:42\\ncol:C:w:105\\ncol:D:w:182\\ncol:E:w:110\\ncol:F:w:115\\ncol:G:w:65\\nrow:1:h:14.25\\nrow:2:h:18.75\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:15.75\\nrow:6:h:15.75\\nrow:7:h:15.75\\nrow:8:h:15.75\\nrow:9:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:13:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:16:h:14.25\\nrow:17:h:14.25\\nrow:18:h:14.25\\nrow:19:h:14.25\\nrow:20:h:14.25\\nrow:21:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nrow:24:h:14.25\\nrow:25:h:14.25\\nrow:26:h:14.25\\nrow:27:h:14.25\\nrow:28:h:15.75\\nrow:29:h:15.75\\nrow:30:h:14.25\\nrow:31:h:14.25\\nrow:32:h:14.25\\nrow:33:h:14.25\\nrow:34:h:14.25\\nrow:35:h:14.25\\nsheet:c:7:r:36:h:12.75\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\nfont:1:* * Trebuchet MS\\nfont:2:normal bold * Trebuchet MS\\nfont:3:normal bold 10pt Arial\\nfont:4:normal bold 12pt Arial\\nfont:5:normal bold 12pt Trebuchet MS\\nfont:6:normal bold 14pt Trebuchet MS\\nfont:7:normal normal 10pt Arial\\nfont:8:normal normal 12pt Arial\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nlayout:3:padding:* * * *;vertical-align:top;\\nvalueformat:1:#,##0.00\\nvalueformat:2:d-mmm\\nvalueformat:3:m/d/yy\\nvalueformat:4:text-html\\n\"},\"name\":\"typei\",\"hidden\":\"0\"},\"sheet2\":{\"sheetstr\":{\"savestr\":\"version:1.5\\ncell:A2:b::2:::l:1:f:7\\ncell:B2:t:INVOICE:b:1:1:1:1:l:3:f:6:cf:1:colspan:8\\ncell:C2:t::b:2::2::l:1:f:7\\ncell:D2:t::b:2::2::l:1:f:7\\ncell:E2:t::b:2::2::l:1:f:7\\ncell:F2:t::b:2::2::l:1:f:7\\ncell:G2:b:2::2::l:1:f:7\\ncell:H2:b:2::2::l:1:f:7\\ncell:I2:t::b:2::2::l:1:f:7\\ncell:A3:b::2:::l:3:f:7\\ncell:B3:b:2:::2:l:3:f:7\\ncell:E3:b:2::::l:1:f:7\\ncell:F3:b:2::::l:1:f:7\\ncell:G3:b:2::::l:1:f:7\\ncell:H3:b:2::::l:1:f:7\\ncell:I3:b:2:2:::l:3:f:7\\ncell:A4:b::2:::l:3:f:7\\ncell:B4:b::::2:l:3:f:3\\ncell:C4:t:INVOICE # \\\\c:f:2:cf:2\\ncell:D4:v:1:f:2:cf:2\\ncell:F4:tvf:5:colspan:2:rowspan:4\\ncell:I4:b::2:::l:3:f:7\\ncell:A5:b::2:::l:3:f:7\\ncell:B5:b::::2:l:3:f:4\\ncell:F5:t::l:2:f:7\\ncell:G5:l:2:f:7\\ncell:H5:l:2:f:7\\ncell:I5:t::b::1:::l:2:f:7\\ncell:A6:b::2:::l:3:f:7\\ncell:B6:b::::2:l:3:f:4\\ncell:C6:t:INVOICE DATE\\\\c:f:2:cf:2\\ncell:D6:f:2:cf:2:ntvf:4\\ncell:F6:l:2:f:7\\ncell:G6:l:2:f:7\\ncell:H6:l:2:f:7\\ncell:I6:b::1:::l:2:f:7\\ncell:A7:b::2:::l:3:f:7\\ncell:B7:b::::2:l:3:f:4\\ncell:I7:b::2:::l:3:f:7\\ncell:A8:b::2:::l:3:f:7\\ncell:B8:b::::2:l:3:f:4\\ncell:I8:b::2:::l:3:f:7\\ncell:A9:b::2:::l:3:f:7\\ncell:B9:b::::2:l:3:f:4\\ncell:C9:t:BILL TO\\\\c:f:2\\ncell:E9:t:FROM\\\\c:f:2:cf:2\\ncell:F9:colspan:3\\ncell:I9:b::2:::l:3:f:7\\ncell:A10:b::2:::l:3:f:7\\ncell:B10:b::::2:l:3:f:3\\ncell:C10:t:[Name]:f:1:cf:2:colspan:2\\ncell:E10:t:[Name]:f:1:cf:2:colspan:4\\ncell:I10:b::2:::l:3:f:7\\ncell:A11:b::2:::l:3:f:7\\ncell:B11:b::::2:l:3:f:7\\ncell:C11:t:[Street Address]:f:1:cf:2:colspan:2\\ncell:E11:t:[Street Address]:f:1:colspan:4\\ncell:I11:b::2:::l:3:f:7\\ncell:A12:b::2:::l:3:f:7\\ncell:B12:b::::2:l:3:f:7\\ncell:C12:t:[City, State, Zip]:f:1:cf:2:colspan:2\\ncell:E12:t:[City, State, Zip]:f:1:cf:2:colspan:4\\ncell:I12:b::2:::l:3:f:7\\ncell:A13:b::2:::l:3:f:7\\ncell:B13:b::::2:l:3:f:7\\ncell:C13:t:Phone\\\\c :f:1:cf:2:colspan:2\\ncell:E13:t:Phone\\\\c :f:1:cf:2:colspan:4\\ncell:I13:b::2:::l:3:f:7\\ncell:A14:b::2:::l:3:f:7\\ncell:B14:b::::2:l:3:f:3:cf:2\\ncell:C14:b:::2::l:1:f:7\\ncell:D14:b:::2::l:3:f:3:cf:2\\ncell:E14:b:::2::l:1:f:7\\ncell:F14:b:::2::l:1:f:7\\ncell:G14:b:::2::l:1:f:7\\ncell:H14:b:::2::l:1:f:7\\ncell:I14:b::2:::l:3:f:7\\ncell:A15:b::2:::l:3:f:7\\ncell:B15:b::2::2:l:3:f:7\\ncell:C15:t:Description:b:1:1:1:1:f:2:cf:1:colspan:3\\ncell:D15:t:Description:b:2::2:2:l:3:f:3:cf:2:colspan:2:rowspan:1\\ncell:E15:t::b:2:2:2::l:1:f:7\\ncell:F15:t:Hours:b:1:1:1:1:f:2:cf:1\\ncell:G15:t:Rate:b:1:1:1:1:f:2:cf:1\\ncell:H15:t:Amount:b:1:1:1:1:f:2:cf:1\\ncell:I15:b::2::2:l:3:f:7\\ncell:A16:b::2:::l:3:f:7\\ncell:B16:b::2::2:l:3:f:7\\ncell:C16:b:1:1::1:f:1:cf:2:colspan:3\\ncell:D16:b:1:1::1:l:3:f:7:cf:2:colspan:2:rowspan:1\\ncell:E16:t::b:2:2:2::l:1:f:7\\ncell:F16:b:1:1:::f:1:ntvf:1\\ncell:G16:b:1:1:::f:1:ntvf:1\\ncell:H16:vtf:t::IF(F16*G16>0,F16*G16,\\\"\\\"):b:1:1:::f:1:ntvf:1\\ncell:I16:b::2::2:l:3:f:7\\ncell:A17:b::2:::l:3:f:7\\ncell:B17:b::2::2:l:3:f:7:cf:2\\ncell:C17:b::1::1:f:1:cf:2:colspan:3\\ncell:D17:b::1::1:l:1:f:7:colspan:2\\ncell:E17:l:1:f:7\\ncell:F17:b::1:::f:1:ntvf:1\\ncell:G17:b::1:::f:1:ntvf:1\\ncell:H17:vtf:t::IF(F17*G17>0,F17*G17,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I17:b::2::2:l:3:f:7\\ncell:A18:b::2:::l:3:f:7\\ncell:B18:b::2::2:l:3:f:7:cf:2:ntvf:3\\ncell:C18:b::1::1:f:1:cf:2:colspan:3\\ncell:D18:b::1::1:colspan:2\\ncell:F18:b::1:::f:1:ntvf:1\\ncell:G18:b::1:::f:1:ntvf:1\\ncell:H18:vtf:t::IF(F18*G18>0,F18*G18,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I18:b::2::2:l:3:f:7\\ncell:A19:b::2:::l:3:f:7\\ncell:B19:b::2::2:l:3:f:7:cf:2:ntvf:3\\ncell:C19:b::1::1:f:1:cf:2:colspan:3\\ncell:D19:b::1::1:colspan:2\\ncell:F19:b::1:::f:1:ntvf:1\\ncell:G19:b::1:::f:1:ntvf:1\\ncell:H19:vtf:t::IF(F19*G19>0,F19*G19,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I19:b::2::2:l:3:f:7\\ncell:A20:b::2:::l:3:f:7\\ncell:B20:b::2::2:l:3:f:7:cf:2:ntvf:3\\ncell:C20:b::1::1:f:1:cf:2:colspan:3\\ncell:D20:b::1::1:colspan:2\\ncell:F20:b::1:::f:1:ntvf:1\\ncell:G20:b::1:::f:1:ntvf:1\\ncell:H20:vtf:t::IF(F20*G20>0,F20*G20,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I20:b::2::2:l:3:f:7\\ncell:A21:b::2:::l:3:f:7\\ncell:B21:b::2::2:l:3:f:7:cf:2:ntvf:3\\ncell:C21:b::1::1:f:1:cf:2:colspan:3\\ncell:D21:b::1::1:colspan:2\\ncell:F21:b::1:::f:1:ntvf:1\\ncell:G21:b::1:::f:1:ntvf:1\\ncell:H21:vtf:t::IF(F21*G21>0,F21*G21,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I21:b::2::2:l:3:f:7\\ncell:A22:b::2:::l:3:f:7\\ncell:B22:b::2::2:l:3:f:7:cf:2:ntvf:3\\ncell:C22:b::1::1:f:1:cf:2:colspan:3\\ncell:D22:b::1::1:colspan:2\\ncell:F22:b::1:::f:1:ntvf:1\\ncell:G22:b::1:::f:1:ntvf:1\\ncell:H22:vtf:t::IF(F22*G22>0,F22*G22,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I22:b::2::2:l:3:f:7\\ncell:A23:b::2:::l:3:f:7\\ncell:B23:b::2::2:l:3:f:7:cf:2\\ncell:C23:b::1::1:f:1:cf:2:colspan:3\\ncell:D23:b::1::1:colspan:2\\ncell:F23:b::1:::f:1:ntvf:1\\ncell:G23:b::1:::f:1:ntvf:1\\ncell:H23:vtf:t::IF(F23*G23>0,F23*G23,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I23:b::2::2:l:3:f:7\\ncell:A24:b::2:::l:3:f:7\\ncell:B24:b::2::2:l:3:f:7:cf:2\\ncell:C24:b::1::1:f:1:cf:2:colspan:3\\ncell:D24:b::1::1:colspan:2\\ncell:F24:b::1:::f:1:ntvf:1\\ncell:G24:b::1:::f:1:ntvf:1\\ncell:H24:vtf:t::IF(F24*G24>0,F24*G24,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I24:b::2::2:l:3:f:7\\ncell:A25:b::2:::l:3:f:7\\ncell:B25:b::2::2:l:3:f:7:cf:2\\ncell:C25:b::1::1:f:1:cf:2:colspan:3\\ncell:D25:b::1::1:colspan:2\\ncell:F25:b::1:::f:1:ntvf:1\\ncell:G25:b::1:::f:1:ntvf:1\\ncell:H25:vtf:t::IF(F25*G25>0,F25*G25,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I25:b::2::2:l:3:f:7\\ncell:A26:b::2:::l:3:f:7\\ncell:B26:b::2::2:l:3:f:7:cf:2\\ncell:C26:b::1::1:f:1:cf:2:colspan:3\\ncell:D26:b::1::1:colspan:2\\ncell:F26:b::1:::f:1:ntvf:1\\ncell:G26:b::1:::f:1:ntvf:1\\ncell:H26:vtf:t::IF(F26*G26>0,F26*G26,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I26:b::2::2:l:3:f:7\\ncell:A27:b::2:::l:3:f:7\\ncell:B27:b::2::2:l:3:f:7:cf:2\\ncell:C27:b::1::1:f:1:cf:2:colspan:3\\ncell:D27:b::1::1:colspan:2\\ncell:F27:b::1:::f:1:ntvf:1\\ncell:G27:b::1:::f:1:ntvf:1\\ncell:H27:vtf:t::IF(F27*G27>0,F27*G27,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I27:b::2::2:l:3:f:7\\ncell:A28:b::2:::l:3:f:4\\ncell:B28:b::2::2:l:3:f:7:cf:2\\ncell:C28:b::1:1:1:f:1:cf:2:colspan:3\\ncell:D28:b::1:1:1:l:3:f:7:cf:2:colspan:2\\ncell:E28:b:::2::l:3:f:7:cf:2\\ncell:F28:b::1:1::f:1:ntvf:1\\ncell:G28:b::1:1::f:1:ntvf:1\\ncell:H28:vtf:t::IF(F28*G28>0,F28*G28,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I28:b::2::2:l:3:f:7\\ncell:A29:b::2:::l:3:f:3\\ncell:B29:b::2::2:l:3:f:3\\ncell:C29:t:TOTAL:b:1:1:1:1:l:3:f:5:cf:2:colspan:5\\ncell:D29:b:2::2::l:3:f:8:cf:2\\ncell:E29:b:2:2:2::l:3:f:8:cf:2\\ncell:F29:vtf:n:0:SUM(F16\\\\cF28):b:2:2:2::l:3:f:4:ntvf:2\\ncell:G29:b:2:2:2::l:3:f:4:ntvf:2\\ncell:H29:vtf:n:0:SUM(H16\\\\cH28):b:1:1:1::f:5:ntvf:1\\ncell:I29:b::2::2:l:3:f:4\\ncell:A30:b::2:::l:3:f:7\\ncell:B30:b::::2:l:3:f:3:cf:2\\ncell:C30:b:2::::l:1:f:7\\ncell:D30:b:2::::l:1:f:7\\ncell:E30:b:2::::l:1:f:7\\ncell:F30:b:2::::l:1:f:7\\ncell:G30:b:2::::l:1:f:7\\ncell:H30:b:2::::l:1:f:7\\ncell:I30:b::2:::l:3:f:3\\ncell:A31:b::2:::l:3:f:7\\ncell:B31:b::::2:l:3:f:7\\ncell:D31:tvf:5:rowspan:4\\ncell:I31:b::2:::l:3:f:7\\ncell:A32:b::2:::l:3:f:7\\ncell:B32:b::::2:l:3:f:7\\ncell:I32:b::2:::l:3:f:7\\ncell:A33:b::2:::l:3:f:7\\ncell:B33:b::::2:l:3:f:7\\ncell:I33:b::2:::l:3:f:7\\ncell:A34:b::2:::l:3:f:7\\ncell:B34:b::::2:l:3:f:7\\ncell:I34:b::2:::l:3:f:7\\ncell:A35:b::2:::l:3:f:7\\ncell:B35:b:::2:2:l:3:f:7\\ncell:C35:b:::2::l:3:f:7\\ncell:D35:b:::2::l:3:f:7\\ncell:E35:b:::2::l:3:f:7\\ncell:F35:b:::2::l:3:f:7\\ncell:G35:b:::2::l:3:f:7\\ncell:H35:b:::2::l:3:f:7\\ncell:I35:b::2:2::l:3:f:7\\ncell:B36:b:1:::\\ncell:C36:b:1:::\\ncell:D36:b:1:::\\ncell:E36:b:1:::\\ncell:F36:b:1:::\\ncell:G36:b:1:::\\ncell:H36:b:1:::\\ncell:I36:b:1:::\\ncol:A:w:26\\ncol:B:w:28\\ncol:C:w:96\\ncol:D:w:203\\ncol:E:w:51\\ncol:F:w:50\\ncol:G:w:58\\ncol:H:w:80\\ncol:I:w:28\\nrow:1:h:14.25\\nrow:2:h:18.75\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:15.75\\nrow:6:h:15.75\\nrow:7:h:15.75\\nrow:8:h:15.75\\nrow:9:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:13:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:16:h:14.25\\nrow:17:h:14.25\\nrow:18:h:14.25\\nrow:19:h:14.25\\nrow:20:h:14.25\\nrow:21:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nrow:24:h:14.25\\nrow:25:h:14.25\\nrow:26:h:14.25\\nrow:27:h:14.25\\nrow:28:h:15.75\\nrow:29:h:15.75\\nrow:30:h:14.25\\nrow:31:h:14.25\\nrow:32:h:14.25\\nrow:33:h:14.25\\nrow:34:h:14.25\\nrow:35:h:14.25\\nsheet:c:9:r:36:h:12.75\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\nfont:1:* * Trebuchet MS\\nfont:2:normal bold * Trebuchet MS\\nfont:3:normal bold 10pt Arial\\nfont:4:normal bold 12pt Arial\\nfont:5:normal bold 12pt Trebuchet MS\\nfont:6:normal bold 14pt Trebuchet MS\\nfont:7:normal normal 10pt Arial\\nfont:8:normal normal 12pt Arial\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nlayout:3:padding:* * * *;vertical-align:top;\\nvalueformat:1:#,##0.00\\nvalueformat:2:#,##0.00;(#,##0.00)\\nvalueformat:3:d-mmm\\nvalueformat:4:m/d/yy\\nvalueformat:5:text-html\\n\"},\"name\":\"typeii\",\"hidden\":\"0\"},\"sheet3\":{\"sheetstr\":{\"savestr\":\"version:1.5\\ncell:A1:l:3\\ncell:B2:t:[Company Name]:l:1:f:3:cf:2:colspan:3\\ncell:C2:t::l:2:f:9\\ncell:D2:t::l:2:f:9\\ncell:E2:l:1:f:7:c:2:cf:3\\ncell:F2:t:INVOICE:l:1:f:7:c:2:cf:2:colspan:2\\ncell:G2:t::l:2:f:9\\ncell:B3:t:[Company Slogan]:f:4:cf:2:colspan:3\\ncell:C3:t::l:2:f:9\\ncell:D3:t::l:2:f:9\\ncell:B4:f:2:colspan:2\\ncell:F4:tvf:4:rowspan:4\\ncell:B5:t:[Street Address]:f:1:cf:2:colspan:2\\ncell:F5:l:1:f:6\\ncell:G5:l:1:f:10:cf:1\\ncell:B6:t:[City, State,  Zip]:f:1:cf:2:colspan:2\\ncell:G6:l:1:f:9\\ncell:B7:t:Phone\\\\c :f:1:cf:2:colspan:2\\ncell:B8:t:Email\\\\c:f:1:cf:2:colspan:2\\ncell:B9:colspan:2\\ncell:F9:t:DATE \\\\c:l:1:f:6:cf:2\\ncell:G9:l:1:f:10:cf:2:ntvf:3\\ncell:B10:t:BILL TO\\\\c:f:5:c:1:bg:3:cf:2:colspan:2\\ncell:F10:t:INVOICE # \\\\c:l:1:f:6:cf:2\\ncell:G10:v:1:l:1:f:10:cf:2\\ncell:B11:t:[Name]:f:1:cf:2:colspan:2\\ncell:B12:t:[Company Name]:f:1:cf:2:colspan:2\\ncell:F12:t:  \\ncell:B13:t:[Street Address]:f:1:cf:2:colspan:2\\ncell:B14:t:[City, State,  Zip]:f:1:cf:2:colspan:2\\ncell:B15:t:Phone\\\\c :f:1:cf:2:colspan:2\\ncell:A17:b::1::\\ncell:B17:t:DESCRIPTION:b:1:1:1:1:l:1:f:6:c:1:bg:3:cf:1:colspan:5:rowspan:1\\ncell:C17:t::l:2:f:9\\ncell:D17:t::l:2:f:9\\ncell:E17:t::l:2:f:9\\ncell:F17:t::l:2:f:9\\ncell:G17:t:AMOUNT:b:1:1:1::l:1:f:6:c:1:bg:3:cf:1\\ncell:A18:b::1::\\ncell:B18:b:1:1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C18:t::l:2:f:9\\ncell:D18:t::l:2:f:9\\ncell:E18:t::l:2:f:9\\ncell:F18:t::b::2:::l:1:f:9\\ncell:G18:b::1::1:f:1:ntvf:1\\ncell:A19:b::1::\\ncell:B19:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C19:t::l:2:f:9\\ncell:D19:t::l:2:f:9\\ncell:E19:t::l:2:f:9\\ncell:F19:t::b::2:::l:1:f:9\\ncell:G19:b::1::1:f:1:ntvf:1\\ncell:A20:b::1::\\ncell:B20:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C20:t::l:2:f:9\\ncell:D20:t::l:2:f:9\\ncell:E20:t::l:2:f:9\\ncell:F20:t::b::2:::l:1:f:9\\ncell:G20:b::1::1:f:1:ntvf:1\\ncell:A21:b::1::\\ncell:B21:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C21:t::l:2:f:9\\ncell:D21:t::l:2:f:9\\ncell:E21:t::l:2:f:9\\ncell:F21:t::b::2:::l:1:f:9\\ncell:G21:b::1::1:f:1:ntvf:1\\ncell:A22:b::1::\\ncell:B22:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C22:t::l:2:f:9\\ncell:D22:t::l:2:f:9\\ncell:E22:t::l:2:f:9\\ncell:F22:t::b::2:::l:1:f:9\\ncell:G22:b::1::1:f:1:ntvf:1\\ncell:A23:b::1::\\ncell:B23:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C23:t::l:2:f:9\\ncell:D23:t::l:2:f:9\\ncell:E23:t::l:2:f:9\\ncell:F23:t::b::2:::l:1:f:9\\ncell:G23:b::1::1:f:1:ntvf:1\\ncell:A24:b::1::\\ncell:B24:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C24:t::l:2:f:9\\ncell:D24:t::l:2:f:9\\ncell:E24:t::l:2:f:9\\ncell:F24:t::b::2:::l:1:f:9\\ncell:G24:b::1::1:f:1:ntvf:1\\ncell:A25:b::1::\\ncell:B25:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C25:t::l:2:f:9\\ncell:D25:t::l:2:f:9\\ncell:E25:t::l:2:f:9\\ncell:F25:t::b::2:::l:1:f:9\\ncell:G25:b::1::1:f:1:ntvf:1\\ncell:A26:b::1::\\ncell:B26:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C26:t::l:2:f:9\\ncell:D26:t::l:2:f:9\\ncell:E26:t::l:2:f:9\\ncell:F26:t::b::2:::l:1:f:9\\ncell:G26:b::1::1:f:1:ntvf:1\\ncell:A27:b::1::\\ncell:B27:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C27:t::l:2:f:9\\ncell:D27:t::l:2:f:9\\ncell:E27:t::l:2:f:9\\ncell:F27:t::b::2:::l:1:f:9\\ncell:G27:b::1::1:f:1:ntvf:1\\ncell:A28:b::1::\\ncell:B28:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C28:t::l:2:f:9\\ncell:D28:t::l:2:f:9\\ncell:E28:t::l:2:f:9\\ncell:F28:t::b::2:::l:1:f:9\\ncell:G28:b::1::1:f:1:ntvf:1\\ncell:A29:b::1::\\ncell:B29:b::1:1:1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C29:t::b:::2::l:1:f:9\\ncell:D29:t::b:::2::l:1:f:9\\ncell:E29:t::b:::2::l:1:f:9\\ncell:F29:t::b::2:2::l:1:f:9\\ncell:G29:b::1:1:1:f:1:ntvf:1\\ncell:B30:b:2::::l:1:f:9\\ncell:C30:b:2::::l:1:f:9\\ncell:D30:b:2::::l:1:f:9\\ncell:E30:b:2::::l:1:f:10\\ncell:F30:t:Subtotal:b:2::::l:1:f:10\\ncell:G30:vtf:n:0:SUM(G18\\\\cG29):b:1::::f:8:ntvf:1\\ncell:B31:t:NOTES:b:::2::l:1:f:6:cf:2:colspan:3:rowspan:1\\ncell:C31:t::b:::2::l:1:f:9\\ncell:D31:t::b:::2::l:1:f:9\\ncell:F31:t:Tax Rate:l:1:f:1\\ncell:G31:v:0:f:1:ntvf:2\\ncell:B32:b:1::::f:1:cf:2:colspan:3\\ncell:C32:t::b:2::::l:1:f:9\\ncell:D32:t::b:2::::l:1:f:9\\ncell:F32:t:Tax:l:1:f:1\\ncell:G32:vtf:n:0:G31*G30:f:1:ntvf:1\\ncell:B33:f:1:cf:2:colspan:3\\ncell:C33:t::l:2:f:9\\ncell:D33:t::l:2:f:9\\ncell:F33:t:Other:b:::1::l:1:f:1\\ncell:G33:v:0:b:::1::f:1:ntvf:1\\ncell:B34:b:::1::f:1:cf:2:colspan:3:rowspan:1\\ncell:C34:t::l:2:f:9\\ncell:D34:t::l:2:f:9\\ncell:F34:t:TOTAL:b:2::::l:1:f:6\\ncell:G34:vtf:n:0:(G30+G32)+G33:b:1::::f:5:ntvf:1\\ncell:C36:tvf:4:colspan:5:rowspan:7\\ncol:A:w:40\\ncol:B:w:232\\ncol:C:w:53\\ncol:D:w:90\\ncol:E:w:54\\ncol:F:w:91\\ncol:G:w:99\\nrow:1:h:34.5\\nrow:2:h:34.5\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:14.25\\nrow:6:h:14.25\\nrow:7:h:14.25\\nrow:8:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:13:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:17:h:14.25\\nrow:18:h:14.25\\nrow:19:h:14.25\\nrow:20:h:14.25\\nrow:21:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nrow:24:h:14.25\\nrow:25:h:14.25\\nrow:26:h:14.25\\nrow:27:h:14.25\\nrow:28:h:14.25\\nrow:29:h:14.25\\nrow:30:h:14.25\\nrow:31:h:14.25\\nrow:32:h:14.25\\nrow:33:h:14.25\\nrow:34:h:14.25\\nsheet:c:7:r:36:h:12.75:needsrecalc:yes\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\ncellformat:3:right\\ncolor:1:rgb(0, 0, 0)\\ncolor:2:rgb(0,0,0)\\ncolor:3:rgb(221, 221, 221)\\nfont:1:* * Trebuchet MS\\nfont:2:* 10pt *\\nfont:3:* 16pt Trebuchet MS\\nfont:4:italic normal * Trebuchet MS\\nfont:5:normal bold * Trebuchet MS\\nfont:6:normal bold 10pt Trebuchet MS\\nfont:7:normal bold 28pt Trebuchet MS\\nfont:8:normal normal * Trebuchet MS\\nfont:9:normal normal 10pt Arial\\nfont:10:normal normal 10pt Trebuchet MS\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nlayout:3:padding:36px * 28px *;vertical-align:*;\\nvalueformat:1:#,##0.00\\nvalueformat:2:#,##0.00%\\nvalueformat:3:m/d/yy\\nvalueformat:4:text-html\\n\"},\"name\":\"typeiii\",\"hidden\":\"0\"},\"sheet4\":{\"sheetstr\":{\"savestr\":\"version:1.5\\ncell:A1:l:3\\ncell:B2:t:[Company Name]:l:1:f:2:cf:2:colspan:3:rowspan:1\\ncell:C2:t::l:2:f:7\\ncell:D2:t::l:2:f:7\\ncell:F2:t:INVOICE:l:1:f:6:c:1:cf:2:colspan:2\\ncell:G2:t::l:2:f:7\\ncell:B3:t:[Company slogan]:f:3:cf:2:colspan:3:rowspan:1\\ncell:C3:t::l:2:f:7\\ncell:D3:t::l:2:f:7\\ncell:B4:cf:2:colspan:3:rowspan:1\\ncell:F4:tvf:4:rowspan:4\\ncell:B5:t:[Street Address]:f:1:cf:2:colspan:3:rowspan:1\\ncell:F5:l:1:f:5\\ncell:G5:l:1:f:8:cf:1\\ncell:B6:t:[City, State,  Zip]:f:1:cf:2:colspan:3:rowspan:1\\ncell:G6:l:1:f:7\\ncell:B7:t:Phone\\\\c :f:1:cf:2:colspan:3:rowspan:1\\ncell:B8:t:Email\\\\c:f:1:cf:2:colspan:3:rowspan:1\\ncell:B9:cf:2:colspan:3:rowspan:1\\ncell:B10:t:BILL TO\\\\c:l:1:f:5:bg:2:cf:2:colspan:2\\ncell:F10:t:DATE\\\\c:l:1:f:5:cf:2\\ncell:G10:l:1:f:8:cf:2:ntvf:3\\ncell:B11:t:[Name]:f:1:cf:2:colspan:3:rowspan:1\\ncell:F11:t:INVOICE # \\\\c:l:1:f:5:cf:2\\ncell:G11:v:1:l:1:f:8:cf:2\\ncell:B12:t:[Company Name]:f:1:cf:2:colspan:3:rowspan:1\\ncell:J12:tvf:4\\ncell:B13:t:[Street Address]:f:1:cf:2:colspan:3:rowspan:1\\ncell:B14:t:[City, State,  Zip]:f:1:cf:2:colspan:3:rowspan:1\\ncell:B15:t:Phone\\\\c :f:1:cf:2:colspan:3:rowspan:1\\ncell:B16:cf:2:colspan:3:rowspan:1\\ncell:A17:b::1::\\ncell:B17:t:DESCRIPTION:b:1:1:1:1:l:1:f:5:bg:2:cf:1:colspan:3:rowspan:1\\ncell:C17:t::b:1::1::l:1:f:7:bg:2\\ncell:D17:t::b:1::1::l:1:f:7:bg:2\\ncell:E17:t:HOURS:b:1:1:1::l:1:f:5:bg:2:cf:1\\ncell:F17:t:RATE:b:1:1:1::l:1:f:5:bg:2:cf:1\\ncell:G17:t:AMOUNT:b:1:1:1::l:1:f:5:bg:2:cf:1\\ncell:A18:b::1::\\ncell:B18:b:1:1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C18:t::b:2::::l:1:f:7\\ncell:D18:t::b:2:2:::l:1:f:7\\ncell:E18:b:1:1::1:f:1:ntvf:1\\ncell:F18:b:1:1::1:f:1:ntvf:1\\ncell:G18:vtf:t::IF(E18*F18>0,E18*F18,\\\"\\\"):b:1:1:::f:1:ntvf:1\\ncell:A19:b::1::\\ncell:B19:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C19:t::l:2:f:7\\ncell:D19:t::b::2:::l:1:f:7\\ncell:E19:b::1::1:f:1:ntvf:1\\ncell:F19:b::1::1:f:1:ntvf:1\\ncell:G19:vtf:t::IF(E19*F19>0,E19*F19,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A20:b::1::\\ncell:B20:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C20:t::l:2:f:7\\ncell:D20:t::b::2:::l:1:f:7\\ncell:E20:b::1::1:f:1:ntvf:1\\ncell:F20:b::1::1:f:1:ntvf:1\\ncell:G20:vtf:t::IF(E20*F20>0,E20*F20,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A21:b::1::\\ncell:B21:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C21:t::l:2:f:7\\ncell:D21:t::b::2:::l:1:f:7\\ncell:E21:b::1::1:f:1:ntvf:1\\ncell:F21:b::1::1:f:1:ntvf:1\\ncell:G21:vtf:t::IF(E21*F21>0,E21*F21,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A22:b::1::\\ncell:B22:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C22:t::l:2:f:7\\ncell:D22:t::b::2:::l:1:f:7\\ncell:E22:b::1::1:f:1:ntvf:1\\ncell:F22:b::1::1:f:1:ntvf:1\\ncell:G22:vtf:t::IF(E22*F22>0,E22*F22,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A23:b::1::\\ncell:B23:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C23:t::l:2:f:7\\ncell:D23:t::b::2:::l:1:f:7\\ncell:E23:b::1::1:f:1:ntvf:1\\ncell:F23:b::1::1:f:1:ntvf:1\\ncell:G23:vtf:t::IF(E23*F23>0,E23*F23,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A24:b::1::\\ncell:B24:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C24:t::l:2:f:7\\ncell:D24:t::b::2:::l:1:f:7\\ncell:E24:b::1::1:f:1:ntvf:1\\ncell:F24:b::1::1:f:1:ntvf:1\\ncell:G24:vtf:t::IF(E24*F24>0,E24*F24,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A25:b::1::\\ncell:B25:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C25:t::l:2:f:7\\ncell:D25:t::b::2:::l:1:f:7\\ncell:E25:b::1::1:f:1:ntvf:1\\ncell:F25:b::1::1:f:1:ntvf:1\\ncell:G25:vtf:t::IF(E25*F25>0,E25*F25,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A26:b::1::\\ncell:B26:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C26:t::l:2:f:7\\ncell:D26:t::b::2:::l:1:f:7\\ncell:E26:b::1::1:f:1:ntvf:1\\ncell:F26:b::1::1:f:1:ntvf:1\\ncell:G26:vtf:t::IF(E26*F26>0,E26*F26,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A27:b::1::\\ncell:B27:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C27:t::l:2:f:7\\ncell:D27:t::b::2:::l:1:f:7\\ncell:E27:b::1::1:f:1:ntvf:1\\ncell:F27:b::1::1:f:1:ntvf:1\\ncell:G27:vtf:t::IF(E27*F27>0,E27*F27,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A28:b::1::\\ncell:B28:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C28:t::l:2:f:7\\ncell:D28:t::b::2:::l:1:f:7\\ncell:E28:b::1::1:f:1:ntvf:1\\ncell:F28:b::1::1:f:1:ntvf:1\\ncell:G28:vtf:t::IF(E28*F28>0,E28*F28,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A29:b::1::\\ncell:B29:b::1:1:1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C29:t::b:::2::l:1:f:7\\ncell:D29:t::b::2:2::l:1:f:7\\ncell:E29:b::1:1:1:f:1:ntvf:1\\ncell:F29:b::1:1:1:f:1:ntvf:1\\ncell:G29:vtf:t::IF(E29*F29>0,E29*F29,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:B30:b:2::::l:1:f:8:cf:1:colspan:3:rowspan:1\\ncell:C30:t::b:2::::l:1:f:7\\ncell:D30:t::b:2::::l:1:f:7\\ncell:E30:b:2::::l:1:f:8\\ncell:F30:t:Subtotal:b:1::::f:1\\ncell:G30:vtf:n:0:SUM(G18\\\\cG29):b:1::::f:1:ntvf:1\\ncell:B31:t:NOTES:b:::2::l:1:f:5:cf:2:colspan:3:rowspan:1\\ncell:C31:t::b:::2::l:1:f:7\\ncell:D31:t::b:::2::l:1:f:7\\ncell:F31:t:Tax Rate:f:1\\ncell:G31:v:0:f:1:ntvf:2\\ncell:B32:b:1::::f:1:cf:2:colspan:3:rowspan:1\\ncell:C32:t::b:2::::l:1:f:7\\ncell:D32:t::b:2::::l:1:f:7\\ncell:F32:t:Tax:f:1\\ncell:G32:vtf:n:0:G31*G30:f:1:ntvf:1\\ncell:B33:f:1:cf:2:colspan:3:rowspan:1\\ncell:C33:t::l:2:f:7\\ncell:D33:t::l:2:f:7\\ncell:F33:t:Other:b:::1::l:1:f:1\\ncell:G33:v:0:b:::1::f:1:ntvf:1\\ncell:B34:f:1:cf:2:colspan:3:rowspan:1\\ncell:C34:t::l:2:f:7\\ncell:D34:t::l:2:f:7\\ncell:F34:t:TOTAL:b:1::::l:1:f:4\\ncell:G34:vtf:n:0:(G30+G32)+G33:b:1::::f:4:ntvf:1\\ncell:B35:b:2::::l:1:f:7\\ncell:C35:b:2::::l:1:f:7\\ncell:D35:b:2::::l:1:f:7\\ncell:C36:tvf:4:colspan:5:rowspan:7\\ncol:A:w:40\\ncol:B:w:194\\ncol:C:w:128\\ncol:D:w:60\\ncol:E:w:65\\ncol:F:w:95\\ncol:G:w:90\\nrow:1:h:34.5\\nrow:2:h:34.5\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:14.25\\nrow:6:h:14.25\\nrow:7:h:14.25\\nrow:8:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:13:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:17:h:14.25\\nrow:18:h:14.25\\nrow:19:h:14.25\\nrow:20:h:14.25\\nrow:21:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nrow:24:h:14.25\\nrow:25:h:14.25\\nrow:26:h:14.25\\nrow:27:h:14.25\\nrow:28:h:14.25\\nrow:29:h:14.25\\nrow:30:h:14.25\\nrow:31:h:14.25\\nrow:32:h:14.25\\nrow:33:h:14.25\\nrow:34:h:14.25\\nrow:35:h:14.25\\nsheet:c:10:r:36:h:12.75:needsrecalc:yes\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\ncolor:1:rgb(0,0,0)\\ncolor:2:rgb(221, 221, 221)\\nfont:1:* * Trebuchet MS\\nfont:2:* 16pt Trebuchet MS\\nfont:3:italic normal * Trebuchet MS\\nfont:4:normal bold * Trebuchet MS\\nfont:5:normal bold 10pt Trebuchet MS\\nfont:6:normal bold 28pt Trebuchet MS\\nfont:7:normal normal 10pt Arial\\nfont:8:normal normal 10pt Trebuchet MS\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nlayout:3:padding:36px * 28px *;vertical-align:*;\\nvalueformat:1:#,##0.00\\nvalueformat:2:#,##0.00%\\nvalueformat:3:m/d/yy\\nvalueformat:4:text-html\\n\"},\"name\":\"typeiv\",\"hidden\":\"0\"}},\"EditableCells\":{\"allow\":true,\"cells\":{\"typei!C10\":true,\"typei!B2\":true,\"typei!C11\":true,\"typei!C12\":true,\"typei!C13\":true,\"typei!D9\":true,\"typei!D4\":true,\"typei!D6\":true,\"typei!E10\":true,\"typei!E11\":true,\"typei!E12\":true,\"typei!E13\":true,\"typei!F9\":true,\"typei!C16\":true,\"typei!C17\":true,\"typei!C18\":true,\"typei!C19\":true,\"typei!C20\":true,\"typei!C21\":true,\"typei!C22\":true,\"typei!C23\":true,\"typei!C24\":true,\"typei!C25\":true,\"typei!C26\":true,\"typei!C27\":true,\"typei!C28\":true,\"typei!F16\":true,\"typei!F17\":true,\"typei!F18\":true,\"typei!F19\":true,\"typei!F20\":true,\"typei!F21\":true,\"typei!F22\":true,\"typei!F23\":true,\"typei!F24\":true,\"typei!F25\":true,\"typei!F26\":true,\"typei!F27\":true,\"typei!F28\":true,\"typei!E35\":true,\"typeii!B2\":true,\"typeii!D4\":true,\"typeii!C10\":true,\"typeii!C11\":true,\"typeii!C12\":true,\"typeii!C13\":true,\"typeii!D9\":true,\"typeii!E10\":true,\"typeii!E11\":true,\"typeii!E12\":true,\"typeii!E13\":true,\"typeii!F9\":true,\"typeii!C16\":true,\"typeii!C17\":true,\"typeii!C18\":true,\"typeii!C19\":true,\"typeii!C20\":true,\"typeii!C21\":true,\"typeii!C22\":true,\"typeii!C23\":true,\"typeii!C24\":true,\"typeii!C25\":true,\"typeii!C26\":true,\"typeii!C27\":true,\"typeii!C28\":true,\"typeii!F16\":true,\"typeii!F17\":true,\"typeii!F18\":true,\"typeii!F19\":true,\"typeii!F20\":true,\"typeii!F21\":true,\"typeii!F22\":true,\"typeii!F23\":true,\"typeii!F24\":true,\"typeii!F25\":true,\"typeii!F26\":true,\"typeii!F27\":true,\"typeii!F28\":true,\"typeii!G16\":true,\"typeii!G17\":true,\"typeii!G18\":true,\"typeii!G19\":true,\"typeii!G20\":true,\"typeii!G21\":true,\"typeii!G22\":true,\"typeii!G23\":true,\"typeii!G24\":true,\"typeii!G25\":true,\"typeii!G26\":true,\"typeii!G27\":true,\"typeii!G28\":true,\"typeii!E35\":true,\"typeiii!G9\":true,\"typeiii!G10\":true,\"typeiii!B2\":true,\"typeiii!B3\":true,\"typeiii!B4\":true,\"typeiii!B5\":true,\"typeiii!B6\":true,\"typeiii!B7\":true,\"typeiii!B8\":true,\"typeiii!B9\":true,\"typeiii!B11\":true,\"typeiii!B12\":true,\"typeiii!B13\":true,\"typeiii!B14\":true,\"typeiii!B15\":true,\"typeiii!B18\":true,\"typeiii!B19\":true,\"typeiii!B20\":true,\"typeiii!B21\":true,\"typeiii!B22\":true,\"typeiii!B23\":true,\"typeiii!B24\":true,\"typeiii!B25\":true,\"typeiii!B26\":true,\"typeiii!B27\":true,\"typeiii!B28\":true,\"typeiii!B29\":true,\"typeiii!G18\":true,\"typeiii!G19\":true,\"typeiii!G20\":true,\"typeiii!G21\":true,\"typeiii!G22\":true,\"typeiii!G23\":true,\"typeiii!G24\":true,\"typeiii!G25\":true,\"typeiii!G26\":true,\"typeiii!G27\":true,\"typeiii!G28\":true,\"typeiii!G29\":true,\"typeiii!B32\":true,\"typeiii!B33\":true,\"typeiii!B34\":true,\"typeiii!G31\":true,\"typeiii!G33\":true,\"typeiii!B37\":true,\"typeiv!G9\":true,\"typeiv!G10\":true,\"typeiv!B2\":true,\"typeiv!B3\":true,\"typeiv!B4\":true,\"typeiv!B5\":true,\"typeiv!B6\":true,\"typeiv!B7\":true,\"typeiv!B8\":true,\"typeiv!B11\":true,\"typeiv!B12\":true,\"typeiv!B13\":true,\"typeiv!B14\":true,\"typeiv!B15\":true,\"typeiv!B16\":true,\"typeiv!B18\":true,\"typeiv!B19\":true,\"typeiv!B20\":true,\"typeiv!B21\":true,\"typeiv!B22\":true,\"typeiv!B23\":true,\"typeiv!B24\":true,\"typeiv!B25\":true,\"typeiv!B26\":true,\"typeiv!B27\":true,\"typeiv!B28\":true,\"typeiv!B29\":true,\"typeiv!E18\":true,\"typeiv!E19\":true,\"typeiv!E20\":true,\"typeiv!E21\":true,\"typeiv!E22\":true,\"typeiv!E23\":true,\"typeiv!E24\":true,\"typeiv!E25\":true,\"typeiv!E26\":true,\"typeiv!E27\":true,\"typeiv!E28\":true,\"typeiv!E29\":true,\"typeiv!F18\":true,\"typeiv!F19\":true,\"typeiv!F2\":true,\"typeiv!F20\":true,\"typeiv!F21\":true,\"typeiv!F22\":true,\"typeiv!F23\":true,\"typeiv!F24\":true,\"typeiv!F25\":true,\"typeiv!F26\":true,\"typeiv!F27\":true,\"typeiv!F28\":true,\"typeiv!F29\":true,\"typeiv!B32\":true,\"typeiv!B33\":true,\"typeiv!B34\":true,\"typeiv!G31\":true,\"typeiv!G33\":true,\"typeiv!B37\":true,\"typeii!F15\":true,\"typeii!G15\":true,\"typeiv!E17\":true,\"typeiv!F17\":true,\"typeii!D6\":true,\"typeiv!G11\":true,\"typei!C4\":true,\"typeii!C4\":true,\"typeiii!F10\":true,\"typeiv!F11\":true,\"typeiv!F10\":true,\"typeiii!F9\":true,\"typeii!C6\":true,\"typei!C6\":true,\"typei!F4\":true,\"typeii!F4\":true,\"typeiii!F4\":true,\"typeiii!F2\":true,\"typeiv!F4\":true,\"typei!F29\":true,\"typeii!H29\":true,\"typeiii!G30\":true,\"typeiii!G34\":true,\"typeiv!G30\":true,\"typeiv!G34\":true},\"constraints\":{}}},\n        \t\"footers\": [{name: 'Invoice 1' , index: 1, isActive: true }, {name: 'Invoice 2' , index: 2, isActive: false}, \n                        {name: 'Company Invoice 1' , index: 3, isActive: false}, {name: 'Company Invoice 2' , index: 4, isActive: false}]\n        },\n        \"iPhone\":{\n        \t\"msc\": {\"numsheets\":5,\"currentid\":\"sheet1\",\"currentname\":\"inv1\",\"sheetArr\":{\"sheet1\":{\"sheetstr\":{\"savestr\":\"version:1.5\\ncell:B1:b:::2::l:1:f:10\\ncell:C1:b:::2::l:1:f:10\\ncell:D1:b:::2::l:1:f:10\\ncell:E1:b:::2::l:1:f:10\\ncell:F1:b:::2::l:1:f:10\\ncell:G1:b:::2::l:1:f:10\\ncell:A2:b::2:::l:1:f:10\\ncell:B2:t:INVOICE:b:1:1:1:1:f:13:cf:1:colspan:6\\ncell:C2:t::b:2::2::l:1:f:10\\ncell:D2:t::b:2::2::l:1:f:10\\ncell:E2:t::b:2::2::l:1:f:10\\ncell:F2:t::b:2::2::l:1:f:10\\ncell:G2:t::b:2::2::l:1:f:10\\ncell:A3:b::2:::l:3:f:10\\ncell:B3:b:2:::2:l:3:f:10\\ncell:C3:b:2::::l:1:f:10\\ncell:D3:b:2::::l:1:f:10\\ncell:E3:b:2::::l:1:f:10\\ncell:F3:b:2::::l:1:f:10\\ncell:G3:b:2:2:::l:3:f:10\\ncell:A4:b::2:::l:3:f:10\\ncell:B4:b::::2:l:3:f:6\\ncell:C4:t:BILL TO\\\\c:f:9:colspan:2\\ncell:E4:f:5:cf:2\\ncell:G4:b::2:::l:3:f:10\\ncell:A5:b::2:::l:3:f:10\\ncell:B5:b::::2:l:3:f:7\\ncell:C5:t:[Name]:f:9:cf:2:colspan:3\\ncell:E5:f:1:cf:2\\ncell:F5:t::l:2:f:10:tvf:4:rowspan:6\\ncell:G5:t::b::1:::l:2:f:10\\ncell:A6:b::2:::l:3:f:10\\ncell:B6:b::::2:l:3:f:7\\ncell:C6:t:[Street Address]:f:9:cf:2:colspan:3\\ncell:E6:f:1:cf:2\\ncell:F6:l:2:f:10\\ncell:G6:b::1:::l:2:f:10\\ncell:A7:b::2:::l:3:f:10\\ncell:B7:b::::2:l:3:f:7\\ncell:C7:t:[City, State, Zip]:f:9:cf:2:colspan:3\\ncell:E7:f:1:cf:2\\ncell:G7:b::2:::l:3:f:10\\ncell:A8:b::2:::l:3:f:10\\ncell:B8:b::::2:l:3:f:7\\ncell:C8:t:Phone\\\\c:f:9:cf:2:colspan:3\\ncell:D8:f:8:cf:2\\ncell:E8:f:1:cf:2\\ncell:G8:b::2:::l:3:f:10\\ncell:A9:b::2:::l:3:f:10\\ncell:B9:b::::2:l:3:f:7\\ncell:C9:t:Email\\\\c:f:9:cf:2:colspan:3\\ncell:E9:f:1:cf:2\\ncell:G9:b::2:::l:3:f:10\\ncell:A10:b::2:::l:3:f:10\\ncell:B10:b::::2:l:3:f:7\\ncell:C10:colspan:2\\ncell:G10:b::2:::l:3:f:10\\ncell:A11:b::2:::l:3:f:10\\ncell:B11:b::::2:l:3:f:7\\ncell:C11:t:FROM\\\\c:f:9:colspan:2\\ncell:E11:f:8:colspan:2\\ncell:G11:b::2:::l:3:f:10\\ncell:A12:b::2:::l:3:f:10\\ncell:B12:b::::2:l:3:f:7\\ncell:C12:t:[Name]:f:9:colspan:4\\ncell:E12:colspan:2\\ncell:G12:b::2:::l:3:f:10\\ncell:A13:b::2:::l:3:f:10\\ncell:B13:b::::2:l:3:f:7\\ncell:C13:t:[Street Address]:f:9:colspan:4\\ncell:E13:colspan:2\\ncell:G13:b::2:::l:3:f:10\\ncell:A14:b::2:::l:3:f:10\\ncell:B14:b::::2:l:3:f:7\\ncell:C14:t:[City, State, Zip]:f:9:colspan:4\\ncell:E14:colspan:2\\ncell:G14:b::2:::l:3:f:10\\ncell:A15:b::2:::l:3:f:10\\ncell:B15:b::::2:l:3:f:7\\ncell:C15:t:Phone\\\\c:f:9:colspan:4\\ncell:D15:f:8:cf:2:colspan:3\\ncell:E15:colspan:2\\ncell:G15:b::2:::l:3:f:10\\ncell:A16:b::2:::l:3:f:10\\ncell:B16:b::::2:l:3:f:7\\ncell:C16:t:Email\\\\c:f:9:colspan:4\\ncell:E16:colspan:2\\ncell:G16:b::2:::l:3:f:10\\ncell:A17:b::2:::l:3:f:10\\ncell:B17:b::::2:l:3:f:6\\ncell:G17:b::2:::l:3:f:10\\ncell:A18:b::2:::l:3:f:10\\ncell:B18:b::::2:l:3:f:10\\ncell:C18:t:INVOICE #\\\\c:f:9:cf:2:colspan:4\\ncell:D18:v:1:l:4:f:9:cf:2:colspan:3\\ncell:G18:b::2:::l:3:f:10\\ncell:A19:b::2:::l:3:f:10\\ncell:B19:b::::2:l:3:f:10\\ncell:G19:b::2:::l:3:f:10\\ncell:A20:b::2:::l:3:f:10\\ncell:B20:b::::2:l:3:f:10\\ncell:C20:t:DATE\\\\c:f:9:cf:2\\ncell:D20:vtf:nd:42081:TODAY():f:9:cf:2:ntvf:3:colspan:2\\ncell:G20:b::2:::l:3:f:10\\ncell:A21:b::2:::l:3:f:10\\ncell:B21:b::::2:l:3:f:6:cf:2\\ncell:C21:b:::2::l:1:f:10\\ncell:D21:b:::2::l:3:f:6:cf:2\\ncell:E21:b:::2::l:1:f:10\\ncell:F21:b:::2::l:1:f:10\\ncell:G21:b::2:::l:3:f:10\\ncell:A22:b::2:::l:3:f:10\\ncell:B22:b::2::2:l:3:f:10\\ncell:C22:t:Description:b:1::1:1:f:9:cf:1:colspan:3\\ncell:D22:t:Description:b:1::1::l:3:f:6:cf:2:colspan:2:rowspan:1\\ncell:E22:t::b:2:2:2::l:1:f:10\\ncell:F22:t:Amount:b:1:1:1:1:f:9:cf:1\\ncell:G22:b::2::2:l:3:f:10\\ncell:A23:b::2:::l:3:f:10\\ncell:B23:b::2::2:l:3:f:10\\ncell:C23:b:1:1::1:f:2:cf:2:colspan:3\\ncell:D23:b:1:1:::l:3:f:10:cf:2:colspan:2:rowspan:1\\ncell:E23:t::b:2:2:2::l:1:f:10\\ncell:F23:b:1:1:::f:2:ntvf:1\\ncell:G23:b::2::2:l:3:f:10\\ncell:A24:b::2:::l:3:f:10\\ncell:B24:b::2::2:l:3:f:10:cf:2\\ncell:C24:b::1::1:f:2:cf:2:colspan:3\\ncell:D24:b::1:::l:1:f:10:colspan:2\\ncell:E24:l:1:f:10\\ncell:F24:b::1:::f:2:ntvf:1\\ncell:G24:b::2::2:l:3:f:10\\ncell:A25:b::2:::l:3:f:10\\ncell:B25:b::2::2:l:3:f:10:cf:2:ntvf:2\\ncell:C25:b::1::1:f:2:cf:2:colspan:3\\ncell:D25:b::1:::colspan:2\\ncell:F25:b::1:::f:2:ntvf:1\\ncell:G25:b::2::2:l:3:f:10\\ncell:A26:b::2:::l:3:f:10\\ncell:B26:b::2::2:l:3:f:10:cf:2:ntvf:2\\ncell:C26:b::1::1:f:2:cf:2:colspan:3\\ncell:D26:b::1:::colspan:2\\ncell:F26:b::1:::f:2:ntvf:1\\ncell:G26:b::2::2:l:3:f:10\\ncell:A27:b::2:::l:3:f:10\\ncell:B27:b::2::2:l:3:f:10:cf:2:ntvf:2\\ncell:C27:b::1::1:f:2:cf:2:colspan:3\\ncell:D27:b::1:::colspan:2\\ncell:F27:b::1:::f:2:ntvf:1\\ncell:G27:b::2::2:l:3:f:10\\ncell:A28:b::2:::l:3:f:10\\ncell:B28:b::2::2:l:3:f:10:cf:2:ntvf:2\\ncell:C28:b::1::1:f:2:cf:2:colspan:3\\ncell:D28:b::1:::colspan:2\\ncell:F28:b::1:::f:2:ntvf:1\\ncell:G28:b::2::2:l:3:f:10\\ncell:A29:b::2:::l:3:f:10\\ncell:B29:b::2::2:l:3:f:10:cf:2:ntvf:2\\ncell:C29:b::1::1:f:2:cf:2:colspan:3\\ncell:D29:b::1:::colspan:2\\ncell:F29:b::1:::f:2:ntvf:1\\ncell:G29:b::2::2:l:3:f:10\\ncell:A30:b::2:::l:3:f:10\\ncell:B30:b::2::2:l:3:f:10:cf:2\\ncell:C30:b::1::1:f:2:cf:2:colspan:3\\ncell:D30:b::1:::colspan:2\\ncell:F30:b::1:::f:2:ntvf:1\\ncell:G30:b::2::2:l:3:f:10\\ncell:A31:b::2:::l:3:f:10\\ncell:B31:b::2::2:l:3:f:10:cf:2\\ncell:C31:b::1::1:f:2:cf:2:colspan:3\\ncell:D31:b::1:::colspan:2\\ncell:F31:b::1:::f:2:ntvf:1\\ncell:G31:b::2::2:l:3:f:10\\ncell:A32:b::2:::l:3:f:10\\ncell:B32:b::2::2:l:3:f:10:cf:2\\ncell:C32:b::1::1:f:2:cf:2:colspan:3\\ncell:D32:b::1:::colspan:2\\ncell:F32:b::1:::f:2:ntvf:1\\ncell:G32:b::2::2:l:3:f:10\\ncell:A33:b::2:::l:3:f:10\\ncell:B33:b::2::2:l:3:f:10:cf:2\\ncell:C33:b::1::1:f:2:cf:2:colspan:3\\ncell:D33:b::1:::colspan:2\\ncell:F33:b::1:::f:2:ntvf:1\\ncell:G33:b::2::2:l:3:f:10\\ncell:A34:b::2:::l:3:f:10\\ncell:B34:b::2::2:l:3:f:10:cf:2\\ncell:C34:b::1::1:f:2:cf:2:colspan:3\\ncell:D34:b::1:::colspan:2\\ncell:F34:b::1:::f:2:ntvf:1\\ncell:G34:b::2::2:l:3:f:10\\ncell:A35:b::2:::l:3:f:7\\ncell:B35:b::2::2:l:3:f:10:cf:2\\ncell:C35:b::1:1:1:f:2:cf:2:colspan:3\\ncell:D35:b::1:1::l:3:f:10:cf:2:colspan:2\\ncell:E35:b:::2::l:3:f:10:cf:2\\ncell:F35:b::1:1::f:2:ntvf:1\\ncell:G35:b::2::2:l:3:f:10\\ncell:A36:b::2:::l:3:f:6\\ncell:B36:b::2::2:l:3:f:6\\ncell:C36:t:TOTAL:b:1:1:1:1:f:11:cf:2:colspan:3\\ncell:D36:b:2::2::l:3:f:12:cf:2\\ncell:E36:b:2:2:2::l:3:f:12:cf:2\\ncell:F36:vtf:n:0:SUM(F23\\\\cF35):b:1:1:1::f:11:ntvf:1\\ncell:G36:b::2::2:l:3:f:7\\ncell:A37:b::2:::l:3:f:10\\ncell:B37:b::::2:l:3:f:6:cf:2\\ncell:C37:b:2::::l:1:f:10\\ncell:D37:b:2::::l:1:f:10\\ncell:E37:b:2::::l:1:f:10\\ncell:F37:b:2::::l:1:f:10\\ncell:G37:b::2:::l:3:f:6\\ncell:A38:b::2:::l:3:f:10\\ncell:B38:b::::2:l:3:f:10\\ncell:G38:b::2:::l:3:f:10\\ncell:A39:b::2:::l:3:f:10\\ncell:B39:b::::2:l:3:f:10:cf:2\\ncell:C39:t:Thank you for your business:f:4:cf:1:colspan:4\\ncell:D39:t:Thank you for your business:colspan:3\\ncell:E39:t:Thank you for your business:f:3:colspan:2\\ncell:F39:t::l:2:f:10\\ncell:G39:b::2:::l:3:f:10\\ncell:A40:b::2:::l:3:f:10\\ncell:B40:b::::2:l:3:f:10\\ncell:G40:b::2:::l:3:f:10\\ncell:A41:b::2:::l:3:f:10\\ncell:B41:b:::2:2:l:3:f:10\\ncell:C41:b:::2::l:3:f:10\\ncell:D41:b:::2::l:3:f:10\\ncell:E41:b:::2::l:3:f:10\\ncell:F41:b:::2::l:3:f:10\\ncell:G41:b::2:2::l:3:f:10\\ncell:B42:b:1:::\\ncell:C42:b:1:::\\ncell:D42:b:1:::\\ncell:E42:b:1:::\\ncell:F42:b:1:::\\ncell:G42:b:1:::\\ncol:A:w:10\\ncol:B:w:10\\ncol:C:w:62\\ncol:D:w:73\\ncol:E:w:15\\ncol:F:w:68\\ncol:G:w:10\\nrow:1:h:14.25\\nrow:2:h:18.75\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:15.75\\nrow:6:h:15.75\\nrow:7:h:15.75\\nrow:8:h:15.75\\nrow:9:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:13:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:16:h:14.25\\nrow:17:h:14.25\\nrow:18:h:14.25\\nrow:19:h:14.25\\nrow:20:h:14.25\\nrow:21:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nrow:24:h:14.25\\nrow:25:h:14.25\\nrow:26:h:14.25\\nrow:27:h:14.25\\nrow:28:h:14.25\\nrow:29:h:14.25\\nrow:30:h:14.25\\nrow:31:h:14.25\\nrow:32:h:14.25\\nrow:33:h:14.25\\nrow:34:h:14.25\\nrow:35:h:15.75\\nrow:36:h:15.75\\nrow:37:h:14.25\\nrow:38:h:14.25\\nrow:39:h:14.25\\nrow:40:h:14.25\\nrow:41:h:14.25\\nsheet:c:7:r:42:h:12.75\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\nfont:1:* * Trebuchet MS\\nfont:2:* 9pt Trebuchet MS\\nfont:3:italic bold * Trebuchet MS\\nfont:4:italic bold 10pt Trebuchet MS\\nfont:5:normal bold * Trebuchet MS\\nfont:6:normal bold 10pt Arial\\nfont:7:normal bold 12pt Arial\\nfont:8:normal normal * *\\nfont:9:normal normal * Trebuchet MS\\nfont:10:normal normal 10pt Arial\\nfont:11:normal normal 11pt Trebuchet MS\\nfont:12:normal normal 12pt Arial\\nfont:13:normal normal 16pt Trebuchet MS\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nlayout:3:padding:* * * *;vertical-align:top;\\nlayout:4:padding:* * * 4px;vertical-align:*;\\nvalueformat:1:#,##0.00\\nvalueformat:2:d-mmm\\nvalueformat:3:m/d/yy\\nvalueformat:4:text-html\\n\"},\"name\":\"inv1\",\"hidden\":\"0\"},\"sheet2\":{\"sheetstr\":{\"savestr\":\"version:1.5\\ncell:B2:t:INVOICE:l:1:f:9:cf:1:colspan:6\\ncell:C2:t::l:2:f:13\\ncell:D2:t::l:2:f:13\\ncell:E2:l:1:f:10:c:2:cf:3\\ncell:F2:t:INVOICE:l:1:f:8:c:2:cf:2:colspan:2\\ncell:G2:t::l:2:f:13\\ncell:B3:f:6:cf:2:colspan:4\\ncell:C3:t::l:2:f:13\\ncell:D3:t::l:2:f:13\\ncell:F3:l:1:f:7:cf:2\\ncell:G3:l:1:f:14:cf:2:ntvf:3\\ncell:B4:f:2:colspan:2\\ncell:F4:t:DATE\\\\c:l:1:f:14:cf:2\\ncell:G4:vtf:nd:42081:TODAY():l:1:f:14:cf:2:ntvf:3\\ncell:B5:t:INVOICE #\\\\c:f:3:colspan:6\\ncell:C5:cf:2:colspan:5\\ncell:F5:l:1:f:7:cf:2:colspan:2\\ncell:G5:l:1:f:14:cf:2\\ncell:B6:f:2:colspan:2\\ncell:F6:l:1:f:7:cf:2:colspan:2\\ncell:G6:l:1:f:14:cf:2\\ncell:B7:t:FROM\\\\c:f:12\\ncell:F7:l:1:f:7:cf:2:tvf:4:colspan:2:rowspan:6\\ncell:G7:l:1:f:14:cf:2\\ncell:B8:t:[Company Name]:f:3:colspan:4\\ncell:F8:l:1:f:7:cf:2:colspan:2\\ncell:G8:l:1:f:14:cf:2\\ncell:B9:t:[Street Address]:f:1:cf:2:colspan:4\\ncell:F9:l:1:f:7\\ncell:G9:l:1:f:14:cf:1\\ncell:B10:t:[City, State,  Zip]:f:1:cf:2:colspan:4\\ncell:G10:l:1:f:13\\ncell:B11:t:Phone\\\\c :f:1:cf:2:colspan:4\\ncell:B12:t:Email\\\\c:f:1:cf:2:colspan:4\\ncell:B13:colspan:2\\ncell:B14:t:BILL TO\\\\c:f:11:cf:2\\ncell:B15:t:[Name]:f:1:cf:2:colspan:6\\ncell:B16:t:[Company Name]:f:1:cf:2:colspan:6\\ncell:F16:t:  \\ncell:B17:t:[Street Address]:f:1:cf:2:colspan:6\\ncell:B18:t:[City, State,  Zip]:f:1:cf:2:colspan:6\\ncell:B19:t:Phone\\\\c :f:1:cf:2:colspan:6\\ncell:B20:t:Email\\\\c:f:1:cf:2:colspan:6\\ncell:A22:b::1::\\ncell:B22:t:DESCRIPTION:b:1:1:1:1:l:1:f:14:c:1:bg:3:cf:1:colspan:5:rowspan:1\\ncell:C22:t::l:2:f:13\\ncell:D22:t::l:2:f:13\\ncell:E22:t::l:2:f:13\\ncell:F22:t::l:2:f:13\\ncell:G22:t:AMOUNT:b:1:1:1::l:1:f:14:c:1:bg:3:cf:1\\ncell:A23:b::1::\\ncell:B23:b:1:1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C23:t::l:2:f:4\\ncell:D23:t::l:2:f:4\\ncell:E23:t::l:2:f:4\\ncell:F23:t::b::2:::l:1:f:4\\ncell:G23:b::1::1:f:4:ntvf:1\\ncell:A24:b::1::\\ncell:B24:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C24:t::l:2:f:4\\ncell:D24:t::l:2:f:4\\ncell:E24:t::l:2:f:4\\ncell:F24:t::b::2:::l:1:f:4\\ncell:G24:b::1::1:f:4:ntvf:1\\ncell:A25:b::1::\\ncell:B25:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C25:t::l:2:f:4\\ncell:D25:t::l:2:f:4\\ncell:E25:t::l:2:f:4\\ncell:F25:t::b::2:::l:1:f:4\\ncell:G25:b::1::1:f:4:ntvf:1\\ncell:A26:b::1::\\ncell:B26:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C26:t::l:2:f:4\\ncell:D26:t::l:2:f:4\\ncell:E26:t::l:2:f:4\\ncell:F26:t::b::2:::l:1:f:4\\ncell:G26:b::1::1:f:4:ntvf:1\\ncell:A27:b::1::\\ncell:B27:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C27:t::l:2:f:4\\ncell:D27:t::l:2:f:4\\ncell:E27:t::l:2:f:4\\ncell:F27:t::b::2:::l:1:f:4\\ncell:G27:b::1::1:f:4:ntvf:1\\ncell:A28:b::1::\\ncell:B28:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C28:t::l:2:f:4\\ncell:D28:t::l:2:f:4\\ncell:E28:t::l:2:f:4\\ncell:F28:t::b::2:::l:1:f:4\\ncell:G28:b::1::1:f:4:ntvf:1\\ncell:A29:b::1::\\ncell:B29:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C29:t::l:2:f:4\\ncell:D29:t::l:2:f:4\\ncell:E29:t::l:2:f:4\\ncell:F29:t::b::2:::l:1:f:4\\ncell:G29:b::1::1:f:4:ntvf:1\\ncell:A30:b::1::\\ncell:B30:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C30:t::l:2:f:4\\ncell:D30:t::l:2:f:4\\ncell:E30:t::l:2:f:4\\ncell:F30:t::b::2:::l:1:f:4\\ncell:G30:b::1::1:f:4:ntvf:1\\ncell:A31:b::1::\\ncell:B31:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C31:t::l:2:f:4\\ncell:D31:t::l:2:f:4\\ncell:E31:t::l:2:f:4\\ncell:F31:t::b::2:::l:1:f:4\\ncell:G31:b::1::1:f:4:ntvf:1\\ncell:A32:b::1::\\ncell:B32:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C32:t::l:2:f:4\\ncell:D32:t::l:2:f:4\\ncell:E32:t::l:2:f:4\\ncell:F32:t::b::2:::l:1:f:4\\ncell:G32:b::1::1:f:4:ntvf:1\\ncell:A33:b::1::\\ncell:B33:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C33:t::l:2:f:4\\ncell:D33:t::l:2:f:4\\ncell:E33:t::l:2:f:4\\ncell:F33:t::b::2:::l:1:f:4\\ncell:G33:b::1::1:f:4:ntvf:1\\ncell:A34:b::1::\\ncell:B34:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C34:l:2:f:4\\ncell:D34:l:2:f:4\\ncell:E34:l:2:f:4\\ncell:F34:b::2:::l:1:f:4\\ncell:G34:b::1::1:f:4:ntvf:1\\ncell:A35:b::1::\\ncell:B35:b::1:1:1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C35:t::b:::2::l:1:f:4\\ncell:D35:t::b:::2::l:1:f:4\\ncell:E35:t::b:::2::l:1:f:4\\ncell:F35:t::b::2:2::l:1:f:4\\ncell:G35:b::1:1:1:f:4:ntvf:1\\ncell:B36:b:2::::l:1:f:13\\ncell:C36:b:2::::l:1:f:13\\ncell:D36:b:2::::l:1:f:13\\ncell:E36:b:2::::l:1:f:14\\ncell:F36:t:Subtotal:b:2::::l:1:f:11\\ncell:G36:vtf:n:0:SUM(G23\\\\cG35):b:1::::f:11:ntvf:1\\ncell:B37:t:NOTES:b:::1::l:1:f:14:cf:2:colspan:3:rowspan:1\\ncell:C37:t::b:::2::l:1:f:13\\ncell:D37:t::b:::2::l:1:f:13\\ncell:F37:t:Tax Rate:l:1:f:11\\ncell:G37:v:0:f:1:ntvf:2\\ncell:B38:b:1::::f:1:cf:2:colspan:3\\ncell:C38:t::b:2::::l:1:f:13\\ncell:D38:t::b:2::::l:1:f:13\\ncell:F38:t:Tax:l:1:f:11\\ncell:G38:vtf:n:0:G37*G36:f:1:ntvf:1\\ncell:B39:f:1:cf:2:colspan:3\\ncell:C39:t::l:2:f:13\\ncell:D39:t::l:2:f:13\\ncell:F39:t:Other:b:::1::l:1:f:11\\ncell:G39:v:0:b:::1::f:1:ntvf:1\\ncell:B40:b:::1::f:1:cf:2:colspan:3:rowspan:1\\ncell:C40:t::l:2:f:13\\ncell:D40:t::l:2:f:13\\ncell:F40:t:TOTAL:b:1::::l:1:f:14\\ncell:G40:vtf:n:0:(G36+G38)+G39:b:1::::f:11:ntvf:1\\ncell:B43:t:Thank you for your business:l:1:f:5:cf:1:colspan:6:rowspan:1\\ncell:C43:t::l:2:f:13\\ncell:D43:t::l:2:f:13\\ncell:E43:t::l:2:f:13\\ncell:F43:t::l:2:f:13\\ncell:G43:t::l:2:f:13\\ncol:A:w:10\\ncol:B:w:90\\ncol:C:w:19\\ncol:D:w:10\\ncol:E:w:16\\ncol:F:w:45\\ncol:G:w:64\\nrow:1:h:34.5\\nrow:2:h:34.5\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:14.25\\nrow:6:h:14.25\\nrow:7:h:14.25\\nrow:8:h:14.25\\nrow:9:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:16:h:14.25\\nrow:17:h:14.25\\nrow:18:h:14.25\\nrow:19:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nrow:24:h:14.25\\nrow:25:h:14.25\\nrow:26:h:14.25\\nrow:27:h:14.25\\nrow:28:h:14.25\\nrow:29:h:14.25\\nrow:30:h:14.25\\nrow:31:h:14.25\\nrow:32:h:14.25\\nrow:33:h:14.25\\nrow:34:h:14.25\\nrow:35:h:14.25\\nrow:36:h:14.25\\nrow:37:h:14.25\\nrow:38:h:14.25\\nrow:39:h:14.25\\nrow:40:h:14.25\\nrow:43:h:15.75\\nsheet:c:7:r:43:h:12.75:needsrecalc:yes\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\ncellformat:3:right\\ncolor:1:rgb(0, 0, 0)\\ncolor:2:rgb(0,0,0)\\ncolor:3:rgb(221, 221, 221)\\nfont:1:* * Trebuchet MS\\nfont:2:* 10pt *\\nfont:3:* 10pt Trebuchet MS\\nfont:4:* 9pt Trebuchet MS\\nfont:5:italic bold 10pt Trebuchet MS\\nfont:6:italic normal * Trebuchet MS\\nfont:7:normal bold 10pt Trebuchet MS\\nfont:8:normal bold 14pt Trebuchet MS\\nfont:9:normal bold 16pt Trebuchet MS\\nfont:10:normal bold 28pt Trebuchet MS\\nfont:11:normal normal * Trebuchet MS\\nfont:12:normal normal 10pt *\\nfont:13:normal normal 10pt Arial\\nfont:14:normal normal 10pt Trebuchet MS\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nvalueformat:1:#,##0.00\\nvalueformat:2:#,##0.00%\\nvalueformat:3:m/d/yy\\nvalueformat:4:text-html\\n\"},\"name\":\"inv2\",\"hidden\":\"0\"},\"sheet3\":{\"sheetstr\":{\"savestr\":\"version:1.5\\ncell:B2:t:INVOICE:l:1:f:12:cf:1:colspan:6\\ncell:C2:t::l:2:f:10\\ncell:D2:t::l:2:f:10\\ncell:E2:l:1:f:8:c:2:cf:3\\ncell:F2:t:INVOICE:l:1:f:7:c:2:cf:2:colspan:2\\ncell:G2:t::l:2:f:10\\ncell:B3:f:5:cf:2:colspan:4\\ncell:C3:t::l:2:f:10\\ncell:D3:t::l:2:f:10\\ncell:F3:l:1:f:6:cf:2\\ncell:G3:l:1:f:11:cf:2:ntvf:3\\ncell:B4:f:2:colspan:2\\ncell:F4:t:DATE\\\\c:l:1:f:11:cf:2\\ncell:G4:vtf:nd:42081:TODAY():l:1:f:11:cf:2:ntvf:3\\ncell:B5:t:INVOICE #\\\\c:f:9:colspan:6\\ncell:C5:cf:2:colspan:5\\ncell:F5:l:1:f:6:cf:2:colspan:2\\ncell:G5:l:1:f:11:cf:2\\ncell:B6:f:2:colspan:2\\ncell:F6:l:1:f:6:cf:2:colspan:2\\ncell:G6:l:1:f:11:cf:2\\ncell:B7:t:FROM\\\\c:f:11\\ncell:F7:l:1:f:6:cf:2:colspan:2\\ncell:G7:l:1:f:11:cf:2\\ncell:B8:t:[Company Name]:f:9:colspan:4\\ncell:F8:l:1:f:6:cf:2:tvf:4:colspan:2:rowspan:5\\ncell:G8:l:1:f:11:cf:2\\ncell:B9:t:[Street Address]:f:9:cf:2:colspan:4\\ncell:F9:l:1:f:6\\ncell:G9:l:1:f:11:cf:1\\ncell:B10:t:[City, State,  Zip]:f:9:cf:2:colspan:4\\ncell:G10:l:1:f:10\\ncell:B11:t:Phone\\\\c :f:9:cf:2:colspan:4\\ncell:B12:t:Email\\\\c:f:9:cf:2:colspan:4\\ncell:B13:colspan:2\\ncell:B14:t:BILL TO\\\\c:f:9:cf:2\\ncell:B15:t:[Name]:f:9:cf:2:colspan:6\\ncell:B16:t:[Company Name]:f:9:cf:2:colspan:6\\ncell:F16:t:  \\ncell:B17:t:[Street Address]:f:9:cf:2:colspan:6\\ncell:B18:t:[City, State,  Zip]:f:9:cf:2:colspan:6\\ncell:B19:t:Phone\\\\c :f:9:cf:2:colspan:6\\ncell:B20:t:Email\\\\c:f:9:cf:2:colspan:6\\ncell:A22:b::1::\\ncell:B22:t:DESCRIPTION:b:1:1:1:1:l:1:f:11:c:1:bg:3:cf:1:colspan:5:rowspan:1\\ncell:C22:t::l:2:f:10\\ncell:D22:t::l:2:f:10\\ncell:E22:t::l:2:f:10\\ncell:F22:t::l:2:f:10\\ncell:G22:t:AMOUNT:b:1:1:1::l:1:f:11:c:1:bg:3:cf:1\\ncell:A23:b::1::\\ncell:B23:vtf:t: :IF(AND(ISBLANK(inv3!B6),ISBLANK(sheet7!B6)), \\\" \\\", IF(ISBLANK(inv3!B6), sheet7!B6, inv3!B6)):b:1:1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C23:t::l:2:f:3\\ncell:D23:t::l:2:f:3\\ncell:E23:t::l:2:f:3\\ncell:F23:t::b::2:::l:1:f:3\\ncell:G23:vtf:t: :IF(AND(ISBLANK(inv3!B6),ISBLANK(sheet7!B6)), \\\" \\\", IF(ISBLANK(inv3!B6), (sheet7!E6*sheet7!F6), (inv3!E6*inv3!F6))):b::1::1:f:3:ntvf:1\\ncell:A24:b::1::\\ncell:B24:vtf:t: :IF(AND(ISBLANK(INV3!B7),ISBLANK(SHEET7!B7)), \\\" \\\", IF(ISBLANK(INV3!B7), SHEET7!B7, INV3!B7)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C24:t::l:2:f:3\\ncell:D24:t::l:2:f:3\\ncell:E24:t::l:2:f:3\\ncell:F24:t::b::2:::l:1:f:3\\ncell:G24:vtf:t: :IF(AND(ISBLANK(INV3!B7),ISBLANK(SHEET7!B7)), \\\" \\\", IF(ISBLANK(INV3!B7), (SHEET7!E7*SHEET7!F7), (INV3!E7*INV3!F7))):b::1::1:f:3:ntvf:1\\ncell:A25:b::1::\\ncell:B25:vtf:t: :IF(AND(ISBLANK(INV3!B8),ISBLANK(SHEET7!B8)), \\\" \\\", IF(ISBLANK(INV3!B8), SHEET7!B8, INV3!B8)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C25:t::l:2:f:3\\ncell:D25:t::l:2:f:3\\ncell:E25:t::l:2:f:3\\ncell:F25:t::b::2:::l:1:f:3\\ncell:G25:vtf:t: :IF(AND(ISBLANK(INV3!B8),ISBLANK(SHEET7!B8)), \\\" \\\", IF(ISBLANK(INV3!B8), (SHEET7!E8*SHEET7!F8), (INV3!E8*INV3!F8))):b::1::1:f:3:ntvf:1\\ncell:A26:b::1::\\ncell:B26:vtf:t: :IF(AND(ISBLANK(INV3!B9),ISBLANK(SHEET7!B9)), \\\" \\\", IF(ISBLANK(INV3!B9), SHEET7!B9, INV3!B9)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C26:t::l:2:f:3\\ncell:D26:t::l:2:f:3\\ncell:E26:t::l:2:f:3\\ncell:F26:t::b::2:::l:1:f:3\\ncell:G26:vtf:t: :IF(AND(ISBLANK(INV3!B9),ISBLANK(SHEET7!B9)), \\\" \\\", IF(ISBLANK(INV3!B9), (SHEET7!E9*SHEET7!F9), (INV3!E9*INV3!F9))):b::1::1:f:3:ntvf:1\\ncell:A27:b::1::\\ncell:B27:vtf:t: :IF(AND(ISBLANK(INV3!B10),ISBLANK(SHEET7!B10)), \\\" \\\", IF(ISBLANK(INV3!B10), SHEET7!B10, INV3!B10)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C27:t::l:2:f:3\\ncell:D27:t::l:2:f:3\\ncell:E27:t::l:2:f:3\\ncell:F27:t::b::2:::l:1:f:3\\ncell:G27:vtf:t: :IF(AND(ISBLANK(INV3!B10),ISBLANK(SHEET7!B10)), \\\" \\\", IF(ISBLANK(INV3!B10), (SHEET7!E10*SHEET7!F10), (INV3!E10*INV3!F10))):b::1::1:f:3:ntvf:1\\ncell:A28:b::1::\\ncell:B28:vtf:t: :IF(AND(ISBLANK(INV3!B11),ISBLANK(SHEET7!B11)), \\\" \\\", IF(ISBLANK(INV3!B11), SHEET7!B11, INV3!B11)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C28:t::l:2:f:3\\ncell:D28:t::l:2:f:3\\ncell:E28:t::l:2:f:3\\ncell:F28:t::b::2:::l:1:f:3\\ncell:G28:vtf:t: :IF(AND(ISBLANK(INV3!B11),ISBLANK(SHEET7!B11)), \\\" \\\", IF(ISBLANK(INV3!B11), (SHEET7!E11*SHEET7!F11), (INV3!E11*INV3!F11))):b::1::1:f:3:ntvf:1\\ncell:A29:b::1::\\ncell:B29:vtf:t: :IF(AND(ISBLANK(INV3!B12),ISBLANK(SHEET7!B12)), \\\" \\\", IF(ISBLANK(INV3!B12), SHEET7!B12, INV3!B12)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C29:t::l:2:f:3\\ncell:D29:t::l:2:f:3\\ncell:E29:t::l:2:f:3\\ncell:F29:t::b::2:::l:1:f:3\\ncell:G29:vtf:t: :IF(AND(ISBLANK(INV3!B12),ISBLANK(SHEET7!B12)), \\\" \\\", IF(ISBLANK(INV3!B12), (SHEET7!E12*SHEET7!F12), (INV3!E12*INV3!F12))):b::1::1:f:3:ntvf:1\\ncell:A30:b::1::\\ncell:B30:vtf:t: :IF(AND(ISBLANK(INV3!B13),ISBLANK(SHEET7!B13)), \\\" \\\", IF(ISBLANK(INV3!B13), SHEET7!B13, INV3!B13)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C30:t::l:2:f:3\\ncell:D30:t::l:2:f:3\\ncell:E30:t::l:2:f:3\\ncell:F30:t::b::2:::l:1:f:3\\ncell:G30:vtf:t: :IF(AND(ISBLANK(INV3!B13),ISBLANK(SHEET7!B13)), \\\" \\\", IF(ISBLANK(INV3!B13), (SHEET7!E13*SHEET7!F13), (INV3!E13*INV3!F13))):b::1::1:f:3:ntvf:1\\ncell:A31:b::1::\\ncell:B31:vtf:t: :IF(AND(ISBLANK(INV3!B14),ISBLANK(SHEET7!B14)), \\\" \\\", IF(ISBLANK(INV3!B14), SHEET7!B14, INV3!B14)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C31:t::l:2:f:3\\ncell:D31:t::l:2:f:3\\ncell:E31:t::l:2:f:3\\ncell:F31:t::b::2:::l:1:f:3\\ncell:G31:vtf:t: :IF(AND(ISBLANK(INV3!B14),ISBLANK(SHEET7!B14)), \\\" \\\", IF(ISBLANK(INV3!B14), (SHEET7!E14*SHEET7!F14), (INV3!E14*INV3!F14))):b::1::1:f:3:ntvf:1\\ncell:A32:b::1::\\ncell:B32:vtf:t: :IF(AND(ISBLANK(INV3!B15),ISBLANK(SHEET7!B15)), \\\" \\\", IF(ISBLANK(INV3!B15), SHEET7!B15, INV3!B15)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C32:t::l:2:f:3\\ncell:D32:t::l:2:f:3\\ncell:E32:t::l:2:f:3\\ncell:F32:t::b::2:::l:1:f:3\\ncell:G32:vtf:t: :IF(AND(ISBLANK(INV3!B15),ISBLANK(SHEET7!B15)), \\\" \\\", IF(ISBLANK(INV3!B15), (SHEET7!E15*SHEET7!F15), (INV3!E15*INV3!F15))):b::1::1:f:3:ntvf:1\\ncell:A33:b::1::\\ncell:B33:vtf:t: :IF(AND(ISBLANK(INV3!B16),ISBLANK(SHEET7!B16)), \\\" \\\", IF(ISBLANK(INV3!B16), SHEET7!B16, INV3!B16)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C33:l:2:f:3\\ncell:D33:l:2:f:3\\ncell:E33:l:2:f:3\\ncell:F33:b::2:::l:1:f:3\\ncell:G33:vtf:t: :IF(AND(ISBLANK(INV3!B16),ISBLANK(SHEET7!B16)), \\\" \\\", IF(ISBLANK(INV3!B16), (SHEET7!E16*SHEET7!F16), (INV3!E16*INV3!F16))):b::1::1:f:3:ntvf:1\\ncell:A34:b::1::\\ncell:B34:vtf:t: :IF(AND(ISBLANK(INV3!B17),ISBLANK(SHEET7!B17)), \\\" \\\", IF(ISBLANK(INV3!B17), SHEET7!B17, INV3!B17)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C34:t::l:2:f:3\\ncell:D34:t::l:2:f:3\\ncell:E34:t::l:2:f:3\\ncell:F34:t::b::2:::l:1:f:3\\ncell:G34:vtf:t: :IF(AND(ISBLANK(INV3!B17),ISBLANK(SHEET7!B17)), \\\" \\\", IF(ISBLANK(INV3!B17), (SHEET7!E17*SHEET7!F17), (INV3!E17*INV3!F17))):b::1::1:f:3:ntvf:1\\ncell:A35:b::1::\\ncell:B35:vtf:t: :IF(AND(ISBLANK(INV3!B18),ISBLANK(SHEET7!B18)), \\\" \\\", IF(ISBLANK(INV3!B18), SHEET7!B18, INV3!B18)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C35:t::b:::2::l:1:f:3\\ncell:D35:t::b:::2::l:1:f:3\\ncell:E35:t::b:::2::l:1:f:3\\ncell:F35:t::b::2:2::l:1:f:3\\ncell:G35:vtf:t: :IF(AND(ISBLANK(INV3!B18),ISBLANK(SHEET7!B18)), \\\" \\\", IF(ISBLANK(INV3!B18), (SHEET7!E18*SHEET7!F18), (INV3!E18*INV3!F18))):b::1::1:f:3:ntvf:1\\ncell:B36:b:2::::l:1:f:10\\ncell:C36:b:2::::l:1:f:10\\ncell:D36:b:2::::l:1:f:10\\ncell:E36:b:2::::l:1:f:11\\ncell:F36:t:Subtotal:b:2::::l:1:f:9\\ncell:G36:vtf:n:0:SUM(G23\\\\cG35):b:1::::f:9:ntvf:1\\ncell:B37:t:NOTES:b:::1::l:1:f:11:cf:2:colspan:3:rowspan:1\\ncell:C37:t::b:::2::l:1:f:10\\ncell:D37:t::b:::2::l:1:f:10\\ncell:F37:t:Tax Rate:l:1:f:9\\ncell:G37:v:0:f:1:ntvf:2\\ncell:B38:b:1::::f:1:cf:2:colspan:3\\ncell:C38:t::b:2::::l:1:f:10\\ncell:D38:t::b:2::::l:1:f:10\\ncell:F38:t:Tax:l:1:f:9\\ncell:G38:vtf:n:0:G37*G36:f:1:ntvf:1\\ncell:B39:f:1:cf:2:colspan:3\\ncell:C39:t::l:2:f:10\\ncell:D39:t::l:2:f:10\\ncell:F39:t:Other:b:::1::l:1:f:9\\ncell:G39:v:0:b:::1::f:1:ntvf:1\\ncell:B40:b:::1::f:1:cf:2:colspan:3:rowspan:1\\ncell:C40:t::l:2:f:10\\ncell:D40:t::l:2:f:10\\ncell:F40:t:TOTAL:b:1::::l:1:f:11\\ncell:G40:vtf:n:0:(G36+G38)+G39:b:1::::f:9:ntvf:1\\ncell:B43:t:Thank you for your business:l:1:f:4:cf:1:colspan:6:rowspan:1\\ncell:C43:t::l:2:f:10\\ncell:D43:t::l:2:f:10\\ncell:E43:t::l:2:f:10\\ncell:F43:t::l:2:f:10\\ncell:G43:t::l:2:f:10\\ncol:A:w:10\\ncol:B:w:65\\ncol:C:w:19\\ncol:D:w:10\\ncol:E:w:16\\ncol:F:w:53\\ncol:G:w:64\\nrow:1:h:34.5\\nrow:2:h:34.5\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:14.25\\nrow:6:h:14.25\\nrow:7:h:14.25\\nrow:8:h:14.25\\nrow:9:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:16:h:14.25\\nrow:17:h:14.25\\nrow:18:h:14.25\\nrow:19:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nrow:24:h:14.25\\nrow:25:h:14.25\\nrow:26:h:14.25\\nrow:27:h:14.25\\nrow:28:h:14.25\\nrow:29:h:14.25\\nrow:30:h:14.25\\nrow:31:h:14.25\\nrow:32:h:14.25\\nrow:33:h:14.25\\nrow:34:h:14.25\\nrow:35:h:14.25\\nrow:36:h:14.25\\nrow:37:h:14.25\\nrow:38:h:14.25\\nrow:39:h:14.25\\nrow:40:h:14.25\\nrow:43:h:15.75\\nsheet:c:7:r:43:h:12.75:needsrecalc:yes\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\ncellformat:3:right\\ncolor:1:rgb(0, 0, 0)\\ncolor:2:rgb(0,0,0)\\ncolor:3:rgb(221, 221, 221)\\nfont:1:* * Trebuchet MS\\nfont:2:* 10pt *\\nfont:3:* 9pt Trebuchet MS\\nfont:4:italic bold 10pt Trebuchet MS\\nfont:5:italic normal * Trebuchet MS\\nfont:6:normal bold 10pt Trebuchet MS\\nfont:7:normal bold 14pt Trebuchet MS\\nfont:8:normal bold 28pt Trebuchet MS\\nfont:9:normal normal * Trebuchet MS\\nfont:10:normal normal 10pt Arial\\nfont:11:normal normal 10pt Trebuchet MS\\nfont:12:normal normal 16pt Trebuchet MS\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nvalueformat:1:#,##0.00\\nvalueformat:2:#,##0.00%\\nvalueformat:3:m/d/yy\\nvalueformat:4:text-html\\n\"},\"name\":\"sheet6\",\"hidden\":\"0\"},\"sheet4\":{\"sheetstr\":{\"savestr\":\"version:1.5\\ncell:B1:b:::2::l:1:f:7\\ncell:C1:b:::2::l:1:f:7\\ncell:D1:b:::2::l:1:f:7\\ncell:E1:b:::2::l:1:f:7\\ncell:F1:b:::2::l:1:f:7\\ncell:A2:b::2:::l:1:f:7\\ncell:B2:t:INVOICE DETAILS:b:1:1:1:1:l:1:f:8:cf:1:colspan:5\\ncell:C2:t::b:2::2::l:1:f:7\\ncell:D2:t::b:2::2::l:1:f:7\\ncell:E2:t::b:2::2::l:1:f:7\\ncell:F2:b:2:1:1::l:1:f:7\\ncell:G2:b::::1\\ncell:A3:b::2:::l:3:f:7\\ncell:B3:b:2::::l:1:f:7\\ncell:C3:b:2::::l:1:f:7\\ncell:D3:b:2::::l:1:f:7\\ncell:E3:b:2::::l:1:f:7\\ncell:F3:b:1:1:::l:1:f:7\\ncell:G3:b::::1\\ncell:A4:b::2:::l:3:f:7\\ncell:B4:b:::2::l:1:f:7\\ncell:C4:b:::2::l:3:f:4:cf:2\\ncell:D4:b:::2::l:1:f:7\\ncell:E4:b:::2::l:1:f:7\\ncell:F4:b::1:1::l:1:f:7\\ncell:G4:b::::1\\ncell:A5:b::2:::l:3:f:7\\ncell:B5:t:Description:b:1:1:1:1:f:6:cf:1:colspan:3\\ncell:C5:t:Description:b:2::2:2:l:3:f:4:cf:2:colspan:2:rowspan:1\\ncell:D5:t::b:2:2:2::l:1:f:7\\ncell:E5:t:Hours:b:1:1:1:1:f:6:cf:1\\ncell:F5:t:Rate:b:1:1:1:1:f:6:cf:1\\ncell:G5:b::::1\\ncell:A6:b::2:::l:3:f:7\\ncell:B6:b:1:1::1:f:1:cf:2:colspan:3\\ncell:C6:b:1:1::1:l:3:f:7:cf:2:colspan:2:rowspan:1\\ncell:D6:t::b:2:2:2::l:1:f:7\\ncell:E6:b:1:1:::f:1:ntvf:1\\ncell:F6:b:1:1:::f:1:ntvf:1\\ncell:G6:b::::1\\ncell:A7:b::2:::l:3:f:7\\ncell:B7:b::1::1:f:1:cf:2:colspan:3\\ncell:C7:b::1::1:l:1:f:7:colspan:2\\ncell:D7:l:1:f:7\\ncell:E7:b::1:::f:1:ntvf:1\\ncell:F7:b::1:::f:1:ntvf:1\\ncell:G7:b::::1\\ncell:A8:b::2:::l:3:f:7\\ncell:B8:b::1::1:f:1:cf:2:colspan:3\\ncell:C8:b::1::1:colspan:2\\ncell:E8:b::1:::f:1:ntvf:1\\ncell:F8:b::1:::f:1:ntvf:1\\ncell:G8:b::::1\\ncell:A9:b::2:::l:3:f:7\\ncell:B9:b::1::1:f:1:cf:2:colspan:3\\ncell:C9:b::1::1:colspan:2\\ncell:E9:b::1:::f:1:ntvf:1\\ncell:F9:b::1:::f:1:ntvf:1\\ncell:G9:b::::1\\ncell:A10:b::2:::l:3:f:7\\ncell:B10:b::1::1:f:1:cf:2:colspan:3\\ncell:C10:b::1::1:colspan:2\\ncell:E10:b::1:::f:1:ntvf:1\\ncell:F10:b::1:::f:1:ntvf:1\\ncell:G10:b::::1\\ncell:A11:b::2:::l:3:f:7\\ncell:B11:b::1::1:f:1:cf:2:colspan:3\\ncell:C11:b::1::1:colspan:2\\ncell:E11:b::1:::f:1:ntvf:1\\ncell:F11:b::1:::f:1:ntvf:1\\ncell:G11:b::::1\\ncell:A12:b::2:::l:3:f:7\\ncell:B12:b::1::1:f:1:cf:2:colspan:3\\ncell:C12:b::1::1:colspan:2\\ncell:E12:b::1:::f:1:ntvf:1\\ncell:F12:b::1:::f:1:ntvf:1\\ncell:G12:b::::1\\ncell:A13:b::2:::l:3:f:7\\ncell:B13:b::1::1:f:1:cf:2:colspan:3\\ncell:C13:b::1::1:colspan:2\\ncell:E13:b::1:::f:1:ntvf:1\\ncell:F13:b::1:::f:1:ntvf:1\\ncell:G13:b::::1\\ncell:A14:b::2:::l:3:f:7\\ncell:B14:b::1::1:f:1:cf:2:colspan:3\\ncell:C14:b::1::1:colspan:2\\ncell:E14:b::1:::f:1:ntvf:1\\ncell:F14:b::1:::f:1:ntvf:1\\ncell:G14:b::::1\\ncell:A15:b::2:::l:3:f:7\\ncell:B15:b::1::1:f:1:cf:2:colspan:3\\ncell:C15:b::1::1:colspan:2\\ncell:E15:b::1:::f:1:ntvf:1\\ncell:F15:b::1:::f:1:ntvf:1\\ncell:G15:b::::1\\ncell:A16:b::2:::l:3:f:7\\ncell:B16:b::1::1:f:1:cf:2:colspan:3\\ncell:C16:b::1::1:colspan:2\\ncell:E16:b::1:::f:1:ntvf:1\\ncell:F16:b::1:::f:1:ntvf:1\\ncell:G16:b::::1\\ncell:A17:b::2:::l:3:f:7\\ncell:B17:b::1::1:f:1:cf:2:colspan:3\\ncell:C17:b::1::1:colspan:2\\ncell:E17:b::1:::f:1:ntvf:1\\ncell:F17:b::1:::f:1:ntvf:1\\ncell:G17:b::::1\\ncell:A18:b::2:::l:3:f:5\\ncell:B18:b::1:1:1:f:1:cf:2:colspan:3\\ncell:C18:b::1:1:1:l:3:f:7:cf:2:colspan:2\\ncell:D18:b:::2::l:3:f:7:cf:2\\ncell:E18:b::1:1::f:1:ntvf:1\\ncell:F18:b::1:1::f:1:ntvf:1\\ncell:G18:b::::1\\ncell:A19:b::2:::l:3:f:7\\ncell:F19:b::1::\\ncell:G19:b::::1\\ncell:A20:b::2:::l:3:f:7\\ncell:F20:b::1::\\ncell:G20:b::::1\\ncell:A21:b::2:::l:3:f:7\\ncell:C21:t:Thank you for your business:b::1:::f:3:colspan:4\\ncell:D21:t:Thank you for your business:f:2:colspan:4\\ncell:E21:t::l:2:f:7\\ncell:F21:l:2:f:7\\ncell:G21:b::::1\\ncell:A22:b::2:::l:3:f:7\\ncell:F22:b::1::\\ncell:G22:b::::1\\ncell:A23:b::2:::l:3:f:7\\ncell:B23:b:::2::l:3:f:7\\ncell:C23:b:::2::l:3:f:7\\ncell:D23:b:::2::l:3:f:7\\ncell:E23:b:::2::l:3:f:7\\ncell:F23:b::1:1::l:3:f:7\\ncell:G23:b::::1\\ncell:B24:b:1:::\\ncell:C24:b:1:::\\ncell:D24:b:1:::\\ncell:E24:b:1:::\\ncell:F24:b:1:::\\ncol:A:w:10\\ncol:B:w:42\\ncol:C:w:56\\ncol:D:w:39\\ncol:E:w:48\\ncol:F:w:57\\nrow:1:h:14.25\\nrow:2:h:18.75\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:14.25\\nrow:6:h:14.25\\nrow:7:h:14.25\\nrow:8:h:14.25\\nrow:9:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:13:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:16:h:14.25\\nrow:17:h:14.25\\nrow:18:h:15.75\\nrow:19:h:14.25\\nrow:20:h:14.25\\nrow:21:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nsheet:c:7:r:24:h:12.75:needsrecalc:yes\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\nfont:1:* * Trebuchet MS\\nfont:2:italic bold * Trebuchet MS\\nfont:3:italic bold 10pt Trebuchet MS\\nfont:4:normal bold 10pt Arial\\nfont:5:normal bold 12pt Arial\\nfont:6:normal normal * Trebuchet MS\\nfont:7:normal normal 10pt Arial\\nfont:8:normal normal 16pt Arial\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nlayout:3:padding:* * * *;vertical-align:top;\\nvalueformat:1:#,##0.00\\n\"},\"name\":\"inv3\",\"hidden\":\"0\"},\"sheet5\":{\"sheetstr\":{\"savestr\":\"version:1.5\\ncell:B1:b:::2::l:1:f:7\\ncell:C1:b:::2::l:1:f:7\\ncell:D1:b:::2::l:1:f:7\\ncell:E1:b:::2::l:1:f:7\\ncell:F1:b:::2::l:1:f:7\\ncell:A2:b::2:::l:1:f:7\\ncell:B2:t:INVOICE DETAILS:b:1:1:1:1:l:1:f:8:cf:1:colspan:5\\ncell:C2:t::b:2::2::l:1:f:7\\ncell:D2:t::b:2::2::l:1:f:7\\ncell:E2:t::b:2::2::l:1:f:7\\ncell:F2:b:2:1:1::l:1:f:7\\ncell:G2:b::::1\\ncell:A3:b::2:::l:3:f:7\\ncell:B3:b:2::::l:1:f:7\\ncell:C3:b:2::::l:1:f:7\\ncell:D3:b:2::::l:1:f:7\\ncell:E3:b:2::::l:1:f:7\\ncell:F3:b:1:1:::l:1:f:7\\ncell:G3:b::::1\\ncell:A4:b::2:::l:3:f:7\\ncell:B4:b:::2::l:1:f:7\\ncell:C4:b:::2::l:3:f:4:cf:2\\ncell:D4:b:::2::l:1:f:7\\ncell:E4:b:::2::l:1:f:7\\ncell:F4:b::1:1::l:1:f:7\\ncell:G4:b::::1\\ncell:A5:b::2:::l:3:f:7\\ncell:B5:t:Description:b:1:1:1:1:f:6:cf:1:colspan:3\\ncell:C5:t:Description:b:2::2:2:l:3:f:4:cf:2:colspan:2:rowspan:1\\ncell:D5:t::b:2:2:2::l:1:f:7\\ncell:E5:t:Qty.:b:1:1:1:1:f:6:cf:1\\ncell:F5:t:Price:b:1:1:1:1:f:6:cf:1\\ncell:G5:b::::1\\ncell:A6:b::2:::l:3:f:7\\ncell:B6:b:1:1::1:f:1:cf:2:colspan:3\\ncell:C6:b:1:1::1:l:3:f:7:cf:2:colspan:2:rowspan:1\\ncell:D6:t::b:2:2:2::l:1:f:7\\ncell:E6:b:1:1:::f:1:ntvf:1\\ncell:F6:b:1:1:::f:1:ntvf:1\\ncell:G6:b::::1\\ncell:A7:b::2:::l:3:f:7\\ncell:B7:b::1::1:f:1:cf:2:colspan:3\\ncell:C7:b::1::1:l:1:f:7:colspan:2\\ncell:D7:l:1:f:7\\ncell:E7:b::1:::f:1:ntvf:1\\ncell:F7:b::1:::f:1:ntvf:1\\ncell:G7:b::::1\\ncell:A8:b::2:::l:3:f:7\\ncell:B8:b::1::1:f:1:cf:2:colspan:3\\ncell:C8:b::1::1:colspan:2\\ncell:E8:b::1:::f:1:ntvf:1\\ncell:F8:b::1:::f:1:ntvf:1\\ncell:G8:b::::1\\ncell:A9:b::2:::l:3:f:7\\ncell:B9:b::1::1:f:1:cf:2:colspan:3\\ncell:C9:b::1::1:colspan:2\\ncell:E9:b::1:::f:1:ntvf:1\\ncell:F9:b::1:::f:1:ntvf:1\\ncell:G9:b::::1\\ncell:A10:b::2:::l:3:f:7\\ncell:B10:b::1::1:f:1:cf:2:colspan:3\\ncell:C10:b::1::1:colspan:2\\ncell:E10:b::1:::f:1:ntvf:1\\ncell:F10:b::1:::f:1:ntvf:1\\ncell:G10:b::::1\\ncell:A11:b::2:::l:3:f:7\\ncell:B11:b::1::1:f:1:cf:2:colspan:3\\ncell:C11:b::1::1:colspan:2\\ncell:E11:b::1:::f:1:ntvf:1\\ncell:F11:b::1:::f:1:ntvf:1\\ncell:G11:b::::1\\ncell:A12:b::2:::l:3:f:7\\ncell:B12:b::1::1:f:1:cf:2:colspan:3\\ncell:C12:b::1::1:colspan:2\\ncell:E12:b::1:::f:1:ntvf:1\\ncell:F12:b::1:::f:1:ntvf:1\\ncell:G12:b::::1\\ncell:A13:b::2:::l:3:f:7\\ncell:B13:b::1::1:f:1:cf:2:colspan:3\\ncell:C13:b::1::1:colspan:2\\ncell:E13:b::1:::f:1:ntvf:1\\ncell:F13:b::1:::f:1:ntvf:1\\ncell:G13:b::::1\\ncell:A14:b::2:::l:3:f:7\\ncell:B14:b::1::1:f:1:cf:2:colspan:3\\ncell:C14:b::1::1:colspan:2\\ncell:E14:b::1:::f:1:ntvf:1\\ncell:F14:b::1:::f:1:ntvf:1\\ncell:G14:b::::1\\ncell:A15:b::2:::l:3:f:7\\ncell:B15:b::1::1:f:1:cf:2:colspan:3\\ncell:C15:b::1::1:colspan:2\\ncell:E15:b::1:::f:1:ntvf:1\\ncell:F15:b::1:::f:1:ntvf:1\\ncell:G15:b::::1\\ncell:A16:b::2:::l:3:f:7\\ncell:B16:b::1::1:f:1:cf:2:colspan:3\\ncell:C16:b::1::1:colspan:2\\ncell:E16:b::1:::f:1:ntvf:1\\ncell:F16:b::1:::f:1:ntvf:1\\ncell:G16:b::::1\\ncell:A17:b::2:::l:3:f:7\\ncell:B17:b::1::1:f:1:cf:2:colspan:3\\ncell:C17:b::1::1:colspan:2\\ncell:E17:b::1:::f:1:ntvf:1\\ncell:F17:b::1:::f:1:ntvf:1\\ncell:G17:b::::1\\ncell:A18:b::2:::l:3:f:5\\ncell:B18:b::1:1:1:f:1:cf:2:colspan:3\\ncell:C18:b::1:1:1:l:3:f:7:cf:2:colspan:2\\ncell:D18:b:::2::l:3:f:7:cf:2\\ncell:E18:b::1:1::f:1:ntvf:1\\ncell:F18:b::1:1::f:1:ntvf:1\\ncell:G18:b::::1\\ncell:A19:b::2:::l:3:f:7\\ncell:F19:b::1::\\ncell:G19:b::::1\\ncell:A20:b::2:::l:3:f:7\\ncell:F20:b::1::\\ncell:G20:b::::1\\ncell:A21:b::2:::l:3:f:7\\ncell:C21:t:Thank you for your business:b::1:::f:3:colspan:4\\ncell:D21:t:Thank you for your business:f:2:colspan:4\\ncell:E21:t::l:2:f:7\\ncell:F21:l:2:f:7\\ncell:G21:b::::1\\ncell:A22:b::2:::l:3:f:7\\ncell:F22:b::1::\\ncell:G22:b::::1\\ncell:A23:b::2:::l:3:f:7\\ncell:B23:b:::2::l:3:f:7\\ncell:C23:b:::2::l:3:f:7\\ncell:D23:b:::2::l:3:f:7\\ncell:E23:b:::2::l:3:f:7\\ncell:F23:b::1:1::l:3:f:7\\ncell:G23:b::::1\\ncell:B24:b:1:::\\ncell:C24:b:1:::\\ncell:D24:b:1:::\\ncell:E24:b:1:::\\ncell:F24:b:1:::\\ncol:A:w:10\\ncol:B:w:42\\ncol:C:w:56\\ncol:D:w:39\\ncol:E:w:48\\ncol:F:w:57\\nrow:1:h:14.25\\nrow:2:h:18.75\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:14.25\\nrow:6:h:14.25\\nrow:7:h:14.25\\nrow:8:h:14.25\\nrow:9:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:13:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:16:h:14.25\\nrow:17:h:14.25\\nrow:18:h:15.75\\nrow:19:h:14.25\\nrow:20:h:14.25\\nrow:21:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nsheet:c:7:r:24:h:12.75:needsrecalc:yes\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\nfont:1:* * Trebuchet MS\\nfont:2:italic bold * Trebuchet MS\\nfont:3:italic bold 10pt Trebuchet MS\\nfont:4:normal bold 10pt Arial\\nfont:5:normal bold 12pt Arial\\nfont:6:normal normal * Trebuchet MS\\nfont:7:normal normal 10pt Arial\\nfont:8:normal normal 16pt Arial\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nlayout:3:padding:* * * *;vertical-align:top;\\nvalueformat:1:#,##0.00\\n\"},\"name\":\"sheet7\",\"hidden\":\"0\"}},\"EditableCells\":{\"allow\":true,\"cells\":{\"inv1!B2\":true,\"inv1!C5\":true,\"inv1!C6\":true,\"inv1!C7\":true,\"inv1!C8\":true,\"inv1!C9\":true,\"inv1!C11\":true,\"inv1!C12\":true,\"inv1!C13\":true,\"inv1!C14\":true,\"inv1!C15\":true,\"inv1!C16\":true,\"inv1!C18\":true,\"inv1!C20\":true,\"inv1!D20\":true,\"inv1!C23\":true,\"inv1!C24\":true,\"inv1!C25\":true,\"inv1!C26\":true,\"inv1!C27\":true,\"inv1!C28\":true,\"inv1!C29\":true,\"inv1!C30\":true,\"inv1!C31\":true,\"inv1!C32\":true,\"inv1!C33\":true,\"inv1!C34\":true,\"inv1!C35\":true,\"inv1!F23\":true,\"inv1!F24\":true,\"inv1!F25\":true,\"inv1!F26\":true,\"inv1!F27\":true,\"inv1!F28\":true,\"inv1!F29\":true,\"inv1!F30\":true,\"inv1!F31\":true,\"inv1!F32\":true,\"inv1!F33\":true,\"inv1!F34\":true,\"inv1!F35\":true,\"inv2!B2\":true,\"inv2!F4\":true,\"inv2!G4\":true,\"inv2!B5\":true,\"inv2!B7\":true,\"inv2!B8\":true,\"inv2!B9\":true,\"inv2!B10\":true,\"inv2!B11\":true,\"inv2!B12\":true,\"inv2!B14\":true,\"inv2!B15\":true,\"inv2!B16\":true,\"inv2!B17\":true,\"inv2!B18\":true,\"inv2!B19\":true,\"inv2!B20\":true,\"inv2!B23\":true,\"inv2!B24\":true,\"inv2!B25\":true,\"inv2!B26\":true,\"inv2!B27\":true,\"inv2!B28\":true,\"inv2!B29\":true,\"inv2!B30\":true,\"inv2!B31\":true,\"inv2!B32\":true,\"inv2!B33\":true,\"inv2!B34\":true,\"inv2!B35\":true,\"inv2!G23\":true,\"inv2!G24\":true,\"inv2!G25\":true,\"inv2!G26\":true,\"inv2!G27\":true,\"inv2!G28\":true,\"inv2!G29\":true,\"inv2!G30\":true,\"inv2!G31\":true,\"inv2!G32\":true,\"inv2!G33\":true,\"inv2!G34\":true,\"inv2!G35\":true,\"inv2!B38\":true,\"inv2!B39\":true,\"inv2!B40\":true,\"inv2!F36\":true,\"inv2!G37\":true,\"inv2!F37\":true,\"inv2!F39\":true,\"inv2!G39\":true,\"inv2!F38\":true,\"sheet6!B2\":true,\"sheet6!F4\":true,\"sheet6!G4\":true,\"sheet6!B5\":true,\"sheet6!B7\":true,\"sheet6!B8\":true,\"sheet6!B9\":true,\"sheet6!B10\":true,\"sheet6!B11\":true,\"sheet6!B12\":true,\"sheet6!B14\":true,\"sheet6!B15\":true,\"sheet6!B16\":true,\"sheet6!B17\":true,\"sheet6!B18\":true,\"sheet6!B19\":true,\"sheet6!B20\":true,\"sheet6!B38\":true,\"sheet6!B39\":true,\"sheet6!B40\":true,\"sheet6!F36\":true,\"sheet6!G37\":true,\"sheet6!F37\":true,\"sheet6!F39\":true,\"sheet6!G39\":true,\"sheet6!F38\":true,\"inv3!B2\":true,\"inv3!B6\":true,\"inv3!B7\":true,\"inv3!B8\":true,\"inv3!B9\":true,\"inv3!B10\":true,\"inv3!B11\":true,\"inv3!B12\":true,\"inv3!B13\":true,\"inv3!B14\":true,\"inv3!B15\":true,\"inv3!B16\":true,\"inv3!B17\":true,\"inv3!B18\":true,\"inv3!E6\":true,\"inv3!E7\":true,\"inv3!E8\":true,\"inv3!E9\":true,\"inv3!E10\":true,\"inv3!E11\":true,\"inv3!E12\":true,\"inv3!E13\":true,\"inv3!E14\":true,\"inv3!E15\":true,\"inv3!E16\":true,\"inv3!E17\":true,\"inv3!E18\":true,\"inv3!F6\":true,\"inv3!F7\":true,\"inv3!F8\":true,\"inv3!F9\":true,\"inv3!F10\":true,\"inv3!F11\":true,\"inv3!F12\":true,\"inv3!F13\":true,\"inv3!F14\":true,\"inv3!F15\":true,\"inv3!F16\":true,\"inv3!F17\":true,\"inv3!F18\":true,\"sheet7!F6\":true,\"sheet7!F7\":true,\"sheet7!F8\":true,\"sheet7!F9\":true,\"sheet7!F10\":true,\"sheet7!F11\":true,\"sheet7!F12\":true,\"sheet7!F13\":true,\"sheet7!F14\":true,\"sheet7!F15\":true,\"sheet7!F16\":true,\"sheet7!F17\":true,\"sheet7!F18\":true,\"sheet7!E6\":true,\"sheet7!E7\":true,\"sheet7!E8\":true,\"sheet7!E9\":true,\"sheet7!E10\":true,\"sheet7!E11\":true,\"sheet7!E12\":true,\"sheet7!E13\":true,\"sheet7!E14\":true,\"sheet7!E15\":true,\"sheet7!E16\":true,\"sheet7!E17\":true,\"sheet7!E18\":true,\"sheet7!B6\":true,\"sheet7!B2\":true,\"sheet7!B7\":true,\"sheet7!B8\":true,\"sheet7!B9\":true,\"sheet7!B10\":true,\"sheet7!B11\":true,\"sheet7!B12\":true,\"sheet7!B13\":true,\"sheet7!B14\":true,\"sheet7!B15\":true,\"sheet7!B16\":true,\"sheet7!B17\":true,\"sheet7!B18\":true,\"inv1!D8\":true,\"inv1!D15\":true,\"inv1!D18\":true,\"inv2!C5\":true,\"sheet6!C5\":true},\"constraints\":{\"inv1!C5\":[\"prompttext\",\"0\",\"1e10\",\"Name\"],\"inv1!C6\":[\"prompttext\",\"0\",\"1e10\",\"Street Address\"],\"inv1!C7\":[\"prompttext\",\"0\",\"1e10\",\"City, State, Zip\"],\"inv1!C8\":[\"prompttext\",\"0\",\"1e10\",\"Phone\"],\"inv1!C9\":[\"promptemail\",\"0\",\"1e10\",\"Email\"],\"inv1!C11\":[\"prompttext\",\"0\",\"1e10\",\"From\"],\"inv1!C12\":[\"prompttext\",\"0\",\"1e10\",\"Name\"],\"inv1!C13\":[\"prompttext\",\"0\",\"1e10\",\"Street Address\"],\"inv1!C14\":[\"prompttext\",\"0\",\"1e10\",\"City, State, Zip\"],\"inv1!C15\":[\"prompttext\",\"0\",\"1e10\",\"Phone\"],\"inv1!C16\":[\"promptemail\",\"0\",\"1e10\",\"Email\"],\"inv1!C18\":[\"prompttext\",\"0\",\"1e10\",\"Invoice #\"],\"inv1!C20\":[\"prompttext\",\"0\",\"1e10\",\"Date\"],\"inv1!D20\":[\"prompttext\",\"0\",\"1e10\",\"Date\"],\"inv1!C23\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv1!C24\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv1!C25\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv1!C26\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv1!C27\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv1!C28\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv1!C29\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv1!C30\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv1!C31\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv1!C32\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv1!C33\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv1!C34\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv1!C35\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv1!F23\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv1!F24\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv1!F25\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv1!F26\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv1!F27\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv1!F28\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv1!F29\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv1!F30\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv1!F31\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv1!F32\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv1!F33\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv1!F34\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv1!F35\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv2!B2\":[\"prompttext\",\"0\",\"1e10\",\"Invoice\"],\"inv2!F4\":[\"prompttext\",\"0\",\"1e10\",\"Date\"],\"inv2!G4\":[\"prompttext\",\"0\",\"1e10\",\"Date\"],\"inv2!B5\":[\"prompttext\",\"0\",\"1e10\",\"Invoice #\"],\"inv2!B7\":[\"prompttext\",\"0\",\"1e10\",\"From\"],\"inv2!B8\":[\"prompttext\",\"0\",\"1e10\",\"Company Name\"],\"inv2!B9\":[\"prompttext\",\"0\",\"1e10\",\"Street Address\"],\"inv2!B10\":[\"prompttext\",\"0\",\"1e10\",\"City, State, Zip\"],\"inv2!B11\":[\"prompttext\",\"0\",\"1e10\",\"Phone\"],\"inv2!B12\":[\"promptemail\",\"0\",\"1e10\",\"Email\"],\"inv2!B14\":[\"prompttext\",\"0\",\"1e10\",\"Bill To\"],\"inv2!B15\":[\"prompttext\",\"0\",\"1e10\",\"Name\"],\"inv2!B16\":[\"prompttext\",\"0\",\"1e10\",\"Company Name\"],\"inv2!B17\":[\"prompttext\",\"0\",\"1e10\",\"Street Address\"],\"inv2!B18\":[\"prompttext\",\"0\",\"1e10\",\"City, State, Zip\"],\"inv2!B19\":[\"prompttext\",\"0\",\"1e10\",\"Phone\"],\"inv2!B20\":[\"promptemail\",\"0\",\"1e10\",\"Email\"],\"inv2!B23\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv2!B24\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv2!B25\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv2!B26\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv2!B27\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv2!B28\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv2!B29\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv2!B30\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv2!B31\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv2!B32\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv2!B33\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv2!B34\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv2!B35\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv2!G23\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv2!G24\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv2!G25\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv2!G26\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv2!G27\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv2!G28\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv2!G29\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv2!G30\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv2!G31\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv2!G32\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv2!G33\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv2!G34\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv2!G35\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv2!B38\":[\"prompttext\",\"0\",\"1e10\",\"Notes\"],\"inv2!B39\":[\"prompttext\",\"0\",\"1e10\",\"Notes\"],\"inv2!B40\":[\"prompttext\",\"0\",\"1e10\",\"Notes\"],\"inv2!F36\":[\"prompttext\",\"0\",\"1e10\",\"Subtotal\"],\"inv2!G37\":[\"promptdecimal\",\"0\",\"1e10\",\"Tax Rate (0.00)\"],\"inv2!F37\":[\"prompttext\",\"0\",\"1e10\",\"Tax Rate\"],\"inv2!F39\":[\"prompttext\",\"0\",\"1e10\",\"Other\"],\"inv2!G39\":[\"promptdecimal\",\"0\",\"1e10\",\"Other\"],\"inv2!F38\":[\"prompttext\",\"0\",\"1e10\",\"Tax\"],\"sheet6!B2\":[\"prompttext\",\"0\",\"1e10\",\"Invoice\"],\"sheet6!F4\":[\"prompttext\",\"0\",\"1e10\",\"Date\"],\"sheet6!G4\":[\"prompttext\",\"0\",\"1e10\",\"Date\"],\"sheet6!B5\":[\"prompttext\",\"0\",\"1e10\",\"Invoice #\"],\"sheet6!B7\":[\"prompttext\",\"0\",\"1e10\",\"From\"],\"sheet6!B8\":[\"prompttext\",\"0\",\"1e10\",\"Company Name\"],\"sheet6!B9\":[\"prompttext\",\"0\",\"1e10\",\"Street Address\"],\"sheet6!B10\":[\"prompttext\",\"0\",\"1e10\",\"City, State, Zip\"],\"sheet6!B11\":[\"prompttext\",\"0\",\"1e10\",\"Phone\"],\"sheet6!B12\":[\"promptemail\",\"0\",\"1e10\",\"Email\"],\"sheet6!B14\":[\"prompttext\",\"0\",\"1e10\",\"Bill To\"],\"sheet6!B15\":[\"prompttext\",\"0\",\"1e10\",\"Name\"],\"sheet6!B16\":[\"prompttext\",\"0\",\"1e10\",\"Company Name\"],\"sheet6!B17\":[\"prompttext\",\"0\",\"1e10\",\"Street Address\"],\"sheet6!B18\":[\"prompttext\",\"0\",\"1e10\",\"City, State, Zip\"],\"sheet6!B19\":[\"prompttext\",\"0\",\"1e10\",\"Phone\"],\"sheet6!B20\":[\"promptemail\",\"0\",\"1e10\",\"Email\"],\"sheet6!B38\":[\"prompttext\",\"0\",\"1e10\",\"Notes\"],\"sheet6!B39\":[\"prompttext\",\"0\",\"1e10\",\"Notes\"],\"sheet6!B40\":[\"prompttext\",\"0\",\"1e10\",\"Notes\"],\"sheet6!F36\":[\"prompttext\",\"0\",\"1e10\",\"Subtotal\"],\"sheet6!G37\":[\"promptdecimal\",\"0\",\"1e10\",\"Tax Rate (0.00)\"],\"sheet6!F37\":[\"prompttext\",\"0\",\"1e10\",\"Tax Rate\"],\"sheet6!F39\":[\"prompttext\",\"0\",\"1e10\",\"Other\"],\"sheet6!G39\":[\"promptdecimal\",\"0\",\"1e10\",\"Other\"],\"sheet6!F38\":[\"prompttext\",\"0\",\"1e10\",\"Tax\"],\"inv3!B6\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv3!B7\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv3!B8\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv3!B9\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv3!B10\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv3!B11\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv3!B12\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv3!B13\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv3!B14\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv3!B15\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv3!B16\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv3!B17\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv3!B18\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"sheet7!B6\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"sheet7!B7\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"sheet7!B8\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"sheet7!B9\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"sheet7!B10\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"sheet7!B11\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"sheet7!B12\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"sheet7!B13\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"sheet7!B14\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"sheet7!B15\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"sheet7!B16\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"sheet7!B17\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"sheet7!B18\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv1!D8\":[\"prompttext\",\"0\",\"1e10\",\"Phone\"],\"inv1!D15\":[\"prompttext\",\"0\",\"1e10\",\"Phone\"],\"inv1!D18\":[\"promptnumeric\",\"0\",\"1e10\",\"Invoice#\"],\"inv2!C5\":[\"promptnumeric\",\"0\",\"1e10\",\"Invoice#\"],\"sheet6!C5\":[\"promptnumeric\",\"0\",\"1e10\",\"Invoice#\"],\"sheet7!E6\":[\"promptdecimal\",\"0\",\"1e10\",\"Quantity\"],\"sheet7!E7\":[\"promptdecimal\",\"0\",\"1e10\",\"Quantity\"],\"sheet7!E8\":[\"promptdecimal\",\"0\",\"1e10\",\"Quantity\"],\"sheet7!E9\":[\"promptdecimal\",\"0\",\"1e10\",\"Quantity\"],\"sheet7!E10\":[\"promptdecimal\",\"0\",\"1e10\",\"Quantity\"],\"sheet7!E11\":[\"promptdecimal\",\"0\",\"1e10\",\"Quantity\"],\"sheet7!E12\":[\"promptdecimal\",\"0\",\"1e10\",\"Quantity\"],\"sheet7!E13\":[\"promptdecimal\",\"0\",\"1e10\",\"Quantity\"],\"sheet7!E14\":[\"promptdecimal\",\"0\",\"1e10\",\"Quantity\"],\"sheet7!E15\":[\"promptdecimal\",\"0\",\"1e10\",\"Quantity\"],\"sheet7!E16\":[\"promptdecimal\",\"0\",\"1e10\",\"Quantity\"],\"sheet7!E17\":[\"promptdecimal\",\"0\",\"1e10\",\"Quantity\"],\"sheet7!E18\":[\"promptdecimal\",\"0\",\"1e10\",\"Quantity\"],\"sheet7!F6\":[\"promptdecimal\",\"0\",\"1e10\",\"Price\"],\"sheet7!F7\":[\"promptdecimal\",\"0\",\"1e10\",\"Price\"],\"sheet7!F8\":[\"promptdecimal\",\"0\",\"1e10\",\"Price\"],\"sheet7!F9\":[\"promptdecimal\",\"0\",\"1e10\",\"Price\"],\"sheet7!F10\":[\"promptdecimal\",\"0\",\"1e10\",\"Price\"],\"sheet7!F11\":[\"promptdecimal\",\"0\",\"1e10\",\"Price\"],\"sheet7!F12\":[\"promptdecimal\",\"0\",\"1e10\",\"Price\"],\"sheet7!F13\":[\"promptdecimal\",\"0\",\"1e10\",\"Price\"],\"sheet7!F14\":[\"promptdecimal\",\"0\",\"1e10\",\"Price\"],\"sheet7!F15\":[\"promptdecimal\",\"0\",\"1e10\",\"Price\"],\"sheet7!F16\":[\"promptdecimal\",\"0\",\"1e10\",\"Price\"],\"sheet7!F17\":[\"promptdecimal\",\"0\",\"1e10\",\"Price\"],\"sheet7!F18\":[\"promptdecimal\",\"0\",\"1e10\",\"Price\"],\"inv3!E6\":[\"promptdecimal\",\"0\",\"1e10\",\"Hours\"],\"inv3!E7\":[\"promptdecimal\",\"0\",\"1e10\",\"Hours\"],\"inv3!E8\":[\"promptdecimal\",\"0\",\"1e10\",\"Hours\"],\"inv3!E9\":[\"promptdecimal\",\"0\",\"1e10\",\"Hours\"],\"inv3!E10\":[\"promptdecimal\",\"0\",\"1e10\",\"Hours\"],\"inv3!E11\":[\"promptdecimal\",\"0\",\"1e10\",\"Hours\"],\"inv3!E12\":[\"promptdecimal\",\"0\",\"1e10\",\"Hours\"],\"inv3!E13\":[\"promptdecimal\",\"0\",\"1e10\",\"Hours\"],\"inv3!E14\":[\"promptdecimal\",\"0\",\"1e10\",\"Hours\"],\"inv3!E15\":[\"promptdecimal\",\"0\",\"1e10\",\"Hours\"],\"inv3!E16\":[\"promptdecimal\",\"0\",\"1e10\",\"Hours\"],\"inv3!E17\":[\"promptdecimal\",\"0\",\"1e10\",\"Hours\"],\"inv3!E18\":[\"promptdecimal\",\"0\",\"1e10\",\"Hours\"],\"inv3!F6\":[\"promptdecimal\",\"0\",\"1e10\",\"Rate\"],\"inv3!F7\":[\"promptdecimal\",\"0\",\"1e10\",\"Rate\"],\"inv3!F8\":[\"promptdecimal\",\"0\",\"1e10\",\"Rate\"],\"inv3!F9\":[\"promptdecimal\",\"0\",\"1e10\",\"Rate\"],\"inv3!F10\":[\"promptdecimal\",\"0\",\"1e10\",\"Rate\"],\"inv3!F11\":[\"promptdecimal\",\"0\",\"1e10\",\"Rate\"],\"inv3!F12\":[\"promptdecimal\",\"0\",\"1e10\",\"Rate\"],\"inv3!F13\":[\"promptdecimal\",\"0\",\"1e10\",\"Rate\"],\"inv3!F14\":[\"promptdecimal\",\"0\",\"1e10\",\"Rate\"],\"inv3!F15\":[\"promptdecimal\",\"0\",\"1e10\",\"Rate\"],\"inv3!F16\":[\"promptdecimal\",\"0\",\"1e10\",\"Rate\"],\"inv3!F17\":[\"promptdecimal\",\"0\",\"1e10\",\"Rate\"],\"inv3!F18\":[\"promptdecimal\",\"0\",\"1e10\",\"Rate\"]}}},\n        \t\"footers\": [{name: 'Type1' , index: 1, isActive: true }, {name: 'Type2' , index: 2, isActive: false}, \n                        {name: 'Type3' , index: 3, isActive: false}, {name: 'Detail1' , index: 4, isActive: false}, \n                        {name: 'Detail2' , index: 5, isActive: false}]\n        },\n        \"iPod\":{\n        \t\"msc\": {\"numsheets\":5,\"currentid\":\"sheet1\",\"currentname\":\"inv1\",\"sheetArr\":{\"sheet1\":{\"sheetstr\":{\"savestr\":\"version:1.5\\ncell:B1:b:::2::l:1:f:10\\ncell:C1:b:::2::l:1:f:10\\ncell:D1:b:::2::l:1:f:10\\ncell:E1:b:::2::l:1:f:10\\ncell:F1:b:::2::l:1:f:10\\ncell:G1:b:::2::l:1:f:10\\ncell:A2:b::2:::l:1:f:10\\ncell:B2:t:INVOICE:b:1:1:1:1:f:13:cf:1:colspan:6\\ncell:C2:t::b:2::2::l:1:f:10\\ncell:D2:t::b:2::2::l:1:f:10\\ncell:E2:t::b:2::2::l:1:f:10\\ncell:F2:t::b:2::2::l:1:f:10\\ncell:G2:t::b:2::2::l:1:f:10\\ncell:A3:b::2:::l:3:f:10\\ncell:B3:b:2:::2:l:3:f:10\\ncell:C3:b:2::::l:1:f:10\\ncell:D3:b:2::::l:1:f:10\\ncell:E3:b:2::::l:1:f:10\\ncell:F3:b:2::::l:1:f:10\\ncell:G3:b:2:2:::l:3:f:10\\ncell:A4:b::2:::l:3:f:10\\ncell:B4:b::::2:l:3:f:6\\ncell:C4:t:BILL TO\\\\c:f:9:colspan:2\\ncell:E4:f:5:cf:2\\ncell:G4:b::2:::l:3:f:10\\ncell:A5:b::2:::l:3:f:10\\ncell:B5:b::::2:l:3:f:7\\ncell:C5:t:[Name]:f:9:cf:2:colspan:3\\ncell:E5:f:1:cf:2\\ncell:F5:t::l:2:f:10:tvf:4:rowspan:6\\ncell:G5:t::b::1:::l:2:f:10\\ncell:A6:b::2:::l:3:f:10\\ncell:B6:b::::2:l:3:f:7\\ncell:C6:t:[Street Address]:f:9:cf:2:colspan:3\\ncell:E6:f:1:cf:2\\ncell:F6:l:2:f:10\\ncell:G6:b::1:::l:2:f:10\\ncell:A7:b::2:::l:3:f:10\\ncell:B7:b::::2:l:3:f:7\\ncell:C7:t:[City, State, Zip]:f:9:cf:2:colspan:3\\ncell:E7:f:1:cf:2\\ncell:G7:b::2:::l:3:f:10\\ncell:A8:b::2:::l:3:f:10\\ncell:B8:b::::2:l:3:f:7\\ncell:C8:t:Phone\\\\c:f:9:cf:2:colspan:3\\ncell:D8:f:8:cf:2\\ncell:E8:f:1:cf:2\\ncell:G8:b::2:::l:3:f:10\\ncell:A9:b::2:::l:3:f:10\\ncell:B9:b::::2:l:3:f:7\\ncell:C9:t:Email\\\\c:f:9:cf:2:colspan:3\\ncell:E9:f:1:cf:2\\ncell:G9:b::2:::l:3:f:10\\ncell:A10:b::2:::l:3:f:10\\ncell:B10:b::::2:l:3:f:7\\ncell:C10:colspan:2\\ncell:G10:b::2:::l:3:f:10\\ncell:A11:b::2:::l:3:f:10\\ncell:B11:b::::2:l:3:f:7\\ncell:C11:t:FROM\\\\c:f:9:colspan:2\\ncell:E11:f:8:colspan:2\\ncell:G11:b::2:::l:3:f:10\\ncell:A12:b::2:::l:3:f:10\\ncell:B12:b::::2:l:3:f:7\\ncell:C12:t:[Name]:f:9:colspan:4\\ncell:E12:colspan:2\\ncell:G12:b::2:::l:3:f:10\\ncell:A13:b::2:::l:3:f:10\\ncell:B13:b::::2:l:3:f:7\\ncell:C13:t:[Street Address]:f:9:colspan:4\\ncell:E13:colspan:2\\ncell:G13:b::2:::l:3:f:10\\ncell:A14:b::2:::l:3:f:10\\ncell:B14:b::::2:l:3:f:7\\ncell:C14:t:[City, State, Zip]:f:9:colspan:4\\ncell:E14:colspan:2\\ncell:G14:b::2:::l:3:f:10\\ncell:A15:b::2:::l:3:f:10\\ncell:B15:b::::2:l:3:f:7\\ncell:C15:t:Phone\\\\c:f:9:colspan:4\\ncell:D15:f:8:cf:2:colspan:3\\ncell:E15:colspan:2\\ncell:G15:b::2:::l:3:f:10\\ncell:A16:b::2:::l:3:f:10\\ncell:B16:b::::2:l:3:f:7\\ncell:C16:t:Email\\\\c:f:9:colspan:4\\ncell:E16:colspan:2\\ncell:G16:b::2:::l:3:f:10\\ncell:A17:b::2:::l:3:f:10\\ncell:B17:b::::2:l:3:f:6\\ncell:G17:b::2:::l:3:f:10\\ncell:A18:b::2:::l:3:f:10\\ncell:B18:b::::2:l:3:f:10\\ncell:C18:t:INVOICE #\\\\c:f:9:cf:2:colspan:4\\ncell:D18:v:1:l:4:f:9:cf:2:colspan:3\\ncell:G18:b::2:::l:3:f:10\\ncell:A19:b::2:::l:3:f:10\\ncell:B19:b::::2:l:3:f:10\\ncell:G19:b::2:::l:3:f:10\\ncell:A20:b::2:::l:3:f:10\\ncell:B20:b::::2:l:3:f:10\\ncell:C20:t:DATE\\\\c:f:9:cf:2\\ncell:D20:vtf:nd:42081:TODAY():f:9:cf:2:ntvf:3:colspan:2\\ncell:G20:b::2:::l:3:f:10\\ncell:A21:b::2:::l:3:f:10\\ncell:B21:b::::2:l:3:f:6:cf:2\\ncell:C21:b:::2::l:1:f:10\\ncell:D21:b:::2::l:3:f:6:cf:2\\ncell:E21:b:::2::l:1:f:10\\ncell:F21:b:::2::l:1:f:10\\ncell:G21:b::2:::l:3:f:10\\ncell:A22:b::2:::l:3:f:10\\ncell:B22:b::2::2:l:3:f:10\\ncell:C22:t:Description:b:1::1:1:f:9:cf:1:colspan:3\\ncell:D22:t:Description:b:1::1::l:3:f:6:cf:2:colspan:2:rowspan:1\\ncell:E22:t::b:2:2:2::l:1:f:10\\ncell:F22:t:Amount:b:1:1:1:1:f:9:cf:1\\ncell:G22:b::2::2:l:3:f:10\\ncell:A23:b::2:::l:3:f:10\\ncell:B23:b::2::2:l:3:f:10\\ncell:C23:b:1:1::1:f:2:cf:2:colspan:3\\ncell:D23:b:1:1:::l:3:f:10:cf:2:colspan:2:rowspan:1\\ncell:E23:t::b:2:2:2::l:1:f:10\\ncell:F23:b:1:1:::f:2:ntvf:1\\ncell:G23:b::2::2:l:3:f:10\\ncell:A24:b::2:::l:3:f:10\\ncell:B24:b::2::2:l:3:f:10:cf:2\\ncell:C24:b::1::1:f:2:cf:2:colspan:3\\ncell:D24:b::1:::l:1:f:10:colspan:2\\ncell:E24:l:1:f:10\\ncell:F24:b::1:::f:2:ntvf:1\\ncell:G24:b::2::2:l:3:f:10\\ncell:A25:b::2:::l:3:f:10\\ncell:B25:b::2::2:l:3:f:10:cf:2:ntvf:2\\ncell:C25:b::1::1:f:2:cf:2:colspan:3\\ncell:D25:b::1:::colspan:2\\ncell:F25:b::1:::f:2:ntvf:1\\ncell:G25:b::2::2:l:3:f:10\\ncell:A26:b::2:::l:3:f:10\\ncell:B26:b::2::2:l:3:f:10:cf:2:ntvf:2\\ncell:C26:b::1::1:f:2:cf:2:colspan:3\\ncell:D26:b::1:::colspan:2\\ncell:F26:b::1:::f:2:ntvf:1\\ncell:G26:b::2::2:l:3:f:10\\ncell:A27:b::2:::l:3:f:10\\ncell:B27:b::2::2:l:3:f:10:cf:2:ntvf:2\\ncell:C27:b::1::1:f:2:cf:2:colspan:3\\ncell:D27:b::1:::colspan:2\\ncell:F27:b::1:::f:2:ntvf:1\\ncell:G27:b::2::2:l:3:f:10\\ncell:A28:b::2:::l:3:f:10\\ncell:B28:b::2::2:l:3:f:10:cf:2:ntvf:2\\ncell:C28:b::1::1:f:2:cf:2:colspan:3\\ncell:D28:b::1:::colspan:2\\ncell:F28:b::1:::f:2:ntvf:1\\ncell:G28:b::2::2:l:3:f:10\\ncell:A29:b::2:::l:3:f:10\\ncell:B29:b::2::2:l:3:f:10:cf:2:ntvf:2\\ncell:C29:b::1::1:f:2:cf:2:colspan:3\\ncell:D29:b::1:::colspan:2\\ncell:F29:b::1:::f:2:ntvf:1\\ncell:G29:b::2::2:l:3:f:10\\ncell:A30:b::2:::l:3:f:10\\ncell:B30:b::2::2:l:3:f:10:cf:2\\ncell:C30:b::1::1:f:2:cf:2:colspan:3\\ncell:D30:b::1:::colspan:2\\ncell:F30:b::1:::f:2:ntvf:1\\ncell:G30:b::2::2:l:3:f:10\\ncell:A31:b::2:::l:3:f:10\\ncell:B31:b::2::2:l:3:f:10:cf:2\\ncell:C31:b::1::1:f:2:cf:2:colspan:3\\ncell:D31:b::1:::colspan:2\\ncell:F31:b::1:::f:2:ntvf:1\\ncell:G31:b::2::2:l:3:f:10\\ncell:A32:b::2:::l:3:f:10\\ncell:B32:b::2::2:l:3:f:10:cf:2\\ncell:C32:b::1::1:f:2:cf:2:colspan:3\\ncell:D32:b::1:::colspan:2\\ncell:F32:b::1:::f:2:ntvf:1\\ncell:G32:b::2::2:l:3:f:10\\ncell:A33:b::2:::l:3:f:10\\ncell:B33:b::2::2:l:3:f:10:cf:2\\ncell:C33:b::1::1:f:2:cf:2:colspan:3\\ncell:D33:b::1:::colspan:2\\ncell:F33:b::1:::f:2:ntvf:1\\ncell:G33:b::2::2:l:3:f:10\\ncell:A34:b::2:::l:3:f:10\\ncell:B34:b::2::2:l:3:f:10:cf:2\\ncell:C34:b::1::1:f:2:cf:2:colspan:3\\ncell:D34:b::1:::colspan:2\\ncell:F34:b::1:::f:2:ntvf:1\\ncell:G34:b::2::2:l:3:f:10\\ncell:A35:b::2:::l:3:f:7\\ncell:B35:b::2::2:l:3:f:10:cf:2\\ncell:C35:b::1:1:1:f:2:cf:2:colspan:3\\ncell:D35:b::1:1::l:3:f:10:cf:2:colspan:2\\ncell:E35:b:::2::l:3:f:10:cf:2\\ncell:F35:b::1:1::f:2:ntvf:1\\ncell:G35:b::2::2:l:3:f:10\\ncell:A36:b::2:::l:3:f:6\\ncell:B36:b::2::2:l:3:f:6\\ncell:C36:t:TOTAL:b:1:1:1:1:f:11:cf:2:colspan:3\\ncell:D36:b:2::2::l:3:f:12:cf:2\\ncell:E36:b:2:2:2::l:3:f:12:cf:2\\ncell:F36:vtf:n:0:SUM(F23\\\\cF35):b:1:1:1::f:11:ntvf:1\\ncell:G36:b::2::2:l:3:f:7\\ncell:A37:b::2:::l:3:f:10\\ncell:B37:b::::2:l:3:f:6:cf:2\\ncell:C37:b:2::::l:1:f:10\\ncell:D37:b:2::::l:1:f:10\\ncell:E37:b:2::::l:1:f:10\\ncell:F37:b:2::::l:1:f:10\\ncell:G37:b::2:::l:3:f:6\\ncell:A38:b::2:::l:3:f:10\\ncell:B38:b::::2:l:3:f:10\\ncell:G38:b::2:::l:3:f:10\\ncell:A39:b::2:::l:3:f:10\\ncell:B39:b::::2:l:3:f:10:cf:2\\ncell:C39:t:Thank you for your business:f:4:cf:1:colspan:4\\ncell:D39:t:Thank you for your business:colspan:3\\ncell:E39:t:Thank you for your business:f:3:colspan:2\\ncell:F39:t::l:2:f:10\\ncell:G39:b::2:::l:3:f:10\\ncell:A40:b::2:::l:3:f:10\\ncell:B40:b::::2:l:3:f:10\\ncell:G40:b::2:::l:3:f:10\\ncell:A41:b::2:::l:3:f:10\\ncell:B41:b:::2:2:l:3:f:10\\ncell:C41:b:::2::l:3:f:10\\ncell:D41:b:::2::l:3:f:10\\ncell:E41:b:::2::l:3:f:10\\ncell:F41:b:::2::l:3:f:10\\ncell:G41:b::2:2::l:3:f:10\\ncell:B42:b:1:::\\ncell:C42:b:1:::\\ncell:D42:b:1:::\\ncell:E42:b:1:::\\ncell:F42:b:1:::\\ncell:G42:b:1:::\\ncol:A:w:10\\ncol:B:w:10\\ncol:C:w:62\\ncol:D:w:73\\ncol:E:w:15\\ncol:F:w:68\\ncol:G:w:10\\nrow:1:h:14.25\\nrow:2:h:18.75\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:15.75\\nrow:6:h:15.75\\nrow:7:h:15.75\\nrow:8:h:15.75\\nrow:9:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:13:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:16:h:14.25\\nrow:17:h:14.25\\nrow:18:h:14.25\\nrow:19:h:14.25\\nrow:20:h:14.25\\nrow:21:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nrow:24:h:14.25\\nrow:25:h:14.25\\nrow:26:h:14.25\\nrow:27:h:14.25\\nrow:28:h:14.25\\nrow:29:h:14.25\\nrow:30:h:14.25\\nrow:31:h:14.25\\nrow:32:h:14.25\\nrow:33:h:14.25\\nrow:34:h:14.25\\nrow:35:h:15.75\\nrow:36:h:15.75\\nrow:37:h:14.25\\nrow:38:h:14.25\\nrow:39:h:14.25\\nrow:40:h:14.25\\nrow:41:h:14.25\\nsheet:c:7:r:42:h:12.75\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\nfont:1:* * Trebuchet MS\\nfont:2:* 9pt Trebuchet MS\\nfont:3:italic bold * Trebuchet MS\\nfont:4:italic bold 10pt Trebuchet MS\\nfont:5:normal bold * Trebuchet MS\\nfont:6:normal bold 10pt Arial\\nfont:7:normal bold 12pt Arial\\nfont:8:normal normal * *\\nfont:9:normal normal * Trebuchet MS\\nfont:10:normal normal 10pt Arial\\nfont:11:normal normal 11pt Trebuchet MS\\nfont:12:normal normal 12pt Arial\\nfont:13:normal normal 16pt Trebuchet MS\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nlayout:3:padding:* * * *;vertical-align:top;\\nlayout:4:padding:* * * 4px;vertical-align:*;\\nvalueformat:1:#,##0.00\\nvalueformat:2:d-mmm\\nvalueformat:3:m/d/yy\\nvalueformat:4:text-html\\n\"},\"name\":\"inv1\",\"hidden\":\"0\"},\"sheet2\":{\"sheetstr\":{\"savestr\":\"version:1.5\\ncell:B2:t:INVOICE:l:1:f:9:cf:1:colspan:6\\ncell:C2:t::l:2:f:13\\ncell:D2:t::l:2:f:13\\ncell:E2:l:1:f:10:c:2:cf:3\\ncell:F2:t:INVOICE:l:1:f:8:c:2:cf:2:colspan:2\\ncell:G2:t::l:2:f:13\\ncell:B3:f:6:cf:2:colspan:4\\ncell:C3:t::l:2:f:13\\ncell:D3:t::l:2:f:13\\ncell:F3:l:1:f:7:cf:2\\ncell:G3:l:1:f:14:cf:2:ntvf:3\\ncell:B4:f:2:colspan:2\\ncell:F4:t:DATE\\\\c:l:1:f:14:cf:2\\ncell:G4:vtf:nd:42081:TODAY():l:1:f:14:cf:2:ntvf:3\\ncell:B5:t:INVOICE #\\\\c:f:3:colspan:6\\ncell:C5:cf:2:colspan:5\\ncell:F5:l:1:f:7:cf:2:colspan:2\\ncell:G5:l:1:f:14:cf:2\\ncell:B6:f:2:colspan:2\\ncell:F6:l:1:f:7:cf:2:colspan:2\\ncell:G6:l:1:f:14:cf:2\\ncell:B7:t:FROM\\\\c:f:12\\ncell:F7:l:1:f:7:cf:2:tvf:4:colspan:2:rowspan:6\\ncell:G7:l:1:f:14:cf:2\\ncell:B8:t:[Company Name]:f:3:colspan:4\\ncell:F8:l:1:f:7:cf:2:colspan:2\\ncell:G8:l:1:f:14:cf:2\\ncell:B9:t:[Street Address]:f:1:cf:2:colspan:4\\ncell:F9:l:1:f:7\\ncell:G9:l:1:f:14:cf:1\\ncell:B10:t:[City, State,  Zip]:f:1:cf:2:colspan:4\\ncell:G10:l:1:f:13\\ncell:B11:t:Phone\\\\c :f:1:cf:2:colspan:4\\ncell:B12:t:Email\\\\c:f:1:cf:2:colspan:4\\ncell:B13:colspan:2\\ncell:B14:t:BILL TO\\\\c:f:11:cf:2\\ncell:B15:t:[Name]:f:1:cf:2:colspan:6\\ncell:B16:t:[Company Name]:f:1:cf:2:colspan:6\\ncell:F16:t:  \\ncell:B17:t:[Street Address]:f:1:cf:2:colspan:6\\ncell:B18:t:[City, State,  Zip]:f:1:cf:2:colspan:6\\ncell:B19:t:Phone\\\\c :f:1:cf:2:colspan:6\\ncell:B20:t:Email\\\\c:f:1:cf:2:colspan:6\\ncell:A22:b::1::\\ncell:B22:t:DESCRIPTION:b:1:1:1:1:l:1:f:14:c:1:bg:3:cf:1:colspan:5:rowspan:1\\ncell:C22:t::l:2:f:13\\ncell:D22:t::l:2:f:13\\ncell:E22:t::l:2:f:13\\ncell:F22:t::l:2:f:13\\ncell:G22:t:AMOUNT:b:1:1:1::l:1:f:14:c:1:bg:3:cf:1\\ncell:A23:b::1::\\ncell:B23:b:1:1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C23:t::l:2:f:4\\ncell:D23:t::l:2:f:4\\ncell:E23:t::l:2:f:4\\ncell:F23:t::b::2:::l:1:f:4\\ncell:G23:b::1::1:f:4:ntvf:1\\ncell:A24:b::1::\\ncell:B24:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C24:t::l:2:f:4\\ncell:D24:t::l:2:f:4\\ncell:E24:t::l:2:f:4\\ncell:F24:t::b::2:::l:1:f:4\\ncell:G24:b::1::1:f:4:ntvf:1\\ncell:A25:b::1::\\ncell:B25:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C25:t::l:2:f:4\\ncell:D25:t::l:2:f:4\\ncell:E25:t::l:2:f:4\\ncell:F25:t::b::2:::l:1:f:4\\ncell:G25:b::1::1:f:4:ntvf:1\\ncell:A26:b::1::\\ncell:B26:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C26:t::l:2:f:4\\ncell:D26:t::l:2:f:4\\ncell:E26:t::l:2:f:4\\ncell:F26:t::b::2:::l:1:f:4\\ncell:G26:b::1::1:f:4:ntvf:1\\ncell:A27:b::1::\\ncell:B27:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C27:t::l:2:f:4\\ncell:D27:t::l:2:f:4\\ncell:E27:t::l:2:f:4\\ncell:F27:t::b::2:::l:1:f:4\\ncell:G27:b::1::1:f:4:ntvf:1\\ncell:A28:b::1::\\ncell:B28:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C28:t::l:2:f:4\\ncell:D28:t::l:2:f:4\\ncell:E28:t::l:2:f:4\\ncell:F28:t::b::2:::l:1:f:4\\ncell:G28:b::1::1:f:4:ntvf:1\\ncell:A29:b::1::\\ncell:B29:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C29:t::l:2:f:4\\ncell:D29:t::l:2:f:4\\ncell:E29:t::l:2:f:4\\ncell:F29:t::b::2:::l:1:f:4\\ncell:G29:b::1::1:f:4:ntvf:1\\ncell:A30:b::1::\\ncell:B30:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C30:t::l:2:f:4\\ncell:D30:t::l:2:f:4\\ncell:E30:t::l:2:f:4\\ncell:F30:t::b::2:::l:1:f:4\\ncell:G30:b::1::1:f:4:ntvf:1\\ncell:A31:b::1::\\ncell:B31:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C31:t::l:2:f:4\\ncell:D31:t::l:2:f:4\\ncell:E31:t::l:2:f:4\\ncell:F31:t::b::2:::l:1:f:4\\ncell:G31:b::1::1:f:4:ntvf:1\\ncell:A32:b::1::\\ncell:B32:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C32:t::l:2:f:4\\ncell:D32:t::l:2:f:4\\ncell:E32:t::l:2:f:4\\ncell:F32:t::b::2:::l:1:f:4\\ncell:G32:b::1::1:f:4:ntvf:1\\ncell:A33:b::1::\\ncell:B33:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C33:t::l:2:f:4\\ncell:D33:t::l:2:f:4\\ncell:E33:t::l:2:f:4\\ncell:F33:t::b::2:::l:1:f:4\\ncell:G33:b::1::1:f:4:ntvf:1\\ncell:A34:b::1::\\ncell:B34:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C34:l:2:f:4\\ncell:D34:l:2:f:4\\ncell:E34:l:2:f:4\\ncell:F34:b::2:::l:1:f:4\\ncell:G34:b::1::1:f:4:ntvf:1\\ncell:A35:b::1::\\ncell:B35:b::1:1:1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C35:t::b:::2::l:1:f:4\\ncell:D35:t::b:::2::l:1:f:4\\ncell:E35:t::b:::2::l:1:f:4\\ncell:F35:t::b::2:2::l:1:f:4\\ncell:G35:b::1:1:1:f:4:ntvf:1\\ncell:B36:b:2::::l:1:f:13\\ncell:C36:b:2::::l:1:f:13\\ncell:D36:b:2::::l:1:f:13\\ncell:E36:b:2::::l:1:f:14\\ncell:F36:t:Subtotal:b:2::::l:1:f:11\\ncell:G36:vtf:n:0:SUM(G23\\\\cG35):b:1::::f:11:ntvf:1\\ncell:B37:t:NOTES:b:::1::l:1:f:14:cf:2:colspan:3:rowspan:1\\ncell:C37:t::b:::2::l:1:f:13\\ncell:D37:t::b:::2::l:1:f:13\\ncell:F37:t:Tax Rate:l:1:f:11\\ncell:G37:v:0:f:1:ntvf:2\\ncell:B38:b:1::::f:1:cf:2:colspan:3\\ncell:C38:t::b:2::::l:1:f:13\\ncell:D38:t::b:2::::l:1:f:13\\ncell:F38:t:Tax:l:1:f:11\\ncell:G38:vtf:n:0:G37*G36:f:1:ntvf:1\\ncell:B39:f:1:cf:2:colspan:3\\ncell:C39:t::l:2:f:13\\ncell:D39:t::l:2:f:13\\ncell:F39:t:Other:b:::1::l:1:f:11\\ncell:G39:v:0:b:::1::f:1:ntvf:1\\ncell:B40:b:::1::f:1:cf:2:colspan:3:rowspan:1\\ncell:C40:t::l:2:f:13\\ncell:D40:t::l:2:f:13\\ncell:F40:t:TOTAL:b:1::::l:1:f:14\\ncell:G40:vtf:n:0:(G36+G38)+G39:b:1::::f:11:ntvf:1\\ncell:B43:t:Thank you for your business:l:1:f:5:cf:1:colspan:6:rowspan:1\\ncell:C43:t::l:2:f:13\\ncell:D43:t::l:2:f:13\\ncell:E43:t::l:2:f:13\\ncell:F43:t::l:2:f:13\\ncell:G43:t::l:2:f:13\\ncol:A:w:10\\ncol:B:w:90\\ncol:C:w:19\\ncol:D:w:10\\ncol:E:w:16\\ncol:F:w:45\\ncol:G:w:64\\nrow:1:h:34.5\\nrow:2:h:34.5\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:14.25\\nrow:6:h:14.25\\nrow:7:h:14.25\\nrow:8:h:14.25\\nrow:9:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:16:h:14.25\\nrow:17:h:14.25\\nrow:18:h:14.25\\nrow:19:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nrow:24:h:14.25\\nrow:25:h:14.25\\nrow:26:h:14.25\\nrow:27:h:14.25\\nrow:28:h:14.25\\nrow:29:h:14.25\\nrow:30:h:14.25\\nrow:31:h:14.25\\nrow:32:h:14.25\\nrow:33:h:14.25\\nrow:34:h:14.25\\nrow:35:h:14.25\\nrow:36:h:14.25\\nrow:37:h:14.25\\nrow:38:h:14.25\\nrow:39:h:14.25\\nrow:40:h:14.25\\nrow:43:h:15.75\\nsheet:c:7:r:43:h:12.75:needsrecalc:yes\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\ncellformat:3:right\\ncolor:1:rgb(0, 0, 0)\\ncolor:2:rgb(0,0,0)\\ncolor:3:rgb(221, 221, 221)\\nfont:1:* * Trebuchet MS\\nfont:2:* 10pt *\\nfont:3:* 10pt Trebuchet MS\\nfont:4:* 9pt Trebuchet MS\\nfont:5:italic bold 10pt Trebuchet MS\\nfont:6:italic normal * Trebuchet MS\\nfont:7:normal bold 10pt Trebuchet MS\\nfont:8:normal bold 14pt Trebuchet MS\\nfont:9:normal bold 16pt Trebuchet MS\\nfont:10:normal bold 28pt Trebuchet MS\\nfont:11:normal normal * Trebuchet MS\\nfont:12:normal normal 10pt *\\nfont:13:normal normal 10pt Arial\\nfont:14:normal normal 10pt Trebuchet MS\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nvalueformat:1:#,##0.00\\nvalueformat:2:#,##0.00%\\nvalueformat:3:m/d/yy\\nvalueformat:4:text-html\\n\"},\"name\":\"inv2\",\"hidden\":\"0\"},\"sheet3\":{\"sheetstr\":{\"savestr\":\"version:1.5\\ncell:B2:t:INVOICE:l:1:f:12:cf:1:colspan:6\\ncell:C2:t::l:2:f:10\\ncell:D2:t::l:2:f:10\\ncell:E2:l:1:f:8:c:2:cf:3\\ncell:F2:t:INVOICE:l:1:f:7:c:2:cf:2:colspan:2\\ncell:G2:t::l:2:f:10\\ncell:B3:f:5:cf:2:colspan:4\\ncell:C3:t::l:2:f:10\\ncell:D3:t::l:2:f:10\\ncell:F3:l:1:f:6:cf:2\\ncell:G3:l:1:f:11:cf:2:ntvf:3\\ncell:B4:f:2:colspan:2\\ncell:F4:t:DATE\\\\c:l:1:f:11:cf:2\\ncell:G4:vtf:nd:42081:TODAY():l:1:f:11:cf:2:ntvf:3\\ncell:B5:t:INVOICE #\\\\c:f:9:colspan:6\\ncell:C5:cf:2:colspan:5\\ncell:F5:l:1:f:6:cf:2:colspan:2\\ncell:G5:l:1:f:11:cf:2\\ncell:B6:f:2:colspan:2\\ncell:F6:l:1:f:6:cf:2:colspan:2\\ncell:G6:l:1:f:11:cf:2\\ncell:B7:t:FROM\\\\c:f:11\\ncell:F7:l:1:f:6:cf:2:colspan:2\\ncell:G7:l:1:f:11:cf:2\\ncell:B8:t:[Company Name]:f:9:colspan:4\\ncell:F8:l:1:f:6:cf:2:tvf:4:colspan:2:rowspan:5\\ncell:G8:l:1:f:11:cf:2\\ncell:B9:t:[Street Address]:f:9:cf:2:colspan:4\\ncell:F9:l:1:f:6\\ncell:G9:l:1:f:11:cf:1\\ncell:B10:t:[City, State,  Zip]:f:9:cf:2:colspan:4\\ncell:G10:l:1:f:10\\ncell:B11:t:Phone\\\\c :f:9:cf:2:colspan:4\\ncell:B12:t:Email\\\\c:f:9:cf:2:colspan:4\\ncell:B13:colspan:2\\ncell:B14:t:BILL TO\\\\c:f:9:cf:2\\ncell:B15:t:[Name]:f:9:cf:2:colspan:6\\ncell:B16:t:[Company Name]:f:9:cf:2:colspan:6\\ncell:F16:t:  \\ncell:B17:t:[Street Address]:f:9:cf:2:colspan:6\\ncell:B18:t:[City, State,  Zip]:f:9:cf:2:colspan:6\\ncell:B19:t:Phone\\\\c :f:9:cf:2:colspan:6\\ncell:B20:t:Email\\\\c:f:9:cf:2:colspan:6\\ncell:A22:b::1::\\ncell:B22:t:DESCRIPTION:b:1:1:1:1:l:1:f:11:c:1:bg:3:cf:1:colspan:5:rowspan:1\\ncell:C22:t::l:2:f:10\\ncell:D22:t::l:2:f:10\\ncell:E22:t::l:2:f:10\\ncell:F22:t::l:2:f:10\\ncell:G22:t:AMOUNT:b:1:1:1::l:1:f:11:c:1:bg:3:cf:1\\ncell:A23:b::1::\\ncell:B23:vtf:t: :IF(AND(ISBLANK(inv3!B6),ISBLANK(sheet7!B6)), \\\" \\\", IF(ISBLANK(inv3!B6), sheet7!B6, inv3!B6)):b:1:1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C23:t::l:2:f:3\\ncell:D23:t::l:2:f:3\\ncell:E23:t::l:2:f:3\\ncell:F23:t::b::2:::l:1:f:3\\ncell:G23:vtf:t: :IF(AND(ISBLANK(inv3!B6),ISBLANK(sheet7!B6)), \\\" \\\", IF(ISBLANK(inv3!B6), (sheet7!E6*sheet7!F6), (inv3!E6*inv3!F6))):b::1::1:f:3:ntvf:1\\ncell:A24:b::1::\\ncell:B24:vtf:t: :IF(AND(ISBLANK(INV3!B7),ISBLANK(SHEET7!B7)), \\\" \\\", IF(ISBLANK(INV3!B7), SHEET7!B7, INV3!B7)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C24:t::l:2:f:3\\ncell:D24:t::l:2:f:3\\ncell:E24:t::l:2:f:3\\ncell:F24:t::b::2:::l:1:f:3\\ncell:G24:vtf:t: :IF(AND(ISBLANK(INV3!B7),ISBLANK(SHEET7!B7)), \\\" \\\", IF(ISBLANK(INV3!B7), (SHEET7!E7*SHEET7!F7), (INV3!E7*INV3!F7))):b::1::1:f:3:ntvf:1\\ncell:A25:b::1::\\ncell:B25:vtf:t: :IF(AND(ISBLANK(INV3!B8),ISBLANK(SHEET7!B8)), \\\" \\\", IF(ISBLANK(INV3!B8), SHEET7!B8, INV3!B8)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C25:t::l:2:f:3\\ncell:D25:t::l:2:f:3\\ncell:E25:t::l:2:f:3\\ncell:F25:t::b::2:::l:1:f:3\\ncell:G25:vtf:t: :IF(AND(ISBLANK(INV3!B8),ISBLANK(SHEET7!B8)), \\\" \\\", IF(ISBLANK(INV3!B8), (SHEET7!E8*SHEET7!F8), (INV3!E8*INV3!F8))):b::1::1:f:3:ntvf:1\\ncell:A26:b::1::\\ncell:B26:vtf:t: :IF(AND(ISBLANK(INV3!B9),ISBLANK(SHEET7!B9)), \\\" \\\", IF(ISBLANK(INV3!B9), SHEET7!B9, INV3!B9)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C26:t::l:2:f:3\\ncell:D26:t::l:2:f:3\\ncell:E26:t::l:2:f:3\\ncell:F26:t::b::2:::l:1:f:3\\ncell:G26:vtf:t: :IF(AND(ISBLANK(INV3!B9),ISBLANK(SHEET7!B9)), \\\" \\\", IF(ISBLANK(INV3!B9), (SHEET7!E9*SHEET7!F9), (INV3!E9*INV3!F9))):b::1::1:f:3:ntvf:1\\ncell:A27:b::1::\\ncell:B27:vtf:t: :IF(AND(ISBLANK(INV3!B10),ISBLANK(SHEET7!B10)), \\\" \\\", IF(ISBLANK(INV3!B10), SHEET7!B10, INV3!B10)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C27:t::l:2:f:3\\ncell:D27:t::l:2:f:3\\ncell:E27:t::l:2:f:3\\ncell:F27:t::b::2:::l:1:f:3\\ncell:G27:vtf:t: :IF(AND(ISBLANK(INV3!B10),ISBLANK(SHEET7!B10)), \\\" \\\", IF(ISBLANK(INV3!B10), (SHEET7!E10*SHEET7!F10), (INV3!E10*INV3!F10))):b::1::1:f:3:ntvf:1\\ncell:A28:b::1::\\ncell:B28:vtf:t: :IF(AND(ISBLANK(INV3!B11),ISBLANK(SHEET7!B11)), \\\" \\\", IF(ISBLANK(INV3!B11), SHEET7!B11, INV3!B11)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C28:t::l:2:f:3\\ncell:D28:t::l:2:f:3\\ncell:E28:t::l:2:f:3\\ncell:F28:t::b::2:::l:1:f:3\\ncell:G28:vtf:t: :IF(AND(ISBLANK(INV3!B11),ISBLANK(SHEET7!B11)), \\\" \\\", IF(ISBLANK(INV3!B11), (SHEET7!E11*SHEET7!F11), (INV3!E11*INV3!F11))):b::1::1:f:3:ntvf:1\\ncell:A29:b::1::\\ncell:B29:vtf:t: :IF(AND(ISBLANK(INV3!B12),ISBLANK(SHEET7!B12)), \\\" \\\", IF(ISBLANK(INV3!B12), SHEET7!B12, INV3!B12)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C29:t::l:2:f:3\\ncell:D29:t::l:2:f:3\\ncell:E29:t::l:2:f:3\\ncell:F29:t::b::2:::l:1:f:3\\ncell:G29:vtf:t: :IF(AND(ISBLANK(INV3!B12),ISBLANK(SHEET7!B12)), \\\" \\\", IF(ISBLANK(INV3!B12), (SHEET7!E12*SHEET7!F12), (INV3!E12*INV3!F12))):b::1::1:f:3:ntvf:1\\ncell:A30:b::1::\\ncell:B30:vtf:t: :IF(AND(ISBLANK(INV3!B13),ISBLANK(SHEET7!B13)), \\\" \\\", IF(ISBLANK(INV3!B13), SHEET7!B13, INV3!B13)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C30:t::l:2:f:3\\ncell:D30:t::l:2:f:3\\ncell:E30:t::l:2:f:3\\ncell:F30:t::b::2:::l:1:f:3\\ncell:G30:vtf:t: :IF(AND(ISBLANK(INV3!B13),ISBLANK(SHEET7!B13)), \\\" \\\", IF(ISBLANK(INV3!B13), (SHEET7!E13*SHEET7!F13), (INV3!E13*INV3!F13))):b::1::1:f:3:ntvf:1\\ncell:A31:b::1::\\ncell:B31:vtf:t: :IF(AND(ISBLANK(INV3!B14),ISBLANK(SHEET7!B14)), \\\" \\\", IF(ISBLANK(INV3!B14), SHEET7!B14, INV3!B14)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C31:t::l:2:f:3\\ncell:D31:t::l:2:f:3\\ncell:E31:t::l:2:f:3\\ncell:F31:t::b::2:::l:1:f:3\\ncell:G31:vtf:t: :IF(AND(ISBLANK(INV3!B14),ISBLANK(SHEET7!B14)), \\\" \\\", IF(ISBLANK(INV3!B14), (SHEET7!E14*SHEET7!F14), (INV3!E14*INV3!F14))):b::1::1:f:3:ntvf:1\\ncell:A32:b::1::\\ncell:B32:vtf:t: :IF(AND(ISBLANK(INV3!B15),ISBLANK(SHEET7!B15)), \\\" \\\", IF(ISBLANK(INV3!B15), SHEET7!B15, INV3!B15)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C32:t::l:2:f:3\\ncell:D32:t::l:2:f:3\\ncell:E32:t::l:2:f:3\\ncell:F32:t::b::2:::l:1:f:3\\ncell:G32:vtf:t: :IF(AND(ISBLANK(INV3!B15),ISBLANK(SHEET7!B15)), \\\" \\\", IF(ISBLANK(INV3!B15), (SHEET7!E15*SHEET7!F15), (INV3!E15*INV3!F15))):b::1::1:f:3:ntvf:1\\ncell:A33:b::1::\\ncell:B33:vtf:t: :IF(AND(ISBLANK(INV3!B16),ISBLANK(SHEET7!B16)), \\\" \\\", IF(ISBLANK(INV3!B16), SHEET7!B16, INV3!B16)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C33:l:2:f:3\\ncell:D33:l:2:f:3\\ncell:E33:l:2:f:3\\ncell:F33:b::2:::l:1:f:3\\ncell:G33:vtf:t: :IF(AND(ISBLANK(INV3!B16),ISBLANK(SHEET7!B16)), \\\" \\\", IF(ISBLANK(INV3!B16), (SHEET7!E16*SHEET7!F16), (INV3!E16*INV3!F16))):b::1::1:f:3:ntvf:1\\ncell:A34:b::1::\\ncell:B34:vtf:t: :IF(AND(ISBLANK(INV3!B17),ISBLANK(SHEET7!B17)), \\\" \\\", IF(ISBLANK(INV3!B17), SHEET7!B17, INV3!B17)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C34:t::l:2:f:3\\ncell:D34:t::l:2:f:3\\ncell:E34:t::l:2:f:3\\ncell:F34:t::b::2:::l:1:f:3\\ncell:G34:vtf:t: :IF(AND(ISBLANK(INV3!B17),ISBLANK(SHEET7!B17)), \\\" \\\", IF(ISBLANK(INV3!B17), (SHEET7!E17*SHEET7!F17), (INV3!E17*INV3!F17))):b::1::1:f:3:ntvf:1\\ncell:A35:b::1::\\ncell:B35:vtf:t: :IF(AND(ISBLANK(INV3!B18),ISBLANK(SHEET7!B18)), \\\" \\\", IF(ISBLANK(INV3!B18), SHEET7!B18, INV3!B18)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C35:t::b:::2::l:1:f:3\\ncell:D35:t::b:::2::l:1:f:3\\ncell:E35:t::b:::2::l:1:f:3\\ncell:F35:t::b::2:2::l:1:f:3\\ncell:G35:vtf:t: :IF(AND(ISBLANK(INV3!B18),ISBLANK(SHEET7!B18)), \\\" \\\", IF(ISBLANK(INV3!B18), (SHEET7!E18*SHEET7!F18), (INV3!E18*INV3!F18))):b::1::1:f:3:ntvf:1\\ncell:B36:b:2::::l:1:f:10\\ncell:C36:b:2::::l:1:f:10\\ncell:D36:b:2::::l:1:f:10\\ncell:E36:b:2::::l:1:f:11\\ncell:F36:t:Subtotal:b:2::::l:1:f:9\\ncell:G36:vtf:n:0:SUM(G23\\\\cG35):b:1::::f:9:ntvf:1\\ncell:B37:t:NOTES:b:::1::l:1:f:11:cf:2:colspan:3:rowspan:1\\ncell:C37:t::b:::2::l:1:f:10\\ncell:D37:t::b:::2::l:1:f:10\\ncell:F37:t:Tax Rate:l:1:f:9\\ncell:G37:v:0:f:1:ntvf:2\\ncell:B38:b:1::::f:1:cf:2:colspan:3\\ncell:C38:t::b:2::::l:1:f:10\\ncell:D38:t::b:2::::l:1:f:10\\ncell:F38:t:Tax:l:1:f:9\\ncell:G38:vtf:n:0:G37*G36:f:1:ntvf:1\\ncell:B39:f:1:cf:2:colspan:3\\ncell:C39:t::l:2:f:10\\ncell:D39:t::l:2:f:10\\ncell:F39:t:Other:b:::1::l:1:f:9\\ncell:G39:v:0:b:::1::f:1:ntvf:1\\ncell:B40:b:::1::f:1:cf:2:colspan:3:rowspan:1\\ncell:C40:t::l:2:f:10\\ncell:D40:t::l:2:f:10\\ncell:F40:t:TOTAL:b:1::::l:1:f:11\\ncell:G40:vtf:n:0:(G36+G38)+G39:b:1::::f:9:ntvf:1\\ncell:B43:t:Thank you for your business:l:1:f:4:cf:1:colspan:6:rowspan:1\\ncell:C43:t::l:2:f:10\\ncell:D43:t::l:2:f:10\\ncell:E43:t::l:2:f:10\\ncell:F43:t::l:2:f:10\\ncell:G43:t::l:2:f:10\\ncol:A:w:10\\ncol:B:w:65\\ncol:C:w:19\\ncol:D:w:10\\ncol:E:w:16\\ncol:F:w:53\\ncol:G:w:64\\nrow:1:h:34.5\\nrow:2:h:34.5\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:14.25\\nrow:6:h:14.25\\nrow:7:h:14.25\\nrow:8:h:14.25\\nrow:9:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:16:h:14.25\\nrow:17:h:14.25\\nrow:18:h:14.25\\nrow:19:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nrow:24:h:14.25\\nrow:25:h:14.25\\nrow:26:h:14.25\\nrow:27:h:14.25\\nrow:28:h:14.25\\nrow:29:h:14.25\\nrow:30:h:14.25\\nrow:31:h:14.25\\nrow:32:h:14.25\\nrow:33:h:14.25\\nrow:34:h:14.25\\nrow:35:h:14.25\\nrow:36:h:14.25\\nrow:37:h:14.25\\nrow:38:h:14.25\\nrow:39:h:14.25\\nrow:40:h:14.25\\nrow:43:h:15.75\\nsheet:c:7:r:43:h:12.75:needsrecalc:yes\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\ncellformat:3:right\\ncolor:1:rgb(0, 0, 0)\\ncolor:2:rgb(0,0,0)\\ncolor:3:rgb(221, 221, 221)\\nfont:1:* * Trebuchet MS\\nfont:2:* 10pt *\\nfont:3:* 9pt Trebuchet MS\\nfont:4:italic bold 10pt Trebuchet MS\\nfont:5:italic normal * Trebuchet MS\\nfont:6:normal bold 10pt Trebuchet MS\\nfont:7:normal bold 14pt Trebuchet MS\\nfont:8:normal bold 28pt Trebuchet MS\\nfont:9:normal normal * Trebuchet MS\\nfont:10:normal normal 10pt Arial\\nfont:11:normal normal 10pt Trebuchet MS\\nfont:12:normal normal 16pt Trebuchet MS\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nvalueformat:1:#,##0.00\\nvalueformat:2:#,##0.00%\\nvalueformat:3:m/d/yy\\nvalueformat:4:text-html\\n\"},\"name\":\"sheet6\",\"hidden\":\"0\"},\"sheet4\":{\"sheetstr\":{\"savestr\":\"version:1.5\\ncell:B1:b:::2::l:1:f:7\\ncell:C1:b:::2::l:1:f:7\\ncell:D1:b:::2::l:1:f:7\\ncell:E1:b:::2::l:1:f:7\\ncell:F1:b:::2::l:1:f:7\\ncell:A2:b::2:::l:1:f:7\\ncell:B2:t:INVOICE DETAILS:b:1:1:1:1:l:1:f:8:cf:1:colspan:5\\ncell:C2:t::b:2::2::l:1:f:7\\ncell:D2:t::b:2::2::l:1:f:7\\ncell:E2:t::b:2::2::l:1:f:7\\ncell:F2:b:2:1:1::l:1:f:7\\ncell:G2:b::::1\\ncell:A3:b::2:::l:3:f:7\\ncell:B3:b:2::::l:1:f:7\\ncell:C3:b:2::::l:1:f:7\\ncell:D3:b:2::::l:1:f:7\\ncell:E3:b:2::::l:1:f:7\\ncell:F3:b:1:1:::l:1:f:7\\ncell:G3:b::::1\\ncell:A4:b::2:::l:3:f:7\\ncell:B4:b:::2::l:1:f:7\\ncell:C4:b:::2::l:3:f:4:cf:2\\ncell:D4:b:::2::l:1:f:7\\ncell:E4:b:::2::l:1:f:7\\ncell:F4:b::1:1::l:1:f:7\\ncell:G4:b::::1\\ncell:A5:b::2:::l:3:f:7\\ncell:B5:t:Description:b:1:1:1:1:f:6:cf:1:colspan:3\\ncell:C5:t:Description:b:2::2:2:l:3:f:4:cf:2:colspan:2:rowspan:1\\ncell:D5:t::b:2:2:2::l:1:f:7\\ncell:E5:t:Hours:b:1:1:1:1:f:6:cf:1\\ncell:F5:t:Rate:b:1:1:1:1:f:6:cf:1\\ncell:G5:b::::1\\ncell:A6:b::2:::l:3:f:7\\ncell:B6:b:1:1::1:f:1:cf:2:colspan:3\\ncell:C6:b:1:1::1:l:3:f:7:cf:2:colspan:2:rowspan:1\\ncell:D6:t::b:2:2:2::l:1:f:7\\ncell:E6:b:1:1:::f:1:ntvf:1\\ncell:F6:b:1:1:::f:1:ntvf:1\\ncell:G6:b::::1\\ncell:A7:b::2:::l:3:f:7\\ncell:B7:b::1::1:f:1:cf:2:colspan:3\\ncell:C7:b::1::1:l:1:f:7:colspan:2\\ncell:D7:l:1:f:7\\ncell:E7:b::1:::f:1:ntvf:1\\ncell:F7:b::1:::f:1:ntvf:1\\ncell:G7:b::::1\\ncell:A8:b::2:::l:3:f:7\\ncell:B8:b::1::1:f:1:cf:2:colspan:3\\ncell:C8:b::1::1:colspan:2\\ncell:E8:b::1:::f:1:ntvf:1\\ncell:F8:b::1:::f:1:ntvf:1\\ncell:G8:b::::1\\ncell:A9:b::2:::l:3:f:7\\ncell:B9:b::1::1:f:1:cf:2:colspan:3\\ncell:C9:b::1::1:colspan:2\\ncell:E9:b::1:::f:1:ntvf:1\\ncell:F9:b::1:::f:1:ntvf:1\\ncell:G9:b::::1\\ncell:A10:b::2:::l:3:f:7\\ncell:B10:b::1::1:f:1:cf:2:colspan:3\\ncell:C10:b::1::1:colspan:2\\ncell:E10:b::1:::f:1:ntvf:1\\ncell:F10:b::1:::f:1:ntvf:1\\ncell:G10:b::::1\\ncell:A11:b::2:::l:3:f:7\\ncell:B11:b::1::1:f:1:cf:2:colspan:3\\ncell:C11:b::1::1:colspan:2\\ncell:E11:b::1:::f:1:ntvf:1\\ncell:F11:b::1:::f:1:ntvf:1\\ncell:G11:b::::1\\ncell:A12:b::2:::l:3:f:7\\ncell:B12:b::1::1:f:1:cf:2:colspan:3\\ncell:C12:b::1::1:colspan:2\\ncell:E12:b::1:::f:1:ntvf:1\\ncell:F12:b::1:::f:1:ntvf:1\\ncell:G12:b::::1\\ncell:A13:b::2:::l:3:f:7\\ncell:B13:b::1::1:f:1:cf:2:colspan:3\\ncell:C13:b::1::1:colspan:2\\ncell:E13:b::1:::f:1:ntvf:1\\ncell:F13:b::1:::f:1:ntvf:1\\ncell:G13:b::::1\\ncell:A14:b::2:::l:3:f:7\\ncell:B14:b::1::1:f:1:cf:2:colspan:3\\ncell:C14:b::1::1:colspan:2\\ncell:E14:b::1:::f:1:ntvf:1\\ncell:F14:b::1:::f:1:ntvf:1\\ncell:G14:b::::1\\ncell:A15:b::2:::l:3:f:7\\ncell:B15:b::1::1:f:1:cf:2:colspan:3\\ncell:C15:b::1::1:colspan:2\\ncell:E15:b::1:::f:1:ntvf:1\\ncell:F15:b::1:::f:1:ntvf:1\\ncell:G15:b::::1\\ncell:A16:b::2:::l:3:f:7\\ncell:B16:b::1::1:f:1:cf:2:colspan:3\\ncell:C16:b::1::1:colspan:2\\ncell:E16:b::1:::f:1:ntvf:1\\ncell:F16:b::1:::f:1:ntvf:1\\ncell:G16:b::::1\\ncell:A17:b::2:::l:3:f:7\\ncell:B17:b::1::1:f:1:cf:2:colspan:3\\ncell:C17:b::1::1:colspan:2\\ncell:E17:b::1:::f:1:ntvf:1\\ncell:F17:b::1:::f:1:ntvf:1\\ncell:G17:b::::1\\ncell:A18:b::2:::l:3:f:5\\ncell:B18:b::1:1:1:f:1:cf:2:colspan:3\\ncell:C18:b::1:1:1:l:3:f:7:cf:2:colspan:2\\ncell:D18:b:::2::l:3:f:7:cf:2\\ncell:E18:b::1:1::f:1:ntvf:1\\ncell:F18:b::1:1::f:1:ntvf:1\\ncell:G18:b::::1\\ncell:A19:b::2:::l:3:f:7\\ncell:F19:b::1::\\ncell:G19:b::::1\\ncell:A20:b::2:::l:3:f:7\\ncell:F20:b::1::\\ncell:G20:b::::1\\ncell:A21:b::2:::l:3:f:7\\ncell:C21:t:Thank you for your business:b::1:::f:3:colspan:4\\ncell:D21:t:Thank you for your business:f:2:colspan:4\\ncell:E21:t::l:2:f:7\\ncell:F21:l:2:f:7\\ncell:G21:b::::1\\ncell:A22:b::2:::l:3:f:7\\ncell:F22:b::1::\\ncell:G22:b::::1\\ncell:A23:b::2:::l:3:f:7\\ncell:B23:b:::2::l:3:f:7\\ncell:C23:b:::2::l:3:f:7\\ncell:D23:b:::2::l:3:f:7\\ncell:E23:b:::2::l:3:f:7\\ncell:F23:b::1:1::l:3:f:7\\ncell:G23:b::::1\\ncell:B24:b:1:::\\ncell:C24:b:1:::\\ncell:D24:b:1:::\\ncell:E24:b:1:::\\ncell:F24:b:1:::\\ncol:A:w:10\\ncol:B:w:42\\ncol:C:w:56\\ncol:D:w:39\\ncol:E:w:48\\ncol:F:w:57\\nrow:1:h:14.25\\nrow:2:h:18.75\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:14.25\\nrow:6:h:14.25\\nrow:7:h:14.25\\nrow:8:h:14.25\\nrow:9:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:13:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:16:h:14.25\\nrow:17:h:14.25\\nrow:18:h:15.75\\nrow:19:h:14.25\\nrow:20:h:14.25\\nrow:21:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nsheet:c:7:r:24:h:12.75:needsrecalc:yes\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\nfont:1:* * Trebuchet MS\\nfont:2:italic bold * Trebuchet MS\\nfont:3:italic bold 10pt Trebuchet MS\\nfont:4:normal bold 10pt Arial\\nfont:5:normal bold 12pt Arial\\nfont:6:normal normal * Trebuchet MS\\nfont:7:normal normal 10pt Arial\\nfont:8:normal normal 16pt Arial\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nlayout:3:padding:* * * *;vertical-align:top;\\nvalueformat:1:#,##0.00\\n\"},\"name\":\"inv3\",\"hidden\":\"0\"},\"sheet5\":{\"sheetstr\":{\"savestr\":\"version:1.5\\ncell:B1:b:::2::l:1:f:7\\ncell:C1:b:::2::l:1:f:7\\ncell:D1:b:::2::l:1:f:7\\ncell:E1:b:::2::l:1:f:7\\ncell:F1:b:::2::l:1:f:7\\ncell:A2:b::2:::l:1:f:7\\ncell:B2:t:INVOICE DETAILS:b:1:1:1:1:l:1:f:8:cf:1:colspan:5\\ncell:C2:t::b:2::2::l:1:f:7\\ncell:D2:t::b:2::2::l:1:f:7\\ncell:E2:t::b:2::2::l:1:f:7\\ncell:F2:b:2:1:1::l:1:f:7\\ncell:G2:b::::1\\ncell:A3:b::2:::l:3:f:7\\ncell:B3:b:2::::l:1:f:7\\ncell:C3:b:2::::l:1:f:7\\ncell:D3:b:2::::l:1:f:7\\ncell:E3:b:2::::l:1:f:7\\ncell:F3:b:1:1:::l:1:f:7\\ncell:G3:b::::1\\ncell:A4:b::2:::l:3:f:7\\ncell:B4:b:::2::l:1:f:7\\ncell:C4:b:::2::l:3:f:4:cf:2\\ncell:D4:b:::2::l:1:f:7\\ncell:E4:b:::2::l:1:f:7\\ncell:F4:b::1:1::l:1:f:7\\ncell:G4:b::::1\\ncell:A5:b::2:::l:3:f:7\\ncell:B5:t:Description:b:1:1:1:1:f:6:cf:1:colspan:3\\ncell:C5:t:Description:b:2::2:2:l:3:f:4:cf:2:colspan:2:rowspan:1\\ncell:D5:t::b:2:2:2::l:1:f:7\\ncell:E5:t:Qty.:b:1:1:1:1:f:6:cf:1\\ncell:F5:t:Price:b:1:1:1:1:f:6:cf:1\\ncell:G5:b::::1\\ncell:A6:b::2:::l:3:f:7\\ncell:B6:b:1:1::1:f:1:cf:2:colspan:3\\ncell:C6:b:1:1::1:l:3:f:7:cf:2:colspan:2:rowspan:1\\ncell:D6:t::b:2:2:2::l:1:f:7\\ncell:E6:b:1:1:::f:1:ntvf:1\\ncell:F6:b:1:1:::f:1:ntvf:1\\ncell:G6:b::::1\\ncell:A7:b::2:::l:3:f:7\\ncell:B7:b::1::1:f:1:cf:2:colspan:3\\ncell:C7:b::1::1:l:1:f:7:colspan:2\\ncell:D7:l:1:f:7\\ncell:E7:b::1:::f:1:ntvf:1\\ncell:F7:b::1:::f:1:ntvf:1\\ncell:G7:b::::1\\ncell:A8:b::2:::l:3:f:7\\ncell:B8:b::1::1:f:1:cf:2:colspan:3\\ncell:C8:b::1::1:colspan:2\\ncell:E8:b::1:::f:1:ntvf:1\\ncell:F8:b::1:::f:1:ntvf:1\\ncell:G8:b::::1\\ncell:A9:b::2:::l:3:f:7\\ncell:B9:b::1::1:f:1:cf:2:colspan:3\\ncell:C9:b::1::1:colspan:2\\ncell:E9:b::1:::f:1:ntvf:1\\ncell:F9:b::1:::f:1:ntvf:1\\ncell:G9:b::::1\\ncell:A10:b::2:::l:3:f:7\\ncell:B10:b::1::1:f:1:cf:2:colspan:3\\ncell:C10:b::1::1:colspan:2\\ncell:E10:b::1:::f:1:ntvf:1\\ncell:F10:b::1:::f:1:ntvf:1\\ncell:G10:b::::1\\ncell:A11:b::2:::l:3:f:7\\ncell:B11:b::1::1:f:1:cf:2:colspan:3\\ncell:C11:b::1::1:colspan:2\\ncell:E11:b::1:::f:1:ntvf:1\\ncell:F11:b::1:::f:1:ntvf:1\\ncell:G11:b::::1\\ncell:A12:b::2:::l:3:f:7\\ncell:B12:b::1::1:f:1:cf:2:colspan:3\\ncell:C12:b::1::1:colspan:2\\ncell:E12:b::1:::f:1:ntvf:1\\ncell:F12:b::1:::f:1:ntvf:1\\ncell:G12:b::::1\\ncell:A13:b::2:::l:3:f:7\\ncell:B13:b::1::1:f:1:cf:2:colspan:3\\ncell:C13:b::1::1:colspan:2\\ncell:E13:b::1:::f:1:ntvf:1\\ncell:F13:b::1:::f:1:ntvf:1\\ncell:G13:b::::1\\ncell:A14:b::2:::l:3:f:7\\ncell:B14:b::1::1:f:1:cf:2:colspan:3\\ncell:C14:b::1::1:colspan:2\\ncell:E14:b::1:::f:1:ntvf:1\\ncell:F14:b::1:::f:1:ntvf:1\\ncell:G14:b::::1\\ncell:A15:b::2:::l:3:f:7\\ncell:B15:b::1::1:f:1:cf:2:colspan:3\\ncell:C15:b::1::1:colspan:2\\ncell:E15:b::1:::f:1:ntvf:1\\ncell:F15:b::1:::f:1:ntvf:1\\ncell:G15:b::::1\\ncell:A16:b::2:::l:3:f:7\\ncell:B16:b::1::1:f:1:cf:2:colspan:3\\ncell:C16:b::1::1:colspan:2\\ncell:E16:b::1:::f:1:ntvf:1\\ncell:F16:b::1:::f:1:ntvf:1\\ncell:G16:b::::1\\ncell:A17:b::2:::l:3:f:7\\ncell:B17:b::1::1:f:1:cf:2:colspan:3\\ncell:C17:b::1::1:colspan:2\\ncell:E17:b::1:::f:1:ntvf:1\\ncell:F17:b::1:::f:1:ntvf:1\\ncell:G17:b::::1\\ncell:A18:b::2:::l:3:f:5\\ncell:B18:b::1:1:1:f:1:cf:2:colspan:3\\ncell:C18:b::1:1:1:l:3:f:7:cf:2:colspan:2\\ncell:D18:b:::2::l:3:f:7:cf:2\\ncell:E18:b::1:1::f:1:ntvf:1\\ncell:F18:b::1:1::f:1:ntvf:1\\ncell:G18:b::::1\\ncell:A19:b::2:::l:3:f:7\\ncell:F19:b::1::\\ncell:G19:b::::1\\ncell:A20:b::2:::l:3:f:7\\ncell:F20:b::1::\\ncell:G20:b::::1\\ncell:A21:b::2:::l:3:f:7\\ncell:C21:t:Thank you for your business:b::1:::f:3:colspan:4\\ncell:D21:t:Thank you for your business:f:2:colspan:4\\ncell:E21:t::l:2:f:7\\ncell:F21:l:2:f:7\\ncell:G21:b::::1\\ncell:A22:b::2:::l:3:f:7\\ncell:F22:b::1::\\ncell:G22:b::::1\\ncell:A23:b::2:::l:3:f:7\\ncell:B23:b:::2::l:3:f:7\\ncell:C23:b:::2::l:3:f:7\\ncell:D23:b:::2::l:3:f:7\\ncell:E23:b:::2::l:3:f:7\\ncell:F23:b::1:1::l:3:f:7\\ncell:G23:b::::1\\ncell:B24:b:1:::\\ncell:C24:b:1:::\\ncell:D24:b:1:::\\ncell:E24:b:1:::\\ncell:F24:b:1:::\\ncol:A:w:10\\ncol:B:w:42\\ncol:C:w:56\\ncol:D:w:39\\ncol:E:w:48\\ncol:F:w:57\\nrow:1:h:14.25\\nrow:2:h:18.75\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:14.25\\nrow:6:h:14.25\\nrow:7:h:14.25\\nrow:8:h:14.25\\nrow:9:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:13:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:16:h:14.25\\nrow:17:h:14.25\\nrow:18:h:15.75\\nrow:19:h:14.25\\nrow:20:h:14.25\\nrow:21:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nsheet:c:7:r:24:h:12.75:needsrecalc:yes\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\nfont:1:* * Trebuchet MS\\nfont:2:italic bold * Trebuchet MS\\nfont:3:italic bold 10pt Trebuchet MS\\nfont:4:normal bold 10pt Arial\\nfont:5:normal bold 12pt Arial\\nfont:6:normal normal * Trebuchet MS\\nfont:7:normal normal 10pt Arial\\nfont:8:normal normal 16pt Arial\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nlayout:3:padding:* * * *;vertical-align:top;\\nvalueformat:1:#,##0.00\\n\"},\"name\":\"sheet7\",\"hidden\":\"0\"}},\"EditableCells\":{\"allow\":true,\"cells\":{\"inv1!B2\":true,\"inv1!C5\":true,\"inv1!C6\":true,\"inv1!C7\":true,\"inv1!C8\":true,\"inv1!C9\":true,\"inv1!C11\":true,\"inv1!C12\":true,\"inv1!C13\":true,\"inv1!C14\":true,\"inv1!C15\":true,\"inv1!C16\":true,\"inv1!C18\":true,\"inv1!C20\":true,\"inv1!D20\":true,\"inv1!C23\":true,\"inv1!C24\":true,\"inv1!C25\":true,\"inv1!C26\":true,\"inv1!C27\":true,\"inv1!C28\":true,\"inv1!C29\":true,\"inv1!C30\":true,\"inv1!C31\":true,\"inv1!C32\":true,\"inv1!C33\":true,\"inv1!C34\":true,\"inv1!C35\":true,\"inv1!F23\":true,\"inv1!F24\":true,\"inv1!F25\":true,\"inv1!F26\":true,\"inv1!F27\":true,\"inv1!F28\":true,\"inv1!F29\":true,\"inv1!F30\":true,\"inv1!F31\":true,\"inv1!F32\":true,\"inv1!F33\":true,\"inv1!F34\":true,\"inv1!F35\":true,\"inv2!B2\":true,\"inv2!F4\":true,\"inv2!G4\":true,\"inv2!B5\":true,\"inv2!B7\":true,\"inv2!B8\":true,\"inv2!B9\":true,\"inv2!B10\":true,\"inv2!B11\":true,\"inv2!B12\":true,\"inv2!B14\":true,\"inv2!B15\":true,\"inv2!B16\":true,\"inv2!B17\":true,\"inv2!B18\":true,\"inv2!B19\":true,\"inv2!B20\":true,\"inv2!B23\":true,\"inv2!B24\":true,\"inv2!B25\":true,\"inv2!B26\":true,\"inv2!B27\":true,\"inv2!B28\":true,\"inv2!B29\":true,\"inv2!B30\":true,\"inv2!B31\":true,\"inv2!B32\":true,\"inv2!B33\":true,\"inv2!B34\":true,\"inv2!B35\":true,\"inv2!G23\":true,\"inv2!G24\":true,\"inv2!G25\":true,\"inv2!G26\":true,\"inv2!G27\":true,\"inv2!G28\":true,\"inv2!G29\":true,\"inv2!G30\":true,\"inv2!G31\":true,\"inv2!G32\":true,\"inv2!G33\":true,\"inv2!G34\":true,\"inv2!G35\":true,\"inv2!B38\":true,\"inv2!B39\":true,\"inv2!B40\":true,\"inv2!F36\":true,\"inv2!G37\":true,\"inv2!F37\":true,\"inv2!F39\":true,\"inv2!G39\":true,\"inv2!F38\":true,\"sheet6!B2\":true,\"sheet6!F4\":true,\"sheet6!G4\":true,\"sheet6!B5\":true,\"sheet6!B7\":true,\"sheet6!B8\":true,\"sheet6!B9\":true,\"sheet6!B10\":true,\"sheet6!B11\":true,\"sheet6!B12\":true,\"sheet6!B14\":true,\"sheet6!B15\":true,\"sheet6!B16\":true,\"sheet6!B17\":true,\"sheet6!B18\":true,\"sheet6!B19\":true,\"sheet6!B20\":true,\"sheet6!B38\":true,\"sheet6!B39\":true,\"sheet6!B40\":true,\"sheet6!F36\":true,\"sheet6!G37\":true,\"sheet6!F37\":true,\"sheet6!F39\":true,\"sheet6!G39\":true,\"sheet6!F38\":true,\"inv3!B2\":true,\"inv3!B6\":true,\"inv3!B7\":true,\"inv3!B8\":true,\"inv3!B9\":true,\"inv3!B10\":true,\"inv3!B11\":true,\"inv3!B12\":true,\"inv3!B13\":true,\"inv3!B14\":true,\"inv3!B15\":true,\"inv3!B16\":true,\"inv3!B17\":true,\"inv3!B18\":true,\"inv3!E6\":true,\"inv3!E7\":true,\"inv3!E8\":true,\"inv3!E9\":true,\"inv3!E10\":true,\"inv3!E11\":true,\"inv3!E12\":true,\"inv3!E13\":true,\"inv3!E14\":true,\"inv3!E15\":true,\"inv3!E16\":true,\"inv3!E17\":true,\"inv3!E18\":true,\"inv3!F6\":true,\"inv3!F7\":true,\"inv3!F8\":true,\"inv3!F9\":true,\"inv3!F10\":true,\"inv3!F11\":true,\"inv3!F12\":true,\"inv3!F13\":true,\"inv3!F14\":true,\"inv3!F15\":true,\"inv3!F16\":true,\"inv3!F17\":true,\"inv3!F18\":true,\"sheet7!F6\":true,\"sheet7!F7\":true,\"sheet7!F8\":true,\"sheet7!F9\":true,\"sheet7!F10\":true,\"sheet7!F11\":true,\"sheet7!F12\":true,\"sheet7!F13\":true,\"sheet7!F14\":true,\"sheet7!F15\":true,\"sheet7!F16\":true,\"sheet7!F17\":true,\"sheet7!F18\":true,\"sheet7!E6\":true,\"sheet7!E7\":true,\"sheet7!E8\":true,\"sheet7!E9\":true,\"sheet7!E10\":true,\"sheet7!E11\":true,\"sheet7!E12\":true,\"sheet7!E13\":true,\"sheet7!E14\":true,\"sheet7!E15\":true,\"sheet7!E16\":true,\"sheet7!E17\":true,\"sheet7!E18\":true,\"sheet7!B6\":true,\"sheet7!B2\":true,\"sheet7!B7\":true,\"sheet7!B8\":true,\"sheet7!B9\":true,\"sheet7!B10\":true,\"sheet7!B11\":true,\"sheet7!B12\":true,\"sheet7!B13\":true,\"sheet7!B14\":true,\"sheet7!B15\":true,\"sheet7!B16\":true,\"sheet7!B17\":true,\"sheet7!B18\":true,\"inv1!D8\":true,\"inv1!D15\":true,\"inv1!D18\":true,\"inv2!C5\":true,\"sheet6!C5\":true},\"constraints\":{\"inv1!C5\":[\"prompttext\",\"0\",\"1e10\",\"Name\"],\"inv1!C6\":[\"prompttext\",\"0\",\"1e10\",\"Street Address\"],\"inv1!C7\":[\"prompttext\",\"0\",\"1e10\",\"City, State, Zip\"],\"inv1!C8\":[\"prompttext\",\"0\",\"1e10\",\"Phone\"],\"inv1!C9\":[\"promptemail\",\"0\",\"1e10\",\"Email\"],\"inv1!C11\":[\"prompttext\",\"0\",\"1e10\",\"From\"],\"inv1!C12\":[\"prompttext\",\"0\",\"1e10\",\"Name\"],\"inv1!C13\":[\"prompttext\",\"0\",\"1e10\",\"Street Address\"],\"inv1!C14\":[\"prompttext\",\"0\",\"1e10\",\"City, State, Zip\"],\"inv1!C15\":[\"prompttext\",\"0\",\"1e10\",\"Phone\"],\"inv1!C16\":[\"promptemail\",\"0\",\"1e10\",\"Email\"],\"inv1!C18\":[\"prompttext\",\"0\",\"1e10\",\"Invoice #\"],\"inv1!C20\":[\"prompttext\",\"0\",\"1e10\",\"Date\"],\"inv1!D20\":[\"prompttext\",\"0\",\"1e10\",\"Date\"],\"inv1!C23\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv1!C24\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv1!C25\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv1!C26\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv1!C27\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv1!C28\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv1!C29\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv1!C30\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv1!C31\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv1!C32\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv1!C33\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv1!C34\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv1!C35\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv1!F23\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv1!F24\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv1!F25\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv1!F26\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv1!F27\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv1!F28\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv1!F29\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv1!F30\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv1!F31\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv1!F32\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv1!F33\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv1!F34\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv1!F35\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv2!B2\":[\"prompttext\",\"0\",\"1e10\",\"Invoice\"],\"inv2!F4\":[\"prompttext\",\"0\",\"1e10\",\"Date\"],\"inv2!G4\":[\"prompttext\",\"0\",\"1e10\",\"Date\"],\"inv2!B5\":[\"prompttext\",\"0\",\"1e10\",\"Invoice #\"],\"inv2!B7\":[\"prompttext\",\"0\",\"1e10\",\"From\"],\"inv2!B8\":[\"prompttext\",\"0\",\"1e10\",\"Company Name\"],\"inv2!B9\":[\"prompttext\",\"0\",\"1e10\",\"Street Address\"],\"inv2!B10\":[\"prompttext\",\"0\",\"1e10\",\"City, State, Zip\"],\"inv2!B11\":[\"prompttext\",\"0\",\"1e10\",\"Phone\"],\"inv2!B12\":[\"promptemail\",\"0\",\"1e10\",\"Email\"],\"inv2!B14\":[\"prompttext\",\"0\",\"1e10\",\"Bill To\"],\"inv2!B15\":[\"prompttext\",\"0\",\"1e10\",\"Name\"],\"inv2!B16\":[\"prompttext\",\"0\",\"1e10\",\"Company Name\"],\"inv2!B17\":[\"prompttext\",\"0\",\"1e10\",\"Street Address\"],\"inv2!B18\":[\"prompttext\",\"0\",\"1e10\",\"City, State, Zip\"],\"inv2!B19\":[\"prompttext\",\"0\",\"1e10\",\"Phone\"],\"inv2!B20\":[\"promptemail\",\"0\",\"1e10\",\"Email\"],\"inv2!B23\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv2!B24\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv2!B25\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv2!B26\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv2!B27\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv2!B28\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv2!B29\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv2!B30\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv2!B31\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv2!B32\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv2!B33\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv2!B34\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv2!B35\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv2!G23\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv2!G24\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv2!G25\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv2!G26\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv2!G27\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv2!G28\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv2!G29\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv2!G30\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv2!G31\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv2!G32\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv2!G33\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv2!G34\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv2!G35\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv2!B38\":[\"prompttext\",\"0\",\"1e10\",\"Notes\"],\"inv2!B39\":[\"prompttext\",\"0\",\"1e10\",\"Notes\"],\"inv2!B40\":[\"prompttext\",\"0\",\"1e10\",\"Notes\"],\"inv2!F36\":[\"prompttext\",\"0\",\"1e10\",\"Subtotal\"],\"inv2!G37\":[\"promptdecimal\",\"0\",\"1e10\",\"Tax Rate (0.00)\"],\"inv2!F37\":[\"prompttext\",\"0\",\"1e10\",\"Tax Rate\"],\"inv2!F39\":[\"prompttext\",\"0\",\"1e10\",\"Other\"],\"inv2!G39\":[\"promptdecimal\",\"0\",\"1e10\",\"Other\"],\"inv2!F38\":[\"prompttext\",\"0\",\"1e10\",\"Tax\"],\"sheet6!B2\":[\"prompttext\",\"0\",\"1e10\",\"Invoice\"],\"sheet6!F4\":[\"prompttext\",\"0\",\"1e10\",\"Date\"],\"sheet6!G4\":[\"prompttext\",\"0\",\"1e10\",\"Date\"],\"sheet6!B5\":[\"prompttext\",\"0\",\"1e10\",\"Invoice #\"],\"sheet6!B7\":[\"prompttext\",\"0\",\"1e10\",\"From\"],\"sheet6!B8\":[\"prompttext\",\"0\",\"1e10\",\"Company Name\"],\"sheet6!B9\":[\"prompttext\",\"0\",\"1e10\",\"Street Address\"],\"sheet6!B10\":[\"prompttext\",\"0\",\"1e10\",\"City, State, Zip\"],\"sheet6!B11\":[\"prompttext\",\"0\",\"1e10\",\"Phone\"],\"sheet6!B12\":[\"promptemail\",\"0\",\"1e10\",\"Email\"],\"sheet6!B14\":[\"prompttext\",\"0\",\"1e10\",\"Bill To\"],\"sheet6!B15\":[\"prompttext\",\"0\",\"1e10\",\"Name\"],\"sheet6!B16\":[\"prompttext\",\"0\",\"1e10\",\"Company Name\"],\"sheet6!B17\":[\"prompttext\",\"0\",\"1e10\",\"Street Address\"],\"sheet6!B18\":[\"prompttext\",\"0\",\"1e10\",\"City, State, Zip\"],\"sheet6!B19\":[\"prompttext\",\"0\",\"1e10\",\"Phone\"],\"sheet6!B20\":[\"promptemail\",\"0\",\"1e10\",\"Email\"],\"sheet6!B38\":[\"prompttext\",\"0\",\"1e10\",\"Notes\"],\"sheet6!B39\":[\"prompttext\",\"0\",\"1e10\",\"Notes\"],\"sheet6!B40\":[\"prompttext\",\"0\",\"1e10\",\"Notes\"],\"sheet6!F36\":[\"prompttext\",\"0\",\"1e10\",\"Subtotal\"],\"sheet6!G37\":[\"promptdecimal\",\"0\",\"1e10\",\"Tax Rate (0.00)\"],\"sheet6!F37\":[\"prompttext\",\"0\",\"1e10\",\"Tax Rate\"],\"sheet6!F39\":[\"prompttext\",\"0\",\"1e10\",\"Other\"],\"sheet6!G39\":[\"promptdecimal\",\"0\",\"1e10\",\"Other\"],\"sheet6!F38\":[\"prompttext\",\"0\",\"1e10\",\"Tax\"],\"inv3!B6\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv3!B7\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv3!B8\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv3!B9\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv3!B10\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv3!B11\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv3!B12\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv3!B13\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv3!B14\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv3!B15\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv3!B16\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv3!B17\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv3!B18\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"sheet7!B6\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"sheet7!B7\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"sheet7!B8\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"sheet7!B9\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"sheet7!B10\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"sheet7!B11\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"sheet7!B12\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"sheet7!B13\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"sheet7!B14\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"sheet7!B15\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"sheet7!B16\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"sheet7!B17\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"sheet7!B18\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv1!D8\":[\"prompttext\",\"0\",\"1e10\",\"Phone\"],\"inv1!D15\":[\"prompttext\",\"0\",\"1e10\",\"Phone\"],\"inv1!D18\":[\"promptnumeric\",\"0\",\"1e10\",\"Invoice#\"],\"inv2!C5\":[\"promptnumeric\",\"0\",\"1e10\",\"Invoice#\"],\"sheet6!C5\":[\"promptnumeric\",\"0\",\"1e10\",\"Invoice#\"],\"sheet7!E6\":[\"promptdecimal\",\"0\",\"1e10\",\"Quantity\"],\"sheet7!E7\":[\"promptdecimal\",\"0\",\"1e10\",\"Quantity\"],\"sheet7!E8\":[\"promptdecimal\",\"0\",\"1e10\",\"Quantity\"],\"sheet7!E9\":[\"promptdecimal\",\"0\",\"1e10\",\"Quantity\"],\"sheet7!E10\":[\"promptdecimal\",\"0\",\"1e10\",\"Quantity\"],\"sheet7!E11\":[\"promptdecimal\",\"0\",\"1e10\",\"Quantity\"],\"sheet7!E12\":[\"promptdecimal\",\"0\",\"1e10\",\"Quantity\"],\"sheet7!E13\":[\"promptdecimal\",\"0\",\"1e10\",\"Quantity\"],\"sheet7!E14\":[\"promptdecimal\",\"0\",\"1e10\",\"Quantity\"],\"sheet7!E15\":[\"promptdecimal\",\"0\",\"1e10\",\"Quantity\"],\"sheet7!E16\":[\"promptdecimal\",\"0\",\"1e10\",\"Quantity\"],\"sheet7!E17\":[\"promptdecimal\",\"0\",\"1e10\",\"Quantity\"],\"sheet7!E18\":[\"promptdecimal\",\"0\",\"1e10\",\"Quantity\"],\"sheet7!F6\":[\"promptdecimal\",\"0\",\"1e10\",\"Price\"],\"sheet7!F7\":[\"promptdecimal\",\"0\",\"1e10\",\"Price\"],\"sheet7!F8\":[\"promptdecimal\",\"0\",\"1e10\",\"Price\"],\"sheet7!F9\":[\"promptdecimal\",\"0\",\"1e10\",\"Price\"],\"sheet7!F10\":[\"promptdecimal\",\"0\",\"1e10\",\"Price\"],\"sheet7!F11\":[\"promptdecimal\",\"0\",\"1e10\",\"Price\"],\"sheet7!F12\":[\"promptdecimal\",\"0\",\"1e10\",\"Price\"],\"sheet7!F13\":[\"promptdecimal\",\"0\",\"1e10\",\"Price\"],\"sheet7!F14\":[\"promptdecimal\",\"0\",\"1e10\",\"Price\"],\"sheet7!F15\":[\"promptdecimal\",\"0\",\"1e10\",\"Price\"],\"sheet7!F16\":[\"promptdecimal\",\"0\",\"1e10\",\"Price\"],\"sheet7!F17\":[\"promptdecimal\",\"0\",\"1e10\",\"Price\"],\"sheet7!F18\":[\"promptdecimal\",\"0\",\"1e10\",\"Price\"],\"inv3!E6\":[\"promptdecimal\",\"0\",\"1e10\",\"Hours\"],\"inv3!E7\":[\"promptdecimal\",\"0\",\"1e10\",\"Hours\"],\"inv3!E8\":[\"promptdecimal\",\"0\",\"1e10\",\"Hours\"],\"inv3!E9\":[\"promptdecimal\",\"0\",\"1e10\",\"Hours\"],\"inv3!E10\":[\"promptdecimal\",\"0\",\"1e10\",\"Hours\"],\"inv3!E11\":[\"promptdecimal\",\"0\",\"1e10\",\"Hours\"],\"inv3!E12\":[\"promptdecimal\",\"0\",\"1e10\",\"Hours\"],\"inv3!E13\":[\"promptdecimal\",\"0\",\"1e10\",\"Hours\"],\"inv3!E14\":[\"promptdecimal\",\"0\",\"1e10\",\"Hours\"],\"inv3!E15\":[\"promptdecimal\",\"0\",\"1e10\",\"Hours\"],\"inv3!E16\":[\"promptdecimal\",\"0\",\"1e10\",\"Hours\"],\"inv3!E17\":[\"promptdecimal\",\"0\",\"1e10\",\"Hours\"],\"inv3!E18\":[\"promptdecimal\",\"0\",\"1e10\",\"Hours\"],\"inv3!F6\":[\"promptdecimal\",\"0\",\"1e10\",\"Rate\"],\"inv3!F7\":[\"promptdecimal\",\"0\",\"1e10\",\"Rate\"],\"inv3!F8\":[\"promptdecimal\",\"0\",\"1e10\",\"Rate\"],\"inv3!F9\":[\"promptdecimal\",\"0\",\"1e10\",\"Rate\"],\"inv3!F10\":[\"promptdecimal\",\"0\",\"1e10\",\"Rate\"],\"inv3!F11\":[\"promptdecimal\",\"0\",\"1e10\",\"Rate\"],\"inv3!F12\":[\"promptdecimal\",\"0\",\"1e10\",\"Rate\"],\"inv3!F13\":[\"promptdecimal\",\"0\",\"1e10\",\"Rate\"],\"inv3!F14\":[\"promptdecimal\",\"0\",\"1e10\",\"Rate\"],\"inv3!F15\":[\"promptdecimal\",\"0\",\"1e10\",\"Rate\"],\"inv3!F16\":[\"promptdecimal\",\"0\",\"1e10\",\"Rate\"],\"inv3!F17\":[\"promptdecimal\",\"0\",\"1e10\",\"Rate\"],\"inv3!F18\":[\"promptdecimal\",\"0\",\"1e10\",\"Rate\"]}}},\n        \t\"footers\": [{name: 'Type1' , index: 1, isActive: true }, {name: 'Type2' , index: 2, isActive: false}, \n                        {name: 'Type3' , index: 3, isActive: false}, {name: 'Detail1' , index: 4, isActive: false}, \n                        {name: 'Detail2' , index: 5, isActive: false}]\n        }\n    },\n    \"home\":{\n        \"iPad\":{\n        \t\"msc\": {\"numsheets\":4,\"currentid\":\"sheet1\",\"currentname\":\"typei\",\"sheetArr\":{\"sheet1\":{\"sheetstr\":{\"savestr\":\"version:1.5\\ncell:A2:b::2:::l:1:f:7\\ncell:B2:t:INVOICE:b:1:1:1:1:f:6:cf:1:colspan:6\\ncell:C2:t::b:2::2::l:1:f:7\\ncell:D2:t::b:2::2::l:1:f:7\\ncell:E2:t::b:2::2::l:1:f:7\\ncell:F2:t::b:2::2::l:1:f:7\\ncell:G2:t::b:2::2::l:1:f:7\\ncell:A3:b::2:::l:3:f:7\\ncell:B3:b:2:::2:l:3:f:7\\ncell:C3:b:2::::l:1:f:7\\ncell:D3:b:2::::l:1:f:7\\ncell:E3:b:2::::l:1:f:7\\ncell:F3:b:2::::l:1:f:7\\ncell:G3:b:2:2:::l:3:f:7\\ncell:A4:b::2:::l:3:f:7\\ncell:B4:b::::2:l:3:f:3\\ncell:C4:t:INVOICE # \\\\c:f:2:cf:2\\ncell:D4:v:1:f:2:cf:2\\ncell:F4:tvf:4:rowspan:4\\ncell:G4:b::2:::l:3:f:7\\ncell:A5:b::2:::l:3:f:7\\ncell:B5:b::::2:l:3:f:4\\ncell:F5:t::l:2:f:7\\ncell:G5:t::b::1:::l:2:f:7\\ncell:A6:b::2:::l:3:f:7\\ncell:B6:b::::2:l:3:f:4\\ncell:C6:t:INVOICE DATE\\\\c:f:2:cf:2\\ncell:D6:f:2:cf:2:ntvf:3\\ncell:F6:l:2:f:7\\ncell:G6:b::1:::l:2:f:7\\ncell:A7:b::2:::l:3:f:7\\ncell:B7:b::::2:l:3:f:4\\ncell:G7:b::2:::l:3:f:7\\ncell:A8:b::2:::l:3:f:7\\ncell:B8:b::::2:l:3:f:4\\ncell:G8:b::2:::l:3:f:7\\ncell:A9:b::2:::l:3:f:7\\ncell:B9:b::::2:l:3:f:4\\ncell:C9:t:BILL TO\\\\c:l:3:f:2\\ncell:E9:t:FROM\\\\c:f:2:cf:2\\ncell:G9:b::2:::l:3:f:7\\ncell:A10:b::2:::l:3:f:7\\ncell:B10:b::::2:l:3:f:3\\ncell:C10:t:[Name]:f:1:cf:2:colspan:2\\ncell:E10:t:[Name]:f:1:cf:2:colspan:2\\ncell:G10:b::2:::l:3:f:7\\ncell:A11:b::2:::l:3:f:7\\ncell:B11:b::::2:l:3:f:7\\ncell:C11:t:[Street Address]:f:1:cf:2:colspan:2\\ncell:E11:t:[Street Address]:f:1:cf:2:colspan:2\\ncell:G11:b::2:::l:3:f:7\\ncell:A12:b::2:::l:3:f:7\\ncell:B12:b::::2:l:3:f:7\\ncell:C12:t:[City, State, Zip]:f:1:cf:2:colspan:2\\ncell:E12:t:[City, State, Zip]:f:1:cf:2:colspan:2\\ncell:G12:b::2:::l:3:f:7\\ncell:A13:b::2:::l:3:f:7\\ncell:B13:b::::2:l:3:f:7\\ncell:C13:t:Phone\\\\c:f:1:cf:2:colspan:2\\ncell:E13:t:Phone\\\\c:f:1:cf:2:colspan:2\\ncell:G13:b::2:::l:3:f:7\\ncell:A14:b::2:::l:3:f:7\\ncell:B14:b::::2:l:3:f:3:cf:2\\ncell:C14:b:::2::l:1:f:7\\ncell:D14:b:::2::l:3:f:3:cf:2\\ncell:E14:b:::2::l:1:f:7\\ncell:F14:b:::2::l:1:f:7\\ncell:G14:b::2:::l:3:f:7\\ncell:A15:b::2:::l:3:f:7\\ncell:B15:b::2::2:l:3:f:7\\ncell:C15:t:Description:b:1::1:1:f:2:cf:1:colspan:3\\ncell:D15:t:Description:b:1::1::l:3:f:3:cf:2:colspan:2:rowspan:1\\ncell:E15:t::b:2:2:2::l:1:f:7\\ncell:F15:t:Amount:b:1:1:1:1:f:2:cf:1\\ncell:G15:b::2::2:l:3:f:7\\ncell:A16:b::2:::l:3:f:7\\ncell:B16:b::2::2:l:3:f:7\\ncell:C16:b:1:1::1:f:1:cf:2:colspan:3\\ncell:D16:b:1:1:::l:3:f:7:cf:2:colspan:2:rowspan:1\\ncell:E16:t::b:2:2:2::l:1:f:7\\ncell:F16:b:1:1:::f:1:ntvf:1\\ncell:G16:b::2::2:l:3:f:7\\ncell:A17:b::2:::l:3:f:7\\ncell:B17:b::2::2:l:3:f:7:cf:2\\ncell:C17:b::1::1:f:1:cf:2:colspan:3\\ncell:D17:b::1:::l:1:f:7:colspan:2\\ncell:E17:l:1:f:7\\ncell:F17:b::1:::f:1:ntvf:1\\ncell:G17:b::2::2:l:3:f:7\\ncell:A18:b::2:::l:3:f:7\\ncell:B18:b::2::2:l:3:f:7:cf:2:ntvf:2\\ncell:C18:b::1::1:f:1:cf:2:colspan:3\\ncell:D18:b::1:::colspan:2\\ncell:F18:b::1:::f:1:ntvf:1\\ncell:G18:b::2::2:l:3:f:7\\ncell:A19:b::2:::l:3:f:7\\ncell:B19:b::2::2:l:3:f:7:cf:2:ntvf:2\\ncell:C19:b::1::1:f:1:cf:2:colspan:3\\ncell:D19:b::1:::colspan:2\\ncell:F19:b::1:::f:1:ntvf:1\\ncell:G19:b::2::2:l:3:f:7\\ncell:A20:b::2:::l:3:f:7\\ncell:B20:b::2::2:l:3:f:7:cf:2:ntvf:2\\ncell:C20:b::1::1:f:1:cf:2:colspan:3\\ncell:D20:b::1:::colspan:2\\ncell:F20:b::1:::f:1:ntvf:1\\ncell:G20:b::2::2:l:3:f:7\\ncell:A21:b::2:::l:3:f:7\\ncell:B21:b::2::2:l:3:f:7:cf:2:ntvf:2\\ncell:C21:b::1::1:f:1:cf:2:colspan:3\\ncell:D21:b::1:::colspan:2\\ncell:F21:b::1:::f:1:ntvf:1\\ncell:G21:b::2::2:l:3:f:7\\ncell:A22:b::2:::l:3:f:7\\ncell:B22:b::2::2:l:3:f:7:cf:2:ntvf:2\\ncell:C22:b::1::1:f:1:cf:2:colspan:3\\ncell:D22:b::1:::colspan:2\\ncell:F22:b::1:::f:1:ntvf:1\\ncell:G22:b::2::2:l:3:f:7\\ncell:A23:b::2:::l:3:f:7\\ncell:B23:b::2::2:l:3:f:7:cf:2\\ncell:C23:b::1::1:f:1:cf:2:colspan:3\\ncell:D23:b::1:::colspan:2\\ncell:F23:b::1:::f:1:ntvf:1\\ncell:G23:b::2::2:l:3:f:7\\ncell:A24:b::2:::l:3:f:7\\ncell:B24:b::2::2:l:3:f:7:cf:2\\ncell:C24:b::1::1:f:1:cf:2:colspan:3\\ncell:D24:b::1:::colspan:2\\ncell:F24:b::1:::f:1:ntvf:1\\ncell:G24:b::2::2:l:3:f:7\\ncell:A25:b::2:::l:3:f:7\\ncell:B25:b::2::2:l:3:f:7:cf:2\\ncell:C25:b::1::1:f:1:cf:2:colspan:3\\ncell:D25:b::1:::colspan:2\\ncell:F25:b::1:::f:1:ntvf:1\\ncell:G25:b::2::2:l:3:f:7\\ncell:A26:b::2:::l:3:f:7\\ncell:B26:b::2::2:l:3:f:7:cf:2\\ncell:C26:b::1::1:f:1:cf:2:colspan:3\\ncell:D26:b::1:::colspan:2\\ncell:F26:b::1:::f:1:ntvf:1\\ncell:G26:b::2::2:l:3:f:7\\ncell:A27:b::2:::l:3:f:7\\ncell:B27:b::2::2:l:3:f:7:cf:2\\ncell:C27:b::1::1:f:1:cf:2:colspan:3\\ncell:D27:b::1:::colspan:2\\ncell:F27:b::1:::f:1:ntvf:1\\ncell:G27:b::2::2:l:3:f:7\\ncell:A28:b::2:::l:3:f:4\\ncell:B28:b::2::2:l:3:f:7:cf:2\\ncell:C28:b::1:1:1:f:1:cf:2:colspan:3\\ncell:D28:b::1:1::l:3:f:7:cf:2:colspan:2\\ncell:E28:b:::2::l:3:f:7:cf:2\\ncell:F28:b::1:1::f:1:ntvf:1\\ncell:G28:b::2::2:l:3:f:7\\ncell:A29:b::2:::l:3:f:3\\ncell:B29:b::2::2:l:3:f:3\\ncell:C29:t:TOTAL:b:1:1:1:1:f:5:cf:2:colspan:3\\ncell:D29:b:2::2::l:3:f:8:cf:2\\ncell:E29:b:2:2:2::l:3:f:8:cf:2\\ncell:F29:vtf:n:0:SUM(F16\\\\cF28):b:1:1:1::f:5:ntvf:1\\ncell:G29:b::2::2:l:3:f:4\\ncell:A30:b::2:::l:3:f:7\\ncell:B30:b::::2:l:3:f:3:cf:2\\ncell:C30:b:2::::l:1:f:7\\ncell:D30:b:2::::l:1:f:7\\ncell:E30:b:2::::l:1:f:7\\ncell:F30:b:2::::l:1:f:7\\ncell:G30:b::2:::l:3:f:3\\ncell:A31:b::2:::l:3:f:7\\ncell:B31:b::::2:l:3:f:7\\ncell:D31:tvf:4:rowspan:4\\ncell:G31:b::2:::l:3:f:7\\ncell:A32:b::2:::l:3:f:7\\ncell:B32:b::::2:l:3:f:7\\ncell:G32:b::2:::l:3:f:7\\ncell:A33:b::2:::l:3:f:7\\ncell:B33:b::::2:l:3:f:7\\ncell:G33:b::2:::l:3:f:7\\ncell:A34:b::2:::l:3:f:7\\ncell:B34:b::::2:l:3:f:7\\ncell:G34:b::2:::l:3:f:7\\ncell:A35:b::2:::l:3:f:7\\ncell:B35:b:::2:2:l:3:f:7\\ncell:C35:b:::2::l:3:f:7\\ncell:D35:b:::2::l:3:f:7\\ncell:E35:b:::2::l:3:f:7\\ncell:F35:b:::2::l:3:f:7\\ncell:G35:b::2:2::l:3:f:7\\ncell:B36:b:1:::\\ncell:C36:b:1:::\\ncell:D36:b:1:::\\ncell:E36:b:1:::\\ncell:F36:b:1:::\\ncell:G36:b:1:::\\ncol:A:w:10\\ncol:B:w:42\\ncol:C:w:105\\ncol:D:w:182\\ncol:E:w:110\\ncol:F:w:115\\ncol:G:w:65\\nrow:1:h:14.25\\nrow:2:h:18.75\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:15.75\\nrow:6:h:15.75\\nrow:7:h:15.75\\nrow:8:h:15.75\\nrow:9:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:13:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:16:h:14.25\\nrow:17:h:14.25\\nrow:18:h:14.25\\nrow:19:h:14.25\\nrow:20:h:14.25\\nrow:21:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nrow:24:h:14.25\\nrow:25:h:14.25\\nrow:26:h:14.25\\nrow:27:h:14.25\\nrow:28:h:15.75\\nrow:29:h:15.75\\nrow:30:h:14.25\\nrow:31:h:14.25\\nrow:32:h:14.25\\nrow:33:h:14.25\\nrow:34:h:14.25\\nrow:35:h:14.25\\nsheet:c:7:r:36:h:12.75\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\nfont:1:* * Trebuchet MS\\nfont:2:normal bold * Trebuchet MS\\nfont:3:normal bold 10pt Arial\\nfont:4:normal bold 12pt Arial\\nfont:5:normal bold 12pt Trebuchet MS\\nfont:6:normal bold 14pt Trebuchet MS\\nfont:7:normal normal 10pt Arial\\nfont:8:normal normal 12pt Arial\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nlayout:3:padding:* * * *;vertical-align:top;\\nvalueformat:1:#,##0.00\\nvalueformat:2:d-mmm\\nvalueformat:3:m/d/yy\\nvalueformat:4:text-html\\n\"},\"name\":\"typei\",\"hidden\":\"0\"},\"sheet2\":{\"sheetstr\":{\"savestr\":\"version:1.5\\ncell:A2:b::2:::l:1:f:7\\ncell:B2:t:INVOICE:b:1:1:1:1:l:3:f:6:cf:1:colspan:8\\ncell:C2:t::b:2::2::l:1:f:7\\ncell:D2:t::b:2::2::l:1:f:7\\ncell:E2:t::b:2::2::l:1:f:7\\ncell:F2:t::b:2::2::l:1:f:7\\ncell:G2:b:2::2::l:1:f:7\\ncell:H2:b:2::2::l:1:f:7\\ncell:I2:t::b:2::2::l:1:f:7\\ncell:A3:b::2:::l:3:f:7\\ncell:B3:b:2:::2:l:3:f:7\\ncell:E3:b:2::::l:1:f:7\\ncell:F3:b:2::::l:1:f:7\\ncell:G3:b:2::::l:1:f:7\\ncell:H3:b:2::::l:1:f:7\\ncell:I3:b:2:2:::l:3:f:7\\ncell:A4:b::2:::l:3:f:7\\ncell:B4:b::::2:l:3:f:3\\ncell:C4:t:INVOICE # \\\\c:f:2:cf:2\\ncell:D4:v:1:f:2:cf:2\\ncell:F4:tvf:5:colspan:2:rowspan:4\\ncell:I4:b::2:::l:3:f:7\\ncell:A5:b::2:::l:3:f:7\\ncell:B5:b::::2:l:3:f:4\\ncell:F5:t::l:2:f:7\\ncell:G5:l:2:f:7\\ncell:H5:l:2:f:7\\ncell:I5:t::b::1:::l:2:f:7\\ncell:A6:b::2:::l:3:f:7\\ncell:B6:b::::2:l:3:f:4\\ncell:C6:t:INVOICE DATE\\\\c:f:2:cf:2\\ncell:D6:f:2:cf:2:ntvf:4\\ncell:F6:l:2:f:7\\ncell:G6:l:2:f:7\\ncell:H6:l:2:f:7\\ncell:I6:b::1:::l:2:f:7\\ncell:A7:b::2:::l:3:f:7\\ncell:B7:b::::2:l:3:f:4\\ncell:I7:b::2:::l:3:f:7\\ncell:A8:b::2:::l:3:f:7\\ncell:B8:b::::2:l:3:f:4\\ncell:I8:b::2:::l:3:f:7\\ncell:A9:b::2:::l:3:f:7\\ncell:B9:b::::2:l:3:f:4\\ncell:C9:t:BILL TO\\\\c:f:2\\ncell:E9:t:FROM\\\\c:f:2:cf:2\\ncell:F9:colspan:3\\ncell:I9:b::2:::l:3:f:7\\ncell:A10:b::2:::l:3:f:7\\ncell:B10:b::::2:l:3:f:3\\ncell:C10:t:[Name]:f:1:cf:2:colspan:2\\ncell:E10:t:[Name]:f:1:cf:2:colspan:4\\ncell:I10:b::2:::l:3:f:7\\ncell:A11:b::2:::l:3:f:7\\ncell:B11:b::::2:l:3:f:7\\ncell:C11:t:[Street Address]:f:1:cf:2:colspan:2\\ncell:E11:t:[Street Address]:f:1:colspan:4\\ncell:I11:b::2:::l:3:f:7\\ncell:A12:b::2:::l:3:f:7\\ncell:B12:b::::2:l:3:f:7\\ncell:C12:t:[City, State, Zip]:f:1:cf:2:colspan:2\\ncell:E12:t:[City, State, Zip]:f:1:cf:2:colspan:4\\ncell:I12:b::2:::l:3:f:7\\ncell:A13:b::2:::l:3:f:7\\ncell:B13:b::::2:l:3:f:7\\ncell:C13:t:Phone\\\\c :f:1:cf:2:colspan:2\\ncell:E13:t:Phone\\\\c :f:1:cf:2:colspan:4\\ncell:I13:b::2:::l:3:f:7\\ncell:A14:b::2:::l:3:f:7\\ncell:B14:b::::2:l:3:f:3:cf:2\\ncell:C14:b:::2::l:1:f:7\\ncell:D14:b:::2::l:3:f:3:cf:2\\ncell:E14:b:::2::l:1:f:7\\ncell:F14:b:::2::l:1:f:7\\ncell:G14:b:::2::l:1:f:7\\ncell:H14:b:::2::l:1:f:7\\ncell:I14:b::2:::l:3:f:7\\ncell:A15:b::2:::l:3:f:7\\ncell:B15:b::2::2:l:3:f:7\\ncell:C15:t:Description:b:1:1:1:1:f:2:cf:1:colspan:3\\ncell:D15:t:Description:b:2::2:2:l:3:f:3:cf:2:colspan:2:rowspan:1\\ncell:E15:t::b:2:2:2::l:1:f:7\\ncell:F15:t:Hours:b:1:1:1:1:f:2:cf:1\\ncell:G15:t:Rate:b:1:1:1:1:f:2:cf:1\\ncell:H15:t:Amount:b:1:1:1:1:f:2:cf:1\\ncell:I15:b::2::2:l:3:f:7\\ncell:A16:b::2:::l:3:f:7\\ncell:B16:b::2::2:l:3:f:7\\ncell:C16:b:1:1::1:f:1:cf:2:colspan:3\\ncell:D16:b:1:1::1:l:3:f:7:cf:2:colspan:2:rowspan:1\\ncell:E16:t::b:2:2:2::l:1:f:7\\ncell:F16:b:1:1:::f:1:ntvf:1\\ncell:G16:b:1:1:::f:1:ntvf:1\\ncell:H16:vtf:t::IF(F16*G16>0,F16*G16,\\\"\\\"):b:1:1:::f:1:ntvf:1\\ncell:I16:b::2::2:l:3:f:7\\ncell:A17:b::2:::l:3:f:7\\ncell:B17:b::2::2:l:3:f:7:cf:2\\ncell:C17:b::1::1:f:1:cf:2:colspan:3\\ncell:D17:b::1::1:l:1:f:7:colspan:2\\ncell:E17:l:1:f:7\\ncell:F17:b::1:::f:1:ntvf:1\\ncell:G17:b::1:::f:1:ntvf:1\\ncell:H17:vtf:t::IF(F17*G17>0,F17*G17,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I17:b::2::2:l:3:f:7\\ncell:A18:b::2:::l:3:f:7\\ncell:B18:b::2::2:l:3:f:7:cf:2:ntvf:3\\ncell:C18:b::1::1:f:1:cf:2:colspan:3\\ncell:D18:b::1::1:colspan:2\\ncell:F18:b::1:::f:1:ntvf:1\\ncell:G18:b::1:::f:1:ntvf:1\\ncell:H18:vtf:t::IF(F18*G18>0,F18*G18,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I18:b::2::2:l:3:f:7\\ncell:A19:b::2:::l:3:f:7\\ncell:B19:b::2::2:l:3:f:7:cf:2:ntvf:3\\ncell:C19:b::1::1:f:1:cf:2:colspan:3\\ncell:D19:b::1::1:colspan:2\\ncell:F19:b::1:::f:1:ntvf:1\\ncell:G19:b::1:::f:1:ntvf:1\\ncell:H19:vtf:t::IF(F19*G19>0,F19*G19,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I19:b::2::2:l:3:f:7\\ncell:A20:b::2:::l:3:f:7\\ncell:B20:b::2::2:l:3:f:7:cf:2:ntvf:3\\ncell:C20:b::1::1:f:1:cf:2:colspan:3\\ncell:D20:b::1::1:colspan:2\\ncell:F20:b::1:::f:1:ntvf:1\\ncell:G20:b::1:::f:1:ntvf:1\\ncell:H20:vtf:t::IF(F20*G20>0,F20*G20,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I20:b::2::2:l:3:f:7\\ncell:A21:b::2:::l:3:f:7\\ncell:B21:b::2::2:l:3:f:7:cf:2:ntvf:3\\ncell:C21:b::1::1:f:1:cf:2:colspan:3\\ncell:D21:b::1::1:colspan:2\\ncell:F21:b::1:::f:1:ntvf:1\\ncell:G21:b::1:::f:1:ntvf:1\\ncell:H21:vtf:t::IF(F21*G21>0,F21*G21,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I21:b::2::2:l:3:f:7\\ncell:A22:b::2:::l:3:f:7\\ncell:B22:b::2::2:l:3:f:7:cf:2:ntvf:3\\ncell:C22:b::1::1:f:1:cf:2:colspan:3\\ncell:D22:b::1::1:colspan:2\\ncell:F22:b::1:::f:1:ntvf:1\\ncell:G22:b::1:::f:1:ntvf:1\\ncell:H22:vtf:t::IF(F22*G22>0,F22*G22,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I22:b::2::2:l:3:f:7\\ncell:A23:b::2:::l:3:f:7\\ncell:B23:b::2::2:l:3:f:7:cf:2\\ncell:C23:b::1::1:f:1:cf:2:colspan:3\\ncell:D23:b::1::1:colspan:2\\ncell:F23:b::1:::f:1:ntvf:1\\ncell:G23:b::1:::f:1:ntvf:1\\ncell:H23:vtf:t::IF(F23*G23>0,F23*G23,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I23:b::2::2:l:3:f:7\\ncell:A24:b::2:::l:3:f:7\\ncell:B24:b::2::2:l:3:f:7:cf:2\\ncell:C24:b::1::1:f:1:cf:2:colspan:3\\ncell:D24:b::1::1:colspan:2\\ncell:F24:b::1:::f:1:ntvf:1\\ncell:G24:b::1:::f:1:ntvf:1\\ncell:H24:vtf:t::IF(F24*G24>0,F24*G24,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I24:b::2::2:l:3:f:7\\ncell:A25:b::2:::l:3:f:7\\ncell:B25:b::2::2:l:3:f:7:cf:2\\ncell:C25:b::1::1:f:1:cf:2:colspan:3\\ncell:D25:b::1::1:colspan:2\\ncell:F25:b::1:::f:1:ntvf:1\\ncell:G25:b::1:::f:1:ntvf:1\\ncell:H25:vtf:t::IF(F25*G25>0,F25*G25,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I25:b::2::2:l:3:f:7\\ncell:A26:b::2:::l:3:f:7\\ncell:B26:b::2::2:l:3:f:7:cf:2\\ncell:C26:b::1::1:f:1:cf:2:colspan:3\\ncell:D26:b::1::1:colspan:2\\ncell:F26:b::1:::f:1:ntvf:1\\ncell:G26:b::1:::f:1:ntvf:1\\ncell:H26:vtf:t::IF(F26*G26>0,F26*G26,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I26:b::2::2:l:3:f:7\\ncell:A27:b::2:::l:3:f:7\\ncell:B27:b::2::2:l:3:f:7:cf:2\\ncell:C27:b::1::1:f:1:cf:2:colspan:3\\ncell:D27:b::1::1:colspan:2\\ncell:F27:b::1:::f:1:ntvf:1\\ncell:G27:b::1:::f:1:ntvf:1\\ncell:H27:vtf:t::IF(F27*G27>0,F27*G27,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I27:b::2::2:l:3:f:7\\ncell:A28:b::2:::l:3:f:4\\ncell:B28:b::2::2:l:3:f:7:cf:2\\ncell:C28:b::1:1:1:f:1:cf:2:colspan:3\\ncell:D28:b::1:1:1:l:3:f:7:cf:2:colspan:2\\ncell:E28:b:::2::l:3:f:7:cf:2\\ncell:F28:b::1:1::f:1:ntvf:1\\ncell:G28:b::1:1::f:1:ntvf:1\\ncell:H28:vtf:t::IF(F28*G28>0,F28*G28,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I28:b::2::2:l:3:f:7\\ncell:A29:b::2:::l:3:f:3\\ncell:B29:b::2::2:l:3:f:3\\ncell:C29:t:TOTAL:b:1:1:1:1:l:3:f:5:cf:2:colspan:5\\ncell:D29:b:2::2::l:3:f:8:cf:2\\ncell:E29:b:2:2:2::l:3:f:8:cf:2\\ncell:F29:vtf:n:0:SUM(F16\\\\cF28):b:2:2:2::l:3:f:4:ntvf:2\\ncell:G29:b:2:2:2::l:3:f:4:ntvf:2\\ncell:H29:vtf:n:0:SUM(H16\\\\cH28):b:1:1:1::f:5:ntvf:1\\ncell:I29:b::2::2:l:3:f:4\\ncell:A30:b::2:::l:3:f:7\\ncell:B30:b::::2:l:3:f:3:cf:2\\ncell:C30:b:2::::l:1:f:7\\ncell:D30:b:2::::l:1:f:7\\ncell:E30:b:2::::l:1:f:7\\ncell:F30:b:2::::l:1:f:7\\ncell:G30:b:2::::l:1:f:7\\ncell:H30:b:2::::l:1:f:7\\ncell:I30:b::2:::l:3:f:3\\ncell:A31:b::2:::l:3:f:7\\ncell:B31:b::::2:l:3:f:7\\ncell:D31:tvf:5:rowspan:4\\ncell:I31:b::2:::l:3:f:7\\ncell:A32:b::2:::l:3:f:7\\ncell:B32:b::::2:l:3:f:7\\ncell:I32:b::2:::l:3:f:7\\ncell:A33:b::2:::l:3:f:7\\ncell:B33:b::::2:l:3:f:7\\ncell:I33:b::2:::l:3:f:7\\ncell:A34:b::2:::l:3:f:7\\ncell:B34:b::::2:l:3:f:7\\ncell:I34:b::2:::l:3:f:7\\ncell:A35:b::2:::l:3:f:7\\ncell:B35:b:::2:2:l:3:f:7\\ncell:C35:b:::2::l:3:f:7\\ncell:D35:b:::2::l:3:f:7\\ncell:E35:b:::2::l:3:f:7\\ncell:F35:b:::2::l:3:f:7\\ncell:G35:b:::2::l:3:f:7\\ncell:H35:b:::2::l:3:f:7\\ncell:I35:b::2:2::l:3:f:7\\ncell:B36:b:1:::\\ncell:C36:b:1:::\\ncell:D36:b:1:::\\ncell:E36:b:1:::\\ncell:F36:b:1:::\\ncell:G36:b:1:::\\ncell:H36:b:1:::\\ncell:I36:b:1:::\\ncol:A:w:26\\ncol:B:w:28\\ncol:C:w:96\\ncol:D:w:203\\ncol:E:w:51\\ncol:F:w:50\\ncol:G:w:58\\ncol:H:w:80\\ncol:I:w:28\\nrow:1:h:14.25\\nrow:2:h:18.75\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:15.75\\nrow:6:h:15.75\\nrow:7:h:15.75\\nrow:8:h:15.75\\nrow:9:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:13:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:16:h:14.25\\nrow:17:h:14.25\\nrow:18:h:14.25\\nrow:19:h:14.25\\nrow:20:h:14.25\\nrow:21:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nrow:24:h:14.25\\nrow:25:h:14.25\\nrow:26:h:14.25\\nrow:27:h:14.25\\nrow:28:h:15.75\\nrow:29:h:15.75\\nrow:30:h:14.25\\nrow:31:h:14.25\\nrow:32:h:14.25\\nrow:33:h:14.25\\nrow:34:h:14.25\\nrow:35:h:14.25\\nsheet:c:9:r:36:h:12.75\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\nfont:1:* * Trebuchet MS\\nfont:2:normal bold * Trebuchet MS\\nfont:3:normal bold 10pt Arial\\nfont:4:normal bold 12pt Arial\\nfont:5:normal bold 12pt Trebuchet MS\\nfont:6:normal bold 14pt Trebuchet MS\\nfont:7:normal normal 10pt Arial\\nfont:8:normal normal 12pt Arial\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nlayout:3:padding:* * * *;vertical-align:top;\\nvalueformat:1:#,##0.00\\nvalueformat:2:#,##0.00;(#,##0.00)\\nvalueformat:3:d-mmm\\nvalueformat:4:m/d/yy\\nvalueformat:5:text-html\\n\"},\"name\":\"typeii\",\"hidden\":\"0\"},\"sheet3\":{\"sheetstr\":{\"savestr\":\"version:1.5\\ncell:A1:l:3\\ncell:B2:t:[Company Name]:l:1:f:3:cf:2:colspan:3\\ncell:C2:t::l:2:f:9\\ncell:D2:t::l:2:f:9\\ncell:E2:l:1:f:7:c:2:cf:3\\ncell:F2:t:INVOICE:l:1:f:7:c:2:cf:2:colspan:2\\ncell:G2:t::l:2:f:9\\ncell:B3:t:[Company Slogan]:f:4:cf:2:colspan:3\\ncell:C3:t::l:2:f:9\\ncell:D3:t::l:2:f:9\\ncell:B4:f:2:colspan:2\\ncell:F4:tvf:4:rowspan:4\\ncell:B5:t:[Street Address]:f:1:cf:2:colspan:2\\ncell:F5:l:1:f:6\\ncell:G5:l:1:f:10:cf:1\\ncell:B6:t:[City, State,  Zip]:f:1:cf:2:colspan:2\\ncell:G6:l:1:f:9\\ncell:B7:t:Phone\\\\c :f:1:cf:2:colspan:2\\ncell:B8:t:Email\\\\c:f:1:cf:2:colspan:2\\ncell:B9:colspan:2\\ncell:F9:t:DATE \\\\c:l:1:f:6:cf:2\\ncell:G9:l:1:f:10:cf:2:ntvf:3\\ncell:B10:t:BILL TO\\\\c:f:5:c:1:bg:3:cf:2:colspan:2\\ncell:F10:t:INVOICE # \\\\c:l:1:f:6:cf:2\\ncell:G10:v:1:l:1:f:10:cf:2\\ncell:B11:t:[Name]:f:1:cf:2:colspan:2\\ncell:B12:t:[Company Name]:f:1:cf:2:colspan:2\\ncell:F12:t:  \\ncell:B13:t:[Street Address]:f:1:cf:2:colspan:2\\ncell:B14:t:[City, State,  Zip]:f:1:cf:2:colspan:2\\ncell:B15:t:Phone\\\\c :f:1:cf:2:colspan:2\\ncell:A17:b::1::\\ncell:B17:t:DESCRIPTION:b:1:1:1:1:l:1:f:6:c:1:bg:3:cf:1:colspan:5:rowspan:1\\ncell:C17:t::l:2:f:9\\ncell:D17:t::l:2:f:9\\ncell:E17:t::l:2:f:9\\ncell:F17:t::l:2:f:9\\ncell:G17:t:AMOUNT:b:1:1:1::l:1:f:6:c:1:bg:3:cf:1\\ncell:A18:b::1::\\ncell:B18:b:1:1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C18:t::l:2:f:9\\ncell:D18:t::l:2:f:9\\ncell:E18:t::l:2:f:9\\ncell:F18:t::b::2:::l:1:f:9\\ncell:G18:b::1::1:f:1:ntvf:1\\ncell:A19:b::1::\\ncell:B19:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C19:t::l:2:f:9\\ncell:D19:t::l:2:f:9\\ncell:E19:t::l:2:f:9\\ncell:F19:t::b::2:::l:1:f:9\\ncell:G19:b::1::1:f:1:ntvf:1\\ncell:A20:b::1::\\ncell:B20:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C20:t::l:2:f:9\\ncell:D20:t::l:2:f:9\\ncell:E20:t::l:2:f:9\\ncell:F20:t::b::2:::l:1:f:9\\ncell:G20:b::1::1:f:1:ntvf:1\\ncell:A21:b::1::\\ncell:B21:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C21:t::l:2:f:9\\ncell:D21:t::l:2:f:9\\ncell:E21:t::l:2:f:9\\ncell:F21:t::b::2:::l:1:f:9\\ncell:G21:b::1::1:f:1:ntvf:1\\ncell:A22:b::1::\\ncell:B22:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C22:t::l:2:f:9\\ncell:D22:t::l:2:f:9\\ncell:E22:t::l:2:f:9\\ncell:F22:t::b::2:::l:1:f:9\\ncell:G22:b::1::1:f:1:ntvf:1\\ncell:A23:b::1::\\ncell:B23:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C23:t::l:2:f:9\\ncell:D23:t::l:2:f:9\\ncell:E23:t::l:2:f:9\\ncell:F23:t::b::2:::l:1:f:9\\ncell:G23:b::1::1:f:1:ntvf:1\\ncell:A24:b::1::\\ncell:B24:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C24:t::l:2:f:9\\ncell:D24:t::l:2:f:9\\ncell:E24:t::l:2:f:9\\ncell:F24:t::b::2:::l:1:f:9\\ncell:G24:b::1::1:f:1:ntvf:1\\ncell:A25:b::1::\\ncell:B25:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C25:t::l:2:f:9\\ncell:D25:t::l:2:f:9\\ncell:E25:t::l:2:f:9\\ncell:F25:t::b::2:::l:1:f:9\\ncell:G25:b::1::1:f:1:ntvf:1\\ncell:A26:b::1::\\ncell:B26:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C26:t::l:2:f:9\\ncell:D26:t::l:2:f:9\\ncell:E26:t::l:2:f:9\\ncell:F26:t::b::2:::l:1:f:9\\ncell:G26:b::1::1:f:1:ntvf:1\\ncell:A27:b::1::\\ncell:B27:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C27:t::l:2:f:9\\ncell:D27:t::l:2:f:9\\ncell:E27:t::l:2:f:9\\ncell:F27:t::b::2:::l:1:f:9\\ncell:G27:b::1::1:f:1:ntvf:1\\ncell:A28:b::1::\\ncell:B28:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C28:t::l:2:f:9\\ncell:D28:t::l:2:f:9\\ncell:E28:t::l:2:f:9\\ncell:F28:t::b::2:::l:1:f:9\\ncell:G28:b::1::1:f:1:ntvf:1\\ncell:A29:b::1::\\ncell:B29:b::1:1:1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C29:t::b:::2::l:1:f:9\\ncell:D29:t::b:::2::l:1:f:9\\ncell:E29:t::b:::2::l:1:f:9\\ncell:F29:t::b::2:2::l:1:f:9\\ncell:G29:b::1:1:1:f:1:ntvf:1\\ncell:B30:b:2::::l:1:f:9\\ncell:C30:b:2::::l:1:f:9\\ncell:D30:b:2::::l:1:f:9\\ncell:E30:b:2::::l:1:f:10\\ncell:F30:t:Subtotal:b:2::::l:1:f:10\\ncell:G30:vtf:n:0:SUM(G18\\\\cG29):b:1::::f:8:ntvf:1\\ncell:B31:t:NOTES:b:::2::l:1:f:6:cf:2:colspan:3:rowspan:1\\ncell:C31:t::b:::2::l:1:f:9\\ncell:D31:t::b:::2::l:1:f:9\\ncell:F31:t:Tax Rate:l:1:f:1\\ncell:G31:v:0:f:1:ntvf:2\\ncell:B32:b:1::::f:1:cf:2:colspan:3\\ncell:C32:t::b:2::::l:1:f:9\\ncell:D32:t::b:2::::l:1:f:9\\ncell:F32:t:Tax:l:1:f:1\\ncell:G32:vtf:n:0:G31*G30:f:1:ntvf:1\\ncell:B33:f:1:cf:2:colspan:3\\ncell:C33:t::l:2:f:9\\ncell:D33:t::l:2:f:9\\ncell:F33:t:Other:b:::1::l:1:f:1\\ncell:G33:v:0:b:::1::f:1:ntvf:1\\ncell:B34:b:::1::f:1:cf:2:colspan:3:rowspan:1\\ncell:C34:t::l:2:f:9\\ncell:D34:t::l:2:f:9\\ncell:F34:t:TOTAL:b:2::::l:1:f:6\\ncell:G34:vtf:n:0:(G30+G32)+G33:b:1::::f:5:ntvf:1\\ncell:C36:tvf:4:colspan:5:rowspan:7\\ncol:A:w:40\\ncol:B:w:232\\ncol:C:w:53\\ncol:D:w:90\\ncol:E:w:54\\ncol:F:w:91\\ncol:G:w:99\\nrow:1:h:34.5\\nrow:2:h:34.5\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:14.25\\nrow:6:h:14.25\\nrow:7:h:14.25\\nrow:8:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:13:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:17:h:14.25\\nrow:18:h:14.25\\nrow:19:h:14.25\\nrow:20:h:14.25\\nrow:21:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nrow:24:h:14.25\\nrow:25:h:14.25\\nrow:26:h:14.25\\nrow:27:h:14.25\\nrow:28:h:14.25\\nrow:29:h:14.25\\nrow:30:h:14.25\\nrow:31:h:14.25\\nrow:32:h:14.25\\nrow:33:h:14.25\\nrow:34:h:14.25\\nsheet:c:7:r:36:h:12.75:needsrecalc:yes\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\ncellformat:3:right\\ncolor:1:rgb(0, 0, 0)\\ncolor:2:rgb(0,0,0)\\ncolor:3:rgb(221, 221, 221)\\nfont:1:* * Trebuchet MS\\nfont:2:* 10pt *\\nfont:3:* 16pt Trebuchet MS\\nfont:4:italic normal * Trebuchet MS\\nfont:5:normal bold * Trebuchet MS\\nfont:6:normal bold 10pt Trebuchet MS\\nfont:7:normal bold 28pt Trebuchet MS\\nfont:8:normal normal * Trebuchet MS\\nfont:9:normal normal 10pt Arial\\nfont:10:normal normal 10pt Trebuchet MS\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nlayout:3:padding:36px * 28px *;vertical-align:*;\\nvalueformat:1:#,##0.00\\nvalueformat:2:#,##0.00%\\nvalueformat:3:m/d/yy\\nvalueformat:4:text-html\\n\"},\"name\":\"typeiii\",\"hidden\":\"0\"},\"sheet4\":{\"sheetstr\":{\"savestr\":\"version:1.5\\ncell:A1:l:3\\ncell:B2:t:[Company Name]:l:1:f:2:cf:2:colspan:3:rowspan:1\\ncell:C2:t::l:2:f:7\\ncell:D2:t::l:2:f:7\\ncell:F2:t:INVOICE:l:1:f:6:c:1:cf:2:colspan:2\\ncell:G2:t::l:2:f:7\\ncell:B3:t:[Company slogan]:f:3:cf:2:colspan:3:rowspan:1\\ncell:C3:t::l:2:f:7\\ncell:D3:t::l:2:f:7\\ncell:B4:cf:2:colspan:3:rowspan:1\\ncell:F4:tvf:4:rowspan:4\\ncell:B5:t:[Street Address]:f:1:cf:2:colspan:3:rowspan:1\\ncell:F5:l:1:f:5\\ncell:G5:l:1:f:8:cf:1\\ncell:B6:t:[City, State,  Zip]:f:1:cf:2:colspan:3:rowspan:1\\ncell:G6:l:1:f:7\\ncell:B7:t:Phone\\\\c :f:1:cf:2:colspan:3:rowspan:1\\ncell:B8:t:Email\\\\c:f:1:cf:2:colspan:3:rowspan:1\\ncell:B9:cf:2:colspan:3:rowspan:1\\ncell:B10:t:BILL TO\\\\c:l:1:f:5:bg:2:cf:2:colspan:2\\ncell:F10:t:DATE\\\\c:l:1:f:5:cf:2\\ncell:G10:l:1:f:8:cf:2:ntvf:3\\ncell:B11:t:[Name]:f:1:cf:2:colspan:3:rowspan:1\\ncell:F11:t:INVOICE # \\\\c:l:1:f:5:cf:2\\ncell:G11:v:1:l:1:f:8:cf:2\\ncell:B12:t:[Company Name]:f:1:cf:2:colspan:3:rowspan:1\\ncell:J12:tvf:4\\ncell:B13:t:[Street Address]:f:1:cf:2:colspan:3:rowspan:1\\ncell:B14:t:[City, State,  Zip]:f:1:cf:2:colspan:3:rowspan:1\\ncell:B15:t:Phone\\\\c :f:1:cf:2:colspan:3:rowspan:1\\ncell:B16:cf:2:colspan:3:rowspan:1\\ncell:A17:b::1::\\ncell:B17:t:DESCRIPTION:b:1:1:1:1:l:1:f:5:bg:2:cf:1:colspan:3:rowspan:1\\ncell:C17:t::b:1::1::l:1:f:7:bg:2\\ncell:D17:t::b:1::1::l:1:f:7:bg:2\\ncell:E17:t:HOURS:b:1:1:1::l:1:f:5:bg:2:cf:1\\ncell:F17:t:RATE:b:1:1:1::l:1:f:5:bg:2:cf:1\\ncell:G17:t:AMOUNT:b:1:1:1::l:1:f:5:bg:2:cf:1\\ncell:A18:b::1::\\ncell:B18:b:1:1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C18:t::b:2::::l:1:f:7\\ncell:D18:t::b:2:2:::l:1:f:7\\ncell:E18:b:1:1::1:f:1:ntvf:1\\ncell:F18:b:1:1::1:f:1:ntvf:1\\ncell:G18:vtf:t::IF(E18*F18>0,E18*F18,\\\"\\\"):b:1:1:::f:1:ntvf:1\\ncell:A19:b::1::\\ncell:B19:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C19:t::l:2:f:7\\ncell:D19:t::b::2:::l:1:f:7\\ncell:E19:b::1::1:f:1:ntvf:1\\ncell:F19:b::1::1:f:1:ntvf:1\\ncell:G19:vtf:t::IF(E19*F19>0,E19*F19,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A20:b::1::\\ncell:B20:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C20:t::l:2:f:7\\ncell:D20:t::b::2:::l:1:f:7\\ncell:E20:b::1::1:f:1:ntvf:1\\ncell:F20:b::1::1:f:1:ntvf:1\\ncell:G20:vtf:t::IF(E20*F20>0,E20*F20,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A21:b::1::\\ncell:B21:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C21:t::l:2:f:7\\ncell:D21:t::b::2:::l:1:f:7\\ncell:E21:b::1::1:f:1:ntvf:1\\ncell:F21:b::1::1:f:1:ntvf:1\\ncell:G21:vtf:t::IF(E21*F21>0,E21*F21,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A22:b::1::\\ncell:B22:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C22:t::l:2:f:7\\ncell:D22:t::b::2:::l:1:f:7\\ncell:E22:b::1::1:f:1:ntvf:1\\ncell:F22:b::1::1:f:1:ntvf:1\\ncell:G22:vtf:t::IF(E22*F22>0,E22*F22,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A23:b::1::\\ncell:B23:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C23:t::l:2:f:7\\ncell:D23:t::b::2:::l:1:f:7\\ncell:E23:b::1::1:f:1:ntvf:1\\ncell:F23:b::1::1:f:1:ntvf:1\\ncell:G23:vtf:t::IF(E23*F23>0,E23*F23,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A24:b::1::\\ncell:B24:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C24:t::l:2:f:7\\ncell:D24:t::b::2:::l:1:f:7\\ncell:E24:b::1::1:f:1:ntvf:1\\ncell:F24:b::1::1:f:1:ntvf:1\\ncell:G24:vtf:t::IF(E24*F24>0,E24*F24,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A25:b::1::\\ncell:B25:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C25:t::l:2:f:7\\ncell:D25:t::b::2:::l:1:f:7\\ncell:E25:b::1::1:f:1:ntvf:1\\ncell:F25:b::1::1:f:1:ntvf:1\\ncell:G25:vtf:t::IF(E25*F25>0,E25*F25,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A26:b::1::\\ncell:B26:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C26:t::l:2:f:7\\ncell:D26:t::b::2:::l:1:f:7\\ncell:E26:b::1::1:f:1:ntvf:1\\ncell:F26:b::1::1:f:1:ntvf:1\\ncell:G26:vtf:t::IF(E26*F26>0,E26*F26,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A27:b::1::\\ncell:B27:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C27:t::l:2:f:7\\ncell:D27:t::b::2:::l:1:f:7\\ncell:E27:b::1::1:f:1:ntvf:1\\ncell:F27:b::1::1:f:1:ntvf:1\\ncell:G27:vtf:t::IF(E27*F27>0,E27*F27,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A28:b::1::\\ncell:B28:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C28:t::l:2:f:7\\ncell:D28:t::b::2:::l:1:f:7\\ncell:E28:b::1::1:f:1:ntvf:1\\ncell:F28:b::1::1:f:1:ntvf:1\\ncell:G28:vtf:t::IF(E28*F28>0,E28*F28,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A29:b::1::\\ncell:B29:b::1:1:1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C29:t::b:::2::l:1:f:7\\ncell:D29:t::b::2:2::l:1:f:7\\ncell:E29:b::1:1:1:f:1:ntvf:1\\ncell:F29:b::1:1:1:f:1:ntvf:1\\ncell:G29:vtf:t::IF(E29*F29>0,E29*F29,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:B30:b:2::::l:1:f:8:cf:1:colspan:3:rowspan:1\\ncell:C30:t::b:2::::l:1:f:7\\ncell:D30:t::b:2::::l:1:f:7\\ncell:E30:b:2::::l:1:f:8\\ncell:F30:t:Subtotal:b:1::::f:1\\ncell:G30:vtf:n:0:SUM(G18\\\\cG29):b:1::::f:1:ntvf:1\\ncell:B31:t:NOTES:b:::2::l:1:f:5:cf:2:colspan:3:rowspan:1\\ncell:C31:t::b:::2::l:1:f:7\\ncell:D31:t::b:::2::l:1:f:7\\ncell:F31:t:Tax Rate:f:1\\ncell:G31:v:0:f:1:ntvf:2\\ncell:B32:b:1::::f:1:cf:2:colspan:3:rowspan:1\\ncell:C32:t::b:2::::l:1:f:7\\ncell:D32:t::b:2::::l:1:f:7\\ncell:F32:t:Tax:f:1\\ncell:G32:vtf:n:0:G31*G30:f:1:ntvf:1\\ncell:B33:f:1:cf:2:colspan:3:rowspan:1\\ncell:C33:t::l:2:f:7\\ncell:D33:t::l:2:f:7\\ncell:F33:t:Other:b:::1::l:1:f:1\\ncell:G33:v:0:b:::1::f:1:ntvf:1\\ncell:B34:f:1:cf:2:colspan:3:rowspan:1\\ncell:C34:t::l:2:f:7\\ncell:D34:t::l:2:f:7\\ncell:F34:t:TOTAL:b:1::::l:1:f:4\\ncell:G34:vtf:n:0:(G30+G32)+G33:b:1::::f:4:ntvf:1\\ncell:B35:b:2::::l:1:f:7\\ncell:C35:b:2::::l:1:f:7\\ncell:D35:b:2::::l:1:f:7\\ncell:C36:tvf:4:colspan:5:rowspan:7\\ncol:A:w:40\\ncol:B:w:194\\ncol:C:w:128\\ncol:D:w:60\\ncol:E:w:65\\ncol:F:w:95\\ncol:G:w:90\\nrow:1:h:34.5\\nrow:2:h:34.5\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:14.25\\nrow:6:h:14.25\\nrow:7:h:14.25\\nrow:8:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:13:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:17:h:14.25\\nrow:18:h:14.25\\nrow:19:h:14.25\\nrow:20:h:14.25\\nrow:21:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nrow:24:h:14.25\\nrow:25:h:14.25\\nrow:26:h:14.25\\nrow:27:h:14.25\\nrow:28:h:14.25\\nrow:29:h:14.25\\nrow:30:h:14.25\\nrow:31:h:14.25\\nrow:32:h:14.25\\nrow:33:h:14.25\\nrow:34:h:14.25\\nrow:35:h:14.25\\nsheet:c:10:r:36:h:12.75:needsrecalc:yes\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\ncolor:1:rgb(0,0,0)\\ncolor:2:rgb(221, 221, 221)\\nfont:1:* * Trebuchet MS\\nfont:2:* 16pt Trebuchet MS\\nfont:3:italic normal * Trebuchet MS\\nfont:4:normal bold * Trebuchet MS\\nfont:5:normal bold 10pt Trebuchet MS\\nfont:6:normal bold 28pt Trebuchet MS\\nfont:7:normal normal 10pt Arial\\nfont:8:normal normal 10pt Trebuchet MS\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nlayout:3:padding:36px * 28px *;vertical-align:*;\\nvalueformat:1:#,##0.00\\nvalueformat:2:#,##0.00%\\nvalueformat:3:m/d/yy\\nvalueformat:4:text-html\\n\"},\"name\":\"typeiv\",\"hidden\":\"0\"}},\"EditableCells\":{\"allow\":true,\"cells\":{\"typei!C10\":true,\"typei!B2\":true,\"typei!C11\":true,\"typei!C12\":true,\"typei!C13\":true,\"typei!D9\":true,\"typei!D4\":true,\"typei!D6\":true,\"typei!E10\":true,\"typei!E11\":true,\"typei!E12\":true,\"typei!E13\":true,\"typei!F9\":true,\"typei!C16\":true,\"typei!C17\":true,\"typei!C18\":true,\"typei!C19\":true,\"typei!C20\":true,\"typei!C21\":true,\"typei!C22\":true,\"typei!C23\":true,\"typei!C24\":true,\"typei!C25\":true,\"typei!C26\":true,\"typei!C27\":true,\"typei!C28\":true,\"typei!F16\":true,\"typei!F17\":true,\"typei!F18\":true,\"typei!F19\":true,\"typei!F20\":true,\"typei!F21\":true,\"typei!F22\":true,\"typei!F23\":true,\"typei!F24\":true,\"typei!F25\":true,\"typei!F26\":true,\"typei!F27\":true,\"typei!F28\":true,\"typei!E35\":true,\"typeii!B2\":true,\"typeii!D4\":true,\"typeii!C10\":true,\"typeii!C11\":true,\"typeii!C12\":true,\"typeii!C13\":true,\"typeii!D9\":true,\"typeii!E10\":true,\"typeii!E11\":true,\"typeii!E12\":true,\"typeii!E13\":true,\"typeii!F9\":true,\"typeii!C16\":true,\"typeii!C17\":true,\"typeii!C18\":true,\"typeii!C19\":true,\"typeii!C20\":true,\"typeii!C21\":true,\"typeii!C22\":true,\"typeii!C23\":true,\"typeii!C24\":true,\"typeii!C25\":true,\"typeii!C26\":true,\"typeii!C27\":true,\"typeii!C28\":true,\"typeii!F16\":true,\"typeii!F17\":true,\"typeii!F18\":true,\"typeii!F19\":true,\"typeii!F20\":true,\"typeii!F21\":true,\"typeii!F22\":true,\"typeii!F23\":true,\"typeii!F24\":true,\"typeii!F25\":true,\"typeii!F26\":true,\"typeii!F27\":true,\"typeii!F28\":true,\"typeii!G16\":true,\"typeii!G17\":true,\"typeii!G18\":true,\"typeii!G19\":true,\"typeii!G20\":true,\"typeii!G21\":true,\"typeii!G22\":true,\"typeii!G23\":true,\"typeii!G24\":true,\"typeii!G25\":true,\"typeii!G26\":true,\"typeii!G27\":true,\"typeii!G28\":true,\"typeii!E35\":true,\"typeiii!G9\":true,\"typeiii!G10\":true,\"typeiii!B2\":true,\"typeiii!B3\":true,\"typeiii!B4\":true,\"typeiii!B5\":true,\"typeiii!B6\":true,\"typeiii!B7\":true,\"typeiii!B8\":true,\"typeiii!B9\":true,\"typeiii!B11\":true,\"typeiii!B12\":true,\"typeiii!B13\":true,\"typeiii!B14\":true,\"typeiii!B15\":true,\"typeiii!B18\":true,\"typeiii!B19\":true,\"typeiii!B20\":true,\"typeiii!B21\":true,\"typeiii!B22\":true,\"typeiii!B23\":true,\"typeiii!B24\":true,\"typeiii!B25\":true,\"typeiii!B26\":true,\"typeiii!B27\":true,\"typeiii!B28\":true,\"typeiii!B29\":true,\"typeiii!G18\":true,\"typeiii!G19\":true,\"typeiii!G20\":true,\"typeiii!G21\":true,\"typeiii!G22\":true,\"typeiii!G23\":true,\"typeiii!G24\":true,\"typeiii!G25\":true,\"typeiii!G26\":true,\"typeiii!G27\":true,\"typeiii!G28\":true,\"typeiii!G29\":true,\"typeiii!B32\":true,\"typeiii!B33\":true,\"typeiii!B34\":true,\"typeiii!G31\":true,\"typeiii!G33\":true,\"typeiii!B37\":true,\"typeiv!G9\":true,\"typeiv!G10\":true,\"typeiv!B2\":true,\"typeiv!B3\":true,\"typeiv!B4\":true,\"typeiv!B5\":true,\"typeiv!B6\":true,\"typeiv!B7\":true,\"typeiv!B8\":true,\"typeiv!B11\":true,\"typeiv!B12\":true,\"typeiv!B13\":true,\"typeiv!B14\":true,\"typeiv!B15\":true,\"typeiv!B16\":true,\"typeiv!B18\":true,\"typeiv!B19\":true,\"typeiv!B20\":true,\"typeiv!B21\":true,\"typeiv!B22\":true,\"typeiv!B23\":true,\"typeiv!B24\":true,\"typeiv!B25\":true,\"typeiv!B26\":true,\"typeiv!B27\":true,\"typeiv!B28\":true,\"typeiv!B29\":true,\"typeiv!E18\":true,\"typeiv!E19\":true,\"typeiv!E20\":true,\"typeiv!E21\":true,\"typeiv!E22\":true,\"typeiv!E23\":true,\"typeiv!E24\":true,\"typeiv!E25\":true,\"typeiv!E26\":true,\"typeiv!E27\":true,\"typeiv!E28\":true,\"typeiv!E29\":true,\"typeiv!F18\":true,\"typeiv!F19\":true,\"typeiv!F2\":true,\"typeiv!F20\":true,\"typeiv!F21\":true,\"typeiv!F22\":true,\"typeiv!F23\":true,\"typeiv!F24\":true,\"typeiv!F25\":true,\"typeiv!F26\":true,\"typeiv!F27\":true,\"typeiv!F28\":true,\"typeiv!F29\":true,\"typeiv!B32\":true,\"typeiv!B33\":true,\"typeiv!B34\":true,\"typeiv!G31\":true,\"typeiv!G33\":true,\"typeiv!B37\":true,\"typeii!F15\":true,\"typeii!G15\":true,\"typeiv!E17\":true,\"typeiv!F17\":true,\"typeii!D6\":true,\"typeiv!G11\":true,\"typei!C4\":true,\"typeii!C4\":true,\"typeiii!F10\":true,\"typeiv!F11\":true,\"typeiv!F10\":true,\"typeiii!F9\":true,\"typeii!C6\":true,\"typei!C6\":true,\"typei!F4\":true,\"typeii!F4\":true,\"typeiii!F4\":true,\"typeiii!F2\":true,\"typeiv!F4\":true,\"typei!F29\":true,\"typeii!H29\":true,\"typeiii!G30\":true,\"typeiii!G34\":true,\"typeiv!G30\":true,\"typeiv!G34\":true},\"constraints\":{}}},\n        \t\"footers\": [{name: 'Invoice 1' , index: 1, isActive: true }, {name: 'Invoice 2' , index: 2, isActive: false}, \n                        {name: 'Company Invoice 1' , index: 3, isActive: false}, {name: 'Company Invoice 2' , index: 4, isActive: false}]\n        },\n        \"default\":{\n        \t\"msc\": {\"numsheets\":4,\"currentid\":\"sheet1\",\"currentname\":\"typei\",\"sheetArr\":{\"sheet1\":{\"sheetstr\":{\"savestr\":\"version:1.5\\ncell:A2:b::2:::l:1:f:7\\ncell:B2:t:INVOICE:b:1:1:1:1:f:6:cf:1:colspan:6\\ncell:C2:t::b:2::2::l:1:f:7\\ncell:D2:t::b:2::2::l:1:f:7\\ncell:E2:t::b:2::2::l:1:f:7\\ncell:F2:t::b:2::2::l:1:f:7\\ncell:G2:t::b:2::2::l:1:f:7\\ncell:A3:b::2:::l:3:f:7\\ncell:B3:b:2:::2:l:3:f:7\\ncell:C3:b:2::::l:1:f:7\\ncell:D3:b:2::::l:1:f:7\\ncell:E3:b:2::::l:1:f:7\\ncell:F3:b:2::::l:1:f:7\\ncell:G3:b:2:2:::l:3:f:7\\ncell:A4:b::2:::l:3:f:7\\ncell:B4:b::::2:l:3:f:3\\ncell:C4:t:INVOICE # \\\\c:f:2:cf:2\\ncell:D4:v:1:f:2:cf:2\\ncell:F4:tvf:4:rowspan:4\\ncell:G4:b::2:::l:3:f:7\\ncell:A5:b::2:::l:3:f:7\\ncell:B5:b::::2:l:3:f:4\\ncell:F5:t::l:2:f:7\\ncell:G5:t::b::1:::l:2:f:7\\ncell:A6:b::2:::l:3:f:7\\ncell:B6:b::::2:l:3:f:4\\ncell:C6:t:INVOICE DATE\\\\c:f:2:cf:2\\ncell:D6:f:2:cf:2:ntvf:3\\ncell:F6:l:2:f:7\\ncell:G6:b::1:::l:2:f:7\\ncell:A7:b::2:::l:3:f:7\\ncell:B7:b::::2:l:3:f:4\\ncell:G7:b::2:::l:3:f:7\\ncell:A8:b::2:::l:3:f:7\\ncell:B8:b::::2:l:3:f:4\\ncell:G8:b::2:::l:3:f:7\\ncell:A9:b::2:::l:3:f:7\\ncell:B9:b::::2:l:3:f:4\\ncell:C9:t:BILL TO\\\\c:l:3:f:2\\ncell:E9:t:FROM\\\\c:f:2:cf:2\\ncell:G9:b::2:::l:3:f:7\\ncell:A10:b::2:::l:3:f:7\\ncell:B10:b::::2:l:3:f:3\\ncell:C10:t:[Name]:f:1:cf:2:colspan:2\\ncell:E10:t:[Name]:f:1:cf:2:colspan:2\\ncell:G10:b::2:::l:3:f:7\\ncell:A11:b::2:::l:3:f:7\\ncell:B11:b::::2:l:3:f:7\\ncell:C11:t:[Street Address]:f:1:cf:2:colspan:2\\ncell:E11:t:[Street Address]:f:1:cf:2:colspan:2\\ncell:G11:b::2:::l:3:f:7\\ncell:A12:b::2:::l:3:f:7\\ncell:B12:b::::2:l:3:f:7\\ncell:C12:t:[City, State, Zip]:f:1:cf:2:colspan:2\\ncell:E12:t:[City, State, Zip]:f:1:cf:2:colspan:2\\ncell:G12:b::2:::l:3:f:7\\ncell:A13:b::2:::l:3:f:7\\ncell:B13:b::::2:l:3:f:7\\ncell:C13:t:Phone\\\\c:f:1:cf:2:colspan:2\\ncell:E13:t:Phone\\\\c:f:1:cf:2:colspan:2\\ncell:G13:b::2:::l:3:f:7\\ncell:A14:b::2:::l:3:f:7\\ncell:B14:b::::2:l:3:f:3:cf:2\\ncell:C14:b:::2::l:1:f:7\\ncell:D14:b:::2::l:3:f:3:cf:2\\ncell:E14:b:::2::l:1:f:7\\ncell:F14:b:::2::l:1:f:7\\ncell:G14:b::2:::l:3:f:7\\ncell:A15:b::2:::l:3:f:7\\ncell:B15:b::2::2:l:3:f:7\\ncell:C15:t:Description:b:1::1:1:f:2:cf:1:colspan:3\\ncell:D15:t:Description:b:1::1::l:3:f:3:cf:2:colspan:2:rowspan:1\\ncell:E15:t::b:2:2:2::l:1:f:7\\ncell:F15:t:Amount:b:1:1:1:1:f:2:cf:1\\ncell:G15:b::2::2:l:3:f:7\\ncell:A16:b::2:::l:3:f:7\\ncell:B16:b::2::2:l:3:f:7\\ncell:C16:b:1:1::1:f:1:cf:2:colspan:3\\ncell:D16:b:1:1:::l:3:f:7:cf:2:colspan:2:rowspan:1\\ncell:E16:t::b:2:2:2::l:1:f:7\\ncell:F16:b:1:1:::f:1:ntvf:1\\ncell:G16:b::2::2:l:3:f:7\\ncell:A17:b::2:::l:3:f:7\\ncell:B17:b::2::2:l:3:f:7:cf:2\\ncell:C17:b::1::1:f:1:cf:2:colspan:3\\ncell:D17:b::1:::l:1:f:7:colspan:2\\ncell:E17:l:1:f:7\\ncell:F17:b::1:::f:1:ntvf:1\\ncell:G17:b::2::2:l:3:f:7\\ncell:A18:b::2:::l:3:f:7\\ncell:B18:b::2::2:l:3:f:7:cf:2:ntvf:2\\ncell:C18:b::1::1:f:1:cf:2:colspan:3\\ncell:D18:b::1:::colspan:2\\ncell:F18:b::1:::f:1:ntvf:1\\ncell:G18:b::2::2:l:3:f:7\\ncell:A19:b::2:::l:3:f:7\\ncell:B19:b::2::2:l:3:f:7:cf:2:ntvf:2\\ncell:C19:b::1::1:f:1:cf:2:colspan:3\\ncell:D19:b::1:::colspan:2\\ncell:F19:b::1:::f:1:ntvf:1\\ncell:G19:b::2::2:l:3:f:7\\ncell:A20:b::2:::l:3:f:7\\ncell:B20:b::2::2:l:3:f:7:cf:2:ntvf:2\\ncell:C20:b::1::1:f:1:cf:2:colspan:3\\ncell:D20:b::1:::colspan:2\\ncell:F20:b::1:::f:1:ntvf:1\\ncell:G20:b::2::2:l:3:f:7\\ncell:A21:b::2:::l:3:f:7\\ncell:B21:b::2::2:l:3:f:7:cf:2:ntvf:2\\ncell:C21:b::1::1:f:1:cf:2:colspan:3\\ncell:D21:b::1:::colspan:2\\ncell:F21:b::1:::f:1:ntvf:1\\ncell:G21:b::2::2:l:3:f:7\\ncell:A22:b::2:::l:3:f:7\\ncell:B22:b::2::2:l:3:f:7:cf:2:ntvf:2\\ncell:C22:b::1::1:f:1:cf:2:colspan:3\\ncell:D22:b::1:::colspan:2\\ncell:F22:b::1:::f:1:ntvf:1\\ncell:G22:b::2::2:l:3:f:7\\ncell:A23:b::2:::l:3:f:7\\ncell:B23:b::2::2:l:3:f:7:cf:2\\ncell:C23:b::1::1:f:1:cf:2:colspan:3\\ncell:D23:b::1:::colspan:2\\ncell:F23:b::1:::f:1:ntvf:1\\ncell:G23:b::2::2:l:3:f:7\\ncell:A24:b::2:::l:3:f:7\\ncell:B24:b::2::2:l:3:f:7:cf:2\\ncell:C24:b::1::1:f:1:cf:2:colspan:3\\ncell:D24:b::1:::colspan:2\\ncell:F24:b::1:::f:1:ntvf:1\\ncell:G24:b::2::2:l:3:f:7\\ncell:A25:b::2:::l:3:f:7\\ncell:B25:b::2::2:l:3:f:7:cf:2\\ncell:C25:b::1::1:f:1:cf:2:colspan:3\\ncell:D25:b::1:::colspan:2\\ncell:F25:b::1:::f:1:ntvf:1\\ncell:G25:b::2::2:l:3:f:7\\ncell:A26:b::2:::l:3:f:7\\ncell:B26:b::2::2:l:3:f:7:cf:2\\ncell:C26:b::1::1:f:1:cf:2:colspan:3\\ncell:D26:b::1:::colspan:2\\ncell:F26:b::1:::f:1:ntvf:1\\ncell:G26:b::2::2:l:3:f:7\\ncell:A27:b::2:::l:3:f:7\\ncell:B27:b::2::2:l:3:f:7:cf:2\\ncell:C27:b::1::1:f:1:cf:2:colspan:3\\ncell:D27:b::1:::colspan:2\\ncell:F27:b::1:::f:1:ntvf:1\\ncell:G27:b::2::2:l:3:f:7\\ncell:A28:b::2:::l:3:f:4\\ncell:B28:b::2::2:l:3:f:7:cf:2\\ncell:C28:b::1:1:1:f:1:cf:2:colspan:3\\ncell:D28:b::1:1::l:3:f:7:cf:2:colspan:2\\ncell:E28:b:::2::l:3:f:7:cf:2\\ncell:F28:b::1:1::f:1:ntvf:1\\ncell:G28:b::2::2:l:3:f:7\\ncell:A29:b::2:::l:3:f:3\\ncell:B29:b::2::2:l:3:f:3\\ncell:C29:t:TOTAL:b:1:1:1:1:f:5:cf:2:colspan:3\\ncell:D29:b:2::2::l:3:f:8:cf:2\\ncell:E29:b:2:2:2::l:3:f:8:cf:2\\ncell:F29:vtf:n:0:SUM(F16\\\\cF28):b:1:1:1::f:5:ntvf:1\\ncell:G29:b::2::2:l:3:f:4\\ncell:A30:b::2:::l:3:f:7\\ncell:B30:b::::2:l:3:f:3:cf:2\\ncell:C30:b:2::::l:1:f:7\\ncell:D30:b:2::::l:1:f:7\\ncell:E30:b:2::::l:1:f:7\\ncell:F30:b:2::::l:1:f:7\\ncell:G30:b::2:::l:3:f:3\\ncell:A31:b::2:::l:3:f:7\\ncell:B31:b::::2:l:3:f:7\\ncell:D31:tvf:4:rowspan:4\\ncell:G31:b::2:::l:3:f:7\\ncell:A32:b::2:::l:3:f:7\\ncell:B32:b::::2:l:3:f:7\\ncell:G32:b::2:::l:3:f:7\\ncell:A33:b::2:::l:3:f:7\\ncell:B33:b::::2:l:3:f:7\\ncell:G33:b::2:::l:3:f:7\\ncell:A34:b::2:::l:3:f:7\\ncell:B34:b::::2:l:3:f:7\\ncell:G34:b::2:::l:3:f:7\\ncell:A35:b::2:::l:3:f:7\\ncell:B35:b:::2:2:l:3:f:7\\ncell:C35:b:::2::l:3:f:7\\ncell:D35:b:::2::l:3:f:7\\ncell:E35:b:::2::l:3:f:7\\ncell:F35:b:::2::l:3:f:7\\ncell:G35:b::2:2::l:3:f:7\\ncell:B36:b:1:::\\ncell:C36:b:1:::\\ncell:D36:b:1:::\\ncell:E36:b:1:::\\ncell:F36:b:1:::\\ncell:G36:b:1:::\\ncol:A:w:10\\ncol:B:w:42\\ncol:C:w:105\\ncol:D:w:182\\ncol:E:w:110\\ncol:F:w:115\\ncol:G:w:65\\nrow:1:h:14.25\\nrow:2:h:18.75\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:15.75\\nrow:6:h:15.75\\nrow:7:h:15.75\\nrow:8:h:15.75\\nrow:9:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:13:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:16:h:14.25\\nrow:17:h:14.25\\nrow:18:h:14.25\\nrow:19:h:14.25\\nrow:20:h:14.25\\nrow:21:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nrow:24:h:14.25\\nrow:25:h:14.25\\nrow:26:h:14.25\\nrow:27:h:14.25\\nrow:28:h:15.75\\nrow:29:h:15.75\\nrow:30:h:14.25\\nrow:31:h:14.25\\nrow:32:h:14.25\\nrow:33:h:14.25\\nrow:34:h:14.25\\nrow:35:h:14.25\\nsheet:c:7:r:36:h:12.75\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\nfont:1:* * Trebuchet MS\\nfont:2:normal bold * Trebuchet MS\\nfont:3:normal bold 10pt Arial\\nfont:4:normal bold 12pt Arial\\nfont:5:normal bold 12pt Trebuchet MS\\nfont:6:normal bold 14pt Trebuchet MS\\nfont:7:normal normal 10pt Arial\\nfont:8:normal normal 12pt Arial\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nlayout:3:padding:* * * *;vertical-align:top;\\nvalueformat:1:#,##0.00\\nvalueformat:2:d-mmm\\nvalueformat:3:m/d/yy\\nvalueformat:4:text-html\\n\"},\"name\":\"typei\",\"hidden\":\"0\"},\"sheet2\":{\"sheetstr\":{\"savestr\":\"version:1.5\\ncell:A2:b::2:::l:1:f:7\\ncell:B2:t:INVOICE:b:1:1:1:1:l:3:f:6:cf:1:colspan:8\\ncell:C2:t::b:2::2::l:1:f:7\\ncell:D2:t::b:2::2::l:1:f:7\\ncell:E2:t::b:2::2::l:1:f:7\\ncell:F2:t::b:2::2::l:1:f:7\\ncell:G2:b:2::2::l:1:f:7\\ncell:H2:b:2::2::l:1:f:7\\ncell:I2:t::b:2::2::l:1:f:7\\ncell:A3:b::2:::l:3:f:7\\ncell:B3:b:2:::2:l:3:f:7\\ncell:E3:b:2::::l:1:f:7\\ncell:F3:b:2::::l:1:f:7\\ncell:G3:b:2::::l:1:f:7\\ncell:H3:b:2::::l:1:f:7\\ncell:I3:b:2:2:::l:3:f:7\\ncell:A4:b::2:::l:3:f:7\\ncell:B4:b::::2:l:3:f:3\\ncell:C4:t:INVOICE # \\\\c:f:2:cf:2\\ncell:D4:v:1:f:2:cf:2\\ncell:F4:tvf:5:colspan:2:rowspan:4\\ncell:I4:b::2:::l:3:f:7\\ncell:A5:b::2:::l:3:f:7\\ncell:B5:b::::2:l:3:f:4\\ncell:F5:t::l:2:f:7\\ncell:G5:l:2:f:7\\ncell:H5:l:2:f:7\\ncell:I5:t::b::1:::l:2:f:7\\ncell:A6:b::2:::l:3:f:7\\ncell:B6:b::::2:l:3:f:4\\ncell:C6:t:INVOICE DATE\\\\c:f:2:cf:2\\ncell:D6:f:2:cf:2:ntvf:4\\ncell:F6:l:2:f:7\\ncell:G6:l:2:f:7\\ncell:H6:l:2:f:7\\ncell:I6:b::1:::l:2:f:7\\ncell:A7:b::2:::l:3:f:7\\ncell:B7:b::::2:l:3:f:4\\ncell:I7:b::2:::l:3:f:7\\ncell:A8:b::2:::l:3:f:7\\ncell:B8:b::::2:l:3:f:4\\ncell:I8:b::2:::l:3:f:7\\ncell:A9:b::2:::l:3:f:7\\ncell:B9:b::::2:l:3:f:4\\ncell:C9:t:BILL TO\\\\c:f:2\\ncell:E9:t:FROM\\\\c:f:2:cf:2\\ncell:F9:colspan:3\\ncell:I9:b::2:::l:3:f:7\\ncell:A10:b::2:::l:3:f:7\\ncell:B10:b::::2:l:3:f:3\\ncell:C10:t:[Name]:f:1:cf:2:colspan:2\\ncell:E10:t:[Name]:f:1:cf:2:colspan:4\\ncell:I10:b::2:::l:3:f:7\\ncell:A11:b::2:::l:3:f:7\\ncell:B11:b::::2:l:3:f:7\\ncell:C11:t:[Street Address]:f:1:cf:2:colspan:2\\ncell:E11:t:[Street Address]:f:1:colspan:4\\ncell:I11:b::2:::l:3:f:7\\ncell:A12:b::2:::l:3:f:7\\ncell:B12:b::::2:l:3:f:7\\ncell:C12:t:[City, State, Zip]:f:1:cf:2:colspan:2\\ncell:E12:t:[City, State, Zip]:f:1:cf:2:colspan:4\\ncell:I12:b::2:::l:3:f:7\\ncell:A13:b::2:::l:3:f:7\\ncell:B13:b::::2:l:3:f:7\\ncell:C13:t:Phone\\\\c :f:1:cf:2:colspan:2\\ncell:E13:t:Phone\\\\c :f:1:cf:2:colspan:4\\ncell:I13:b::2:::l:3:f:7\\ncell:A14:b::2:::l:3:f:7\\ncell:B14:b::::2:l:3:f:3:cf:2\\ncell:C14:b:::2::l:1:f:7\\ncell:D14:b:::2::l:3:f:3:cf:2\\ncell:E14:b:::2::l:1:f:7\\ncell:F14:b:::2::l:1:f:7\\ncell:G14:b:::2::l:1:f:7\\ncell:H14:b:::2::l:1:f:7\\ncell:I14:b::2:::l:3:f:7\\ncell:A15:b::2:::l:3:f:7\\ncell:B15:b::2::2:l:3:f:7\\ncell:C15:t:Description:b:1:1:1:1:f:2:cf:1:colspan:3\\ncell:D15:t:Description:b:2::2:2:l:3:f:3:cf:2:colspan:2:rowspan:1\\ncell:E15:t::b:2:2:2::l:1:f:7\\ncell:F15:t:Hours:b:1:1:1:1:f:2:cf:1\\ncell:G15:t:Rate:b:1:1:1:1:f:2:cf:1\\ncell:H15:t:Amount:b:1:1:1:1:f:2:cf:1\\ncell:I15:b::2::2:l:3:f:7\\ncell:A16:b::2:::l:3:f:7\\ncell:B16:b::2::2:l:3:f:7\\ncell:C16:b:1:1::1:f:1:cf:2:colspan:3\\ncell:D16:b:1:1::1:l:3:f:7:cf:2:colspan:2:rowspan:1\\ncell:E16:t::b:2:2:2::l:1:f:7\\ncell:F16:b:1:1:::f:1:ntvf:1\\ncell:G16:b:1:1:::f:1:ntvf:1\\ncell:H16:vtf:t::IF(F16*G16>0,F16*G16,\\\"\\\"):b:1:1:::f:1:ntvf:1\\ncell:I16:b::2::2:l:3:f:7\\ncell:A17:b::2:::l:3:f:7\\ncell:B17:b::2::2:l:3:f:7:cf:2\\ncell:C17:b::1::1:f:1:cf:2:colspan:3\\ncell:D17:b::1::1:l:1:f:7:colspan:2\\ncell:E17:l:1:f:7\\ncell:F17:b::1:::f:1:ntvf:1\\ncell:G17:b::1:::f:1:ntvf:1\\ncell:H17:vtf:t::IF(F17*G17>0,F17*G17,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I17:b::2::2:l:3:f:7\\ncell:A18:b::2:::l:3:f:7\\ncell:B18:b::2::2:l:3:f:7:cf:2:ntvf:3\\ncell:C18:b::1::1:f:1:cf:2:colspan:3\\ncell:D18:b::1::1:colspan:2\\ncell:F18:b::1:::f:1:ntvf:1\\ncell:G18:b::1:::f:1:ntvf:1\\ncell:H18:vtf:t::IF(F18*G18>0,F18*G18,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I18:b::2::2:l:3:f:7\\ncell:A19:b::2:::l:3:f:7\\ncell:B19:b::2::2:l:3:f:7:cf:2:ntvf:3\\ncell:C19:b::1::1:f:1:cf:2:colspan:3\\ncell:D19:b::1::1:colspan:2\\ncell:F19:b::1:::f:1:ntvf:1\\ncell:G19:b::1:::f:1:ntvf:1\\ncell:H19:vtf:t::IF(F19*G19>0,F19*G19,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I19:b::2::2:l:3:f:7\\ncell:A20:b::2:::l:3:f:7\\ncell:B20:b::2::2:l:3:f:7:cf:2:ntvf:3\\ncell:C20:b::1::1:f:1:cf:2:colspan:3\\ncell:D20:b::1::1:colspan:2\\ncell:F20:b::1:::f:1:ntvf:1\\ncell:G20:b::1:::f:1:ntvf:1\\ncell:H20:vtf:t::IF(F20*G20>0,F20*G20,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I20:b::2::2:l:3:f:7\\ncell:A21:b::2:::l:3:f:7\\ncell:B21:b::2::2:l:3:f:7:cf:2:ntvf:3\\ncell:C21:b::1::1:f:1:cf:2:colspan:3\\ncell:D21:b::1::1:colspan:2\\ncell:F21:b::1:::f:1:ntvf:1\\ncell:G21:b::1:::f:1:ntvf:1\\ncell:H21:vtf:t::IF(F21*G21>0,F21*G21,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I21:b::2::2:l:3:f:7\\ncell:A22:b::2:::l:3:f:7\\ncell:B22:b::2::2:l:3:f:7:cf:2:ntvf:3\\ncell:C22:b::1::1:f:1:cf:2:colspan:3\\ncell:D22:b::1::1:colspan:2\\ncell:F22:b::1:::f:1:ntvf:1\\ncell:G22:b::1:::f:1:ntvf:1\\ncell:H22:vtf:t::IF(F22*G22>0,F22*G22,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I22:b::2::2:l:3:f:7\\ncell:A23:b::2:::l:3:f:7\\ncell:B23:b::2::2:l:3:f:7:cf:2\\ncell:C23:b::1::1:f:1:cf:2:colspan:3\\ncell:D23:b::1::1:colspan:2\\ncell:F23:b::1:::f:1:ntvf:1\\ncell:G23:b::1:::f:1:ntvf:1\\ncell:H23:vtf:t::IF(F23*G23>0,F23*G23,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I23:b::2::2:l:3:f:7\\ncell:A24:b::2:::l:3:f:7\\ncell:B24:b::2::2:l:3:f:7:cf:2\\ncell:C24:b::1::1:f:1:cf:2:colspan:3\\ncell:D24:b::1::1:colspan:2\\ncell:F24:b::1:::f:1:ntvf:1\\ncell:G24:b::1:::f:1:ntvf:1\\ncell:H24:vtf:t::IF(F24*G24>0,F24*G24,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I24:b::2::2:l:3:f:7\\ncell:A25:b::2:::l:3:f:7\\ncell:B25:b::2::2:l:3:f:7:cf:2\\ncell:C25:b::1::1:f:1:cf:2:colspan:3\\ncell:D25:b::1::1:colspan:2\\ncell:F25:b::1:::f:1:ntvf:1\\ncell:G25:b::1:::f:1:ntvf:1\\ncell:H25:vtf:t::IF(F25*G25>0,F25*G25,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I25:b::2::2:l:3:f:7\\ncell:A26:b::2:::l:3:f:7\\ncell:B26:b::2::2:l:3:f:7:cf:2\\ncell:C26:b::1::1:f:1:cf:2:colspan:3\\ncell:D26:b::1::1:colspan:2\\ncell:F26:b::1:::f:1:ntvf:1\\ncell:G26:b::1:::f:1:ntvf:1\\ncell:H26:vtf:t::IF(F26*G26>0,F26*G26,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I26:b::2::2:l:3:f:7\\ncell:A27:b::2:::l:3:f:7\\ncell:B27:b::2::2:l:3:f:7:cf:2\\ncell:C27:b::1::1:f:1:cf:2:colspan:3\\ncell:D27:b::1::1:colspan:2\\ncell:F27:b::1:::f:1:ntvf:1\\ncell:G27:b::1:::f:1:ntvf:1\\ncell:H27:vtf:t::IF(F27*G27>0,F27*G27,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I27:b::2::2:l:3:f:7\\ncell:A28:b::2:::l:3:f:4\\ncell:B28:b::2::2:l:3:f:7:cf:2\\ncell:C28:b::1:1:1:f:1:cf:2:colspan:3\\ncell:D28:b::1:1:1:l:3:f:7:cf:2:colspan:2\\ncell:E28:b:::2::l:3:f:7:cf:2\\ncell:F28:b::1:1::f:1:ntvf:1\\ncell:G28:b::1:1::f:1:ntvf:1\\ncell:H28:vtf:t::IF(F28*G28>0,F28*G28,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:I28:b::2::2:l:3:f:7\\ncell:A29:b::2:::l:3:f:3\\ncell:B29:b::2::2:l:3:f:3\\ncell:C29:t:TOTAL:b:1:1:1:1:l:3:f:5:cf:2:colspan:5\\ncell:D29:b:2::2::l:3:f:8:cf:2\\ncell:E29:b:2:2:2::l:3:f:8:cf:2\\ncell:F29:vtf:n:0:SUM(F16\\\\cF28):b:2:2:2::l:3:f:4:ntvf:2\\ncell:G29:b:2:2:2::l:3:f:4:ntvf:2\\ncell:H29:vtf:n:0:SUM(H16\\\\cH28):b:1:1:1::f:5:ntvf:1\\ncell:I29:b::2::2:l:3:f:4\\ncell:A30:b::2:::l:3:f:7\\ncell:B30:b::::2:l:3:f:3:cf:2\\ncell:C30:b:2::::l:1:f:7\\ncell:D30:b:2::::l:1:f:7\\ncell:E30:b:2::::l:1:f:7\\ncell:F30:b:2::::l:1:f:7\\ncell:G30:b:2::::l:1:f:7\\ncell:H30:b:2::::l:1:f:7\\ncell:I30:b::2:::l:3:f:3\\ncell:A31:b::2:::l:3:f:7\\ncell:B31:b::::2:l:3:f:7\\ncell:D31:tvf:5:rowspan:4\\ncell:I31:b::2:::l:3:f:7\\ncell:A32:b::2:::l:3:f:7\\ncell:B32:b::::2:l:3:f:7\\ncell:I32:b::2:::l:3:f:7\\ncell:A33:b::2:::l:3:f:7\\ncell:B33:b::::2:l:3:f:7\\ncell:I33:b::2:::l:3:f:7\\ncell:A34:b::2:::l:3:f:7\\ncell:B34:b::::2:l:3:f:7\\ncell:I34:b::2:::l:3:f:7\\ncell:A35:b::2:::l:3:f:7\\ncell:B35:b:::2:2:l:3:f:7\\ncell:C35:b:::2::l:3:f:7\\ncell:D35:b:::2::l:3:f:7\\ncell:E35:b:::2::l:3:f:7\\ncell:F35:b:::2::l:3:f:7\\ncell:G35:b:::2::l:3:f:7\\ncell:H35:b:::2::l:3:f:7\\ncell:I35:b::2:2::l:3:f:7\\ncell:B36:b:1:::\\ncell:C36:b:1:::\\ncell:D36:b:1:::\\ncell:E36:b:1:::\\ncell:F36:b:1:::\\ncell:G36:b:1:::\\ncell:H36:b:1:::\\ncell:I36:b:1:::\\ncol:A:w:26\\ncol:B:w:28\\ncol:C:w:96\\ncol:D:w:203\\ncol:E:w:51\\ncol:F:w:50\\ncol:G:w:58\\ncol:H:w:80\\ncol:I:w:28\\nrow:1:h:14.25\\nrow:2:h:18.75\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:15.75\\nrow:6:h:15.75\\nrow:7:h:15.75\\nrow:8:h:15.75\\nrow:9:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:13:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:16:h:14.25\\nrow:17:h:14.25\\nrow:18:h:14.25\\nrow:19:h:14.25\\nrow:20:h:14.25\\nrow:21:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nrow:24:h:14.25\\nrow:25:h:14.25\\nrow:26:h:14.25\\nrow:27:h:14.25\\nrow:28:h:15.75\\nrow:29:h:15.75\\nrow:30:h:14.25\\nrow:31:h:14.25\\nrow:32:h:14.25\\nrow:33:h:14.25\\nrow:34:h:14.25\\nrow:35:h:14.25\\nsheet:c:9:r:36:h:12.75\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\nfont:1:* * Trebuchet MS\\nfont:2:normal bold * Trebuchet MS\\nfont:3:normal bold 10pt Arial\\nfont:4:normal bold 12pt Arial\\nfont:5:normal bold 12pt Trebuchet MS\\nfont:6:normal bold 14pt Trebuchet MS\\nfont:7:normal normal 10pt Arial\\nfont:8:normal normal 12pt Arial\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nlayout:3:padding:* * * *;vertical-align:top;\\nvalueformat:1:#,##0.00\\nvalueformat:2:#,##0.00;(#,##0.00)\\nvalueformat:3:d-mmm\\nvalueformat:4:m/d/yy\\nvalueformat:5:text-html\\n\"},\"name\":\"typeii\",\"hidden\":\"0\"},\"sheet3\":{\"sheetstr\":{\"savestr\":\"version:1.5\\ncell:A1:l:3\\ncell:B2:t:[Company Name]:l:1:f:3:cf:2:colspan:3\\ncell:C2:t::l:2:f:9\\ncell:D2:t::l:2:f:9\\ncell:E2:l:1:f:7:c:2:cf:3\\ncell:F2:t:INVOICE:l:1:f:7:c:2:cf:2:colspan:2\\ncell:G2:t::l:2:f:9\\ncell:B3:t:[Company Slogan]:f:4:cf:2:colspan:3\\ncell:C3:t::l:2:f:9\\ncell:D3:t::l:2:f:9\\ncell:B4:f:2:colspan:2\\ncell:F4:tvf:4:rowspan:4\\ncell:B5:t:[Street Address]:f:1:cf:2:colspan:2\\ncell:F5:l:1:f:6\\ncell:G5:l:1:f:10:cf:1\\ncell:B6:t:[City, State,  Zip]:f:1:cf:2:colspan:2\\ncell:G6:l:1:f:9\\ncell:B7:t:Phone\\\\c :f:1:cf:2:colspan:2\\ncell:B8:t:Email\\\\c:f:1:cf:2:colspan:2\\ncell:B9:colspan:2\\ncell:F9:t:DATE \\\\c:l:1:f:6:cf:2\\ncell:G9:l:1:f:10:cf:2:ntvf:3\\ncell:B10:t:BILL TO\\\\c:f:5:c:1:bg:3:cf:2:colspan:2\\ncell:F10:t:INVOICE # \\\\c:l:1:f:6:cf:2\\ncell:G10:v:1:l:1:f:10:cf:2\\ncell:B11:t:[Name]:f:1:cf:2:colspan:2\\ncell:B12:t:[Company Name]:f:1:cf:2:colspan:2\\ncell:F12:t:  \\ncell:B13:t:[Street Address]:f:1:cf:2:colspan:2\\ncell:B14:t:[City, State,  Zip]:f:1:cf:2:colspan:2\\ncell:B15:t:Phone\\\\c :f:1:cf:2:colspan:2\\ncell:A17:b::1::\\ncell:B17:t:DESCRIPTION:b:1:1:1:1:l:1:f:6:c:1:bg:3:cf:1:colspan:5:rowspan:1\\ncell:C17:t::l:2:f:9\\ncell:D17:t::l:2:f:9\\ncell:E17:t::l:2:f:9\\ncell:F17:t::l:2:f:9\\ncell:G17:t:AMOUNT:b:1:1:1::l:1:f:6:c:1:bg:3:cf:1\\ncell:A18:b::1::\\ncell:B18:b:1:1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C18:t::l:2:f:9\\ncell:D18:t::l:2:f:9\\ncell:E18:t::l:2:f:9\\ncell:F18:t::b::2:::l:1:f:9\\ncell:G18:b::1::1:f:1:ntvf:1\\ncell:A19:b::1::\\ncell:B19:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C19:t::l:2:f:9\\ncell:D19:t::l:2:f:9\\ncell:E19:t::l:2:f:9\\ncell:F19:t::b::2:::l:1:f:9\\ncell:G19:b::1::1:f:1:ntvf:1\\ncell:A20:b::1::\\ncell:B20:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C20:t::l:2:f:9\\ncell:D20:t::l:2:f:9\\ncell:E20:t::l:2:f:9\\ncell:F20:t::b::2:::l:1:f:9\\ncell:G20:b::1::1:f:1:ntvf:1\\ncell:A21:b::1::\\ncell:B21:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C21:t::l:2:f:9\\ncell:D21:t::l:2:f:9\\ncell:E21:t::l:2:f:9\\ncell:F21:t::b::2:::l:1:f:9\\ncell:G21:b::1::1:f:1:ntvf:1\\ncell:A22:b::1::\\ncell:B22:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C22:t::l:2:f:9\\ncell:D22:t::l:2:f:9\\ncell:E22:t::l:2:f:9\\ncell:F22:t::b::2:::l:1:f:9\\ncell:G22:b::1::1:f:1:ntvf:1\\ncell:A23:b::1::\\ncell:B23:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C23:t::l:2:f:9\\ncell:D23:t::l:2:f:9\\ncell:E23:t::l:2:f:9\\ncell:F23:t::b::2:::l:1:f:9\\ncell:G23:b::1::1:f:1:ntvf:1\\ncell:A24:b::1::\\ncell:B24:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C24:t::l:2:f:9\\ncell:D24:t::l:2:f:9\\ncell:E24:t::l:2:f:9\\ncell:F24:t::b::2:::l:1:f:9\\ncell:G24:b::1::1:f:1:ntvf:1\\ncell:A25:b::1::\\ncell:B25:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C25:t::l:2:f:9\\ncell:D25:t::l:2:f:9\\ncell:E25:t::l:2:f:9\\ncell:F25:t::b::2:::l:1:f:9\\ncell:G25:b::1::1:f:1:ntvf:1\\ncell:A26:b::1::\\ncell:B26:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C26:t::l:2:f:9\\ncell:D26:t::l:2:f:9\\ncell:E26:t::l:2:f:9\\ncell:F26:t::b::2:::l:1:f:9\\ncell:G26:b::1::1:f:1:ntvf:1\\ncell:A27:b::1::\\ncell:B27:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C27:t::l:2:f:9\\ncell:D27:t::l:2:f:9\\ncell:E27:t::l:2:f:9\\ncell:F27:t::b::2:::l:1:f:9\\ncell:G27:b::1::1:f:1:ntvf:1\\ncell:A28:b::1::\\ncell:B28:b::1::1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C28:t::l:2:f:9\\ncell:D28:t::l:2:f:9\\ncell:E28:t::l:2:f:9\\ncell:F28:t::b::2:::l:1:f:9\\ncell:G28:b::1::1:f:1:ntvf:1\\ncell:A29:b::1::\\ncell:B29:b::1:1:1:f:1:cf:2:colspan:5:rowspan:1\\ncell:C29:t::b:::2::l:1:f:9\\ncell:D29:t::b:::2::l:1:f:9\\ncell:E29:t::b:::2::l:1:f:9\\ncell:F29:t::b::2:2::l:1:f:9\\ncell:G29:b::1:1:1:f:1:ntvf:1\\ncell:B30:b:2::::l:1:f:9\\ncell:C30:b:2::::l:1:f:9\\ncell:D30:b:2::::l:1:f:9\\ncell:E30:b:2::::l:1:f:10\\ncell:F30:t:Subtotal:b:2::::l:1:f:10\\ncell:G30:vtf:n:0:SUM(G18\\\\cG29):b:1::::f:8:ntvf:1\\ncell:B31:t:NOTES:b:::2::l:1:f:6:cf:2:colspan:3:rowspan:1\\ncell:C31:t::b:::2::l:1:f:9\\ncell:D31:t::b:::2::l:1:f:9\\ncell:F31:t:Tax Rate:l:1:f:1\\ncell:G31:v:0:f:1:ntvf:2\\ncell:B32:b:1::::f:1:cf:2:colspan:3\\ncell:C32:t::b:2::::l:1:f:9\\ncell:D32:t::b:2::::l:1:f:9\\ncell:F32:t:Tax:l:1:f:1\\ncell:G32:vtf:n:0:G31*G30:f:1:ntvf:1\\ncell:B33:f:1:cf:2:colspan:3\\ncell:C33:t::l:2:f:9\\ncell:D33:t::l:2:f:9\\ncell:F33:t:Other:b:::1::l:1:f:1\\ncell:G33:v:0:b:::1::f:1:ntvf:1\\ncell:B34:b:::1::f:1:cf:2:colspan:3:rowspan:1\\ncell:C34:t::l:2:f:9\\ncell:D34:t::l:2:f:9\\ncell:F34:t:TOTAL:b:2::::l:1:f:6\\ncell:G34:vtf:n:0:(G30+G32)+G33:b:1::::f:5:ntvf:1\\ncell:C36:tvf:4:colspan:5:rowspan:7\\ncol:A:w:40\\ncol:B:w:232\\ncol:C:w:53\\ncol:D:w:90\\ncol:E:w:54\\ncol:F:w:91\\ncol:G:w:99\\nrow:1:h:34.5\\nrow:2:h:34.5\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:14.25\\nrow:6:h:14.25\\nrow:7:h:14.25\\nrow:8:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:13:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:17:h:14.25\\nrow:18:h:14.25\\nrow:19:h:14.25\\nrow:20:h:14.25\\nrow:21:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nrow:24:h:14.25\\nrow:25:h:14.25\\nrow:26:h:14.25\\nrow:27:h:14.25\\nrow:28:h:14.25\\nrow:29:h:14.25\\nrow:30:h:14.25\\nrow:31:h:14.25\\nrow:32:h:14.25\\nrow:33:h:14.25\\nrow:34:h:14.25\\nsheet:c:7:r:36:h:12.75:needsrecalc:yes\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\ncellformat:3:right\\ncolor:1:rgb(0, 0, 0)\\ncolor:2:rgb(0,0,0)\\ncolor:3:rgb(221, 221, 221)\\nfont:1:* * Trebuchet MS\\nfont:2:* 10pt *\\nfont:3:* 16pt Trebuchet MS\\nfont:4:italic normal * Trebuchet MS\\nfont:5:normal bold * Trebuchet MS\\nfont:6:normal bold 10pt Trebuchet MS\\nfont:7:normal bold 28pt Trebuchet MS\\nfont:8:normal normal * Trebuchet MS\\nfont:9:normal normal 10pt Arial\\nfont:10:normal normal 10pt Trebuchet MS\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nlayout:3:padding:36px * 28px *;vertical-align:*;\\nvalueformat:1:#,##0.00\\nvalueformat:2:#,##0.00%\\nvalueformat:3:m/d/yy\\nvalueformat:4:text-html\\n\"},\"name\":\"typeiii\",\"hidden\":\"0\"},\"sheet4\":{\"sheetstr\":{\"savestr\":\"version:1.5\\ncell:A1:l:3\\ncell:B2:t:[Company Name]:l:1:f:2:cf:2:colspan:3:rowspan:1\\ncell:C2:t::l:2:f:7\\ncell:D2:t::l:2:f:7\\ncell:F2:t:INVOICE:l:1:f:6:c:1:cf:2:colspan:2\\ncell:G2:t::l:2:f:7\\ncell:B3:t:[Company slogan]:f:3:cf:2:colspan:3:rowspan:1\\ncell:C3:t::l:2:f:7\\ncell:D3:t::l:2:f:7\\ncell:B4:cf:2:colspan:3:rowspan:1\\ncell:F4:tvf:4:rowspan:4\\ncell:B5:t:[Street Address]:f:1:cf:2:colspan:3:rowspan:1\\ncell:F5:l:1:f:5\\ncell:G5:l:1:f:8:cf:1\\ncell:B6:t:[City, State,  Zip]:f:1:cf:2:colspan:3:rowspan:1\\ncell:G6:l:1:f:7\\ncell:B7:t:Phone\\\\c :f:1:cf:2:colspan:3:rowspan:1\\ncell:B8:t:Email\\\\c:f:1:cf:2:colspan:3:rowspan:1\\ncell:B9:cf:2:colspan:3:rowspan:1\\ncell:B10:t:BILL TO\\\\c:l:1:f:5:bg:2:cf:2:colspan:2\\ncell:F10:t:DATE\\\\c:l:1:f:5:cf:2\\ncell:G10:l:1:f:8:cf:2:ntvf:3\\ncell:B11:t:[Name]:f:1:cf:2:colspan:3:rowspan:1\\ncell:F11:t:INVOICE # \\\\c:l:1:f:5:cf:2\\ncell:G11:v:1:l:1:f:8:cf:2\\ncell:B12:t:[Company Name]:f:1:cf:2:colspan:3:rowspan:1\\ncell:J12:tvf:4\\ncell:B13:t:[Street Address]:f:1:cf:2:colspan:3:rowspan:1\\ncell:B14:t:[City, State,  Zip]:f:1:cf:2:colspan:3:rowspan:1\\ncell:B15:t:Phone\\\\c :f:1:cf:2:colspan:3:rowspan:1\\ncell:B16:cf:2:colspan:3:rowspan:1\\ncell:A17:b::1::\\ncell:B17:t:DESCRIPTION:b:1:1:1:1:l:1:f:5:bg:2:cf:1:colspan:3:rowspan:1\\ncell:C17:t::b:1::1::l:1:f:7:bg:2\\ncell:D17:t::b:1::1::l:1:f:7:bg:2\\ncell:E17:t:HOURS:b:1:1:1::l:1:f:5:bg:2:cf:1\\ncell:F17:t:RATE:b:1:1:1::l:1:f:5:bg:2:cf:1\\ncell:G17:t:AMOUNT:b:1:1:1::l:1:f:5:bg:2:cf:1\\ncell:A18:b::1::\\ncell:B18:b:1:1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C18:t::b:2::::l:1:f:7\\ncell:D18:t::b:2:2:::l:1:f:7\\ncell:E18:b:1:1::1:f:1:ntvf:1\\ncell:F18:b:1:1::1:f:1:ntvf:1\\ncell:G18:vtf:t::IF(E18*F18>0,E18*F18,\\\"\\\"):b:1:1:::f:1:ntvf:1\\ncell:A19:b::1::\\ncell:B19:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C19:t::l:2:f:7\\ncell:D19:t::b::2:::l:1:f:7\\ncell:E19:b::1::1:f:1:ntvf:1\\ncell:F19:b::1::1:f:1:ntvf:1\\ncell:G19:vtf:t::IF(E19*F19>0,E19*F19,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A20:b::1::\\ncell:B20:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C20:t::l:2:f:7\\ncell:D20:t::b::2:::l:1:f:7\\ncell:E20:b::1::1:f:1:ntvf:1\\ncell:F20:b::1::1:f:1:ntvf:1\\ncell:G20:vtf:t::IF(E20*F20>0,E20*F20,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A21:b::1::\\ncell:B21:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C21:t::l:2:f:7\\ncell:D21:t::b::2:::l:1:f:7\\ncell:E21:b::1::1:f:1:ntvf:1\\ncell:F21:b::1::1:f:1:ntvf:1\\ncell:G21:vtf:t::IF(E21*F21>0,E21*F21,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A22:b::1::\\ncell:B22:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C22:t::l:2:f:7\\ncell:D22:t::b::2:::l:1:f:7\\ncell:E22:b::1::1:f:1:ntvf:1\\ncell:F22:b::1::1:f:1:ntvf:1\\ncell:G22:vtf:t::IF(E22*F22>0,E22*F22,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A23:b::1::\\ncell:B23:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C23:t::l:2:f:7\\ncell:D23:t::b::2:::l:1:f:7\\ncell:E23:b::1::1:f:1:ntvf:1\\ncell:F23:b::1::1:f:1:ntvf:1\\ncell:G23:vtf:t::IF(E23*F23>0,E23*F23,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A24:b::1::\\ncell:B24:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C24:t::l:2:f:7\\ncell:D24:t::b::2:::l:1:f:7\\ncell:E24:b::1::1:f:1:ntvf:1\\ncell:F24:b::1::1:f:1:ntvf:1\\ncell:G24:vtf:t::IF(E24*F24>0,E24*F24,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A25:b::1::\\ncell:B25:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C25:t::l:2:f:7\\ncell:D25:t::b::2:::l:1:f:7\\ncell:E25:b::1::1:f:1:ntvf:1\\ncell:F25:b::1::1:f:1:ntvf:1\\ncell:G25:vtf:t::IF(E25*F25>0,E25*F25,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A26:b::1::\\ncell:B26:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C26:t::l:2:f:7\\ncell:D26:t::b::2:::l:1:f:7\\ncell:E26:b::1::1:f:1:ntvf:1\\ncell:F26:b::1::1:f:1:ntvf:1\\ncell:G26:vtf:t::IF(E26*F26>0,E26*F26,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A27:b::1::\\ncell:B27:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C27:t::l:2:f:7\\ncell:D27:t::b::2:::l:1:f:7\\ncell:E27:b::1::1:f:1:ntvf:1\\ncell:F27:b::1::1:f:1:ntvf:1\\ncell:G27:vtf:t::IF(E27*F27>0,E27*F27,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A28:b::1::\\ncell:B28:b::1::1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C28:t::l:2:f:7\\ncell:D28:t::b::2:::l:1:f:7\\ncell:E28:b::1::1:f:1:ntvf:1\\ncell:F28:b::1::1:f:1:ntvf:1\\ncell:G28:vtf:t::IF(E28*F28>0,E28*F28,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:A29:b::1::\\ncell:B29:b::1:1:1:f:1:cf:2:colspan:3:rowspan:1\\ncell:C29:t::b:::2::l:1:f:7\\ncell:D29:t::b::2:2::l:1:f:7\\ncell:E29:b::1:1:1:f:1:ntvf:1\\ncell:F29:b::1:1:1:f:1:ntvf:1\\ncell:G29:vtf:t::IF(E29*F29>0,E29*F29,\\\"\\\"):b::1:::f:1:ntvf:1\\ncell:B30:b:2::::l:1:f:8:cf:1:colspan:3:rowspan:1\\ncell:C30:t::b:2::::l:1:f:7\\ncell:D30:t::b:2::::l:1:f:7\\ncell:E30:b:2::::l:1:f:8\\ncell:F30:t:Subtotal:b:1::::f:1\\ncell:G30:vtf:n:0:SUM(G18\\\\cG29):b:1::::f:1:ntvf:1\\ncell:B31:t:NOTES:b:::2::l:1:f:5:cf:2:colspan:3:rowspan:1\\ncell:C31:t::b:::2::l:1:f:7\\ncell:D31:t::b:::2::l:1:f:7\\ncell:F31:t:Tax Rate:f:1\\ncell:G31:v:0:f:1:ntvf:2\\ncell:B32:b:1::::f:1:cf:2:colspan:3:rowspan:1\\ncell:C32:t::b:2::::l:1:f:7\\ncell:D32:t::b:2::::l:1:f:7\\ncell:F32:t:Tax:f:1\\ncell:G32:vtf:n:0:G31*G30:f:1:ntvf:1\\ncell:B33:f:1:cf:2:colspan:3:rowspan:1\\ncell:C33:t::l:2:f:7\\ncell:D33:t::l:2:f:7\\ncell:F33:t:Other:b:::1::l:1:f:1\\ncell:G33:v:0:b:::1::f:1:ntvf:1\\ncell:B34:f:1:cf:2:colspan:3:rowspan:1\\ncell:C34:t::l:2:f:7\\ncell:D34:t::l:2:f:7\\ncell:F34:t:TOTAL:b:1::::l:1:f:4\\ncell:G34:vtf:n:0:(G30+G32)+G33:b:1::::f:4:ntvf:1\\ncell:B35:b:2::::l:1:f:7\\ncell:C35:b:2::::l:1:f:7\\ncell:D35:b:2::::l:1:f:7\\ncell:C36:tvf:4:colspan:5:rowspan:7\\ncol:A:w:40\\ncol:B:w:194\\ncol:C:w:128\\ncol:D:w:60\\ncol:E:w:65\\ncol:F:w:95\\ncol:G:w:90\\nrow:1:h:34.5\\nrow:2:h:34.5\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:14.25\\nrow:6:h:14.25\\nrow:7:h:14.25\\nrow:8:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:13:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:17:h:14.25\\nrow:18:h:14.25\\nrow:19:h:14.25\\nrow:20:h:14.25\\nrow:21:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nrow:24:h:14.25\\nrow:25:h:14.25\\nrow:26:h:14.25\\nrow:27:h:14.25\\nrow:28:h:14.25\\nrow:29:h:14.25\\nrow:30:h:14.25\\nrow:31:h:14.25\\nrow:32:h:14.25\\nrow:33:h:14.25\\nrow:34:h:14.25\\nrow:35:h:14.25\\nsheet:c:10:r:36:h:12.75:needsrecalc:yes\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\ncolor:1:rgb(0,0,0)\\ncolor:2:rgb(221, 221, 221)\\nfont:1:* * Trebuchet MS\\nfont:2:* 16pt Trebuchet MS\\nfont:3:italic normal * Trebuchet MS\\nfont:4:normal bold * Trebuchet MS\\nfont:5:normal bold 10pt Trebuchet MS\\nfont:6:normal bold 28pt Trebuchet MS\\nfont:7:normal normal 10pt Arial\\nfont:8:normal normal 10pt Trebuchet MS\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nlayout:3:padding:36px * 28px *;vertical-align:*;\\nvalueformat:1:#,##0.00\\nvalueformat:2:#,##0.00%\\nvalueformat:3:m/d/yy\\nvalueformat:4:text-html\\n\"},\"name\":\"typeiv\",\"hidden\":\"0\"}},\"EditableCells\":{\"allow\":true,\"cells\":{\"typei!C10\":true,\"typei!B2\":true,\"typei!C11\":true,\"typei!C12\":true,\"typei!C13\":true,\"typei!D9\":true,\"typei!D4\":true,\"typei!D6\":true,\"typei!E10\":true,\"typei!E11\":true,\"typei!E12\":true,\"typei!E13\":true,\"typei!F9\":true,\"typei!C16\":true,\"typei!C17\":true,\"typei!C18\":true,\"typei!C19\":true,\"typei!C20\":true,\"typei!C21\":true,\"typei!C22\":true,\"typei!C23\":true,\"typei!C24\":true,\"typei!C25\":true,\"typei!C26\":true,\"typei!C27\":true,\"typei!C28\":true,\"typei!F16\":true,\"typei!F17\":true,\"typei!F18\":true,\"typei!F19\":true,\"typei!F20\":true,\"typei!F21\":true,\"typei!F22\":true,\"typei!F23\":true,\"typei!F24\":true,\"typei!F25\":true,\"typei!F26\":true,\"typei!F27\":true,\"typei!F28\":true,\"typei!E35\":true,\"typeii!B2\":true,\"typeii!D4\":true,\"typeii!C10\":true,\"typeii!C11\":true,\"typeii!C12\":true,\"typeii!C13\":true,\"typeii!D9\":true,\"typeii!E10\":true,\"typeii!E11\":true,\"typeii!E12\":true,\"typeii!E13\":true,\"typeii!F9\":true,\"typeii!C16\":true,\"typeii!C17\":true,\"typeii!C18\":true,\"typeii!C19\":true,\"typeii!C20\":true,\"typeii!C21\":true,\"typeii!C22\":true,\"typeii!C23\":true,\"typeii!C24\":true,\"typeii!C25\":true,\"typeii!C26\":true,\"typeii!C27\":true,\"typeii!C28\":true,\"typeii!F16\":true,\"typeii!F17\":true,\"typeii!F18\":true,\"typeii!F19\":true,\"typeii!F20\":true,\"typeii!F21\":true,\"typeii!F22\":true,\"typeii!F23\":true,\"typeii!F24\":true,\"typeii!F25\":true,\"typeii!F26\":true,\"typeii!F27\":true,\"typeii!F28\":true,\"typeii!G16\":true,\"typeii!G17\":true,\"typeii!G18\":true,\"typeii!G19\":true,\"typeii!G20\":true,\"typeii!G21\":true,\"typeii!G22\":true,\"typeii!G23\":true,\"typeii!G24\":true,\"typeii!G25\":true,\"typeii!G26\":true,\"typeii!G27\":true,\"typeii!G28\":true,\"typeii!E35\":true,\"typeiii!G9\":true,\"typeiii!G10\":true,\"typeiii!B2\":true,\"typeiii!B3\":true,\"typeiii!B4\":true,\"typeiii!B5\":true,\"typeiii!B6\":true,\"typeiii!B7\":true,\"typeiii!B8\":true,\"typeiii!B9\":true,\"typeiii!B11\":true,\"typeiii!B12\":true,\"typeiii!B13\":true,\"typeiii!B14\":true,\"typeiii!B15\":true,\"typeiii!B18\":true,\"typeiii!B19\":true,\"typeiii!B20\":true,\"typeiii!B21\":true,\"typeiii!B22\":true,\"typeiii!B23\":true,\"typeiii!B24\":true,\"typeiii!B25\":true,\"typeiii!B26\":true,\"typeiii!B27\":true,\"typeiii!B28\":true,\"typeiii!B29\":true,\"typeiii!G18\":true,\"typeiii!G19\":true,\"typeiii!G20\":true,\"typeiii!G21\":true,\"typeiii!G22\":true,\"typeiii!G23\":true,\"typeiii!G24\":true,\"typeiii!G25\":true,\"typeiii!G26\":true,\"typeiii!G27\":true,\"typeiii!G28\":true,\"typeiii!G29\":true,\"typeiii!B32\":true,\"typeiii!B33\":true,\"typeiii!B34\":true,\"typeiii!G31\":true,\"typeiii!G33\":true,\"typeiii!B37\":true,\"typeiv!G9\":true,\"typeiv!G10\":true,\"typeiv!B2\":true,\"typeiv!B3\":true,\"typeiv!B4\":true,\"typeiv!B5\":true,\"typeiv!B6\":true,\"typeiv!B7\":true,\"typeiv!B8\":true,\"typeiv!B11\":true,\"typeiv!B12\":true,\"typeiv!B13\":true,\"typeiv!B14\":true,\"typeiv!B15\":true,\"typeiv!B16\":true,\"typeiv!B18\":true,\"typeiv!B19\":true,\"typeiv!B20\":true,\"typeiv!B21\":true,\"typeiv!B22\":true,\"typeiv!B23\":true,\"typeiv!B24\":true,\"typeiv!B25\":true,\"typeiv!B26\":true,\"typeiv!B27\":true,\"typeiv!B28\":true,\"typeiv!B29\":true,\"typeiv!E18\":true,\"typeiv!E19\":true,\"typeiv!E20\":true,\"typeiv!E21\":true,\"typeiv!E22\":true,\"typeiv!E23\":true,\"typeiv!E24\":true,\"typeiv!E25\":true,\"typeiv!E26\":true,\"typeiv!E27\":true,\"typeiv!E28\":true,\"typeiv!E29\":true,\"typeiv!F18\":true,\"typeiv!F19\":true,\"typeiv!F2\":true,\"typeiv!F20\":true,\"typeiv!F21\":true,\"typeiv!F22\":true,\"typeiv!F23\":true,\"typeiv!F24\":true,\"typeiv!F25\":true,\"typeiv!F26\":true,\"typeiv!F27\":true,\"typeiv!F28\":true,\"typeiv!F29\":true,\"typeiv!B32\":true,\"typeiv!B33\":true,\"typeiv!B34\":true,\"typeiv!G31\":true,\"typeiv!G33\":true,\"typeiv!B37\":true,\"typeii!F15\":true,\"typeii!G15\":true,\"typeiv!E17\":true,\"typeiv!F17\":true,\"typeii!D6\":true,\"typeiv!G11\":true,\"typei!C4\":true,\"typeii!C4\":true,\"typeiii!F10\":true,\"typeiv!F11\":true,\"typeiv!F10\":true,\"typeiii!F9\":true,\"typeii!C6\":true,\"typei!C6\":true,\"typei!F4\":true,\"typeii!F4\":true,\"typeiii!F4\":true,\"typeiii!F2\":true,\"typeiv!F4\":true,\"typei!F29\":true,\"typeii!H29\":true,\"typeiii!G30\":true,\"typeiii!G34\":true,\"typeiv!G30\":true,\"typeiv!G34\":true},\"constraints\":{}}},\n        \t\"footers\": [{name: 'Invoice 1' , index: 1, isActive: true }, {name: 'Invoice 2' , index: 2, isActive: false}, \n                        {name: 'Company Invoice 1' , index: 3, isActive: false}, {name: 'Company Invoice 2' , index: 4, isActive: false}]\n        },\n        \"iPhone\":{\n        \t\"msc\": {\"numsheets\":5,\"currentid\":\"sheet1\",\"currentname\":\"inv1\",\"sheetArr\":{\"sheet1\":{\"sheetstr\":{\"savestr\":\"version:1.5\\ncell:B1:b:::2::l:1:f:10\\ncell:C1:b:::2::l:1:f:10\\ncell:D1:b:::2::l:1:f:10\\ncell:E1:b:::2::l:1:f:10\\ncell:F1:b:::2::l:1:f:10\\ncell:G1:b:::2::l:1:f:10\\ncell:A2:b::2:::l:1:f:10\\ncell:B2:t:INVOICE:b:1:1:1:1:f:13:cf:1:colspan:6\\ncell:C2:t::b:2::2::l:1:f:10\\ncell:D2:t::b:2::2::l:1:f:10\\ncell:E2:t::b:2::2::l:1:f:10\\ncell:F2:t::b:2::2::l:1:f:10\\ncell:G2:t::b:2::2::l:1:f:10\\ncell:A3:b::2:::l:3:f:10\\ncell:B3:b:2:::2:l:3:f:10\\ncell:C3:b:2::::l:1:f:10\\ncell:D3:b:2::::l:1:f:10\\ncell:E3:b:2::::l:1:f:10\\ncell:F3:b:2::::l:1:f:10\\ncell:G3:b:2:2:::l:3:f:10\\ncell:A4:b::2:::l:3:f:10\\ncell:B4:b::::2:l:3:f:6\\ncell:C4:t:BILL TO\\\\c:f:9:colspan:2\\ncell:E4:f:5:cf:2\\ncell:G4:b::2:::l:3:f:10\\ncell:A5:b::2:::l:3:f:10\\ncell:B5:b::::2:l:3:f:7\\ncell:C5:t:[Name]:f:9:cf:2:colspan:3\\ncell:E5:f:1:cf:2\\ncell:F5:t::l:2:f:10:tvf:4:rowspan:6\\ncell:G5:t::b::1:::l:2:f:10\\ncell:A6:b::2:::l:3:f:10\\ncell:B6:b::::2:l:3:f:7\\ncell:C6:t:[Street Address]:f:9:cf:2:colspan:3\\ncell:E6:f:1:cf:2\\ncell:F6:l:2:f:10\\ncell:G6:b::1:::l:2:f:10\\ncell:A7:b::2:::l:3:f:10\\ncell:B7:b::::2:l:3:f:7\\ncell:C7:t:[City, State, Zip]:f:9:cf:2:colspan:3\\ncell:E7:f:1:cf:2\\ncell:G7:b::2:::l:3:f:10\\ncell:A8:b::2:::l:3:f:10\\ncell:B8:b::::2:l:3:f:7\\ncell:C8:t:Phone\\\\c:f:9:cf:2:colspan:3\\ncell:D8:f:8:cf:2\\ncell:E8:f:1:cf:2\\ncell:G8:b::2:::l:3:f:10\\ncell:A9:b::2:::l:3:f:10\\ncell:B9:b::::2:l:3:f:7\\ncell:C9:t:Email\\\\c:f:9:cf:2:colspan:3\\ncell:E9:f:1:cf:2\\ncell:G9:b::2:::l:3:f:10\\ncell:A10:b::2:::l:3:f:10\\ncell:B10:b::::2:l:3:f:7\\ncell:C10:colspan:2\\ncell:G10:b::2:::l:3:f:10\\ncell:A11:b::2:::l:3:f:10\\ncell:B11:b::::2:l:3:f:7\\ncell:C11:t:FROM\\\\c:f:9:colspan:2\\ncell:E11:f:8:colspan:2\\ncell:G11:b::2:::l:3:f:10\\ncell:A12:b::2:::l:3:f:10\\ncell:B12:b::::2:l:3:f:7\\ncell:C12:t:[Name]:f:9:colspan:4\\ncell:E12:colspan:2\\ncell:G12:b::2:::l:3:f:10\\ncell:A13:b::2:::l:3:f:10\\ncell:B13:b::::2:l:3:f:7\\ncell:C13:t:[Street Address]:f:9:colspan:4\\ncell:E13:colspan:2\\ncell:G13:b::2:::l:3:f:10\\ncell:A14:b::2:::l:3:f:10\\ncell:B14:b::::2:l:3:f:7\\ncell:C14:t:[City, State, Zip]:f:9:colspan:4\\ncell:E14:colspan:2\\ncell:G14:b::2:::l:3:f:10\\ncell:A15:b::2:::l:3:f:10\\ncell:B15:b::::2:l:3:f:7\\ncell:C15:t:Phone\\\\c:f:9:colspan:4\\ncell:D15:f:8:cf:2:colspan:3\\ncell:E15:colspan:2\\ncell:G15:b::2:::l:3:f:10\\ncell:A16:b::2:::l:3:f:10\\ncell:B16:b::::2:l:3:f:7\\ncell:C16:t:Email\\\\c:f:9:colspan:4\\ncell:E16:colspan:2\\ncell:G16:b::2:::l:3:f:10\\ncell:A17:b::2:::l:3:f:10\\ncell:B17:b::::2:l:3:f:6\\ncell:G17:b::2:::l:3:f:10\\ncell:A18:b::2:::l:3:f:10\\ncell:B18:b::::2:l:3:f:10\\ncell:C18:t:INVOICE #\\\\c:f:9:cf:2:colspan:4\\ncell:D18:v:1:l:4:f:9:cf:2:colspan:3\\ncell:G18:b::2:::l:3:f:10\\ncell:A19:b::2:::l:3:f:10\\ncell:B19:b::::2:l:3:f:10\\ncell:G19:b::2:::l:3:f:10\\ncell:A20:b::2:::l:3:f:10\\ncell:B20:b::::2:l:3:f:10\\ncell:C20:t:DATE\\\\c:f:9:cf:2\\ncell:D20:vtf:nd:42081:TODAY():f:9:cf:2:ntvf:3:colspan:2\\ncell:G20:b::2:::l:3:f:10\\ncell:A21:b::2:::l:3:f:10\\ncell:B21:b::::2:l:3:f:6:cf:2\\ncell:C21:b:::2::l:1:f:10\\ncell:D21:b:::2::l:3:f:6:cf:2\\ncell:E21:b:::2::l:1:f:10\\ncell:F21:b:::2::l:1:f:10\\ncell:G21:b::2:::l:3:f:10\\ncell:A22:b::2:::l:3:f:10\\ncell:B22:b::2::2:l:3:f:10\\ncell:C22:t:Description:b:1::1:1:f:9:cf:1:colspan:3\\ncell:D22:t:Description:b:1::1::l:3:f:6:cf:2:colspan:2:rowspan:1\\ncell:E22:t::b:2:2:2::l:1:f:10\\ncell:F22:t:Amount:b:1:1:1:1:f:9:cf:1\\ncell:G22:b::2::2:l:3:f:10\\ncell:A23:b::2:::l:3:f:10\\ncell:B23:b::2::2:l:3:f:10\\ncell:C23:b:1:1::1:f:2:cf:2:colspan:3\\ncell:D23:b:1:1:::l:3:f:10:cf:2:colspan:2:rowspan:1\\ncell:E23:t::b:2:2:2::l:1:f:10\\ncell:F23:b:1:1:::f:2:ntvf:1\\ncell:G23:b::2::2:l:3:f:10\\ncell:A24:b::2:::l:3:f:10\\ncell:B24:b::2::2:l:3:f:10:cf:2\\ncell:C24:b::1::1:f:2:cf:2:colspan:3\\ncell:D24:b::1:::l:1:f:10:colspan:2\\ncell:E24:l:1:f:10\\ncell:F24:b::1:::f:2:ntvf:1\\ncell:G24:b::2::2:l:3:f:10\\ncell:A25:b::2:::l:3:f:10\\ncell:B25:b::2::2:l:3:f:10:cf:2:ntvf:2\\ncell:C25:b::1::1:f:2:cf:2:colspan:3\\ncell:D25:b::1:::colspan:2\\ncell:F25:b::1:::f:2:ntvf:1\\ncell:G25:b::2::2:l:3:f:10\\ncell:A26:b::2:::l:3:f:10\\ncell:B26:b::2::2:l:3:f:10:cf:2:ntvf:2\\ncell:C26:b::1::1:f:2:cf:2:colspan:3\\ncell:D26:b::1:::colspan:2\\ncell:F26:b::1:::f:2:ntvf:1\\ncell:G26:b::2::2:l:3:f:10\\ncell:A27:b::2:::l:3:f:10\\ncell:B27:b::2::2:l:3:f:10:cf:2:ntvf:2\\ncell:C27:b::1::1:f:2:cf:2:colspan:3\\ncell:D27:b::1:::colspan:2\\ncell:F27:b::1:::f:2:ntvf:1\\ncell:G27:b::2::2:l:3:f:10\\ncell:A28:b::2:::l:3:f:10\\ncell:B28:b::2::2:l:3:f:10:cf:2:ntvf:2\\ncell:C28:b::1::1:f:2:cf:2:colspan:3\\ncell:D28:b::1:::colspan:2\\ncell:F28:b::1:::f:2:ntvf:1\\ncell:G28:b::2::2:l:3:f:10\\ncell:A29:b::2:::l:3:f:10\\ncell:B29:b::2::2:l:3:f:10:cf:2:ntvf:2\\ncell:C29:b::1::1:f:2:cf:2:colspan:3\\ncell:D29:b::1:::colspan:2\\ncell:F29:b::1:::f:2:ntvf:1\\ncell:G29:b::2::2:l:3:f:10\\ncell:A30:b::2:::l:3:f:10\\ncell:B30:b::2::2:l:3:f:10:cf:2\\ncell:C30:b::1::1:f:2:cf:2:colspan:3\\ncell:D30:b::1:::colspan:2\\ncell:F30:b::1:::f:2:ntvf:1\\ncell:G30:b::2::2:l:3:f:10\\ncell:A31:b::2:::l:3:f:10\\ncell:B31:b::2::2:l:3:f:10:cf:2\\ncell:C31:b::1::1:f:2:cf:2:colspan:3\\ncell:D31:b::1:::colspan:2\\ncell:F31:b::1:::f:2:ntvf:1\\ncell:G31:b::2::2:l:3:f:10\\ncell:A32:b::2:::l:3:f:10\\ncell:B32:b::2::2:l:3:f:10:cf:2\\ncell:C32:b::1::1:f:2:cf:2:colspan:3\\ncell:D32:b::1:::colspan:2\\ncell:F32:b::1:::f:2:ntvf:1\\ncell:G32:b::2::2:l:3:f:10\\ncell:A33:b::2:::l:3:f:10\\ncell:B33:b::2::2:l:3:f:10:cf:2\\ncell:C33:b::1::1:f:2:cf:2:colspan:3\\ncell:D33:b::1:::colspan:2\\ncell:F33:b::1:::f:2:ntvf:1\\ncell:G33:b::2::2:l:3:f:10\\ncell:A34:b::2:::l:3:f:10\\ncell:B34:b::2::2:l:3:f:10:cf:2\\ncell:C34:b::1::1:f:2:cf:2:colspan:3\\ncell:D34:b::1:::colspan:2\\ncell:F34:b::1:::f:2:ntvf:1\\ncell:G34:b::2::2:l:3:f:10\\ncell:A35:b::2:::l:3:f:7\\ncell:B35:b::2::2:l:3:f:10:cf:2\\ncell:C35:b::1:1:1:f:2:cf:2:colspan:3\\ncell:D35:b::1:1::l:3:f:10:cf:2:colspan:2\\ncell:E35:b:::2::l:3:f:10:cf:2\\ncell:F35:b::1:1::f:2:ntvf:1\\ncell:G35:b::2::2:l:3:f:10\\ncell:A36:b::2:::l:3:f:6\\ncell:B36:b::2::2:l:3:f:6\\ncell:C36:t:TOTAL:b:1:1:1:1:f:11:cf:2:colspan:3\\ncell:D36:b:2::2::l:3:f:12:cf:2\\ncell:E36:b:2:2:2::l:3:f:12:cf:2\\ncell:F36:vtf:n:0:SUM(F23\\\\cF35):b:1:1:1::f:11:ntvf:1\\ncell:G36:b::2::2:l:3:f:7\\ncell:A37:b::2:::l:3:f:10\\ncell:B37:b::::2:l:3:f:6:cf:2\\ncell:C37:b:2::::l:1:f:10\\ncell:D37:b:2::::l:1:f:10\\ncell:E37:b:2::::l:1:f:10\\ncell:F37:b:2::::l:1:f:10\\ncell:G37:b::2:::l:3:f:6\\ncell:A38:b::2:::l:3:f:10\\ncell:B38:b::::2:l:3:f:10\\ncell:G38:b::2:::l:3:f:10\\ncell:A39:b::2:::l:3:f:10\\ncell:B39:b::::2:l:3:f:10:cf:2\\ncell:C39:t:Thank you for your business:f:4:cf:1:colspan:4\\ncell:D39:t:Thank you for your business:colspan:3\\ncell:E39:t:Thank you for your business:f:3:colspan:2\\ncell:F39:t::l:2:f:10\\ncell:G39:b::2:::l:3:f:10\\ncell:A40:b::2:::l:3:f:10\\ncell:B40:b::::2:l:3:f:10\\ncell:G40:b::2:::l:3:f:10\\ncell:A41:b::2:::l:3:f:10\\ncell:B41:b:::2:2:l:3:f:10\\ncell:C41:b:::2::l:3:f:10\\ncell:D41:b:::2::l:3:f:10\\ncell:E41:b:::2::l:3:f:10\\ncell:F41:b:::2::l:3:f:10\\ncell:G41:b::2:2::l:3:f:10\\ncell:B42:b:1:::\\ncell:C42:b:1:::\\ncell:D42:b:1:::\\ncell:E42:b:1:::\\ncell:F42:b:1:::\\ncell:G42:b:1:::\\ncol:A:w:10\\ncol:B:w:10\\ncol:C:w:62\\ncol:D:w:73\\ncol:E:w:15\\ncol:F:w:68\\ncol:G:w:10\\nrow:1:h:14.25\\nrow:2:h:18.75\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:15.75\\nrow:6:h:15.75\\nrow:7:h:15.75\\nrow:8:h:15.75\\nrow:9:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:13:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:16:h:14.25\\nrow:17:h:14.25\\nrow:18:h:14.25\\nrow:19:h:14.25\\nrow:20:h:14.25\\nrow:21:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nrow:24:h:14.25\\nrow:25:h:14.25\\nrow:26:h:14.25\\nrow:27:h:14.25\\nrow:28:h:14.25\\nrow:29:h:14.25\\nrow:30:h:14.25\\nrow:31:h:14.25\\nrow:32:h:14.25\\nrow:33:h:14.25\\nrow:34:h:14.25\\nrow:35:h:15.75\\nrow:36:h:15.75\\nrow:37:h:14.25\\nrow:38:h:14.25\\nrow:39:h:14.25\\nrow:40:h:14.25\\nrow:41:h:14.25\\nsheet:c:7:r:42:h:12.75\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\nfont:1:* * Trebuchet MS\\nfont:2:* 9pt Trebuchet MS\\nfont:3:italic bold * Trebuchet MS\\nfont:4:italic bold 10pt Trebuchet MS\\nfont:5:normal bold * Trebuchet MS\\nfont:6:normal bold 10pt Arial\\nfont:7:normal bold 12pt Arial\\nfont:8:normal normal * *\\nfont:9:normal normal * Trebuchet MS\\nfont:10:normal normal 10pt Arial\\nfont:11:normal normal 11pt Trebuchet MS\\nfont:12:normal normal 12pt Arial\\nfont:13:normal normal 16pt Trebuchet MS\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nlayout:3:padding:* * * *;vertical-align:top;\\nlayout:4:padding:* * * 4px;vertical-align:*;\\nvalueformat:1:#,##0.00\\nvalueformat:2:d-mmm\\nvalueformat:3:m/d/yy\\nvalueformat:4:text-html\\n\"},\"name\":\"inv1\",\"hidden\":\"0\"},\"sheet2\":{\"sheetstr\":{\"savestr\":\"version:1.5\\ncell:B2:t:INVOICE:l:1:f:9:cf:1:colspan:6\\ncell:C2:t::l:2:f:13\\ncell:D2:t::l:2:f:13\\ncell:E2:l:1:f:10:c:2:cf:3\\ncell:F2:t:INVOICE:l:1:f:8:c:2:cf:2:colspan:2\\ncell:G2:t::l:2:f:13\\ncell:B3:f:6:cf:2:colspan:4\\ncell:C3:t::l:2:f:13\\ncell:D3:t::l:2:f:13\\ncell:F3:l:1:f:7:cf:2\\ncell:G3:l:1:f:14:cf:2:ntvf:3\\ncell:B4:f:2:colspan:2\\ncell:F4:t:DATE\\\\c:l:1:f:14:cf:2\\ncell:G4:vtf:nd:42081:TODAY():l:1:f:14:cf:2:ntvf:3\\ncell:B5:t:INVOICE #\\\\c:f:3:colspan:6\\ncell:C5:cf:2:colspan:5\\ncell:F5:l:1:f:7:cf:2:colspan:2\\ncell:G5:l:1:f:14:cf:2\\ncell:B6:f:2:colspan:2\\ncell:F6:l:1:f:7:cf:2:colspan:2\\ncell:G6:l:1:f:14:cf:2\\ncell:B7:t:FROM\\\\c:f:12\\ncell:F7:l:1:f:7:cf:2:tvf:4:colspan:2:rowspan:6\\ncell:G7:l:1:f:14:cf:2\\ncell:B8:t:[Company Name]:f:3:colspan:4\\ncell:F8:l:1:f:7:cf:2:colspan:2\\ncell:G8:l:1:f:14:cf:2\\ncell:B9:t:[Street Address]:f:1:cf:2:colspan:4\\ncell:F9:l:1:f:7\\ncell:G9:l:1:f:14:cf:1\\ncell:B10:t:[City, State,  Zip]:f:1:cf:2:colspan:4\\ncell:G10:l:1:f:13\\ncell:B11:t:Phone\\\\c :f:1:cf:2:colspan:4\\ncell:B12:t:Email\\\\c:f:1:cf:2:colspan:4\\ncell:B13:colspan:2\\ncell:B14:t:BILL TO\\\\c:f:11:cf:2\\ncell:B15:t:[Name]:f:1:cf:2:colspan:6\\ncell:B16:t:[Company Name]:f:1:cf:2:colspan:6\\ncell:F16:t:  \\ncell:B17:t:[Street Address]:f:1:cf:2:colspan:6\\ncell:B18:t:[City, State,  Zip]:f:1:cf:2:colspan:6\\ncell:B19:t:Phone\\\\c :f:1:cf:2:colspan:6\\ncell:B20:t:Email\\\\c:f:1:cf:2:colspan:6\\ncell:A22:b::1::\\ncell:B22:t:DESCRIPTION:b:1:1:1:1:l:1:f:14:c:1:bg:3:cf:1:colspan:5:rowspan:1\\ncell:C22:t::l:2:f:13\\ncell:D22:t::l:2:f:13\\ncell:E22:t::l:2:f:13\\ncell:F22:t::l:2:f:13\\ncell:G22:t:AMOUNT:b:1:1:1::l:1:f:14:c:1:bg:3:cf:1\\ncell:A23:b::1::\\ncell:B23:b:1:1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C23:t::l:2:f:4\\ncell:D23:t::l:2:f:4\\ncell:E23:t::l:2:f:4\\ncell:F23:t::b::2:::l:1:f:4\\ncell:G23:b::1::1:f:4:ntvf:1\\ncell:A24:b::1::\\ncell:B24:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C24:t::l:2:f:4\\ncell:D24:t::l:2:f:4\\ncell:E24:t::l:2:f:4\\ncell:F24:t::b::2:::l:1:f:4\\ncell:G24:b::1::1:f:4:ntvf:1\\ncell:A25:b::1::\\ncell:B25:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C25:t::l:2:f:4\\ncell:D25:t::l:2:f:4\\ncell:E25:t::l:2:f:4\\ncell:F25:t::b::2:::l:1:f:4\\ncell:G25:b::1::1:f:4:ntvf:1\\ncell:A26:b::1::\\ncell:B26:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C26:t::l:2:f:4\\ncell:D26:t::l:2:f:4\\ncell:E26:t::l:2:f:4\\ncell:F26:t::b::2:::l:1:f:4\\ncell:G26:b::1::1:f:4:ntvf:1\\ncell:A27:b::1::\\ncell:B27:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C27:t::l:2:f:4\\ncell:D27:t::l:2:f:4\\ncell:E27:t::l:2:f:4\\ncell:F27:t::b::2:::l:1:f:4\\ncell:G27:b::1::1:f:4:ntvf:1\\ncell:A28:b::1::\\ncell:B28:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C28:t::l:2:f:4\\ncell:D28:t::l:2:f:4\\ncell:E28:t::l:2:f:4\\ncell:F28:t::b::2:::l:1:f:4\\ncell:G28:b::1::1:f:4:ntvf:1\\ncell:A29:b::1::\\ncell:B29:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C29:t::l:2:f:4\\ncell:D29:t::l:2:f:4\\ncell:E29:t::l:2:f:4\\ncell:F29:t::b::2:::l:1:f:4\\ncell:G29:b::1::1:f:4:ntvf:1\\ncell:A30:b::1::\\ncell:B30:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C30:t::l:2:f:4\\ncell:D30:t::l:2:f:4\\ncell:E30:t::l:2:f:4\\ncell:F30:t::b::2:::l:1:f:4\\ncell:G30:b::1::1:f:4:ntvf:1\\ncell:A31:b::1::\\ncell:B31:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C31:t::l:2:f:4\\ncell:D31:t::l:2:f:4\\ncell:E31:t::l:2:f:4\\ncell:F31:t::b::2:::l:1:f:4\\ncell:G31:b::1::1:f:4:ntvf:1\\ncell:A32:b::1::\\ncell:B32:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C32:t::l:2:f:4\\ncell:D32:t::l:2:f:4\\ncell:E32:t::l:2:f:4\\ncell:F32:t::b::2:::l:1:f:4\\ncell:G32:b::1::1:f:4:ntvf:1\\ncell:A33:b::1::\\ncell:B33:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C33:t::l:2:f:4\\ncell:D33:t::l:2:f:4\\ncell:E33:t::l:2:f:4\\ncell:F33:t::b::2:::l:1:f:4\\ncell:G33:b::1::1:f:4:ntvf:1\\ncell:A34:b::1::\\ncell:B34:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C34:l:2:f:4\\ncell:D34:l:2:f:4\\ncell:E34:l:2:f:4\\ncell:F34:b::2:::l:1:f:4\\ncell:G34:b::1::1:f:4:ntvf:1\\ncell:A35:b::1::\\ncell:B35:b::1:1:1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C35:t::b:::2::l:1:f:4\\ncell:D35:t::b:::2::l:1:f:4\\ncell:E35:t::b:::2::l:1:f:4\\ncell:F35:t::b::2:2::l:1:f:4\\ncell:G35:b::1:1:1:f:4:ntvf:1\\ncell:B36:b:2::::l:1:f:13\\ncell:C36:b:2::::l:1:f:13\\ncell:D36:b:2::::l:1:f:13\\ncell:E36:b:2::::l:1:f:14\\ncell:F36:t:Subtotal:b:2::::l:1:f:11\\ncell:G36:vtf:n:0:SUM(G23\\\\cG35):b:1::::f:11:ntvf:1\\ncell:B37:t:NOTES:b:::1::l:1:f:14:cf:2:colspan:3:rowspan:1\\ncell:C37:t::b:::2::l:1:f:13\\ncell:D37:t::b:::2::l:1:f:13\\ncell:F37:t:Tax Rate:l:1:f:11\\ncell:G37:v:0:f:1:ntvf:2\\ncell:B38:b:1::::f:1:cf:2:colspan:3\\ncell:C38:t::b:2::::l:1:f:13\\ncell:D38:t::b:2::::l:1:f:13\\ncell:F38:t:Tax:l:1:f:11\\ncell:G38:vtf:n:0:G37*G36:f:1:ntvf:1\\ncell:B39:f:1:cf:2:colspan:3\\ncell:C39:t::l:2:f:13\\ncell:D39:t::l:2:f:13\\ncell:F39:t:Other:b:::1::l:1:f:11\\ncell:G39:v:0:b:::1::f:1:ntvf:1\\ncell:B40:b:::1::f:1:cf:2:colspan:3:rowspan:1\\ncell:C40:t::l:2:f:13\\ncell:D40:t::l:2:f:13\\ncell:F40:t:TOTAL:b:1::::l:1:f:14\\ncell:G40:vtf:n:0:(G36+G38)+G39:b:1::::f:11:ntvf:1\\ncell:B43:t:Thank you for your business:l:1:f:5:cf:1:colspan:6:rowspan:1\\ncell:C43:t::l:2:f:13\\ncell:D43:t::l:2:f:13\\ncell:E43:t::l:2:f:13\\ncell:F43:t::l:2:f:13\\ncell:G43:t::l:2:f:13\\ncol:A:w:10\\ncol:B:w:90\\ncol:C:w:19\\ncol:D:w:10\\ncol:E:w:16\\ncol:F:w:45\\ncol:G:w:64\\nrow:1:h:34.5\\nrow:2:h:34.5\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:14.25\\nrow:6:h:14.25\\nrow:7:h:14.25\\nrow:8:h:14.25\\nrow:9:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:16:h:14.25\\nrow:17:h:14.25\\nrow:18:h:14.25\\nrow:19:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nrow:24:h:14.25\\nrow:25:h:14.25\\nrow:26:h:14.25\\nrow:27:h:14.25\\nrow:28:h:14.25\\nrow:29:h:14.25\\nrow:30:h:14.25\\nrow:31:h:14.25\\nrow:32:h:14.25\\nrow:33:h:14.25\\nrow:34:h:14.25\\nrow:35:h:14.25\\nrow:36:h:14.25\\nrow:37:h:14.25\\nrow:38:h:14.25\\nrow:39:h:14.25\\nrow:40:h:14.25\\nrow:43:h:15.75\\nsheet:c:7:r:43:h:12.75:needsrecalc:yes\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\ncellformat:3:right\\ncolor:1:rgb(0, 0, 0)\\ncolor:2:rgb(0,0,0)\\ncolor:3:rgb(221, 221, 221)\\nfont:1:* * Trebuchet MS\\nfont:2:* 10pt *\\nfont:3:* 10pt Trebuchet MS\\nfont:4:* 9pt Trebuchet MS\\nfont:5:italic bold 10pt Trebuchet MS\\nfont:6:italic normal * Trebuchet MS\\nfont:7:normal bold 10pt Trebuchet MS\\nfont:8:normal bold 14pt Trebuchet MS\\nfont:9:normal bold 16pt Trebuchet MS\\nfont:10:normal bold 28pt Trebuchet MS\\nfont:11:normal normal * Trebuchet MS\\nfont:12:normal normal 10pt *\\nfont:13:normal normal 10pt Arial\\nfont:14:normal normal 10pt Trebuchet MS\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nvalueformat:1:#,##0.00\\nvalueformat:2:#,##0.00%\\nvalueformat:3:m/d/yy\\nvalueformat:4:text-html\\n\"},\"name\":\"inv2\",\"hidden\":\"0\"},\"sheet3\":{\"sheetstr\":{\"savestr\":\"version:1.5\\ncell:B2:t:INVOICE:l:1:f:12:cf:1:colspan:6\\ncell:C2:t::l:2:f:10\\ncell:D2:t::l:2:f:10\\ncell:E2:l:1:f:8:c:2:cf:3\\ncell:F2:t:INVOICE:l:1:f:7:c:2:cf:2:colspan:2\\ncell:G2:t::l:2:f:10\\ncell:B3:f:5:cf:2:colspan:4\\ncell:C3:t::l:2:f:10\\ncell:D3:t::l:2:f:10\\ncell:F3:l:1:f:6:cf:2\\ncell:G3:l:1:f:11:cf:2:ntvf:3\\ncell:B4:f:2:colspan:2\\ncell:F4:t:DATE\\\\c:l:1:f:11:cf:2\\ncell:G4:vtf:nd:42081:TODAY():l:1:f:11:cf:2:ntvf:3\\ncell:B5:t:INVOICE #\\\\c:f:9:colspan:6\\ncell:C5:cf:2:colspan:5\\ncell:F5:l:1:f:6:cf:2:colspan:2\\ncell:G5:l:1:f:11:cf:2\\ncell:B6:f:2:colspan:2\\ncell:F6:l:1:f:6:cf:2:colspan:2\\ncell:G6:l:1:f:11:cf:2\\ncell:B7:t:FROM\\\\c:f:11\\ncell:F7:l:1:f:6:cf:2:colspan:2\\ncell:G7:l:1:f:11:cf:2\\ncell:B8:t:[Company Name]:f:9:colspan:4\\ncell:F8:l:1:f:6:cf:2:tvf:4:colspan:2:rowspan:5\\ncell:G8:l:1:f:11:cf:2\\ncell:B9:t:[Street Address]:f:9:cf:2:colspan:4\\ncell:F9:l:1:f:6\\ncell:G9:l:1:f:11:cf:1\\ncell:B10:t:[City, State,  Zip]:f:9:cf:2:colspan:4\\ncell:G10:l:1:f:10\\ncell:B11:t:Phone\\\\c :f:9:cf:2:colspan:4\\ncell:B12:t:Email\\\\c:f:9:cf:2:colspan:4\\ncell:B13:colspan:2\\ncell:B14:t:BILL TO\\\\c:f:9:cf:2\\ncell:B15:t:[Name]:f:9:cf:2:colspan:6\\ncell:B16:t:[Company Name]:f:9:cf:2:colspan:6\\ncell:F16:t:  \\ncell:B17:t:[Street Address]:f:9:cf:2:colspan:6\\ncell:B18:t:[City, State,  Zip]:f:9:cf:2:colspan:6\\ncell:B19:t:Phone\\\\c :f:9:cf:2:colspan:6\\ncell:B20:t:Email\\\\c:f:9:cf:2:colspan:6\\ncell:A22:b::1::\\ncell:B22:t:DESCRIPTION:b:1:1:1:1:l:1:f:11:c:1:bg:3:cf:1:colspan:5:rowspan:1\\ncell:C22:t::l:2:f:10\\ncell:D22:t::l:2:f:10\\ncell:E22:t::l:2:f:10\\ncell:F22:t::l:2:f:10\\ncell:G22:t:AMOUNT:b:1:1:1::l:1:f:11:c:1:bg:3:cf:1\\ncell:A23:b::1::\\ncell:B23:vtf:t: :IF(AND(ISBLANK(inv3!B6),ISBLANK(sheet7!B6)), \\\" \\\", IF(ISBLANK(inv3!B6), sheet7!B6, inv3!B6)):b:1:1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C23:t::l:2:f:3\\ncell:D23:t::l:2:f:3\\ncell:E23:t::l:2:f:3\\ncell:F23:t::b::2:::l:1:f:3\\ncell:G23:vtf:t: :IF(AND(ISBLANK(inv3!B6),ISBLANK(sheet7!B6)), \\\" \\\", IF(ISBLANK(inv3!B6), (sheet7!E6*sheet7!F6), (inv3!E6*inv3!F6))):b::1::1:f:3:ntvf:1\\ncell:A24:b::1::\\ncell:B24:vtf:t: :IF(AND(ISBLANK(INV3!B7),ISBLANK(SHEET7!B7)), \\\" \\\", IF(ISBLANK(INV3!B7), SHEET7!B7, INV3!B7)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C24:t::l:2:f:3\\ncell:D24:t::l:2:f:3\\ncell:E24:t::l:2:f:3\\ncell:F24:t::b::2:::l:1:f:3\\ncell:G24:vtf:t: :IF(AND(ISBLANK(INV3!B7),ISBLANK(SHEET7!B7)), \\\" \\\", IF(ISBLANK(INV3!B7), (SHEET7!E7*SHEET7!F7), (INV3!E7*INV3!F7))):b::1::1:f:3:ntvf:1\\ncell:A25:b::1::\\ncell:B25:vtf:t: :IF(AND(ISBLANK(INV3!B8),ISBLANK(SHEET7!B8)), \\\" \\\", IF(ISBLANK(INV3!B8), SHEET7!B8, INV3!B8)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C25:t::l:2:f:3\\ncell:D25:t::l:2:f:3\\ncell:E25:t::l:2:f:3\\ncell:F25:t::b::2:::l:1:f:3\\ncell:G25:vtf:t: :IF(AND(ISBLANK(INV3!B8),ISBLANK(SHEET7!B8)), \\\" \\\", IF(ISBLANK(INV3!B8), (SHEET7!E8*SHEET7!F8), (INV3!E8*INV3!F8))):b::1::1:f:3:ntvf:1\\ncell:A26:b::1::\\ncell:B26:vtf:t: :IF(AND(ISBLANK(INV3!B9),ISBLANK(SHEET7!B9)), \\\" \\\", IF(ISBLANK(INV3!B9), SHEET7!B9, INV3!B9)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C26:t::l:2:f:3\\ncell:D26:t::l:2:f:3\\ncell:E26:t::l:2:f:3\\ncell:F26:t::b::2:::l:1:f:3\\ncell:G26:vtf:t: :IF(AND(ISBLANK(INV3!B9),ISBLANK(SHEET7!B9)), \\\" \\\", IF(ISBLANK(INV3!B9), (SHEET7!E9*SHEET7!F9), (INV3!E9*INV3!F9))):b::1::1:f:3:ntvf:1\\ncell:A27:b::1::\\ncell:B27:vtf:t: :IF(AND(ISBLANK(INV3!B10),ISBLANK(SHEET7!B10)), \\\" \\\", IF(ISBLANK(INV3!B10), SHEET7!B10, INV3!B10)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C27:t::l:2:f:3\\ncell:D27:t::l:2:f:3\\ncell:E27:t::l:2:f:3\\ncell:F27:t::b::2:::l:1:f:3\\ncell:G27:vtf:t: :IF(AND(ISBLANK(INV3!B10),ISBLANK(SHEET7!B10)), \\\" \\\", IF(ISBLANK(INV3!B10), (SHEET7!E10*SHEET7!F10), (INV3!E10*INV3!F10))):b::1::1:f:3:ntvf:1\\ncell:A28:b::1::\\ncell:B28:vtf:t: :IF(AND(ISBLANK(INV3!B11),ISBLANK(SHEET7!B11)), \\\" \\\", IF(ISBLANK(INV3!B11), SHEET7!B11, INV3!B11)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C28:t::l:2:f:3\\ncell:D28:t::l:2:f:3\\ncell:E28:t::l:2:f:3\\ncell:F28:t::b::2:::l:1:f:3\\ncell:G28:vtf:t: :IF(AND(ISBLANK(INV3!B11),ISBLANK(SHEET7!B11)), \\\" \\\", IF(ISBLANK(INV3!B11), (SHEET7!E11*SHEET7!F11), (INV3!E11*INV3!F11))):b::1::1:f:3:ntvf:1\\ncell:A29:b::1::\\ncell:B29:vtf:t: :IF(AND(ISBLANK(INV3!B12),ISBLANK(SHEET7!B12)), \\\" \\\", IF(ISBLANK(INV3!B12), SHEET7!B12, INV3!B12)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C29:t::l:2:f:3\\ncell:D29:t::l:2:f:3\\ncell:E29:t::l:2:f:3\\ncell:F29:t::b::2:::l:1:f:3\\ncell:G29:vtf:t: :IF(AND(ISBLANK(INV3!B12),ISBLANK(SHEET7!B12)), \\\" \\\", IF(ISBLANK(INV3!B12), (SHEET7!E12*SHEET7!F12), (INV3!E12*INV3!F12))):b::1::1:f:3:ntvf:1\\ncell:A30:b::1::\\ncell:B30:vtf:t: :IF(AND(ISBLANK(INV3!B13),ISBLANK(SHEET7!B13)), \\\" \\\", IF(ISBLANK(INV3!B13), SHEET7!B13, INV3!B13)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C30:t::l:2:f:3\\ncell:D30:t::l:2:f:3\\ncell:E30:t::l:2:f:3\\ncell:F30:t::b::2:::l:1:f:3\\ncell:G30:vtf:t: :IF(AND(ISBLANK(INV3!B13),ISBLANK(SHEET7!B13)), \\\" \\\", IF(ISBLANK(INV3!B13), (SHEET7!E13*SHEET7!F13), (INV3!E13*INV3!F13))):b::1::1:f:3:ntvf:1\\ncell:A31:b::1::\\ncell:B31:vtf:t: :IF(AND(ISBLANK(INV3!B14),ISBLANK(SHEET7!B14)), \\\" \\\", IF(ISBLANK(INV3!B14), SHEET7!B14, INV3!B14)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C31:t::l:2:f:3\\ncell:D31:t::l:2:f:3\\ncell:E31:t::l:2:f:3\\ncell:F31:t::b::2:::l:1:f:3\\ncell:G31:vtf:t: :IF(AND(ISBLANK(INV3!B14),ISBLANK(SHEET7!B14)), \\\" \\\", IF(ISBLANK(INV3!B14), (SHEET7!E14*SHEET7!F14), (INV3!E14*INV3!F14))):b::1::1:f:3:ntvf:1\\ncell:A32:b::1::\\ncell:B32:vtf:t: :IF(AND(ISBLANK(INV3!B15),ISBLANK(SHEET7!B15)), \\\" \\\", IF(ISBLANK(INV3!B15), SHEET7!B15, INV3!B15)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C32:t::l:2:f:3\\ncell:D32:t::l:2:f:3\\ncell:E32:t::l:2:f:3\\ncell:F32:t::b::2:::l:1:f:3\\ncell:G32:vtf:t: :IF(AND(ISBLANK(INV3!B15),ISBLANK(SHEET7!B15)), \\\" \\\", IF(ISBLANK(INV3!B15), (SHEET7!E15*SHEET7!F15), (INV3!E15*INV3!F15))):b::1::1:f:3:ntvf:1\\ncell:A33:b::1::\\ncell:B33:vtf:t: :IF(AND(ISBLANK(INV3!B16),ISBLANK(SHEET7!B16)), \\\" \\\", IF(ISBLANK(INV3!B16), SHEET7!B16, INV3!B16)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C33:l:2:f:3\\ncell:D33:l:2:f:3\\ncell:E33:l:2:f:3\\ncell:F33:b::2:::l:1:f:3\\ncell:G33:vtf:t: :IF(AND(ISBLANK(INV3!B16),ISBLANK(SHEET7!B16)), \\\" \\\", IF(ISBLANK(INV3!B16), (SHEET7!E16*SHEET7!F16), (INV3!E16*INV3!F16))):b::1::1:f:3:ntvf:1\\ncell:A34:b::1::\\ncell:B34:vtf:t: :IF(AND(ISBLANK(INV3!B17),ISBLANK(SHEET7!B17)), \\\" \\\", IF(ISBLANK(INV3!B17), SHEET7!B17, INV3!B17)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C34:t::l:2:f:3\\ncell:D34:t::l:2:f:3\\ncell:E34:t::l:2:f:3\\ncell:F34:t::b::2:::l:1:f:3\\ncell:G34:vtf:t: :IF(AND(ISBLANK(INV3!B17),ISBLANK(SHEET7!B17)), \\\" \\\", IF(ISBLANK(INV3!B17), (SHEET7!E17*SHEET7!F17), (INV3!E17*INV3!F17))):b::1::1:f:3:ntvf:1\\ncell:A35:b::1::\\ncell:B35:vtf:t: :IF(AND(ISBLANK(INV3!B18),ISBLANK(SHEET7!B18)), \\\" \\\", IF(ISBLANK(INV3!B18), SHEET7!B18, INV3!B18)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C35:t::b:::2::l:1:f:3\\ncell:D35:t::b:::2::l:1:f:3\\ncell:E35:t::b:::2::l:1:f:3\\ncell:F35:t::b::2:2::l:1:f:3\\ncell:G35:vtf:t: :IF(AND(ISBLANK(INV3!B18),ISBLANK(SHEET7!B18)), \\\" \\\", IF(ISBLANK(INV3!B18), (SHEET7!E18*SHEET7!F18), (INV3!E18*INV3!F18))):b::1::1:f:3:ntvf:1\\ncell:B36:b:2::::l:1:f:10\\ncell:C36:b:2::::l:1:f:10\\ncell:D36:b:2::::l:1:f:10\\ncell:E36:b:2::::l:1:f:11\\ncell:F36:t:Subtotal:b:2::::l:1:f:9\\ncell:G36:vtf:n:0:SUM(G23\\\\cG35):b:1::::f:9:ntvf:1\\ncell:B37:t:NOTES:b:::1::l:1:f:11:cf:2:colspan:3:rowspan:1\\ncell:C37:t::b:::2::l:1:f:10\\ncell:D37:t::b:::2::l:1:f:10\\ncell:F37:t:Tax Rate:l:1:f:9\\ncell:G37:v:0:f:1:ntvf:2\\ncell:B38:b:1::::f:1:cf:2:colspan:3\\ncell:C38:t::b:2::::l:1:f:10\\ncell:D38:t::b:2::::l:1:f:10\\ncell:F38:t:Tax:l:1:f:9\\ncell:G38:vtf:n:0:G37*G36:f:1:ntvf:1\\ncell:B39:f:1:cf:2:colspan:3\\ncell:C39:t::l:2:f:10\\ncell:D39:t::l:2:f:10\\ncell:F39:t:Other:b:::1::l:1:f:9\\ncell:G39:v:0:b:::1::f:1:ntvf:1\\ncell:B40:b:::1::f:1:cf:2:colspan:3:rowspan:1\\ncell:C40:t::l:2:f:10\\ncell:D40:t::l:2:f:10\\ncell:F40:t:TOTAL:b:1::::l:1:f:11\\ncell:G40:vtf:n:0:(G36+G38)+G39:b:1::::f:9:ntvf:1\\ncell:B43:t:Thank you for your business:l:1:f:4:cf:1:colspan:6:rowspan:1\\ncell:C43:t::l:2:f:10\\ncell:D43:t::l:2:f:10\\ncell:E43:t::l:2:f:10\\ncell:F43:t::l:2:f:10\\ncell:G43:t::l:2:f:10\\ncol:A:w:10\\ncol:B:w:65\\ncol:C:w:19\\ncol:D:w:10\\ncol:E:w:16\\ncol:F:w:53\\ncol:G:w:64\\nrow:1:h:34.5\\nrow:2:h:34.5\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:14.25\\nrow:6:h:14.25\\nrow:7:h:14.25\\nrow:8:h:14.25\\nrow:9:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:16:h:14.25\\nrow:17:h:14.25\\nrow:18:h:14.25\\nrow:19:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nrow:24:h:14.25\\nrow:25:h:14.25\\nrow:26:h:14.25\\nrow:27:h:14.25\\nrow:28:h:14.25\\nrow:29:h:14.25\\nrow:30:h:14.25\\nrow:31:h:14.25\\nrow:32:h:14.25\\nrow:33:h:14.25\\nrow:34:h:14.25\\nrow:35:h:14.25\\nrow:36:h:14.25\\nrow:37:h:14.25\\nrow:38:h:14.25\\nrow:39:h:14.25\\nrow:40:h:14.25\\nrow:43:h:15.75\\nsheet:c:7:r:43:h:12.75:needsrecalc:yes\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\ncellformat:3:right\\ncolor:1:rgb(0, 0, 0)\\ncolor:2:rgb(0,0,0)\\ncolor:3:rgb(221, 221, 221)\\nfont:1:* * Trebuchet MS\\nfont:2:* 10pt *\\nfont:3:* 9pt Trebuchet MS\\nfont:4:italic bold 10pt Trebuchet MS\\nfont:5:italic normal * Trebuchet MS\\nfont:6:normal bold 10pt Trebuchet MS\\nfont:7:normal bold 14pt Trebuchet MS\\nfont:8:normal bold 28pt Trebuchet MS\\nfont:9:normal normal * Trebuchet MS\\nfont:10:normal normal 10pt Arial\\nfont:11:normal normal 10pt Trebuchet MS\\nfont:12:normal normal 16pt Trebuchet MS\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nvalueformat:1:#,##0.00\\nvalueformat:2:#,##0.00%\\nvalueformat:3:m/d/yy\\nvalueformat:4:text-html\\n\"},\"name\":\"sheet6\",\"hidden\":\"0\"},\"sheet4\":{\"sheetstr\":{\"savestr\":\"version:1.5\\ncell:B1:b:::2::l:1:f:7\\ncell:C1:b:::2::l:1:f:7\\ncell:D1:b:::2::l:1:f:7\\ncell:E1:b:::2::l:1:f:7\\ncell:F1:b:::2::l:1:f:7\\ncell:A2:b::2:::l:1:f:7\\ncell:B2:t:INVOICE DETAILS:b:1:1:1:1:l:1:f:8:cf:1:colspan:5\\ncell:C2:t::b:2::2::l:1:f:7\\ncell:D2:t::b:2::2::l:1:f:7\\ncell:E2:t::b:2::2::l:1:f:7\\ncell:F2:b:2:1:1::l:1:f:7\\ncell:G2:b::::1\\ncell:A3:b::2:::l:3:f:7\\ncell:B3:b:2::::l:1:f:7\\ncell:C3:b:2::::l:1:f:7\\ncell:D3:b:2::::l:1:f:7\\ncell:E3:b:2::::l:1:f:7\\ncell:F3:b:1:1:::l:1:f:7\\ncell:G3:b::::1\\ncell:A4:b::2:::l:3:f:7\\ncell:B4:b:::2::l:1:f:7\\ncell:C4:b:::2::l:3:f:4:cf:2\\ncell:D4:b:::2::l:1:f:7\\ncell:E4:b:::2::l:1:f:7\\ncell:F4:b::1:1::l:1:f:7\\ncell:G4:b::::1\\ncell:A5:b::2:::l:3:f:7\\ncell:B5:t:Description:b:1:1:1:1:f:6:cf:1:colspan:3\\ncell:C5:t:Description:b:2::2:2:l:3:f:4:cf:2:colspan:2:rowspan:1\\ncell:D5:t::b:2:2:2::l:1:f:7\\ncell:E5:t:Hours:b:1:1:1:1:f:6:cf:1\\ncell:F5:t:Rate:b:1:1:1:1:f:6:cf:1\\ncell:G5:b::::1\\ncell:A6:b::2:::l:3:f:7\\ncell:B6:b:1:1::1:f:1:cf:2:colspan:3\\ncell:C6:b:1:1::1:l:3:f:7:cf:2:colspan:2:rowspan:1\\ncell:D6:t::b:2:2:2::l:1:f:7\\ncell:E6:b:1:1:::f:1:ntvf:1\\ncell:F6:b:1:1:::f:1:ntvf:1\\ncell:G6:b::::1\\ncell:A7:b::2:::l:3:f:7\\ncell:B7:b::1::1:f:1:cf:2:colspan:3\\ncell:C7:b::1::1:l:1:f:7:colspan:2\\ncell:D7:l:1:f:7\\ncell:E7:b::1:::f:1:ntvf:1\\ncell:F7:b::1:::f:1:ntvf:1\\ncell:G7:b::::1\\ncell:A8:b::2:::l:3:f:7\\ncell:B8:b::1::1:f:1:cf:2:colspan:3\\ncell:C8:b::1::1:colspan:2\\ncell:E8:b::1:::f:1:ntvf:1\\ncell:F8:b::1:::f:1:ntvf:1\\ncell:G8:b::::1\\ncell:A9:b::2:::l:3:f:7\\ncell:B9:b::1::1:f:1:cf:2:colspan:3\\ncell:C9:b::1::1:colspan:2\\ncell:E9:b::1:::f:1:ntvf:1\\ncell:F9:b::1:::f:1:ntvf:1\\ncell:G9:b::::1\\ncell:A10:b::2:::l:3:f:7\\ncell:B10:b::1::1:f:1:cf:2:colspan:3\\ncell:C10:b::1::1:colspan:2\\ncell:E10:b::1:::f:1:ntvf:1\\ncell:F10:b::1:::f:1:ntvf:1\\ncell:G10:b::::1\\ncell:A11:b::2:::l:3:f:7\\ncell:B11:b::1::1:f:1:cf:2:colspan:3\\ncell:C11:b::1::1:colspan:2\\ncell:E11:b::1:::f:1:ntvf:1\\ncell:F11:b::1:::f:1:ntvf:1\\ncell:G11:b::::1\\ncell:A12:b::2:::l:3:f:7\\ncell:B12:b::1::1:f:1:cf:2:colspan:3\\ncell:C12:b::1::1:colspan:2\\ncell:E12:b::1:::f:1:ntvf:1\\ncell:F12:b::1:::f:1:ntvf:1\\ncell:G12:b::::1\\ncell:A13:b::2:::l:3:f:7\\ncell:B13:b::1::1:f:1:cf:2:colspan:3\\ncell:C13:b::1::1:colspan:2\\ncell:E13:b::1:::f:1:ntvf:1\\ncell:F13:b::1:::f:1:ntvf:1\\ncell:G13:b::::1\\ncell:A14:b::2:::l:3:f:7\\ncell:B14:b::1::1:f:1:cf:2:colspan:3\\ncell:C14:b::1::1:colspan:2\\ncell:E14:b::1:::f:1:ntvf:1\\ncell:F14:b::1:::f:1:ntvf:1\\ncell:G14:b::::1\\ncell:A15:b::2:::l:3:f:7\\ncell:B15:b::1::1:f:1:cf:2:colspan:3\\ncell:C15:b::1::1:colspan:2\\ncell:E15:b::1:::f:1:ntvf:1\\ncell:F15:b::1:::f:1:ntvf:1\\ncell:G15:b::::1\\ncell:A16:b::2:::l:3:f:7\\ncell:B16:b::1::1:f:1:cf:2:colspan:3\\ncell:C16:b::1::1:colspan:2\\ncell:E16:b::1:::f:1:ntvf:1\\ncell:F16:b::1:::f:1:ntvf:1\\ncell:G16:b::::1\\ncell:A17:b::2:::l:3:f:7\\ncell:B17:b::1::1:f:1:cf:2:colspan:3\\ncell:C17:b::1::1:colspan:2\\ncell:E17:b::1:::f:1:ntvf:1\\ncell:F17:b::1:::f:1:ntvf:1\\ncell:G17:b::::1\\ncell:A18:b::2:::l:3:f:5\\ncell:B18:b::1:1:1:f:1:cf:2:colspan:3\\ncell:C18:b::1:1:1:l:3:f:7:cf:2:colspan:2\\ncell:D18:b:::2::l:3:f:7:cf:2\\ncell:E18:b::1:1::f:1:ntvf:1\\ncell:F18:b::1:1::f:1:ntvf:1\\ncell:G18:b::::1\\ncell:A19:b::2:::l:3:f:7\\ncell:F19:b::1::\\ncell:G19:b::::1\\ncell:A20:b::2:::l:3:f:7\\ncell:F20:b::1::\\ncell:G20:b::::1\\ncell:A21:b::2:::l:3:f:7\\ncell:C21:t:Thank you for your business:b::1:::f:3:colspan:4\\ncell:D21:t:Thank you for your business:f:2:colspan:4\\ncell:E21:t::l:2:f:7\\ncell:F21:l:2:f:7\\ncell:G21:b::::1\\ncell:A22:b::2:::l:3:f:7\\ncell:F22:b::1::\\ncell:G22:b::::1\\ncell:A23:b::2:::l:3:f:7\\ncell:B23:b:::2::l:3:f:7\\ncell:C23:b:::2::l:3:f:7\\ncell:D23:b:::2::l:3:f:7\\ncell:E23:b:::2::l:3:f:7\\ncell:F23:b::1:1::l:3:f:7\\ncell:G23:b::::1\\ncell:B24:b:1:::\\ncell:C24:b:1:::\\ncell:D24:b:1:::\\ncell:E24:b:1:::\\ncell:F24:b:1:::\\ncol:A:w:10\\ncol:B:w:42\\ncol:C:w:56\\ncol:D:w:39\\ncol:E:w:48\\ncol:F:w:57\\nrow:1:h:14.25\\nrow:2:h:18.75\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:14.25\\nrow:6:h:14.25\\nrow:7:h:14.25\\nrow:8:h:14.25\\nrow:9:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:13:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:16:h:14.25\\nrow:17:h:14.25\\nrow:18:h:15.75\\nrow:19:h:14.25\\nrow:20:h:14.25\\nrow:21:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nsheet:c:7:r:24:h:12.75:needsrecalc:yes\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\nfont:1:* * Trebuchet MS\\nfont:2:italic bold * Trebuchet MS\\nfont:3:italic bold 10pt Trebuchet MS\\nfont:4:normal bold 10pt Arial\\nfont:5:normal bold 12pt Arial\\nfont:6:normal normal * Trebuchet MS\\nfont:7:normal normal 10pt Arial\\nfont:8:normal normal 16pt Arial\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nlayout:3:padding:* * * *;vertical-align:top;\\nvalueformat:1:#,##0.00\\n\"},\"name\":\"inv3\",\"hidden\":\"0\"},\"sheet5\":{\"sheetstr\":{\"savestr\":\"version:1.5\\ncell:B1:b:::2::l:1:f:7\\ncell:C1:b:::2::l:1:f:7\\ncell:D1:b:::2::l:1:f:7\\ncell:E1:b:::2::l:1:f:7\\ncell:F1:b:::2::l:1:f:7\\ncell:A2:b::2:::l:1:f:7\\ncell:B2:t:INVOICE DETAILS:b:1:1:1:1:l:1:f:8:cf:1:colspan:5\\ncell:C2:t::b:2::2::l:1:f:7\\ncell:D2:t::b:2::2::l:1:f:7\\ncell:E2:t::b:2::2::l:1:f:7\\ncell:F2:b:2:1:1::l:1:f:7\\ncell:G2:b::::1\\ncell:A3:b::2:::l:3:f:7\\ncell:B3:b:2::::l:1:f:7\\ncell:C3:b:2::::l:1:f:7\\ncell:D3:b:2::::l:1:f:7\\ncell:E3:b:2::::l:1:f:7\\ncell:F3:b:1:1:::l:1:f:7\\ncell:G3:b::::1\\ncell:A4:b::2:::l:3:f:7\\ncell:B4:b:::2::l:1:f:7\\ncell:C4:b:::2::l:3:f:4:cf:2\\ncell:D4:b:::2::l:1:f:7\\ncell:E4:b:::2::l:1:f:7\\ncell:F4:b::1:1::l:1:f:7\\ncell:G4:b::::1\\ncell:A5:b::2:::l:3:f:7\\ncell:B5:t:Description:b:1:1:1:1:f:6:cf:1:colspan:3\\ncell:C5:t:Description:b:2::2:2:l:3:f:4:cf:2:colspan:2:rowspan:1\\ncell:D5:t::b:2:2:2::l:1:f:7\\ncell:E5:t:Qty.:b:1:1:1:1:f:6:cf:1\\ncell:F5:t:Price:b:1:1:1:1:f:6:cf:1\\ncell:G5:b::::1\\ncell:A6:b::2:::l:3:f:7\\ncell:B6:b:1:1::1:f:1:cf:2:colspan:3\\ncell:C6:b:1:1::1:l:3:f:7:cf:2:colspan:2:rowspan:1\\ncell:D6:t::b:2:2:2::l:1:f:7\\ncell:E6:b:1:1:::f:1:ntvf:1\\ncell:F6:b:1:1:::f:1:ntvf:1\\ncell:G6:b::::1\\ncell:A7:b::2:::l:3:f:7\\ncell:B7:b::1::1:f:1:cf:2:colspan:3\\ncell:C7:b::1::1:l:1:f:7:colspan:2\\ncell:D7:l:1:f:7\\ncell:E7:b::1:::f:1:ntvf:1\\ncell:F7:b::1:::f:1:ntvf:1\\ncell:G7:b::::1\\ncell:A8:b::2:::l:3:f:7\\ncell:B8:b::1::1:f:1:cf:2:colspan:3\\ncell:C8:b::1::1:colspan:2\\ncell:E8:b::1:::f:1:ntvf:1\\ncell:F8:b::1:::f:1:ntvf:1\\ncell:G8:b::::1\\ncell:A9:b::2:::l:3:f:7\\ncell:B9:b::1::1:f:1:cf:2:colspan:3\\ncell:C9:b::1::1:colspan:2\\ncell:E9:b::1:::f:1:ntvf:1\\ncell:F9:b::1:::f:1:ntvf:1\\ncell:G9:b::::1\\ncell:A10:b::2:::l:3:f:7\\ncell:B10:b::1::1:f:1:cf:2:colspan:3\\ncell:C10:b::1::1:colspan:2\\ncell:E10:b::1:::f:1:ntvf:1\\ncell:F10:b::1:::f:1:ntvf:1\\ncell:G10:b::::1\\ncell:A11:b::2:::l:3:f:7\\ncell:B11:b::1::1:f:1:cf:2:colspan:3\\ncell:C11:b::1::1:colspan:2\\ncell:E11:b::1:::f:1:ntvf:1\\ncell:F11:b::1:::f:1:ntvf:1\\ncell:G11:b::::1\\ncell:A12:b::2:::l:3:f:7\\ncell:B12:b::1::1:f:1:cf:2:colspan:3\\ncell:C12:b::1::1:colspan:2\\ncell:E12:b::1:::f:1:ntvf:1\\ncell:F12:b::1:::f:1:ntvf:1\\ncell:G12:b::::1\\ncell:A13:b::2:::l:3:f:7\\ncell:B13:b::1::1:f:1:cf:2:colspan:3\\ncell:C13:b::1::1:colspan:2\\ncell:E13:b::1:::f:1:ntvf:1\\ncell:F13:b::1:::f:1:ntvf:1\\ncell:G13:b::::1\\ncell:A14:b::2:::l:3:f:7\\ncell:B14:b::1::1:f:1:cf:2:colspan:3\\ncell:C14:b::1::1:colspan:2\\ncell:E14:b::1:::f:1:ntvf:1\\ncell:F14:b::1:::f:1:ntvf:1\\ncell:G14:b::::1\\ncell:A15:b::2:::l:3:f:7\\ncell:B15:b::1::1:f:1:cf:2:colspan:3\\ncell:C15:b::1::1:colspan:2\\ncell:E15:b::1:::f:1:ntvf:1\\ncell:F15:b::1:::f:1:ntvf:1\\ncell:G15:b::::1\\ncell:A16:b::2:::l:3:f:7\\ncell:B16:b::1::1:f:1:cf:2:colspan:3\\ncell:C16:b::1::1:colspan:2\\ncell:E16:b::1:::f:1:ntvf:1\\ncell:F16:b::1:::f:1:ntvf:1\\ncell:G16:b::::1\\ncell:A17:b::2:::l:3:f:7\\ncell:B17:b::1::1:f:1:cf:2:colspan:3\\ncell:C17:b::1::1:colspan:2\\ncell:E17:b::1:::f:1:ntvf:1\\ncell:F17:b::1:::f:1:ntvf:1\\ncell:G17:b::::1\\ncell:A18:b::2:::l:3:f:5\\ncell:B18:b::1:1:1:f:1:cf:2:colspan:3\\ncell:C18:b::1:1:1:l:3:f:7:cf:2:colspan:2\\ncell:D18:b:::2::l:3:f:7:cf:2\\ncell:E18:b::1:1::f:1:ntvf:1\\ncell:F18:b::1:1::f:1:ntvf:1\\ncell:G18:b::::1\\ncell:A19:b::2:::l:3:f:7\\ncell:F19:b::1::\\ncell:G19:b::::1\\ncell:A20:b::2:::l:3:f:7\\ncell:F20:b::1::\\ncell:G20:b::::1\\ncell:A21:b::2:::l:3:f:7\\ncell:C21:t:Thank you for your business:b::1:::f:3:colspan:4\\ncell:D21:t:Thank you for your business:f:2:colspan:4\\ncell:E21:t::l:2:f:7\\ncell:F21:l:2:f:7\\ncell:G21:b::::1\\ncell:A22:b::2:::l:3:f:7\\ncell:F22:b::1::\\ncell:G22:b::::1\\ncell:A23:b::2:::l:3:f:7\\ncell:B23:b:::2::l:3:f:7\\ncell:C23:b:::2::l:3:f:7\\ncell:D23:b:::2::l:3:f:7\\ncell:E23:b:::2::l:3:f:7\\ncell:F23:b::1:1::l:3:f:7\\ncell:G23:b::::1\\ncell:B24:b:1:::\\ncell:C24:b:1:::\\ncell:D24:b:1:::\\ncell:E24:b:1:::\\ncell:F24:b:1:::\\ncol:A:w:10\\ncol:B:w:42\\ncol:C:w:56\\ncol:D:w:39\\ncol:E:w:48\\ncol:F:w:57\\nrow:1:h:14.25\\nrow:2:h:18.75\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:14.25\\nrow:6:h:14.25\\nrow:7:h:14.25\\nrow:8:h:14.25\\nrow:9:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:13:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:16:h:14.25\\nrow:17:h:14.25\\nrow:18:h:15.75\\nrow:19:h:14.25\\nrow:20:h:14.25\\nrow:21:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nsheet:c:7:r:24:h:12.75:needsrecalc:yes\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\nfont:1:* * Trebuchet MS\\nfont:2:italic bold * Trebuchet MS\\nfont:3:italic bold 10pt Trebuchet MS\\nfont:4:normal bold 10pt Arial\\nfont:5:normal bold 12pt Arial\\nfont:6:normal normal * Trebuchet MS\\nfont:7:normal normal 10pt Arial\\nfont:8:normal normal 16pt Arial\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nlayout:3:padding:* * * *;vertical-align:top;\\nvalueformat:1:#,##0.00\\n\"},\"name\":\"sheet7\",\"hidden\":\"0\"}},\"EditableCells\":{\"allow\":true,\"cells\":{\"inv1!B2\":true,\"inv1!C5\":true,\"inv1!C6\":true,\"inv1!C7\":true,\"inv1!C8\":true,\"inv1!C9\":true,\"inv1!C11\":true,\"inv1!C12\":true,\"inv1!C13\":true,\"inv1!C14\":true,\"inv1!C15\":true,\"inv1!C16\":true,\"inv1!C18\":true,\"inv1!C20\":true,\"inv1!D20\":true,\"inv1!C23\":true,\"inv1!C24\":true,\"inv1!C25\":true,\"inv1!C26\":true,\"inv1!C27\":true,\"inv1!C28\":true,\"inv1!C29\":true,\"inv1!C30\":true,\"inv1!C31\":true,\"inv1!C32\":true,\"inv1!C33\":true,\"inv1!C34\":true,\"inv1!C35\":true,\"inv1!F23\":true,\"inv1!F24\":true,\"inv1!F25\":true,\"inv1!F26\":true,\"inv1!F27\":true,\"inv1!F28\":true,\"inv1!F29\":true,\"inv1!F30\":true,\"inv1!F31\":true,\"inv1!F32\":true,\"inv1!F33\":true,\"inv1!F34\":true,\"inv1!F35\":true,\"inv2!B2\":true,\"inv2!F4\":true,\"inv2!G4\":true,\"inv2!B5\":true,\"inv2!B7\":true,\"inv2!B8\":true,\"inv2!B9\":true,\"inv2!B10\":true,\"inv2!B11\":true,\"inv2!B12\":true,\"inv2!B14\":true,\"inv2!B15\":true,\"inv2!B16\":true,\"inv2!B17\":true,\"inv2!B18\":true,\"inv2!B19\":true,\"inv2!B20\":true,\"inv2!B23\":true,\"inv2!B24\":true,\"inv2!B25\":true,\"inv2!B26\":true,\"inv2!B27\":true,\"inv2!B28\":true,\"inv2!B29\":true,\"inv2!B30\":true,\"inv2!B31\":true,\"inv2!B32\":true,\"inv2!B33\":true,\"inv2!B34\":true,\"inv2!B35\":true,\"inv2!G23\":true,\"inv2!G24\":true,\"inv2!G25\":true,\"inv2!G26\":true,\"inv2!G27\":true,\"inv2!G28\":true,\"inv2!G29\":true,\"inv2!G30\":true,\"inv2!G31\":true,\"inv2!G32\":true,\"inv2!G33\":true,\"inv2!G34\":true,\"inv2!G35\":true,\"inv2!B38\":true,\"inv2!B39\":true,\"inv2!B40\":true,\"inv2!F36\":true,\"inv2!G37\":true,\"inv2!F37\":true,\"inv2!F39\":true,\"inv2!G39\":true,\"inv2!F38\":true,\"sheet6!B2\":true,\"sheet6!F4\":true,\"sheet6!G4\":true,\"sheet6!B5\":true,\"sheet6!B7\":true,\"sheet6!B8\":true,\"sheet6!B9\":true,\"sheet6!B10\":true,\"sheet6!B11\":true,\"sheet6!B12\":true,\"sheet6!B14\":true,\"sheet6!B15\":true,\"sheet6!B16\":true,\"sheet6!B17\":true,\"sheet6!B18\":true,\"sheet6!B19\":true,\"sheet6!B20\":true,\"sheet6!B38\":true,\"sheet6!B39\":true,\"sheet6!B40\":true,\"sheet6!F36\":true,\"sheet6!G37\":true,\"sheet6!F37\":true,\"sheet6!F39\":true,\"sheet6!G39\":true,\"sheet6!F38\":true,\"inv3!B2\":true,\"inv3!B6\":true,\"inv3!B7\":true,\"inv3!B8\":true,\"inv3!B9\":true,\"inv3!B10\":true,\"inv3!B11\":true,\"inv3!B12\":true,\"inv3!B13\":true,\"inv3!B14\":true,\"inv3!B15\":true,\"inv3!B16\":true,\"inv3!B17\":true,\"inv3!B18\":true,\"inv3!E6\":true,\"inv3!E7\":true,\"inv3!E8\":true,\"inv3!E9\":true,\"inv3!E10\":true,\"inv3!E11\":true,\"inv3!E12\":true,\"inv3!E13\":true,\"inv3!E14\":true,\"inv3!E15\":true,\"inv3!E16\":true,\"inv3!E17\":true,\"inv3!E18\":true,\"inv3!F6\":true,\"inv3!F7\":true,\"inv3!F8\":true,\"inv3!F9\":true,\"inv3!F10\":true,\"inv3!F11\":true,\"inv3!F12\":true,\"inv3!F13\":true,\"inv3!F14\":true,\"inv3!F15\":true,\"inv3!F16\":true,\"inv3!F17\":true,\"inv3!F18\":true,\"sheet7!F6\":true,\"sheet7!F7\":true,\"sheet7!F8\":true,\"sheet7!F9\":true,\"sheet7!F10\":true,\"sheet7!F11\":true,\"sheet7!F12\":true,\"sheet7!F13\":true,\"sheet7!F14\":true,\"sheet7!F15\":true,\"sheet7!F16\":true,\"sheet7!F17\":true,\"sheet7!F18\":true,\"sheet7!E6\":true,\"sheet7!E7\":true,\"sheet7!E8\":true,\"sheet7!E9\":true,\"sheet7!E10\":true,\"sheet7!E11\":true,\"sheet7!E12\":true,\"sheet7!E13\":true,\"sheet7!E14\":true,\"sheet7!E15\":true,\"sheet7!E16\":true,\"sheet7!E17\":true,\"sheet7!E18\":true,\"sheet7!B6\":true,\"sheet7!B2\":true,\"sheet7!B7\":true,\"sheet7!B8\":true,\"sheet7!B9\":true,\"sheet7!B10\":true,\"sheet7!B11\":true,\"sheet7!B12\":true,\"sheet7!B13\":true,\"sheet7!B14\":true,\"sheet7!B15\":true,\"sheet7!B16\":true,\"sheet7!B17\":true,\"sheet7!B18\":true,\"inv1!D8\":true,\"inv1!D15\":true,\"inv1!D18\":true,\"inv2!C5\":true,\"sheet6!C5\":true},\"constraints\":{\"inv1!C5\":[\"prompttext\",\"0\",\"1e10\",\"Name\"],\"inv1!C6\":[\"prompttext\",\"0\",\"1e10\",\"Street Address\"],\"inv1!C7\":[\"prompttext\",\"0\",\"1e10\",\"City, State, Zip\"],\"inv1!C8\":[\"prompttext\",\"0\",\"1e10\",\"Phone\"],\"inv1!C9\":[\"promptemail\",\"0\",\"1e10\",\"Email\"],\"inv1!C11\":[\"prompttext\",\"0\",\"1e10\",\"From\"],\"inv1!C12\":[\"prompttext\",\"0\",\"1e10\",\"Name\"],\"inv1!C13\":[\"prompttext\",\"0\",\"1e10\",\"Street Address\"],\"inv1!C14\":[\"prompttext\",\"0\",\"1e10\",\"City, State, Zip\"],\"inv1!C15\":[\"prompttext\",\"0\",\"1e10\",\"Phone\"],\"inv1!C16\":[\"promptemail\",\"0\",\"1e10\",\"Email\"],\"inv1!C18\":[\"prompttext\",\"0\",\"1e10\",\"Invoice #\"],\"inv1!C20\":[\"prompttext\",\"0\",\"1e10\",\"Date\"],\"inv1!D20\":[\"prompttext\",\"0\",\"1e10\",\"Date\"],\"inv1!C23\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv1!C24\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv1!C25\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv1!C26\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv1!C27\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv1!C28\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv1!C29\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv1!C30\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv1!C31\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv1!C32\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv1!C33\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv1!C34\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv1!C35\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv1!F23\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv1!F24\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv1!F25\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv1!F26\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv1!F27\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv1!F28\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv1!F29\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv1!F30\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv1!F31\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv1!F32\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv1!F33\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv1!F34\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv1!F35\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv2!B2\":[\"prompttext\",\"0\",\"1e10\",\"Invoice\"],\"inv2!F4\":[\"prompttext\",\"0\",\"1e10\",\"Date\"],\"inv2!G4\":[\"prompttext\",\"0\",\"1e10\",\"Date\"],\"inv2!B5\":[\"prompttext\",\"0\",\"1e10\",\"Invoice #\"],\"inv2!B7\":[\"prompttext\",\"0\",\"1e10\",\"From\"],\"inv2!B8\":[\"prompttext\",\"0\",\"1e10\",\"Company Name\"],\"inv2!B9\":[\"prompttext\",\"0\",\"1e10\",\"Street Address\"],\"inv2!B10\":[\"prompttext\",\"0\",\"1e10\",\"City, State, Zip\"],\"inv2!B11\":[\"prompttext\",\"0\",\"1e10\",\"Phone\"],\"inv2!B12\":[\"promptemail\",\"0\",\"1e10\",\"Email\"],\"inv2!B14\":[\"prompttext\",\"0\",\"1e10\",\"Bill To\"],\"inv2!B15\":[\"prompttext\",\"0\",\"1e10\",\"Name\"],\"inv2!B16\":[\"prompttext\",\"0\",\"1e10\",\"Company Name\"],\"inv2!B17\":[\"prompttext\",\"0\",\"1e10\",\"Street Address\"],\"inv2!B18\":[\"prompttext\",\"0\",\"1e10\",\"City, State, Zip\"],\"inv2!B19\":[\"prompttext\",\"0\",\"1e10\",\"Phone\"],\"inv2!B20\":[\"promptemail\",\"0\",\"1e10\",\"Email\"],\"inv2!B23\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv2!B24\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv2!B25\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv2!B26\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv2!B27\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv2!B28\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv2!B29\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv2!B30\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv2!B31\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv2!B32\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv2!B33\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv2!B34\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv2!B35\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv2!G23\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv2!G24\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv2!G25\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv2!G26\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv2!G27\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv2!G28\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv2!G29\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv2!G30\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv2!G31\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv2!G32\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv2!G33\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv2!G34\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv2!G35\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv2!B38\":[\"prompttext\",\"0\",\"1e10\",\"Notes\"],\"inv2!B39\":[\"prompttext\",\"0\",\"1e10\",\"Notes\"],\"inv2!B40\":[\"prompttext\",\"0\",\"1e10\",\"Notes\"],\"inv2!F36\":[\"prompttext\",\"0\",\"1e10\",\"Subtotal\"],\"inv2!G37\":[\"promptdecimal\",\"0\",\"1e10\",\"Tax Rate (0.00)\"],\"inv2!F37\":[\"prompttext\",\"0\",\"1e10\",\"Tax Rate\"],\"inv2!F39\":[\"prompttext\",\"0\",\"1e10\",\"Other\"],\"inv2!G39\":[\"promptdecimal\",\"0\",\"1e10\",\"Other\"],\"inv2!F38\":[\"prompttext\",\"0\",\"1e10\",\"Tax\"],\"sheet6!B2\":[\"prompttext\",\"0\",\"1e10\",\"Invoice\"],\"sheet6!F4\":[\"prompttext\",\"0\",\"1e10\",\"Date\"],\"sheet6!G4\":[\"prompttext\",\"0\",\"1e10\",\"Date\"],\"sheet6!B5\":[\"prompttext\",\"0\",\"1e10\",\"Invoice #\"],\"sheet6!B7\":[\"prompttext\",\"0\",\"1e10\",\"From\"],\"sheet6!B8\":[\"prompttext\",\"0\",\"1e10\",\"Company Name\"],\"sheet6!B9\":[\"prompttext\",\"0\",\"1e10\",\"Street Address\"],\"sheet6!B10\":[\"prompttext\",\"0\",\"1e10\",\"City, State, Zip\"],\"sheet6!B11\":[\"prompttext\",\"0\",\"1e10\",\"Phone\"],\"sheet6!B12\":[\"promptemail\",\"0\",\"1e10\",\"Email\"],\"sheet6!B14\":[\"prompttext\",\"0\",\"1e10\",\"Bill To\"],\"sheet6!B15\":[\"prompttext\",\"0\",\"1e10\",\"Name\"],\"sheet6!B16\":[\"prompttext\",\"0\",\"1e10\",\"Company Name\"],\"sheet6!B17\":[\"prompttext\",\"0\",\"1e10\",\"Street Address\"],\"sheet6!B18\":[\"prompttext\",\"0\",\"1e10\",\"City, State, Zip\"],\"sheet6!B19\":[\"prompttext\",\"0\",\"1e10\",\"Phone\"],\"sheet6!B20\":[\"promptemail\",\"0\",\"1e10\",\"Email\"],\"sheet6!B38\":[\"prompttext\",\"0\",\"1e10\",\"Notes\"],\"sheet6!B39\":[\"prompttext\",\"0\",\"1e10\",\"Notes\"],\"sheet6!B40\":[\"prompttext\",\"0\",\"1e10\",\"Notes\"],\"sheet6!F36\":[\"prompttext\",\"0\",\"1e10\",\"Subtotal\"],\"sheet6!G37\":[\"promptdecimal\",\"0\",\"1e10\",\"Tax Rate (0.00)\"],\"sheet6!F37\":[\"prompttext\",\"0\",\"1e10\",\"Tax Rate\"],\"sheet6!F39\":[\"prompttext\",\"0\",\"1e10\",\"Other\"],\"sheet6!G39\":[\"promptdecimal\",\"0\",\"1e10\",\"Other\"],\"sheet6!F38\":[\"prompttext\",\"0\",\"1e10\",\"Tax\"],\"inv3!B6\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv3!B7\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv3!B8\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv3!B9\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv3!B10\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv3!B11\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv3!B12\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv3!B13\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv3!B14\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv3!B15\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv3!B16\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv3!B17\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv3!B18\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"sheet7!B6\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"sheet7!B7\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"sheet7!B8\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"sheet7!B9\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"sheet7!B10\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"sheet7!B11\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"sheet7!B12\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"sheet7!B13\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"sheet7!B14\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"sheet7!B15\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"sheet7!B16\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"sheet7!B17\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"sheet7!B18\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv1!D8\":[\"prompttext\",\"0\",\"1e10\",\"Phone\"],\"inv1!D15\":[\"prompttext\",\"0\",\"1e10\",\"Phone\"],\"inv1!D18\":[\"promptnumeric\",\"0\",\"1e10\",\"Invoice#\"],\"inv2!C5\":[\"promptnumeric\",\"0\",\"1e10\",\"Invoice#\"],\"sheet6!C5\":[\"promptnumeric\",\"0\",\"1e10\",\"Invoice#\"],\"sheet7!E6\":[\"promptdecimal\",\"0\",\"1e10\",\"Quantity\"],\"sheet7!E7\":[\"promptdecimal\",\"0\",\"1e10\",\"Quantity\"],\"sheet7!E8\":[\"promptdecimal\",\"0\",\"1e10\",\"Quantity\"],\"sheet7!E9\":[\"promptdecimal\",\"0\",\"1e10\",\"Quantity\"],\"sheet7!E10\":[\"promptdecimal\",\"0\",\"1e10\",\"Quantity\"],\"sheet7!E11\":[\"promptdecimal\",\"0\",\"1e10\",\"Quantity\"],\"sheet7!E12\":[\"promptdecimal\",\"0\",\"1e10\",\"Quantity\"],\"sheet7!E13\":[\"promptdecimal\",\"0\",\"1e10\",\"Quantity\"],\"sheet7!E14\":[\"promptdecimal\",\"0\",\"1e10\",\"Quantity\"],\"sheet7!E15\":[\"promptdecimal\",\"0\",\"1e10\",\"Quantity\"],\"sheet7!E16\":[\"promptdecimal\",\"0\",\"1e10\",\"Quantity\"],\"sheet7!E17\":[\"promptdecimal\",\"0\",\"1e10\",\"Quantity\"],\"sheet7!E18\":[\"promptdecimal\",\"0\",\"1e10\",\"Quantity\"],\"sheet7!F6\":[\"promptdecimal\",\"0\",\"1e10\",\"Price\"],\"sheet7!F7\":[\"promptdecimal\",\"0\",\"1e10\",\"Price\"],\"sheet7!F8\":[\"promptdecimal\",\"0\",\"1e10\",\"Price\"],\"sheet7!F9\":[\"promptdecimal\",\"0\",\"1e10\",\"Price\"],\"sheet7!F10\":[\"promptdecimal\",\"0\",\"1e10\",\"Price\"],\"sheet7!F11\":[\"promptdecimal\",\"0\",\"1e10\",\"Price\"],\"sheet7!F12\":[\"promptdecimal\",\"0\",\"1e10\",\"Price\"],\"sheet7!F13\":[\"promptdecimal\",\"0\",\"1e10\",\"Price\"],\"sheet7!F14\":[\"promptdecimal\",\"0\",\"1e10\",\"Price\"],\"sheet7!F15\":[\"promptdecimal\",\"0\",\"1e10\",\"Price\"],\"sheet7!F16\":[\"promptdecimal\",\"0\",\"1e10\",\"Price\"],\"sheet7!F17\":[\"promptdecimal\",\"0\",\"1e10\",\"Price\"],\"sheet7!F18\":[\"promptdecimal\",\"0\",\"1e10\",\"Price\"],\"inv3!E6\":[\"promptdecimal\",\"0\",\"1e10\",\"Hours\"],\"inv3!E7\":[\"promptdecimal\",\"0\",\"1e10\",\"Hours\"],\"inv3!E8\":[\"promptdecimal\",\"0\",\"1e10\",\"Hours\"],\"inv3!E9\":[\"promptdecimal\",\"0\",\"1e10\",\"Hours\"],\"inv3!E10\":[\"promptdecimal\",\"0\",\"1e10\",\"Hours\"],\"inv3!E11\":[\"promptdecimal\",\"0\",\"1e10\",\"Hours\"],\"inv3!E12\":[\"promptdecimal\",\"0\",\"1e10\",\"Hours\"],\"inv3!E13\":[\"promptdecimal\",\"0\",\"1e10\",\"Hours\"],\"inv3!E14\":[\"promptdecimal\",\"0\",\"1e10\",\"Hours\"],\"inv3!E15\":[\"promptdecimal\",\"0\",\"1e10\",\"Hours\"],\"inv3!E16\":[\"promptdecimal\",\"0\",\"1e10\",\"Hours\"],\"inv3!E17\":[\"promptdecimal\",\"0\",\"1e10\",\"Hours\"],\"inv3!E18\":[\"promptdecimal\",\"0\",\"1e10\",\"Hours\"],\"inv3!F6\":[\"promptdecimal\",\"0\",\"1e10\",\"Rate\"],\"inv3!F7\":[\"promptdecimal\",\"0\",\"1e10\",\"Rate\"],\"inv3!F8\":[\"promptdecimal\",\"0\",\"1e10\",\"Rate\"],\"inv3!F9\":[\"promptdecimal\",\"0\",\"1e10\",\"Rate\"],\"inv3!F10\":[\"promptdecimal\",\"0\",\"1e10\",\"Rate\"],\"inv3!F11\":[\"promptdecimal\",\"0\",\"1e10\",\"Rate\"],\"inv3!F12\":[\"promptdecimal\",\"0\",\"1e10\",\"Rate\"],\"inv3!F13\":[\"promptdecimal\",\"0\",\"1e10\",\"Rate\"],\"inv3!F14\":[\"promptdecimal\",\"0\",\"1e10\",\"Rate\"],\"inv3!F15\":[\"promptdecimal\",\"0\",\"1e10\",\"Rate\"],\"inv3!F16\":[\"promptdecimal\",\"0\",\"1e10\",\"Rate\"],\"inv3!F17\":[\"promptdecimal\",\"0\",\"1e10\",\"Rate\"],\"inv3!F18\":[\"promptdecimal\",\"0\",\"1e10\",\"Rate\"]}}},\n        \t\"footers\": [{name: 'Type1' , index: 1, isActive: true }, {name: 'Type2' , index: 2, isActive: false}, \n                        {name: 'Type3' , index: 3, isActive: false}, {name: 'Detail1' , index: 4, isActive: false}, \n                        {name: 'Detail2' , index: 5, isActive: false}]\n        },\n        \"iPod\":{\n        \t\"msc\": {\"numsheets\":5,\"currentid\":\"sheet1\",\"currentname\":\"inv1\",\"sheetArr\":{\"sheet1\":{\"sheetstr\":{\"savestr\":\"version:1.5\\ncell:B1:b:::2::l:1:f:10\\ncell:C1:b:::2::l:1:f:10\\ncell:D1:b:::2::l:1:f:10\\ncell:E1:b:::2::l:1:f:10\\ncell:F1:b:::2::l:1:f:10\\ncell:G1:b:::2::l:1:f:10\\ncell:A2:b::2:::l:1:f:10\\ncell:B2:t:INVOICE:b:1:1:1:1:f:13:cf:1:colspan:6\\ncell:C2:t::b:2::2::l:1:f:10\\ncell:D2:t::b:2::2::l:1:f:10\\ncell:E2:t::b:2::2::l:1:f:10\\ncell:F2:t::b:2::2::l:1:f:10\\ncell:G2:t::b:2::2::l:1:f:10\\ncell:A3:b::2:::l:3:f:10\\ncell:B3:b:2:::2:l:3:f:10\\ncell:C3:b:2::::l:1:f:10\\ncell:D3:b:2::::l:1:f:10\\ncell:E3:b:2::::l:1:f:10\\ncell:F3:b:2::::l:1:f:10\\ncell:G3:b:2:2:::l:3:f:10\\ncell:A4:b::2:::l:3:f:10\\ncell:B4:b::::2:l:3:f:6\\ncell:C4:t:BILL TO\\\\c:f:9:colspan:2\\ncell:E4:f:5:cf:2\\ncell:G4:b::2:::l:3:f:10\\ncell:A5:b::2:::l:3:f:10\\ncell:B5:b::::2:l:3:f:7\\ncell:C5:t:[Name]:f:9:cf:2:colspan:3\\ncell:E5:f:1:cf:2\\ncell:F5:t::l:2:f:10:tvf:4:rowspan:6\\ncell:G5:t::b::1:::l:2:f:10\\ncell:A6:b::2:::l:3:f:10\\ncell:B6:b::::2:l:3:f:7\\ncell:C6:t:[Street Address]:f:9:cf:2:colspan:3\\ncell:E6:f:1:cf:2\\ncell:F6:l:2:f:10\\ncell:G6:b::1:::l:2:f:10\\ncell:A7:b::2:::l:3:f:10\\ncell:B7:b::::2:l:3:f:7\\ncell:C7:t:[City, State, Zip]:f:9:cf:2:colspan:3\\ncell:E7:f:1:cf:2\\ncell:G7:b::2:::l:3:f:10\\ncell:A8:b::2:::l:3:f:10\\ncell:B8:b::::2:l:3:f:7\\ncell:C8:t:Phone\\\\c:f:9:cf:2:colspan:3\\ncell:D8:f:8:cf:2\\ncell:E8:f:1:cf:2\\ncell:G8:b::2:::l:3:f:10\\ncell:A9:b::2:::l:3:f:10\\ncell:B9:b::::2:l:3:f:7\\ncell:C9:t:Email\\\\c:f:9:cf:2:colspan:3\\ncell:E9:f:1:cf:2\\ncell:G9:b::2:::l:3:f:10\\ncell:A10:b::2:::l:3:f:10\\ncell:B10:b::::2:l:3:f:7\\ncell:C10:colspan:2\\ncell:G10:b::2:::l:3:f:10\\ncell:A11:b::2:::l:3:f:10\\ncell:B11:b::::2:l:3:f:7\\ncell:C11:t:FROM\\\\c:f:9:colspan:2\\ncell:E11:f:8:colspan:2\\ncell:G11:b::2:::l:3:f:10\\ncell:A12:b::2:::l:3:f:10\\ncell:B12:b::::2:l:3:f:7\\ncell:C12:t:[Name]:f:9:colspan:4\\ncell:E12:colspan:2\\ncell:G12:b::2:::l:3:f:10\\ncell:A13:b::2:::l:3:f:10\\ncell:B13:b::::2:l:3:f:7\\ncell:C13:t:[Street Address]:f:9:colspan:4\\ncell:E13:colspan:2\\ncell:G13:b::2:::l:3:f:10\\ncell:A14:b::2:::l:3:f:10\\ncell:B14:b::::2:l:3:f:7\\ncell:C14:t:[City, State, Zip]:f:9:colspan:4\\ncell:E14:colspan:2\\ncell:G14:b::2:::l:3:f:10\\ncell:A15:b::2:::l:3:f:10\\ncell:B15:b::::2:l:3:f:7\\ncell:C15:t:Phone\\\\c:f:9:colspan:4\\ncell:D15:f:8:cf:2:colspan:3\\ncell:E15:colspan:2\\ncell:G15:b::2:::l:3:f:10\\ncell:A16:b::2:::l:3:f:10\\ncell:B16:b::::2:l:3:f:7\\ncell:C16:t:Email\\\\c:f:9:colspan:4\\ncell:E16:colspan:2\\ncell:G16:b::2:::l:3:f:10\\ncell:A17:b::2:::l:3:f:10\\ncell:B17:b::::2:l:3:f:6\\ncell:G17:b::2:::l:3:f:10\\ncell:A18:b::2:::l:3:f:10\\ncell:B18:b::::2:l:3:f:10\\ncell:C18:t:INVOICE #\\\\c:f:9:cf:2:colspan:4\\ncell:D18:v:1:l:4:f:9:cf:2:colspan:3\\ncell:G18:b::2:::l:3:f:10\\ncell:A19:b::2:::l:3:f:10\\ncell:B19:b::::2:l:3:f:10\\ncell:G19:b::2:::l:3:f:10\\ncell:A20:b::2:::l:3:f:10\\ncell:B20:b::::2:l:3:f:10\\ncell:C20:t:DATE\\\\c:f:9:cf:2\\ncell:D20:vtf:nd:42081:TODAY():f:9:cf:2:ntvf:3:colspan:2\\ncell:G20:b::2:::l:3:f:10\\ncell:A21:b::2:::l:3:f:10\\ncell:B21:b::::2:l:3:f:6:cf:2\\ncell:C21:b:::2::l:1:f:10\\ncell:D21:b:::2::l:3:f:6:cf:2\\ncell:E21:b:::2::l:1:f:10\\ncell:F21:b:::2::l:1:f:10\\ncell:G21:b::2:::l:3:f:10\\ncell:A22:b::2:::l:3:f:10\\ncell:B22:b::2::2:l:3:f:10\\ncell:C22:t:Description:b:1::1:1:f:9:cf:1:colspan:3\\ncell:D22:t:Description:b:1::1::l:3:f:6:cf:2:colspan:2:rowspan:1\\ncell:E22:t::b:2:2:2::l:1:f:10\\ncell:F22:t:Amount:b:1:1:1:1:f:9:cf:1\\ncell:G22:b::2::2:l:3:f:10\\ncell:A23:b::2:::l:3:f:10\\ncell:B23:b::2::2:l:3:f:10\\ncell:C23:b:1:1::1:f:2:cf:2:colspan:3\\ncell:D23:b:1:1:::l:3:f:10:cf:2:colspan:2:rowspan:1\\ncell:E23:t::b:2:2:2::l:1:f:10\\ncell:F23:b:1:1:::f:2:ntvf:1\\ncell:G23:b::2::2:l:3:f:10\\ncell:A24:b::2:::l:3:f:10\\ncell:B24:b::2::2:l:3:f:10:cf:2\\ncell:C24:b::1::1:f:2:cf:2:colspan:3\\ncell:D24:b::1:::l:1:f:10:colspan:2\\ncell:E24:l:1:f:10\\ncell:F24:b::1:::f:2:ntvf:1\\ncell:G24:b::2::2:l:3:f:10\\ncell:A25:b::2:::l:3:f:10\\ncell:B25:b::2::2:l:3:f:10:cf:2:ntvf:2\\ncell:C25:b::1::1:f:2:cf:2:colspan:3\\ncell:D25:b::1:::colspan:2\\ncell:F25:b::1:::f:2:ntvf:1\\ncell:G25:b::2::2:l:3:f:10\\ncell:A26:b::2:::l:3:f:10\\ncell:B26:b::2::2:l:3:f:10:cf:2:ntvf:2\\ncell:C26:b::1::1:f:2:cf:2:colspan:3\\ncell:D26:b::1:::colspan:2\\ncell:F26:b::1:::f:2:ntvf:1\\ncell:G26:b::2::2:l:3:f:10\\ncell:A27:b::2:::l:3:f:10\\ncell:B27:b::2::2:l:3:f:10:cf:2:ntvf:2\\ncell:C27:b::1::1:f:2:cf:2:colspan:3\\ncell:D27:b::1:::colspan:2\\ncell:F27:b::1:::f:2:ntvf:1\\ncell:G27:b::2::2:l:3:f:10\\ncell:A28:b::2:::l:3:f:10\\ncell:B28:b::2::2:l:3:f:10:cf:2:ntvf:2\\ncell:C28:b::1::1:f:2:cf:2:colspan:3\\ncell:D28:b::1:::colspan:2\\ncell:F28:b::1:::f:2:ntvf:1\\ncell:G28:b::2::2:l:3:f:10\\ncell:A29:b::2:::l:3:f:10\\ncell:B29:b::2::2:l:3:f:10:cf:2:ntvf:2\\ncell:C29:b::1::1:f:2:cf:2:colspan:3\\ncell:D29:b::1:::colspan:2\\ncell:F29:b::1:::f:2:ntvf:1\\ncell:G29:b::2::2:l:3:f:10\\ncell:A30:b::2:::l:3:f:10\\ncell:B30:b::2::2:l:3:f:10:cf:2\\ncell:C30:b::1::1:f:2:cf:2:colspan:3\\ncell:D30:b::1:::colspan:2\\ncell:F30:b::1:::f:2:ntvf:1\\ncell:G30:b::2::2:l:3:f:10\\ncell:A31:b::2:::l:3:f:10\\ncell:B31:b::2::2:l:3:f:10:cf:2\\ncell:C31:b::1::1:f:2:cf:2:colspan:3\\ncell:D31:b::1:::colspan:2\\ncell:F31:b::1:::f:2:ntvf:1\\ncell:G31:b::2::2:l:3:f:10\\ncell:A32:b::2:::l:3:f:10\\ncell:B32:b::2::2:l:3:f:10:cf:2\\ncell:C32:b::1::1:f:2:cf:2:colspan:3\\ncell:D32:b::1:::colspan:2\\ncell:F32:b::1:::f:2:ntvf:1\\ncell:G32:b::2::2:l:3:f:10\\ncell:A33:b::2:::l:3:f:10\\ncell:B33:b::2::2:l:3:f:10:cf:2\\ncell:C33:b::1::1:f:2:cf:2:colspan:3\\ncell:D33:b::1:::colspan:2\\ncell:F33:b::1:::f:2:ntvf:1\\ncell:G33:b::2::2:l:3:f:10\\ncell:A34:b::2:::l:3:f:10\\ncell:B34:b::2::2:l:3:f:10:cf:2\\ncell:C34:b::1::1:f:2:cf:2:colspan:3\\ncell:D34:b::1:::colspan:2\\ncell:F34:b::1:::f:2:ntvf:1\\ncell:G34:b::2::2:l:3:f:10\\ncell:A35:b::2:::l:3:f:7\\ncell:B35:b::2::2:l:3:f:10:cf:2\\ncell:C35:b::1:1:1:f:2:cf:2:colspan:3\\ncell:D35:b::1:1::l:3:f:10:cf:2:colspan:2\\ncell:E35:b:::2::l:3:f:10:cf:2\\ncell:F35:b::1:1::f:2:ntvf:1\\ncell:G35:b::2::2:l:3:f:10\\ncell:A36:b::2:::l:3:f:6\\ncell:B36:b::2::2:l:3:f:6\\ncell:C36:t:TOTAL:b:1:1:1:1:f:11:cf:2:colspan:3\\ncell:D36:b:2::2::l:3:f:12:cf:2\\ncell:E36:b:2:2:2::l:3:f:12:cf:2\\ncell:F36:vtf:n:0:SUM(F23\\\\cF35):b:1:1:1::f:11:ntvf:1\\ncell:G36:b::2::2:l:3:f:7\\ncell:A37:b::2:::l:3:f:10\\ncell:B37:b::::2:l:3:f:6:cf:2\\ncell:C37:b:2::::l:1:f:10\\ncell:D37:b:2::::l:1:f:10\\ncell:E37:b:2::::l:1:f:10\\ncell:F37:b:2::::l:1:f:10\\ncell:G37:b::2:::l:3:f:6\\ncell:A38:b::2:::l:3:f:10\\ncell:B38:b::::2:l:3:f:10\\ncell:G38:b::2:::l:3:f:10\\ncell:A39:b::2:::l:3:f:10\\ncell:B39:b::::2:l:3:f:10:cf:2\\ncell:C39:t:Thank you for your business:f:4:cf:1:colspan:4\\ncell:D39:t:Thank you for your business:colspan:3\\ncell:E39:t:Thank you for your business:f:3:colspan:2\\ncell:F39:t::l:2:f:10\\ncell:G39:b::2:::l:3:f:10\\ncell:A40:b::2:::l:3:f:10\\ncell:B40:b::::2:l:3:f:10\\ncell:G40:b::2:::l:3:f:10\\ncell:A41:b::2:::l:3:f:10\\ncell:B41:b:::2:2:l:3:f:10\\ncell:C41:b:::2::l:3:f:10\\ncell:D41:b:::2::l:3:f:10\\ncell:E41:b:::2::l:3:f:10\\ncell:F41:b:::2::l:3:f:10\\ncell:G41:b::2:2::l:3:f:10\\ncell:B42:b:1:::\\ncell:C42:b:1:::\\ncell:D42:b:1:::\\ncell:E42:b:1:::\\ncell:F42:b:1:::\\ncell:G42:b:1:::\\ncol:A:w:10\\ncol:B:w:10\\ncol:C:w:62\\ncol:D:w:73\\ncol:E:w:15\\ncol:F:w:68\\ncol:G:w:10\\nrow:1:h:14.25\\nrow:2:h:18.75\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:15.75\\nrow:6:h:15.75\\nrow:7:h:15.75\\nrow:8:h:15.75\\nrow:9:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:13:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:16:h:14.25\\nrow:17:h:14.25\\nrow:18:h:14.25\\nrow:19:h:14.25\\nrow:20:h:14.25\\nrow:21:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nrow:24:h:14.25\\nrow:25:h:14.25\\nrow:26:h:14.25\\nrow:27:h:14.25\\nrow:28:h:14.25\\nrow:29:h:14.25\\nrow:30:h:14.25\\nrow:31:h:14.25\\nrow:32:h:14.25\\nrow:33:h:14.25\\nrow:34:h:14.25\\nrow:35:h:15.75\\nrow:36:h:15.75\\nrow:37:h:14.25\\nrow:38:h:14.25\\nrow:39:h:14.25\\nrow:40:h:14.25\\nrow:41:h:14.25\\nsheet:c:7:r:42:h:12.75\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\nfont:1:* * Trebuchet MS\\nfont:2:* 9pt Trebuchet MS\\nfont:3:italic bold * Trebuchet MS\\nfont:4:italic bold 10pt Trebuchet MS\\nfont:5:normal bold * Trebuchet MS\\nfont:6:normal bold 10pt Arial\\nfont:7:normal bold 12pt Arial\\nfont:8:normal normal * *\\nfont:9:normal normal * Trebuchet MS\\nfont:10:normal normal 10pt Arial\\nfont:11:normal normal 11pt Trebuchet MS\\nfont:12:normal normal 12pt Arial\\nfont:13:normal normal 16pt Trebuchet MS\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nlayout:3:padding:* * * *;vertical-align:top;\\nlayout:4:padding:* * * 4px;vertical-align:*;\\nvalueformat:1:#,##0.00\\nvalueformat:2:d-mmm\\nvalueformat:3:m/d/yy\\nvalueformat:4:text-html\\n\"},\"name\":\"inv1\",\"hidden\":\"0\"},\"sheet2\":{\"sheetstr\":{\"savestr\":\"version:1.5\\ncell:B2:t:INVOICE:l:1:f:9:cf:1:colspan:6\\ncell:C2:t::l:2:f:13\\ncell:D2:t::l:2:f:13\\ncell:E2:l:1:f:10:c:2:cf:3\\ncell:F2:t:INVOICE:l:1:f:8:c:2:cf:2:colspan:2\\ncell:G2:t::l:2:f:13\\ncell:B3:f:6:cf:2:colspan:4\\ncell:C3:t::l:2:f:13\\ncell:D3:t::l:2:f:13\\ncell:F3:l:1:f:7:cf:2\\ncell:G3:l:1:f:14:cf:2:ntvf:3\\ncell:B4:f:2:colspan:2\\ncell:F4:t:DATE\\\\c:l:1:f:14:cf:2\\ncell:G4:vtf:nd:42081:TODAY():l:1:f:14:cf:2:ntvf:3\\ncell:B5:t:INVOICE #\\\\c:f:3:colspan:6\\ncell:C5:cf:2:colspan:5\\ncell:F5:l:1:f:7:cf:2:colspan:2\\ncell:G5:l:1:f:14:cf:2\\ncell:B6:f:2:colspan:2\\ncell:F6:l:1:f:7:cf:2:colspan:2\\ncell:G6:l:1:f:14:cf:2\\ncell:B7:t:FROM\\\\c:f:12\\ncell:F7:l:1:f:7:cf:2:tvf:4:colspan:2:rowspan:6\\ncell:G7:l:1:f:14:cf:2\\ncell:B8:t:[Company Name]:f:3:colspan:4\\ncell:F8:l:1:f:7:cf:2:colspan:2\\ncell:G8:l:1:f:14:cf:2\\ncell:B9:t:[Street Address]:f:1:cf:2:colspan:4\\ncell:F9:l:1:f:7\\ncell:G9:l:1:f:14:cf:1\\ncell:B10:t:[City, State,  Zip]:f:1:cf:2:colspan:4\\ncell:G10:l:1:f:13\\ncell:B11:t:Phone\\\\c :f:1:cf:2:colspan:4\\ncell:B12:t:Email\\\\c:f:1:cf:2:colspan:4\\ncell:B13:colspan:2\\ncell:B14:t:BILL TO\\\\c:f:11:cf:2\\ncell:B15:t:[Name]:f:1:cf:2:colspan:6\\ncell:B16:t:[Company Name]:f:1:cf:2:colspan:6\\ncell:F16:t:  \\ncell:B17:t:[Street Address]:f:1:cf:2:colspan:6\\ncell:B18:t:[City, State,  Zip]:f:1:cf:2:colspan:6\\ncell:B19:t:Phone\\\\c :f:1:cf:2:colspan:6\\ncell:B20:t:Email\\\\c:f:1:cf:2:colspan:6\\ncell:A22:b::1::\\ncell:B22:t:DESCRIPTION:b:1:1:1:1:l:1:f:14:c:1:bg:3:cf:1:colspan:5:rowspan:1\\ncell:C22:t::l:2:f:13\\ncell:D22:t::l:2:f:13\\ncell:E22:t::l:2:f:13\\ncell:F22:t::l:2:f:13\\ncell:G22:t:AMOUNT:b:1:1:1::l:1:f:14:c:1:bg:3:cf:1\\ncell:A23:b::1::\\ncell:B23:b:1:1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C23:t::l:2:f:4\\ncell:D23:t::l:2:f:4\\ncell:E23:t::l:2:f:4\\ncell:F23:t::b::2:::l:1:f:4\\ncell:G23:b::1::1:f:4:ntvf:1\\ncell:A24:b::1::\\ncell:B24:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C24:t::l:2:f:4\\ncell:D24:t::l:2:f:4\\ncell:E24:t::l:2:f:4\\ncell:F24:t::b::2:::l:1:f:4\\ncell:G24:b::1::1:f:4:ntvf:1\\ncell:A25:b::1::\\ncell:B25:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C25:t::l:2:f:4\\ncell:D25:t::l:2:f:4\\ncell:E25:t::l:2:f:4\\ncell:F25:t::b::2:::l:1:f:4\\ncell:G25:b::1::1:f:4:ntvf:1\\ncell:A26:b::1::\\ncell:B26:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C26:t::l:2:f:4\\ncell:D26:t::l:2:f:4\\ncell:E26:t::l:2:f:4\\ncell:F26:t::b::2:::l:1:f:4\\ncell:G26:b::1::1:f:4:ntvf:1\\ncell:A27:b::1::\\ncell:B27:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C27:t::l:2:f:4\\ncell:D27:t::l:2:f:4\\ncell:E27:t::l:2:f:4\\ncell:F27:t::b::2:::l:1:f:4\\ncell:G27:b::1::1:f:4:ntvf:1\\ncell:A28:b::1::\\ncell:B28:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C28:t::l:2:f:4\\ncell:D28:t::l:2:f:4\\ncell:E28:t::l:2:f:4\\ncell:F28:t::b::2:::l:1:f:4\\ncell:G28:b::1::1:f:4:ntvf:1\\ncell:A29:b::1::\\ncell:B29:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C29:t::l:2:f:4\\ncell:D29:t::l:2:f:4\\ncell:E29:t::l:2:f:4\\ncell:F29:t::b::2:::l:1:f:4\\ncell:G29:b::1::1:f:4:ntvf:1\\ncell:A30:b::1::\\ncell:B30:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C30:t::l:2:f:4\\ncell:D30:t::l:2:f:4\\ncell:E30:t::l:2:f:4\\ncell:F30:t::b::2:::l:1:f:4\\ncell:G30:b::1::1:f:4:ntvf:1\\ncell:A31:b::1::\\ncell:B31:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C31:t::l:2:f:4\\ncell:D31:t::l:2:f:4\\ncell:E31:t::l:2:f:4\\ncell:F31:t::b::2:::l:1:f:4\\ncell:G31:b::1::1:f:4:ntvf:1\\ncell:A32:b::1::\\ncell:B32:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C32:t::l:2:f:4\\ncell:D32:t::l:2:f:4\\ncell:E32:t::l:2:f:4\\ncell:F32:t::b::2:::l:1:f:4\\ncell:G32:b::1::1:f:4:ntvf:1\\ncell:A33:b::1::\\ncell:B33:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C33:t::l:2:f:4\\ncell:D33:t::l:2:f:4\\ncell:E33:t::l:2:f:4\\ncell:F33:t::b::2:::l:1:f:4\\ncell:G33:b::1::1:f:4:ntvf:1\\ncell:A34:b::1::\\ncell:B34:b::1::1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C34:l:2:f:4\\ncell:D34:l:2:f:4\\ncell:E34:l:2:f:4\\ncell:F34:b::2:::l:1:f:4\\ncell:G34:b::1::1:f:4:ntvf:1\\ncell:A35:b::1::\\ncell:B35:b::1:1:1:f:4:cf:2:colspan:5:rowspan:1\\ncell:C35:t::b:::2::l:1:f:4\\ncell:D35:t::b:::2::l:1:f:4\\ncell:E35:t::b:::2::l:1:f:4\\ncell:F35:t::b::2:2::l:1:f:4\\ncell:G35:b::1:1:1:f:4:ntvf:1\\ncell:B36:b:2::::l:1:f:13\\ncell:C36:b:2::::l:1:f:13\\ncell:D36:b:2::::l:1:f:13\\ncell:E36:b:2::::l:1:f:14\\ncell:F36:t:Subtotal:b:2::::l:1:f:11\\ncell:G36:vtf:n:0:SUM(G23\\\\cG35):b:1::::f:11:ntvf:1\\ncell:B37:t:NOTES:b:::1::l:1:f:14:cf:2:colspan:3:rowspan:1\\ncell:C37:t::b:::2::l:1:f:13\\ncell:D37:t::b:::2::l:1:f:13\\ncell:F37:t:Tax Rate:l:1:f:11\\ncell:G37:v:0:f:1:ntvf:2\\ncell:B38:b:1::::f:1:cf:2:colspan:3\\ncell:C38:t::b:2::::l:1:f:13\\ncell:D38:t::b:2::::l:1:f:13\\ncell:F38:t:Tax:l:1:f:11\\ncell:G38:vtf:n:0:G37*G36:f:1:ntvf:1\\ncell:B39:f:1:cf:2:colspan:3\\ncell:C39:t::l:2:f:13\\ncell:D39:t::l:2:f:13\\ncell:F39:t:Other:b:::1::l:1:f:11\\ncell:G39:v:0:b:::1::f:1:ntvf:1\\ncell:B40:b:::1::f:1:cf:2:colspan:3:rowspan:1\\ncell:C40:t::l:2:f:13\\ncell:D40:t::l:2:f:13\\ncell:F40:t:TOTAL:b:1::::l:1:f:14\\ncell:G40:vtf:n:0:(G36+G38)+G39:b:1::::f:11:ntvf:1\\ncell:B43:t:Thank you for your business:l:1:f:5:cf:1:colspan:6:rowspan:1\\ncell:C43:t::l:2:f:13\\ncell:D43:t::l:2:f:13\\ncell:E43:t::l:2:f:13\\ncell:F43:t::l:2:f:13\\ncell:G43:t::l:2:f:13\\ncol:A:w:10\\ncol:B:w:90\\ncol:C:w:19\\ncol:D:w:10\\ncol:E:w:16\\ncol:F:w:45\\ncol:G:w:64\\nrow:1:h:34.5\\nrow:2:h:34.5\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:14.25\\nrow:6:h:14.25\\nrow:7:h:14.25\\nrow:8:h:14.25\\nrow:9:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:16:h:14.25\\nrow:17:h:14.25\\nrow:18:h:14.25\\nrow:19:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nrow:24:h:14.25\\nrow:25:h:14.25\\nrow:26:h:14.25\\nrow:27:h:14.25\\nrow:28:h:14.25\\nrow:29:h:14.25\\nrow:30:h:14.25\\nrow:31:h:14.25\\nrow:32:h:14.25\\nrow:33:h:14.25\\nrow:34:h:14.25\\nrow:35:h:14.25\\nrow:36:h:14.25\\nrow:37:h:14.25\\nrow:38:h:14.25\\nrow:39:h:14.25\\nrow:40:h:14.25\\nrow:43:h:15.75\\nsheet:c:7:r:43:h:12.75:needsrecalc:yes\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\ncellformat:3:right\\ncolor:1:rgb(0, 0, 0)\\ncolor:2:rgb(0,0,0)\\ncolor:3:rgb(221, 221, 221)\\nfont:1:* * Trebuchet MS\\nfont:2:* 10pt *\\nfont:3:* 10pt Trebuchet MS\\nfont:4:* 9pt Trebuchet MS\\nfont:5:italic bold 10pt Trebuchet MS\\nfont:6:italic normal * Trebuchet MS\\nfont:7:normal bold 10pt Trebuchet MS\\nfont:8:normal bold 14pt Trebuchet MS\\nfont:9:normal bold 16pt Trebuchet MS\\nfont:10:normal bold 28pt Trebuchet MS\\nfont:11:normal normal * Trebuchet MS\\nfont:12:normal normal 10pt *\\nfont:13:normal normal 10pt Arial\\nfont:14:normal normal 10pt Trebuchet MS\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nvalueformat:1:#,##0.00\\nvalueformat:2:#,##0.00%\\nvalueformat:3:m/d/yy\\nvalueformat:4:text-html\\n\"},\"name\":\"inv2\",\"hidden\":\"0\"},\"sheet3\":{\"sheetstr\":{\"savestr\":\"version:1.5\\ncell:B2:t:INVOICE:l:1:f:12:cf:1:colspan:6\\ncell:C2:t::l:2:f:10\\ncell:D2:t::l:2:f:10\\ncell:E2:l:1:f:8:c:2:cf:3\\ncell:F2:t:INVOICE:l:1:f:7:c:2:cf:2:colspan:2\\ncell:G2:t::l:2:f:10\\ncell:B3:f:5:cf:2:colspan:4\\ncell:C3:t::l:2:f:10\\ncell:D3:t::l:2:f:10\\ncell:F3:l:1:f:6:cf:2\\ncell:G3:l:1:f:11:cf:2:ntvf:3\\ncell:B4:f:2:colspan:2\\ncell:F4:t:DATE\\\\c:l:1:f:11:cf:2\\ncell:G4:vtf:nd:42081:TODAY():l:1:f:11:cf:2:ntvf:3\\ncell:B5:t:INVOICE #\\\\c:f:9:colspan:6\\ncell:C5:cf:2:colspan:5\\ncell:F5:l:1:f:6:cf:2:colspan:2\\ncell:G5:l:1:f:11:cf:2\\ncell:B6:f:2:colspan:2\\ncell:F6:l:1:f:6:cf:2:colspan:2\\ncell:G6:l:1:f:11:cf:2\\ncell:B7:t:FROM\\\\c:f:11\\ncell:F7:l:1:f:6:cf:2:colspan:2\\ncell:G7:l:1:f:11:cf:2\\ncell:B8:t:[Company Name]:f:9:colspan:4\\ncell:F8:l:1:f:6:cf:2:tvf:4:colspan:2:rowspan:5\\ncell:G8:l:1:f:11:cf:2\\ncell:B9:t:[Street Address]:f:9:cf:2:colspan:4\\ncell:F9:l:1:f:6\\ncell:G9:l:1:f:11:cf:1\\ncell:B10:t:[City, State,  Zip]:f:9:cf:2:colspan:4\\ncell:G10:l:1:f:10\\ncell:B11:t:Phone\\\\c :f:9:cf:2:colspan:4\\ncell:B12:t:Email\\\\c:f:9:cf:2:colspan:4\\ncell:B13:colspan:2\\ncell:B14:t:BILL TO\\\\c:f:9:cf:2\\ncell:B15:t:[Name]:f:9:cf:2:colspan:6\\ncell:B16:t:[Company Name]:f:9:cf:2:colspan:6\\ncell:F16:t:  \\ncell:B17:t:[Street Address]:f:9:cf:2:colspan:6\\ncell:B18:t:[City, State,  Zip]:f:9:cf:2:colspan:6\\ncell:B19:t:Phone\\\\c :f:9:cf:2:colspan:6\\ncell:B20:t:Email\\\\c:f:9:cf:2:colspan:6\\ncell:A22:b::1::\\ncell:B22:t:DESCRIPTION:b:1:1:1:1:l:1:f:11:c:1:bg:3:cf:1:colspan:5:rowspan:1\\ncell:C22:t::l:2:f:10\\ncell:D22:t::l:2:f:10\\ncell:E22:t::l:2:f:10\\ncell:F22:t::l:2:f:10\\ncell:G22:t:AMOUNT:b:1:1:1::l:1:f:11:c:1:bg:3:cf:1\\ncell:A23:b::1::\\ncell:B23:vtf:t: :IF(AND(ISBLANK(inv3!B6),ISBLANK(sheet7!B6)), \\\" \\\", IF(ISBLANK(inv3!B6), sheet7!B6, inv3!B6)):b:1:1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C23:t::l:2:f:3\\ncell:D23:t::l:2:f:3\\ncell:E23:t::l:2:f:3\\ncell:F23:t::b::2:::l:1:f:3\\ncell:G23:vtf:t: :IF(AND(ISBLANK(inv3!B6),ISBLANK(sheet7!B6)), \\\" \\\", IF(ISBLANK(inv3!B6), (sheet7!E6*sheet7!F6), (inv3!E6*inv3!F6))):b::1::1:f:3:ntvf:1\\ncell:A24:b::1::\\ncell:B24:vtf:t: :IF(AND(ISBLANK(INV3!B7),ISBLANK(SHEET7!B7)), \\\" \\\", IF(ISBLANK(INV3!B7), SHEET7!B7, INV3!B7)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C24:t::l:2:f:3\\ncell:D24:t::l:2:f:3\\ncell:E24:t::l:2:f:3\\ncell:F24:t::b::2:::l:1:f:3\\ncell:G24:vtf:t: :IF(AND(ISBLANK(INV3!B7),ISBLANK(SHEET7!B7)), \\\" \\\", IF(ISBLANK(INV3!B7), (SHEET7!E7*SHEET7!F7), (INV3!E7*INV3!F7))):b::1::1:f:3:ntvf:1\\ncell:A25:b::1::\\ncell:B25:vtf:t: :IF(AND(ISBLANK(INV3!B8),ISBLANK(SHEET7!B8)), \\\" \\\", IF(ISBLANK(INV3!B8), SHEET7!B8, INV3!B8)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C25:t::l:2:f:3\\ncell:D25:t::l:2:f:3\\ncell:E25:t::l:2:f:3\\ncell:F25:t::b::2:::l:1:f:3\\ncell:G25:vtf:t: :IF(AND(ISBLANK(INV3!B8),ISBLANK(SHEET7!B8)), \\\" \\\", IF(ISBLANK(INV3!B8), (SHEET7!E8*SHEET7!F8), (INV3!E8*INV3!F8))):b::1::1:f:3:ntvf:1\\ncell:A26:b::1::\\ncell:B26:vtf:t: :IF(AND(ISBLANK(INV3!B9),ISBLANK(SHEET7!B9)), \\\" \\\", IF(ISBLANK(INV3!B9), SHEET7!B9, INV3!B9)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C26:t::l:2:f:3\\ncell:D26:t::l:2:f:3\\ncell:E26:t::l:2:f:3\\ncell:F26:t::b::2:::l:1:f:3\\ncell:G26:vtf:t: :IF(AND(ISBLANK(INV3!B9),ISBLANK(SHEET7!B9)), \\\" \\\", IF(ISBLANK(INV3!B9), (SHEET7!E9*SHEET7!F9), (INV3!E9*INV3!F9))):b::1::1:f:3:ntvf:1\\ncell:A27:b::1::\\ncell:B27:vtf:t: :IF(AND(ISBLANK(INV3!B10),ISBLANK(SHEET7!B10)), \\\" \\\", IF(ISBLANK(INV3!B10), SHEET7!B10, INV3!B10)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C27:t::l:2:f:3\\ncell:D27:t::l:2:f:3\\ncell:E27:t::l:2:f:3\\ncell:F27:t::b::2:::l:1:f:3\\ncell:G27:vtf:t: :IF(AND(ISBLANK(INV3!B10),ISBLANK(SHEET7!B10)), \\\" \\\", IF(ISBLANK(INV3!B10), (SHEET7!E10*SHEET7!F10), (INV3!E10*INV3!F10))):b::1::1:f:3:ntvf:1\\ncell:A28:b::1::\\ncell:B28:vtf:t: :IF(AND(ISBLANK(INV3!B11),ISBLANK(SHEET7!B11)), \\\" \\\", IF(ISBLANK(INV3!B11), SHEET7!B11, INV3!B11)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C28:t::l:2:f:3\\ncell:D28:t::l:2:f:3\\ncell:E28:t::l:2:f:3\\ncell:F28:t::b::2:::l:1:f:3\\ncell:G28:vtf:t: :IF(AND(ISBLANK(INV3!B11),ISBLANK(SHEET7!B11)), \\\" \\\", IF(ISBLANK(INV3!B11), (SHEET7!E11*SHEET7!F11), (INV3!E11*INV3!F11))):b::1::1:f:3:ntvf:1\\ncell:A29:b::1::\\ncell:B29:vtf:t: :IF(AND(ISBLANK(INV3!B12),ISBLANK(SHEET7!B12)), \\\" \\\", IF(ISBLANK(INV3!B12), SHEET7!B12, INV3!B12)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C29:t::l:2:f:3\\ncell:D29:t::l:2:f:3\\ncell:E29:t::l:2:f:3\\ncell:F29:t::b::2:::l:1:f:3\\ncell:G29:vtf:t: :IF(AND(ISBLANK(INV3!B12),ISBLANK(SHEET7!B12)), \\\" \\\", IF(ISBLANK(INV3!B12), (SHEET7!E12*SHEET7!F12), (INV3!E12*INV3!F12))):b::1::1:f:3:ntvf:1\\ncell:A30:b::1::\\ncell:B30:vtf:t: :IF(AND(ISBLANK(INV3!B13),ISBLANK(SHEET7!B13)), \\\" \\\", IF(ISBLANK(INV3!B13), SHEET7!B13, INV3!B13)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C30:t::l:2:f:3\\ncell:D30:t::l:2:f:3\\ncell:E30:t::l:2:f:3\\ncell:F30:t::b::2:::l:1:f:3\\ncell:G30:vtf:t: :IF(AND(ISBLANK(INV3!B13),ISBLANK(SHEET7!B13)), \\\" \\\", IF(ISBLANK(INV3!B13), (SHEET7!E13*SHEET7!F13), (INV3!E13*INV3!F13))):b::1::1:f:3:ntvf:1\\ncell:A31:b::1::\\ncell:B31:vtf:t: :IF(AND(ISBLANK(INV3!B14),ISBLANK(SHEET7!B14)), \\\" \\\", IF(ISBLANK(INV3!B14), SHEET7!B14, INV3!B14)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C31:t::l:2:f:3\\ncell:D31:t::l:2:f:3\\ncell:E31:t::l:2:f:3\\ncell:F31:t::b::2:::l:1:f:3\\ncell:G31:vtf:t: :IF(AND(ISBLANK(INV3!B14),ISBLANK(SHEET7!B14)), \\\" \\\", IF(ISBLANK(INV3!B14), (SHEET7!E14*SHEET7!F14), (INV3!E14*INV3!F14))):b::1::1:f:3:ntvf:1\\ncell:A32:b::1::\\ncell:B32:vtf:t: :IF(AND(ISBLANK(INV3!B15),ISBLANK(SHEET7!B15)), \\\" \\\", IF(ISBLANK(INV3!B15), SHEET7!B15, INV3!B15)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C32:t::l:2:f:3\\ncell:D32:t::l:2:f:3\\ncell:E32:t::l:2:f:3\\ncell:F32:t::b::2:::l:1:f:3\\ncell:G32:vtf:t: :IF(AND(ISBLANK(INV3!B15),ISBLANK(SHEET7!B15)), \\\" \\\", IF(ISBLANK(INV3!B15), (SHEET7!E15*SHEET7!F15), (INV3!E15*INV3!F15))):b::1::1:f:3:ntvf:1\\ncell:A33:b::1::\\ncell:B33:vtf:t: :IF(AND(ISBLANK(INV3!B16),ISBLANK(SHEET7!B16)), \\\" \\\", IF(ISBLANK(INV3!B16), SHEET7!B16, INV3!B16)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C33:l:2:f:3\\ncell:D33:l:2:f:3\\ncell:E33:l:2:f:3\\ncell:F33:b::2:::l:1:f:3\\ncell:G33:vtf:t: :IF(AND(ISBLANK(INV3!B16),ISBLANK(SHEET7!B16)), \\\" \\\", IF(ISBLANK(INV3!B16), (SHEET7!E16*SHEET7!F16), (INV3!E16*INV3!F16))):b::1::1:f:3:ntvf:1\\ncell:A34:b::1::\\ncell:B34:vtf:t: :IF(AND(ISBLANK(INV3!B17),ISBLANK(SHEET7!B17)), \\\" \\\", IF(ISBLANK(INV3!B17), SHEET7!B17, INV3!B17)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C34:t::l:2:f:3\\ncell:D34:t::l:2:f:3\\ncell:E34:t::l:2:f:3\\ncell:F34:t::b::2:::l:1:f:3\\ncell:G34:vtf:t: :IF(AND(ISBLANK(INV3!B17),ISBLANK(SHEET7!B17)), \\\" \\\", IF(ISBLANK(INV3!B17), (SHEET7!E17*SHEET7!F17), (INV3!E17*INV3!F17))):b::1::1:f:3:ntvf:1\\ncell:A35:b::1::\\ncell:B35:vtf:t: :IF(AND(ISBLANK(INV3!B18),ISBLANK(SHEET7!B18)), \\\" \\\", IF(ISBLANK(INV3!B18), SHEET7!B18, INV3!B18)):b::1::1:f:3:cf:2:colspan:5:rowspan:1\\ncell:C35:t::b:::2::l:1:f:3\\ncell:D35:t::b:::2::l:1:f:3\\ncell:E35:t::b:::2::l:1:f:3\\ncell:F35:t::b::2:2::l:1:f:3\\ncell:G35:vtf:t: :IF(AND(ISBLANK(INV3!B18),ISBLANK(SHEET7!B18)), \\\" \\\", IF(ISBLANK(INV3!B18), (SHEET7!E18*SHEET7!F18), (INV3!E18*INV3!F18))):b::1::1:f:3:ntvf:1\\ncell:B36:b:2::::l:1:f:10\\ncell:C36:b:2::::l:1:f:10\\ncell:D36:b:2::::l:1:f:10\\ncell:E36:b:2::::l:1:f:11\\ncell:F36:t:Subtotal:b:2::::l:1:f:9\\ncell:G36:vtf:n:0:SUM(G23\\\\cG35):b:1::::f:9:ntvf:1\\ncell:B37:t:NOTES:b:::1::l:1:f:11:cf:2:colspan:3:rowspan:1\\ncell:C37:t::b:::2::l:1:f:10\\ncell:D37:t::b:::2::l:1:f:10\\ncell:F37:t:Tax Rate:l:1:f:9\\ncell:G37:v:0:f:1:ntvf:2\\ncell:B38:b:1::::f:1:cf:2:colspan:3\\ncell:C38:t::b:2::::l:1:f:10\\ncell:D38:t::b:2::::l:1:f:10\\ncell:F38:t:Tax:l:1:f:9\\ncell:G38:vtf:n:0:G37*G36:f:1:ntvf:1\\ncell:B39:f:1:cf:2:colspan:3\\ncell:C39:t::l:2:f:10\\ncell:D39:t::l:2:f:10\\ncell:F39:t:Other:b:::1::l:1:f:9\\ncell:G39:v:0:b:::1::f:1:ntvf:1\\ncell:B40:b:::1::f:1:cf:2:colspan:3:rowspan:1\\ncell:C40:t::l:2:f:10\\ncell:D40:t::l:2:f:10\\ncell:F40:t:TOTAL:b:1::::l:1:f:11\\ncell:G40:vtf:n:0:(G36+G38)+G39:b:1::::f:9:ntvf:1\\ncell:B43:t:Thank you for your business:l:1:f:4:cf:1:colspan:6:rowspan:1\\ncell:C43:t::l:2:f:10\\ncell:D43:t::l:2:f:10\\ncell:E43:t::l:2:f:10\\ncell:F43:t::l:2:f:10\\ncell:G43:t::l:2:f:10\\ncol:A:w:10\\ncol:B:w:65\\ncol:C:w:19\\ncol:D:w:10\\ncol:E:w:16\\ncol:F:w:53\\ncol:G:w:64\\nrow:1:h:34.5\\nrow:2:h:34.5\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:14.25\\nrow:6:h:14.25\\nrow:7:h:14.25\\nrow:8:h:14.25\\nrow:9:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:16:h:14.25\\nrow:17:h:14.25\\nrow:18:h:14.25\\nrow:19:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nrow:24:h:14.25\\nrow:25:h:14.25\\nrow:26:h:14.25\\nrow:27:h:14.25\\nrow:28:h:14.25\\nrow:29:h:14.25\\nrow:30:h:14.25\\nrow:31:h:14.25\\nrow:32:h:14.25\\nrow:33:h:14.25\\nrow:34:h:14.25\\nrow:35:h:14.25\\nrow:36:h:14.25\\nrow:37:h:14.25\\nrow:38:h:14.25\\nrow:39:h:14.25\\nrow:40:h:14.25\\nrow:43:h:15.75\\nsheet:c:7:r:43:h:12.75:needsrecalc:yes\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\ncellformat:3:right\\ncolor:1:rgb(0, 0, 0)\\ncolor:2:rgb(0,0,0)\\ncolor:3:rgb(221, 221, 221)\\nfont:1:* * Trebuchet MS\\nfont:2:* 10pt *\\nfont:3:* 9pt Trebuchet MS\\nfont:4:italic bold 10pt Trebuchet MS\\nfont:5:italic normal * Trebuchet MS\\nfont:6:normal bold 10pt Trebuchet MS\\nfont:7:normal bold 14pt Trebuchet MS\\nfont:8:normal bold 28pt Trebuchet MS\\nfont:9:normal normal * Trebuchet MS\\nfont:10:normal normal 10pt Arial\\nfont:11:normal normal 10pt Trebuchet MS\\nfont:12:normal normal 16pt Trebuchet MS\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nvalueformat:1:#,##0.00\\nvalueformat:2:#,##0.00%\\nvalueformat:3:m/d/yy\\nvalueformat:4:text-html\\n\"},\"name\":\"sheet6\",\"hidden\":\"0\"},\"sheet4\":{\"sheetstr\":{\"savestr\":\"version:1.5\\ncell:B1:b:::2::l:1:f:7\\ncell:C1:b:::2::l:1:f:7\\ncell:D1:b:::2::l:1:f:7\\ncell:E1:b:::2::l:1:f:7\\ncell:F1:b:::2::l:1:f:7\\ncell:A2:b::2:::l:1:f:7\\ncell:B2:t:INVOICE DETAILS:b:1:1:1:1:l:1:f:8:cf:1:colspan:5\\ncell:C2:t::b:2::2::l:1:f:7\\ncell:D2:t::b:2::2::l:1:f:7\\ncell:E2:t::b:2::2::l:1:f:7\\ncell:F2:b:2:1:1::l:1:f:7\\ncell:G2:b::::1\\ncell:A3:b::2:::l:3:f:7\\ncell:B3:b:2::::l:1:f:7\\ncell:C3:b:2::::l:1:f:7\\ncell:D3:b:2::::l:1:f:7\\ncell:E3:b:2::::l:1:f:7\\ncell:F3:b:1:1:::l:1:f:7\\ncell:G3:b::::1\\ncell:A4:b::2:::l:3:f:7\\ncell:B4:b:::2::l:1:f:7\\ncell:C4:b:::2::l:3:f:4:cf:2\\ncell:D4:b:::2::l:1:f:7\\ncell:E4:b:::2::l:1:f:7\\ncell:F4:b::1:1::l:1:f:7\\ncell:G4:b::::1\\ncell:A5:b::2:::l:3:f:7\\ncell:B5:t:Description:b:1:1:1:1:f:6:cf:1:colspan:3\\ncell:C5:t:Description:b:2::2:2:l:3:f:4:cf:2:colspan:2:rowspan:1\\ncell:D5:t::b:2:2:2::l:1:f:7\\ncell:E5:t:Hours:b:1:1:1:1:f:6:cf:1\\ncell:F5:t:Rate:b:1:1:1:1:f:6:cf:1\\ncell:G5:b::::1\\ncell:A6:b::2:::l:3:f:7\\ncell:B6:b:1:1::1:f:1:cf:2:colspan:3\\ncell:C6:b:1:1::1:l:3:f:7:cf:2:colspan:2:rowspan:1\\ncell:D6:t::b:2:2:2::l:1:f:7\\ncell:E6:b:1:1:::f:1:ntvf:1\\ncell:F6:b:1:1:::f:1:ntvf:1\\ncell:G6:b::::1\\ncell:A7:b::2:::l:3:f:7\\ncell:B7:b::1::1:f:1:cf:2:colspan:3\\ncell:C7:b::1::1:l:1:f:7:colspan:2\\ncell:D7:l:1:f:7\\ncell:E7:b::1:::f:1:ntvf:1\\ncell:F7:b::1:::f:1:ntvf:1\\ncell:G7:b::::1\\ncell:A8:b::2:::l:3:f:7\\ncell:B8:b::1::1:f:1:cf:2:colspan:3\\ncell:C8:b::1::1:colspan:2\\ncell:E8:b::1:::f:1:ntvf:1\\ncell:F8:b::1:::f:1:ntvf:1\\ncell:G8:b::::1\\ncell:A9:b::2:::l:3:f:7\\ncell:B9:b::1::1:f:1:cf:2:colspan:3\\ncell:C9:b::1::1:colspan:2\\ncell:E9:b::1:::f:1:ntvf:1\\ncell:F9:b::1:::f:1:ntvf:1\\ncell:G9:b::::1\\ncell:A10:b::2:::l:3:f:7\\ncell:B10:b::1::1:f:1:cf:2:colspan:3\\ncell:C10:b::1::1:colspan:2\\ncell:E10:b::1:::f:1:ntvf:1\\ncell:F10:b::1:::f:1:ntvf:1\\ncell:G10:b::::1\\ncell:A11:b::2:::l:3:f:7\\ncell:B11:b::1::1:f:1:cf:2:colspan:3\\ncell:C11:b::1::1:colspan:2\\ncell:E11:b::1:::f:1:ntvf:1\\ncell:F11:b::1:::f:1:ntvf:1\\ncell:G11:b::::1\\ncell:A12:b::2:::l:3:f:7\\ncell:B12:b::1::1:f:1:cf:2:colspan:3\\ncell:C12:b::1::1:colspan:2\\ncell:E12:b::1:::f:1:ntvf:1\\ncell:F12:b::1:::f:1:ntvf:1\\ncell:G12:b::::1\\ncell:A13:b::2:::l:3:f:7\\ncell:B13:b::1::1:f:1:cf:2:colspan:3\\ncell:C13:b::1::1:colspan:2\\ncell:E13:b::1:::f:1:ntvf:1\\ncell:F13:b::1:::f:1:ntvf:1\\ncell:G13:b::::1\\ncell:A14:b::2:::l:3:f:7\\ncell:B14:b::1::1:f:1:cf:2:colspan:3\\ncell:C14:b::1::1:colspan:2\\ncell:E14:b::1:::f:1:ntvf:1\\ncell:F14:b::1:::f:1:ntvf:1\\ncell:G14:b::::1\\ncell:A15:b::2:::l:3:f:7\\ncell:B15:b::1::1:f:1:cf:2:colspan:3\\ncell:C15:b::1::1:colspan:2\\ncell:E15:b::1:::f:1:ntvf:1\\ncell:F15:b::1:::f:1:ntvf:1\\ncell:G15:b::::1\\ncell:A16:b::2:::l:3:f:7\\ncell:B16:b::1::1:f:1:cf:2:colspan:3\\ncell:C16:b::1::1:colspan:2\\ncell:E16:b::1:::f:1:ntvf:1\\ncell:F16:b::1:::f:1:ntvf:1\\ncell:G16:b::::1\\ncell:A17:b::2:::l:3:f:7\\ncell:B17:b::1::1:f:1:cf:2:colspan:3\\ncell:C17:b::1::1:colspan:2\\ncell:E17:b::1:::f:1:ntvf:1\\ncell:F17:b::1:::f:1:ntvf:1\\ncell:G17:b::::1\\ncell:A18:b::2:::l:3:f:5\\ncell:B18:b::1:1:1:f:1:cf:2:colspan:3\\ncell:C18:b::1:1:1:l:3:f:7:cf:2:colspan:2\\ncell:D18:b:::2::l:3:f:7:cf:2\\ncell:E18:b::1:1::f:1:ntvf:1\\ncell:F18:b::1:1::f:1:ntvf:1\\ncell:G18:b::::1\\ncell:A19:b::2:::l:3:f:7\\ncell:F19:b::1::\\ncell:G19:b::::1\\ncell:A20:b::2:::l:3:f:7\\ncell:F20:b::1::\\ncell:G20:b::::1\\ncell:A21:b::2:::l:3:f:7\\ncell:C21:t:Thank you for your business:b::1:::f:3:colspan:4\\ncell:D21:t:Thank you for your business:f:2:colspan:4\\ncell:E21:t::l:2:f:7\\ncell:F21:l:2:f:7\\ncell:G21:b::::1\\ncell:A22:b::2:::l:3:f:7\\ncell:F22:b::1::\\ncell:G22:b::::1\\ncell:A23:b::2:::l:3:f:7\\ncell:B23:b:::2::l:3:f:7\\ncell:C23:b:::2::l:3:f:7\\ncell:D23:b:::2::l:3:f:7\\ncell:E23:b:::2::l:3:f:7\\ncell:F23:b::1:1::l:3:f:7\\ncell:G23:b::::1\\ncell:B24:b:1:::\\ncell:C24:b:1:::\\ncell:D24:b:1:::\\ncell:E24:b:1:::\\ncell:F24:b:1:::\\ncol:A:w:10\\ncol:B:w:42\\ncol:C:w:56\\ncol:D:w:39\\ncol:E:w:48\\ncol:F:w:57\\nrow:1:h:14.25\\nrow:2:h:18.75\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:14.25\\nrow:6:h:14.25\\nrow:7:h:14.25\\nrow:8:h:14.25\\nrow:9:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:13:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:16:h:14.25\\nrow:17:h:14.25\\nrow:18:h:15.75\\nrow:19:h:14.25\\nrow:20:h:14.25\\nrow:21:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nsheet:c:7:r:24:h:12.75:needsrecalc:yes\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\nfont:1:* * Trebuchet MS\\nfont:2:italic bold * Trebuchet MS\\nfont:3:italic bold 10pt Trebuchet MS\\nfont:4:normal bold 10pt Arial\\nfont:5:normal bold 12pt Arial\\nfont:6:normal normal * Trebuchet MS\\nfont:7:normal normal 10pt Arial\\nfont:8:normal normal 16pt Arial\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nlayout:3:padding:* * * *;vertical-align:top;\\nvalueformat:1:#,##0.00\\n\"},\"name\":\"inv3\",\"hidden\":\"0\"},\"sheet5\":{\"sheetstr\":{\"savestr\":\"version:1.5\\ncell:B1:b:::2::l:1:f:7\\ncell:C1:b:::2::l:1:f:7\\ncell:D1:b:::2::l:1:f:7\\ncell:E1:b:::2::l:1:f:7\\ncell:F1:b:::2::l:1:f:7\\ncell:A2:b::2:::l:1:f:7\\ncell:B2:t:INVOICE DETAILS:b:1:1:1:1:l:1:f:8:cf:1:colspan:5\\ncell:C2:t::b:2::2::l:1:f:7\\ncell:D2:t::b:2::2::l:1:f:7\\ncell:E2:t::b:2::2::l:1:f:7\\ncell:F2:b:2:1:1::l:1:f:7\\ncell:G2:b::::1\\ncell:A3:b::2:::l:3:f:7\\ncell:B3:b:2::::l:1:f:7\\ncell:C3:b:2::::l:1:f:7\\ncell:D3:b:2::::l:1:f:7\\ncell:E3:b:2::::l:1:f:7\\ncell:F3:b:1:1:::l:1:f:7\\ncell:G3:b::::1\\ncell:A4:b::2:::l:3:f:7\\ncell:B4:b:::2::l:1:f:7\\ncell:C4:b:::2::l:3:f:4:cf:2\\ncell:D4:b:::2::l:1:f:7\\ncell:E4:b:::2::l:1:f:7\\ncell:F4:b::1:1::l:1:f:7\\ncell:G4:b::::1\\ncell:A5:b::2:::l:3:f:7\\ncell:B5:t:Description:b:1:1:1:1:f:6:cf:1:colspan:3\\ncell:C5:t:Description:b:2::2:2:l:3:f:4:cf:2:colspan:2:rowspan:1\\ncell:D5:t::b:2:2:2::l:1:f:7\\ncell:E5:t:Qty.:b:1:1:1:1:f:6:cf:1\\ncell:F5:t:Price:b:1:1:1:1:f:6:cf:1\\ncell:G5:b::::1\\ncell:A6:b::2:::l:3:f:7\\ncell:B6:b:1:1::1:f:1:cf:2:colspan:3\\ncell:C6:b:1:1::1:l:3:f:7:cf:2:colspan:2:rowspan:1\\ncell:D6:t::b:2:2:2::l:1:f:7\\ncell:E6:b:1:1:::f:1:ntvf:1\\ncell:F6:b:1:1:::f:1:ntvf:1\\ncell:G6:b::::1\\ncell:A7:b::2:::l:3:f:7\\ncell:B7:b::1::1:f:1:cf:2:colspan:3\\ncell:C7:b::1::1:l:1:f:7:colspan:2\\ncell:D7:l:1:f:7\\ncell:E7:b::1:::f:1:ntvf:1\\ncell:F7:b::1:::f:1:ntvf:1\\ncell:G7:b::::1\\ncell:A8:b::2:::l:3:f:7\\ncell:B8:b::1::1:f:1:cf:2:colspan:3\\ncell:C8:b::1::1:colspan:2\\ncell:E8:b::1:::f:1:ntvf:1\\ncell:F8:b::1:::f:1:ntvf:1\\ncell:G8:b::::1\\ncell:A9:b::2:::l:3:f:7\\ncell:B9:b::1::1:f:1:cf:2:colspan:3\\ncell:C9:b::1::1:colspan:2\\ncell:E9:b::1:::f:1:ntvf:1\\ncell:F9:b::1:::f:1:ntvf:1\\ncell:G9:b::::1\\ncell:A10:b::2:::l:3:f:7\\ncell:B10:b::1::1:f:1:cf:2:colspan:3\\ncell:C10:b::1::1:colspan:2\\ncell:E10:b::1:::f:1:ntvf:1\\ncell:F10:b::1:::f:1:ntvf:1\\ncell:G10:b::::1\\ncell:A11:b::2:::l:3:f:7\\ncell:B11:b::1::1:f:1:cf:2:colspan:3\\ncell:C11:b::1::1:colspan:2\\ncell:E11:b::1:::f:1:ntvf:1\\ncell:F11:b::1:::f:1:ntvf:1\\ncell:G11:b::::1\\ncell:A12:b::2:::l:3:f:7\\ncell:B12:b::1::1:f:1:cf:2:colspan:3\\ncell:C12:b::1::1:colspan:2\\ncell:E12:b::1:::f:1:ntvf:1\\ncell:F12:b::1:::f:1:ntvf:1\\ncell:G12:b::::1\\ncell:A13:b::2:::l:3:f:7\\ncell:B13:b::1::1:f:1:cf:2:colspan:3\\ncell:C13:b::1::1:colspan:2\\ncell:E13:b::1:::f:1:ntvf:1\\ncell:F13:b::1:::f:1:ntvf:1\\ncell:G13:b::::1\\ncell:A14:b::2:::l:3:f:7\\ncell:B14:b::1::1:f:1:cf:2:colspan:3\\ncell:C14:b::1::1:colspan:2\\ncell:E14:b::1:::f:1:ntvf:1\\ncell:F14:b::1:::f:1:ntvf:1\\ncell:G14:b::::1\\ncell:A15:b::2:::l:3:f:7\\ncell:B15:b::1::1:f:1:cf:2:colspan:3\\ncell:C15:b::1::1:colspan:2\\ncell:E15:b::1:::f:1:ntvf:1\\ncell:F15:b::1:::f:1:ntvf:1\\ncell:G15:b::::1\\ncell:A16:b::2:::l:3:f:7\\ncell:B16:b::1::1:f:1:cf:2:colspan:3\\ncell:C16:b::1::1:colspan:2\\ncell:E16:b::1:::f:1:ntvf:1\\ncell:F16:b::1:::f:1:ntvf:1\\ncell:G16:b::::1\\ncell:A17:b::2:::l:3:f:7\\ncell:B17:b::1::1:f:1:cf:2:colspan:3\\ncell:C17:b::1::1:colspan:2\\ncell:E17:b::1:::f:1:ntvf:1\\ncell:F17:b::1:::f:1:ntvf:1\\ncell:G17:b::::1\\ncell:A18:b::2:::l:3:f:5\\ncell:B18:b::1:1:1:f:1:cf:2:colspan:3\\ncell:C18:b::1:1:1:l:3:f:7:cf:2:colspan:2\\ncell:D18:b:::2::l:3:f:7:cf:2\\ncell:E18:b::1:1::f:1:ntvf:1\\ncell:F18:b::1:1::f:1:ntvf:1\\ncell:G18:b::::1\\ncell:A19:b::2:::l:3:f:7\\ncell:F19:b::1::\\ncell:G19:b::::1\\ncell:A20:b::2:::l:3:f:7\\ncell:F20:b::1::\\ncell:G20:b::::1\\ncell:A21:b::2:::l:3:f:7\\ncell:C21:t:Thank you for your business:b::1:::f:3:colspan:4\\ncell:D21:t:Thank you for your business:f:2:colspan:4\\ncell:E21:t::l:2:f:7\\ncell:F21:l:2:f:7\\ncell:G21:b::::1\\ncell:A22:b::2:::l:3:f:7\\ncell:F22:b::1::\\ncell:G22:b::::1\\ncell:A23:b::2:::l:3:f:7\\ncell:B23:b:::2::l:3:f:7\\ncell:C23:b:::2::l:3:f:7\\ncell:D23:b:::2::l:3:f:7\\ncell:E23:b:::2::l:3:f:7\\ncell:F23:b::1:1::l:3:f:7\\ncell:G23:b::::1\\ncell:B24:b:1:::\\ncell:C24:b:1:::\\ncell:D24:b:1:::\\ncell:E24:b:1:::\\ncell:F24:b:1:::\\ncol:A:w:10\\ncol:B:w:42\\ncol:C:w:56\\ncol:D:w:39\\ncol:E:w:48\\ncol:F:w:57\\nrow:1:h:14.25\\nrow:2:h:18.75\\nrow:3:h:14.25\\nrow:4:h:14.25\\nrow:5:h:14.25\\nrow:6:h:14.25\\nrow:7:h:14.25\\nrow:8:h:14.25\\nrow:9:h:14.25\\nrow:10:h:14.25\\nrow:11:h:14.25\\nrow:12:h:14.25\\nrow:13:h:14.25\\nrow:14:h:14.25\\nrow:15:h:14.25\\nrow:16:h:14.25\\nrow:17:h:14.25\\nrow:18:h:15.75\\nrow:19:h:14.25\\nrow:20:h:14.25\\nrow:21:h:14.25\\nrow:22:h:14.25\\nrow:23:h:14.25\\nsheet:c:7:r:24:h:12.75:needsrecalc:yes\\nborder:1:1px solid rgb(0,0,0)\\nborder:2:thin solid rgb(0,0,0)\\ncellformat:1:center\\ncellformat:2:left\\nfont:1:* * Trebuchet MS\\nfont:2:italic bold * Trebuchet MS\\nfont:3:italic bold 10pt Trebuchet MS\\nfont:4:normal bold 10pt Arial\\nfont:5:normal bold 12pt Arial\\nfont:6:normal normal * Trebuchet MS\\nfont:7:normal normal 10pt Arial\\nfont:8:normal normal 16pt Arial\\nlayout:1:padding:* * * *;vertical-align:bottom;\\nlayout:2:padding:* * * *;vertical-align:middle;\\nlayout:3:padding:* * * *;vertical-align:top;\\nvalueformat:1:#,##0.00\\n\"},\"name\":\"sheet7\",\"hidden\":\"0\"}},\"EditableCells\":{\"allow\":true,\"cells\":{\"inv1!B2\":true,\"inv1!C5\":true,\"inv1!C6\":true,\"inv1!C7\":true,\"inv1!C8\":true,\"inv1!C9\":true,\"inv1!C11\":true,\"inv1!C12\":true,\"inv1!C13\":true,\"inv1!C14\":true,\"inv1!C15\":true,\"inv1!C16\":true,\"inv1!C18\":true,\"inv1!C20\":true,\"inv1!D20\":true,\"inv1!C23\":true,\"inv1!C24\":true,\"inv1!C25\":true,\"inv1!C26\":true,\"inv1!C27\":true,\"inv1!C28\":true,\"inv1!C29\":true,\"inv1!C30\":true,\"inv1!C31\":true,\"inv1!C32\":true,\"inv1!C33\":true,\"inv1!C34\":true,\"inv1!C35\":true,\"inv1!F23\":true,\"inv1!F24\":true,\"inv1!F25\":true,\"inv1!F26\":true,\"inv1!F27\":true,\"inv1!F28\":true,\"inv1!F29\":true,\"inv1!F30\":true,\"inv1!F31\":true,\"inv1!F32\":true,\"inv1!F33\":true,\"inv1!F34\":true,\"inv1!F35\":true,\"inv2!B2\":true,\"inv2!F4\":true,\"inv2!G4\":true,\"inv2!B5\":true,\"inv2!B7\":true,\"inv2!B8\":true,\"inv2!B9\":true,\"inv2!B10\":true,\"inv2!B11\":true,\"inv2!B12\":true,\"inv2!B14\":true,\"inv2!B15\":true,\"inv2!B16\":true,\"inv2!B17\":true,\"inv2!B18\":true,\"inv2!B19\":true,\"inv2!B20\":true,\"inv2!B23\":true,\"inv2!B24\":true,\"inv2!B25\":true,\"inv2!B26\":true,\"inv2!B27\":true,\"inv2!B28\":true,\"inv2!B29\":true,\"inv2!B30\":true,\"inv2!B31\":true,\"inv2!B32\":true,\"inv2!B33\":true,\"inv2!B34\":true,\"inv2!B35\":true,\"inv2!G23\":true,\"inv2!G24\":true,\"inv2!G25\":true,\"inv2!G26\":true,\"inv2!G27\":true,\"inv2!G28\":true,\"inv2!G29\":true,\"inv2!G30\":true,\"inv2!G31\":true,\"inv2!G32\":true,\"inv2!G33\":true,\"inv2!G34\":true,\"inv2!G35\":true,\"inv2!B38\":true,\"inv2!B39\":true,\"inv2!B40\":true,\"inv2!F36\":true,\"inv2!G37\":true,\"inv2!F37\":true,\"inv2!F39\":true,\"inv2!G39\":true,\"inv2!F38\":true,\"sheet6!B2\":true,\"sheet6!F4\":true,\"sheet6!G4\":true,\"sheet6!B5\":true,\"sheet6!B7\":true,\"sheet6!B8\":true,\"sheet6!B9\":true,\"sheet6!B10\":true,\"sheet6!B11\":true,\"sheet6!B12\":true,\"sheet6!B14\":true,\"sheet6!B15\":true,\"sheet6!B16\":true,\"sheet6!B17\":true,\"sheet6!B18\":true,\"sheet6!B19\":true,\"sheet6!B20\":true,\"sheet6!B38\":true,\"sheet6!B39\":true,\"sheet6!B40\":true,\"sheet6!F36\":true,\"sheet6!G37\":true,\"sheet6!F37\":true,\"sheet6!F39\":true,\"sheet6!G39\":true,\"sheet6!F38\":true,\"inv3!B2\":true,\"inv3!B6\":true,\"inv3!B7\":true,\"inv3!B8\":true,\"inv3!B9\":true,\"inv3!B10\":true,\"inv3!B11\":true,\"inv3!B12\":true,\"inv3!B13\":true,\"inv3!B14\":true,\"inv3!B15\":true,\"inv3!B16\":true,\"inv3!B17\":true,\"inv3!B18\":true,\"inv3!E6\":true,\"inv3!E7\":true,\"inv3!E8\":true,\"inv3!E9\":true,\"inv3!E10\":true,\"inv3!E11\":true,\"inv3!E12\":true,\"inv3!E13\":true,\"inv3!E14\":true,\"inv3!E15\":true,\"inv3!E16\":true,\"inv3!E17\":true,\"inv3!E18\":true,\"inv3!F6\":true,\"inv3!F7\":true,\"inv3!F8\":true,\"inv3!F9\":true,\"inv3!F10\":true,\"inv3!F11\":true,\"inv3!F12\":true,\"inv3!F13\":true,\"inv3!F14\":true,\"inv3!F15\":true,\"inv3!F16\":true,\"inv3!F17\":true,\"inv3!F18\":true,\"sheet7!F6\":true,\"sheet7!F7\":true,\"sheet7!F8\":true,\"sheet7!F9\":true,\"sheet7!F10\":true,\"sheet7!F11\":true,\"sheet7!F12\":true,\"sheet7!F13\":true,\"sheet7!F14\":true,\"sheet7!F15\":true,\"sheet7!F16\":true,\"sheet7!F17\":true,\"sheet7!F18\":true,\"sheet7!E6\":true,\"sheet7!E7\":true,\"sheet7!E8\":true,\"sheet7!E9\":true,\"sheet7!E10\":true,\"sheet7!E11\":true,\"sheet7!E12\":true,\"sheet7!E13\":true,\"sheet7!E14\":true,\"sheet7!E15\":true,\"sheet7!E16\":true,\"sheet7!E17\":true,\"sheet7!E18\":true,\"sheet7!B6\":true,\"sheet7!B2\":true,\"sheet7!B7\":true,\"sheet7!B8\":true,\"sheet7!B9\":true,\"sheet7!B10\":true,\"sheet7!B11\":true,\"sheet7!B12\":true,\"sheet7!B13\":true,\"sheet7!B14\":true,\"sheet7!B15\":true,\"sheet7!B16\":true,\"sheet7!B17\":true,\"sheet7!B18\":true,\"inv1!D8\":true,\"inv1!D15\":true,\"inv1!D18\":true,\"inv2!C5\":true,\"sheet6!C5\":true},\"constraints\":{\"inv1!C5\":[\"prompttext\",\"0\",\"1e10\",\"Name\"],\"inv1!C6\":[\"prompttext\",\"0\",\"1e10\",\"Street Address\"],\"inv1!C7\":[\"prompttext\",\"0\",\"1e10\",\"City, State, Zip\"],\"inv1!C8\":[\"prompttext\",\"0\",\"1e10\",\"Phone\"],\"inv1!C9\":[\"promptemail\",\"0\",\"1e10\",\"Email\"],\"inv1!C11\":[\"prompttext\",\"0\",\"1e10\",\"From\"],\"inv1!C12\":[\"prompttext\",\"0\",\"1e10\",\"Name\"],\"inv1!C13\":[\"prompttext\",\"0\",\"1e10\",\"Street Address\"],\"inv1!C14\":[\"prompttext\",\"0\",\"1e10\",\"City, State, Zip\"],\"inv1!C15\":[\"prompttext\",\"0\",\"1e10\",\"Phone\"],\"inv1!C16\":[\"promptemail\",\"0\",\"1e10\",\"Email\"],\"inv1!C18\":[\"prompttext\",\"0\",\"1e10\",\"Invoice #\"],\"inv1!C20\":[\"prompttext\",\"0\",\"1e10\",\"Date\"],\"inv1!D20\":[\"prompttext\",\"0\",\"1e10\",\"Date\"],\"inv1!C23\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv1!C24\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv1!C25\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv1!C26\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv1!C27\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv1!C28\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv1!C29\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv1!C30\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv1!C31\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv1!C32\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv1!C33\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv1!C34\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv1!C35\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv1!F23\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv1!F24\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv1!F25\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv1!F26\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv1!F27\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv1!F28\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv1!F29\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv1!F30\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv1!F31\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv1!F32\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv1!F33\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv1!F34\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv1!F35\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv2!B2\":[\"prompttext\",\"0\",\"1e10\",\"Invoice\"],\"inv2!F4\":[\"prompttext\",\"0\",\"1e10\",\"Date\"],\"inv2!G4\":[\"prompttext\",\"0\",\"1e10\",\"Date\"],\"inv2!B5\":[\"prompttext\",\"0\",\"1e10\",\"Invoice #\"],\"inv2!B7\":[\"prompttext\",\"0\",\"1e10\",\"From\"],\"inv2!B8\":[\"prompttext\",\"0\",\"1e10\",\"Company Name\"],\"inv2!B9\":[\"prompttext\",\"0\",\"1e10\",\"Street Address\"],\"inv2!B10\":[\"prompttext\",\"0\",\"1e10\",\"City, State, Zip\"],\"inv2!B11\":[\"prompttext\",\"0\",\"1e10\",\"Phone\"],\"inv2!B12\":[\"promptemail\",\"0\",\"1e10\",\"Email\"],\"inv2!B14\":[\"prompttext\",\"0\",\"1e10\",\"Bill To\"],\"inv2!B15\":[\"prompttext\",\"0\",\"1e10\",\"Name\"],\"inv2!B16\":[\"prompttext\",\"0\",\"1e10\",\"Company Name\"],\"inv2!B17\":[\"prompttext\",\"0\",\"1e10\",\"Street Address\"],\"inv2!B18\":[\"prompttext\",\"0\",\"1e10\",\"City, State, Zip\"],\"inv2!B19\":[\"prompttext\",\"0\",\"1e10\",\"Phone\"],\"inv2!B20\":[\"promptemail\",\"0\",\"1e10\",\"Email\"],\"inv2!B23\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv2!B24\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv2!B25\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv2!B26\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv2!B27\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv2!B28\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv2!B29\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv2!B30\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv2!B31\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv2!B32\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv2!B33\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv2!B34\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv2!B35\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv2!G23\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv2!G24\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv2!G25\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv2!G26\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv2!G27\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv2!G28\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv2!G29\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv2!G30\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv2!G31\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv2!G32\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv2!G33\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv2!G34\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv2!G35\":[\"promptdecimal\",\"0\",\"1e10\",\"Amount\"],\"inv2!B38\":[\"prompttext\",\"0\",\"1e10\",\"Notes\"],\"inv2!B39\":[\"prompttext\",\"0\",\"1e10\",\"Notes\"],\"inv2!B40\":[\"prompttext\",\"0\",\"1e10\",\"Notes\"],\"inv2!F36\":[\"prompttext\",\"0\",\"1e10\",\"Subtotal\"],\"inv2!G37\":[\"promptdecimal\",\"0\",\"1e10\",\"Tax Rate (0.00)\"],\"inv2!F37\":[\"prompttext\",\"0\",\"1e10\",\"Tax Rate\"],\"inv2!F39\":[\"prompttext\",\"0\",\"1e10\",\"Other\"],\"inv2!G39\":[\"promptdecimal\",\"0\",\"1e10\",\"Other\"],\"inv2!F38\":[\"prompttext\",\"0\",\"1e10\",\"Tax\"],\"sheet6!B2\":[\"prompttext\",\"0\",\"1e10\",\"Invoice\"],\"sheet6!F4\":[\"prompttext\",\"0\",\"1e10\",\"Date\"],\"sheet6!G4\":[\"prompttext\",\"0\",\"1e10\",\"Date\"],\"sheet6!B5\":[\"prompttext\",\"0\",\"1e10\",\"Invoice #\"],\"sheet6!B7\":[\"prompttext\",\"0\",\"1e10\",\"From\"],\"sheet6!B8\":[\"prompttext\",\"0\",\"1e10\",\"Company Name\"],\"sheet6!B9\":[\"prompttext\",\"0\",\"1e10\",\"Street Address\"],\"sheet6!B10\":[\"prompttext\",\"0\",\"1e10\",\"City, State, Zip\"],\"sheet6!B11\":[\"prompttext\",\"0\",\"1e10\",\"Phone\"],\"sheet6!B12\":[\"promptemail\",\"0\",\"1e10\",\"Email\"],\"sheet6!B14\":[\"prompttext\",\"0\",\"1e10\",\"Bill To\"],\"sheet6!B15\":[\"prompttext\",\"0\",\"1e10\",\"Name\"],\"sheet6!B16\":[\"prompttext\",\"0\",\"1e10\",\"Company Name\"],\"sheet6!B17\":[\"prompttext\",\"0\",\"1e10\",\"Street Address\"],\"sheet6!B18\":[\"prompttext\",\"0\",\"1e10\",\"City, State, Zip\"],\"sheet6!B19\":[\"prompttext\",\"0\",\"1e10\",\"Phone\"],\"sheet6!B20\":[\"promptemail\",\"0\",\"1e10\",\"Email\"],\"sheet6!B38\":[\"prompttext\",\"0\",\"1e10\",\"Notes\"],\"sheet6!B39\":[\"prompttext\",\"0\",\"1e10\",\"Notes\"],\"sheet6!B40\":[\"prompttext\",\"0\",\"1e10\",\"Notes\"],\"sheet6!F36\":[\"prompttext\",\"0\",\"1e10\",\"Subtotal\"],\"sheet6!G37\":[\"promptdecimal\",\"0\",\"1e10\",\"Tax Rate (0.00)\"],\"sheet6!F37\":[\"prompttext\",\"0\",\"1e10\",\"Tax Rate\"],\"sheet6!F39\":[\"prompttext\",\"0\",\"1e10\",\"Other\"],\"sheet6!G39\":[\"promptdecimal\",\"0\",\"1e10\",\"Other\"],\"sheet6!F38\":[\"prompttext\",\"0\",\"1e10\",\"Tax\"],\"inv3!B6\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv3!B7\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv3!B8\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv3!B9\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv3!B10\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv3!B11\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv3!B12\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv3!B13\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv3!B14\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv3!B15\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv3!B16\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv3!B17\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv3!B18\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"sheet7!B6\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"sheet7!B7\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"sheet7!B8\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"sheet7!B9\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"sheet7!B10\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"sheet7!B11\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"sheet7!B12\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"sheet7!B13\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"sheet7!B14\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"sheet7!B15\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"sheet7!B16\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"sheet7!B17\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"sheet7!B18\":[\"prompttext\",\"0\",\"1e10\",\"Description\"],\"inv1!D8\":[\"prompttext\",\"0\",\"1e10\",\"Phone\"],\"inv1!D15\":[\"prompttext\",\"0\",\"1e10\",\"Phone\"],\"inv1!D18\":[\"promptnumeric\",\"0\",\"1e10\",\"Invoice#\"],\"inv2!C5\":[\"promptnumeric\",\"0\",\"1e10\",\"Invoice#\"],\"sheet6!C5\":[\"promptnumeric\",\"0\",\"1e10\",\"Invoice#\"],\"sheet7!E6\":[\"promptdecimal\",\"0\",\"1e10\",\"Quantity\"],\"sheet7!E7\":[\"promptdecimal\",\"0\",\"1e10\",\"Quantity\"],\"sheet7!E8\":[\"promptdecimal\",\"0\",\"1e10\",\"Quantity\"],\"sheet7!E9\":[\"promptdecimal\",\"0\",\"1e10\",\"Quantity\"],\"sheet7!E10\":[\"promptdecimal\",\"0\",\"1e10\",\"Quantity\"],\"sheet7!E11\":[\"promptdecimal\",\"0\",\"1e10\",\"Quantity\"],\"sheet7!E12\":[\"promptdecimal\",\"0\",\"1e10\",\"Quantity\"],\"sheet7!E13\":[\"promptdecimal\",\"0\",\"1e10\",\"Quantity\"],\"sheet7!E14\":[\"promptdecimal\",\"0\",\"1e10\",\"Quantity\"],\"sheet7!E15\":[\"promptdecimal\",\"0\",\"1e10\",\"Quantity\"],\"sheet7!E16\":[\"promptdecimal\",\"0\",\"1e10\",\"Quantity\"],\"sheet7!E17\":[\"promptdecimal\",\"0\",\"1e10\",\"Quantity\"],\"sheet7!E18\":[\"promptdecimal\",\"0\",\"1e10\",\"Quantity\"],\"sheet7!F6\":[\"promptdecimal\",\"0\",\"1e10\",\"Price\"],\"sheet7!F7\":[\"promptdecimal\",\"0\",\"1e10\",\"Price\"],\"sheet7!F8\":[\"promptdecimal\",\"0\",\"1e10\",\"Price\"],\"sheet7!F9\":[\"promptdecimal\",\"0\",\"1e10\",\"Price\"],\"sheet7!F10\":[\"promptdecimal\",\"0\",\"1e10\",\"Price\"],\"sheet7!F11\":[\"promptdecimal\",\"0\",\"1e10\",\"Price\"],\"sheet7!F12\":[\"promptdecimal\",\"0\",\"1e10\",\"Price\"],\"sheet7!F13\":[\"promptdecimal\",\"0\",\"1e10\",\"Price\"],\"sheet7!F14\":[\"promptdecimal\",\"0\",\"1e10\",\"Price\"],\"sheet7!F15\":[\"promptdecimal\",\"0\",\"1e10\",\"Price\"],\"sheet7!F16\":[\"promptdecimal\",\"0\",\"1e10\",\"Price\"],\"sheet7!F17\":[\"promptdecimal\",\"0\",\"1e10\",\"Price\"],\"sheet7!F18\":[\"promptdecimal\",\"0\",\"1e10\",\"Price\"],\"inv3!E6\":[\"promptdecimal\",\"0\",\"1e10\",\"Hours\"],\"inv3!E7\":[\"promptdecimal\",\"0\",\"1e10\",\"Hours\"],\"inv3!E8\":[\"promptdecimal\",\"0\",\"1e10\",\"Hours\"],\"inv3!E9\":[\"promptdecimal\",\"0\",\"1e10\",\"Hours\"],\"inv3!E10\":[\"promptdecimal\",\"0\",\"1e10\",\"Hours\"],\"inv3!E11\":[\"promptdecimal\",\"0\",\"1e10\",\"Hours\"],\"inv3!E12\":[\"promptdecimal\",\"0\",\"1e10\",\"Hours\"],\"inv3!E13\":[\"promptdecimal\",\"0\",\"1e10\",\"Hours\"],\"inv3!E14\":[\"promptdecimal\",\"0\",\"1e10\",\"Hours\"],\"inv3!E15\":[\"promptdecimal\",\"0\",\"1e10\",\"Hours\"],\"inv3!E16\":[\"promptdecimal\",\"0\",\"1e10\",\"Hours\"],\"inv3!E17\":[\"promptdecimal\",\"0\",\"1e10\",\"Hours\"],\"inv3!E18\":[\"promptdecimal\",\"0\",\"1e10\",\"Hours\"],\"inv3!F6\":[\"promptdecimal\",\"0\",\"1e10\",\"Rate\"],\"inv3!F7\":[\"promptdecimal\",\"0\",\"1e10\",\"Rate\"],\"inv3!F8\":[\"promptdecimal\",\"0\",\"1e10\",\"Rate\"],\"inv3!F9\":[\"promptdecimal\",\"0\",\"1e10\",\"Rate\"],\"inv3!F10\":[\"promptdecimal\",\"0\",\"1e10\",\"Rate\"],\"inv3!F11\":[\"promptdecimal\",\"0\",\"1e10\",\"Rate\"],\"inv3!F12\":[\"promptdecimal\",\"0\",\"1e10\",\"Rate\"],\"inv3!F13\":[\"promptdecimal\",\"0\",\"1e10\",\"Rate\"],\"inv3!F14\":[\"promptdecimal\",\"0\",\"1e10\",\"Rate\"],\"inv3!F15\":[\"promptdecimal\",\"0\",\"1e10\",\"Rate\"],\"inv3!F16\":[\"promptdecimal\",\"0\",\"1e10\",\"Rate\"],\"inv3!F17\":[\"promptdecimal\",\"0\",\"1e10\",\"Rate\"],\"inv3!F18\":[\"promptdecimal\",\"0\",\"1e10\",\"Rate\"]}}},\n        \t\"footers\": [{name: 'Type1' , index: 1, isActive: true }, {name: 'Type2' , index: 2, isActive: false}, \n                        {name: 'Type3' , index: 3, isActive: false}, {name: 'Detail1' , index: 4, isActive: false}, \n                        {name: 'Detail2' , index: 5, isActive: false}]\n        }\n    }\n};\n\n\n// WEBPACK FOOTER //\n// ./src/app-data.js","var SocialCalc = require(\"./aspiring/SocialCalc.js\");\n\nexport function getDeviceType(){\n\t/* Returns the type of the device */\n    var device = \"default\";\n    if (navigator.userAgent.match(/iPod/)) device = \"iPod\";\n    if (navigator.userAgent.match(/iPad/)) device = \"iPad\";\n    if (navigator.userAgent.match(/iPhone/)) device = \"iPhone\";\n    console.log(\"Device is: \"+device);\n    return device;\n}\n\nexport function initializeApp(data) {\n\t/* Initializes the spreadsheet */\n    \n    let tableeditor = document.getElementById(\"tableeditor\");\n\tlet spreadsheet = new SocialCalc.SpreadsheetControl();\n    let workbook = new SocialCalc.WorkBook(spreadsheet);\n    workbook.InitializeWorkBook(\"sheet1\");\n    \n    spreadsheet.InitializeSpreadsheetControl(tableeditor, 0, 0, 0);\n    spreadsheet.ExecuteCommand('redisplay', '');\n    \n    let workbookcontrol = new SocialCalc.WorkBookControl(workbook,\"workbookControl\",\"sheet1\");\n    workbookcontrol.InitializeWorkBookControl();\n    // alert(\"app: \"+JSON.stringify(data));\n    SocialCalc.WorkBookControlLoad(data);\n    let ele = document.getElementById('te_griddiv');\n    ele.style.height= \"1600px\";\n    spreadsheet.DoOnResize();\n   \n}\n\nexport function activateFooterButton(index){\n\t/* Activates the sheet according to the index*/\n    if (index === SocialCalc.oldBtnActive) return;\n    var control = SocialCalc.GetCurrentWorkBookControl();\n    \n    var sheets = [];\n    for (var key in control.sheetButtonArr) {\n        //console.log(key);\n        sheets.push(key);\n    }\n    var spreadsheet = control.workbook.spreadsheet;\n    var ele = document.getElementById(spreadsheet.formulabarDiv.id);\n    if (ele) {\n        SocialCalc.ToggleInputLineButtons(false);\n        var input = ele.firstChild;\n        input.style.display=\"none\";\n        spreadsheet.editor.state = \"start\";\n    }\n    SocialCalc.WorkBookControlActivateSheet(sheets[index-1]);\n    \n    SocialCalc.oldBtnActive = index;\n}\n\nexport function viewFile(filename, data){\n\n    SocialCalc.WorkBookControlInsertWorkbook(data);\n\n    SocialCalc.GetCurrentWorkBookControl().workbook.spreadsheet.editor.state = \"start\";\n    \n    SocialCalc.GetCurrentWorkBookControl().workbook.spreadsheet.ExecuteCommand('redisplay', '');\n    \n    window.setTimeout(function() {\n                      SocialCalc.ScrollRelativeBoth(SocialCalc.GetCurrentWorkBookControl().workbook.spreadsheet.editor, 1, 0);\n                      SocialCalc.ScrollRelativeBoth(SocialCalc.GetCurrentWorkBookControl().workbook.spreadsheet.editor, -1, 0);\n                      },1000);\n}\n\nexport function getCSVContent(){\n    var val = SocialCalc.WorkBookControlSaveSheet();\n    var workBookObject = JSON.parse(val);\n    var control = SocialCalc.GetCurrentWorkBookControl();\n    var currentname = control.currentSheetButton.id; \n    var savestrr = workBookObject.sheetArr[currentname].sheetstr.savestr;\n    var res = SocialCalc.ConvertSaveToOtherFormat(savestrr, \"csv\", false);\n    return res;\n}\n\nexport function mustshowprompt(coord){\n    var control = SocialCalc.GetCurrentWorkBookControl();\n    var editor = control.workbook.spreadsheet.editor;\n    var cellname = editor.workingvalues.currentsheet+\"!\"+editor.ecell.coord;\n    var constraint = SocialCalc.EditableCells.constraints[cellname];\n    if (constraint)\n    {\n        \n    }\n    // for phone apps always show prompt\n    return true;\n}\n\nexport function getinputtype(coord){\n    var control = SocialCalc.GetCurrentWorkBookControl();\n    var editor = control.workbook.spreadsheet.editor;\n    var cellname = editor.workingvalues.currentsheet+\"!\"+editor.ecell.coord;\n    var constraint = SocialCalc.EditableCells.constraints[cellname];\n    if (constraint){\n       \n    }\n    return null;\n}\n\nexport function prompttype(coord){\n    var control = SocialCalc.GetCurrentWorkBookControl();\n    var editor = control.workbook.spreadsheet.editor;\n    var cellname = editor.workingvalues.currentsheet+\"!\"+editor.ecell.coord;\n    var constraint = SocialCalc.EditableCells.constraints[cellname];\n    \n    if (constraint)\n    {\n        \n    }\n    return null;\n}\n\nexport function showprompt(coord) {\n    \n    var control = SocialCalc.GetCurrentWorkBookControl();\n    var editor = control.workbook.spreadsheet.editor;\n    var cellname = editor.workingvalues.currentsheet+\"!\"+editor.ecell.coord;\n    var constraint = SocialCalc.EditableCells.constraints[cellname];\n    var highlights = editor.context.highlights;\n    \n    //alert(constraint);\n    var wval = editor.workingvalues;\n    if (wval.eccord) {\n        wval.ecoord = null;\n        console.log(\"return due to ecoord\")\n        return;\n    }\n    wval.ecoord = coord;\n    if (!coord) coord = editor.ecell.coord;\n    var text = SocialCalc.GetCellContents(editor.context.sheetobj, coord);\n    console.log(\"in prompt, coord = \"+coord+\" text=\"+text);\n    \n    if (SocialCalc.Constants.SCNoQuoteInInputBox && (text.substring(0,1) === \"'\")) {\n        text = text.substring(1);\n    }\n    console.log(\"continue...\")\n    \n    var cell=SocialCalc.GetEditorCellElement(editor, editor.ecell.row, editor.ecell.col);\n    //alert(cell);\n    \n    /*var cancelfn = function() {\n        wval.ecoord = null;\n        delete highlights[editor.ecell.coord];\n        editor.UpdateCellCSS(cell, editor.ecell.row, editor.ecell.col);\n        \n    };*/\n    \n    var okfn = function(val) {\n        var callbackfn = function() {\n            console.log(\"callback val \"+val)\n            SocialCalc.EditorSaveEdit(editor, val);\n        };\n        window.setTimeout(callbackfn, 100);\n    };\n    \n    // highlight the cell\n    delete highlights[editor.ecell.coord];\n    highlights[editor.ecell.coord] = \"cursor\";\n    editor.UpdateCellCSS(cell, editor.ecell.row, editor.ecell.col);\n    \n    \n    var celltext = \"Enter Value\";\n    var title = \"Input\";\n    if (constraint)\n    {\n        \n    } else {\n        console.log(\"cell text is null\")\n    }\n    \n    var options = {title: title};\n    \n    options[\"message\"] = celltext;\n    console.log(\"text is \"+text);\n    options[\"textvalue\"] = text;\n    \n    function onPrompt(results) {\n        if(results.buttonIndex === 3) return;\n\n        else if(results.buttonIndex === 2){\n            var onConfirm = function(buttonIndex){\n                console.log(buttonIndex);\n                switch(buttonIndex){\n                    case 1: //do nothing \n                        break;\n                    case 2:\n                        var onFontConfirm = function(fontIndex){\n                            switch(fontIndex){\n                                case 1: //do nothing \n                                    break;\n                                case 2:\n                                    SocialCalc.EditorChangefontFromWidget(editor,\"a\");\n                                    break;\n                                case 3:\n                                    SocialCalc.EditorChangefontFromWidget(editor,\"b\");\n                                    break;\n                                case 4:\n                                    SocialCalc.EditorChangefontFromWidget(editor,\"c\");\n                                    break;\n                                case 5:\n                                    SocialCalc.EditorChangefontFromWidget(editor,\"d\");\n                                    break;\n                                default:\n                                    break;\n                            }\n                        }\n\n                        navigator.notification.confirm(\n                            'Customise cell options', // message\n                            onFontConfirm,            // callback to invoke with index of button pressed\n                            'Customise',           // title\n                            ['Cancel', 'Small:8pt','Medium:12pt','Big:14pt','Large:16pt']      // buttonLabels\n                        );\n                        break;\n                    case 3:\n                        var onColorConfirm = function(colorIndex){\n                            switch(colorIndex){\n                                case 1: //do nothing \n                                    break;\n                                case 2:\n                                    SocialCalc.EditorChangecolorFromWidget(editor,\"red\");\n                                    break;\n                                case 3:\n                                    SocialCalc.EditorChangecolorFromWidget(editor,\"yellow\");\n                                    break;\n                                case 4:\n                                    SocialCalc.EditorChangecolorFromWidget(editor,\"blue\");\n                                    break;\n                                case 5:\n                                    SocialCalc.EditorChangecolorFromWidget(editor,\"green\");\n                                    break;\n                                case 6:\n                                    SocialCalc.EditorChangecolorFromWidget(editor,\"purple\");\n                                    break;\n                                case 7:\n                                    SocialCalc.EditorChangecolorFromWidget(editor,\"black\");\n                                    break;\n                                default:\n                                    break;\n                            }\n                        }\n\n                        navigator.notification.confirm(\n                            'Customise cell options', // message\n                            onColorConfirm,            // callback to invoke with index of button pressed\n                            'Customise',           // title\n                            ['Cancel', 'Red','Yellow','Blue','Green','Purple','Black']      // buttonLabels\n                        );\n                        break;\n                    case 4:\n                        editor.context.sheetobj.SheetUndo();\n                        break;\n                    case 5:\n                        editor.context.sheetobj.SheetRedo();\n                        break;\n                    case 6:\n                        SocialCalc.EditorCut(editor, 'a');\n                        break;\n                    case 7:\n                        SocialCalc.EditorCut(editor, 'b');\n                        break;\n                    case 8:\n                        SocialCalc.EditorCut(editor, 'c');\n                        break;\n                    case 9:\n                        SocialCalc.EditorCut(editor, 'd');\n                        break;\n                    default:\n                        break;\n                }\n            };\n            navigator.notification.confirm(\n                                   'Customise cell options', // message\n                                   onConfirm,            // callback to invoke with index of button pressed\n                                   'Customise',           // title\n                                   [\"Cancel\", \"Font\", \"Color\", \"Undo\", \"Redo\", \"Cut\",\"Copy\",\"Paste\",\"Clear\"]      // buttonLabels\n                                   );\n        }\n        else if(results.buttonIndex === 1){\n            okfn(results.input1);\n        }\n    }\n    \n    navigator.notification.prompt(\n                                  'Enter value',  // message\n                                  onPrompt,                  // callback to invoke\n                                  'Input',            // title\n                                  ['Ok','Customise','Cancel'],             // buttonLabels\n                                  ''+text+''              // defaultText\n                                  );\n         \n    \n    return true;\n}\n\nexport function getSpreadsheetContent(){\n    return SocialCalc.WorkBookControlSaveSheet();\n}\n\nexport function getCurrentHTMLContent(){\n    var control = SocialCalc.GetCurrentWorkBookControl();\n    return control.workbook.spreadsheet.CreateSheetHTML();\n}\n\nexport function getAllHTMLContent(sheetdata){\n    var appsheets = {};\n    // var control = SocialCalc.GetCurrentWorkBookControl();\n    \n    for(var i=1; i<= sheetdata.numsheets;i++){\n        var key = \"sheet\"+i;\n        appsheets[key] = key;\n    }\n    \n    return SocialCalc.WorkbookControlCreateSheetHTML(appsheets);\n}\n\nexport function saveAs(){\n    return new Promise(function(resolve, reject){\n        \n        navigator.notification.prompt(\n            'Please enter the filename',  // message\n            function(results){\n                if(results.buttonIndex === 2){\n                    resolve(results.input1);\n                }\n            },                  // callback to invoke\n            'Save as',            // title\n            ['Cancel','Save'],             // buttonLabels\n            ''                 // defaultText\n        );\n    });\n}\n\nexport function getAllOldFiles() {\n    return new Promise(function(resolve, reject){\n        var files = {};\n\n        for (var i=0; i < window.localStorage.length; i++) {\n            if(window.localStorage.key(i).length >=30) continue;\n            var filename = window.localStorage.key(i);\n            \n            if(filename === \"logoArray\") continue;\n            if(filename === \"inapp\") continue;\n            if(filename === \"sound\") continue;\n            if(filename === \"cloudInapp\") continue;\n            if(filename === \"inapplocal\") continue;\n            if(filename === \"inappPurchase\") continue;\n            if(filename === \"flag\") continue;\n            if(filename === \"share\") continue;\n            if(filename === \"cellArray\") continue;\n            if(filename === \"sk_receiptForProduct\") continue;\n            if(filename === \"sk_receiptForTransaction\") continue;\n            if(filename === \"didTutorial\" || filename === \"customise\" || filename === \"rename\" || filename === \"choice\") continue;\n            /// console.log(filename);\n            var filedata = decodeURIComponent(window.localStorage.getItem(filename));\n\n            files[filename]= filedata;\n\n        }\n        // console.log(files);\n        resolve(files);\n    });\n}\n\nexport function deleteAllOldFiles(files){\n    return new Promise(function(resolve, reject){\n        for(var i in files){\n            console.log(\"Removing..\"+i);\n            window.localStorage.removeItem(i);\n        }\n        resolve(true);\n    });\n}\n\nexport function addLogo(coord, url){\n    return new Promise(function(resolve, reject){\n        console.log(url);\n\n        var control = SocialCalc.GetCurrentWorkBookControl();\n        var currsheet = control.currentSheetButton.id;\n        // var editor = control.workbook.spreadsheet.editor;\n\n        var cmd = '';\n        for(var sheetname in coord){\n            if(coord[sheetname] !== null){\n                if(currsheet === sheetname){\n                    console.log(sheetname+\" ,\"+coord[sheetname]);// eslint-disable-next-line\n                    cmd = 'set '+coord[sheetname]+' text t <img src=\"'+url+'\" height=\"100\" width=\"150\"></img>'+\"\\n\";\n                    cmd = {cmdtype:\"scmd\", id:currsheet, cmdstr: cmd, saveundo: false};\n                    control.ExecuteWorkBookControlCommand(cmd, false);\n                }\n            }\n        }\n        resolve(true);\n    });\n}\n\nexport function removeLogo(coord){\n    return new Promise(function(resolve, reject){\n        var control = SocialCalc.GetCurrentWorkBookControl();\n        var currsheet = control.currentSheetButton.id;\n        // var editor = control.workbook.spreadsheet.editor;\n\n        var cmd = '';\n        for(var sheetname in coord){\n            if(coord[sheetname] !== null){\n                if(currsheet === sheetname){\n                    console.log(sheetname+\" ,\"+coord[sheetname]);\n                    cmd = 'erase '+coord[sheetname]+' formulas';\n                    cmd = {cmdtype:\"scmd\", id:currsheet, cmdstr: cmd, saveundo: false};\n                    control.ExecuteWorkBookControlCommand(cmd, false);\n                }\n            }\n        }\n        resolve(true);\n    });\n}\n\n\nexport function undo(){\n    var control = SocialCalc.GetCurrentWorkBookControl();\n    //alert('control are'+control);\n    var editor = control.workbook.spreadsheet.editor;\n    editor.context.sheetobj.SheetUndo();\n}\n\nexport function redo(){\n    var control = SocialCalc.GetCurrentWorkBookControl();\n    //alert('control are'+control);\n    var editor = control.workbook.spreadsheet.editor;\n    editor.context.sheetobj.SheetRedo();\n}\n\nexport function getCurrentSheet(){\n    return SocialCalc.GetCurrentWorkBookControl().currentSheetButton.id;\n}\n\nexport function changeSheetColor(name){\n    var control = SocialCalc.GetCurrentWorkBookControl();\n    var editor = control.workbook.spreadsheet.editor;\n    \n    name = name.toLowerCase();\n    //console.log(\"changing sheet color to: \"+name);\n    SocialCalc.EditorChangeSheetcolor(editor, name);\n   \n}\n\nexport function changeFontSheet(cmdline){\n    var control = SocialCalc.GetCurrentWorkBookControl();\n    //alert('control are'+control);\n    var editor = control.workbook.spreadsheet.editor;\n    editor.EditorScheduleSheetCommands(cmdline, true, false);\n}\n\nexport function executeCommand(cmdline) {\n    var control = SocialCalc.GetCurrentWorkBookControl();\n    //alert('control are'+control);\n    var editor = control.workbook.spreadsheet.editor;\n    editor.EditorScheduleSheetCommands(cmdline, true, false);\n}\n\n\n// WEBPACK FOOTER //\n// ./src/socialcalc/AppGeneral.js","/*\nobject-assign\n(c) Sindre Sorhus\n@license MIT\n*/\n\n'use strict';\n/* eslint-disable no-unused-vars */\nvar getOwnPropertySymbols = Object.getOwnPropertySymbols;\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\nvar propIsEnumerable = Object.prototype.propertyIsEnumerable;\n\nfunction toObject(val) {\n\tif (val === null || val === undefined) {\n\t\tthrow new TypeError('Object.assign cannot be called with null or undefined');\n\t}\n\n\treturn Object(val);\n}\n\nfunction shouldUseNative() {\n\ttry {\n\t\tif (!Object.assign) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Detect buggy property enumeration order in older V8 versions.\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=4118\n\t\tvar test1 = new String('abc');  // eslint-disable-line no-new-wrappers\n\t\ttest1[5] = 'de';\n\t\tif (Object.getOwnPropertyNames(test1)[0] === '5') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test2 = {};\n\t\tfor (var i = 0; i < 10; i++) {\n\t\t\ttest2['_' + String.fromCharCode(i)] = i;\n\t\t}\n\t\tvar order2 = Object.getOwnPropertyNames(test2).map(function (n) {\n\t\t\treturn test2[n];\n\t\t});\n\t\tif (order2.join('') !== '0123456789') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test3 = {};\n\t\t'abcdefghijklmnopqrst'.split('').forEach(function (letter) {\n\t\t\ttest3[letter] = letter;\n\t\t});\n\t\tif (Object.keys(Object.assign({}, test3)).join('') !==\n\t\t\t\t'abcdefghijklmnopqrst') {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t} catch (err) {\n\t\t// We don't expect any of the above to throw, but better to be safe.\n\t\treturn false;\n\t}\n}\n\nmodule.exports = shouldUseNative() ? Object.assign : function (target, source) {\n\tvar from;\n\tvar to = toObject(target);\n\tvar symbols;\n\n\tfor (var s = 1; s < arguments.length; s++) {\n\t\tfrom = Object(arguments[s]);\n\n\t\tfor (var key in from) {\n\t\t\tif (hasOwnProperty.call(from, key)) {\n\t\t\t\tto[key] = from[key];\n\t\t\t}\n\t\t}\n\n\t\tif (getOwnPropertySymbols) {\n\t\t\tsymbols = getOwnPropertySymbols(from);\n\t\t\tfor (var i = 0; i < symbols.length; i++) {\n\t\t\t\tif (propIsEnumerable.call(from, symbols[i])) {\n\t\t\t\t\tto[symbols[i]] = from[symbols[i]];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn to;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/object-assign/index.js\n// module id = 4\n// module chunks = 0","const storage = window.localStorage;\n\nexport class File{\n\t\n\tcreated: string;\n\tmodified: string;\n\tname: string\n\tcontent: string;\n\tpassword: string;\n\n\tconstructor(created: string, modified: string, content: string, name: string, password ?: string ){\n\t\tthis.created = created;\n\t\tthis.modified = modified;\n\t\tthis.content = content;\n\t\tthis.name = name;\n\t\tthis.password = password;\n\t}\n\n}\n\nexport class Local {\n\n\tconstructor(){\n\t\tthis.storage = storage;\n\t\tthis.token = null;\n\t}\n\n\t_saveFile(file: File){\n\t\t// console.log(file.password);\n\t\tlet data = {created: file.created, modified: file.modified, content: file.content, password: file.password};\n\t\tthis.storage.setItem(file.name, JSON.stringify(data));\n\t}\n\n\t_getFile(name){\n\t\tconst rawData = this.storage.getItem(name);\n    \treturn JSON.parse(rawData);\n\t}\n\n\t_getAllFiles(){\n\t\tlet arr = {};\n\t\tfor(let i = 0; i< window.localStorage.length; i++){\n\t\t\tvar fname = window.localStorage.key(i);\n    \t\t// console.log(fname);\n    \t\tconst data = this._getFile(fname);\n    \t\tarr[fname] = data.modified;\n\t\t}\n\t\treturn arr;\n\t}\n\n\t_deleteFile(name){\n\t\tconsole.log(\"deleting file \"+name);\n\t\tthis.storage.removeItem(name);\n\t}\n\n}\n\n\n// WEBPACK FOOTER //\n// ./src/storage/LocalStorage.js","'use strict';\n\nvar asap = require('asap/raw');\n\nfunction noop() {}\n\n// States:\n//\n// 0 - pending\n// 1 - fulfilled with _value\n// 2 - rejected with _value\n// 3 - adopted the state of another promise, _value\n//\n// once the state is no longer pending (0) it is immutable\n\n// All `_` prefixed properties will be reduced to `_{random number}`\n// at build time to obfuscate them and discourage their use.\n// We don't use symbols or Object.defineProperty to fully hide them\n// because the performance isn't good enough.\n\n\n// to avoid using try/catch inside critical functions, we\n// extract them to here.\nvar LAST_ERROR = null;\nvar IS_ERROR = {};\nfunction getThen(obj) {\n  try {\n    return obj.then;\n  } catch (ex) {\n    LAST_ERROR = ex;\n    return IS_ERROR;\n  }\n}\n\nfunction tryCallOne(fn, a) {\n  try {\n    return fn(a);\n  } catch (ex) {\n    LAST_ERROR = ex;\n    return IS_ERROR;\n  }\n}\nfunction tryCallTwo(fn, a, b) {\n  try {\n    fn(a, b);\n  } catch (ex) {\n    LAST_ERROR = ex;\n    return IS_ERROR;\n  }\n}\n\nmodule.exports = Promise;\n\nfunction Promise(fn) {\n  if (typeof this !== 'object') {\n    throw new TypeError('Promises must be constructed via new');\n  }\n  if (typeof fn !== 'function') {\n    throw new TypeError('not a function');\n  }\n  this._45 = 0;\n  this._81 = 0;\n  this._65 = null;\n  this._54 = null;\n  if (fn === noop) return;\n  doResolve(fn, this);\n}\nPromise._10 = null;\nPromise._97 = null;\nPromise._61 = noop;\n\nPromise.prototype.then = function(onFulfilled, onRejected) {\n  if (this.constructor !== Promise) {\n    return safeThen(this, onFulfilled, onRejected);\n  }\n  var res = new Promise(noop);\n  handle(this, new Handler(onFulfilled, onRejected, res));\n  return res;\n};\n\nfunction safeThen(self, onFulfilled, onRejected) {\n  return new self.constructor(function (resolve, reject) {\n    var res = new Promise(noop);\n    res.then(resolve, reject);\n    handle(self, new Handler(onFulfilled, onRejected, res));\n  });\n};\nfunction handle(self, deferred) {\n  while (self._81 === 3) {\n    self = self._65;\n  }\n  if (Promise._10) {\n    Promise._10(self);\n  }\n  if (self._81 === 0) {\n    if (self._45 === 0) {\n      self._45 = 1;\n      self._54 = deferred;\n      return;\n    }\n    if (self._45 === 1) {\n      self._45 = 2;\n      self._54 = [self._54, deferred];\n      return;\n    }\n    self._54.push(deferred);\n    return;\n  }\n  handleResolved(self, deferred);\n}\n\nfunction handleResolved(self, deferred) {\n  asap(function() {\n    var cb = self._81 === 1 ? deferred.onFulfilled : deferred.onRejected;\n    if (cb === null) {\n      if (self._81 === 1) {\n        resolve(deferred.promise, self._65);\n      } else {\n        reject(deferred.promise, self._65);\n      }\n      return;\n    }\n    var ret = tryCallOne(cb, self._65);\n    if (ret === IS_ERROR) {\n      reject(deferred.promise, LAST_ERROR);\n    } else {\n      resolve(deferred.promise, ret);\n    }\n  });\n}\nfunction resolve(self, newValue) {\n  // Promise Resolution Procedure: https://github.com/promises-aplus/promises-spec#the-promise-resolution-procedure\n  if (newValue === self) {\n    return reject(\n      self,\n      new TypeError('A promise cannot be resolved with itself.')\n    );\n  }\n  if (\n    newValue &&\n    (typeof newValue === 'object' || typeof newValue === 'function')\n  ) {\n    var then = getThen(newValue);\n    if (then === IS_ERROR) {\n      return reject(self, LAST_ERROR);\n    }\n    if (\n      then === self.then &&\n      newValue instanceof Promise\n    ) {\n      self._81 = 3;\n      self._65 = newValue;\n      finale(self);\n      return;\n    } else if (typeof then === 'function') {\n      doResolve(then.bind(newValue), self);\n      return;\n    }\n  }\n  self._81 = 1;\n  self._65 = newValue;\n  finale(self);\n}\n\nfunction reject(self, newValue) {\n  self._81 = 2;\n  self._65 = newValue;\n  if (Promise._97) {\n    Promise._97(self, newValue);\n  }\n  finale(self);\n}\nfunction finale(self) {\n  if (self._45 === 1) {\n    handle(self, self._54);\n    self._54 = null;\n  }\n  if (self._45 === 2) {\n    for (var i = 0; i < self._54.length; i++) {\n      handle(self, self._54[i]);\n    }\n    self._54 = null;\n  }\n}\n\nfunction Handler(onFulfilled, onRejected, promise){\n  this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n  this.onRejected = typeof onRejected === 'function' ? onRejected : null;\n  this.promise = promise;\n}\n\n/**\n * Take a potentially misbehaving resolver function and make sure\n * onFulfilled and onRejected are only called once.\n *\n * Makes no guarantees about asynchrony.\n */\nfunction doResolve(fn, promise) {\n  var done = false;\n  var res = tryCallTwo(fn, function (value) {\n    if (done) return;\n    done = true;\n    resolve(promise, value);\n  }, function (reason) {\n    if (done) return;\n    done = true;\n    reject(promise, reason);\n  })\n  if (!done && res === IS_ERROR) {\n    done = true;\n    reject(promise, LAST_ERROR);\n  }\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/promise/lib/core.js\n// module id = 6\n// module chunks = 0","\"use strict\";\n\n// Use the fastest means possible to execute a task in its own turn, with\n// priority over other events including IO, animation, reflow, and redraw\n// events in browsers.\n//\n// An exception thrown by a task will permanently interrupt the processing of\n// subsequent tasks. The higher level `asap` function ensures that if an\n// exception is thrown by a task, that the task queue will continue flushing as\n// soon as possible, but if you use `rawAsap` directly, you are responsible to\n// either ensure that no exceptions are thrown from your task, or to manually\n// call `rawAsap.requestFlush` if an exception is thrown.\nmodule.exports = rawAsap;\nfunction rawAsap(task) {\n    if (!queue.length) {\n        requestFlush();\n        flushing = true;\n    }\n    // Equivalent to push, but avoids a function call.\n    queue[queue.length] = task;\n}\n\nvar queue = [];\n// Once a flush has been requested, no further calls to `requestFlush` are\n// necessary until the next `flush` completes.\nvar flushing = false;\n// `requestFlush` is an implementation-specific method that attempts to kick\n// off a `flush` event as quickly as possible. `flush` will attempt to exhaust\n// the event queue before yielding to the browser's own event loop.\nvar requestFlush;\n// The position of the next task to execute in the task queue. This is\n// preserved between calls to `flush` so that it can be resumed if\n// a task throws an exception.\nvar index = 0;\n// If a task schedules additional tasks recursively, the task queue can grow\n// unbounded. To prevent memory exhaustion, the task queue will periodically\n// truncate already-completed tasks.\nvar capacity = 1024;\n\n// The flush function processes all tasks that have been scheduled with\n// `rawAsap` unless and until one of those tasks throws an exception.\n// If a task throws an exception, `flush` ensures that its state will remain\n// consistent and will resume where it left off when called again.\n// However, `flush` does not make any arrangements to be called again if an\n// exception is thrown.\nfunction flush() {\n    while (index < queue.length) {\n        var currentIndex = index;\n        // Advance the index before calling the task. This ensures that we will\n        // begin flushing on the next task the task throws an error.\n        index = index + 1;\n        queue[currentIndex].call();\n        // Prevent leaking memory for long chains of recursive calls to `asap`.\n        // If we call `asap` within tasks scheduled by `asap`, the queue will\n        // grow, but to avoid an O(n) walk for every task we execute, we don't\n        // shift tasks off the queue after they have been executed.\n        // Instead, we periodically shift 1024 tasks off the queue.\n        if (index > capacity) {\n            // Manually shift all values starting at the index back to the\n            // beginning of the queue.\n            for (var scan = 0, newLength = queue.length - index; scan < newLength; scan++) {\n                queue[scan] = queue[scan + index];\n            }\n            queue.length -= index;\n            index = 0;\n        }\n    }\n    queue.length = 0;\n    index = 0;\n    flushing = false;\n}\n\n// `requestFlush` is implemented using a strategy based on data collected from\n// every available SauceLabs Selenium web driver worker at time of writing.\n// https://docs.google.com/spreadsheets/d/1mG-5UYGup5qxGdEMWkhP6BWCz053NUb2E1QoUTU16uA/edit#gid=783724593\n\n// Safari 6 and 6.1 for desktop, iPad, and iPhone are the only browsers that\n// have WebKitMutationObserver but not un-prefixed MutationObserver.\n// Must use `global` or `self` instead of `window` to work in both frames and web\n// workers. `global` is a provision of Browserify, Mr, Mrs, or Mop.\n\n/* globals self */\nvar scope = typeof global !== \"undefined\" ? global : self;\nvar BrowserMutationObserver = scope.MutationObserver || scope.WebKitMutationObserver;\n\n// MutationObservers are desirable because they have high priority and work\n// reliably everywhere they are implemented.\n// They are implemented in all modern browsers.\n//\n// - Android 4-4.3\n// - Chrome 26-34\n// - Firefox 14-29\n// - Internet Explorer 11\n// - iPad Safari 6-7.1\n// - iPhone Safari 7-7.1\n// - Safari 6-7\nif (typeof BrowserMutationObserver === \"function\") {\n    requestFlush = makeRequestCallFromMutationObserver(flush);\n\n// MessageChannels are desirable because they give direct access to the HTML\n// task queue, are implemented in Internet Explorer 10, Safari 5.0-1, and Opera\n// 11-12, and in web workers in many engines.\n// Although message channels yield to any queued rendering and IO tasks, they\n// would be better than imposing the 4ms delay of timers.\n// However, they do not work reliably in Internet Explorer or Safari.\n\n// Internet Explorer 10 is the only browser that has setImmediate but does\n// not have MutationObservers.\n// Although setImmediate yields to the browser's renderer, it would be\n// preferrable to falling back to setTimeout since it does not have\n// the minimum 4ms penalty.\n// Unfortunately there appears to be a bug in Internet Explorer 10 Mobile (and\n// Desktop to a lesser extent) that renders both setImmediate and\n// MessageChannel useless for the purposes of ASAP.\n// https://github.com/kriskowal/q/issues/396\n\n// Timers are implemented universally.\n// We fall back to timers in workers in most engines, and in foreground\n// contexts in the following browsers.\n// However, note that even this simple case requires nuances to operate in a\n// broad spectrum of browsers.\n//\n// - Firefox 3-13\n// - Internet Explorer 6-9\n// - iPad Safari 4.3\n// - Lynx 2.8.7\n} else {\n    requestFlush = makeRequestCallFromTimer(flush);\n}\n\n// `requestFlush` requests that the high priority event queue be flushed as\n// soon as possible.\n// This is useful to prevent an error thrown in a task from stalling the event\n// queue if the exception handled by Node.jss\n// `process.on(\"uncaughtException\")` or by a domain.\nrawAsap.requestFlush = requestFlush;\n\n// To request a high priority event, we induce a mutation observer by toggling\n// the text of a text node between \"1\" and \"-1\".\nfunction makeRequestCallFromMutationObserver(callback) {\n    var toggle = 1;\n    var observer = new BrowserMutationObserver(callback);\n    var node = document.createTextNode(\"\");\n    observer.observe(node, {characterData: true});\n    return function requestCall() {\n        toggle = -toggle;\n        node.data = toggle;\n    };\n}\n\n// The message channel technique was discovered by Malte Ubl and was the\n// original foundation for this library.\n// http://www.nonblocking.io/2011/06/windownexttick.html\n\n// Safari 6.0.5 (at least) intermittently fails to create message ports on a\n// page's first load. Thankfully, this version of Safari supports\n// MutationObservers, so we don't need to fall back in that case.\n\n// function makeRequestCallFromMessageChannel(callback) {\n//     var channel = new MessageChannel();\n//     channel.port1.onmessage = callback;\n//     return function requestCall() {\n//         channel.port2.postMessage(0);\n//     };\n// }\n\n// For reasons explained above, we are also unable to use `setImmediate`\n// under any circumstances.\n// Even if we were, there is another bug in Internet Explorer 10.\n// It is not sufficient to assign `setImmediate` to `requestFlush` because\n// `setImmediate` must be called *by name* and therefore must be wrapped in a\n// closure.\n// Never forget.\n\n// function makeRequestCallFromSetImmediate(callback) {\n//     return function requestCall() {\n//         setImmediate(callback);\n//     };\n// }\n\n// Safari 6.0 has a problem where timers will get lost while the user is\n// scrolling. This problem does not impact ASAP because Safari 6.0 supports\n// mutation observers, so that implementation is used instead.\n// However, if we ever elect to use timers in Safari, the prevalent work-around\n// is to add a scroll event listener that calls for a flush.\n\n// `setTimeout` does not call the passed callback if the delay is less than\n// approximately 7 in web workers in Firefox 8 through 18, and sometimes not\n// even then.\n\nfunction makeRequestCallFromTimer(callback) {\n    return function requestCall() {\n        // We dispatch a timeout with a specified delay of 0 for engines that\n        // can reliably accommodate that request. This will usually be snapped\n        // to a 4 milisecond delay, but once we're flushing, there's no delay\n        // between events.\n        var timeoutHandle = setTimeout(handleTimer, 0);\n        // However, since this timer gets frequently dropped in Firefox\n        // workers, we enlist an interval handle that will try to fire\n        // an event 20 times per second until it succeeds.\n        var intervalHandle = setInterval(handleTimer, 50);\n\n        function handleTimer() {\n            // Whichever timer succeeds will cancel both timers and\n            // execute the callback.\n            clearTimeout(timeoutHandle);\n            clearInterval(intervalHandle);\n            callback();\n        }\n    };\n}\n\n// This is for `asap.js` only.\n// Its name will be periodically randomized to break any code that depends on\n// its existence.\nrawAsap.makeRequestCallFromTimer = makeRequestCallFromTimer;\n\n// ASAP was originally a nextTick shim included in Q. This was factored out\n// into this ASAP package. It was later adapted to RSVP which made further\n// amendments. These decisions, particularly to marginalize MessageChannel and\n// to capture the MutationObserver implementation in a closure, were integrated\n// back into ASAP proper.\n// https://github.com/tildeio/rsvp.js/blob/cddf7232546a9cf858524b75cde6f9edf72620a7/lib/rsvp/asap.js\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/asap/browser-raw.js\n// module id = 7\n// module chunks = 0","import React, { Component } from 'react';\nimport * as AppGeneral from '../socialcalc/AppGeneral';\nimport { DATA } from '../app-data.js';\nimport './App.css';\n\nimport Menu from '../Menu/Menu';\nimport Files from '../Files/Files';\n\n// import '@ionic/react/css/core.css';\n\n// /* Basic CSS for apps built with Ionic */\n// import '@ionic/react/css/normalize.css';\n// import '@ionic/react/css/structure.css';\n// import '@ionic/react/css/typography.css';\n\n// /* Optional CSS utils that can be commented out */\n// import '@ionic/react/css/padding.css';\n// import '@ionic/react/css/float-elements.css';\n// import '@ionic/react/css/text-alignment.css';\n// import '@ionic/react/css/text-transformation.css';\n// import '@ionic/react/css/flex-utils.css';\n// import '@ionic/react/css/display.css';\n// import { Outlet } from 'react-router-dom';\n// import { setupIonicReact } from '@ionic/react';\n\n// import '../theme/variables.css';\n\n// setupIonicReact();\n\nclass App extends Component {\n  \n  constructor(props) {\n    super(props);\n    this.state = {selectedFile: \"default\" , device: AppGeneral.getDeviceType() , listFiles: false };\n    this.updateSelectedFile = this.updateSelectedFile.bind(this);\n    this.toggleListFiles = this.toggleListFiles.bind(this);\n  }\n\n  updateSelectedFile(selectedFile){\n    this.setState({\n      selectedFile: selectedFile\n    });\n  }\n\n  toggleListFiles(){\n    this.setState(prevState => ({\n      listFiles: !prevState.listFiles\n    }));\n  }\n\n  componentDidMount(){\n    let data = DATA['home'][this.state.device]['msc'];\n    AppGeneral.initializeApp(JSON.stringify(data));\n  }\n\n  activateFooter(footer){\n    // console.log(\"Button pressed! \"+footer);\n    AppGeneral.activateFooterButton(footer);\n  }\n\n  render() {\n    let footers = DATA['home'][this.state.device]['footers'];\n    \n    let footersList = footers.map((footerArray, i) => {\n        // console.log(footerArray.name);\n        // console.log(footerArray.index);\n        return <button className=\"button button-outline\" key={footerArray.index} onClick={() => this.activateFooter(footerArray.index)}> {footerArray.name} </button>\n        \n    });\n\n    return (\n      <div className=\"App\">\n        <div className=\"App-header\"> \n          <span>Editing: { this.state.selectedFile } </span>\n          <button className=\"App-list\" onClick={ this.toggleListFiles } >List Files</button> \n          \n        </div>\n        <div className=\"App-menu\"> <Menu file={this.state.selectedFile} updateSelectedFile={this.updateSelectedFile} /> </div>\n        <ul className=\"App-footers\"> { footersList } </ul>\n        <div id=\"workbookControl\"></div>\n        <div id=\"tableeditor\">editor goes here</div> \n        <div id=\"msg\"></div> \n        {this.state.listFiles ? <div className=\"App-files\"> \n                                <Files file={this.state.selectedFile} updateSelectedFile={this.updateSelectedFile}/> </div> : null} \n      {/* <Outlet></Outlet> */}\n      </div>\n    );\n  }\n}\n\nexport default App;\n\n\n\n// WEBPACK FOOTER //\n// ./src/App/App.js","import React, { Component } from 'react';\nimport './Files.css';\nimport * as AppGeneral from '../socialcalc/AppGeneral';\nimport { Local } from '../storage/LocalStorage.js';\nimport { DATA } from '../app-data.js';\n\nclass Files extends Component {\n\n\tconstructor(props){\n\t\tsuper(props);\n\t\tthis.store = new Local(this.props.file);\t\n\t\tthis.state = {\n\t\t\tfiles: this.store._getAllFiles()\n\t\t}\n\t}\n\n\teditFile(key){\n\t\tconst data = this.store._getFile(key);\n\t\t// console.log(JSON.stringify(data));\n\t\tAppGeneral.viewFile(key, decodeURIComponent(data.content));\n\t\tthis.props.updateSelectedFile(key);\n\t}\n\n\tdeleteFile(key){\n\t\tevent.preventDefault()\n    \tconst result = window.confirm(`Do you want to delete the ${key} file?`)\n    \tif (result) {\n    \t  // Delete file\n    \t  this.store._deleteFile(key);\n    \t  this.setState({ files: this.store._getAllFiles() });\n    \t  this.loadDefault();\n    \t}\n\t}\n\n\tloadDefault(){\n\t\tconst msc = DATA['home'][AppGeneral.getDeviceType()]['msc'];\n\t\tAppGeneral.viewFile('default', JSON.stringify(msc));\n\t\tthis.props.updateSelectedFile('default');\n\t}\n\n\trender() {\n\t\tconst files = this.store._getAllFiles();\n\t\t// console.log(JSON.stringify(files));\n\t\tlet fileList = Object.keys(files).map(key => {\n\t\t\t// console.log(key);\n\t\t\treturn <div key={key}><li>{ key } <span>{ this._formatDate(files[key]) }</span></li>\n\t\t\t\t\t<button onClick={()=>{ this.editFile(key)} }>Edit</button>\n\t\t\t\t\t<button onClick={()=>{ this.deleteFile(key)} }>Delete</button>\n\t\t\t\t\t</div>;\n\t\t});\n\n\t\treturn (\n\t\t\t<div className=\"file\">\n\t\t\t\t<ul>\n\t\t\t\t\t{ fileList }\n\t\t\t\t</ul>\n\t\t\t</div>\n\t\t);\n\t}\n\n\t_formatDate(date){\n\t\treturn new Date(date).toLocaleString();\n\t}\n\n}\n\nexport default Files;\n\n\n// WEBPACK FOOTER //\n// ./src/Files/Files.js","import React, { Component } from 'react';\nimport './Login.css';\nimport { Cloud } from '../storage/CloudStorage.js';\nimport { APP_NAME } from '../app-data.js';\n\nclass Login extends Component {\n\n\tconstructor(props) {\n      \tsuper(props);\n\t\t\n      \tthis.state = {\n         \temail: '', password: ''\n      \t};\n\n      \tthis.cloud = new Cloud();\t\n\n   };\n\n   updateEmail(e) {\n      \tthis.setState({email: e.target.value});\n   }\n\n   updatePassword(e) {\n      \tthis.setState({password: e.target.value});\n   }\n\n   doAuth(){\n   \t\tconsole.log(\"Loggin in... \"+this.state.email);\n   \t\tconst data = {email: this.state.email, password: this.state.password, appname: APP_NAME };\n   \t\tthis.cloud._auth(data);\n   }\n\n\trender(){\n\t\treturn(\n\t\t\t<div className=\"Login-modal\">\n\t\t\t\t<input type=\"text\" id=\"email\" value={ this.state.email } onChange={ this.updateEmail.bind(this) } placeholder=\"Email..\"/>\n\t\t\t\t<input type=\"password\" id=\"password\" value={ this.state.password } onChange={ this.updatePassword.bind(this) } placeholder=\"Password..\"/>\n\t\t\t\t<button onClick={ ()=> this.doAuth() }> Login </button>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default Login;\n\n\n// WEBPACK FOOTER //\n// ./src/Login/Login.js","import React, { Component } from 'react';\nimport './Menu.css';\nimport * as AppGeneral from '../socialcalc/AppGeneral';\nimport { File, Local } from '../storage/LocalStorage.js';\nimport { DATA } from '../app-data.js';\nimport Login from '../Login/Login';\n// import AWS from 'aws-sdk';\n//import config from '../config';\n\n\n// const ses = new AWS.SES({\n// \t  apiVersion: '2010-12-01',\n// \t  accessKeyId: 'AKIAIUAT6PWCBX54OQEA',\n// \t  \"secretAccessKey\": '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',\n// \t  \"region\": \"us-west-1\",\n// \t});\n\n\nclass Menu extends Component {\n\n\tconstructor(props){\n\t\tsuper(props);\n\t\tthis.store = new Local(this.props.file);\n\t\tthis.state = { login : false , openLogin: false };\t\n\t}\n\n\tdoPrint(){\n\t\tconst content = AppGeneral.getCurrentHTMLContent();\n\t\tvar printWindow = window.open('','','left=100,top=100');\n\t\tprintWindow.document.write(content);\n\t\tprintWindow.print();\n\t\tprintWindow.close();\n\t}\n\n\tdoSave(){\n\t\tif(this.props.file === \"default\"){\n\t\t\twindow.alert(`Cannot update ${this.props.file} file! `);\n\t\t\treturn;\n\t\t}\n\t\tconst content = encodeURIComponent(AppGeneral.getSpreadsheetContent());\n\t\tconst data = this.store._getFile(this.props.file);\n\t\tconst file = new File(data.created, new Date().toString(), content, this.props.file);\n\t\tthis.store._saveFile(file);\n\t\tthis.props.updateSelectedFile(this.props.file);\n\t\twindow.alert(`File ${this.props.file} updated successfully! `);\n\t}\n\n\tdoSaveAs(){\n\t\tevent.preventDefault();\n\t\tconst filename = window.prompt(\"Enter filename : \");\n\t    if(filename) {\n\t\t\tif(this._validateName(filename)){\n\t\t\t\t// filename valid . go on save\n\t\t\t\tconst content = encodeURIComponent(AppGeneral.getSpreadsheetContent());\n\t\t\t\t// console.log(content);\n\t\t\t\tconst file = new File(new Date().toString(), new Date().toString(), content, filename);\n\t\t\t\t// const data = { created: file.created, modified: file.modified, content: file.content, password: file.password };\n\t\t\t\t// console.log(JSON.stringify(data));\n\t\t\t\tthis.store._saveFile(file);\n\t\t\t\tthis.props.updateSelectedFile(filename);\n\t\t\t\twindow.alert(`File ${filename} saved successfully! `);\n\t\t\t}\n\t\t\telse{\n\t\t\t\twindow.alert(`Filename cannot be ${this.props.file}`);\n\t\t\t}\n\t\t}\n\t\t\n\t}\n\n\tnewFile(){\n\t\tif(this.props.file !== 'default'){\n\t\t\tconst content = encodeURIComponent(AppGeneral.getSpreadsheetContent());\n\t\t\tconst data = this.store._getFile(this.props.file);\n\t\t\tconst file = new File(data.created, new Date().toString(), content, this.props.file);\n\t\t\tthis.store._saveFile(file);\n\t\t\tthis.props.updateSelectedFile(this.props.file);\n\t\t}\n\t\tconst msc = DATA['home'][AppGeneral.getDeviceType()]['msc'];\n\t\tAppGeneral.viewFile('default', JSON.stringify(msc));\n\t\tthis.props.updateSelectedFile('default');\n\t}\n\n\tauth(loggedIn){\n\t\tif(loggedIn){\n\t\t\t// console.log(\"log out..\");\n\t\t\tthis.setState({login: false , openLogin: false});\n\t\t}\n\t\telse{\n\t\t\t// console.log(\"log in..\");\n\t\t\tthis.setState({login: true , openLogin: true });\n\t\t}\n\t}\n\n\tsendEmail(){\n\t\t// Prepare values to send with email\n      const emailParams = {\n        Destination: { ToAddresses: [ '<aspiringuserapps@gmail.com>' ] },\n        Message: {\n          Body: { Text: {\n            Data: 'This is a test email' } },\n          Subject: { Data: 'Contact Form' }\n        },\n        ReplyToAddresses: [''],\n        Source: '<aspiring.investments@gmail.com>', // this has to be verified email in SES\n      };\n\n    //   ses.sendEmail(emailParams, function(error, data) {\n    //     if (error) {\n    //        // handle error\n    //     } else {\n    //        // handle success\n    //        alert(\"Done\");\n    //     }\n    //   });\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<div className=\"Menu\">\n\t\t\t\t<button onClick={() => this.doSave()} > Save  </button>\n\t\t\t\t<button onClick={() => this.doSaveAs()} > Save As </button>\n\t\t\t\t<button onClick={() => this.doPrint()} > Print </button>\n\t\t\t\t<button onClick={() => this.sendEmail()} > Email </button>\n\t\t\t\t<button onClick={() => this.newFile()} > New File </button>\n\t\t\t\t<button onClick={() => this.auth(this.state.login)} > {this.state.login ? `Logout` : `Login` } </button>\n\t\t\t\t{ this.state.openLogin ? <Login /> : null  }\n\t\t\t</div>\n\t\t);\n\t}\n\n\t/* Utility functions */\n\t_validateName(filename){\n\n\t\tfilename = filename.trim();\n\t\tif(filename === \"default\" || filename === \"Untitled\"){\n\t\t\t// return 'Cannot update default file!';\n\t\t\treturn false;\n\t\t}\n\t\telse if(filename === '' || !filename){\n\t\t\t// this.showToast('Filename cannot be empty');\n\t\t\treturn false;\n\t\t}\n\t\telse if(filename.length > 30) {\n\t\t\t// this.showToast('Filename too long');\n\t\t\treturn false;\n\t\t}\n\t\telse if(/^[a-zA-Z0-9- ]*$/.test(filename) === false) {\n\t\t\t// this.showToast('Special Characters cannot be used');\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t}\n\n\t_formatString(filename){\n\t\t/* Remove whitespaces */\n\t\twhile(filename.indexOf(\" \") !== -1){\n\t\t\tfilename = filename.replace(\" \",\"\");\n\t\t}\n\t\treturn filename;\n\t}\n\n}\n\nexport default Menu;\n\n\n// WEBPACK FOOTER //\n// ./src/Menu/Menu.js","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App/App';\nimport './index.css';\n\nReactDOM.render(\n  <App />,\n  document.getElementById('root')\n);\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","/* eslint-disable */\n// Taken from https://github.com/umdjs/umd/blob/master/templates/returnExports.js\n// (c) by The UMD contributors\n// MIT License: https://github.com/umdjs/umd/blob/master/LICENSE.md\n(function (root, factory) {\n    if (typeof define === 'function' && define.amd) {\n        // AMD. Register as an anonymous module.\n        define([], factory.bind(root, this));\n    } else if (typeof module === 'object' && module.exports) {\n        // Node. Does not work with strict CommonJS, but\n        // only CommonJS-like environments that support module.exports,\n        // like Node.\n        module.exports = factory.call(root, this);\n    } else {\n        // Browser globals (root is window)\n        root.SocialCalc = factory.call(root, this);\n  }\n}(this, function (window) {\n//\n/*\n// The module of the SocialCalc package with customizable constants, strings, etc.\n// This is where most of the common localizations are done.\n//\n// (c) Copyright 2008, 2009, 2010 Socialtext, Inc.\n// All Rights Reserved.\n//\n// The contents of this file are subject to the Artistic License 2.0; you may not\n// use this file except in compliance with the License. You may obtain a copy of \n// the License at http://socialcalc.org/licenses/al-20/.\n//\n// Some of the other files in the SocialCalc package are licensed under\n// different licenses. Please note the licenses of the modules you use.\n//\n// Code History:\n//\n// Initially coded by Dan Bricklin of Software Garden, Inc., for Socialtext, Inc.\n// Based in part on the SocialCalc 1.1.0 code written in Perl.\n// The SocialCalc 1.1.0 code was:\n//    Portions (c) Copyright 2005, 2006, 2007 Software Garden, Inc.\n//    All Rights Reserved.\n//    Portions (c) Copyright 2007 Socialtext, Inc.\n//    All Rights Reserved.\n// The Perl SocialCalc started as modifications to the wikiCalc(R) program, version 1.0.\n// wikiCalc 1.0 was written by Software Garden, Inc.\n// Unless otherwise specified, referring to \"SocialCalc\" in comments refers to this\n// JavaScript version of the code, not the SocialCalc Perl code.\n//\n*/\n//\n/*\n// The module of the SocialCalc package with customizable constants, strings, etc.\n// This is where most of the common localizations are done.\n//\n// (c) Copyright 2008, 2009, 2010 Socialtext, Inc.\n// All Rights Reserved.\n//\n// The contents of this file are subject to the Artistic License 2.0; you may not\n// use this file except in compliance with the License. You may obtain a copy of \n// the License at http://socialcalc.org/licenses/al-20/.\n//\n// Some of the other files in the SocialCalc package are licensed under\n// different licenses. Please note the licenses of the modules you use.\n//\n// Code History:\n//\n// Initially coded by Dan Bricklin of Software Garden, Inc., for Socialtext, Inc.\n// Based in part on the SocialCalc 1.1.0 code written in Perl.\n// The SocialCalc 1.1.0 code was:\n//    Portions (c) Copyright 2005, 2006, 2007 Software Garden, Inc.\n//    All Rights Reserved.\n//    Portions (c) Copyright 2007 Socialtext, Inc.\n//    All Rights Reserved.\n// The Perl SocialCalc started as modifications to the wikiCalc(R) program, version 1.0.\n// wikiCalc 1.0 was written by Software Garden, Inc.\n// Unless otherwise specified, referring to \"SocialCalc\" in comments refers to this\n// JavaScript version of the code, not the SocialCalc Perl code.\n//\n*/\n\nvar AppGeneral = require(\"../AppGeneral.js\");\nvar SocialCalc;\nif (!SocialCalc) SocialCalc = {};\n\n// *************************************\n//\n// TO LEARN HOW TO LOCALIZE OR CUSTOMIZE SOCIALCALC, PLEASE READ THIS:\n//\n// The constants are all properties of the SocialCalc.Constants object.\n// They are grouped here by what they are for, which module uses them, etc.\n//\n// Properties whose names start with \"s_\" are strings, or arrays of strings,\n// that are good candidates for translation from the English.\n//\n// Other properties relate to visual settings, localization parameters, etc.\n//\n// These values are not used when SocialCalc modules are first loaded.\n// They may be modified before the first use of the routines that use them,\n// e.g., before creating SocialCalc objects.\n//\n// The exceptions are:\n//    TooltipOffsetX and TooltipOffsetY, as described with their definitions.\n//\n// SocialCalc IS NOT DESIGNED FOR USE WITH A TRANSLATION FUNCTION each time a string\n// is used. Instead, language translations may be done by modifying this object.\n//\n// To customize SocialCalc, you may either replace this file with a modified version\n// or you can overwrite the values before use. An example would be to\n// iterate over all the properties looking for names that start with \"s_\" and\n// use some other mechanism to obtain a localized string and replace the values\n// here with those translated values.\n//\n// There is also a function, SocialCalc.ConstantsSetClasses, that may be used\n// to easily switch SocialCalc from using explicit CSS styles for many things\n// to using CSS classes. See the function, below, for more information.\n//\n// *************************************\n\nSocialCalc.Constants = {\n\n//\n// Main SocialCalc module, socialcalc-3.js:\n//\n\n   //*** Common Constants\n\n   textdatadefaulttype: \"t\", // This sets the default type for text on reading source file\n                             // It should normally be \"t\"\n\n   //*** Common error messages\n\n   s_BrowserNotSupported: \"Browser not supported.\", // error thrown if browser can't handle events like IE or Firefox.\n   s_InternalError: \"Internal SocialCalc error (probably an internal bug): \", // hopefully unlikely, but a test failed\n\n   //*** SocialCalc.ParseSheetSave\n\n   // Errors thrown on unexpected value in save file:\n\n   s_pssUnknownColType: \"Unknown col type item\",\n   s_pssUnknownRowType: \"Unknown row type item\",\n   s_pssUnknownLineType: \"Unknown line type\",\n\n   //*** SocialCalc.CellFromStringParts\n\n   // Error thrown on unexpected value in save file:\n\n   s_cfspUnknownCellType: \"Unknown cell type item\",\n\n   //*** SocialCalc.CanonicalizeSheet\n\n   doCanonicalizeSheet: true, // if true, do the canonicalization calculations\n\n   //*** ExecuteSheetCommand\n\n   s_escUnknownSheetCmd: \"Unknown sheet command: \",\n   s_escUnknownSetCoordCmd: \"Unknown set coord command: \",\n   s_escUnknownCmd: \"Unknown command: \",\n\n   //*** SocialCalc.CheckAndCalcCell\n\n   s_caccCircRef: \"Circular reference to \", // circular reference found during recalc\n\n   //*** SocialCalc.RenderContext\n\n   defaultRowNameWidth: \"30\", // used to set minimum width of the row header column - a string in pixels\n   defaultAssumedRowHeight: 15, // used when guessing row heights - number\n   defaultCellIDPrefix: \"cell_\", // if non-null, each cell will render with an ID starting with this\n\n   // Default sheet display values\n\n   defaultCellLayout: \"padding:2px 2px 1px 2px;vertical-align:top;\",\n   defaultCellFontStyle: \"normal normal\",\n   defaultCellFontSize: \"small\",\n   defaultCellFontFamily: \"Verdana,Arial,Helvetica,sans-serif\",\n\n   defaultPaneDividerWidth: \"2\", // a string\n   defaultPaneDividerHeight: \"3\", // a string\n\n   defaultGridCSS: \"1px solid #C0C0C0;\", // used as style to set each border when grid enabled (was #ECECEC)\n\n   defaultCommentClass: \"\", // class added to cells with non-null comments when grid enabled\n   defaultCommentStyle: \"background-repeat:no-repeat;background-position:top right;background-image:url(www/assets/images/sc_commentbg.gif);\", // style added to cells with non-null comments when grid enabled\n   defaultCommentNoGridClass: \"\", // class added to cells with non-null comments when grid not enabled\n   defaultCommentNoGridStyle: \"\", // style added to cells with non-null comments when grid not enabled\n\n   defaultColWidth: \"80\", // text\n   defaultMinimumColWidth: 10, // numeric\n\n   // For each of the following default sheet display values at least one of class and/or style are needed\n\n   defaultHighlightTypeCursorClass: \"\",\n   // defaultHighlightTypeCursorStyle: \"color:#FFF;backgroundColor:#A6A6A6;\",\n   defaultHighlightTypeCursorStyle: \"\",\n   defaultHighlightTypeRangeClass: \"\",\n   //defaultHighlightTypeRangeStyle: \"color:#000;backgroundColor:#E5E5E5;\",\n   defaultHighlightTypeRangeStyle: \"\",\n\n   defaultColnameClass: \"\", // regular column heading letters, needs a cursor property \n   defaultColnameStyle: \"font-size:small;text-align:center;color:#FFFFFF;background-color:#808080;cursor:e-resize;\",\n   defaultSelectedColnameClass: \"\", // column with selected cell, needs a cursor property \n   defaultSelectedColnameStyle: \"font-size:small;text-align:center;color:#FFFFFF;background-color:#404040;cursor:e-resize;\",\n   defaultRownameClass: \"\", // regular row heading numbers\n   defaultRownameStyle: \"font-size:small;text-align:right;color:#FFFFFF;background-color:#808080;\",\n   defaultSelectedRownameClass: \"\", // column with selected cell, needs a cursor property \n   defaultSelectedRownameStyle: \"font-size:small;text-align:right;color:#FFFFFF;background-color:#404040;\",\n   defaultUpperLeftClass: \"\", // Corner cell in upper left\n   defaultUpperLeftStyle: \"font-size:small;text-align:center;color:#FFFFFF;background-color:#808080;cursor:e-resize;\",\n   defaultSkippedCellClass: \"\", // used if present for spanned cells peeking into a pane (at least one of class/style needed)\n   defaultSkippedCellStyle: \"font-size:small;background-color:#CCC\", // used if present\n   defaultPaneDividerClass: \"\", // used if present for the look of the space between panes (at least one of class/style needed)\n   defaultPaneDividerStyle: \"font-size:small;background-color:#C0C0C0;padding:0px;\", // used if present\n\n   s_rcMissingSheet: \"Render Context must have a sheet object\", // unlikely thrown error\n\n   //*** SocialCalc.format_text_for_display\n\n   defaultLinkFormatString: '<span style=\"font-size:smaller;text-decoration:none !important;background-color:#66B;color:#FFF;\">Link</span>', // used for format \"text-link\"; you could make this an img tag if desired\n//   defaultLinkFormatString: '<img src=\"www/assets/images/sc_linkout.gif\" border=\"0\" alt=\"Link out\" title=\"Link out\">',\n   defaultPageLinkFormatString: '<span style=\"font-size:smaller;text-decoration:none !important;background-color:#66B;color:#FFF;\">Page</span>', // used for format \"text-link\"; you could make this an img tag if desired\n\n   //*** SocialCalc.format_number_for_display\n\n   defaultFormatdt: 'd-mmm-yyyy h:mm:ss',\n   defaultFormatd: 'd-mmm-yyyy',\n   defaultFormatt: '[h]:mm:ss',\n   defaultDisplayTRUE: 'TRUE', // how TRUE shows when rendered\n   defaultDisplayFALSE: 'FALSE',\n\n//\n// SocialCalc Table Editor module, socialcalctableeditor.js:\n//\n\n   //*** SocialCalc.TableEditor\n\n   defaultImagePrefix: \"www/assets/images/sc_\", // URL prefix for images (e.g., \"/www/assets/images/sc\")\n   defaultTableEditorIDPrefix: \"te_\", // if present, many TableEditor elements are assigned IDs with this prefix\n   defaultPageUpDnAmount: 15, // number of rows to move cursor on PgUp/PgDn keys (numeric)\n\n   AllowCtrlS: true, // turns on Ctrl-S trapdoor for setting custom numeric formats and commands if true\n\n   //*** SocialCalc.CreateTableEditor\n\n   defaultTableControlThickness: 0, // the short size for the scrollbars, etc. (numeric in pixels)\n   cteGriddivClass: \"\", // if present, the class for the TableEditor griddiv element\n\n   //** SocialCalc.EditorGetStatuslineString -- strings shown on status line\n\n   s_statusline_executing: \"Executing...\",\n   s_statusline_displaying: \"Displaying...\",\n   s_statusline_ordering: \"Ordering...\",\n   s_statusline_calculating: \"Calculating...\",\n   s_statusline_calculatingls: \"Calculating... Loading Sheet...\",\n   s_statusline_doingserverfunc: \"doing server function \",\n   s_statusline_incell: \" in cell \",\n   s_statusline_calcstart: \"Calculation start...\",\n   s_statusline_sum: \"SUM\",\n   s_statusline_recalcneeded: '<span style=\"color:#999;\">(Recalc needed)</span>',\n   s_statusline_circref: '<span style=\"color:red;\">Circular reference: ',\n\n   //** SocialCalc.InputBoxDisplayCellContents\n\n   s_inputboxdisplaymultilinetext: \"[Multi-line text: Click icon on right to edit]\",\n\n   //** SocialCalc.InputEcho\n\n   defaultInputEchoClass: \"\", // if present, the class of the popup inputEcho div\n   defaultInputEchoStyle: \"filter:alpha(opacity=90);opacity:.9;backgroundColor:#FFD;border:1px solid #884;\"+\n      \"fontSize:small;padding:2px 10px 1px 2px;cursor:default;\", // if present, pseudo style\n   defaultInputEchoPromptClass: \"\", // if present, the class of the popup inputEcho div\n   defaultInputEchoPromptStyle: \"filter:alpha(opacity=90);opacity:.9;backgroundColor:#FFD;\"+\n      \"borderLeft:1px solid #884;borderRight:1px solid #884;borderBottom:1px solid #884;\"+\n      \"fontSize:small;fontStyle:italic;padding:2px 10px 1px 2px;cursor:default;\", // if present, pseudo style\n\n   //** SocialCalc.InputEchoText\n\n   ietUnknownFunction: \"Unknown function \", // displayed when typing \"=unknown(\"\n\n   //** SocialCalc.CellHandles\n\n   CH_radius1: 29.0, // extent of inner circle within 90px image\n   CH_radius2: 41.0, // extent of outer circle within 90px image\n   s_CHfillAllTooltip: \"Fill Contents and Formats Down/Right\", // tooltip for fill all handle\n   s_CHfillContentsTooltip: \"Fill Contents Only Down/Right\", // tooltip for fill formulas handle\n   s_CHmovePasteAllTooltip: \"Move Contents and Formats\", // etc.\n   s_CHmovePasteContentsTooltip: \"Move Contents Only\",\n   s_CHmoveInsertAllTooltip: \"Slide Contents and Formats within Row/Col\",\n   s_CHmoveInsertContentsTooltip: \"Slide Contents within Row/Col\",\n   s_CHindicatorOperationLookup: {\"Fill\": \"Fill\", \"FillC\": \"Fill Contents\",\n                                  \"Move\": \"Move\", \"MoveI\": \"Slide\", \n                                  \"MoveC\": \"Move Contents\", \"MoveIC\": \"Slide Contents\"}, // short form of operation to follow drag\n   s_CHindicatorDirectionLookup: {\"Down\": \" Down\", \"Right\": \" Right\",\n                                  \"Horizontal\": \" Horizontal\", \"Vertical\": \" Vertical\"}, // direction that modifies operation during drag\n\n   //*** SocialCalc.TableControl\n\n   defaultTCSliderThickness: 9, // length of pane slider (numeric in pixels)\n   defaultTCButtonThickness: 20, // length of scroll +/- buttons (numeric in pixels)\n   defaultTCThumbThickness: 15, // length of thumb (numeric in pixels)\n\n   //*** SocialCalc.CreateTableControl\n\n   TCmainStyle: \"backgroundColor:#EEE;\", // if present, pseudo style (text-align is textAlign) for main div of a table control\n   TCmainClass: \"\", // if present, the CSS class of the main div for a table control\n   TCendcapStyle: \"backgroundColor:#FFF;\", // backgroundColor may be used while waiting for image that may not come\n   TCendcapClass: \"\",\n   TCpanesliderStyle: \"backgroundColor:#CCC;\",\n   TCpanesliderClass: \"\",\n   s_panesliderTooltiph: \"Drag to lock pane vertically\", // tooltip for horizontal table control pane slider\n   s_panesliderTooltipv: \"Drag to lock pane horizontally\",\n   TClessbuttonStyle: \"backgroundColor:#AAA;\",\n   TClessbuttonClass: \"\",\n   TClessbuttonRepeatWait: 300, // in milliseconds\n   TClessbuttonRepeatInterval: 20,//100, // in milliseconds\n   TCmorebuttonStyle: \"backgroundColor:#AAA;\",\n   TCmorebuttonClass: \"\",\n   TCmorebuttonRepeatWait: 300, // in milliseconds\n   TCmorebuttonRepeatInterval: 20,//100, // in milliseconds\n   TCscrollareaStyle: \"backgroundColor:#DDD;\",\n   TCscrollareaClass: \"\",\n   TCscrollareaRepeatWait: 500, // in milliseconds\n   TCscrollareaRepeatInterval: 100, // in milliseconds\n   TCthumbClass: \"\",\n   TCthumbStyle: \"backgroundColor:#CCC;\",\n\n   //*** SocialCalc.TCPSDragFunctionStart\n\n   TCPStrackinglineClass: \"\", // at least one of class/style for pane slider tracking line display in table control\n   TCPStrackinglineStyle: \"overflow:hidden;position:absolute;zIndex:100;\",\n                           // if present, pseudo style (text-align is textAlign)\n   TCPStrackinglineThickness: \"2px\", // narrow dimension of trackling line (string with units)\n\n\n   //*** SocialCalc.TCTDragFunctionStart\n\n   TCTDFSthumbstatusvClass: \"\", // at least one of class/style for vertical thumb dragging status display in table control\n   TCTDFSthumbstatusvStyle: \"height:20px;width:auto;border:3px solid #808080;overflow:hidden;\"+\n                           \"backgroundColor:#FFF;fontSize:small;position:absolute;zIndex:100;\",\n                           // if present, pseudo style (text-align is textAlign)\n   TCTDFSthumbstatushClass: \"\", // at least one of class/style for horizontal thumb dragging status display in table control\n   TCTDFSthumbstatushStyle: \"height:20px;width:auto;border:1px solid black;padding:2px;\"+\n                           \"backgroundColor:#FFF;fontSize:small;position:absolute;zIndex:100;\",\n                           // if present, pseudo style (text-align is textAlign)\n   TCTDFSthumbstatusrownumClass: \"\", // at least one of class/style for thumb dragging status display in table control\n   TCTDFSthumbstatusrownumStyle: \"color:#FFF;background-color:#808080;font-size:small;white-space:nowrap;padding:3px;\", // if present, real style\n   TCTDFStopOffsetv: 0, // offsets for thumbstatus display while dragging\n   TCTDFSleftOffsetv: -80,\n   s_TCTDFthumbstatusPrefixv: \"Row \", // Text Control Drag Function text before row number\n   TCTDFStopOffseth: -30,\n   TCTDFSleftOffseth: 0,\n   s_TCTDFthumbstatusPrefixh: \"Col \", // Text Control Drag Function text before col number\n\n   //*** SocialCalc.TooltipInfo\n\n   // Note: These two values are used to set the TooltipInfo initial values when the code is first read in.\n   // Modifying them here after loading has no effect -- you need to modify SocialCalc.TooltipInfo directly\n   // to dynamically set them. This is different than most other constants which may be modified until use.\n\n   TooltipOffsetX: 2, // offset in pixels from mouse position (to right on left side of screen, to left on right)\n   TooltipOffsetY: 10, // offset in pixels above mouse position for lower edge\n\n   //*** SocialCalc.TooltipDisplay\n\n   TDpopupElementClass: \"\", // at least one of class/style for tooltip display\n   TDpopupElementStyle: \"border:1px solid black;padding:1px 2px 2px 2px;textAlign:center;backgroundColor:#FFF;\"+\n                        \"fontSize:7pt;fontFamily:Verdana,Arial,Helvetica,sans-serif;\"+\n                        \"position:absolute;width:auto;zIndex:110;\",\n                        // if present, pseudo style (text-align is textAlign)\n\n\n//\n// SocialCalc Spreadsheet Control module, socialcalcspreadsheetcontrol.js:\n//\n\n   //*** SocialCalc.SpreadsheetControl\n\n   SCToolbarbackground: \"background-color:#404040;\",\n   SCTabbackground: \"background-color:#CCC;\",\n   SCTabselectedCSS: \"font-size:small;padding:6px 30px 6px 8px;color:#FFF;background-color:#404040;cursor:default;border-right:1px solid #CCC;\",\n   SCTabplainCSS: \"font-size:small;padding:6px 30px 6px 8px;color:#FFF;background-color:#808080;cursor:default;border-right:1px solid #CCC;\",\n   SCToolbartext: \"font-size:x-small;font-weight:bold;color:#FFF;padding-bottom:4px;\",\n\n   SCFormulabarheight: 0, // in pixels, will contain a text input box\n\n   SCStatuslineheight: 20, // in pixels\n   SCStatuslineCSS: \"font-size:10px;padding:3px 0px;\",\n\n\n   // workbook\n    doWorkBook: true,\n    SCSheetBarHeight: 25,\n    SCSheetBarBackground: \"background-color:#CCC;\",\n    SCSheetBarCSS: \"background-color:#CCC;\",\n    SCSheetBarWidth: \"70%\",\n\n    SCCellHandlesDisable: true,\n    SCNoInputEcho: true,  // do we need an input echo ?\n    s_inputboxdisplaynoteditable: \"[not editable]\",\n    SCNoRowName: true,\n    SCNoRanging: true,\n    SCNoQuoteInInputBox: true,\n   // Constants for default Format tab (settings)\n   //\n   // *** EVEN THOUGH THESE DON'T START WITH s_: ***\n   //\n   // These should be carefully checked for localization. Make sure you understand what they do and how they work!\n   // The first part of \"first:second|first:second|...\" is what is displayed and the second is the value to be used.\n   // The value is normally not translated -- only the displayed part. The [cancel], [break], etc., are not translated --\n   // they are commands to SocialCalc.SettingsControls.PopupListInitialize \n\n   SCFormatNumberFormats: \"[cancel]:|[break]:|%loc!Default!:|[custom]:|%loc!Automatic!:general|%loc!Auto w/ commas!:[,]General|[break]:|\"+\n            \"00:00|000:000|0000:0000|00000:00000|[break]:|%loc!Formula!:formula|%loc!Hidden!:hidden|[newcol]:\"+\n            \"1234:0|1,234:#,##0|1,234.5:#,##0.0|1,234.56:#,##0.00|1,234.567:#,##0.000|1,234.5678:#,##0.0000|\"+\n            \"[break]:|1,234%:#,##0%|1,234.5%:#,##0.0%|1,234.56%:#,##0.00%|\"+\n            \"[newcol]:|$1,234:$#,##0|$1,234.5:$#,##0.0|$1,234.56:$#,##0.00|[break]:|\"+\n            \"(1,234):#,##0_);(#,##0)|(1,234.5):#,##0.0_);(#,##0.0)|(1,234.56):#,##0.00_);(#,##0.00)|[break]:|\"+\n            \"($1,234):#,##0_);($#,##0)|($1,234.5):$#,##0.0_);($#,##0.0)|($1,234.56):$#,##0.00_);($#,##0.00)|\"+\n            \"[newcol]:|1/4/06:m/d/yy|01/04/2006:mm/dd/yyyy|2006-01-04:yyyy-mm-dd|4-Jan-06:d-mmm-yy|04-Jan-2006:dd-mmm-yyyy|January 4, 2006:mmmm d, yyyy|\"+\n            \"[break]:|1\\\\c23:h:mm|1\\\\c23 PM:h:mm AM/PM|1\\\\c23\\\\c45:h:mm:ss|01\\\\c23\\\\c45:hh:mm:ss|26\\\\c23 (h\\\\cm):[hh]:mm|69\\\\c45 (m\\\\cs):[mm]:ss|69 (s):[ss]|\"+\n            \"[newcol]:|2006-01-04 01\\\\c23\\\\c45:yyyy-mm-dd hh:mm:ss|January 4, 2006:mmmm d, yyyy hh:mm:ss|Wed:ddd|Wednesday:dddd|\",\n   SCFormatTextFormats: \"[cancel]:|[break]:|%loc!Default!:|[custom]:|%loc!Automatic!:general|%loc!Plain Text!:text-plain|\"+\n            \"HTML:text-html|%loc!Wikitext!:text-wiki|%loc!Link!:text-link|%loc!Formula!:formula|%loc!Hidden!:hidden|\",\n   SCFormatPadsizes: \"[cancel]:|[break]:|%loc!Default!:|[custom]:|%loc!No padding!:0px|\"+\n            \"[newcol]:|1 pixel:1px|2 pixels:2px|3 pixels:3px|4 pixels:4px|5 pixels:5px|\"+\n            \"6 pixels:6px|7 pixels:7px|8 pixels:8px|[newcol]:|9 pixels:9px|10 pixels:10px|11 pixels:11px|\"+\n            \"12 pixels:12px|13 pixels:13px|14 pixels:14px|16 pixels:16px|\"+\n            \"18 pixels:18px|[newcol]:|20 pixels:20px|22 pixels:22px|24 pixels:24px|28 pixels:28px|36 pixels:36px|\",\n   SCFormatFontsizes: \"[cancel]:|[break]:|%loc!Default!:|[custom]:|X-Small:x-small|Small:small|Medium:medium|Large:large|X-Large:x-large|\"+\n                  \"[newcol]:|6pt:6pt|7pt:7pt|8pt:8pt|9pt:9pt|10pt:10pt|11pt:11pt|12pt:12pt|14pt:14pt|16pt:16pt|\"+\n                  \"[newcol]:|18pt:18pt|20pt:20pt|22pt:22pt|24pt:24pt|28pt:28pt|36pt:36pt|48pt:48pt|72pt:72pt|\"+\n                  \"[newcol]:|8 pixels:8px|9 pixels:9px|10 pixels:10px|11 pixels:11px|\"+\n                  \"12 pixels:12px|13 pixels:13px|14 pixels:14px|[newcol]:|16 pixels:16px|\"+\n                  \"18 pixels:18px|20 pixels:20px|22 pixels:22px|24 pixels:24px|28 pixels:28px|36 pixels:36px|\",\n   SCFormatFontfamilies: \"[cancel]:|[break]:|%loc!Default!:|[custom]:|Verdana:Verdana,Arial,Helvetica,sans-serif|\"+\n                  \"Arial:arial,helvetica,sans-serif|Courier:'Courier New',Courier,monospace|\",\n   SCFormatFontlook: \"[cancel]:|[break]:|%loc!Default!:|%loc!Normal!:normal normal|%loc!Bold!:normal bold|%loc!Italic!:italic normal|\"+\n                  \"%loc!Bold Italic!:italic bold\",\n   SCFormatTextAlignhoriz:  \"[cancel]:|[break]:|%loc!Default!:|%loc!Left!:left|%loc!Center!:center|%loc!Right!:right|\",\n   SCFormatNumberAlignhoriz:  \"[cancel]:|[break]:|%loc!Default!:|%loc!Left!:left|%loc!Center!:center|%loc!Right!:right|\",\n   SCFormatAlignVertical: \"[cancel]:|[break]:|%loc!Default!:|%loc!Top!:top|%loc!Middle!:middle|%loc!Bottom!:bottom|\",\n   SCFormatColwidth: \"[cancel]:|[break]:|%loc!Default!:|[custom]:|[newcol]:|\"+\n                  \"20 pixels:20|40:40|60:60|80:80|100:100|120:120|140:140|160:160|\"+\n                  \"[newcol]:|180 pixels:180|200:200|220:220|240:240|260:260|280:280|300:300|\",\n   SCFormatRecalc: \"[cancel]:|[break]:|%loc!Auto!:|%loc!Manual!:off|\",\n\n   //*** SocialCalc.InitializeSpreadsheetControl\n\n   ISCButtonBorderNormal: \"#404040\",\n   ISCButtonBorderHover: \"#999\",\n   ISCButtonBorderDown: \"#FFF\",\n   ISCButtonDownBackground: \"#888\",\n\n   //*** SocialCalc.SettingsControls.PopupListInitialize\n\n   s_PopupListCancel: \"[Cancel]\",\n   s_PopupListCustom: \"Custom\",\n\n   // ***\n   //\n   // s_loc_ constants accessed by SocialCalc.LocalizeString and SocialCalc.LocalizeSubstrings\n   //\n   // Used extensively by socialcalcspreadsheetcontrol.js\n   //\n   // ***\n\n   s_loc_align_center: \"Align Center\",\n   s_loc_align_left: \"Align Left\",\n   s_loc_align_right: \"Align Right\",\n   s_loc_alignment: \"Alignment\",\n   s_loc_audit: \"Audit\",\n   s_loc_audit_trail_this_session: \"Audit Trail This Session\",\n   s_loc_auto: \"Auto\",\n   s_loc_auto_sum: \"Auto Sum\",\n   s_loc_auto_wX_commas: \"Auto w/ commas\",\n   s_loc_automatic: \"Automatic\",\n   s_loc_background: \"Background\",\n   s_loc_bold: \"Bold\",\n   s_loc_bold_XampX_italics: \"Bold &amp; Italics\",\n   s_loc_bold_italic: \"Bold Italic\",\n   s_loc_borders: \"Borders\",\n   s_loc_borders_off: \"Borders Off\",\n   s_loc_borders_on: \"Borders On\",\n   s_loc_bottom: \"Bottom\",\n   s_loc_bottom_border: \"Bottom Border\",\n   s_loc_cell_settings: \"CELL SETTINGS\",\n   s_loc_csv_format: \"CSV format\",\n   s_loc_cancel: \"Cancel\",\n   s_loc_category: \"Category\",\n   s_loc_center: \"Center\",\n   s_loc_clear: \"Clear\",\n   s_loc_clear_socialcalc_clipboard: \"Clear SocialCalc Clipboard\",\n   s_loc_clipboard: \"Clipboard\",\n   s_loc_color: \"Color\",\n   s_loc_column_: \"Column \",\n   s_loc_comment: \"Comment\",\n   s_loc_copy: \"Copy\",\n   s_loc_custom: \"Custom\",\n   s_loc_cut: \"Cut\",\n   s_loc_default: \"Default\",\n   s_loc_default_alignment: \"Default Alignment\",\n   s_loc_default_column_width: \"Default Column Width\",\n   s_loc_default_font: \"Default Font\",\n   s_loc_default_format: \"Default Format\",\n   s_loc_default_padding: \"Default Padding\",\n   s_loc_delete: \"Delete\",\n   s_loc_delete_column: \"Delete Column\",\n   s_loc_delete_contents: \"Delete Contents\",\n   s_loc_delete_row: \"Delete Row\",\n   s_loc_description: \"Description\",\n   s_loc_display_clipboard_in: \"Display Clipboard in\",\n   s_loc_down: \"Down\",\n   s_loc_edit: \"Edit\",\n   s_loc_existing_names: \"Existing Names\",\n   s_loc_family: \"Family\",\n   s_loc_fill_down: \"Fill Down\",\n   s_loc_fill_right: \"Fill Right\",\n   s_loc_font: \"Font\",\n   s_loc_format: \"Format\",\n   s_loc_formula: \"Formula\",\n   s_loc_function_list: \"Function List\",\n   s_loc_functions: \"Functions\",\n   s_loc_grid: \"Grid\",\n   s_loc_hidden: \"Hidden\",\n   s_loc_horizontal: \"Horizontal\",\n   s_loc_insert_column: \"Insert Column\",\n   s_loc_insert_row: \"Insert Row\",\n   s_loc_italic: \"Italic\",\n   s_loc_last_sort: \"Last Sort\",\n   s_loc_left: \"Left\",\n   s_loc_left_border: \"Left Border\",\n   s_loc_link: \"Link\",\n   s_loc_link_input_box: \"Link Input Box\",\n   s_loc_list: \"List\",\n   s_loc_load_socialcalc_clipboard_with_this: \"Load SocialCalc Clipboard With This\",\n   s_loc_major_sort: \"Major Sort\",\n   s_loc_manual: \"Manual\",\n   s_loc_merge_cells: \"Merge Cells\",\n   s_loc_middle: \"Middle\",\n   s_loc_minor_sort: \"Minor Sort\",\n   s_loc_move_insert: \"Move Insert\",\n   s_loc_move_paste: \"Move Paste\",\n   s_loc_multiXline_input_box: \"Multi-line Input Box\",\n   s_loc_name: \"Name\",\n   s_loc_names: \"Names\",\n   s_loc_no_padding: \"No padding\",\n   s_loc_normal: \"Normal\",\n   s_loc_number: \"Number\",\n   s_loc_number_horizontal: \"Number Horizontal\",\n   s_loc_ok: \"OK\",\n   s_loc_padding: \"Padding\",\n   s_loc_page_name: \"Page Name\",\n   s_loc_paste: \"Paste\",\n   s_loc_paste_formats: \"Paste Formats\",\n   s_loc_plain_text: \"Plain Text\",\n   s_loc_recalc: \"Recalc\",\n   s_loc_recalculation: \"Recalculation\",\n   s_loc_redo: \"Redo\",\n   s_loc_right: \"Right\",\n   s_loc_right_border: \"Right Border\",\n   s_loc_sheet_settings: \"SHEET SETTINGS\",\n   s_loc_save: \"Save\",\n   s_loc_save_to: \"Save to\",\n   s_loc_set_cell_contents: \"Set Cell Contents\",\n   s_loc_set_cells_to_sort: \"Set Cells To Sort\",\n   s_loc_set_value_to: \"Set Value To\",\n   s_loc_set_to_link_format: \"Set to Link format\",\n   s_loc_setXclear_move_from: \"Set/Clear Move From\",\n   s_loc_show_cell_settings: \"Show Cell Settings\",\n   s_loc_show_sheet_settings: \"Show Sheet Settings\",\n   s_loc_show_in_new_browser_window: \"Show in new browser window\",\n   s_loc_size: \"Size\",\n   s_loc_socialcalcXsave_format: \"SocialCalc-save format\",\n   s_loc_sort: \"Sort\",\n   s_loc_sort_: \"Sort \",\n   s_loc_sort_cells: \"Sort Cells\",\n   s_loc_swap_colors: \"Swap Colors\",\n   s_loc_tabXdelimited_format: \"Tab-delimited format\",\n   s_loc_text: \"Text\",\n   s_loc_text_horizontal: \"Text Horizontal\",\n   s_loc_this_is_aXbrXsample: \"This is a<br>sample\",\n   s_loc_top: \"Top\",\n   s_loc_top_border: \"Top Border\",\n   s_loc_undone_steps: \"UNDONE STEPS\",\n   s_loc_url: \"URL\",\n   s_loc_undo: \"Undo\",\n   s_loc_unmerge_cells: \"Unmerge Cells\",\n   s_loc_up: \"Up\",\n   s_loc_value: \"Value\",\n   s_loc_vertical: \"Vertical\",\n   s_loc_wikitext: \"Wikitext\",\n   s_loc_workspace: \"Workspace\",\n   s_loc_XnewX: \"[New]\",\n   s_loc_XnoneX: \"[None]\",\n   s_loc_Xselect_rangeX: \"[select range]\",\n\n//\n// SocialCalc Spreadsheet Viewer module, socialcalcviewer.js:\n//\n\n   //*** SocialCalc.SpreadsheetViewer\n\n   SVStatuslineheight: 20, // in pixels\n   SVStatuslineCSS: \"font-size:10px;padding:3px 0px;\",\n\n//\n// SocialCalc Format Number module, formatnumber2.js:\n//\n\n   FormatNumber_separatorchar: \",\", // the thousands separator character when formatting numbers for display\n   FormatNumber_decimalchar: \".\", // the decimal separator character when formatting numbers for display\n   FormatNumber_defaultCurrency: \"$\", // the currency string used if none specified\n\n   // The following constants are arrays of strings with the short (3 character) and full names of days and months\n\n   s_FormatNumber_daynames: [\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\"],\n   s_FormatNumber_daynames3: [\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"],\n   s_FormatNumber_monthnames: [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\",\n                                      \"October\", \"November\", \"December\"],\n   s_FormatNumber_monthnames3: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"],\n   s_FormatNumber_am: \"AM\",\n   s_FormatNumber_am1: \"A\",\n   s_FormatNumber_pm: \"PM\",\n   s_FormatNumber_pm1: \"P\",\n\n//\n// SocialCalc Spreadsheet Formula module, formula1.js:\n//\n\n   s_parseerrexponent: \"Improperly formed number exponent\",\n   s_parseerrchar: \"Unexpected character in formula\",\n   s_parseerrstring: \"Improperly formed string\",\n   s_parseerrspecialvalue: \"Improperly formed special value\",\n   s_parseerrtwoops: \"Error in formula (two operators inappropriately in a row)\",\n   s_parseerrmissingopenparen: \"Missing open parenthesis in list with comma(s). \",\n   s_parseerrcloseparennoopen: \"Closing parenthesis without open parenthesis. \",\n   s_parseerrmissingcloseparen: \"Missing close parenthesis. \",\n   s_parseerrmissingoperand: \"Missing operand. \",\n   s_parseerrerrorinformula: \"Error in formula.\",\n   s_calcerrerrorvalueinformula: \"Error value in formula\",\n   s_parseerrerrorinformulabadval: \"Error in formula resulting in bad value\",\n   s_formularangeresult: \"Formula results in range value:\",\n   s_calcerrnumericnan: \"Formula results in an bad numeric value\",\n   s_calcerrnumericoverflow: \"Numeric overflow\",\n   s_sheetunavailable: \"Sheet unavailable:\", // when FindSheetInCache returns null\n   s_calcerrcellrefmissing: \"Cell reference missing when expected.\",\n   s_calcerrsheetnamemissing: \"Sheet name missing when expected.\",\n   s_circularnameref: \"Circular name reference to name\",\n   s_calcerrunknownname: \"Unknown name\",\n   s_calcerrincorrectargstofunction: \"Incorrect arguments to function\",\n   s_sheetfuncunknownfunction: \"Unknown function\",\n   s_sheetfunclnarg: \"LN argument must be greater than 0\",\n   s_sheetfunclog10arg: \"LOG10 argument must be greater than 0\",\n   s_sheetfunclogsecondarg: \"LOG second argument must be numeric greater than 0\",\n   s_sheetfunclogfirstarg: \"LOG first argument must be greater than 0\",\n   s_sheetfuncroundsecondarg: \"ROUND second argument must be numeric\",\n   s_sheetfuncddblife: \"DDB life must be greater than 1\",\n   s_sheetfuncslnlife: \"SLN life must be greater than 1\",\n\n   // Function definition text\n\n   s_fdef_ABS: 'Absolute value function. ',\n   s_fdef_ACOS: 'Trigonometric arccosine function. ',\n   s_fdef_AND: 'True if all arguments are true. ',\n   s_fdef_ASIN: 'Trigonometric arcsine function. ',\n   s_fdef_ATAN: 'Trigonometric arctan function. ',\n   s_fdef_ATAN2: 'Trigonometric arc tangent function (result is in radians). ',\n   s_fdef_AVERAGE: 'Averages the values. ',\n   s_fdef_CHOOSE: 'Returns the value specified by the index. The values may be ranges of cells. ',\n   s_fdef_COLUMNS: 'Returns the number of columns in the range. ',\n   s_fdef_COS: 'Trigonometric cosine function (value is in radians). ',\n   s_fdef_COUNT: 'Counts the number of numeric values, not blank, text, or error. ',\n   s_fdef_COUNTA: 'Counts the number of non-blank values. ',\n   s_fdef_COUNTBLANK: 'Counts the number of blank values. (Note: \"\" is not blank.) ',\n   s_fdef_COUNTIF: 'Counts the number of number of cells in the range that meet the criteria. The criteria may be a value (\"x\", 15, 1+3) or a test (>25). ',\n   s_fdef_DATE: 'Returns the appropriate date value given numbers for year, month, and day. For example: DATE(2006,2,1) for February 1, 2006. Note: In this program, day \"1\" is December 31, 1899 and the year 1900 is not a leap year. Some programs use January 1, 1900, as day \"1\" and treat 1900 as a leap year. In both cases, though, dates on or after March 1, 1900, are the same. ',\n   s_fdef_DAVERAGE: 'Averages the values in the specified field in records that meet the criteria. ',\n   s_fdef_DAY: 'Returns the day of month for a date value. ',\n   s_fdef_DCOUNT: 'Counts the number of numeric values, not blank, text, or error, in the specified field in records that meet the criteria. ',\n   s_fdef_DCOUNTA: 'Counts the number of non-blank values in the specified field in records that meet the criteria. ',\n   s_fdef_DDB: 'Returns the amount of depreciation at the given period of time (the default factor is 2 for double-declining balance).   ',\n   s_fdef_DEGREES: 'Converts value in radians into degrees. ',\n   s_fdef_DGET: 'Returns the value of the specified field in the single record that meets the criteria. ',\n   s_fdef_DMAX: 'Returns the maximum of the numeric values in the specified field in records that meet the criteria. ',\n   s_fdef_DMIN: 'Returns the maximum of the numeric values in the specified field in records that meet the criteria. ',\n   s_fdef_DPRODUCT: 'Returns the result of multiplying the numeric values in the specified field in records that meet the criteria. ',\n   s_fdef_DSTDEV: 'Returns the sample standard deviation of the numeric values in the specified field in records that meet the criteria. ',\n   s_fdef_DSTDEVP: 'Returns the standard deviation of the numeric values in the specified field in records that meet the criteria. ',\n   s_fdef_DSUM: 'Returns the sum of the numeric values in the specified field in records that meet the criteria. ',\n   s_fdef_DVAR: 'Returns the sample variance of the numeric values in the specified field in records that meet the criteria. ',\n   s_fdef_DVARP: 'Returns the variance of the numeric values in the specified field in records that meet the criteria. ',\n   s_fdef_EVEN: 'Rounds the value up in magnitude to the nearest even integer. ',\n   s_fdef_EXACT: 'Returns \"true\" if the values are exactly the same, including case, type, etc. ',\n   s_fdef_EXP: 'Returns e raised to the value power. ',\n   s_fdef_FACT: 'Returns factorial of the value. ',\n   s_fdef_FALSE: 'Returns the logical value \"false\". ',\n   s_fdef_FIND: 'Returns the starting position within string2 of the first occurrence of string1 at or after \"start\". If start is omitted, 1 is assumed. ',\n   s_fdef_FV: 'Returns the future value of repeated payments of money invested at the given rate for the specified number of periods, with optional present value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period). ',\n   s_fdef_HLOOKUP: 'Look for the matching value for the given value in the range and return the corresponding value in the cell specified by the row offset. If rangelookup is 1 (the default) and not 0, match if within numeric brackets (match<=value) instead of exact match. ',\n   s_fdef_HOUR: 'Returns the hour portion of a time or date/time value. ',\n   s_fdef_IF: 'Results in true-value if logical-expression is TRUE or non-zero, otherwise results in false-value. ',\n   s_fdef_INDEX: 'Returns a cell or range reference for the specified row and column in the range. If range is 1-dimensional, then only one of rownum or colnum are needed. If range is 2-dimensional and rownum or colnum are zero, a reference to the range of just the specified column or row is returned. You can use the returned reference value in a range, e.g., sum(A1:INDEX(A2:A10,4)). ',\n   s_fdef_INT: 'Returns the value rounded down to the nearest integer (towards -infinity). ',\n   s_fdef_IRR: 'Returns the interest rate at which the cash flows in the range have a net present value of zero. Uses an iterative process that will return #NUM! error if it does not converge. There may be more than one possible solution. Providing the optional guess value may help in certain situations where it does not converge or finds an inappropriate solution (the default guess is 10%). ',\n   s_fdef_ISBLANK: 'Returns \"true\" if the value is a reference to a blank cell. ',\n   s_fdef_ISERR: 'Returns \"true\" if the value is of type \"Error\" but not \"NA\". ',\n   s_fdef_ISERROR: 'Returns \"true\" if the value is of type \"Error\". ',\n   s_fdef_ISLOGICAL: 'Returns \"true\" if the value is of type \"Logical\" (true/false). ',\n   s_fdef_ISNA: 'Returns \"true\" if the value is the error type \"NA\". ',\n   s_fdef_ISNONTEXT: 'Returns \"true\" if the value is not of type \"Text\". ',\n   s_fdef_ISNUMBER: 'Returns \"true\" if the value is of type \"Number\" (including logical values). ',\n   s_fdef_ISTEXT: 'Returns \"true\" if the value is of type \"Text\". ',\n   s_fdef_LEFT: 'Returns the specified number of characters from the text value. If count is omitted, 1 is assumed. ',\n   s_fdef_LEN: 'Returns the number of characters in the text value. ',\n   s_fdef_LN: 'Returns the natural logarithm of the value. ',\n   s_fdef_LOG: 'Returns the logarithm of the value using the specified base. ',\n   s_fdef_LOG10: 'Returns the base 10 logarithm of the value. ',\n   s_fdef_LOWER: 'Returns the text value with all uppercase characters converted to lowercase. ',\n   s_fdef_MATCH: 'Look for the matching value for the given value in the range and return position (the first is 1) in that range. If rangelookup is 1 (the default) and not 0, match if within numeric brackets (match<=value) instead of exact match. If rangelookup is -1, act like 1 but the bracket is match>=value. ',\n   s_fdef_MAX: 'Returns the maximum of the numeric values. ',\n   s_fdef_MID: 'Returns the specified number of characters from the text value starting from the specified position. ',\n   s_fdef_MIN: 'Returns the minimum of the numeric values. ',\n   s_fdef_MINUTE: 'Returns the minute portion of a time or date/time value. ',\n   s_fdef_MOD: 'Returns the remainder of the first value divided by the second. ',\n   s_fdef_MONTH: 'Returns the month part of a date value. ',\n   s_fdef_N: 'Returns the value if it is a numeric value otherwise an error. ',\n   s_fdef_NA: 'Returns the #N/A error value which propagates through most operations. ',\n   s_fdef_NOT: 'Returns FALSE if value is true, and TRUE if it is false. ',\n   s_fdef_NOW: 'Returns the current date/time. ',\n   s_fdef_NPER: 'Returns the number of periods at which payments invested each period at the given rate with optional future value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period) has the given present value. ',\n   s_fdef_NPV: 'Returns the net present value of cash flows (which may be individual values and/or ranges) at the given rate. The flows are positive if income, negative if paid out, and are assumed at the end of each period. ',\n   s_fdef_ODD: 'Rounds the value up in magnitude to the nearest odd integer. ',\n   s_fdef_OR: 'True if any argument is true ',\n   s_fdef_PI: 'The value 3.1415926... ',\n   s_fdef_PMT: 'Returns the amount of each payment that must be invested at the given rate for the specified number of periods to have the specified present value, with optional future value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period). ',\n   s_fdef_POWER: 'Returns the first value raised to the second value power. ',\n   s_fdef_PRODUCT: 'Returns the result of multiplying the numeric values. ',\n   s_fdef_PROPER: 'Returns the text value with the first letter of each word converted to uppercase and the others to lowercase. ',\n   s_fdef_PV: 'Returns the present value of the given number of payments each invested at the given rate, with optional future value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period). ',\n   s_fdef_RADIANS: 'Converts value in degrees into radians. ',\n   s_fdef_RATE: 'Returns the rate at which the given number of payments each invested at the given rate has the specified present value, with optional future value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period). Uses an iterative process that will return #NUM! error if it does not converge. There may be more than one possible solution. Providing the optional guess value may help in certain situations where it does not converge or finds an inappropriate solution (the default guess is 10%). ',\n   s_fdef_REPLACE: 'Returns text1 with the specified number of characters starting from the specified position replaced by text2. ',\n   s_fdef_REPT: 'Returns the text repeated the specified number of times. ',\n   s_fdef_RIGHT: 'Returns the specified number of characters from the text value starting from the end. If count is omitted, 1 is assumed. ',\n   s_fdef_ROUND: 'Rounds the value to the specified number of decimal places. If precision is negative, then round to powers of 10. The default precision is 0 (round to integer). ',\n   s_fdef_ROWS: 'Returns the number of rows in the range. ',\n   s_fdef_SECOND: 'Returns the second portion of a time or date/time value (truncated to an integer). ',\n   s_fdef_SIN: 'Trigonometric sine function (value is in radians) ',\n   s_fdef_SLN: 'Returns the amount of depreciation at each period of time using the straight-line method. ',\n   s_fdef_SQRT: 'Square root of the value ',\n   s_fdef_STDEV: 'Returns the sample standard deviation of the numeric values. ',\n   s_fdef_STDEVP: 'Returns the standard deviation of the numeric values. ',\n   s_fdef_SUBSTITUTE: 'Returns text1 with the all occurrences of oldtext replaced by newtext. If \"occurrence\" is present, then only that occurrence is replaced. ',\n   s_fdef_SUM: 'Adds the numeric values. The values to the sum function may be ranges in the form similar to A1:B5. ',\n   s_fdef_SUMIF: 'Sums the numeric values of cells in the range that meet the criteria. The criteria may be a value (\"x\", 15, 1+3) or a test (>25). If range2 is present, then range1 is tested and the corresponding range2 value is summed. ',\n   s_fdef_SYD: 'Depreciation by Sum of Year\\'s Digits method. ',\n   s_fdef_T: 'Returns the text value or else a null string. ',\n   s_fdef_TAN: 'Trigonometric tangent function (value is in radians) ',\n   s_fdef_TIME: 'Returns the time value given the specified hour, minute, and second. ',\n   s_fdef_TODAY: 'Returns the current date (an integer). Note: In this program, day \"1\" is December 31, 1899 and the year 1900 is not a leap year. Some programs use January 1, 1900, as day \"1\" and treat 1900 as a leap year. In both cases, though, dates on or after March 1, 1900, are the same. ',\n   s_fdef_TRIM: 'Returns the text value with leading, trailing, and repeated spaces removed. ',\n   s_fdef_TRUE: 'Returns the logical value \"true\". ',\n   s_fdef_TRUNC: 'Truncates the value to the specified number of decimal places. If precision is negative, truncate to powers of 10. ',\n   s_fdef_UPPER: 'Returns the text value with all lowercase characters converted to uppercase. ',\n   s_fdef_VALUE: 'Converts the specified text value into a numeric value. Various forms that look like numbers (including digits followed by %, forms that look like dates, etc.) are handled. This may not handle all of the forms accepted by other spreadsheets and may be locale dependent. ',\n   s_fdef_VAR: 'Returns the sample variance of the numeric values. ',\n   s_fdef_VARP: 'Returns the variance of the numeric values. ',\n   s_fdef_VLOOKUP: 'Look for the matching value for the given value in the range and return the corresponding value in the cell specified by the column offset. If rangelookup is 1 (the default) and not 0, match if within numeric brackets (match>=value) instead of exact match. ',\n   s_fdef_WEEKDAY: 'Returns the day of week specified by the date value. If type is 1 (the default), Sunday is day and Saturday is day 7. If type is 2, Monday is day 1 and Sunday is day 7. If type is 3, Monday is day 0 and Sunday is day 6. ',\n   s_fdef_YEAR: 'Returns the year part of a date value. ',\n\n   s_farg_v: \"value\",\n   s_farg_vn: \"value1, value2, ...\",\n   s_farg_xy: \"valueX, valueY\",\n   s_farg_choose: \"index, value1, value2, ...\",\n   s_farg_range: \"range\",\n   s_farg_rangec: \"range, criteria\",\n   s_farg_date: \"year, month, day\",\n   s_farg_dfunc: \"databaserange, fieldname, criteriarange\",\n   s_farg_ddb: \"cost, salvage, lifetime, period [, factor]\",\n   s_farg_find: \"string1, string2 [, start]\",\n   s_farg_fv: \"rate, n, payment, [pv, [paytype]]\",\n   s_farg_hlookup: \"value, range, row, [rangelookup]\",\n   s_farg_iffunc: \"logical-expression, true-value, false-value\",\n   s_farg_index: \"range, rownum, colnum\",\n   s_farg_irr: \"range, [guess]\",\n   s_farg_tc: \"text, count\",\n   s_farg_log: \"value, base\",\n   s_farg_match: \"value, range, [rangelookup]\",\n   s_farg_mid: \"text, start, length\",\n   s_farg_nper: \"rate, payment, pv, [fv, [paytype]]\",\n   s_farg_npv: \"rate, value1, value2, ...\",\n   s_farg_pmt: \"rate, n, pv, [fv, [paytype]]\",\n   s_farg_pv: \"rate, n, payment, [fv, [paytype]]\",\n   s_farg_rate: \"n, payment, pv, [fv, [paytype, [guess]]]\",\n   s_farg_replace: \"text1, start, length, text2\",\n   s_farg_vp: \"value, [precision]\",\n   s_farg_valpre: \"value, precision\",\n   s_farg_csl: \"cost, salvage, lifetime\",\n   s_farg_cslp: \"cost, salvage, lifetime, period\",\n   s_farg_subs: \"text1, oldtext, newtext [, occurrence]\",\n   s_farg_sumif: \"range1, criteria [, range2]\",\n   s_farg_hms: \"hour, minute, second\",\n   s_farg_txt: \"text\",\n   s_farg_vlookup: \"value, range, col, [rangelookup]\",\n   s_farg_weekday: \"date, [type]\",\n   s_farg_dt: \"date\",\n\n   function_classlist: [\"all\", \"stat\", \"lookup\", \"datetime\", \"financial\", \"test\", \"math\", \"text\"], // order of function classes\n\n   s_fclass_all: \"All\",\n   s_fclass_stat: \"Statistics\",\n   s_fclass_lookup: \"Lookup\",\n   s_fclass_datetime: \"Date & Time\",\n   s_fclass_financial: \"Financial\",\n   s_fclass_test: \"Test\",\n   s_fclass_math: \"Math\",\n   s_fclass_text: \"Text\",\n\n   lastone: null\n\n   };\n\n// Default classnames for use with SocialCalc.ConstantsSetClasses:\n\nSocialCalc.ConstantsDefaultClasses = {\n   defaultComment: \"\",\n   defaultCommentNoGrid: \"\",\n   defaultHighlightTypeCursor: \"\",\n   defaultHighlightTypeRange: \"\",\n   defaultColname: \"\",\n   defaultSelectedColname: \"\",\n   defaultRowname: \"\",\n   defaultSelectedRowname: \"\", \n   defaultUpperLeft: \"\",\n   defaultSkippedCell: \"\",\n   defaultPaneDivider: \"\",\n   cteGriddiv: \"\", // this one has no Style version with it\n   defaultInputEcho: {classname: \"\", style: \"filter:alpha(opacity=90);opacity:.9;\"}, // so FireFox won't show warning\n   TCmain: \"\",\n   TCendcap: \"\",\n   TCpaneslider: \"\",\n   TClessbutton: \"\",\n   TCmorebutton: \"\",\n   TCscrollarea: \"\",\n   TCthumb: \"\",\n   TCPStrackingline: \"\",\n   TCTDFSthumbstatus: \"\",\n   TDpopupElement: \"\"\n   };\n\n//\n// SocialCalc.ConstantsSetClasses(prefix)\n//\n// This routine goes through all of the xyzClass/xyzStyle pairs and sets the Class to a default and\n// turns off the Style, if present. The prefix is put before each default.\n// The list of items to set is in SocialCalc.ConstantsDefaultClasses. The names there\n// correspond to the \"xyz\" parts. If there is a value, it is the default to set. If the\n// default is a null, no change is made. If the default is the null string (\"\"), the\n// name of the item is used (e.g., \"defaultComment\" would use the classname \"defaultComment\").\n// If the default is an object, then it expects {classname: classname, style: stylestring} - this\n// lets you combine both.\n//\n\nSocialCalc.ConstantsSetClasses = function(prefix) {\n\n   var defaults = SocialCalc.ConstantsDefaultClasses;\n   var scc = SocialCalc.Constants;\n   var item;\n\n   prefix = prefix || \"\";\n\n   for (item in defaults) {\n      if (typeof defaults[item] == \"string\") {\n         scc[item+\"Class\"] = prefix + (defaults[item] || item);\n         if (scc[item+\"Style\"] !== undefined) {\n            scc[item+\"Style\"] = \"\";\n            }\n         }\n      else if (typeof defaults[item] == \"object\") {\n         scc[item+\"Class\"] = prefix + (defaults[item].classname || item);\n         scc[item+\"Style\"] = defaults[item].style;\n         }\n      }\n   }\n\n\n\n//\n// The main SocialCalc code module of the SocialCalc package\n//\n/*\n// (c) Copyright 2010 Socialtext, Inc.\n// All Rights Reserved.\n//\n// The contents of this file are subject to the Artistic License 2.0; you may not\n// use this file except in compliance with the License. You may obtain a copy of \n// the License at http://socialcalc.org/licenses/al-20/.\n//\n// Some of the other files in the SocialCalc package are licensed under\n// different licenses. Please note the licenses of the modules you use.\n//\n// Code History:\n//\n// Initially coded by Dan Bricklin of Software Garden, Inc., for Socialtext, Inc.\n// Based in part on the SocialCalc 1.1.0 code written in Perl.\n// The SocialCalc 1.1.0 code was:\n//    Portions (c) Copyright 2005, 2006, 2007 Software Garden, Inc.\n//    All Rights Reserved.\n//    Portions (c) Copyright 2007 Socialtext, Inc.\n//    All Rights Reserved.\n// The Perl SocialCalc started as modifications to the wikiCalc(R) program, version 1.0.\n// wikiCalc 1.0 was written by Software Garden, Inc.\n// Unless otherwise specified, referring to \"SocialCalc\" in comments refers to this\n// JavaScript version of the code, not the SocialCalc Perl code.\n//\n*/\n\n/*\n\n**** Overview ****\n\nThis is the beginning of a library of routines for displaying and editing spreadsheet\ndata in a browser. The HTML that includes this does not need to have anything\nspecific to the spreadsheet or editor already present -- everything is dynamically\nadded to the DOM by this code, including the rendered sheet and any editing controls.\n\nThe library has a few parts. This is the main SocialCalc code module.\nOther parts are the Table Editor module, the Formula module, and the Format Number module.\nNote: The Table Editor module is licensed under a different license than this module.\n\nThe class/object style is derived from O'Reilly's JavaScript by Flanagan, 5th Edition,\nsection 9.3, page 157.\n\nAll of the data, object definitions, functions, etc., are stored as properties of the SocialCalc\nobject so as not to clutter up the global variables nor conflict with other names.\n\nA design goal (not tested yet for success) is to make it possible to have more than one\nspreadsheet active on a page, perhaps even open for editing. It is assumed, though, that\nthere is only one mouse and one keyboard (a good assumption on most PCs today but not in the\nnew \"touch and surface world\" Apple and Microsoft are working towards).\n\nThe testing has been on Windows Firefox (2 and 3),\nInternet Explorer (6 and 7), Opera (9.23 and mainly later), Mac Safari (3.1), and Mac Firefox (2.0.0.6).\nThere are small issues with Firefox before 2.0 (cosmetic with drag handles) and larger ones\nwith Opera before 9.5 (the Delete key isn't recognized in some cases -- the 9.5 version was still\nin beta and this bug affects other products like GMail, I believe).\n\nThe data is stored in a SocialCalc.Sheet object. The data is organized in a form similar to that\nused by SocialCalc 1.1.0. There is a function for converting a normal SocialCalc spreadsheet\nsave data string (the spreadsheet part of a SocialCalc data file) into this internal form.\n\nThe SocialCalc.RenderContext class provides methods for rendering a table into the DOM representing\npart of the spreadsheet. It is assumed that the spreadsheet could possibly be very large\nand that rendering the whole thing at once could be too time consuming. It is also set up so\nthat it might be possible to have some of the sheet data only be loaded on demand (such as by Ajax).\nThe rendering can render cells to the right and below the already active area of the spreadsheet\nso that you can scroll to that \"clean\" area without explicitly doing \"add row/column\". The class also\ndoes simple operations such as \"scrolling\" within that table. The table may optionally include\nrow and column headers and may be split into panes. Most of the code assumes any number of panes,\nbut only the rightmost pane has scrolling code. In normal operation there would be one or two\npanes horizontally and vertically. The panes may start on any row/column, though a given row/column\nshould only appear in one pane at a time (not all code enforces this, yet).\n\nThe RenderContext is designed to be rendered as part of a SocialCalc.TableEditor. The TableEditor\nincludes the spreadsheet grid as well as scrollbars, pane sliders, and (eventually) editing controls.\nThe layout is dynamic and may be recomputed on the fly, such as in response to resizing the browser\nwindow.\n\nThe scrollbars and pane sliders are created using SocialCalc.TableControl objects. These in turn\nmake use of Dragging, ToolTip, Button, and MouseWheel functions.\n\nThe keyboard input is handled by keyboard code.\n\nThere are also some helper routines.\n\nMore comments yet to come...\n\n*/\n\n\nvar SocialCalc;\nif (!SocialCalc) SocialCalc = {};\n\n// *************************************\n//\n// Shared values\n//\n// These are \"global\" values shared by the classes, including default settings\n//\n// *************************************\n\n// Callbacks\n\nSocialCalc.Callbacks = {\n\n   // The next two are used by SocialCalc.format_text_for_display\n\n   // The function to expand wiki text - should be set if you want wikitext expansion\n   // The form is: expand_wiki(displayvalue, sheetobj, linkstyle, valueformat)\n   //    valueformat is text-wiki followed by optional sub-formats, e.g., text-wikipagelink\n\n   expand_wiki: null,\n\n   expand_markup: function(displayvalue, sheetobj, linkstyle) // the old function to expand wiki text - may be replaced\n                   {return SocialCalc.default_expand_markup(displayvalue, sheetobj, linkstyle);},\n\n   // MakePageLink is used to create the href for a link to another \"page\"\n   // The form is: MakePageLink(pagename, workspacename, linktyle, valueformat), returns string\n\n   MakePageLink: null,\n\n   // NormalizeSheetName is used to make different variations of sheetnames use the same cache slot\n\n   NormalizeSheetName: null // use default - lowercase\n\n   };\n\n// Shared flags\n\n   // none at present\n\n\n// *************************************\n//\n// Cell class:\n//\n// *************************************\n\n//\n// Class SocialCalc.Cell\n//\n// Usage: var s = new SocialCalc.Cell(coord);\n//\n// Cell attributes include:\n//\n//    coord: the column/row as a string, e.g., \"A1\"\n//    datavalue: the value to be used for computation and formatting for display,\n//               string or numeric (tolerant of numbers stored as strings)\n//    datatype: if present, v=numeric value, t=text value, f=formula,\n//              or c=constant that is not a simple number (like \"$1.20\")\n//    formula: if present, the formula (without leading \"=\") for computation or the constant\n//    valuetype: first char is main type, the following are sub-types.\n//               Main types are b=blank cell, n=numeric, t=text, e=error\n//               Examples of using sub-types would be \"nt\" for a numeric time value, \"n$\" for currency, \"nl\" for logical\n//    displayvalue: if present, rendered version of datavalue with formatting attributes applied\n//    parseinfo: if present, cached parsed version of formula\n//\n//    The following optional values, if present, are mainly used in rendering, overriding defaults:\n//\n//    bt, br, bb, bl: number of border's definition\n//    layout: layout (vertical alignment, padding) definition number\n//    font: font definition number\n//    color: text color definition number\n//    bgcolor: background color definition number\n//    cellformat: cell format (horizontal alignment) definition number\n//    nontextvalueformat: custom format definition number for non-text values, e.g., numbers\n//    textvalueformat: custom format definition number for text values\n//    colspan, rowspan: number of cells to span for merged cells (only on main cell)\n//    cssc: custom css classname for cell, as text (no special chars)\n//    csss: custom css style definition\n//    mod: modification allowed flag \"y\" if present\n//    comment: cell comment string\n//\n\nSocialCalc.Cell = function(coord) {\n\n   this.coord = coord;\n   this.datavalue = \"\";\n   this.datatype = null;\n   this.formula = \"\";\n   this.valuetype = \"b\";\n\n   }\n\n// The types of cell properties\n//\n// Type 1: Base, Type 2: Attribute, Type 3: Special (e.g., displaystring, parseinfo)\n\nSocialCalc.CellProperties = {\n   coord: 1, datavalue: 1, datatype: 1, formula: 1, valuetype: 1, errors: 1, comment: 1,\n   bt: 2, br: 2, bb: 2, bl: 2, layout: 2, font: 2, color: 2, bgcolor: 2,\n   cellformat: 2, nontextvalueformat: 2, textvalueformat: 2, colspan: 2, rowspan: 2,\n   cssc: 2, csss: 2, mod: 2,\n   displaystring: 3, // used to cache rendered HTML of cell contents\n   parseinfo: 3, // used to cache parsed formulas\n   hcolspan: 3, hrowspan: 3 // spans taking hidden cols/rows into account (!!! NOT YET !!!)\n   };\n\nSocialCalc.CellPropertiesTable = {\n   bt: \"borderstyle\", br: \"borderstyle\", bb: \"borderstyle\", bl: \"borderstyle\",\n   layout: \"layout\", font: \"font\", color: \"color\", bgcolor: \"color\",\n   cellformat: \"cellformat\", nontextvalueformat: \"valueformat\", textvalueformat: \"valueformat\"\n   };\n\n// *************************************\n//\n// Sheet class:\n//\n// *************************************\n\n//\n// Class SocialCalc.Sheet\n//\n// Usage: var s = new SocialCalc.Sheet();\n//\n\nSocialCalc.Sheet = function() {\n\n   SocialCalc.ResetSheet(this);\n\n   // Set other values:\n   //\n   // sheet.statuscallback(data, status, arg, this.statuscallbackparams) is called\n   // during recalc and commands.\n   //\n   // During recalc, data is the current recalcdata.\n   // The values for status and the corresponding arg are:\n   //\n   //    calcorder, {coord: coord, total: celllist length, count: count} [0 or more times per recalc]\n   //    calccheckdone, calclist length [once per recalc]\n   //    calcstep, {coord: coord, total: calclist length, count: count} [0 or more times per recalc]\n   //    calcloading, {sheetname: name-of-sheet}\n   //    calcserverfunc, {funcname: name-of-function, coord: coord, total: calclist length, count: count}\n   //    calcfinished, time in milliseconds [once per recalc]\n   //\n   // During commands, data is SocialCalc.SheetCommandInfo.\n   // These values for status and arg are:\n   //\n   //    cmdstart, cmdstr\n   //    cmdend\n   //\n\n   this.statuscallback = null; // routine called with cmdstart, calcstart, etc., status and args:\n                                // sheet.statuscallback(data, status, arg, params)\n   this.statuscallbackparams = null; // parameters passed to that routine\n\n   }\n\n//\n// SocialCalc.ResetSheet(sheet)\n//\n// Resets (and/or initializes) sheet data values.\n// \n\nSocialCalc.ResetSheet = function(sheet, reload) {\n\n   // properties:\n\n   sheet.cells = {}; // at least one for each non-blank cell: coord: cell-object\n   sheet.attribs = // sheet attributes\n      {\n         lastcol: 1,\n         lastrow: 1,\n         defaultlayout: 0\n      };\n   sheet.rowattribs =\n      {\n         hide: {}, // access by row number\n         height: {}\n      };\n   sheet.colattribs =\n      {\n         width: {}, // access by col name\n         hide: {}\n      };\n   sheet.names={}; // Each is: {desc: \"optional description\", definition: \"B5, A1:B7, or =formula\"}\n   sheet.layouts=[];\n   sheet.layouthash={};\n   sheet.fonts=[];\n   sheet.fonthash={};\n   sheet.colors=[];\n   sheet.colorhash={};\n   sheet.borderstyles=[];\n   sheet.borderstylehash={};\n   sheet.cellformats=[];\n   sheet.cellformathash={};\n   sheet.valueformats=[];\n   sheet.valueformathash={};\n\n   sheet.copiedfrom = \"\"; // if a range, then this was loaded from a saved range as clipboard content\n\n   sheet.changes = new SocialCalc.UndoStack();\n\n   sheet.renderneeded = false;\n\n   sheet.changedrendervalues = true; // if true, spans and/or fonts have changed (set by ExecuteSheetCommand & GetStyle)\n\n   sheet.recalcchangedavalue = false; // true if a recalc resulted in a change to a cell's calculated value\n\n   }\n\n// Methods:\n\nSocialCalc.Sheet.prototype.ResetSheet = function() {SocialCalc.ResetSheet(this);};\nSocialCalc.Sheet.prototype.AddCell = function(newcell) {return this.cells[newcell.coord]=newcell;};\nSocialCalc.Sheet.prototype.GetAssuredCell = function(coord) {\n   return this.cells[coord] || this.AddCell(new SocialCalc.Cell(coord));\n   };\nSocialCalc.Sheet.prototype.ParseSheetSave = function(savedsheet) {SocialCalc.ParseSheetSave(savedsheet,this);};\nSocialCalc.Sheet.prototype.CellFromStringParts = function(cell, parts, j) {return SocialCalc.CellFromStringParts(this, cell, parts, j);};\nSocialCalc.Sheet.prototype.CreateSheetSave = function(range, canonicalize) {return SocialCalc.CreateSheetSave(this, range, canonicalize);};\nSocialCalc.Sheet.prototype.CellToString = function(cell) {return SocialCalc.CellToString(this, cell);};\nSocialCalc.Sheet.prototype.CanonicalizeSheet = function(full) {return SocialCalc.CanonicalizeSheet(this, full);};\nSocialCalc.Sheet.prototype.EncodeCellAttributes = function(coord) {return SocialCalc.EncodeCellAttributes(this, coord);};\nSocialCalc.Sheet.prototype.EncodeSheetAttributes = function() {return SocialCalc.EncodeSheetAttributes(this);};\nSocialCalc.Sheet.prototype.DecodeCellAttributes = function(coord, attribs, range) {return SocialCalc.DecodeCellAttributes(this, coord, attribs, range);};\nSocialCalc.Sheet.prototype.DecodeSheetAttributes = function(attribs) {return SocialCalc.DecodeSheetAttributes(this, attribs);};\n\nSocialCalc.Sheet.prototype.ScheduleSheetCommands = function(cmd, saveundo, isRemote) {return SocialCalc.ScheduleSheetCommands(this, cmd, saveundo, isRemote);};\nSocialCalc.Sheet.prototype.SheetUndo = function() {return SocialCalc.SheetUndo(this);};\nSocialCalc.Sheet.prototype.SheetRedo = function() {return SocialCalc.SheetRedo(this);};\nSocialCalc.Sheet.prototype.CreateAuditString = function() {return SocialCalc.CreateAuditString(this);};\nSocialCalc.Sheet.prototype.GetStyleNum = function(atype, style) {return SocialCalc.GetStyleNum(this, atype, style);};\nSocialCalc.Sheet.prototype.GetStyleString = function(atype, num) {return SocialCalc.GetStyleString(this, atype, num);};\nSocialCalc.Sheet.prototype.RecalcSheet = function() {return SocialCalc.RecalcSheet(this);};\n\n//\n// Sheet save format:\n//\n// linetype:param1:param2:...\n//\n// Linetypes are:\n//\n//    version:versionname - version of this format. Currently 1.4.\n//\n//    cell:coord:type:value...:type:value... - Types are as follows:\n//\n//       v:value - straight numeric value\n//       t:value - straight text/wiki-text in cell, encoded to handle \\, :, newlines\n//       vt:fulltype:value - value with value type/subtype\n//       vtf:fulltype:value:formulatext - formula resulting in value with value type/subtype, value and text encoded\n//       vtc:fulltype:value:valuetext - formatted text constant resulting in value with value type/subtype, value and text encoded\n//       vf:fvalue:formulatext - formula resulting in value, value and text encoded (obsolete: only pre format version 1.1)\n//          fvalue - first char is \"N\" for numeric value, \"T\" for text value, \"H\" for HTML value, rest is the value\n//       e:errortext - Error text. Non-blank means formula parsing/calculation results in error.\n//       b:topborder#:rightborder#:bottomborder#:leftborder# - border# in sheet border list or blank if none\n//       l:layout# - number in cell layout list\n//       f:font# - number in sheet fonts list\n//       c:color# - sheet color list index for text\n//       bg:color# - sheet color list index for background color\n//       cf:format# - sheet cell format number for explicit format (align:left, etc.)\n//       cvf:valueformat# - sheet cell value format number (obsolete: only pre format v1.2)\n//       tvf:valueformat# - sheet cell text value format number\n//       ntvf:valueformat# - sheet cell non-text value format number\n//       colspan:numcols - number of columns spanned in merged cell\n//       rowspan:numrows - number of rows spanned in merged cell\n//       cssc:classname - name of CSS class to be used for cell when published instead of one calculated here\n//       csss:styletext - explicit CSS style information, encoded to handle :, etc.\n//       mod:allow - if \"y\" allow modification of cell for live \"view\" recalc\n//       comment:value - encoded text of comment for this cell (added in v1.5)\n//\n//    col:\n//       w:widthval - number, \"auto\" (no width in <col> tag), number%, or blank (use default)\n//       hide: - yes/no, no is assumed if missing\n//    row:\n//       hide - yes/no, no is assumed if missing\n//\n//    sheet:\n//       c:lastcol - number\n//       r:lastrow - number\n//       w:defaultcolwidth - number, \"auto\", number%, or blank (default->80)\n//       h:defaultrowheight - not used\n//       tf:format# - cell format number for sheet default for text values\n//       ntf:format# - cell format number for sheet default for non-text values (i.e., numbers)\n//       layout:layout# - default cell layout number in cell layout list\n//       font:font# - default font number in sheet font list\n//       vf:valueformat# - default number value format number in sheet valueformat list (obsolete: only pre format version 1.2)\n//       ntvf:valueformat# - default non-text (number) value format number in sheet valueformat list\n//       tvf:valueformat# - default text value format number in sheet valueformat list\n//       color:color# - default number for text color in sheet color list\n//       bgcolor:color# - default number for background color in sheet color list\n//       circularreferencecell:coord - cell coord with a circular reference\n//       recalc:value - on/off (on is default). If not \"off\", appropriate changes to the sheet cause a recalc\n//       needsrecalc:value - yes/no (no is default). If \"yes\", formula values are not up to date\n//\n//    name:name:description:value - name definition, name in uppercase, with value being \"B5\", \"A1:B7\", or \"=formula\";\n//                                  description and value are encoded.\n//    font:fontnum:value - text of font definition (style weight size family) for font fontnum\n//                         \"*\" for \"style weight\", size, or family, means use default (first look to sheet, then builtin)\n//    color:colornum:rgbvalue - text of color definition (e.g., rgb(255,255,255)) for color colornum\n//    border:bordernum:value - text of border definition (thickness style color) for border bordernum\n//    layout:layoutnum:value - text of vertical alignment and padding style for cell layout layoutnum (* for default):\n//                             vertical-alignment:vavalue;padding:topval rightval bottomval leftval;\n//    cellformat:cformatnum:value - text of cell alignment (left/center/right) for cellformat cformatnum\n//    valueformat:vformatnum:value - text of number format (see FormatValueForDisplay) for valueformat vformatnum (changed in v1.2)\n//    clipboardrange:upperleftcoord:bottomrightcoord - ignored -- from wikiCalc\n//    clipboard:coord:type:value:... - ignored -- from wikiCalc\n//\n// If this is clipboard contents, then there is also information to facilitate pasting:\n//\n//    copiedfrom:upperleftcoord:bottomrightcoord - range from which this was copied\n//\n\n// Functions:\n\nSocialCalc.ParseSheetSave = function(savedsheet,sheetobj) {\n\n   var lines=savedsheet.split(/\\r\\n|\\n/);\n   var parts=[];\n   var line;\n   var i, j, t, v, coord, cell, attribs, name;\n   var scc = SocialCalc.Constants;\n\n   for (i=0;i<lines.length;i++) {\n      line=lines[i];\n      parts = line.split(\":\");\n      switch (parts[0]) {\n         case \"cell\":\n            cell=sheetobj.GetAssuredCell(parts[1]);\n            j=2;\n            sheetobj.CellFromStringParts(cell, parts, j);\n            break;\n\n         case \"col\":\n            coord=parts[1];\n            j=2;\n            while (t=parts[j++]) {\n               switch (t) {\n                  case \"w\":\n                     sheetobj.colattribs.width[coord]=parts[j++]; // must be text - could be auto or %, etc.\n                     break;\n                  case \"hide\":\n                     sheetobj.colattribs.hide[coord]=parts[j++];\n                     break;\n                  default:\n                     throw scc.s_pssUnknownColType+\" '\"+t+\"'\";\n                     break;\n                  }\n               }\n            break;\n\n         case \"row\":\n            coord=parts[1]-0;\n            j=2;\n            while (t=parts[j++]) {\n               switch (t) {\n                  case \"h\":\n                     sheetobj.rowattribs.height[coord]=parts[j++]-0;\n                     break;\n                  case \"hide\":\n                     sheetobj.rowattribs.hide[coord]=parts[j++];\n                     break;\n                  default:\n                     throw scc.s_pssUnknownRowType+\" '\"+t+\"'\";\n                     break;\n                  }\n               }\n            break;\n\n         case \"sheet\":\n            attribs=sheetobj.attribs;\n            j=1;\n            while (t=parts[j++]) {\n               switch (t) {\n                  case \"c\":\n                     attribs.lastcol=parts[j++]-0;\n                     break;\n                  case \"r\":\n                     attribs.lastrow=parts[j++]-0;\n                     break;\n                  case \"w\":\n                     attribs.defaultcolwidth=parts[j++]+\"\";\n                     break;\n                  case \"h\":\n                     attribs.defaultrowheight=parts[j++]-0;\n                     break;\n                  case \"tf\":\n                     attribs.defaulttextformat=parts[j++]-0;\n                     break;\n                  case \"ntf\":\n                     attribs.defaultnontextformat=parts[j++]-0;\n                     break;\n                  case \"layout\":\n                     attribs.defaultlayout=parts[j++]-0;\n                     break;\n                  case \"font\":\n                     attribs.defaultfont=parts[j++]-0;\n                     break;\n                  case \"tvf\":\n                     attribs.defaulttextvalueformat=parts[j++]-0;\n                     break;\n                  case \"ntvf\":\n                     attribs.defaultnontextvalueformat=parts[j++]-0;\n                     break;\n                  case \"color\":\n                     attribs.defaultcolor=parts[j++]-0;\n                     break;\n                  case \"bgcolor\":\n                     attribs.defaultbgcolor=parts[j++]-0;\n                     break;\n                  case \"circularreferencecell\":\n                     attribs.circularreferencecell=parts[j++];\n                     break;\n                  case \"recalc\":\n                     attribs.recalc=parts[j++];\n                     break;\n                  case \"needsrecalc\":\n                     attribs.needsrecalc=parts[j++];\n                     break;\n                  default:\n                     j+=1;\n                     break;\n                  }\n               }\n            break;\n\n         case \"name\":\n            name = SocialCalc.decodeFromSave(parts[1]).toUpperCase();\n            sheetobj.names[name] = {desc: SocialCalc.decodeFromSave(parts[2])};\n            sheetobj.names[name].definition = SocialCalc.decodeFromSave(parts[3]);\n            break;\n\n         case \"layout\":\n            parts=lines[i].match(/^layout\\:(\\d+)\\:(.+)$/); // layouts can have \":\" in them\n            sheetobj.layouts[parts[1]-0]=parts[2];\n            sheetobj.layouthash[parts[2]]=parts[1]-0;\n            break;\n\n         case \"font\":\n            sheetobj.fonts[parts[1]-0]=parts[2];\n            sheetobj.fonthash[parts[2]]=parts[1]-0;\n            break;\n\n         case \"color\":\n            sheetobj.colors[parts[1]-0]=parts[2];\n            sheetobj.colorhash[parts[2]]=parts[1]-0;\n            break;\n\n         case \"border\":\n            sheetobj.borderstyles[parts[1]-0]=parts[2];\n            sheetobj.borderstylehash[parts[2]]=parts[1]-0;\n            break;\n\n         case \"cellformat\":\n            v=SocialCalc.decodeFromSave(parts[2]);\n            sheetobj.cellformats[parts[1]-0]=v;\n            sheetobj.cellformathash[v]=parts[1]-0;\n            break;\n\n         case \"valueformat\":\n            v=SocialCalc.decodeFromSave(parts[2]);\n            sheetobj.valueformats[parts[1]-0]=v;\n            sheetobj.valueformathash[v]=parts[1]-0;\n            break;\n\n         case \"version\":\n            break;\n\n         case \"copiedfrom\":\n            sheetobj.copiedfrom = parts[1]+\":\"+parts[2];\n            break;\n\n         case \"clipboardrange\": // in save versions up to 1.3. Ignored.\n         case \"clipboard\":\n            break;\n\n         case \"\":\n            break;\n\n         default:\nalert(scc.s_pssUnknownLineType+\" '\"+parts[0]+\"'\");\n            throw scc.s_pssUnknownLineType+\" '\"+parts[0]+\"'\";\n            break;\n         }\n      parts = null;\n      }\n\n   }\n\n//\n// SocialCalc.CellFromStringParts(sheet, cell, parts, j)\n//\n// Takes string that has been split by \":\" in parts, starting at item j,\n// and fills in cell assuming save format.\n//\n\nSocialCalc.CellFromStringParts = function(sheet, cell, parts, j) {\n\n   var cell, t, v;\n\n   while (t=parts[j++]) {\n      switch (t) {\n         case \"v\":\n            cell.datavalue=SocialCalc.decodeFromSave(parts[j++])-0;\n            cell.datatype=\"v\";\n            cell.valuetype=\"n\";\n            break;\n         case \"t\":\n            cell.datavalue=SocialCalc.decodeFromSave(parts[j++]);\n            cell.datatype=\"t\";\n            cell.valuetype=SocialCalc.Constants.textdatadefaulttype; \n            break;\n         case \"vt\":\n            v=parts[j++];\n            cell.valuetype=v;\n            if (v.charAt(0)==\"n\") {\n               cell.datatype=\"v\";\n               cell.datavalue=SocialCalc.decodeFromSave(parts[j++])-0;\n               }\n            else {\n               cell.datatype=\"t\";\n               cell.datavalue=SocialCalc.decodeFromSave(parts[j++]);\n               }\n            break;\n         case \"vtf\":\n            v=parts[j++];\n            cell.valuetype=v;\n            if (v.charAt(0)==\"n\") {\n               cell.datavalue=SocialCalc.decodeFromSave(parts[j++])-0;\n               }\n            else {\n               cell.datavalue=SocialCalc.decodeFromSave(parts[j++]);\n               }\n            cell.formula=SocialCalc.decodeFromSave(parts[j++]);\n            cell.datatype=\"f\";\n            break;\n         case \"vtc\":\n            v=parts[j++];\n            cell.valuetype=v;\n            if (v.charAt(0)==\"n\") {\n               cell.datavalue=SocialCalc.decodeFromSave(parts[j++])-0;\n               }\n            else {\n               cell.datavalue=SocialCalc.decodeFromSave(parts[j++]);\n               }\n            cell.formula=SocialCalc.decodeFromSave(parts[j++]);\n            cell.datatype=\"c\";\n            break;\n         case \"e\":\n            cell.errors=SocialCalc.decodeFromSave(parts[j++]);\n            break;\n         case \"b\":\n            cell.bt=parts[j++]-0;\n            cell.br=parts[j++]-0;\n            cell.bb=parts[j++]-0;\n            cell.bl=parts[j++]-0;\n            break;\n         case \"l\":\n            cell.layout=parts[j++]-0;\n            break;\n         case \"f\":\n            cell.font=parts[j++]-0;\n            break;\n         case \"c\":\n            cell.color=parts[j++]-0;\n            break;\n         case \"bg\":\n            cell.bgcolor=parts[j++]-0;\n            break;\n         case \"cf\":\n            cell.cellformat=parts[j++]-0;\n            break;\n         case \"ntvf\":\n            cell.nontextvalueformat=parts[j++]-0;\n            break;\n         case \"tvf\":\n            cell.textvalueformat=parts[j++]-0;\n            break;\n         case \"colspan\":\n            cell.colspan=parts[j++]-0;\n            break;\n         case \"rowspan\":\n            cell.rowspan=parts[j++]-0;\n            break;\n         case \"cssc\":\n            cell.cssc=parts[j++];\n            break;\n         case \"csss\":\n            cell.csss=SocialCalc.decodeFromSave(parts[j++]);\n            break;\n         case \"mod\":\n            j+=1;\n            break;\n         case \"comment\":\n            cell.comment=SocialCalc.decodeFromSave(parts[j++]);\n            break;\n         default:\n            throw SocialCalc.Constants.s_cfspUnknownCellType+\" '\"+t+\"'\";\n            break;\n         }\n      }\n\n   }\n\n\nSocialCalc.sheetfields = [\"defaultrowheight\", \"defaultcolwidth\", \"circularreferencecell\", \"recalc\", \"needsrecalc\"];\nSocialCalc.sheetfieldsshort = [\"h\", \"w\", \"circularreferencecell\", \"recalc\", \"needsrecalc\"];\n\nSocialCalc.sheetfieldsxlat = [\"defaulttextformat\", \"defaultnontextformat\",\n                              \"defaulttextvalueformat\", \"defaultnontextvalueformat\",\n                              \"defaultcolor\", \"defaultbgcolor\", \"defaultfont\", \"defaultlayout\"];\nSocialCalc.sheetfieldsxlatshort = [\"tf\", \"ntf\", \"tvf\", \"ntvf\", \"color\", \"bgcolor\", \"font\", \"layout\"];\nSocialCalc.sheetfieldsxlatxlt = [\"cellformat\", \"cellformat\", \"valueformat\", \"valueformat\",\n                                  \"color\", \"color\", \"font\", \"layout\"];\n\n//\n// sheetstr = SocialCalc.CreateSheetSave(sheetobj, range, canonicalize)\n//\n// Creates a text representation of the sheetobj data.\n// If the range is present then only those cells are saved\n// (as clipboard data with \"copiedfrom\" set).\n//\n\nSocialCalc.CreateSheetSave = function(sheetobj, range, canonicalize) {\n\n   var cell, cr1, cr2, row, col, coord, attrib, line, value, formula, i, t, r, b, l, name, blanklen;\n   var result=[];\n\n   var prange;\n\n   sheetobj.CanonicalizeSheet(canonicalize || SocialCalc.Constants.doCanonicalizeSheet);\n   var xlt = sheetobj.xlt;\n\n   if (range) {\n      prange = SocialCalc.ParseRange(range);\n      }\n   else {\n      prange = {cr1: {row: 1, col:1},\n                cr2: {row: xlt.maxrow, col: xlt.maxcol}};\n      }\n   cr1 = prange.cr1;\n   cr2 = prange.cr2;\n\n   result.push(\"version:1.5\");\n\n   for (row=cr1.row; row <= cr2.row; row++) {\n      for (col=cr1.col; col <= cr2.col; col++) {\n         coord = SocialCalc.crToCoord(col, row);\n         cell=sheetobj.cells[coord];\n         if (!cell) continue;\n         line=sheetobj.CellToString(cell);\n         if (line.length==0) continue; // ignore completely empty cells\n         line=\"cell:\"+coord+line;\n         result.push(line);\n         }\n      }\n\n   for (col=1; col <= xlt.maxcol; col++) {\n      coord = SocialCalc.rcColname(col);\n      if (sheetobj.colattribs.width[coord])\n         result.push(\"col:\"+coord+\":w:\"+sheetobj.colattribs.width[coord]);\n      if (sheetobj.colattribs.hide[coord])\n         result.push(\"col:\"+coord+\":hide:\"+sheetobj.colattribs.hide[coord]);\n      }\n\n   for (row=1; row <= xlt.maxrow; row++) {\n      if (sheetobj.rowattribs.height[row])\n         result.push(\"row:\"+row+\":h:\"+sheetobj.rowattribs.height[row]);\n      if (sheetobj.rowattribs.hide[row])\n         result.push(\"row:\"+row+\":hide:\"+sheetobj.rowattribs.hide[row]);\n      }\n\n   line=\"sheet:c:\"+xlt.maxcol+\":r:\"+xlt.maxrow;\n\n   for (i=0; i<SocialCalc.sheetfields.length; i++) { // non-xlated values\n      value = SocialCalc.encodeForSave(sheetobj.attribs[SocialCalc.sheetfields[i]]);\n      if (value) line+=\":\"+SocialCalc.sheetfieldsshort[i]+\":\"+value;\n      }\n   for (i=0; i<SocialCalc.sheetfieldsxlat.length; i++) { // xlated values\n      value = sheetobj.attribs[SocialCalc.sheetfieldsxlat[i]];\n      if (value) line+=\":\"+SocialCalc.sheetfieldsxlatshort[i]+\":\"+xlt[SocialCalc.sheetfieldsxlatxlt[i]+\"sxlat\"][value];\n      }\n\n   result.push(line);\n\n   for (i=1;i<xlt.newborderstyles.length;i++) {\n      result.push(\"border:\"+i+\":\"+xlt.newborderstyles[i]);\n      }\n\n   for (i=1;i<xlt.newcellformats.length;i++) {\n      result.push(\"cellformat:\"+i+\":\"+SocialCalc.encodeForSave(xlt.newcellformats[i]));\n      }\n\n   for (i=1;i<xlt.newcolors.length;i++) {\n      result.push(\"color:\"+i+\":\"+xlt.newcolors[i]);\n      }\n\n   for (i=1;i<xlt.newfonts.length;i++) {\n      result.push(\"font:\"+i+\":\"+xlt.newfonts[i]);\n      }\n\n   for (i=1;i<xlt.newlayouts.length;i++) {\n      result.push(\"layout:\"+i+\":\"+xlt.newlayouts[i]);\n      }\n\n   for (i=1;i<xlt.newvalueformats.length;i++) {\n      result.push(\"valueformat:\"+i+\":\"+SocialCalc.encodeForSave(xlt.newvalueformats[i]));\n      }\n\n   for (i=0; i<xlt.namesorder.length; i++) {\n      name = xlt.namesorder[i];\n      result.push(\"name:\"+SocialCalc.encodeForSave(name).toUpperCase()+\":\"+\n                   SocialCalc.encodeForSave(sheetobj.names[name].desc)+\":\"+\n                   SocialCalc.encodeForSave(sheetobj.names[name].definition));\n      }\n\n   if (range) {\n      result.push(\"copiedfrom:\"+SocialCalc.crToCoord(cr1.col, cr1.row)+\":\"+\n                  SocialCalc.crToCoord(cr2.col, cr2.row));\n      }\n\n   result.push(\"\"); // one extra to get extra \\n\n\n   delete sheetobj.xlt; // clean up\n\n   return result.join(\"\\n\");\n   }\n\n//\n// line = SocialCalc.CellToString(sheet, cell)\n//\n\nSocialCalc.CellToString = function(sheet, cell) {\n\n   var cell, line, value, formula, t, r, b, l, xlt;\n\n   line = \"\";\n\n   if (!cell) return line;\n\n   value = SocialCalc.encodeForSave(cell.datavalue);\n   if (cell.datatype==\"v\") {\n      if (cell.valuetype==\"n\") line += \":v:\"+value;\n      else line += \":vt:\"+cell.valuetype+\":\"+value;\n      }\n   else if (cell.datatype==\"t\") {\n      if (cell.valuetype==SocialCalc.Constants.textdatadefaulttype)\n         line += \":t:\"+value;\n      else line += \":vt:\"+cell.valuetype+\":\"+value;\n      }\n   else {\n      formula = SocialCalc.encodeForSave(cell.formula);\n      if (cell.datatype==\"f\") {\n         line += \":vtf:\"+cell.valuetype+\":\"+value+\":\"+formula;\n         }\n      else if (cell.datatype==\"c\") {\n         line += \":vtc:\"+cell.valuetype+\":\"+value+\":\"+formula;\n         }\n      }\n   if (cell.errors) {\n      line += \":e:\"+SocialCalc.encodeForSave(cell.errors);\n      }\n   t = cell.bt || \"\";\n   r = cell.br || \"\";\n   b = cell.bb || \"\";\n   l = cell.bl || \"\";\n\n   if (sheet.xlt) { // if have canonical save info\n      xlt = sheet.xlt;\n      if (t || r || b || l)\n      line += \":b:\"+xlt.borderstylesxlat[t||0]+\":\"+xlt.borderstylesxlat[r||0]+\":\"+xlt.borderstylesxlat[b||0]+\":\"+xlt.borderstylesxlat[l||0];\n      if (cell.layout) line += \":l:\"+xlt.layoutsxlat[cell.layout];\n      if (cell.font) line += \":f:\"+xlt.fontsxlat[cell.font];\n      if (cell.color) line += \":c:\"+xlt.colorsxlat[cell.color];\n      if (cell.bgcolor) line += \":bg:\"+xlt.colorsxlat[cell.bgcolor];\n      if (cell.cellformat) line += \":cf:\"+xlt.cellformatsxlat[cell.cellformat];\n      if (cell.textvalueformat) line += \":tvf:\"+xlt.valueformatsxlat[cell.textvalueformat];\n      if (cell.nontextvalueformat) line += \":ntvf:\"+xlt.valueformatsxlat[cell.nontextvalueformat];\n      }\n   else {\n      if (t || r || b || l)\n      line += \":b:\"+t+\":\"+r+\":\"+b+\":\"+l;\n      if (cell.layout) line += \":l:\"+cell.layout;\n      if (cell.font) line += \":f:\"+cell.font;\n      if (cell.color) line += \":c:\"+cell.color;\n      if (cell.bgcolor) line += \":bg:\"+cell.bgcolor;\n      if (cell.cellformat) line += \":cf:\"+cell.cellformat;\n      if (cell.textvalueformat) line += \":tvf:\"+cell.textvalueformat;\n      if (cell.nontextvalueformat) line += \":ntvf:\"+cell.nontextvalueformat;\n      }\n   if (cell.colspan) line += \":colspan:\"+cell.colspan;\n   if (cell.rowspan) line += \":rowspan:\"+cell.rowspan;\n   if (cell.cssc) line += \":cssc:\"+cell.cssc;\n   if (cell.csss) line += \":csss:\"+SocialCalc.encodeForSave(cell.csss);\n   if (cell.mod) line += \":mod:\"+cell.mod;\n   if (cell.comment) line += \":comment:\"+SocialCalc.encodeForSave(cell.comment);\n\n   return line;\n\n   }\n\n//\n// SocialCalc.CanonicalizeSheet(sheetobj, full)\n//\n// Goes through the sheet and fills in sheetobj.xlt with the following:\n//\n//   .maxrow, .maxcol - lastrow and lastcol are as small as possible\n//   .newlayouts - new version of sheetobj.layouts without unused ones and all in ascending order\n//   .layoutsxlat - maps old layouts index to new one\n//   same \".new\" and \".xlat\" for fonts, colors, borderstyles, cell and value formats\n//   .namesorder - array with names sorted\n//\n// If full or SocialCalc.Constants.doCanonicalizeSheet are not true, then the values will leave things unchanged (to save time, etc.)\n//\n// sheetobj.xlt should be deleted when you are finished using it\n//\n\nSocialCalc.CanonicalizeSheet = function(sheetobj, full) {\n\n   var l, coord, cr, cell, filled, an, a, newa, newxlat, used, ahash, i, v;\n   var maxrow = 0;\n   var maxcol = 0;\n   var alist = [\"borderstyle\", \"cellformat\", \"color\", \"font\", \"layout\", \"valueformat\"];\n\n   var xlt = {};\n\n   xlt.namesorder = []; // always return a sorted list\n   for (a in sheetobj.names) {\n      xlt.namesorder.push(a);\n      }\n   xlt.namesorder.sort();\n\n   if (!SocialCalc.Constants.doCanonicalizeSheet || !full) { // return make-no-changes values if not wanted\n      for (an=0; an<alist.length; an++) {\n         a = alist[an];\n         xlt[\"new\"+a+\"s\"] = sheetobj[a+\"s\"];\n         l = sheetobj[a+\"s\"].length;\n         newxlat = new Array(l);\n         newxlat[0] = \"\";\n         for (i=1; i<l; i++) {\n            newxlat[i] = i;\n            }\n         xlt[a+\"sxlat\"] = newxlat;\n         }\n\n      xlt.maxrow = sheetobj.attribs.lastrow;\n      xlt.maxcol = sheetobj.attribs.lastcol;\n\n      sheetobj.xlt = xlt;\n\n      return;\n      }\n\n   for (an=0; an<alist.length; an++) {\n      a = alist[an];\n      xlt[a+\"sUsed\"] = {};\n      }\n\n   var colorsUsed = xlt.colorsUsed;\n   var borderstylesUsed = xlt.borderstylesUsed;\n   var fontsUsed = xlt.fontsUsed;\n   var layoutsUsed = xlt.layoutsUsed;\n   var cellformatsUsed = xlt.cellformatsUsed;\n   var valueformatsUsed = xlt.valueformatsUsed;\n\n   for (coord in sheetobj.cells) { // check all cells to see which values are used\n      cr = SocialCalc.coordToCr(coord);\n      cell = sheetobj.cells[coord];\n      filled = false;\n\n      if (cell.valuetype && cell.valuetype!=\"b\") filled = true;\n\n      if (cell.color) {\n         colorsUsed[cell.color] = 1;\n         filled = true;\n         }\n\n      if (cell.bgcolor) {\n         colorsUsed[cell.bgcolor] = 1;\n         filled = true;\n         }\n\n      if (cell.bt) {\n         borderstylesUsed[cell.bt] = 1;\n         filled = true;\n         }\n      if (cell.br) {\n         borderstylesUsed[cell.br] = 1;\n         filled = true;\n         }\n      if (cell.bb) {\n         borderstylesUsed[cell.bb] = 1;\n         filled = true;\n         }\n      if (cell.bl) {\n         borderstylesUsed[cell.bl] = 1;\n         filled = true;\n         }\n\n      if (cell.layout) {\n         layoutsUsed[cell.layout] = 1;\n         filled = true;\n         }\n\n      if (cell.font) {\n         fontsUsed[cell.font] = 1;\n         filled = true;\n         }\n\n      if (cell.cellformat) {\n         cellformatsUsed[cell.cellformat] = 1;\n         filled = true;\n         }\n\n      if (cell.textvalueformat) {\n         valueformatsUsed[cell.textvalueformat] = 1;\n         filled = true;\n         }\n\n      if (cell.nontextvalueformat) {\n         valueformatsUsed[cell.nontextvalueformat] = 1;\n         filled = true;\n         }\n\n      if (filled) {\n         if (cr.row > maxrow) maxrow = cr.row;\n         if (cr.col > maxcol) maxcol = cr.col;\n         }\n      }\n\n   for (i=0; i<SocialCalc.sheetfieldsxlat.length; i++) { // do sheet values, too\n      v = sheetobj.attribs[SocialCalc.sheetfieldsxlat[i]];\n      if (v) {\n         xlt[SocialCalc.sheetfieldsxlatxlt[i]+\"sUsed\"][v] = 1;\n         }\n      }\n\n   a = {\"height\": 1, \"hide\": 1}; // look at explicit row settings\n   for (v in a) {\n      for (cr in sheetobj.rowattribs[v]) {\n         if (cr > maxrow) maxrow = cr;\n         }\n      }\n   a = {\"hide\": 1, \"width\": 1}; // look at explicit col settings\n   for (v in a) {\n      for (coord in sheetobj.colattribs[v]) {\n         cr = SocialCalc.coordToCr(coord+\"1\");\n         if (cr.col > maxcol) maxcol = cr.col;\n         }\n      }\n\n   for (an=0; an<alist.length; an++) { // go through the attribs we want\n      a = alist[an];\n\n      newa = [];\n      used = xlt[a+\"sUsed\"];\n      for (v in used) {\n         newa.push(sheetobj[a+\"s\"][v]);\n         }\n      newa.sort();\n      newa.unshift(\"\");\n\n      newxlat = [\"\"];\n      ahash = sheetobj[a+\"hash\"];\n\n      for (i=1; i<newa.length; i++) {\n         newxlat[ahash[newa[i]]] = i;\n         }\n\n      xlt[a+\"sxlat\"] = newxlat;\n      xlt[\"new\"+a+\"s\"] = newa;\n\n      }\n\n   xlt.maxrow = maxrow || 1;\n   xlt.maxcol = maxcol || 1;\n\n   sheetobj.xlt = xlt; // leave for use by caller\n\n   }\n\n//\n// result = SocialCalc.EncodeCellAttributes(sheet, coord)\n//\n// Returns the cell's attributes in an object, each in the following form:\n//\n//    attribname: {def: true/false, val: full-value}\n//\n\nSocialCalc.EncodeCellAttributes = function(sheet, coord) {\n\n   var value, i, b, bb, parts;\n   var result = {};\n\n   var InitAttrib = function(name) {\n      result[name] = {def: true, val: \"\"};\n      }\n\n   var InitAttribs = function(namelist) {\n      for (var i=0; i<namelist.length; i++) {\n         InitAttrib(namelist[i]);\n         }\n      }\n\n   var SetAttrib = function(name, v) {\n      result[name].def = false;\n      result[name].val = v || \"\";\n      }\n\n   var SetAttribStar = function(name, v) {\n      if (v==\"*\") return;\n      result[name].def = false;\n      result[name].val = v;\n      }\n\n   var cell = sheet.GetAssuredCell(coord);\n\n   // cellformat: alignhoriz\n\n   InitAttrib(\"alignhoriz\");\n   if (cell.cellformat) {\n      SetAttrib(\"alignhoriz\", sheet.cellformats[cell.cellformat]);\n      }\n\n   // layout: alignvert, padtop, padright, padbottom, padleft\n\n   InitAttribs([\"alignvert\", \"padtop\", \"padright\", \"padbottom\", \"padleft\"]);\n   if (cell.layout) {\n      parts = sheet.layouts[cell.layout].match(/^padding:\\s*(\\S+)\\s+(\\S+)\\s+(\\S+)\\s+(\\S+);vertical-align:\\s*(\\S+);/);\n      SetAttribStar(\"padtop\", parts[1]);\n      SetAttribStar(\"padright\", parts[2]);\n      SetAttribStar(\"padbottom\", parts[3]);\n      SetAttribStar(\"padleft\", parts[4]);\n      SetAttribStar(\"alignvert\", parts[5]);\n      }\n\n   // font: fontfamily, fontlook, fontsize\n\n   InitAttribs([\"fontfamily\", \"fontlook\", \"fontsize\"]);\n   if (cell.font) {\n      parts = sheet.fonts[cell.font].match(/^(\\*|\\S+? \\S+?) (\\S+?) (\\S.*)$/);\n      SetAttribStar(\"fontfamily\", parts[3]);\n      SetAttribStar(\"fontsize\", parts[2]);\n      SetAttribStar(\"fontlook\", parts[1]);\n      }\n\n   // color: textcolor\n\n   InitAttrib(\"textcolor\");\n   if (cell.color) {\n      SetAttrib(\"textcolor\", sheet.colors[cell.color]);\n      }\n\n   // bgcolor: bgcolor\n\n   InitAttrib(\"bgcolor\");\n   if (cell.bgcolor) {\n      SetAttrib(\"bgcolor\", sheet.colors[cell.bgcolor]);\n      }\n\n   // formatting: numberformat, textformat\n\n   InitAttribs([\"numberformat\", \"textformat\"]);\n   if (cell.nontextvalueformat) {\n      SetAttrib(\"numberformat\", sheet.valueformats[cell.nontextvalueformat]);\n      }\n   if (cell.textvalueformat) {\n      SetAttrib(\"textformat\", sheet.valueformats[cell.textvalueformat]);\n      }\n\n   // merges: colspan, rowspan\n\n   InitAttribs([\"colspan\", \"rowspan\"]);\n   SetAttrib(\"colspan\", cell.colspan || 1);\n   SetAttrib(\"rowspan\", cell.rowspan || 1);\n\n   // borders: bXthickness, bXstyle, bXcolor for X = t, r, b, and l\n\n   for (i=0; i<4; i++) {\n      b = \"trbl\".charAt(i);\n      bb = \"b\"+b;\n      InitAttrib(bb);\n      SetAttrib(bb, cell[bb] ? sheet.borderstyles[cell[bb]] : \"\");\n      InitAttrib(bb+\"thickness\");\n      InitAttrib(bb+\"style\");\n      InitAttrib(bb+\"color\");\n      if (cell[bb]) {\n         parts = sheet.borderstyles[cell[bb]].match(/(\\S+)\\s+(\\S+)\\s+(\\S.+)/);\n         SetAttrib(bb+\"thickness\", parts[1]);\n         SetAttrib(bb+\"style\", parts[2]);\n         SetAttrib(bb+\"color\", parts[3]);\n         }\n      }\n \n   // misc: cssc, csss, mod\n\n   InitAttribs([\"cssc\", \"csss\", \"mod\"]);\n   SetAttrib(\"cssc\", cell.cssc || \"\"); \n   SetAttrib(\"csss\", cell.csss || \"\");\n   SetAttrib(\"mod\", cell.mod || \"n\");\n\n   return result;\n\n   }\n\n//\n// result = SocialCalc.EncodeSheetAttributes(sheet)\n//\n// Returns the sheet's attributes in an object, each in the following form:\n//\n//    attribname: {def: true/false, val: full-value}\n//\n\nSocialCalc.EncodeSheetAttributes = function(sheet) {\n\n   var value;\n   var attribs = sheet.attribs;\n   var result = {};\n\n   var InitAttrib = function(name) {\n      result[name] = {def: true, val: \"\"};\n      }\n\n   var InitAttribs = function(namelist) {\n      for (var i=0; i<namelist.length; i++) {\n         InitAttrib(namelist[i]);\n         }\n      }\n\n   var SetAttrib = function(name, v) {\n      result[name].def = false;\n      result[name].val = v || value;\n      }\n\n   var SetAttribStar = function(name, v) {\n      if (v==\"*\") return;\n      result[name].def = false;\n      result[name].val = v;\n      }\n\n   // sizes: colwidth, rowheight\n\n   InitAttrib(\"colwidth\");\n   if (attribs.defaultcolwidth) {\n      SetAttrib(\"colwidth\", attribs.defaultcolwidth);\n      }\n\n   InitAttrib(\"rowheight\");\n   if (attribs.rowheight) {\n      SetAttrib(\"rowheight\", attribs.defaultrowheight);\n      }\n\n   // cellformat: textalignhoriz, numberalignhoriz\n\n   InitAttrib(\"textalignhoriz\");\n   if (attribs.defaulttextformat) {\n      SetAttrib(\"textalignhoriz\", sheet.cellformats[attribs.defaulttextformat]);\n      }\n\n   InitAttrib(\"numberalignhoriz\");\n   if (attribs.defaultnontextformat) {\n      SetAttrib(\"numberalignhoriz\", sheet.cellformats[attribs.defaultnontextformat]);\n      }\n\n   // layout: alignvert, padtop, padright, padbottom, padleft\n\n   InitAttribs([\"alignvert\", \"padtop\", \"padright\", \"padbottom\", \"padleft\"]);\n   if (attribs.defaultlayout) {\n      parts = sheet.layouts[attribs.defaultlayout].match(/^padding:\\s*(\\S+)\\s+(\\S+)\\s+(\\S+)\\s+(\\S+);vertical-align:\\s*(\\S+);/);\n      SetAttribStar(\"padtop\", parts[1]);\n      SetAttribStar(\"padright\", parts[2]);\n      SetAttribStar(\"padbottom\", parts[3]);\n      SetAttribStar(\"padleft\", parts[4]);\n      SetAttribStar(\"alignvert\", parts[5]);\n      }\n\n   // font: fontfamily, fontlook, fontsize\n\n   InitAttribs([\"fontfamily\", \"fontlook\", \"fontsize\"]);\n   if (attribs.defaultfont) {\n      parts = sheet.fonts[attribs.defaultfont].match(/^(\\*|\\S+? \\S+?) (\\S+?) (\\S.*)$/);\n      SetAttribStar(\"fontfamily\", parts[3]);\n      SetAttribStar(\"fontsize\", parts[2]);\n      SetAttribStar(\"fontlook\", parts[1]);\n      }\n\n   // color: textcolor\n\n   InitAttrib(\"textcolor\");\n   if (attribs.defaultcolor) {\n      SetAttrib(\"textcolor\", sheet.colors[attribs.defaultcolor]);\n      }\n\n   // bgcolor: bgcolor\n\n   InitAttrib(\"bgcolor\");\n   if (attribs.defaultbgcolor) {\n      SetAttrib(\"bgcolor\", sheet.colors[attribs.defaultbgcolor]);\n      }\n\n   // formatting: numberformat, textformat\n\n   InitAttribs([\"numberformat\", \"textformat\"]);\n   if (attribs.defaultnontextvalueformat) {\n      SetAttrib(\"numberformat\", sheet.valueformats[attribs.defaultnontextvalueformat]);\n      }\n   if (attribs.defaulttextvalueformat) {\n      SetAttrib(\"textformat\", sheet.valueformats[attribs.defaulttextvalueformat]);\n      }\n\n   // recalc: recalc\n\n   InitAttrib(\"recalc\");\n   if (attribs.recalc) {\n      SetAttrib(\"recalc\", attribs.recalc);\n      }\n\n   return result;\n\n   }\n\n//\n// cmdstr = SocialCalc.DecodeCellAttributes(sheet, coord, attribs, range)\n//\n// Takes cell attributes in an object, each in the following form:\n//\n//    attribname: {def: true/false, val: full-value}\n//\n// and returns the sheet commands to make the actual attributes correspond.\n// Returns a non-null string if any commands are to be executed, null otherwise.\n//\n// If range is provided, the commands are executed on the whole range.\n//\n\nSocialCalc.DecodeCellAttributes = function(sheet, coord, newattribs, range) {\n\n   var value, b, bb;\n\n   var cell = sheet.GetAssuredCell(coord);\n\n   var changed = false;\n\n   var CheckChanges = function(attribname, oldval, cmdname) {\n      var val;\n      if (newattribs[attribname]) {\n         if (newattribs[attribname].def) {\n            val = \"\";\n            }\n         else {\n            val = newattribs[attribname].val;\n            }\n         if (val != (oldval || \"\")) {\n            DoCmd(cmdname+\" \"+val);\n            }\n         }\n      }\n\n   var cmdstr = \"\";\n\n   var DoCmd = function(str) {\n      if (cmdstr) cmdstr += \"\\n\";\n      cmdstr += \"set \"+(range || coord)+\" \"+str;\n      changed = true;\n      }\n\n   // cellformat: alignhoriz\n\n   CheckChanges(\"alignhoriz\", sheet.cellformats[cell.cellformat], \"cellformat\");\n\n   // layout: alignvert, padtop, padright, padbottom, padleft\n\n   if (!newattribs.alignvert.def || !newattribs.padtop.def || !newattribs.padright.def ||\n       !newattribs.padbottom.def || !newattribs.padleft.def) {\n      value = \"padding:\" +\n         (newattribs.padtop.def ? \"* \" : newattribs.padtop.val + \" \") +\n         (newattribs.padright.def ? \"* \" : newattribs.padright.val + \" \") +\n         (newattribs.padbottom.def ? \"* \" : newattribs.padbottom.val + \" \") +\n         (newattribs.padleft.def ? \"*\" : newattribs.padleft.val) +\n         \";vertical-align:\" +\n         (newattribs.alignvert.def ? \"*;\" : newattribs.alignvert.val+\";\");\n      }\n   else {\n      value = \"\";\n      }\n\n   if (value != (sheet.layouts[cell.layout] || \"\")) {\n      DoCmd(\"layout \"+value);\n      }\n\n   // font: fontfamily, fontlook, fontsize\n\n   if (!newattribs.fontlook.def || !newattribs.fontsize.def || !newattribs.fontfamily.def) {\n      value =\n         (newattribs.fontlook.def ? \"* \" : newattribs.fontlook.val + \" \") +\n         (newattribs.fontsize.def ? \"* \" : newattribs.fontsize.val + \" \") +\n         (newattribs.fontfamily.def ? \"*\" : newattribs.fontfamily.val);\n      }\n   else {\n      value = \"\";\n      }\n\n   if (value != (sheet.fonts[cell.font] || \"\")) {\n      DoCmd(\"font \"+value);\n      }\n\n   // color: textcolor\n\n   CheckChanges(\"textcolor\", sheet.colors[cell.color], \"color\");\n\n   // bgcolor: bgcolor\n\n   CheckChanges(\"bgcolor\", sheet.colors[cell.bgcolor], \"bgcolor\");\n\n   // formatting: numberformat, textformat\n\n   CheckChanges(\"numberformat\", sheet.valueformats[cell.nontextvalueformat], \"nontextvalueformat\");\n\n   CheckChanges(\"textformat\", sheet.valueformats[cell.textvalueformat], \"textvalueformat\");\n\n   // merges: colspan, rowspan - NOT HANDLED: IGNORED!\n\n   // borders: bX for X = t, r, b, and l; bXthickness, bXstyle, bXcolor ignored\n\n   for (var i=0; i<4; i++) {\n      b = \"trbl\".charAt(i);\n      bb = \"b\"+b;\n      CheckChanges(bb, sheet.borderstyles[cell[bb]], bb);\n      }\n\n   // misc: cssc, csss, mod\n\n   CheckChanges(\"cssc\", cell.cssc, \"cssc\");\n\n   CheckChanges(\"csss\", cell.csss, \"csss\");\n\n   if (newattribs.mod) {\n      if (newattribs.mod.def) {\n         value = \"n\";\n         }\n      else {\n         value = newattribs.mod.val;\n         }\n      if (value != (cell.mod || \"n\")) {\n         if (value==\"n\") value = \"\"; // restrict to \"y\" and \"\" normally\n         DoCmd(\"mod \"+value);\n         }\n      }\n\n   // if any changes return command(s)\n\n   if (changed) {\n       return cmdstr;\n      }\n   else {\n      return null;\n      }\n\n   }\n\n\n//\n// changed = SocialCalc.DecodeSheetAttributes(sheet, newattribs)\n//\n// Takes sheet attributes in an object, each in the following form:\n//\n//    attribname: {def: true/false, val: full-value}\n//\n// and returns the sheet commands to make the actual attributes correspond.\n// Returns a non-null string if any commands were executed, null otherwise.\n//\n\nSocialCalc.DecodeSheetAttributes = function(sheet, newattribs) {\n\n   var value;\n   var attribs = sheet.attribs;\n   var changed = false;\n\n   var CheckChanges = function(attribname, oldval, cmdname) {\n      var val;\n      if (newattribs[attribname]) {\n         if (newattribs[attribname].def) {\n            val = \"\";\n            }\n         else {\n            val = newattribs[attribname].val;\n            }\n         if (val != (oldval || \"\")) {\n            DoCmd(cmdname+\" \"+val);\n            }\n         }\n      }\n\n   var cmdstr = \"\";\n\n   var DoCmd = function(str) {\n      if (cmdstr) cmdstr += \"\\n\";\n      cmdstr += \"set sheet \"+str;\n      changed = true;\n      }\n\n   // sizes: colwidth, rowheight\n\n   CheckChanges(\"colwidth\", attribs.defaultcolwidth, \"defaultcolwidth\");\n\n   CheckChanges(\"rowheight\", attribs.defaultrowheight, \"defaultrowheight\");\n\n   // cellformat: textalignhoriz, numberalignhoriz\n\n   CheckChanges(\"textalignhoriz\", sheet.cellformats[attribs.defaulttextformat], \"defaulttextformat\");\n\n   CheckChanges(\"numberalignhoriz\", sheet.cellformats[attribs.defaultnontextformat], \"defaultnontextformat\");\n\n   // layout: alignvert, padtop, padright, padbottom, padleft\n\n   if (!newattribs.alignvert.def || !newattribs.padtop.def || !newattribs.padright.def ||\n       !newattribs.padbottom.def || !newattribs.padleft.def) {\n      value = \"padding:\" +\n         (newattribs.padtop.def ? \"* \" : newattribs.padtop.val + \" \") +\n         (newattribs.padright.def ? \"* \" : newattribs.padright.val + \" \") +\n         (newattribs.padbottom.def ? \"* \" : newattribs.padbottom.val + \" \") +\n         (newattribs.padleft.def ? \"*\" : newattribs.padleft.val) +\n         \";vertical-align:\" +\n         (newattribs.alignvert.def ? \"*;\" : newattribs.alignvert.val+\";\");\n      }\n   else {\n      value = \"\";\n      }\n\n   if (value != (sheet.layouts[attribs.defaultlayout] || \"\")) {\n      DoCmd(\"defaultlayout \"+value);\n      }\n\n   // font: fontfamily, fontlook, fontsize\n\n   if (!newattribs.fontlook.def || !newattribs.fontsize.def || !newattribs.fontfamily.def) {\n      value =\n         (newattribs.fontlook.def ? \"* \" : newattribs.fontlook.val + \" \") +\n         (newattribs.fontsize.def ? \"* \" : newattribs.fontsize.val + \" \") +\n         (newattribs.fontfamily.def ? \"*\" : newattribs.fontfamily.val);\n      }\n   else {\n      value = \"\";\n      }\n\n   if (value != (sheet.fonts[attribs.defaultfont] || \"\")) {\n      DoCmd(\"defaultfont \"+value);\n      }\n\n   // color: textcolor\n\n   CheckChanges(\"textcolor\", sheet.colors[attribs.defaultcolor], \"defaultcolor\");\n\n   // bgcolor: bgcolor\n\n   CheckChanges(\"bgcolor\", sheet.colors[attribs.defaultbgcolor], \"defaultbgcolor\");\n\n   // formatting: numberformat, textformat\n\n   CheckChanges(\"numberformat\", sheet.valueformats[attribs.defaultnontextvalueformat], \"defaultnontextvalueformat\");\n\n   CheckChanges(\"textformat\", sheet.valueformats[attribs.defaulttextvalueformat], \"defaulttextvalueformat\");\n\n   // recalc: recalc\n\n   CheckChanges(\"recalc\", sheet.attribs.recalc, \"recalc\");\n\n   // if any changes return command(s)\n\n   if (changed) {\n       return cmdstr;\n      }\n   else {\n      return null;\n      }\n\n   }\n\n// *************************************\n//\n// Sheet command routines\n//\n// *************************************\n\n//\n// SocialCalc.SheetCommandInfo - object with information used during command execution\n//\n\nSocialCalc.SheetCommandInfo = { // only one of these\n\n   sheetobj: null, // sheet being operated on\n   parseobj: null, // SocialCalc.Parse object with the command string, etc.\n   timerobj: null, // used for timeslicing\n   firsttimerdelay: 50, // wait before starting cmds (for Chrome - to give time to update)\n   timerdelay: 1, // wait between slices\n   maxtimeslice: 100, // do another slice after this many milliseconds\n   saveundo: false, // arg for ExecuteSheetCommand\n\n   CmdExtensionCallbacks: {}, // for startcmdextension, in form: cmdname, {func:function(cmdname, data, sheet, SocialCalc.Parse object, saveundo), data:whatever}\n   cmdextensionbusy: \"\" // if length>0, command loop waits for SocialCalc.ResumeFromCmdExtension()\n\n//   statuscallback: null, // called during execution - obsolete: use sheet obj's\n//   statuscallbackparams: null\n\n   };\n\n//\n// SocialCalc.ScheduleSheetCommands\n//\n// statuscallback is called at the beginning (cmdstart) and end (cmdend).\n//\n\nSocialCalc.ScheduleSheetCommands = function(sheet, cmdstr, saveundo, isRemote) {\n   if (SocialCalc.Callbacks.broadcast && !isRemote) {\n       if (cmdstr != 'redisplay' && cmdstr != 'set sheet defaulttextvalueformat text-wiki' &&\n     cmdstr != 'recalc') {\n           SocialCalc.Callbacks.broadcast('execute', { cmdtype:\"scmd\", id:sheet.sheetid,cmdstr: cmdstr, saveundo: saveundo });\n       }\n   }\n\n   var sci = SocialCalc.SheetCommandInfo;\n\n   sci.sheetobj = sheet;\n   sci.parseobj = new SocialCalc.Parse(cmdstr);\n   sci.saveundo = saveundo;\n\n   if (sci.sheetobj.statuscallback) { // notify others if requested\n      sheet.statuscallback(sci, \"cmdstart\", \"\", sci.sheetobj.statuscallbackparams);\n      }\n\n   if (sci.saveundo) {\n      sci.sheetobj.changes.PushChange(\"\"); // add a step to undo stack\n      }\n\n   sci.timerobj = window.setTimeout(SocialCalc.SheetCommandsTimerRoutine, sci.firsttimerdelay);\n\n   }\n\nSocialCalc.SheetCommandsTimerRoutine = function() {\n\n   var errortext;\n   var sci = SocialCalc.SheetCommandInfo;\n   var starttime = new Date();\n\n   sci.timerobj = null;\n\n   while (!sci.parseobj.EOF()) { // go through all commands (separated by newlines)\n\n      errortext = SocialCalc.ExecuteSheetCommand(sci.sheetobj, sci.parseobj, sci.saveundo);\n      if (errortext) alert(errortext);\n\n      sci.parseobj.NextLine();\n\n      if (sci.cmdextensionbusy.length > 0) { // forced wait\n         if (sci.sheetobj.statuscallback) { // notify others if requested\n            sci.sheetobj.statuscallback(sci, \"cmdextension\", sci.cmdextensionbusy, sci.sheetobj.statuscallbackparams);\n            }\n         return;\n         }\n\n      if (((new Date()) - starttime) >= sci.maxtimeslice) { // if taking too long, give up CPU for a while\n         sci.timerobj = window.setTimeout(SocialCalc.SheetCommandsTimerRoutine, sci.timerdelay);\n         return;\n         }\n      }\n\n   if (sci.sheetobj.statuscallback) { // notify others if requested\n      sci.sheetobj.statuscallback(sci, \"cmdend\", \"\", sci.sheetobj.statuscallbackparams);\n      }\n\n   }\n\nSocialCalc.ResumeFromCmdExtension = function() {\n\n   var sci = SocialCalc.SheetCommandInfo;\n\n   sci.cmdextensionbusy = \"\";\n\n   SocialCalc.SheetCommandsTimerRoutine();\n\n}\n\n//\n// errortext = SocialCalc.ExecuteSheetCommand(sheet, cmd, saveundo)\n//\n// cmd is a SocialCalc.Parse object.\n//\n// Executes commands that modify the sheet data.\n// Sets sheet \"needsrecalc\" as needed.\n// Sets sheet \"changedrendervalues\" as needed.\n//\n// The cmd string may be multiple commands, separated by newlines. In that case\n// only one \"step\" is put on the undo stack representing all the commands.\n// Note that because of this, in \"set A1 text ...\" and \"set A1 comment ...\" text is\n// treated as encoded (newline => \\n, \\ => \\b, : => \\c).\n//\n// The commands are in the forms:\n//\n//    set sheet attributename value (plus lastcol and lastrow)\n//    set 22 attributename value\n//    set B attributename value\n//    set A1 attributename value1 value2... (see each attribute in code for details)\n//    set A1:B5 attributename value1 value2...\n//    erase/copy/cut/paste/fillright/filldown A1:B5 all/formulas/format\n//    loadclipboard save-encoded-clipboard-data\n//    clearclipboard\n//    merge C3:F3\n//    unmerge C3\n//    insertcol/insertrow C5\n//    deletecol/deleterow C5:E7\n//    movepaste/moveinsert A1:B5 A8 all/formulas/format (if insert, destination must be in same rows or columns or else paste done)\n//    sort cr1:cr2 col1 up/down col2 up/down col3 up/down\n//    name define NAME definition\n//    name desc NAME description\n//    name delete NAME\n//    recalc\n//    redisplay\n//    changedrendervalues\n//    startcmdextension extension rest-of-command\n//\n// If saveundo is true, then undo information is saved in sheet.changes.\n//\n\nSocialCalc.ExecuteSheetCommand = function(sheet, cmd, saveundo) {\n\n   var cmdstr, cmd1, rest, what, attrib, num, pos, pos2, errortext, undostart, val;\n   var cr1, cr2, col, row, cr, cell, newcell;\n   var fillright, rowstart, colstart, crbase, rowoffset, coloffset, basecell;\n   var clipsheet, cliprange, numcols, numrows, attribtable;\n   var colend, rowend, newcolstart, newrowstart, newcolend, newrowend, rownext, colnext, colthis, cellnext;\n   var lastrow, lastcol, rowbefore, colbefore, oldformula, oldcr;\n   var cols, dirs, lastsortcol, i, sortlist, sortcells, sortvalues, sorttypes;\n   var sortfunction, slen, valtype, originalrow, sortedcr;\n   var name, v1, v2;\n   var cmdextension;\n\n   var attribs = sheet.attribs;\n   var changes = sheet.changes;\n   var cellProperties = SocialCalc.CellProperties;\n   var scc = SocialCalc.Constants;\n\n   var ParseRange =\n      function() {\n         var prange = SocialCalc.ParseRange(what);\n         cr1 = prange.cr1;\n         cr2 = prange.cr2;\n         if (cr2.col > attribs.lastcol) attribs.lastcol = cr2.col;\n         if (cr2.row > attribs.lastrow) attribs.lastrow = cr2.row;\n         };\n\n   errortext = \"\";\n\n   cmdstr = cmd.RestOfStringNoMove();\n   if (saveundo) {\n      sheet.changes.AddDo(cmdstr);\n      }\n\n   cmd1 = cmd.NextToken();\n\n   switch (cmd1) {\n\n      case \"set\":\n         what = cmd.NextToken();\n         attrib = cmd.NextToken();\n         rest = cmd.RestOfString();\n         undostart = \"set \"+what+\" \"+attrib;\n\n         if (what==\"sheet\") {\n            sheet.renderneeded = true;\n            switch (attrib) {\n               case \"defaultcolwidth\":\n                  if (saveundo) changes.AddUndo(undostart, attribs[attrib]);\n                  attribs[attrib] = rest;\n                  break;\n               case \"defaultcolor\":\n               case \"defaultbgcolor\":\n                  if (saveundo) changes.AddUndo(undostart, sheet.GetStyleString(\"color\", attribs[attrib]));\n                  attribs[attrib] = sheet.GetStyleNum(\"color\", rest);\n                  break;\n               case \"defaultlayout\":\n                  if (saveundo) changes.AddUndo(undostart, sheet.GetStyleString(\"layout\", attribs[attrib]));\n                  attribs[attrib] = sheet.GetStyleNum(\"layout\", rest);\n                  break;\n               case \"defaultfont\":\n                  if (saveundo) changes.AddUndo(undostart, sheet.GetStyleString(\"font\", attribs[attrib]));\n                  if (rest==\"* * *\") rest = \"\"; // all default\n                  attribs[attrib] = sheet.GetStyleNum(\"font\", rest);\n                  break;\n               case \"defaulttextformat\":\n               case \"defaultnontextformat\":\n                  if (saveundo) changes.AddUndo(undostart, sheet.GetStyleString(\"cellformat\", attribs[attrib]));\n                  attribs[attrib] = sheet.GetStyleNum(\"cellformat\", rest);\n                  break;\n               case \"defaulttextvalueformat\":\n               case \"defaultnontextvalueformat\":\n                  if (saveundo) changes.AddUndo(undostart, sheet.GetStyleString(\"valueformat\", attribs[attrib]));\n                  attribs[attrib] = sheet.GetStyleNum(\"valueformat\", rest);\n                  for (cr in sheet.cells) { // forget all cached display strings\n                     delete sheet.cells[cr].displaystring;\n                     }\n                  break;\n               case \"lastcol\":\n               case \"lastrow\":\n                  if (saveundo) changes.AddUndo(undostart, attribs[attrib]-0);\n                  num = rest-0;\n                  if (typeof num == \"number\") attribs[attrib] = num > 0 ? num : 1;\n                  break;\n               case \"recalc\":\n                  if (saveundo) changes.AddUndo(undostart, attribs[attrib]);\n                  if (rest == \"off\") {\n                     attribs.recalc = rest; // manual recalc, not auto\n                     }\n                  else { // all values other than \"off\" mean \"on\"\n                     delete attribs.recalc;\n                     }\n                  break;\n               default:\n                  errortext = scc.s_escUnknownSheetCmd+cmdstr;\n                  break;\n               }\n            }\n\n         else if (/(^[A-Z])([A-Z])?(:[A-Z][A-Z]?){0,1}$/i.test(what)) { // col attributes\n            sheet.renderneeded = true;\n            what = what.toUpperCase();\n            pos = what.indexOf(\":\");\n            if (pos>=0) {\n               cr1 = SocialCalc.coordToCr(what.substring(0,pos)+\"1\");\n               cr2 = SocialCalc.coordToCr(what.substring(pos+1)+\"1\");\n               }\n            else {\n               cr1 = SocialCalc.coordToCr(what+\"1\");\n               cr2 = cr1;\n               }\n            for (col=cr1.col; col <= cr2.col; col++) {\n               if (attrib==\"width\") {\n                  cr = SocialCalc.rcColname(col);\n                  if (saveundo) changes.AddUndo(\"set \"+cr+\" width\", sheet.colattribs.width[cr]);\n                  if (rest.length > 0 ) {\n                     sheet.colattribs.width[cr] = rest;\n                     }\n                  else {\n                     delete sheet.colattribs.width[cr];\n                     }\n                  }\n               }\n            }\n\n         // !!!!! need row attribs !!!!\n\n         else if (/([a-z]){0,1}(\\d+)/i.test(what)) { // cell attributes\n            ParseRange();\n            if (cr1.row!=cr2.row || cr1.col!=cr2.col || sheet.celldisplayneeded || sheet.renderneeded) { // not one cell\n               sheet.renderneeded = true;\n               sheet.celldisplayneeded = \"\";\n               }\n            else {\n               sheet.celldisplayneeded = SocialCalc.crToCoord(cr1.col, cr1.row);\n               }\n            for (row=cr1.row; row <= cr2.row; row++) {\n               for (col=cr1.col; col <= cr2.col; col++) {\n                  cr = SocialCalc.crToCoord(col, row);\n                  cell=sheet.GetAssuredCell(cr);\n                  if (saveundo) changes.AddUndo(\"set \"+cr+\" all\", sheet.CellToString(cell));\n                  if (attrib==\"value\") { // set coord value type numeric-value\n                     pos = rest.indexOf(\" \");\n                     cell.datavalue = rest.substring(pos+1)-0;\n                     delete cell.errors;\n                     cell.datatype = \"v\";\n                     cell.valuetype = rest.substring(0,pos);\n                     delete cell.displaystring;\n                     delete cell.parseinfo;\n                     attribs.needsrecalc = \"yes\";\n                     }\n                  else if (attrib==\"text\") { // set coord text type text-value\n                     pos = rest.indexOf(\" \");\n                     cell.datavalue = SocialCalc.decodeFromSave(rest.substring(pos+1));\n                     delete cell.errors;\n                     cell.datatype = \"t\";\n                     cell.valuetype = rest.substring(0,pos);\n                     delete cell.displaystring;\n                     delete cell.parseinfo;\n                     attribs.needsrecalc = \"yes\";\n                     }\n                  else if (attrib==\"formula\") { // set coord formula formula-body-less-initial-=\n                     cell.datavalue = 0; // until recalc\n                     delete cell.errors;\n                     cell.datatype = \"f\";\n                     cell.valuetype = \"e#N/A\"; // until recalc\n                     cell.formula = rest;\n                     delete cell.displaystring;\n                     delete cell.parseinfo;\n                     attribs.needsrecalc = \"yes\";\n                     }\n                  else if (attrib==\"constant\") { // set coord constant type numeric-value source-text\n                     pos = rest.indexOf(\" \");\n                     pos2 = rest.substring(pos+1).indexOf(\" \");\n                     cell.datavalue = rest.substring(pos+1,pos+1+pos2)-0;\n                     cell.valuetype = rest.substring(0,pos);\n                     if (cell.valuetype.charAt(0)==\"e\") { // error\n                        cell.errors = cell.valuetype.substring(1);\n                        }\n                     else {\n                        delete cell.errors;\n                        }\n                     cell.datatype = \"c\";\n                     cell.formula = rest.substring(pos+pos2+2);\n                     delete cell.displaystring;\n                     delete cell.parseinfo;\n                     attribs.needsrecalc = \"yes\";\n                     }\n                  else if (attrib==\"empty\") { // erase value\n                     cell.datavalue = \"\";\n                     delete cell.errors;\n                     cell.datatype = null;\n                     cell.formula = \"\";\n                     cell.valuetype = \"b\";\n                     delete cell.displaystring;\n                     delete cell.parseinfo;\n                     attribs.needsrecalc = \"yes\";\n                     }\n                  else if (attrib==\"all\") { // set coord all :this:val1:that:val2...\n                     if (rest.length>0) {\n                        cell = new SocialCalc.Cell(cr);\n                        sheet.CellFromStringParts(cell, rest.split(\":\"), 1);\n                        sheet.cells[cr] = cell;\n                        }\n                     else {\n                        delete sheet.cells[cr];\n                        }\n                     attribs.needsrecalc = \"yes\";\n                     }\n                  else if (/^b[trbl]$/.test(attrib)) { // set coord bt 1px solid black\n                     cell[attrib] = sheet.GetStyleNum(\"borderstyle\", rest);\n                     sheet.renderneeded = true; // affects more than just one cell\n                     }\n                  else if (attrib==\"color\" || attrib==\"bgcolor\") {\n                     cell[attrib] = sheet.GetStyleNum(\"color\", rest);\n                     }\n                  else if (attrib==\"layout\" || attrib==\"cellformat\") {\n                     cell[attrib] = sheet.GetStyleNum(attrib, rest);\n                     }\n                  else if (attrib==\"font\") { // set coord font style weight size family\n                     if (rest==\"* * *\") rest = \"\";\n                     cell[attrib] = sheet.GetStyleNum(\"font\", rest);\n                     }\n                  else if (attrib==\"textvalueformat\" || attrib==\"nontextvalueformat\") {\n                     cell[attrib] = sheet.GetStyleNum(\"valueformat\", rest);\n                     delete cell.displaystring;\n                     }\n                  else if (attrib==\"cssc\") {\n                     rest = rest.replace(/[^a-zA-Z0-9\\-]/g, \"\");\n                     cell.cssc = rest;\n                     }\n                  else if (attrib==\"csss\") {\n                     rest = rest.replace(/\\n/g, \"\");\n                     cell.csss = rest;\n                     }\n                  else if (attrib==\"mod\") {\n                     rest = rest.replace(/[^yY]/g, \"\").toLowerCase();\n                     cell.mod = rest;\n                     }\n                  else if (attrib==\"comment\") {\n                     cell.comment = SocialCalc.decodeFromSave(rest);\n                     }\n                  else {\n                     errortext = scc.s_escUnknownSetCoordCmd+cmdstr;\n                     }\n                  }\n               }\n\n            }\n         break;\n\n      case \"merge\":\n         sheet.renderneeded = true;\n         what = cmd.NextToken();\n         rest = cmd.RestOfString();\n         ParseRange();\n         cell=sheet.GetAssuredCell(cr1.coord);\n         if (saveundo) changes.AddUndo(\"unmerge \"+cr1.coord);\n\n         if (cr2.col > cr1.col) cell.colspan = cr2.col - cr1.col + 1;\n         else delete cell.colspan;\n         if (cr2.row > cr1.row) cell.rowspan = cr2.row - cr1.row + 1;\n         else delete cell.rowspan;\n\n         sheet.changedrendervalues = true;\n\n         break;\n\n      case \"unmerge\":\n         sheet.renderneeded = true;\n         what = cmd.NextToken();\n         rest = cmd.RestOfString();\n         ParseRange();\n         cell=sheet.GetAssuredCell(cr1.coord);\n         if (saveundo) changes.AddUndo(\"merge \"+cr1.coord+\":\"+SocialCalc.crToCoord(cr1.col+(cell.colspan||1)-1, cr1.row+(cell.rowspan||1)-1));\n\n         delete cell.colspan;\n         delete cell.rowspan;\n\n         sheet.changedrendervalues = true;\n\n         break;\n\n      case \"erase\":\n      case \"cut\":\n         sheet.renderneeded = true;\n         sheet.changedrendervalues = true;\n         what = cmd.NextToken();\n         rest = cmd.RestOfString();\n         ParseRange();\n\n         if (saveundo) changes.AddUndo(\"changedrendervalues\"); // to take care of undone pasted spans\n         if (cmd1==\"cut\") { // save copy of whole thing before erasing\n            if (saveundo) changes.AddUndo(\"loadclipboard\", SocialCalc.encodeForSave(SocialCalc.Clipboard.clipboard));\n            SocialCalc.Clipboard.clipboard = SocialCalc.CreateSheetSave(sheet, what);\n            }\n\n         for (row = cr1.row; row <= cr2.row; row++) {\n            for (col = cr1.col; col <= cr2.col; col++) {\n               cr = SocialCalc.crToCoord(col, row);\n               cell=sheet.GetAssuredCell(cr);\n               if (saveundo) changes.AddUndo(\"set \"+cr+\" all\", sheet.CellToString(cell));\n               if (rest==\"all\") {\n                  delete sheet.cells[cr];\n                  }\n               else if (rest == \"formulas\") {\n                  cell.datavalue = \"\";\n                  cell.datatype = null;\n                  cell.formula = \"\";\n                  cell.valuetype = \"b\";\n                  delete cell.errors;\n                  delete cell.displaystring;\n                  delete cell.parseinfo;\n                  if (cell.comment) { // comments are considered content for erasing\n                     delete cell.comment;\n                     }\n                  }\n               else if (rest == \"formats\") {\n                  newcell = new SocialCalc.Cell(cr); // create a new cell without attributes\n                  newcell.datavalue = cell.datavalue; // copy existing values\n                  newcell.datatype = cell.datatype;\n                  newcell.formula = cell.formula;\n                  newcell.valuetype = cell.valuetype;\n                  if (cell.comment) {\n                     newcell.comment = cell.comment;\n                     }\n                  sheet.cells[cr] = newcell; // replace\n                  }\n               }\n            }\n         attribs.needsrecalc = \"yes\";\n         break;\n\n      case \"fillright\":\n      case \"filldown\":\n         sheet.renderneeded = true;\n         sheet.changedrendervalues = true;\n         if (saveundo) changes.AddUndo(\"changedrendervalues\"); // to take care of undone pasted spans\n         what = cmd.NextToken();\n         rest = cmd.RestOfString();\n         ParseRange();\n         if (cmd1 == \"fillright\") {\n            fillright = true;\n            rowstart = cr1.row;\n            colstart = cr1.col + 1;\n            }\n         else {\n            fillright = false;\n            rowstart = cr1.row + 1;\n            colstart = cr1.col;\n            }\n         for (row = rowstart; row <= cr2.row; row++) {\n            for (col = colstart; col <= cr2.col; col++) {\n               cr = SocialCalc.crToCoord(col, row);\n               cell=sheet.GetAssuredCell(cr);\n               if (saveundo) changes.AddUndo(\"set \"+cr+\" all\", sheet.CellToString(cell));\n               if (fillright) {\n                  crbase = SocialCalc.crToCoord(cr1.col, row);\n                  coloffset = col - colstart + 1;\n                  rowoffset = 0;\n                  }\n               else {\n                  crbase = SocialCalc.crToCoord(col, cr1.row);\n                  coloffset = 0;\n                  rowoffset = row - rowstart + 1;\n                  }\n               basecell = sheet.GetAssuredCell(crbase);\n               if (rest == \"all\" || rest == \"formats\") {\n                  for (attrib in cellProperties) {\n                     if (cellProperties[attrib] == 1) continue; // copy only format attributes\n                     if (typeof basecell[attrib] === undefined || cellProperties[attrib] == 3) {\n                        delete cell[attrib];\n                        }\n                     else {\n                        cell[attrib] = basecell[attrib];\n                        }\n                     }\n                  }\n               if (rest == \"all\" || rest == \"formulas\") {\n                  cell.datavalue = basecell.datavalue;\n                  cell.datatype = basecell.datatype;            \n                  cell.valuetype = basecell.valuetype;\n                  if (cell.datatype == \"f\") { // offset relative coords, even in sheet references\n                     cell.formula = SocialCalc.OffsetFormulaCoords(basecell.formula, coloffset, rowoffset);\n                     }\n                  else {\n                     cell.formula = basecell.formula;\n                     }\n                  delete cell.parseinfo;\n                  cell.errors = basecell.errors;\n                  }\n               delete cell.displaystring;\n               }\n            }\n\n         attribs.needsrecalc = \"yes\";\n         break;\n\n      case \"copy\":\n         what = cmd.NextToken();\n         rest = cmd.RestOfString();\n         if (saveundo) changes.AddUndo(\"loadclipboard\", SocialCalc.encodeForSave(SocialCalc.Clipboard.clipboard));\n         SocialCalc.Clipboard.clipboard = SocialCalc.CreateSheetSave(sheet, what);\n         break;\n\n      case \"loadclipboard\":\n         rest = cmd.RestOfString();\n         if (saveundo) changes.AddUndo(\"loadclipboard\", SocialCalc.encodeForSave(SocialCalc.Clipboard.clipboard));\n         SocialCalc.Clipboard.clipboard = SocialCalc.decodeFromSave(rest);\n         break;\n\n      case \"clearclipboard\":\n         if (saveundo) changes.AddUndo(\"loadclipboard\", SocialCalc.encodeForSave(SocialCalc.Clipboard.clipboard));\n         SocialCalc.Clipboard.clipboard = \"\";\n         break;\n\n      case \"paste\":\n         sheet.renderneeded = true;\n         sheet.changedrendervalues = true;\n         if (saveundo) changes.AddUndo(\"changedrendervalues\"); // to take care of undone pasted spans\n         what = cmd.NextToken();\n         rest = cmd.RestOfString();\n         ParseRange();\n         if (!SocialCalc.Clipboard.clipboard) {\n            break;\n            }\n         clipsheet = new SocialCalc.Sheet(); // load clipboard contents as another sheet\n         clipsheet.ParseSheetSave(SocialCalc.Clipboard.clipboard);\n         cliprange = SocialCalc.ParseRange(clipsheet.copiedfrom);\n         coloffset = cr1.col - cliprange.cr1.col; // get sizes, etc.\n         rowoffset = cr1.row - cliprange.cr1.row;\n         numcols = cliprange.cr2.col - cliprange.cr1.col + 1;\n         numrows = cliprange.cr2.row - cliprange.cr1.row + 1;\n         if (cr1.col+numcols-1 > attribs.lastcol) attribs.lastcol = cr1.col+numcols-1;\n         if (cr1.row+numrows-1 > attribs.lastrow) attribs.lastrow = cr1.row+numrows-1;\n\n         for (row = cr1.row; row < cr1.row+numrows; row++) {\n            for (col = cr1.col; col < cr1.col+numcols; col++) {\n               cr = SocialCalc.crToCoord(col, row);\n               cell=sheet.GetAssuredCell(cr);\n               if (saveundo) changes.AddUndo(\"set \"+cr+\" all\", sheet.CellToString(cell));\n               crbase = SocialCalc.crToCoord(col-coloffset, row-rowoffset);\n               basecell = clipsheet.GetAssuredCell(crbase);\n               if (rest == \"all\" || rest == \"formats\") {\n                  for (attrib in cellProperties) {\n                     if (cellProperties[attrib] == 1) continue; // copy only format attributes\n                     if (typeof basecell[attrib] === undefined || cellProperties[attrib] == 3) {\n                        delete cell[attrib];\n                        }\n                     else {\n                        attribtable = SocialCalc.CellPropertiesTable[attrib];\n                        if (attribtable && basecell[attrib]) { // table indexes to expand to strings since other sheet may have diff indexes\n                           cell[attrib] = sheet.GetStyleNum(attribtable, clipsheet.GetStyleString(attribtable, basecell[attrib]));\n                           }\n                        else { // these are not table indexes\n                           cell[attrib] = basecell[attrib];\n                           }\n                        }\n                     }\n                  }\n               if (rest == \"all\" || rest == \"formulas\") {\n                  cell.datavalue = basecell.datavalue;\n                  cell.datatype = basecell.datatype;            \n                  cell.valuetype = basecell.valuetype;\n                  if (cell.datatype == \"f\") { // offset relative coords, even in sheet references\n                     cell.formula = SocialCalc.OffsetFormulaCoords(basecell.formula, coloffset, rowoffset);\n                     }\n                  else {\n                     cell.formula = basecell.formula;\n                     }\n                  delete cell.parseinfo;\n                  cell.errors = basecell.errors;\n                  if (basecell.comment) { // comments are pasted as part of content, though not filled, etc.\n                     cell.comment = basecell.comment;\n                     }\n                  else if (cell.comment) {\n                     delete cell.comment;\n                     }\n                  }\n               delete cell.displaystring;\n               }\n            }\n\n         attribs.needsrecalc = \"yes\";\n         break;\n\n      case \"sort\": // sort cr1:cr2 col1 up/down col2 up/down col3 up/down\n         sheet.renderneeded = true;\n         sheet.changedrendervalues = true;\n         if (saveundo) changes.AddUndo(\"changedrendervalues\"); // to take care of undone pasted spans\n         what = cmd.NextToken();\n         ParseRange();\n         cols = []; // get columns and sort directions (or \"\")\n         dirs = [];\n         lastsortcol = 0;\n         for (i=0; i<=3; i++) {\n            cols[i] = cmd.NextToken();\n            dirs[i] = cmd.NextToken();\n            if (cols[i]) lastsortcol = i;\n            }\n\n         sortcells = {}; // a copy of the data which will replace the original, but in the new order\n         sortlist = []; // an array of 0, 1, ..., nrows-1 needed for sorting\n         sortvalues = []; // values to be sorted corresponding to sortlist\n         sorttypes = []; // basic types of the values\n\n         for (row = cr1.row; row <= cr2.row; row++) { // fill in the sort info\n            for (col = cr1.col; col <= cr2.col; col++) {\n               cr = SocialCalc.crToCoord(col, row);\n               cell=sheet.cells[cr];\n               if (cell) { // only copy non-empty cells\n                  sortcells[cr] = sheet.CellToString(cell);\n                  if (saveundo) changes.AddUndo(\"set \"+cr+\" all\", sortcells[cr]);\n                  }\n               else {\n                  if (saveundo) changes.AddUndo(\"set \"+cr+\" all\");\n                  }\n               }\n            sortlist.push(sortlist.length);\n            sortvalues.push([]);\n            sorttypes.push([]);\n            slast = sorttypes.length-1;\n            for (i = 0; i <= lastsortcol; i++) {\n               cr = cols[i] + row; // get cr on this row in sort col\n               cell = sheet.GetAssuredCell(cr);\n               val = cell.datavalue;\n               valtype = cell.valuetype.charAt(0) || \"b\";\n               if (valtype == \"t\") val = val.toLowerCase();\n               sortvalues[slast].push(val);\n               sorttypes[slast].push(valtype);\n               }\n            }\n\n         sortfunction = function(a, b) { // a comparison function that can handle all the type variations\n            var i, a1, b1, ta, cresult;\n            for (i=0; i<=lastsortcol; i++) {\n               if (dirs[i] == \"up\") { // handle sort direction\n                  a1 = a; b1 = b;\n                  }\n               else {\n                  a1 = b; b1 = a;\n                  }\n               ta = sorttypes[a1][i];\n               tb = sorttypes[b1][i];\n               if (ta == \"t\") { // numbers < text < errors, blank always last no matter what dir\n                  if (tb == \"t\") {\n                     a1 = sortvalues[a1][i];\n                     b1 = sortvalues[b1][i];\n                     cresult = a1 > b1 ? 1 : (a1 < b1 ? -1 : 0);\n                     }\n                  else if (tb == \"n\") {\n                     cresult = 1;\n                     }\n                  else if (tb == \"b\") {\n                     cresult = dirs[i] == \"up\" ? -1 : 1;\n                     }\n                  else if (tb == \"e\") {\n                     cresult = -1;\n                     }\n                  }\n               else if (ta == \"n\") {\n                  if (tb == \"t\") {\n                     cresult = -1;\n                     }\n                  else if (tb == \"n\") {\n                     a1 = sortvalues[a1][i]-0; // force to numeric, just in case\n                     b1 = sortvalues[b1][i]-0;\n                     cresult = a1 > b1 ? 1 : (a1 < b1 ? -1 : 0);\n                     }\n                  else if (tb == \"b\") {\n                     cresult = dirs[i] == \"up\" ? -1 : 1;\n                     }\n                  else if (tb == \"e\") {\n                     cresult = -1;\n                     }\n                  }\n               else if (ta == \"e\") {\n                  if (tb == \"e\") {\n                     a1 = sortvalues[a1][i];\n                     b1 = sortvalues[b1][i];\n                     cresult = a1 > b1 ? 1 : (a1 < b1 ? -1 : 0);\n                     }\n                  else if (tb == \"b\") {\n                     cresult = dirs[i] == \"up\" ? -1 : 1;\n                     }\n                  else {\n                     cresult = 1;\n                     }\n                  }\n               else if (ta == \"b\") {\n                  if (tb == \"b\") {\n                     cresult = 0;\n                     }\n                  else {\n                     cresult = dirs[i] == \"up\" ? 1 : -1;\n                     }\n                  }\n               if (cresult) { // return if tested not equal, otherwise do next column\n                  return cresult;\n                  }\n               }\n            cresult = a > b ? 1 : (a < b ? -1 : 0); // equal - return position in original to maintain it\n            return cresult;\n            }\n\n         sortlist.sort(sortfunction);\n\n         for (row = cr1.row; row <= cr2.row; row++) { // copy original rows into sorted positions\n            originalrow = sortlist[row-cr1.row]; // relative position where it was in original\n            for (col = cr1.col; col <= cr2.col; col++) {\n               cr = SocialCalc.crToCoord(col, row);\n               sortedcr = SocialCalc.crToCoord(col, originalrow+cr1.row); // original cell to be put in new place\n               if (sortcells[sortedcr]) {\n                  cell = new SocialCalc.Cell(cr);\n                  sheet.CellFromStringParts(cell, sortcells[sortedcr].split(\":\"), 1);\n                  if (cell.datatype == \"f\") { // offset coord refs, even to ***relative*** coords in other sheets\n                     cell.formula = SocialCalc.OffsetFormulaCoords(cell.formula, 0, (row-cr1.row)-originalrow);\n                     }\n                  sheet.cells[cr] = cell;\n                  }\n               else {\n                  delete sheet.cells[cr];\n                  }\n               }\n            }\n\n         attribs.needsrecalc = \"yes\";\n         break;\n\n      case \"insertcol\":\n      case \"insertrow\":\n         sheet.renderneeded = true;\n         sheet.changedrendervalues = true;\n         what = cmd.NextToken();\n         rest = cmd.RestOfString();\n         ParseRange();\n\n         if (cmd1 == \"insertcol\") {\n            coloffset = 1;\n            colend = cr1.col;\n            rowoffset = 0;\n            rowend = 1;\n            newcolstart = cr1.col;\n            newcolend = cr1.col;\n            newrowstart = 1;\n            newrowend = attribs.lastrow;\n            if (saveundo) changes.AddUndo(\"deletecol \"+cr1.coord);\n            }\n         else {\n            coloffset = 0;\n            colend = 1;\n            rowoffset = 1;\n            rowend = cr1.row;\n            newcolstart = 1;\n            newcolend = attribs.lastcol;\n            newrowstart = cr1.row;\n            newrowend = cr1.row;\n            if (saveundo) changes.AddUndo(\"deleterow \"+cr1.coord);\n            }\n\n         for (row=attribs.lastrow; row >= rowend; row--) { // copy the cells forward\n            for (col=attribs.lastcol; col >= colend; col--) {\n               crbase = SocialCalc.crToCoord(col, row);\n               cr = SocialCalc.crToCoord(col+coloffset, row+rowoffset);\n               if (!sheet.cells[crbase]) { // copying empty cell\n                  delete sheet.cells[cr]; // delete anything that may have been there\n                  }\n               else { // overwrite existing cell with moved contents\n                  sheet.cells[cr] = sheet.cells[crbase];\n                  }\n               }\n            }\n\n         for (row=newrowstart; row <= newrowend; row++) { // fill the \"new\" empty cells\n            for (col=newcolstart; col <= newcolend; col++) {\n               cr = SocialCalc.crToCoord(col, row);\n               cell = new SocialCalc.Cell(cr);\n               sheet.cells[cr] = cell;\n               crbase = SocialCalc.crToCoord(col-coloffset, row-rowoffset); // copy attribs of the one before (0 gives you A or 1)\n               basecell = sheet.GetAssuredCell(crbase);\n               for (attrib in cellProperties) {\n                  if (cellProperties[attrib] == 2) { // copy only format attributes\n                     cell[attrib] = basecell[attrib];\n                     }\n                  }\n               }\n            }\n\n         for (cr in sheet.cells) { // update cell references to moved cells in calculated formulas\n             cell = sheet.cells[cr];\n             if (cell && cell.datatype == \"f\") {\n                cell.formula = SocialCalc.AdjustFormulaCoords(cell.formula, cr1.col, coloffset, cr1.row, rowoffset);\n                }\n             if (cell) {\n                delete cell.parseinfo;\n                }\n             }\n\n         for (name in sheet.names) { // update cell references to moved cells in names\n            if (sheet.names[name]) { // works with \"A1\", \"A1:A20\", and \"=formula\" forms\n               v1 = sheet.names[name].definition;\n               v2 = \"\";\n               if (v1.charAt(0) == \"=\") {\n                  v2 = \"=\";\n                  v1 = v1.substring(1);\n                  }\n               sheet.names[name].definition = v2 +\n                  SocialCalc.AdjustFormulaCoords(v1, cr1.col, coloffset, cr1.row, rowoffset);\n               }\n            }\n\n         for (row = attribs.lastrow; row >= rowend && cmd1 == \"insertrow\"; row--) { // copy the row attributes forward\n            rownext = row + rowoffset;\n            for (attrib in sheet.rowattribs) {\n               val = sheet.rowattribs[attrib][row];\n               if (sheet.rowattribs[attrib][rownext] != val) { // make assignment only if different\n                  if (val) {\n                     sheet.rowattribs[attrib][rownext] = val;\n                     }\n                  else {\n                     delete sheet.rowattribs[attrib][rownext];\n                     }\n                  }\n               }\n            }\n\n         for (col = attribs.lastcol; col >= colend && cmd1 == \"insertcol\"; col--) { // copy the column attributes forward\n            colthis = SocialCalc.rcColname(col);\n            colnext = SocialCalc.rcColname(col + coloffset);\n            for (attrib in sheet.colattribs) {\n               val = sheet.colattribs[attrib][colthis];\n               if (sheet.colattribs[attrib][colnext] != val) { // make assignment only if different\n                  if (val) {\n                     sheet.colattribs[attrib][colnext] = val;\n                     }\n                  else {\n                     delete sheet.colattribs[attrib][colnext];\n                     }\n                  }\n               }\n            }\n\n         attribs.lastcol += coloffset;\n         attribs.lastrow += rowoffset;\n         attribs.needsrecalc = \"yes\";\n         break;\n\n      case \"deletecol\":\n      case \"deleterow\":\n         sheet.renderneeded = true;\n         sheet.changedrendervalues = true;\n         what = cmd.NextToken();\n         rest = cmd.RestOfString();\n         lastcol = attribs.lastcol; // save old values since ParseRange sets...\n         lastrow = attribs.lastrow;\n         ParseRange();\n\n         if (cmd1 == \"deletecol\") {\n            coloffset = cr1.col - cr2.col - 1;\n            rowoffset = 0;\n            colstart = cr2.col + 1;\n            rowstart = 1;\n            }\n         else {\n            coloffset = 0;\n            rowoffset = cr1.row - cr2.row - 1;\n            colstart = 1;\n            rowstart = cr2.row + 1;\n            }\n\n         for (row=rowstart; row <= lastrow - rowoffset; row++) { // copy the cells backwards - extra so no dup of last set\n            for (col=colstart; col <= lastcol - coloffset; col++) {\n               cr = SocialCalc.crToCoord(col+coloffset, row+rowoffset);\n               if (saveundo && (row<rowstart-rowoffset || col<colstart  -coloffset)) { // save cells that are overwritten as undo info\n                  cell = sheet.cells[cr];\n                  if (!cell) { // empty cell\n                     changes.AddUndo(\"erase \"+cr+\" all\");\n                     }\n                  else {\n                     changes.AddUndo(\"set \"+cr+\" all\", sheet.CellToString(cell));\n                     }\n                  }\n               crbase = SocialCalc.crToCoord(col, row);\n               cell = sheet.cells[crbase];\n               if (!cell) { // copying empty cell\n                  delete sheet.cells[cr]; // delete anything that may have been there\n                  }\n               else { // overwrite existing cell with moved contents\n                  sheet.cells[cr] = cell;\n                  }\n               }\n            }\n\n//!!! multiple deletes isn't setting #REF!; need to fix up #REF!'s on undo but only those!\n\n         for (cr in sheet.cells) { // update cell references to moved cells in calculated formulas\n             cell = sheet.cells[cr];\n             if (cell) {\n                if (cell.datatype == \"f\") {\n                   oldformula = cell.formula;\n                   cell.formula = SocialCalc.AdjustFormulaCoords(oldformula, cr1.col, coloffset, cr1.row, rowoffset);\n                   if (cell.formula != oldformula) {\n                      delete cell.parseinfo;\n                      if (saveundo && cell.formula.indexOf(\"#REF!\")!=-1) { // save old version only if removed coord\n                         oldcr = SocialCalc.coordToCr(cr);\n                         changes.AddUndo(\"set \"+SocialCalc.rcColname(oldcr.col-coloffset)+(oldcr.row-rowoffset)+\n                                         \" formula \"+oldformula);\n                         }\n                      }\n                   }\n                else {\n                   delete cell.parseinfo;\n                   }\n                }\n             }\n\n         for (name in sheet.names) { // update cell references to moved cells in names\n            if (sheet.names[name]) { // works with \"A1\", \"A1:A20\", and \"=formula\" forms\n               v1 = sheet.names[name].definition;\n               v2 = \"\";\n               if (v1.charAt(0) == \"=\") {\n                  v2 = \"=\";\n                  v1 = v1.substring(1);\n                  }\n               sheet.names[name].definition = v2 +\n                  SocialCalc.AdjustFormulaCoords(v1, cr1.col, coloffset, cr1.row, rowoffset);\n               }\n            }\n\n         for (row = rowstart; row <= lastrow - rowoffset && cmd1 == \"deleterow\"; row++) { // copy the row attributes backwards\n            rowbefore = row + rowoffset;\n            for (attrib in sheet.rowattribs) {\n               val = sheet.rowattribs[attrib][row];\n               if (sheet.rowattribs[attrib][rowbefore] != val) { // make assignment only if different\n                  if (saveundo) changes.AddUndo(\"set \"+rowbefore+\" \"+attrib, sheet.rowattribs[attrib][rowbefore]);\n                  if (val) {\n                     sheet.rowattribs[attrib][rowbefore] = val;\n                     }\n                  else {\n                     delete sheet.rowattribs[attrib][rowbefore];\n                     }\n                  }\n               }\n            }\n\n         for (col = colstart; col <= lastcol - coloffset && cmd1 == \"deletecol\"; col++) { // copy the column attributes backwards\n            colthis = SocialCalc.rcColname(col);\n            colbefore = SocialCalc.rcColname(col + coloffset);\n            for (attrib in sheet.colattribs) {\n               val = sheet.colattribs[attrib][colthis];\n               if (sheet.colattribs[attrib][colbefore] != val) { // make assignment only if different\n                  if (saveundo) changes.AddUndo(\"set \"+colbefore+\" \"+attrib, sheet.colattribs[attrib][colbefore]);\n                  if (val) {\n                     sheet.colattribs[attrib][colbefore] = val;\n                     }\n                  else {\n                     delete sheet.colattribs[attrib][colbefore];\n                     }\n                  }\n               }\n            }\n\n         if (saveundo) {\n            if (cmd1 == \"deletecol\") {\n               for (col=cr1.col; col<=cr2.col; col++) {\n                  changes.AddUndo(\"insertcol \"+SocialCalc.rcColname(col));\n                  }\n               }\n            else {\n               for (row=cr1.row; row<=cr2.row; row++) {\n                  changes.AddUndo(\"insertrow \"+row);\n                  }\n               }\n            }\n\n         if (cmd1 == \"deletecol\") {\n            if (cr1.col <= lastcol) { // shrink sheet unless deleted phantom cols off the end\n               if (cr2.col <= lastcol) {\n                  attribs.lastcol += coloffset;\n                  }\n               else {\n                  attribs.lastcol = cr1.col - 1;\n                  }\n               }\n            }\n         else {\n            if (cr1.row <= lastrow) { // shrink sheet unless deleted phantom rows off the end\n               if (cr2.row <= lastrow) {\n                  attribs.lastrow += rowoffset;\n                  }\n               else {\n                  attribs.lastrow = cr1.row - 1;\n                  }\n               }\n            }\n         attribs.needsrecalc = \"yes\";\n         break;\n\n\n      case \"movepaste\":\n      case \"moveinsert\":\n\n         var movingcells, dest, destcr, inserthoriz, insertvert, pushamount, movedto;\n\n         sheet.renderneeded = true;\n         sheet.changedrendervalues = true;\n         if (saveundo) changes.AddUndo(\"changedrendervalues\"); // to take care of undone pasted spans\n         what = cmd.NextToken();\n         dest = cmd.NextToken();\n         rest = cmd.RestOfString(); // rest is all/formulas/formats\n         if (rest==\"\") rest = \"all\";\n\n         ParseRange();\n\n         destcr = SocialCalc.coordToCr(dest);\n\n         coloffset = destcr.col - cr1.col;\n         rowoffset = destcr.row - cr1.row;\n         numcols = cr2.col - cr1.col + 1;\n         numrows = cr2.row - cr1.row + 1;\n\n         // get a copy of moving cells and erase from where they were\n\n         movingcells = {};\n\n         for (row = cr1.row; row <= cr2.row; row++) {\n            for (col = cr1.col; col <= cr2.col; col++) {\n               cr = SocialCalc.crToCoord(col, row);\n               cell=sheet.GetAssuredCell(cr);\n               if (saveundo) changes.AddUndo(\"set \"+cr+\" all\", sheet.CellToString(cell));\n\n               if (!sheet.cells[cr]) { // if had nothing\n                  continue; // don't save anything\n                  }\n               movingcells[cr] = new SocialCalc.Cell(cr); // create new cell to copy\n\n               for (attrib in cellProperties) { // go through each property\n                  if (typeof cell[attrib] === undefined) { // don't copy undefined things and no need to delete\n                     continue;\n                     }\n                  else {\n                     movingcells[cr][attrib] = cell[attrib]; // copy for potential moving\n                     }\n                  if (rest == \"all\") {\n                     delete cell[attrib];\n                     }\n                  if (rest == \"formulas\") {\n                     if (cellProperties[attrib] == 1 || cellProperties[attrib] == 3) {\n                        delete cell[attrib];\n                        }\n                     }\n                  if (rest == \"formats\") {\n                     if (cellProperties[attrib] == 2) {\n                        delete cell[attrib];\n                        }\n                     }\n                  }\n               if (rest == \"formulas\") { // leave pristene deleted cell\n                  cell.datavalue = \"\";\n                  cell.datatype = null;\n                  cell.formula = \"\";\n                  cell.valuetype = \"b\";\n                  }\n               if (rest == \"all\") { // leave nothing for move all\n                  delete sheet.cells[cr];\n                  }\n               }\n            }\n\n         // if moveinsert, check destination OK, and calculate pushing parameters\n\n         if (cmd1 == \"moveinsert\") {\n            inserthoriz = false;\n            insertvert = false;\n            if (rowoffset==0 && (destcr.col < cr1.col || destcr.col > cr2.col)) {\n               if (destcr.col < cr1.col) { // moving left\n                  pushamount = cr1.col - destcr.col;\n                  inserthoriz = -1;\n                  }\n               else {\n                  destcr.col -= 1;\n                  coloffset = destcr.col - cr2.col;\n                  pushamount = destcr.col - cr2.col;\n                  inserthoriz = 1;\n                  }\n               }\n            else if (coloffset==0 && (destcr.row < cr1.row || destcr.row > cr2.row)) {\n               if (destcr.row < cr1.row) { // moving up\n                  pushamount = cr1.row - destcr.row;\n                  insertvert = -1;\n                  }\n               else {\n                  destcr.row -= 1;\n                  rowoffset = destcr.row - cr2.row;\n                  pushamount = destcr.row - cr2.row;\n                  insertvert = 1;\n                  }\n               }\n            else {\n               cmd1 = \"movepaste\"; // not allowed right now - ignore\n               }                \n            }\n\n         // push any cells that need pushing\n\n         movedto = {}; // remember what was moved where\n\n         if (insertvert) {\n            for (row = 0; row < pushamount; row++) {\n               for (col = cr1.col; col <= cr2.col; col++) {\n                  if (insertvert < 0) {\n                     crbase = SocialCalc.crToCoord(col, destcr.row+pushamount-row-1); // from cell\n                     cr = SocialCalc.crToCoord(col, cr2.row-row); // to cell\n                     }\n                  else {\n                     crbase = SocialCalc.crToCoord(col, destcr.row-pushamount+row+1); // from cell\n                     cr = SocialCalc.crToCoord(col, cr1.row+row); // to cell\n                     }\n\n                  basecell = sheet.GetAssuredCell(crbase);\n                  if (saveundo) changes.AddUndo(\"set \"+crbase+\" all\", sheet.CellToString(basecell));\n\n                  cell = sheet.GetAssuredCell(cr);\n                  if (rest == \"all\" || rest == \"formats\") {\n                     for (attrib in cellProperties) {\n                        if (cellProperties[attrib] == 1) continue; // copy only format attributes\n                        if (typeof basecell[attrib] === undefined || cellProperties[attrib] == 3) {\n                           delete cell[attrib];\n                           }\n                        else {\n                           cell[attrib] = basecell[attrib];\n                           }\n                        }\n                     }\n                  if (rest == \"all\" || rest == \"formulas\") {\n                     cell.datavalue = basecell.datavalue;\n                     cell.datatype = basecell.datatype;            \n                     cell.valuetype = basecell.valuetype;\n                     cell.formula = basecell.formula;\n                     delete cell.parseinfo;\n                     cell.errors = basecell.errors;\n                     }\n                  delete cell.displaystring;\n\n                  movedto[crbase] = cr; // old crbase is now at cr\n                  }\n               }\n            }\n         if (inserthoriz) {\n            for (col = 0; col < pushamount; col++) {\n               for (row = cr1.row; row <= cr2.row; row++) {\n                  if (inserthoriz < 0) {\n                     crbase = SocialCalc.crToCoord(destcr.col+pushamount-col-1, row);\n                     cr = SocialCalc.crToCoord(cr2.col-col, row);\n                     }\n                  else {\n                     crbase = SocialCalc.crToCoord(destcr.col-pushamount+col+1, row);\n                     cr = SocialCalc.crToCoord(cr1.col+col, row);\n                     }\n\n                  basecell = sheet.GetAssuredCell(crbase);\n                  if (saveundo) changes.AddUndo(\"set \"+crbase+\" all\", sheet.CellToString(basecell));\n\n                  cell = sheet.GetAssuredCell(cr);\n                  if (rest == \"all\" || rest == \"formats\") {\n                     for (attrib in cellProperties) {\n                        if (cellProperties[attrib] == 1) continue; // copy only format attributes\n                        if (typeof basecell[attrib] === undefined || cellProperties[attrib] == 3) {\n                           delete cell[attrib];\n                           }\n                        else {\n                           cell[attrib] = basecell[attrib];\n                           }\n                        }\n                     }\n                  if (rest == \"all\" || rest == \"formulas\") {\n                     cell.datavalue = basecell.datavalue;\n                     cell.datatype = basecell.datatype;            \n                     cell.valuetype = basecell.valuetype;\n                     cell.formula = basecell.formula;\n                     delete cell.parseinfo;\n                     cell.errors = basecell.errors;\n                     }\n                  delete cell.displaystring;\n\n                  movedto[crbase] = cr; // old crbase is now at cr\n                  }\n               }\n            }\n\n         // paste moved cells into new place\n\n         if (destcr.col+numcols-1 > attribs.lastcol) attribs.lastcol = destcr.col+numcols-1;\n         if (destcr.row+numrows-1 > attribs.lastrow) attribs.lastrow = destcr.row+numrows-1;\n\n         for (row = cr1.row; row < cr1.row+numrows; row++) {\n            for (col = cr1.col; col < cr1.col+numcols; col++) {\n               cr = SocialCalc.crToCoord(col+coloffset, row+rowoffset);\n               cell=sheet.GetAssuredCell(cr);\n               if (saveundo) changes.AddUndo(\"set \"+cr+\" all\", sheet.CellToString(cell));\n\n               crbase = SocialCalc.crToCoord(col, row); // get old cell to move\n\n               movedto[crbase] = cr; // old crbase (moved cell) will now be at cr (destination)\n\n               if (rest == \"all\" && !movingcells[crbase]) { // moving an empty cell\n                  delete sheet.cells[cr]; // make the cell empty\n                  continue;\n                  }\n\n               basecell = movingcells[crbase];\n               if (!basecell) basecell = sheet.GetAssuredCell(crbase);\n\n               if (rest == \"all\" || rest == \"formats\") {\n                  for (attrib in cellProperties) {\n                     if (cellProperties[attrib] == 1) continue; // copy only format attributes\n                     if (typeof basecell[attrib] === undefined || cellProperties[attrib] == 3) {\n                        delete cell[attrib];\n                        }\n                     else {\n                        cell[attrib] = basecell[attrib];\n                        }\n                     }\n                  }\n               if (rest == \"all\" || rest == \"formulas\") {\n                  cell.datavalue = basecell.datavalue;\n                  cell.datatype = basecell.datatype;            \n                  cell.valuetype = basecell.valuetype;\n                  cell.formula = basecell.formula;\n                  delete cell.parseinfo;\n                  cell.errors = basecell.errors;\n                  if (basecell.comment) { // comments are pasted as part of content, though not filled, etc.\n                     cell.comment = basecell.comment;\n                     }\n                  else if (cell.comment) {\n                     delete cell.comment;\n                     }\n                  }\n               delete cell.displaystring;\n               }\n            }\n\n         // do fixups\n\n         for (cr in sheet.cells) { // update cell references to moved cells in calculated formulas\n             cell = sheet.cells[cr];\n             if (cell) {\n                if (cell.datatype == \"f\") {\n                   oldformula = cell.formula;\n                   cell.formula = SocialCalc.ReplaceFormulaCoords(oldformula, movedto);\n                   if (cell.formula != oldformula) {\n                      delete cell.parseinfo;\n                      if (saveundo && !movedto[cr]) { // moved cells are already saved for undo\n                         changes.AddUndo(\"set \"+cr+\" formula \"+oldformula);\n                         }\n                      }\n                   }\n                else {\n                   delete cell.parseinfo;\n                   }\n                }\n             }\n\n         for (name in sheet.names) { // update cell references to moved cells in names\n            if (sheet.names[name]) { // works with \"A1\", \"A1:A20\", and \"=formula\" forms\n               v1 = sheet.names[name].definition;\n               oldformula = v1;\n               v2 = \"\";\n               if (v1.charAt(0) == \"=\") {\n                  v2 = \"=\";\n                  v1 = v1.substring(1);\n                  }\n               sheet.names[name].definition = v2 +\n                  SocialCalc.ReplaceFormulaCoords(v1, movedto);\n               if (saveundo && sheet.names[name].definition != oldformula) { // save changes\n                  changes.AddUndo(\"name define \"+name+\" \"+oldformula);\n                  }\n               }\n            }\n\n         attribs.needsrecalc = \"yes\";\n         break;\n\n      case \"name\":\n         what = cmd.NextToken();\n         name = cmd.NextToken();\n         rest = cmd.RestOfString();\n\n         name = name.toUpperCase().replace(/[^A-Z0-9_\\.]/g, \"\");\n         if (name == \"\") break; // must have something\n\n         if (what == \"define\") {\n            if (rest == \"\") break; // must have something\n            if (sheet.names[name]) { // already exists\n               if (saveundo) changes.AddUndo(\"name define \"+name+\" \"+sheet.names[name].definition);\n               sheet.names[name].definition = rest;\n               }\n            else { // new\n               if (saveundo) changes.AddUndo(\"name delete \"+name);\n               sheet.names[name] = {definition: rest, desc: \"\"};\n               }\n            }\n         else if (what == \"desc\") {\n            if (sheet.names[name]) { // must already exist\n               if (saveundo) changes.AddUndo(\"name desc \"+name+\" \"+sheet.names[name].desc);\n               sheet.names[name].desc = rest;\n               }\n            }\n         else if (what == \"delete\") {\n            if (saveundo) {\n               if (sheet.names[name].desc) changes.AddUndo(\"name desc \"+name+\" \"+sheet.names[name].desc);\n               changes.AddUndo(\"name define \"+name+\" \"+sheet.names[name].definition);\n               }\n            delete sheet.names[name];\n            }\n         attribs.needsrecalc = \"yes\";\n\n         break;\n\n      case \"recalc\":\n         attribs.needsrecalc = \"yes\"; // request recalc\n         sheet.recalconce = true; // even if turned off\n         break;\n\n      case \"redisplay\":\n         sheet.renderneeded = true;\n         break;\n\n      case \"changedrendervalues\": // needed for undo sometimes\n         sheet.changedrendervalues = true;\n         break;\n\n      case \"startcmdextension\": // startcmdextension extension rest-of-command\n         name = cmd.NextToken();\n         cmdextension = SocialCalc.SheetCommandInfo.CmdExtensionCallbacks[name];\n         if (cmdextension) {\n            cmdextension.func(name, cmdextension.data, sheet, cmd, saveundo);\n            }\n         break;\n\n      default:\n         errortext = scc.s_escUnknownCmd+cmdstr;\n         break;\n      }\n\n/* For Debugging:\nvar ustack=\"\";\nfor (var i=0;i<sheet.changes.stack.length;i++) {\n   ustack+=(i-0)+\":\"+sheet.changes.stack[i].command[0]+\" of \"+sheet.changes.stack[i].command.length+\"/\"+sheet.changes.stack[i].undo[0]+\" of \"+sheet.changes.stack[i].undo.length+\",\";\n   }\nalert(cmdstr+\"|\"+sheet.changes.stack.length+\"--\"+ustack);\n*/\n\n   return errortext;\n\n   }\n\nSocialCalc.SheetUndo = function(sheet) {\n\n   var i;\n   var tos = sheet.changes.TOS();\n   var lastone = tos ? tos.undo.length-1 : -1;\n   var cmdstr = \"\";\n\n   for (i=lastone; i>=0; i--) { // do them backwards\n      if (cmdstr) cmdstr += \"\\n\"; // concatenate with separate lines\n      cmdstr += tos.undo[i];\n      }\n   sheet.changes.Undo();\n   sheet.ScheduleSheetCommands(cmdstr, false); // do undo operations\n\n   }\n\nSocialCalc.SheetRedo = function(sheet) {\n\n   var tos, i;\n   var didredo = sheet.changes.Redo();\n   if (!didredo) {\n      sheet.ScheduleSheetCommands(\"\", false); // schedule doing nothing\n      return;\n      }\n   tos = sheet.changes.TOS();\n   var cmdstr = \"\";\n\n   for (i=0; tos && i<tos.command.length; i++) {\n      if (cmdstr) cmdstr += \"\\n\"; // concatenate with separate lines\n      cmdstr += tos.command[i];\n      }\n   sheet.ScheduleSheetCommands(cmdstr, false); // do undo operations\n\n   }\n\nSocialCalc.CreateAuditString = function(sheet) {\n\n   var i, j;\n   var result = \"\";\n   var stack = sheet.changes.stack;\n   var tos = sheet.changes.tos;\n   for (i=0; i<=tos; i++) {\n      for (j=0; j<stack[i].command.length; j++) {\n         result += stack[i].command[j] + \"\\n\";\n         }\n      }\n\n   return result;\n\n   }\n\nSocialCalc.GetStyleNum = function(sheet, atype, style) {\n\n   var num;\n\n   if (style.length==0) return 0; // null means use zero, which means default or global default\n\n   num = sheet[atype+\"hash\"][style];\n   if (!num) {\n      if (sheet[atype+\"s\"].length<1) sheet[atype+\"s\"].push(\"\");\n      num = sheet[atype+\"s\"].push(style) - 1;\n      sheet[atype+\"hash\"][style] = num;\n      sheet.changedrendervalues = true;\n      }\n   return num;\n\n   }\n\nSocialCalc.GetStyleString = function(sheet, atype, num) {\n\n   if (!num) return null; // zero, null, and undefined return null\n\n   return sheet[atype+\"s\"][num];\n\n   }\n\n//\n// updatedformula = SocialCalc.OffsetFormulaCoords(formula, coloffset, rowoffset)\n//\n// Change relative cell references by offsets (even those to other worksheets so fill, paste, sort work as expected).\n// If not what you want, use absolute references.\n//\n\nSocialCalc.OffsetFormulaCoords = function(formula, coloffset, rowoffset) {\n\n   var parseinfo, ttext, ttype, i, cr, newcr;\n   var updatedformula = \"\";\n   var scf = SocialCalc.Formula;\n   if (!scf) {\n      return \"Need SocialCalc.Formula\";\n      }\n   var tokentype = scf.TokenType;\n   var token_op = tokentype.op;\n   var token_string = tokentype.string;\n   var token_coord = tokentype.coord;\n   var tokenOpExpansion = scf.TokenOpExpansion;\n\n   parseinfo = scf.ParseFormulaIntoTokens(formula);\n\n   for (i=0; i<parseinfo.length; i++) {\n      ttype = parseinfo[i].type;\n      ttext = parseinfo[i].text;\n      if (ttype == token_coord) {\n         newcr = \"\";\n         cr = SocialCalc.coordToCr(ttext);\n         if (ttext.charAt(0)!=\"$\") { // add col offset unless absolute column\n            cr.col += coloffset;\n            }\n         else {\n            newcr += \"$\";\n            }\n         newcr += SocialCalc.rcColname(cr.col);\n         if (ttext.indexOf(\"$\", 1)==-1) { // add row offset unless absolute row\n            cr.row += rowoffset;\n            }\n         else {\n            newcr += \"$\";\n            }\n         newcr += cr.row;\n         if (cr.row < 1 || cr.col < 1) {\n            newcr = \"#REF!\";\n            }\n         updatedformula += newcr;\n         }\n      else if (ttype == token_string) {\n         if (ttext.indexOf('\"') >= 0) { // quotes to double\n            updatedformula += '\"' + ttext.replace(/\"/, '\"\"') + '\"';\n            }\n         else updatedformula += '\"' + ttext + '\"';\n         }\n      else if (ttype == token_op) {\n         updatedformula += tokenOpExpansion[ttext] || ttext; // make sure short tokens (e.g., \"G\") go back full (\">=\")\n         }\n      else { // leave everything else alone\n         updatedformula += ttext;\n         }\n      }\n\n   return updatedformula;\n\n   }\n\n//\n// updatedformula = SocialCalc.AdjustFormulaCoords(formula, col, coloffset, row, rowoffset)\n//\n// Change all cell references to cells starting with col/row by offsets\n//\n\nSocialCalc.AdjustFormulaCoords = function(formula, col, coloffset, row, rowoffset) {\n\n   var ttype, ttext, i, newcr;\n   var updatedformula = \"\";\n   var sheetref = false;\n   var scf = SocialCalc.Formula;\n   if (!scf) {\n      return \"Need SocialCalc.Formula\";\n      }\n   var tokentype = scf.TokenType;\n   var token_op = tokentype.op;\n   var token_string = tokentype.string;\n   var token_coord = tokentype.coord;\n   var tokenOpExpansion = scf.TokenOpExpansion;\n\n   parseinfo = SocialCalc.Formula.ParseFormulaIntoTokens(formula);\n\n   for (i=0; i<parseinfo.length; i++) {\n      ttype = parseinfo[i].type;\n      ttext = parseinfo[i].text;\n      if (ttype == token_op) { // references with sheet specifier are not offset\n         if (ttext == \"!\") {\n            sheetref = true; // found a sheet reference\n            }\n         else if (ttext != \":\") { // for everything but a range, reset\n            sheetref = false;\n            }\n         ttext = tokenOpExpansion[ttext] || ttext; // make sure short tokens (e.g., \"G\") go back full (\">=\")\n         }\n      if (ttype == token_coord) {\n         cr = SocialCalc.coordToCr(ttext);\n         if ((coloffset < 0 && cr.col >= col && cr.col < col-coloffset) ||\n             (rowoffset < 0 && cr.row >= row && cr.row < row-rowoffset)) { // refs to deleted cells become invalid\n            if (!sheetref) {\n               cr.col = 0;\n               cr.row = 0;\n               }\n            }\n         if (!sheetref) {\n            if (cr.col >= col) {\n               cr.col += coloffset;\n               }\n            if (cr.row >= row) {\n               cr.row += rowoffset;\n               }\n            }\n         if (ttext.charAt(0)==\"$\") {\n            newcr = \"$\"+SocialCalc.rcColname(cr.col);\n            }\n         else {\n            newcr = SocialCalc.rcColname(cr.col);\n            }\n         if (ttext.indexOf(\"$\", 1)!=-1) {\n            newcr += \"$\" + cr.row;\n            }\n         else {\n            newcr += cr.row;\n            }\n         if (cr.row < 1 || cr.col < 1) {\n            newcr = \"#REF!\";\n            }\n         ttext = newcr;\n         }\n      else if (ttype == token_string) {\n         if (ttext.indexOf('\"') >= 0) { // quotes to double\n            ttext = '\"' + ttext.replace(/\"/, '\"\"') + '\"';\n            }\n         else ttext = '\"' + ttext + '\"';\n         }\n      updatedformula += ttext;\n      }\n\n   return updatedformula;\n\n   }\n\n//\n// updatedformula = SocialCalc.ReplaceFormulaCoords(formula, movedto)\n//\n// Change all cell references to cells that are keys in moveto to be to moveto[coord].\n// Don't change references to other sheets.\n// Handle range extents specially.\n//\n\nSocialCalc.ReplaceFormulaCoords = function(formula, movedto) {\n\n   var ttype, ttext, i, newcr, coord;\n   var updatedformula = \"\";\n   var sheetref = false;\n   var scf = SocialCalc.Formula;\n   if (!scf) {\n      return \"Need SocialCalc.Formula\";\n      }\n   var tokentype = scf.TokenType;\n   var token_op = tokentype.op;\n   var token_string = tokentype.string;\n   var token_coord = tokentype.coord;\n   var tokenOpExpansion = scf.TokenOpExpansion;\n\n   parseinfo = SocialCalc.Formula.ParseFormulaIntoTokens(formula);\n\n   for (i=0; i<parseinfo.length; i++) {\n      ttype = parseinfo[i].type;\n      ttext = parseinfo[i].text;\n      if (ttype == token_op) { // references with sheet specifier are not change\n         if (ttext == \"!\") {\n            sheetref = true; // found a sheet reference\n            }\n         else if (ttext != \":\") { // for everything but a range, reset\n            sheetref = false;\n            }\n\n//!!!! HANDLE RANGE EXTENT MOVES\n\n         ttext = tokenOpExpansion[ttext] || ttext; // make sure short tokens (e.g., \"G\") go back full (\">=\")\n         }\n      if (ttype == token_coord) {\n         cr = SocialCalc.coordToCr(ttext); // get parts\n         coord = SocialCalc.crToCoord(cr.col, cr.row); // get \"clean\" reference\n         if (movedto[coord] && !sheetref) { // this is a reference to a moved cell\n            cr = SocialCalc.coordToCr(movedto[coord]); // get new row and col\n            if (ttext.charAt(0)==\"$\") { // copy absolute ref marks if present\n               newcr = \"$\"+SocialCalc.rcColname(cr.col);\n               }\n            else {\n               newcr = SocialCalc.rcColname(cr.col);\n               }\n            if (ttext.indexOf(\"$\", 1)!=-1) {\n               newcr += \"$\" + cr.row;\n               }\n            else {\n               newcr += cr.row;\n               }\n            ttext = newcr;\n            }\n         }\n      else if (ttype == token_string) {\n         if (ttext.indexOf('\"') >= 0) { // quotes to double\n            ttext = '\"' + ttext.replace(/\"/, '\"\"') + '\"';\n            }\n         else ttext = '\"' + ttext + '\"';\n         }\n      updatedformula += ttext;\n      }\n\n   return updatedformula;\n\n   }\n\n\n// ************************\n//\n// Recalc Loop Code\n//\n// ************************\n\n//\n// How recalc works:\n//\n// !!!!!!!!!!!!!!\n//\n\n// SocialCalc.RecalcInfo - object with global recalc info\n\nSocialCalc.RecalcInfo = {\n\n   sheet: null, // which sheet is being recalced\n\n   currentState: 0, // current state\n   state: {start_calc: 1, order: 2, calc: 3, start_wait: 4, done_wait: 5}, // allowed state values\n\n   recalctimer: null, // value to cancel timer\n   maxtimeslice: 100, // maximum milliseconds per slice of recalc time before a wait\n   timeslicedelay: 1, // milliseconds to wait between recalc time slices\n   starttime: 0, // when recalc started\n\n   // LoadSheet: a function that returns true if started a load or false if not.\n   //\n\n   LoadSheet: function(sheetname) {return false;} // default returns not found\n\n   }\n\n// SocialCalc.RecalcData - object with recalc info while determining recalc order and afterward\n\nSocialCalc.RecalcData = function() { // initialize a RecalcData object\n\n   this.inrecalc = true; // if true, doing a recalc\n   this.celllist = []; // list with all potential cells to calculate\n   this.celllistitem = 0; // cell to check next when ordering\n   this.calclist = null; // object which is the chained list of cells to calculate\n                         // each in the form of \"coord: nextcoord\"\n                         // e.g., if B8 is calculated right after A8, then calclist.A8==\"B8\"\n                         // if null, need to create the list\n   this.calclistlength = 0; // number of items in calclist\n\n   this.firstcalc = null; // start of the calc list - a string or null\n   this.lastcalc = null; // last one on chain (used to add more to the end)\n\n   this.nextcalc = null; // used to keep track during background recalc to make it restartable\n   this.count = 0; // number calculated\n\n   // checkinfo is used when determining calc order:\n\n   this.checkinfo = {}; // attributes are coords; if no attrib for a coord, it wasn't checked or doesn't need it\n                        // values are RecalcCheckInfo objects while checking or TRUE when complete\n\n   }\n\n// SocialCalc.RecalcCheckInfo - object that stores checking info while determining recalc order\n\nSocialCalc.RecalcCheckInfo = function() { // initialize a RecalcCheckInfo object\n\n   this.oldcoord = null; // chain back up of cells referring to cells\n   this.parsepos = 0; // which token we are up to\n\n   // range info\n\n   this.inrange = false; // if true, in the process of checking a range of coords\n   this.inrangestart = false; // if true, have not yet filled in range loop values\n   this.cr1 = null; // range first coord as a cr object\n   this.cr2 = null; // range second coord as a cr object\n   this.c1 = null; // range extents\n   this.c2 = null;\n   this.r1 = null;\n   this.r2 = null;\n   this.c = null; // looping values\n   this.r = null;\n   \n   }\n\n// Recalc the entire sheet\n\nSocialCalc.RecalcSheet = function(sheet) {\n\n   var coord, err, recalcdata;\n   var scri = SocialCalc.RecalcInfo;\n\n   delete sheet.attribs.circularreferencecell; // reset recalc-wide things\n   SocialCalc.Formula.FreshnessInfoReset();\n\n   SocialCalc.RecalcClearTimeout();\n\n   scri.sheet = sheet; // set values needed by background recalc\n   scri.currentState = scri.state.start_calc;\n\n   scri.starttime = new Date();\n\n   if (sheet.statuscallback) {\n      sheet.statuscallback(scri, \"calcstart\", null, sheet.statuscallbackparams);\n      }\n\n   SocialCalc.RecalcSetTimeout();\n\n   }\n\n//\n// SocialCalc.RecalcSetTimeout - set a timer for next recalc step\n//\n\nSocialCalc.RecalcSetTimeout = function() {\n\n   var scri = SocialCalc.RecalcInfo;\n\n   scri.recalctimer = window.setTimeout(SocialCalc.RecalcTimerRoutine, scri.timeslicedelay);\n\n   }\n\n//\n// SocialCalc.RecalcClearTimeout - cancel any timeouts\n//\n\nSocialCalc.RecalcClearTimeout = function() {\n\n   var scri = SocialCalc.RecalcInfo;\n\n   if (scri.recalctimer) {\n      window.clearTimeout(scri.recalctimer);\n      scri.recalctimer = null;\n      }\n\n   }\n\n\n//\n// SocialCalc.RecalcLoadedSheet(sheetname, str, recalcneeded)\n//\n// Called when a sheet finishes loading with name, string, and t/f whether it should be recalced.\n// If loaded sheet has sheet.attribs.recalc==\"off\", then no recalc done.\n// If sheetname is null, then the sheetname waiting for will be used.\n//\n\nSocialCalc.RecalcLoadedSheet = function(sheetname, str, recalcneeded) {\n\n   var sheet;\n   var scri = SocialCalc.RecalcInfo;\n   var scf = SocialCalc.Formula;\n\n   sheet = SocialCalc.Formula.AddSheetToCache(sheetname || scf.SheetCache.waitingForLoading, str);\n\n   if (recalcneeded && sheet && sheet.attribs.recalc!=\"off\") { // if recalcneeded, and not manual sheet, chain in this new sheet to recalc loop\n      sheet.previousrecalcsheet = scri.sheet;\n      scri.sheet = sheet;\n      scri.currentState = scri.state.start_calc;\n      }\n   scf.SheetCache.waitingForLoading = null;\n\n   SocialCalc.RecalcSetTimeout();\n\n   }\n\n\n//\n// SocialCalc.RecalcTimerRoutine - handles the actual order determination and cell-by-cell recalculation in the background\n//\n\nSocialCalc.RecalcTimerRoutine = function() {\n\n   var eresult, cell, coord, err, status;\n   var starttime = new Date();\n   var count = 0;\n   var scf = SocialCalc.Formula;\n   if (!scf) {\n      return \"Need SocialCalc.Formula\";\n      }\n   var scri = SocialCalc.RecalcInfo;\n   var sheet = scri.sheet;\n   if (!sheet) {\n      return;\n      }\n   var recalcdata = sheet.recalcdata;\n\n   var do_statuscallback = function(status, arg) { // routine to do callback if required\n      if (sheet.statuscallback) {\n         sheet.statuscallback(recalcdata, status, arg, sheet.statuscallbackparams);\n         }\n      }\n\n   SocialCalc.RecalcClearTimeout();\n\n   if (scri.currentState == scri.state.start_calc) {\n\n      recalcdata = new SocialCalc.RecalcData();\n      sheet.recalcdata = recalcdata;\n\n      for (coord in sheet.cells) { // get list of cells to check for order\n         if (!coord) continue;\n         recalcdata.celllist.push(coord);\n         }\n\n      recalcdata.calclist = {}; // start with empty list\n      scri.currentState = scri.state.order; // drop through to determining recalc order\n      }\n\n   if (scri.currentState == scri.state.order) {\n      while (recalcdata.celllistitem < recalcdata.celllist.length) { // check all the cells to see if they should be on the list\n         coord = recalcdata.celllist[recalcdata.celllistitem++];\n         err = SocialCalc.RecalcCheckCell(sheet, coord);\n         if (((new Date()) - starttime) >= scri.maxtimeslice) { // if taking too long, give up CPU for a while\n            do_statuscallback(\"calcorder\", {coord: coord, total: recalcdata.celllist.length, count: recalcdata.celllistitem});\n            SocialCalc.RecalcSetTimeout();\n            return;\n            }\n         }\n\n      do_statuscallback(\"calccheckdone\", recalcdata.calclistlength);\n\n      recalcdata.nextcalc = recalcdata.firstcalc; // start at the beginning of the recalc chain\n      scri.currentState = scri.state.calc; // loop through cells on next timer call\n      SocialCalc.RecalcSetTimeout();\n      return;\n      }\n\n   if (scri.currentState == scri.state.start_wait) { // starting to wait for something\n      scri.currentState = scri.state.done_wait; // finished on next timer call\n      if (scri.LoadSheet) {\n         status = scri.LoadSheet(scf.SheetCache.waitingForLoading);\n         if (status) { // started a load operation\n            return;\n            }\n         }\n      SocialCalc.RecalcLoadedSheet(null, \"\", false);\n      return;\n      }\n\n   if (scri.currentState == scri.state.done_wait) {\n      scri.currentState = scri.state.calc; // loop through cells on next timer call\n      SocialCalc.RecalcSetTimeout();\n      return;\n      }\n\n   // otherwise should be scri.state.calc\n\n   if (scri.currentState != scri.state.calc) {\n      alert(\"Recalc state error: \"+scri.currentState+\". Error in SocialCalc code.\");\n      }\n\n   coord = sheet.recalcdata.nextcalc;\n   while (coord) {\n      cell = sheet.cells[coord];\n      eresult = scf.evaluate_parsed_formula(cell.parseinfo, sheet, false);\n      if (scf.SheetCache.waitingForLoading) { // wait until restarted\n         recalcdata.nextcalc = coord; // start with this cell again\n         recalcdata.count += count;\n         do_statuscallback(\"calcloading\", {sheetname: scf.SheetCache.waitingForLoading});\n         scri.currentState = scri.state.start_wait; // start load on next timer call\n         SocialCalc.RecalcSetTimeout();\n         return;\n         }\n\n      if (scf.RemoteFunctionInfo.waitingForServer) { // wait until restarted\n         recalcdata.nextcalc = coord; // start with this cell again\n         recalcdata.count += count;\n         do_statuscallback(\"calcserverfunc\",\n            {funcname: scf.RemoteFunctionInfo.waitingForServer, coord: coord, total: recalcdata.calclistlength, count: recalcdata.count});\n         scri.currentState = scri.state.done_wait; // start load on next timer call\n         return; // return and wait for next recalc timer event\n         }\n\n      if (cell.datavalue != eresult.value ||\n       cell.valuetype != eresult.type) { // only update if changed from last time\n         cell.datavalue = eresult.value;\n         cell.valuetype = eresult.type;\n         delete cell.displaystring;\n         sheet.recalcchangedavalue = true; // remember something changed in case other code wants to know\n         }\n      if (eresult.error) {\n         cell.errors = eresult.error;\n         }\n      count++;\n      coord = sheet.recalcdata.calclist[coord];\n\n      if (((new Date()) - starttime) >= scri.maxtimeslice) { // if taking too long, give up CPU for a while\n         recalcdata.nextcalc = coord; // start with next cell on chain\n         recalcdata.count += count;\n         do_statuscallback(\"calcstep\", {coord: coord, total: recalcdata.calclistlength, count: recalcdata.count});\n         SocialCalc.RecalcSetTimeout();\n         return;\n         }\n      }\n\n   recalcdata.inrecalc = false;\n\n   delete sheet.recalcdata; // save memory and clear out for name lookup formula evaluation\n\n   delete sheet.attribs.needsrecalc; // remember recalc done\n\n   scri.sheet = sheet.previousrecalcsheet || null; // chain back if doing recalc of loaded sheets\n   if (scri.sheet) {\n      scri.currentState = scri.state.calc; // start where we left off\n      SocialCalc.RecalcSetTimeout();\n      return;\n      }\n\n   scf.FreshnessInfo.recalc_completed = true; // say freshness info is complete\n\n   do_statuscallback(\"calcfinished\", (new Date()) - scri.starttime);\n\n   }\n\n\n//\n// circref = SocialCalc.RecalcCheckCell(sheet, coord)\n//\n// Checks cell to put on calclist, looking at parsed tokens.\n// Also checks cells this cell is dependent upon\n// if it contains a formula with cell references.\n// If circular reference, returns non-null.\n//\n\nSocialCalc.RecalcCheckCell = function(sheet, startcoord) {\n\n   var parseinfo, ttext, ttype, i, rangecoord, circref, value, pos, pos2, cell, coordvals;\n   var scf = SocialCalc.Formula;\n   if (!scf) {\n      return \"Need SocialCalc.Formula\";\n      }\n   var tokentype = scf.TokenType;\n   var token_op = tokentype.op;\n   var token_name = tokentype.name;\n   var token_coord = tokentype.coord;\n\n   var recalcdata = sheet.recalcdata;\n   var checkinfo = recalcdata.checkinfo;\n\n   var sheetref = false; // if true, a sheet reference is in effect, so don't check that\n   var oldcoord = null; // coord of formula that referred to this one when checking down the tree\n   var coord = startcoord; // the coord of the cell we are checking\n\n   // Start with requested cell, and then continue down or up the dependency tree\n   // oldcoord (and checkinfo[coord].oldcoord) maintains the reference stack during the tree walk\n   // checkinfo[coord] maintains the stack of checking looping values, e.g., token number being checked\n\nmainloop:\n   while (coord) {\n      cell = sheet.cells[coord];\n      coordvals = checkinfo[coord];\n\n      if (!cell || cell.datatype != \"f\" || // Don't calculate if not a formula\n          (coordvals && typeof coordvals != \"object\")) { // Don't calc if already calculated\n         coord = oldcoord; // go back up dependency tree to coord that referred to us\n         if (checkinfo[coord]) oldcoord = checkinfo[coord].oldcoord;\n         continue;\n         }\n\n      if (!coordvals) { // do we have checking information about this cell?\n         coordvals = new SocialCalc.RecalcCheckInfo(); // no - make a place to hold it\n         checkinfo[coord] = coordvals;\n         }\n\n      if (cell.errors) { // delete errors from previous recalcs\n         delete cell.errors;\n         }\n\n      if (!cell.parseinfo) { // cache parsed formula\n         cell.parseinfo = scf.ParseFormulaIntoTokens(cell.formula);\n         }\n      parseinfo = cell.parseinfo;\n\n      for (i=coordvals.parsepos; i<parseinfo.length; i++) { // go through each token in formula\n\n         if (coordvals.inrange) { // processing a range of coords\n            if (coordvals.inrangestart) { // first time - fill in other values\n               if (coordvals.cr1.col > coordvals.cr2.col) { coordvals.c1 = coordvals.cr2.col; coordvals.c2 = coordvals.cr1.col; }\n               else { coordvals.c1 = coordvals.cr1.col; coordvals.c2 = coordvals.cr2.col; }\n               coordvals.c = coordvals.c1 - 1; // start one before\n\n               if (coordvals.cr1.row > coordvals.cr2.row) { coordvals.r1 = coordvals.cr2.row; coordvals.r2 = coordvals.cr1.row; }\n               else { coordvals.r1 = coordvals.cr1.row; coordvals.r2 = coordvals.cr2.row; }\n               coordvals.r = coordvals.r1; // start on this row\n               coordvals.inrangestart = false;\n               }\n            else { // not first time\n               }\n            coordvals.c += 1; // increment column\n            if (coordvals.c > coordvals.c2) { // finished the columns of this row\n               coordvals.r += 1; // increment row\n               if (coordvals.r > coordvals.r2) { // finished checking the entire range\n                  coordvals.inrange = false;\n                  continue;\n                  }\n               coordvals.c = coordvals.c1; // start at the beginning of next row\n               }\n            rangecoord = SocialCalc.crToCoord(coordvals.c, coordvals.r);\n\n            // now check that one\n\n            coordvals.parsepos = i; // remember our position\n            coordvals.oldcoord = oldcoord; // remember back up chain\n            oldcoord = coord; // come back to us\n            coord = rangecoord;\n            if (checkinfo[coord] && typeof checkinfo[coord] == \"object\") { // Circular reference\n               cell.errors = SocialCalc.Constants.s_caccCircRef+startcoord; // set on original cell making the ref\n               checkinfo[startcoord] = true; // this one should be calculated once at this point\n               if (!recalcdata.firstcalc) {\n                  recalcdata.firstcalc = startcoord;\n                  }\n               else {\n                  recalcdata.calclist[recalcdata.lastcalc] = startcoord;\n                  }\n               recalcdata.lastcalc = startcoord;\n               recalcdata.calclistlength++; // count number on list\n               sheet.attribs.circularreferencecell = coord+\"|\"+oldcoord; // remember at least one circ ref\n               return cell.errors;\n               }\n            continue mainloop;\n            }\n\n         ttype = parseinfo[i].type; // get token details\n         ttext = parseinfo[i].text;\n         if (ttype == token_op) { // references with sheet specifier are not checked\n            if (ttext == \"!\") {\n               sheetref = true; // found a sheet reference\n               }\n            else if (ttext != \":\") { // for everything but a range, reset\n               sheetref = false;\n               }\n            }\n\n         if (ttype == token_name) { // look for named range\n            value = scf.LookupName(sheet, ttext);\n            if (value.type == \"range\") { // only need to recurse here for range, which may be just one cell\n               pos = value.value.indexOf(\"|\");\n               if (pos != -1) { // range - check each cell\n                  coordvals.cr1 = SocialCalc.coordToCr(value.value.substring(0,pos));\n                  pos2 = value.value.indexOf(\"|\", pos+1);\n                  coordvals.cr2 = SocialCalc.coordToCr(value.value.substring(pos+1,pos2));\n                  coordvals.inrange = true;\n                  coordvals.inrangestart = true;\n                  i = i-1; // back up so will start up again here\n                  continue;\n                  }\n               }\n            else if (value.type == \"coord\") { // just a coord\n               ttype = token_coord; // treat as a coord inline\n               ttext = value.value; // and then drop through to next test which should succeed\n               }\n            else { // not a defined name - probably a function\n               }\n            }\n\n         if (ttype == token_coord) { // token is a coord\n\n            if (i >= 2 // look for a range\n             && parseinfo[i-1].type == token_op && parseinfo[i-1].text == ':'\n             && parseinfo[i-2].type == token_coord\n             && !sheetref) { // Range -- check each cell\n               coordvals.cr1 = SocialCalc.coordToCr(parseinfo[i-2].text); // remember range extents\n               coordvals.cr2 = SocialCalc.coordToCr(ttext);\n               coordvals.inrange = true; // next time use the range looping code\n               coordvals.inrangestart = true;\n               i = i-1; // back up so will start up again here\n               continue;\n               }\n\n            else if (!sheetref) { // Single cell reference\n               if (ttext.indexOf(\"$\") != -1) ttext = ttext.replace(/\\$/g, \"\"); // remove any $'s\n               coordvals.parsepos = i+1; // remember our position - come back on next token\n               coordvals.oldcoord = oldcoord; // remember back up chain\n               oldcoord = coord; // come back to us\n               coord = ttext;\n               if (checkinfo[coord] && typeof checkinfo[coord] == \"object\") { // Circular reference\n                  cell.errors = SocialCalc.Constants.s_caccCircRef+startcoord; // set on original cell making the ref\n                  checkinfo[startcoord] = true; // this one should be calculated once at this point\n                  if (!recalcdata.firstcalc) { // add to calclist\n                     recalcdata.firstcalc = startcoord;\n                     }\n                  else {\n                     recalcdata.calclist[recalcdata.lastcalc] = startcoord;\n                     }\n                  recalcdata.lastcalc = startcoord;\n                  recalcdata.calclistlength++; // count number on list\n                  sheet.attribs.circularreferencecell = coord+\"|\"+oldcoord; // remember at least one circ ref\n                  return cell.errors;\n                  }\n               continue mainloop;\n               }\n            }\n         }\n\n      sheetref = false; // make sure off when bump back up\n\n      checkinfo[coord] = true; // this one is finished\n      if (!recalcdata.firstcalc) { // add to calclist\n         recalcdata.firstcalc = coord;\n         }\n      else {\n         recalcdata.calclist[recalcdata.lastcalc] = coord;\n         }\n      recalcdata.lastcalc = coord;\n      recalcdata.calclistlength++; // count number on list\n\n      coord = oldcoord; // go back to the formula that referred to us and continue\n      oldcoord = checkinfo[coord] ? checkinfo[coord].oldcoord : null;\n\n      }\n\n   return \"\";\n\n   }\n\n\n// *************************************\n//\n// Parse class:\n//\n// Used by ExecuteSheetCommand to get elements of commands to execute.\n// The string it works with consists of one or more lines each\n// made up of one or more tokens separated by a delimiter.\n//\n// *************************************\n\n// Initialize: set string to work with\n\nSocialCalc.Parse = function(str) {\n\n   // properties:\n\n   this.str = str;\n   this.pos = 0;\n   this.delimiter = \" \";\n   this.lineEnd = str.indexOf(\"\\n\");\n   if (this.lineEnd < 0) {\n      this.lineEnd = str.length;\n      }\n\n   }\n\n// Return next token as a string\n\nSocialCalc.Parse.prototype.NextToken = function() {\n   if (this.pos < 0) return \"\";\n   var pos2 = this.str.indexOf(this.delimiter, this.pos);\n   var pos1 = this.pos;\n   if (pos2 > this.lineEnd) { // don't go past end of line\n      pos2 = this.lineEnd;\n      }\n   if (pos2 >= 0) {\n      this.pos = pos2 + 1;\n      return this.str.substring(pos1, pos2);\n      }\n   else {\n      this.pos = this.lineEnd;\n      return this.str.substring(pos1, this.lineEnd);\n      }\n   }\n\n// Return everything from current point until end of line\n\nSocialCalc.Parse.prototype.RestOfString = function() {\n   var oldpos = this.pos;\n   if (this.pos < 0 || this.pos >= this.lineEnd) return \"\";\n   this.pos = this.lineEnd;\n   return this.str.substring(oldpos, this.lineEnd);\n   }\n\nSocialCalc.Parse.prototype.RestOfStringNoMove = function() {\n   if (this.pos < 0 || this.pos >= this.lineEnd) return \"\";\n   return this.str.substring(this.pos, this.lineEnd);\n   }\n\n// Move current point to next line\n\nSocialCalc.Parse.prototype.NextLine = function() {\n   this.pos = this.lineEnd + 1;\n   this.lineEnd = this.str.indexOf(\"\\n\", this.pos);\n   if (this.lineEnd < 0) {\n      this.lineEnd = this.str.length;\n      }\n   }\n\n// Check to see if at end of string with no more to process\n\nSocialCalc.Parse.prototype.EOF = function() {\n   if (this.pos < 0 || this.pos >= this.str.length) return true;\n   return false;\n   }\n\n\n// *************************************\n//\n// UndoStack class:\n//\n// Implements the behavior needed for a normal application's undo/redo stack.\n// You add a new change sequence with PushChange.\n// The type argument is a string that can be used to lookup some general string \n// like \"typing\" or \"setting attribute\" for the menu prompts for undo/redo.\n//\n// You add the \"do\" steps with AddDo. The non-null, non-undefined arguments are\n// joined together with \" \" to make a command string to be saved.\n//\n// You add the undo steps as commands for the most recent change with AddUndo.\n// The non-null, non-undefined arguments are joined together with \" \" to make\n// a command string to be saved.\n//\n// The Undo and Redo functions move the Top Of Stack pointer through the changes stack\n// so you can undo and redo. Doing a new PushChange removes all undone items\n// after TOS.\n//\n// You can push more things than you can undo if you want.\n// There is a maximum to remember as the \"did\" stack for an audit trail (and as redo). This may be unlimited.\n// There is a separate maximum to remember that can be undone. This may be smaller than maxRedo.\n//\n// *************************************\n\nSocialCalc.UndoStack = function() {\n\n   // properties:\n\n   this.stack = []; // {command: [], type: type, undo: []} -- multiple dos and undos allowed\n   this.tos = -1; // top of stack position, used for undo/redo\n   this.maxRedo = 0; // Maximum size of redo stack (and audit trail which is this.stack[n].command) or zero if no limit\n   this.maxUndo = 50; // Maximum number of steps kept for undo (usually the memory intensive part) or zero if no limit\n\n   }\n\nSocialCalc.UndoStack.prototype.PushChange = function(type) { // adding a new thing to the stack\n   while (this.stack.length > 0 && this.stack.length-1 > this.tos) { // pop off things not redone\n      this.stack.pop();\n      }\n   this.stack.push({command: [], type: type, undo: []});\n   if (this.maxRedo && this.stack.length > this.maxRedo) { // limit number kept as audit trail\n      this.stack.shift(); // remove the extra one\n      }\n   if (this.maxUndo && this.stack.length > this.maxUndo) { // need to trim excess undo info\n      this.stack[this.stack.length - this.maxUndo - 1].undo = []; // only need to remove one\n      }\n   this.tos = this.stack.length - 1;\n   }\n\nSocialCalc.UndoStack.prototype.AddDo = function() {\n   var args = [];\n   for (var i=0; i<arguments.length; i++) {\n      if (arguments[i]!=null) args.push(arguments[i]); // ignore null or undefined\n      }\n   var cmd = args.join(\" \");\n   this.stack[this.stack.length-1].command.push(cmd);\n   }\n\nSocialCalc.UndoStack.prototype.AddUndo = function() {\n   var args = [];\n   for (var i=0; i<arguments.length; i++) {\n      if (arguments[i]!=null) args.push(arguments[i]); // ignore null or undefined\n      }\n   var cmd = args.join(\" \");\n   this.stack[this.stack.length-1].undo.push(cmd);\n   }\n\nSocialCalc.UndoStack.prototype.TOS = function() {\n   if (this.tos >= 0) return this.stack[this.tos];\n   else return null;\n   }\n\nSocialCalc.UndoStack.prototype.Undo = function() {\n   if (this.tos >= 0 && (!this.maxUndo || this.tos > this.stack.length - this.maxUndo - 1)) {\n      this.tos -= 1;\n      return true;\n      }\n   else {\n      return false;\n      }\n   }\n\nSocialCalc.UndoStack.prototype.Redo = function() {\n   if (this.tos < this.stack.length-1) {\n      this.tos += 1;\n      return true;\n      }\n   else {\n      return false;\n      }\n   }\n\n// *************************************\n//\n// Clipboard Object:\n//\n// This is a single object.\n// Stores the clipboard, which is shared by all active sheets.\n// Like the undo stack, it does not persist from one editing session to another.\n//\n// *************************************\n\nSocialCalc.Clipboard = {\n\n   // properties:\n\n   clipboard:  \"\" // empty or string in save format with \"copiedfrom:\" set to a range\n\n   }\n\n\n// *************************************\n//\n// RenderContext class:\n//\n// *************************************\n\nSocialCalc.RenderContext = function(sheetobj) {\n\n   var parts, num, s;\n   var attribs = sheetobj.attribs;\n   var scc = SocialCalc.Constants;\n\n   // properties:\n\n   this.sheetobj = sheetobj;\n   this.hideRowsCols = false; // Rendering with panes only works with \"false\"\n                              // !!!! Note: not implemented yet in rendering, just saved as an attribute\n   this.showGrid = false;\n   this.showRCHeaders = false;\n   this.rownamewidth = scc.defaultRowNameWidth;\n   this.pixelsPerRow = scc.defaultAssumedRowHeight;\n\n   this.cellskip = {}; // if present, coord of cell covering this cell\n   this.coordToCR = {}; // for cells starting spans, coordToCR[coord]={row:row, col:col}\n   this.colwidth = []; // precomputed column widths, taking into account defaults\n   this.totalwidth = 0; // precomputed total table width\n\n   this.rowpanes = []; // for each pane, {first: firstrow, last: lastrow}\n   this.colpanes = []; // for each pane, {first: firstrow, last: lastrow}\n   this.maxcol=0; // max col and row to display, adding long spans, etc.\n   this.maxrow=0;\n\n   this.highlights = {}; // for each cell with special display: coord:highlightType (see this.highlightTypes)\n   this.cursorsuffix = \"\"; // added to highlights[cr]==\"cursor\" to get type to lookup\n\n   this.highlightTypes = // attributes to change when highlit\n      {\n         cursor: {style: scc.defaultHighlightTypeCursorStyle, className: scc.defaultHighlightTypeCursorClass},\n         range: {style: scc.defaultHighlightTypeRangeStyle, className: scc.defaultHighlightTypeRangeClass},\n         cursorinsertup: {style: \"color:#FFF;backgroundColor:#A6A6A6;backgroundRepeat:repeat-x;backgroundPosition:top left;backgroundImage:url(\"+scc.defaultImagePrefix+\"cursorinsertup.gif);\", className: scc.defaultHighlightTypeCursorClass},\n         cursorinsertleft: {style: \"color:#FFF;backgroundColor:#A6A6A6;backgroundRepeat:repeat-y;backgroundPosition:top left;backgroundImage:url(\"+scc.defaultImagePrefix+\"cursorinsertleft.gif);\", className: scc.defaultHighlightTypeCursorClass},\n         range2: {style: \"color:#000;backgroundColor:#FFF;backgroundImage:url(\"+scc.defaultImagePrefix+\"range2.gif);\", className: \"\"}\n      }\n\n   this.cellIDprefix = scc.defaultCellIDPrefix; // if non-null, each cell will render with an ID\n\n   this.defaultlinkstyle = null; // default linkstyle object (allows you to pass values to link renderer)\n   this.defaultHTMLlinkstyle = {type: \"html\"}; // default linkstyle for standalone HTML\n\n   // constants:\n\n   this.defaultfontstyle = scc.defaultCellFontStyle;\n   this.defaultfontsize = scc.defaultCellFontSize;\n   this.defaultfontfamily = scc.defaultCellFontFamily;\n\n   this.defaultlayout = scc.defaultCellLayout;\n\n   this.defaultpanedividerwidth = scc.defaultPaneDividerWidth;\n   this.defaultpanedividerheight = scc.defaultPaneDividerHeight;\n\n   this.gridCSS = scc.defaultGridCSS;\n\n   this.commentClassName = scc.defaultCommentClass; // for cells with non-blank comments when this.showGrid is true\n   this.commentCSS = scc.defaultCommentStyle; // any combination of classnames and styles may be used\n   this.commentNoGridClassName = scc.defaultCommentNoGridClass; // for cells when this.showGrid is false\n   this.commentNoGridCSS = scc.defaultCommentNoGridStyle; // any combination of classnames and styles may be used\n\n   this.classnames = // any combination of classnames and explicitStyles can be used\n      {\n         colname: scc.defaultColnameClass,\n         rowname: scc.defaultRownameClass,\n         selectedcolname: scc.defaultSelectedColnameClass,\n         selectedrowname: scc.defaultSelectedRownameClass,\n         upperleft: scc.defaultUpperLeftClass,\n         skippedcell: scc.defaultSkippedCellClass,\n         panedivider: scc.defaultPaneDividerClass\n      };\n\n   this.explicitStyles = // these may be used so you won't need a stylesheet with the classnames\n      {\n         colname: scc.defaultColnameStyle,\n         rowname: scc.defaultRownameStyle,\n         selectedcolname: scc.defaultSelectedColnameStyle,\n         selectedrowname: scc.defaultSelectedRownameStyle,\n         upperleft: scc.defaultUpperLeftStyle,\n         skippedcell: scc.defaultSkippedCellStyle,\n         panedivider: scc.defaultPaneDividerStyle\n      };\n\n   // processed info about cell skipping\n\n   this.cellskip = null;\n   this.needcellskip = true;\n\n   // precomputed values, filling in defaults indicated by \"*\"\n\n   this.fonts=[]; // for each fontnum, {style: fs, weight: fw, size: fs, family: ff}\n   this.layouts=[]; // for each layout, \"padding:Tpx Rpx Bpx Lpx;vertical-align:va;\"\n\n   this.needprecompute = true; // need to call PrecomputeSheetFontsAndLayouts\n\n   // if have a sheet object, initialize constants and precomputed values\n\n   if (sheetobj) {\n      this.rowpanes[0] = {first: 1, last: attribs.lastrow};\n      this.colpanes[0] = {first: 1, last: attribs.lastcol};\n\n      }\n   else throw scc.s_rcMissingSheet;\n\n   }\n\n// Methods:\n\nSocialCalc.RenderContext.prototype.PrecomputeSheetFontsAndLayouts = function() {SocialCalc.PrecomputeSheetFontsAndLayouts(this);};\nSocialCalc.RenderContext.prototype.CalculateCellSkipData = function() {SocialCalc.CalculateCellSkipData(this);};\nSocialCalc.RenderContext.prototype.CalculateColWidthData = function() {SocialCalc.CalculateColWidthData(this);};\nSocialCalc.RenderContext.prototype.SetRowPaneFirstLast = function(panenum, first, last) {this.rowpanes[panenum]={first:first, last:last};};\nSocialCalc.RenderContext.prototype.SetColPaneFirstLast = function(panenum, first, last) {this.colpanes[panenum]={first:first, last:last};};\nSocialCalc.RenderContext.prototype.CoordInPane = function(coord, rowpane, colpane) {return SocialCalc.CoordInPane(this, coord, rowpane, colpane);};\nSocialCalc.RenderContext.prototype.CellInPane = function(row, col, rowpane, colpane) {return SocialCalc.CellInPane(this, row, col, rowpane, colpane);};\nSocialCalc.RenderContext.prototype.InitializeTable = function(tableobj) {SocialCalc.InitializeTable(this, tableobj);};\nSocialCalc.RenderContext.prototype.RenderSheet = function(oldtable, linkstyle) {return SocialCalc.RenderSheet(this, oldtable, linkstyle);};\nSocialCalc.RenderContext.prototype.RenderColGroup = function() {return SocialCalc.RenderColGroup(this);};\nSocialCalc.RenderContext.prototype.RenderColHeaders = function() {return SocialCalc.RenderColHeaders(this);};\nSocialCalc.RenderContext.prototype.RenderSizingRow = function() {return SocialCalc.RenderSizingRow(this);};\nSocialCalc.RenderContext.prototype.RenderRow = function(rownum, rowpane, linkstyle) {return SocialCalc.RenderRow(this, rownum, rowpane, linkstyle);};\nSocialCalc.RenderContext.prototype.RenderSpacingRow = function() {return SocialCalc.RenderSpacingRow(this);};\nSocialCalc.RenderContext.prototype.RenderCell = function(rownum, colnum, rowpane, colpane, noElement, linkstyle)\n      {return SocialCalc.RenderCell(this, rownum, colnum, rowpane, colpane, noElement, linkstyle);};\n\n// Functions:\n\nSocialCalc.PrecomputeSheetFontsAndLayouts = function(context) {\n\n   var defaultfont, parts, layoutre, dparts, sparts, num, s, i;\n   var sheetobj = context.sheetobj;\n   var attribs =  sheetobj.attribs;\n\n   if (attribs.defaultfont) {\n      defaultfont = sheetobj.fonts[attribs.defaultfont];\n      defaultfont = defaultfont.replace(/^\\*/,SocialCalc.Constants.defaultCellFontStyle);\n      defaultfont = defaultfont.replace(/(.+)\\*(.+)/,\"$1\"+SocialCalc.Constants.defaultCellFontSize+\"$2\");\n      defaultfont = defaultfont.replace(/\\*$/,SocialCalc.Constants.defaultCellFontFamily);\n      parts=defaultfont.match(/^(\\S+? \\S+?) (\\S+?) (\\S.*)$/);\n      context.defaultfontstyle = parts[1];\n      context.defaultfontsize = parts[2];\n      context.defaultfontfamily = parts[3];\n      }\n\n   for (num=1; num<sheetobj.fonts.length; num++) { // precompute fonts by filling in the *'s\n      s=sheetobj.fonts[num];\n      s=s.replace(/^\\*/,context.defaultfontstyle);\n      s=s.replace(/(.+)\\*(.+)/,\"$1\"+context.defaultfontsize+\"$2\");\n      s=s.replace(/\\*$/,context.defaultfontfamily);\n      parts=s.match(/^(\\S+?) (\\S+?) (\\S+?) (\\S.*)$/);\n      context.fonts[num] = {style: parts[1], weight: parts[2], size: parts[3], family: parts[4]};\n\n      }\n\n   layoutre = /^padding:\\s*(\\S+)\\s+(\\S+)\\s+(\\S+)\\s+(\\S+);vertical-align:\\s*(\\S+);/;\n   dparts = SocialCalc.Constants.defaultCellLayout.match(layoutre); // get built-in defaults\n\n   if (attribs.defaultlayout) {\n      sparts = sheetobj.layouts[attribs.defaultlayout].match(layoutre); // get sheet defaults, if set\n      }\n   else {\n      sparts = [\"\", \"*\", \"*\", \"*\", \"*\", \"*\"];\n      }\n\n   for (num=1; num<sheetobj.layouts.length; num++) { // precompute layouts by filling in the *'s\n      s=sheetobj.layouts[num];\n      parts = s.match(layoutre);\n      for (i=1; i<=5; i++) {\n         if (parts[i]==\"*\") {\n            parts[i] = (sparts[i] != \"*\" ? sparts[i] : dparts[i]); // if *, sheet default or built-in\n            }\n         }\n      context.layouts[num] = \"padding:\"+parts[1]+\" \"+parts[2]+\" \"+parts[3]+\" \"+parts[4]+\n         \";vertical-align:\"+parts[5]+\";\";\n      }\n\n   context.needprecompute = false;\n\n   }\n\nSocialCalc.CalculateCellSkipData = function(context) {\n\n   var row, col, coord, cell, contextcell, colspan, rowspan, skiprow, skipcol, skipcoord;\n\n   var sheetobj=context.sheetobj;\n   var sheetrowattribs=sheetobj.rowattribs;\n   var sheetcolattribs=sheetobj.colattribs;\n   context.maxrow=0;\n   context.maxcol=0;\n   context.cellskip = {}; // reset\n\n   // Calculate cellskip data\n\n   for (row=1; row<=sheetobj.attribs.lastrow; row++) {\n      for (col=1; col<=sheetobj.attribs.lastcol; col++) { // look for spans and set cellskip for skipped cells\n         coord=SocialCalc.crToCoord(col, row);\n         cell=sheetobj.cells[coord];\n         // don't look at undefined cells (they have no spans) or skipped cells\n         if (cell===undefined || context.cellskip[coord]) continue;\n         colspan=cell.colspan || 1;\n         rowspan=cell.rowspan || 1;\n         if (colspan>1 || rowspan>1) {\n            for (skiprow=row; skiprow<row+rowspan; skiprow++) {\n               for (skipcol=col; skipcol<col+colspan; skipcol++) { // do the setting on individual cells\n                  skipcoord=SocialCalc.crToCoord(skipcol,skiprow);\n                  if (skipcoord==coord) { // for coord, remember row and col\n                     context.coordToCR[coord]={row: row, col: col};\n                     }\n                  else { // for other cells, flag with coord of here\n                     context.cellskip[skipcoord]=coord;\n                     }\n                  if (skiprow>context.maxrow) maxrow=skiprow;\n                  if (skipcol>context.maxcol) maxcol=skipcol;\n                  }\n               }\n            }\n         }\n      }\n\n   context.needcellskip = false;\n\n   }\n\nSocialCalc.CalculateColWidthData = function(context) {\n\n   var colnum, colname, colwidth, totalwidth;\n\n   var sheetobj=context.sheetobj;\n   var sheetcolattribs=sheetobj.colattribs;\n\n   // Calculate column width data\n\n   totalwidth=context.showRCHeaders ? context.rownamewidth-0 : 0;\n   for (colpane=0; colpane<context.colpanes.length; colpane++) {\n      for (colnum=context.colpanes[colpane].first; colnum<=context.colpanes[colpane].last; colnum++) {\n         colname=SocialCalc.rcColname(colnum);\n         colwidth = sheetobj.colattribs.width[colname] || sheetobj.attribs.defaultcolwidth || SocialCalc.Constants.defaultColWidth;\n         if (colwidth==\"blank\" || colwidth==\"auto\") colwidth=\"\";\n         context.colwidth[colnum]=colwidth+\"\";\n         totalwidth+=(colwidth && ((colwidth-0)>0)) ? (colwidth-0) : 10;\n         }\n      }\n   context.totalwidth = totalwidth;\n\n   }\n\nSocialCalc.InitializeTable = function(context, tableobj) {\n\n/*\n\nUses border-collapse so corners don't have holes\nNote: IE and Firefox handle <col> differently (IE adds borders and padding)\nunder border-collapse and Safari has problems with <col> and wide text\nTablelayout \"fixed\" also leads to problems\n\n*/\n\n/*\n\n*** Discussion ***\n\nThe rendering assumes fixed column widths, even though SocialCalc allows \"auto\".\nThere may be issues with \"auto\" and it is hard to make it work cross-browser\nwith border-collapse, etc.\n\nThis and the RenderSheet routine are where in the code the specifics of\ntable attributes and column size definitions are set. As the browsers settle down\nand when we decide if we don't need auto width, we may want to revisit the way the\ncode does this (e.g., use table-layout:fixed).\n\n*/\n   tableobj.style.borderCollapse=\"collapse\";\n   tableobj.cellSpacing=\"0\";\n   tableobj.cellPadding=\"0\";\n\n   tableobj.style.width=context.totalwidth+\"px\";\n\n   }\n\n//\n// tableobj = SocialCalc.RenderSheet(context, oldtable, linkstyle)\n//\n// Renders a render context returning a DOM table object.\n// If there is an oldtable object, it replaces it in the parent node.\n// If oldtable is null, it just returns the new one.\n// The linkstyle is \"\" or null for editing rendering\n// and optionally an object passed on to formatting code.\n//\n\nSocialCalc.RenderSheet = function(context, oldtable, linkstyle) {\n\n   var newrow, rowpane;\n   var tableobj, colgroupobj, tbodyobj, parentnode;\n\n   // do precompute stuff if necessary\n\n   if (context.sheetobj.changedrendervalues) {\n      context.needcellskip = true;\n      context.needprecompute = true;\n      context.sheetobj.changedrendervalues = false;\n      }\n   if (context.needcellskip) {\n      context.CalculateCellSkipData();\n      }\n   if (context.needprecompute) {\n      context.PrecomputeSheetFontsAndLayouts();\n      }\n\n   context.CalculateColWidthData(); // always make sure col width values are up to date\n\n   // make the table element and fill it in\n\n   tableobj=document.createElement(\"table\");\n   context.InitializeTable(tableobj);\n\n   colgroupobj=context.RenderColGroup();\n   tableobj.appendChild(colgroupobj);\n\n   tbodyobj=document.createElement(\"tbody\");\n\n   tbodyobj.appendChild(context.RenderSizingRow());\n\n   if (context.showRCHeaders) {\n      newrow=context.RenderColHeaders();\n      if (newrow) tbodyobj.appendChild(newrow);\n      }\n\n   for (rowpane=0; rowpane<context.rowpanes.length; rowpane++) {\n      for (rownum=context.rowpanes[rowpane].first;rownum<=context.rowpanes[rowpane].last;rownum++) {\n         newrow=context.RenderRow(rownum, rowpane, linkstyle);\n         tbodyobj.appendChild(newrow);\n         }\n      if (rowpane<context.rowpanes.length-1) {\n         newrow=context.RenderSpacingRow();\n         tbodyobj.appendChild(newrow);\n         }\n      }\n\n   tableobj.appendChild(tbodyobj);\n\n   if (oldtable) {\n      parentnode = oldtable.parentNode;\n      if (parentnode) parentnode.replaceChild(tableobj, oldtable);\n      }\n\n   SocialCalc.EvalUserScripts();\n\n   return tableobj;\n\n   }\n\nSocialCalc.RenderRow = function(context, rownum, rowpane, linkstyle) {\n\n   var sheetobj=context.sheetobj;\n\n   var result=document.createElement(\"tr\");\n   var colnum, newcol, colpane, newdiv;\n\n   if (context.showRCHeaders) {\n      newcol=document.createElement(\"td\");\n      if (context.classnames) newcol.className=context.classnames.rowname;\n      if (context.explicitStyles) newcol.style.cssText=context.explicitStyles.rowname;\n      newcol.width=context.rownamewidth;\n      newcol.style.verticalAlign=\"top\"; // to get around Safari making top of centered row number be\n                                        // considered top of row (and can't get <row> position in Safari)\n      if (!SocialCalc.Constants.SCNoRowName) {\n     newcol.innerHTML=rownum+\"\";\n      }\n      result.appendChild(newcol);\n      }\n\n   for (colpane=0; colpane<context.colpanes.length; colpane++) {\n      for (colnum=context.colpanes[colpane].first; colnum<=context.colpanes[colpane].last; colnum++) {\n         newcol=context.RenderCell(rownum, colnum, rowpane, colpane, null, linkstyle);\n         if (newcol) result.appendChild(newcol);\n         }\n      if (colpane<context.colpanes.length-1) {\n         newcol=document.createElement(\"td\");\n         newcol.width=context.defaultpanedividerwidth;\n         if (context.classnames.panedivider) newcol.className=context.classnames.panedivider;\n         if (context.explicitStyles.panedivider) newcol.style.cssText=context.explicitStyles.panedivider;\n         newdiv=document.createElement(\"div\"); // for Firefox to avoid squishing\n         newdiv.style.width=context.defaultpanedividerwidth+\"px\";\n         newdiv.style.overflow=\"hidden\";\n         newcol.appendChild(newdiv);\n         result.appendChild(newcol);\n         }\n      }\n   return result;\n   }\n\nSocialCalc.RenderSpacingRow = function(context) {\n\n   var colnum, newcol, colpane, w;\n\n   var sheetobj=context.sheetobj;\n\n   var result=document.createElement(\"tr\");\n\n   if (context.showRCHeaders) {\n      newcol=document.createElement(\"td\");\n      newcol.width=context.rownamewidth;\n      newcol.height=context.defaultpanedividerheight;\n      if (context.classnames.panedivider) newcol.className=context.classnames.panedivider;\n      if (context.explicitStyles.panedivider) newcol.style.cssText=context.explicitStyles.panedivider;\n      result.appendChild(newcol);\n      }\n\n   for (colpane=0; colpane<context.colpanes.length; colpane++) {\n      for (colnum=context.colpanes[colpane].first; colnum<=context.colpanes[colpane].last; colnum++) {\n         newcol=document.createElement(\"td\");\n         w = context.colwidth[colnum];\n         if (w) newcol.width=w;\n         newcol.height=context.defaultpanedividerheight;\n         if (context.classnames.panedivider) newcol.className=context.classnames.panedivider;\n         if (context.explicitStyles.panedivider) newcol.style.cssText=context.explicitStyles.panedivider;\n         if (newcol) result.appendChild(newcol);\n         }\n      if (colpane<context.colpanes.length-1) {\n         newcol=document.createElement(\"td\");\n         newcol.width=context.defaultpanedividerwidth;\n         newcol.height=context.defaultpanedividerheight;\n         if (context.classnames.panedivider) newcol.className=context.classnames.panedivider;\n         if (context.explicitStyles.panedivider) newcol.style.cssText=context.explicitStyles.panedivider;\n         result.appendChild(newcol);\n         }\n      }\n   return result;\n   }\n\nSocialCalc.RenderColHeaders = function(context) {\n\n   var sheetobj=context.sheetobj;\n\n   var result=document.createElement(\"tr\");\n   var colnum, newcol;\n\n   if (!context.showRCHeaders) return null;\n\n   newcol=document.createElement(\"td\");\n   if (context.classnames) newcol.className=context.classnames.upperleft;\n   if (context.explicitStyles) newcol.style.cssText=context.explicitStyles.upperleft;\n   newcol.width=context.rownamewidth;\n   result.appendChild(newcol);\n\n   for (colpane=0; colpane<context.colpanes.length; colpane++) {\n      for (colnum=context.colpanes[colpane].first; colnum<=context.colpanes[colpane].last; colnum++) {\n         newcol=document.createElement(\"td\");\n         if (context.classnames) newcol.className=context.classnames.colname;\n         if (context.explicitStyles) newcol.style.cssText=context.explicitStyles.colname;\n    if (SocialCalc.Constants.SCNoColNames) {\n       // newcol.innerHTML=\"&nbsp;\";\n       // newcol.innerHTML=\"\";\n    } else {\n             newcol.innerHTML=SocialCalc.rcColname(colnum);\n    }\n         result.appendChild(newcol);\n         }\n      if (colpane<context.colpanes.length-1) {\n         newcol=document.createElement(\"td\");\n         newcol.width=context.defaultpanedividerwidth;\n         if (context.classnames.panedivider) newcol.className=context.classnames.panedivider;\n         if (context.explicitStyles.panedivider) newcol.style.cssText=context.explicitStyles.panedivider;\n         result.appendChild(newcol);\n         }\n      }\n   return result;\n   }\n\nSocialCalc.RenderColGroup = function(context) {\n\n   var colpane, colnum, newcol, t;\n   var sheetobj=context.sheetobj;\n\n   var result=document.createElement(\"colgroup\");\n\n   if (context.showRCHeaders) {\n      newcol=document.createElement(\"col\");\n      newcol.width=context.rownamewidth;\n      result.appendChild(newcol);\n      }\n\n   for (colpane=0; colpane<context.colpanes.length; colpane++) {\n      for (colnum=context.colpanes[colpane].first; colnum<=context.colpanes[colpane].last; colnum++) {\n         newcol=document.createElement(\"col\");\n         t = context.colwidth[colnum];\n         if (t) newcol.width=t;\n         result.appendChild(newcol);\n         }\n      if (colpane<context.colpanes.length-1) {\n         newcol=document.createElement(\"col\");\n         newcol.width=context.defaultpanedividerwidth;\n         result.appendChild(newcol);\n         }\n      }\n   return result;\n   }\n\nSocialCalc.RenderSizingRow = function(context) {\n\n   var colpane, colnum, newcell, t;\n   var sheetobj=context.sheetobj;\n\n   var result=document.createElement(\"tr\");\n\n   if (context.showRCHeaders) {\n      newcell=document.createElement(\"td\");\n      newcell.style.width=context.rownamewidth+\"px\";\n      newcell.height=\"1\";\n      result.appendChild(newcell);\n      }\n\n   for (colpane=0; colpane<context.colpanes.length; colpane++) {\n      for (colnum=context.colpanes[colpane].first; colnum<=context.colpanes[colpane].last; colnum++) {\n         newcell=document.createElement(\"td\");\n         t = context.colwidth[colnum];\n         if (t) newcell.width=t;\n         newcell.height=\"1\";\n         result.appendChild(newcell);\n         }\n      if (colpane<context.colpanes.length-1) {\n         newcell=document.createElement(\"td\");\n         newcell.width=context.defaultpanedividerwidth;\n         newcell.height=\"1\";\n         result.appendChild(newcell);\n         }\n      }\n   return result;\n   }\n\nSocialCalc.RenderCell = function(context, rownum, colnum, rowpane, colpane, noElement, linkstyle) {\n\n   var sheetobj=context.sheetobj;\n\n   var num, t, result, span, stylename, cell, sheetattribs, scdefaults;\n   var stylestr=\"\";\n\n   rownum = rownum-0; // make sure a number\n   colnum = colnum-0;\n\n   var coord=SocialCalc.crToCoord(colnum, rownum);\n\n   if (context.cellskip[coord]) { // skip if within a span\n      if (context.CoordInPane(context.cellskip[coord], rowpane, colpane)) {\n         return null; // span starts in this pane -- so just skip\n         }\n      result=noElement ? SocialCalc.CreatePseudoElement() : document.createElement(\"td\"); // span start is scrolled away, so make a special cell\n      if (context.classnames.skippedcell) result.className=context.classnames.skippedcell;\n      if (context.explicitStyles.skippedcell) result.style.cssText=context.explicitStyles.skippedcell;\n      result.innerHTML=\"&nbsp;\"; // put something there so height is OK\n      // !!! Really need to add borders in case there isn't anything else shown in the pane to get height\n      return result;\n      }\n\n   result=noElement ? SocialCalc.CreatePseudoElement() : document.createElement(\"td\");\n\n   if (context.cellIDprefix) {\n      result.id = context.cellIDprefix+coord;\n      }\n\n   cell=sheetobj.cells[coord];\n\n   if (!cell) {\n      cell=new SocialCalc.Cell(coord);\n      }\n\n   sheetattribs=sheetobj.attribs;\n   scc=SocialCalc.Constants;\n\n   if (cell.colspan>1) {\n      span=1;\n      for (num=1; num<cell.colspan; num++) {\n          if (sheetobj.colattribs.hide[SocialCalc.rcColname(colnum+num)]!=\"yes\" &&\n                context.CellInPane(rownum, colnum+num, rowpane, colpane)) {\n             span++;\n             }\n          }\n      result.colSpan=span;\n      }\n\n   if (cell.rowspan>1) {\n      span=1;\n      for (num=1; num<cell.rowspan; num++) {\n          if (sheetobj.rowattribs.hide[(rownum+num)+\"\"]!=\"yes\" &&\n                context.CellInPane(rownum+num, colnum, rowpane, colpane))\n             span++;\n         }\n      result.rowSpan=span;\n      }\n\n   if (cell.displaystring==undefined) { // cache the display value\n      cell.displaystring = SocialCalc.FormatValueForDisplay(sheetobj, cell.datavalue, coord, (linkstyle || context.defaultlinkstyle));\n   } else {\n     // callout to execute scripts if needed\n     SocialCalc.CallOutOnRenderCell(sheetobj, cell.datavalue, coord);\n   }\n   result.innerHTML = cell.displaystring;\n\n   num=cell.layout || sheetattribs.defaultlayout;\n   if (num) {\n      stylestr+=context.layouts[num]; // use precomputed layout with \"*\"'s filled in\n      }\n   else {\n      stylestr+=scc.defaultCellLayout;\n      }\n\n   num=cell.font || sheetattribs.defaultfont;\n   if (num) { // get expanded font strings in context\n      t = context.fonts[num]; // do each - plain \"font:\" style sets all sorts of other values, too (Safari font-stretch problem on cssText)\n      stylestr+=\"font-style:\"+t.style+\";font-weight:\"+t.weight+\";font-size:\"+t.size+\";font-family:\"+t.family+\";\";\n      }\n   else {\n      if (scc.defaultCellFontSize) {\n         stylestr+=\"font-size:\"+scc.defaultCellFontSize+\";\";\n         }\n      if (scc.defaultCellFontFamily) {\n         stylestr+=\"font-family:\"+scc.defaultCellFontFamily+\";\";\n         }\n      }\n\n   num=cell.color || sheetattribs.defaultcolor;\n   if (num) stylestr+=\"color:\"+sheetobj.colors[num]+\";\";\n\n   num=cell.bgcolor || sheetattribs.defaultbgcolor;\n   if (num) stylestr+=\"background-color:\"+sheetobj.colors[num]+\";\";\n\n   num=cell.cellformat;\n   if (num) {\n      stylestr+=\"text-align:\"+sheetobj.cellformats[num]+\";\";\n      }\n   else {\n      t=cell.valuetype.charAt(0);\n      if (t==\"t\") {\n         num=sheetattribs.defaulttextformat;\n         if (num) stylestr+=\"text-align:\"+sheetobj.cellformats[num]+\";\";\n         }\n      else if (t=\"n\") {\n         num=sheetattribs.defaultnontextformat;\n         if (num) {\n            stylestr+=\"text-align:\"+sheetobj.cellformats[num]+\";\";\n            }\n         else {\n            stylestr+=\"text-align:right;\";\n            }\n         }\n      else stylestr+=\"text-align:left;\";\n      }\n\n   num=cell.bt;\n   if (num) stylestr+=\"border-top:\"+sheetobj.borderstyles[num]+\";\";\n\n   num=cell.br;\n   if (num) stylestr+=\"border-right:\"+sheetobj.borderstyles[num]+\";\";\n   else if (context.showGrid) {\n      if (context.CellInPane(rownum, colnum+(cell.colspan || 1), rowpane, colpane))\n         t=SocialCalc.crToCoord(colnum+(cell.colspan || 1), rownum);\n      else t=\"nomatch\";\n      if (context.cellskip[t]) t=context.cellskip[t];\n      if (!sheetobj.cells[t] || !sheetobj.cells[t].bl)\n         stylestr+=\"border-right:\"+context.gridCSS;\n      }\n\n   num=cell.bb;\n   if (num) stylestr+=\"border-bottom:\"+sheetobj.borderstyles[num]+\";\";\n   else if (context.showGrid) {\n      if (context.CellInPane(rownum+(cell.rowspan || 1), colnum, rowpane, colpane))\n         t=SocialCalc.crToCoord(colnum, rownum+(cell.rowspan || 1));\n      else t=\"nomatch\";\n      if (context.cellskip[t]) t=context.cellskip[t];\n      if (!sheetobj.cells[t] || !sheetobj.cells[t].bt)\n         stylestr+=\"border-bottom:\"+context.gridCSS;\n      }\n\n   num=cell.bl;\n   if (num) stylestr+=\"border-left:\"+sheetobj.borderstyles[num]+\";\";\n\n   if (cell.comment) {\n      if (context.showGrid) {\n         if (context.commentClassName) {\n            result.className = (result.className ? result.className+\" \" : \"\") + context.commentClassName;\n            }\n         stylestr+=context.commentCSS;\n         }\n      else {\n         if (context.commentNoGridClassName) {\n            result.className = (result.className ? result.className+\" \" : \"\") + context.commentNoGridClassName;\n            }\n         stylestr+=context.commentNoGridCSS;\n         }\n      }\n\n   result.style.cssText=stylestr;\n\n   //!!!!!!!!!\n   // NOTE: csss and cssc are not supported yet.\n   // csss needs to be parsed into pieces to override just the attributes specified, not all with assignment to cssText.\n   // cssc just needs to set the className.\n\n   t = context.highlights[coord];\n   if (t) { // this is a highlit cell: Override style appropriately\n      if (t==\"cursor\") t += context.cursorsuffix; // cursor can take alternative forms\n      if (context.highlightTypes[t].className) {\n         result.className = (result.className ? result.className+\" \" : \"\") + context.highlightTypes[t].className;\n         }\n      // only if cell is editable, set the cursor class\n      if (t==\"cursor\" && SocialCalc.Callbacks.IsCoordEditable &&\n          !SocialCalc.Callbacks.IsCoordEditable(context.sheetobj.sheetname+\"!\"+coord)) {\n     SocialCalc.setStyles(result, \"\");                  \n      }\n      else {\n     SocialCalc.setStyles(result, context.highlightTypes[t].style);    \n      }\n\n   }\n\n   return result;\n}\n\nSocialCalc.CoordInPane = function(context, coord, rowpane, colpane) {\n   var coordToCR = context.coordToCR[coord];\n   if (!coordToCR || !coordToCR.row || !coordToCR.col) throw \"Bad coordToCR for \"+coord;\n   return context.CellInPane(coordToCR.row, coordToCR.col, rowpane, colpane);\n   }\n\n\nSocialCalc.CellInPane = function(context, row, col, rowpane, colpane) {\n   var panerowlimits = context.rowpanes[rowpane];\n   var panecollimits = context.colpanes[colpane];\n   if (!panerowlimits || !panecollimits) throw \"CellInPane called with unknown panes \"+rowpane+\"/\"+colpane;\n   if (row < panerowlimits.first || row > panerowlimits.last) return false;\n   if (col < panecollimits.first || col > panecollimits.last) return false;\n   return true;\n   }\n\nSocialCalc.CreatePseudoElement = function() {\n   return {style:{cssText:\"\"}, innerHTML: \"\", className: \"\"};\n   }\n\n\n// *************************************\n//\n// Misc. functions:\n//\n// *************************************\n\nSocialCalc.rcColname = function(c) {\n\n   if (c > 702) c = 702; // maximum number of columns - ZZ\n   if (c < 1) c = 1;\n   var collow = (c - 1) % 26 + 65;\n   var colhigh = Math.floor((c - 1) / 26);\n   if (colhigh)\n      return String.fromCharCode(colhigh + 64) + String.fromCharCode(collow);\n   else\n      return String.fromCharCode(collow);\n   }\n\nSocialCalc.letters = [\"A\",\"B\",\"C\",\"D\",\"E\",\"F\",\"G\",\"H\",\"I\",\"J\",\"K\",\"L\",\"M\",\n                      \"N\",\"O\",\"P\",\"Q\",\"R\",\"S\",\"T\",\"U\",\"V\",\"W\",\"X\",\"Y\",\"Z\"];\n\nSocialCalc.crToCoord = function(c, r) {\n   var result;\n   if (c < 1) c = 1;\n   if (c > 702) c = 702; // maximum number of columns - ZZ\n   if (r < 1) r = 1;\n   var collow = (c - 1) % 26;\n   var colhigh = Math.floor((c - 1) / 26);\n   if (colhigh)\n      result = SocialCalc.letters[colhigh-1] + SocialCalc.letters[collow] + r;\n   else\n      result = SocialCalc.letters[collow] + r;\n   return result;\n   }\n\nSocialCalc.coordToCol = {}; // too expensive to set in crToCoord since that is called so many times\nSocialCalc.coordToRow = {};\n\nSocialCalc.coordToCr = function(cr) {\n   var c, i, ch;\n   var r = SocialCalc.coordToRow[cr];\n   if (r) return {row: r, col: SocialCalc.coordToCol[cr]};\n   c=0;r=0;\n   for (i=0; i<cr.length; i++) { // this was faster than using regexes; assumes well-formed\n      ch = cr.charCodeAt(i);\n      if (ch==36) ; // skip $'s\n      else if (ch<=57) r = 10*r + ch-48;\n      else if (ch>=97) c = 26*c + ch-96;\n      else if (ch>=65) c = 26*c + ch-64;\n      }\n   SocialCalc.coordToCol[cr] = c;\n   SocialCalc.coordToRow[cr] = r;\n   return {row: r, col: c};\n\n   }\n\nSocialCalc.ParseRange = function(range) {\n   var pos, cr, cr1, cr2;\n   if (!range) range = \"A1:A1\"; // error return, hopefully benign\n   range = range.toUpperCase();\n   pos = range.indexOf(\":\");\n   if (pos>=0) {\n      cr = range.substring(0,pos);\n      cr1 = SocialCalc.coordToCr(cr);\n      cr1.coord = cr;\n      cr = range.substring(pos+1);\n      cr2 = SocialCalc.coordToCr(cr);\n      cr2.coord = cr;\n      }\n   else {\n      cr1 = SocialCalc.coordToCr(range);\n      cr1.coord = range;\n      cr2 = SocialCalc.coordToCr(range);\n      cr2.coord = range;\n      }\n   return {cr1: cr1, cr2: cr2};\n   }\n\nSocialCalc.decodeFromSave = function(s) {\n   if (typeof s != \"string\") return s;\n   if (s.indexOf(\"\\\\\")==-1) return s; // for performace reasons: replace nothing takes up time\n   var r=s.replace(/\\\\c/g,\":\");\n   r=r.replace(/\\\\n/g,\"\\n\");\n   return r.replace(/\\\\b/g,\"\\\\\");\n   }\n\nSocialCalc.decodeFromAjax = function(s) {\n   if (typeof s != \"string\") return s;\n   if (s.indexOf(\"\\\\\")==-1) return s; // for performace reasons: replace nothing takes up time\n   var r=s.replace(/\\\\c/g,\":\");\n   r=r.replace(/\\\\n/g,\"\\n\");\n   r=r.replace(/\\\\e/g,\"]]\");\n   return r.replace(/\\\\b/g,\"\\\\\");\n   }\n\nSocialCalc.encodeForSave = function(s) {\n   if (typeof s != \"string\") return s;\n   if (s.indexOf(\"\\\\\")!=-1) // for performace reasons: replace nothing takes up time\n      s=s.replace(/\\\\/g,\"\\\\b\");\n   if (s.indexOf(\":\")!=-1)\n      s=s.replace(/:/g,\"\\\\c\");\n   if (s.indexOf(\"\\n\")!=-1)\n      s=s.replace(/\\n/g,\"\\\\n\");\n   return s;\n   }\n\n//\n// Returns estring where &, <, >, \" are HTML escaped\n// \nSocialCalc.special_chars = function(string) {\n\n   if (/[&<>\"]/.test(string)) { // only do \"slow\" replaces if something to replace\n      string = string.replace(/&/g, \"&amp;\");\n      string = string.replace(/</g, \"&lt;\");\n      string = string.replace(/>/g, \"&gt;\");\n      string = string.replace(/\"/g, \"&quot;\");\n      }\n   return string;\n\n   }\n\nSocialCalc.Lookup = function(value, list) {\n\n   for (i=0; i<list.length; i++) {\n      if (list[i] > value) {\n         if (i>0) return i-1;\n         else return null;\n         }\n      }\n   return list.length-1; // if all smaller, matches last\n\n   }\n\n//\n// setStyles(element, cssText)\n//\n// Takes a pseudo style string (e.g., text-align must be textAlign) and sets\n// the element's style value for each style name listed (leaving others unchanged).\n// OK to call with null cssText.\n//\n\nSocialCalc.setStyles = function (element, cssText) {\n\n   var parts, part, pos, name, value;\n\n   if (!cssText) return;\n\n   parts = cssText.split(\";\");\n   for (part=0; part<parts.length; part++) {\n      pos = parts[part].indexOf(\":\"); // find first colon (could be one in url)\n      if (pos != -1) {\n         name = parts[part].substring(0, pos);\n         value = parts[part].substring(pos+1);\n         if (name && value) { // if non-null name and value, set style\n            element.style[name] = value;\n            }\n         }\n//      namevalue = parts[part].split(\":\");\n//      if (namevalue[0]) element.style[namevalue[0]] = namevalue[1];\n      }\n\n   }\n\n//\n// GetViewportInfo() - returns object with viewport width and height, and scroll offsets\n//\n// Flanagan, JavaScript, 5th Edition, page 276\n//\n\nSocialCalc.GetViewportInfo = function () {\n\n   var result = {};\n\n   if (window.innerWidth) { // all but IE\n      result.width = window.innerWidth;\n      result.height = window.innerHeight;\n      result.horizontalScroll = window.pageXOffset;\n      result.verticalScroll = window.pageYOffset;\n      }\n   else {\n      if (document.documentElement && document.documentElement.clientWidth) {\n         result.width = document.documentElement.clientWidth;\n         result.height = document.documentElement.clientHeight;\n         result.horizontalScroll = document.documentElement.scrollLeft;\n         result.verticalScroll = document.documentElement.scrollTop;\n         }\n      else if (document.body.clientWidth) {\n         result.width = document.body.clientWidth;\n         result.height = document.body.clientHeight;\n         result.horizontalScroll = document.body.scrollLeft;\n         result.verticalScroll = document.body.scrollTop;\n         }\n      }\n\n   return result;\n   }\n\n//\n// GetElementPosition(element) - returns object with left and top position of the element in the document\n//\n// Goodman's JavaScript & DHTML Cookbook, 2nd Edition, page 415\n//\n\nSocialCalc.GetElementPosition = function (element) {\n\n   var offsetLeft = 0;\n   var offsetTop = 0;\n   while (element) {\n      offsetLeft+=element.offsetLeft;\n      offsetTop+=element.offsetTop;\n      element=element.offsetParent;\n      }\n   return {left:offsetLeft, top:offsetTop};\n\n   }\n\n//\n// GetElementPositionWithScroll(element) - returns object with left and top position of the element in the document\n//\n// Takes into account scroll offsets by going through entire tree\n//\n\nSocialCalc.GetElementPositionWithScroll = function (element) {\n\n   var offsetLeft = 0;\n   var offsetTop = 0;\n   var offsetElement = element;\n   while (element) {\n      if (element.tagName==\"HTML\") break;\n      if (element == offsetElement) {\n         offsetLeft+=element.offsetLeft;\n         offsetTop+=element.offsetTop;\n         offsetElement = element.offsetParent;\n         }\n      if (element.scrollLeft) {\n         offsetLeft-=element.scrollLeft;\n         }\n      if (element.scrollTop) {\n         offsetTop-=element.scrollTop;\n         }\n      element=element.parentNode;\n      }\n   return {left:offsetLeft, top:offsetTop};\n\n   }\n\n//\n// LookupElement(element, array) - returns array element which is an object with \"element\" of element\n//\n\nSocialCalc.LookupElement = function (element, array) {\n\n   var i;\n   for (i=0; i<array.length; i++) {\n      if (array[i].element == element) return array[i];\n      }\n   return null;\n\n   }\n\n//\n// AssignID(obj, element, id) - Optionally assigns an ID with a prefix to the element\n//\n\nSocialCalc.AssignID = function (obj, element, id) {\n\n   if (obj.idPrefix) { // Object must have a non-empty idPrefix attribute\n      element.id = obj.idPrefix + id;\n      }\n\n   }\n\n//\n// SocialCalc.GetCellContents(sheetobj, coord)\n//\n// Returns the contents (value, formula, constant, etc.) of a cell\n// with appropriate prefix (\"'\", \"=\", etc.)\n//\n\nSocialCalc.GetCellContents = function(sheetobj, coord) {\n\n   var result = \"\";\n   var cellobj = sheetobj.cells[coord];\n   if (cellobj) {\n      switch (cellobj.datatype) {\n         case \"v\":\n            result = cellobj.datavalue+\"\";\n            break;\n         case \"t\":\n            result = \"'\"+cellobj.datavalue;\n            break;\n         case \"f\":\n            result = \"=\"+cellobj.formula;\n            break;\n         case \"c\":\n            result = cellobj.formula;\n            break;\n         default:\n            break;\n         }\n      }\n\n   return result;\n\n   }\n\n//\n// Routines translated from the SocialCalc 1.1.0 Perl code:\n//\n// (Makes use of the FormatNumber JavaScript code translated from the Perl.)\n//\n\n//\n// displayvalue = FormatValueForDisplay(sheetobj, value, cr, linkstyle)\n//\n// Returns a string, in HTML, for the contents of a cell.\n//\n// The value is a either numeric or text, the cr is the coord of the cell\n// (its cell properties are used to determine formatting), and linkstyle\n// is a value passed to wiki-text expansion routines specifying the\n// purpose of the rendering so, for example, links can be rendered differently\n// during edit than with plain HTML.\n//\n\nSocialCalc.FormatValueForDisplay = function(sheetobj, value, cr, linkstyle) {\n\n   var valueformat, has_parens, has_commas, valuetype, valuesubtype;\n   var displayvalue;\n\n   var sheetattribs=sheetobj.attribs;\n   var scc=SocialCalc.Constants;\n\n   var cell=sheetobj.cells[cr];\n\n   if (!cell) { // get an empty cell if not there\n      cell=new SocialCalc.Cell(cr);\n      }\n\n   displayvalue = value;\n\n   valuetype = cell.valuetype || \"\"; // get type of value to determine formatting\n   valuesubtype = valuetype.substring(1);\n   valuetype = valuetype.charAt(0);\n\n   if (cell.errors || valuetype==\"e\") {\n      displayvalue = cell.errors || valuesubtype || \"Error in cell\";\n      return displayvalue;\n      }\n\n   if (valuetype==\"t\") {\n      valueformat = sheetobj.valueformats[cell.textvalueformat-0] || sheetobj.valueformats[sheetattribs.defaulttextvalueformat-0] || \"\";\n      if (valueformat==\"formula\") {\n         if (cell.datatype==\"f\") {\n            displayvalue = SocialCalc.special_chars(\"=\"+cell.formula) || \"&nbsp;\";\n            }\n         else if (cell.datatype==\"c\") {\n            displayvalue = SocialCalc.special_chars(\"'\"+cell.formula) || \"&nbsp;\";\n            }\n         else {\n            displayvalue = SocialCalc.special_chars(\"'\"+displayvalue) || \"&nbsp;\";\n            }\n         return displayvalue;\n         }\n      displayvalue = SocialCalc.format_text_for_display(displayvalue, cell.valuetype, valueformat, sheetobj, linkstyle);\n      if (valueformat == \"text-html\")  SocialCalc.ScriptCheck(sheetobj.sheetid,cr,value);\n      }\n\n   else if (valuetype==\"n\") {\n      valueformat = cell.nontextvalueformat;\n      if (valueformat==null || valueformat==\"\") { //\n         valueformat = sheetattribs.defaultnontextvalueformat;\n         }\n      valueformat = sheetobj.valueformats[valueformat-0];\n      if (valueformat==null || valueformat==\"none\") {\n         valueformat = \"\";\n         }\n      if (valueformat==\"formula\") {\n         if (cell.datatype==\"f\") {\n            displayvalue = SocialCalc.special_chars(\"=\"+cell.formula) || \"&nbsp;\";\n            }\n         else if (cell.datatype==\"c\") {\n            displayvalue = SocialCalc.special_chars(\"'\"+cell.formula) || \"&nbsp;\";\n            }\n         else {\n            displayvalue = SocialCalc.special_chars(\"'\"+displayvalue) || \"&nbsp;\";\n            }\n         return displayvalue;\n         }\n      else if (valueformat==\"forcetext\") {\n         if (cell.datatype==\"f\") {\n            displayvalue = SocialCalc.special_chars(\"=\"+cell.formula) || \"&nbsp;\";\n            }\n         else if (cell.datatype==\"c\") {\n            displayvalue = SocialCalc.special_chars(cell.formula) || \"&nbsp;\";\n            }\n         else {\n            displayvalue = SocialCalc.special_chars(displayvalue) || \"&nbsp;\";\n            }\n         return displayvalue;\n         }\n\n      displayvalue = SocialCalc.format_number_for_display(displayvalue, cell.valuetype, valueformat);\n\n      }\n   else { // unknown type - probably blank\n      displayvalue = \"&nbsp;\";\n      }\n\n   return displayvalue;\n\n   }\n\n\n//\n// displayvalue = format_text_for_display(rawvalue, valuetype, valueformat, sheetobj, linkstyle)\n//\n\nSocialCalc.format_text_for_display = function(rawvalue, valuetype, valueformat, sheetobj, linkstyle) {\n\n   var valueformat, valuesubtype, dvsc, dvue, textval;\n   var displayvalue;\n\n   valuesubtype = valuetype.substring(1);\n\n   displayvalue = rawvalue;\n\n   if (valueformat==\"none\" || valueformat==null) valueformat=\"\";\n   if (!/^(text-|custom|hidden)/.test(valueformat)) valueformat=\"\";\n   if (valueformat==\"\" || valueformat==\"General\") { // determine format from type\n      if (valuesubtype==\"h\") valueformat=\"text-html\";\n      if (valuesubtype==\"w\" || valuesubtype==\"r\") valueformat=\"text-wiki\";\n      if (valuesubtype==\"l\") valueformat=\"text-link\";\n      if (!valuesubtype) valueformat=\"text-plain\";\n      }\n   if (valueformat==\"text-html\") { // HTML - output as it as is\n      ;         \n      }\n   else if (SocialCalc.Callbacks.expand_wiki && /^text-wiki/.test(valueformat)) { // do general wiki markup\n      displayvalue = SocialCalc.Callbacks.expand_wiki(displayvalue, sheetobj, linkstyle, valueformat);\n      }\n   else if (valueformat == \"text-wiki\") { // Wiki-text - encode then output\n      displayvalue = SocialCalc.special_chars(displayvalue);\n      }\n   else if (valueformat==\"text-wiki\") { // wiki text\n      displayvalue = (SocialCalc.Callbacks.expand_markup\n                      && SocialCalc.Callbacks.expand_markup(displayvalue, sheetobj, linkstyle)) || // do old wiki markup\n                     SocialCalc.special_chars(displayvalue);\n      }\n   else if (valueformat==\"text-url\") { // text is a URL for a link\n      dvsc = SocialCalc.special_chars(displayvalue);\n      dvue = encodeURI(displayvalue);\n      displayvalue = '<a href=\"'+dvue+'\">'+dvsc+'</a>';\n      }\n   else if (valueformat==\"text-link\") { // more extensive link capabilities for regular web links\n      displayvalue = SocialCalc.expand_text_link(displayvalue, sheetobj, linkstyle, valueformat);\n      }\n   else if (valueformat==\"text-image\") { // text is a URL for an image\n      dvue = encodeURI(displayvalue);\n      displayvalue = '<img src=\"'+dvue+'\">';\n      }\n   else if (valueformat.substring(0,12)==\"text-custom:\") { // construct a custom text format: @r = text raw, @s = special chars, @u = url encoded\n       dvsc = SocialCalc.special_chars(displayvalue); // do special chars\n      dvsc = dvsc.replace(/  /g, \"&nbsp; \"); // keep multiple spaces\n      dvsc = dvsc.replace(/\\n/g, \"<br>\");  // keep line breaks\n      dvue = encodeURI(displayvalue);\n      textval={};\n      textval.r = displayvalue;\n      textval.s = dvsc;\n      textval.u = dvue;\n      displayvalue = valueformat.substring(12); // remove \"text-custom:\"\n      displayvalue = displayvalue.replace(/@(r|s|u)/g, function(a,c){return textval[c];}); // replace placeholders\n      }\n   else if (valueformat.substring(0,6)==\"custom\") { // custom\n      displayvalue = SocialCalc.special_chars(displayvalue); // do special chars\n      displayvalue = displayvalue.replace(/  /g, \"&nbsp; \"); // keep multiple spaces\n      displayvalue = displayvalue.replace(/\\n/g, \"<br>\"); // keep line breaks\n      displayvalue += \" (custom format)\";\n      }\n   else if (valueformat==\"hidden\") {\n      displayvalue = \"&nbsp;\";\n      }\n   else { // plain text\n      displayvalue = SocialCalc.special_chars(displayvalue); // do special chars\n      displayvalue = displayvalue.replace(/  /g, \"&nbsp; \"); // keep multiple spaces\n      displayvalue = displayvalue.replace(/\\n/g, \"<br>\"); // keep line breaks\n      }\n\n   return displayvalue;\n\n   }\n\n\n//\n// displayvalue = format_number_for_display(rawvalue, valuetype, valueformat)\n//\n\nSocialCalc.format_number_for_display = function(rawvalue, valuetype, valueformat) {\n\n   var value, valuesubtype;\n   var scc = SocialCalc.Constants;\n\n   value = rawvalue-0;\n\n   valuesubtype = valuetype.substring(1);\n\n   if (valueformat==\"Auto\" || valueformat==\"\") { // cases with default format\n      if (valuesubtype==\"%\") { // will display a % character\n         valueformat = \"#,##0.0%\";\n         }\n      else if (valuesubtype=='$') {\n         valueformat = '[$]#,##0.00';\n         }\n      else if (valuesubtype=='dt') {\n         valueformat = scc.defaultFormatdt;\n         }\n      else if (valuesubtype=='d') {\n         valueformat = scc.defaultFormatd;\n         }\n      else if (valuesubtype=='t') {\n         valueformat = scc.defaultFormatt;\n         }\n      else if (valuesubtype=='l') {\n         valueformat = 'logical';\n         }\n      else {\n         valueformat = \"General\";\n         }\n      }\n\n   if (valueformat==\"logical\") { // do logical format\n      return value ? scc.defaultDisplayTRUE : scc.defaultDisplayFALSE;\n      }\n\n   if (valueformat==\"hidden\") { // do hidden format\n      return \"&nbsp;\";\n      }\n\n   // Use format\n\n   return SocialCalc.FormatNumber.formatNumberWithFormat(rawvalue, valueformat, \"\");\n\n   }\n\n//\n// valueinfo = DetermineValueType(rawvalue)\n//\n// Takes a value and looks for special formatting like $, %, numbers, etc.\n// Returns the value as a number or string and the type as {value: value, type: type}.\n// Tries to follow the spec for spreadsheet function VALUE(v).\n//\n\nSocialCalc.DetermineValueType = function(rawvalue) {\n\n   var value = rawvalue + \"\";\n   var type = \"t\";\n   var tvalue, matches, year, hour, minute, second, denom, num, intgr, constr;\n\n   tvalue = value.replace(/^\\s+/, \"\"); // remove leading and trailing blanks\n   tvalue = tvalue.replace(/\\s+$/, \"\");\n\n   if (value.length==0) {\n      type = \"\";\n      }\n   else if (value.match(/^\\s+$/)) { // just blanks\n      ; // leave type \"t\"\n      }\n   else if (tvalue.match(/^[-+]?\\d*(?:\\.)?\\d*(?:[eE][-+]?\\d+)?$/)) { // general number, including E\n      value = tvalue - 0; // try converting to number\n      if (isNaN(value)) { // leave alone - catches things like plain \"-\"\n         value = rawvalue + \"\";\n         }\n      else {\n         type = \"n\";\n         }\n      }\n   else if (tvalue.match(/^[-+]?\\d*(?:\\.)?\\d*\\s*%$/)) { // percent form: 15.1%\n      value = (tvalue.slice(0, -1) - 0) / 100; // convert and scale\n      type = \"n%\";\n      }\n   else if (tvalue.match(/^[-+]?\\$\\s*\\d*(?:\\.)?\\d*\\s*$/) && tvalue.match(/\\d/)) { // $ format: $1.49\n      value = tvalue.replace(/\\$/, \"\") - 0;\n      type = \"n$\";\n      }\n   else if (tvalue.match(/^[-+]?(\\d*,\\d*)+(?:\\.)?\\d*$/)) { // number format ignoring commas: 1,234.49\n      value = tvalue.replace(/,/g, \"\") - 0;\n      type = \"n\";\n      }\n   else if (tvalue.match(/^[-+]?(\\d*,\\d*)+(?:\\.)?\\d*\\s*%$/)) { // % with commas: 1,234.49%\n      value = (tvalue.replace(/[%,]/g, \"\") - 0) / 100;\n      type = \"n%\";\n      }\n   else if (tvalue.match(/^[-+]?\\$\\s*(\\d*,\\d*)+(?:\\.)?\\d*$/) && tvalue.match(/\\d/)) { // $ and commas: $1,234.49\n      value = tvalue.replace(/[\\$,]/g, \"\") - 0;\n      type = \"n$\";\n      }\n   else if (matches=value.match(/^(\\d{1,2})[\\/\\-](\\d{1,2})[\\/\\-](\\d{1,4})\\s*$/)) { // MM/DD/YYYY, MM/DD/YYYY\n      year = matches[3] - 0;\n      year = year < 1000 ? year + 2000 : year;\n      value = SocialCalc.FormatNumber.convert_date_gregorian_to_julian(year, matches[1]-0, matches[2]-0)-2415019;\n      type = \"nd\";\n      }\n   else if (matches=value.match(/^(\\d{4})[\\/\\-](\\d{1,2})[\\/\\-](\\d{1,2})\\s*$/)) { // YYYY-MM-DD, YYYY/MM/DD\n      year = matches[1]-0;\n      year = year < 1000 ? year + 2000 : year;\n      value = SocialCalc.FormatNumber.convert_date_gregorian_to_julian(year, matches[2]-0, matches[3]-0)-2415019;\n      type = \"nd\";\n      }\n   else if (matches=value.match(/^(\\d{1,2}):(\\d{1,2})\\s*$/)) { // HH:MM\n      hour = matches[1]-0;\n      minute = matches[2]-0;\n      if (hour < 24 && minute < 60) {\n         value = hour/24 + minute/(24*60);\n         type = \"nt\";\n         }\n      }\n   else if (matches=value.match(/^(\\d{1,2}):(\\d{1,2}):(\\d{1,2})\\s*$/)) { // HH:MM:SS\n      hour = matches[1]-0;\n      minute = matches[2]-0;\n      second = matches[3]-0;\n      if (hour < 24 && minute < 60 && second < 60) {\n         value = hour/24 + minute/(24*60) + second/(24*60*60);\n         type = \"nt\";\n         }\n      }\n   else if (matches=value.match(/^\\s*([-+]?\\d+) (\\d+)\\/(\\d+)\\s*$/)) { // 1 1/2\n      intgr = matches[1]-0;\n      num = matches[2]-0;\n      denom = matches[3]-0;\n      if (denom && denom > 0) {\n         value = intgr + (intgr < 0 ? -num/denom : num/denom);\n         type = \"n\";\n         }\n      }\n   else if (constr=SocialCalc.InputConstants[value.toUpperCase()]) { // special constants, like \"false\" and #N/A\n      num = constr.indexOf(\",\");\n      value = constr.substring(0,num)-0;\n      type = constr.substring(num+1);\n      }\n\n   else if (tvalue.length > 7 && tvalue.substring(0,7).toLowerCase()==\"http://\") { // URL\n      value = tvalue;\n      type = \"tl\";\n      }\n\n   return {value: value, type: type};\n\n   }\n\nSocialCalc.InputConstants = { // strings that turn into constants for SocialCalc.DetermineValueType\n      \"TRUE\": \"1,nl\", \"FALSE\": \"0,nl\", \"#N/A\": \"0,e#N/A\", \"#NULL!\": \"0,e#NULL!\", \"#NUM!\": \"0,e#NUM!\",\n      \"#DIV/0!\": \"0,e#DIV/0!\", \"#VALUE!\": \"0,e#VALUE!\", \"#REF!\": \"0,e#REF!\", \"#NAME?\": \"0,e#NAME?\"};\n\n//\n// result = default_expand_markup(displayvalue, sheetobj, linkstyle)\n//\n// Processes wiki-text -- this is a placeholder.\n// Reference to here in SocialCalc.expand_markup should be replaced by application-specific routine.\n//\n\nSocialCalc.default_expand_markup = function(displayvalue, sheetobj, linkstyle) {\n\n   var result = displayvalue;\n\n   result = SocialCalc.special_chars(result); // do special chars\n   result = result.replace(/  /g, \"&nbsp; \"); // keep multiple spaces\n   result = result.replace(/\\n/g, \"<br>\"); // keep line breaks\n\n   return result; // do very little by default\n\n   result = result.replace(/('*)'''(.*?)'''/g, \"$1<b>$2<\\/b>\"); // Wiki-style bold/italics\n   result = result.replace(/''(.*?)''/g, \"<i>$1<\\/i>\");\n\n   return result;\n\n   }\n\n\n//\n// result = SocialCalc.expand_text_link(displayvalue, sheetobj, linkstyle, valueformat)\n//\n// Parses link text (URL, descriptions, pagenames, workspace names) and returns HTML\n//\n\nSocialCalc.expand_text_link = function(displayvalue, sheetobj, linkstyle, valueformat) {\n\n   var desc, tb, str;\n\n   var scc = SocialCalc.Constants;\n\n   var url = \"\";\n   var parts = SocialCalc.ParseCellLinkText(displayvalue+\"\");\n\n   if (parts.desc) {\n      desc = SocialCalc.special_chars(parts.desc);\n      }\n   else {\n      desc = parts.pagename ? scc.defaultPageLinkFormatString : scc.defaultLinkFormatString;\n      }\n\n   if (displayvalue.length > 7 && displayvalue.substring(0,7).toLowerCase()==\"http://\" \n      && displayvalue.charAt(displayvalue.length-1)!=\">\") {\n      desc = desc.substring(7); // remove http:// unless explicit\n      }\n\n   tb = (parts.newwin || !linkstyle) ? ' target=\"_blank\"' : \"\";\n\n   if (parts.pagename) {\n      if (SocialCalc.Callbacks.MakePageLink) {\n         url = SocialCalc.Callbacks.MakePageLink(parts.pagename, parts.workspacename, linkstyle, valueformat);\n         }\n//      else if (parts.workspace) {\n//         url = \"/\" + encodeURI(parts.workspace) + \"/\" + encodeURI(parts.pagename);\n//         }\n//      else {\n//         url = parts.pagename;\n//         }\n      }\n   else {\n      url = encodeURI(parts.url);\n      }\n   str = '<a href=\"' + url + '\"' + tb + '>' + desc + '</a>';\n\n   return str;\n\n   }\n\n\n//\n// result = SocialCalc.ParseCellLinkText(str)\n//\n// Given: url = http://www.someurl.com/more, desc = Some descriptive text\n//\n// Takes the following:\n//\n//    url\n//    <url>\n//    desc<url>\n//    \"desc\"<url>\n//    <<>> instead of <> => target=\"_blank\" (new window)\n//\n//    [page name]\n//    \"desc\"[page name]\n//    desc[page name]\n//    {workspace name [page name]}\n//    \"desc\"{workspace name [page name]}\n//    [[]] instead of [] => target=\"_blank\" (new window)\n//\n//\n// Returns: {url: url, desc: desc, newwin: t/f, pagename: pagename, workspace: workspace}\n//\n\nSocialCalc.ParseCellLinkText = function(str) {\n\n   var result = {url: \"\", desc: \"\", newwin: false, pagename: \"\", workspace: \"\"};\n\n   var pageform = false;\n   var urlend = str.length - 1;\n   var descstart = 0;\n   var lastlt = str.lastIndexOf(\"<\");\n   var lastbrkt = str.lastIndexOf(\"[\");\n   var lastbrace = str.lastIndexOf(\"{\");\n   var descend = -1;\n\n   if ((str.charAt(urlend) != \">\" || lastlt == -1)\n         && (str.charAt(urlend) != \"]\" || lastbrkt == -1)\n         && (str.charAt(urlend) != \"}\" || str.charAt(urlend-1) != \"]\" || \n             lastbrace == -1 || lastbrkt == -1 || lastbrkt < lastbrace)) { // plain url\n      urlend++;\n      descend = urlend;\n      }\n   else { // some markup\n      if (str.charAt(urlend)==\">\") { // url form\n         descend = lastlt - 1;\n         if (lastlt > 0 && str.charAt(descend) == \"<\" && str.charAt(urlend-1) == \">\") {\n            descend--;\n            urlend--;\n            result.newwin = true;\n            }\n         }\n\n      else if (str.charAt(urlend)==\"]\") { // plain page form\n         descend = lastbrkt - 1;\n         pageform = true;\n         if (lastbrkt > 0 && str.charAt(descend) == \"[\" && str.charAt(urlend-1) == \"]\") {\n            descend--;\n            urlend--;\n            result.newwin = true;\n            }\n         }\n\n      else if (str.charAt(urlend)==\"}\") { // page and workspace form\n         descend = lastbrace - 1;\n         pageform = true;\n         wsend = lastbrkt;\n         urlend--;\n         if (lastbrkt > 0 && str.charAt(lastbrkt-1) == \"[\" && str.charAt(urlend-1) == \"]\") {\n            wsend = lastbrkt-1;\n            urlend--;\n            result.newwin = true;\n            }\n         if (str.charAt(wsend-1)==\" \") { // trim trailing space in workspace name\n            wsend--;\n            }\n         result.workspace = str.substring(lastbrace+1, wsend) || \"\";\n         }\n\n      if (str.charAt(descend)==\" \") { // trim trailing space on desc\n         descend--;\n         }\n\n      if (str.charAt(descstart) == '\"' && str.charAt(descend) == '\"') {\n         descstart++;\n         descend--;\n         }\n      }\n\n   if (pageform) {\n      result.pagename = str.substring(lastbrkt+1, urlend) || \"\";\n      }\n   else {\n      result.url = str.substring(lastlt+1, urlend) || \"\";\n      }\n\n   if (descend >= descstart) {\n      result.desc = str.substring(descstart, descend+1);\n      }\n\n   return result;\n\n   }\n\n\n//\n// result = SocialCalc.ConvertSaveToOtherFormat(savestr, outputformat, dorecalc)\n//\n// Returns a string in the specificed format: \"scsave\", \"html\", \"csv\", \"tab\" (tab delimited)\n// If dorecalc is true, performs a recalc after loading (NO: obsolete!).\n//\n\nSocialCalc.ConvertSaveToOtherFormat = function(savestr, outputformat, dorecalc) {\n\n   var sheet, context, clipextents, div, ele, row, col, cr, cell, str;\n\n   var result = \"\";\n\n   if (outputformat == \"scsave\") {\n      return savestr;\n      }\n\n   if (savestr == \"\") {\n      return \"\";\n      }\n\n   sheet = new SocialCalc.Sheet();\n   sheet.ParseSheetSave(savestr);\n\n   if (dorecalc) {\n      // no longer supported as of 9/10/08\n      // Recalc is now async, so can't do it this way\n      throw(\"SocialCalc.ConvertSaveToOtherFormat: Not doing recalc.\");\n      }\n\n   if (sheet.copiedfrom) {\n      clipextents = SocialCalc.ParseRange(sheet.copiedfrom);\n      }\n   else {\n      clipextents = {cr1: {row: 1, col: 1}, cr2: {row: sheet.attribs.lastrow, col: sheet.attribs.lastcol}};\n      }\n\n   if (outputformat == \"html\") {\n      context=new SocialCalc.RenderContext(sheet);\n      if (sheet.copiedfrom) {\n         context.rowpanes[0] = {first: clipextents.cr1.row, last: clipextents.cr2.row};\n         context.colpanes[0] = {first: clipextents.cr1.col, last: clipextents.cr2.col};\n         }\n      div = document.createElement(\"div\");\n      ele = context.RenderSheet(null, context.defaultHTMLlinkstyle);\n      div.appendChild(ele);\n      context = undefined;\n      sheet = undefined;\n      result = div.innerHTML;\n      ele = undefined;\n      div = undefined;\n      return result;\n      }\n\n   for (row = clipextents.cr1.row; row <= clipextents.cr2.row; row++) {\n      for (col = clipextents.cr1.col; col <= clipextents.cr2.col; col++) {\n         cr = SocialCalc.crToCoord(col, row);\n         cell = sheet.GetAssuredCell(cr);\n\n         if (cell.errors) {\n            str = cell.errors;\n            }\n         else {\n            str = cell.datavalue+\"\"; // get value as text\n            }\n\n         if (outputformat == \"csv\") {\n            if (str.indexOf('\"')!=-1) {\n               str = str.replace(/\"/g, '\"\"'); // double quotes\n               }\n            if (/[, \\n\"]/.test(str)) {\n               str = '\"' + str + '\"'; // add quotes\n               }\n            if (col>clipextents.cr1.col) {\n               str = \",\" + str; // add commas\n               }\n            }\n         else if (outputformat == \"tab\") {\n            if (str.indexOf('\\n')!=-1) { // if multiple lines\n               if (str.indexOf('\"')!=-1) {\n                  str = str.replace(/\"/g, '\"\"'); // double quotes\n                  }\n               str = '\"' + str + '\"'; // add quotes\n               }\n            if (col>clipextents.cr1.col) {\n               str = \"\\t\" + str; // add tabs\n               }\n            }\n         result += str;\n         }\n      result += \"\\n\";\n      }\n\n   return result;\n\n   }\n\n\n//\n// result = SocialCalc.ConvertOtherFormatToSave(inputstr, inputformat)\n//\n// Returns a string converted from the specified format: \"scsave\", \"csv\", \"tab\" (tab delimited)\n//\n\nSocialCalc.ConvertOtherFormatToSave = function(inputstr, inputformat) {\n\n   var sheet, context, lines, i, line, value, inquote, j, ch, values, row, col, cr, maxc;\n\n   var result = \"\";\n\n   var AddCell = function() {\n      col++;\n      if (col>maxc) maxc = col;\n      cr = SocialCalc.crToCoord(col, row);\n      SocialCalc.SetConvertedCell(sheet, cr, value);\n      value = \"\";\n      }\n\n   if (inputformat == \"scsave\") {\n      return inputstr;\n      }\n\n   sheet = new SocialCalc.Sheet();\n\n   lines = inputstr.split(/\\r\\n|\\n/);\n\n   maxc = 0;\n   if (inputformat == \"csv\") {\n      row = 0;\n      inquote = false;\n      for (i=0; i<lines.length; i++) {\n         if (i==lines.length-1 && lines[i]==\"\") { // extra null line - ignore\n            break;\n            }\n         if (inquote) { // if inquote, just continue from where left off\n            value += \"\\n\";\n            }\n         else { // otherwise next row\n            value = \"\";\n            row++;\n            col = 0;\n            }\n         line = lines[i];\n         for (j=0; j<line.length; j++) {\n            ch = line.charAt(j);\n            if (ch == '\"') {\n               if (inquote) {\n                  if (j<line.length-1 && line.charAt(j+1) == '\"') { // double quotes\n                     j++; // skip the second one\n                     value += '\"'; // add one quote\n                     }\n                  else {\n                     inquote = false;\n                     if (j==line.length-1) { // at end of line\n                        AddCell();\n                        }\n                     }\n                  }\n               else {\n                  inquote = true;\n                  }\n               continue;\n               }\n            if (ch == \",\" && !inquote) {\n               AddCell();\n               }\n            else {\n               value += ch;\n               }\n            if (j==line.length-1 && !inquote) {\n               AddCell();\n               }\n            }\n         }\n      if (maxc>0) {\n         sheet.attribs.lastrow = row;\n         sheet.attribs.lastcol = maxc;\n         result = sheet.CreateSheetSave(\"A1:\"+SocialCalc.crToCoord(maxc, row));\n         }\n      }\n\n   if (inputformat == \"tab\") {\n      row = 0;\n      inquote = false;\n      for (i=0; i<lines.length; i++) {\n         if (i==lines.length-1 && lines[i]==\"\") { // extra null line - ignore\n            break;\n            }\n         if (inquote) { // if inquote, just continue from where left off\n            value += \"\\n\";\n            }\n         else { // otherwise next row\n            value = \"\";\n            row++;\n            col = 0;\n            }\n         line = lines[i];\n         for (j=0; j<line.length; j++) {\n            ch = line.charAt(j);\n            if (ch == '\"') {\n               if (inquote) {\n                  if (j<line.length-1) {\n                     if (line.charAt(j+1) == '\"') { // double quotes\n                        j++; // skip the second one\n                        value += '\"'; // add one quote\n                        }\n                     else if (line.charAt(j+1) == '\\t') { // end of quoted item\n                        j++;\n                        inquote = false;\n                        AddCell();\n                        }\n                     }\n                  else { // at end of line\n                     inquote = false;\n                     AddCell();\n                     }\n                  continue;\n                  }\n               if (value==\"\") { // quote at start of item\n                  inquote = true;\n                  continue;\n                  }\n               }\n            if (ch == \"\\t\" && !inquote) {\n               AddCell();\n               }\n            else {\n               value += ch;\n               }\n            if (j==line.length-1 && !inquote) {\n               AddCell();\n               }\n            }\n         }\n      if (maxc>0) {\n         sheet.attribs.lastrow = row;\n         sheet.attribs.lastcol = maxc;\n         result = sheet.CreateSheetSave(\"A1:\"+SocialCalc.crToCoord(maxc, row));\n         }\n      }\n\n   return result;\n\n   }\n\n//\n// SocialCalc.SetConvertedCell(sheet, cr, rawvalue)\n//\n// Sets the cell cr with a value and type determined from rawvalue\n//\n\nSocialCalc.SetConvertedCell = function(sheet, cr, rawvalue) {\n\n   var cell, value;\n\n   cell = sheet.GetAssuredCell(cr);\n\n   value = SocialCalc.DetermineValueType(rawvalue);\n\n   if (value.type == 'n' && value.value == rawvalue) { // check that we don't need \"constant\" to remember original value\n      cell.datatype = \"v\";\n      cell.valuetype = \"n\";\n      cell.datavalue = value.value;\n      }\n   else if (value.type.charAt(0) == 't') { // text of some sort but left unchanged\n      cell.datatype = \"t\";\n      cell.valuetype = value.type;\n      cell.datavalue = value.value;\n      }\n   else { // special number types\n      cell.datatype = \"c\";\n      cell.valuetype = value.type;\n      cell.datavalue = value.value;\n      cell.formula = rawvalue;\n      }\n\n   }\n\n\n//\n// socialcalctouch adds touch gestures to SocialCalc\n// \n// As a start, touch gestures are modeled similar to \n// mouse events \n//\n// Author: Ramu Ramamurthy\n//\n//\n//\n\n//\n//\n// To initialize, SocialCalc.CreateTableEditor must call \n//    SocialCalc.TouchRegister(editor.toplevel, {Swipe: SocialCalc.EditorProcessSwipe, editor: editor});\n//    Also, any element create inside the grid needs to be touch registered for it to work\n//        this includes buttons, etc\n//\n// TestCases:\n//     1) tap to point to cell, and to move edit-cell\n//     2) double-tap on a cell to open edit-box, then tap on edit box to pullup keyboard\n//          -- when editing, tap on any other cell to be done with edit\n//              *** figure out escape to cancel edit versus return to accept edit\n//          -- when editing, and if = seen than tapping on cell puts the cell name into the edit box\n//     3) tap on input box on top opens edit on cell\n//        tap on any cell accepts and finishes this edit\n//        *** need a way to cancel the edit versus accept the edit\n//\n//     4) tap on a cell and move finger starts a range\n//        removing finger completes the range\n//        tap on cell cancels range\n//       \n//     5) a swipe action scrolls the sheet\n//        swipe up/dn scrolls up/dn\n//        swipe lt/rt scrolls lt/rt\n// \n//\n// Wishlist:\n//     1) smooth scroll will be nice (in addition to swipe) -- using a two-touch pan ?\n//\n\n\nvar SocialCalc;\nif (!SocialCalc) {\n    alert(\"Main SocialCalc code module needed\");\n    SocialCalc = {};\n}\n\n// *************************************\n//\n// Touch functions:\n//\n// *************************************\n\nSocialCalc.HasTouch = false;\n\n(function() {\n    // platform specific registration\n    var agent = navigator.userAgent.toLowerCase();\n    \n    if(agent.indexOf('iphone') >= 0 || agent.indexOf('ipad') >= 0 || agent.indexOf('android') >= 0){\n   SocialCalc.HasTouch = true;\n    }\n})();\n\n\n\nSocialCalc.TouchInfo = {\n    \n    // In sequence the following will be implemented\n    // swipe up/dn, left/right will scroll up/dn/left/right respectively\n    // \n    // touch on a cell will move ecell to that cell\n    // repeated touch on a cell will start edit on that cell\n    // touch on another cell will cancel edit if it was in progress (?)\n    // etc\n    // \n    // touch on buttons will activate the buttons\n    // \n    // The registeredElements array is used to identify items.\n    \n    // One item for each element to respond to the touch, each an object with:\n    //    .element, .functionobj\n    \n    registeredElements: [],\n    \n    // for swipe\n    threshold_x : 20,\n    threshold_y : 20,\n    \n    orig_coord_x : 0,\n    orig_coord_y : 0,\n    final_coord_x : 0,\n    final_coord_y : 0,\n    \n    px_to_rows : 20,  // 20 pixels is 1 row scroll\n    px_to_cols : 20,  // 20 pixels is 1 col scroll\n    \n    touch_start : 0,\n    ranging : false,\n    ranging_threshold : 100,\n    move_start: 0,\n    \n    last_touch : 0,\n    timeout_handle : null,\n    doubletap_threshold: 500 // max milliseconds between taps\n    \n};\n\n\n//\n// TouchRegister(element, functionobj) - make element respond to touch\n//\n\nSocialCalc.TouchRegister = function(element, functionobj) {\n    \n    \n    if (!SocialCalc.HasTouch) {\n   return;\n    }\n\n    var touchinfo = SocialCalc.TouchInfo;\n\n    if (SocialCalc.LookupElement(element, touchinfo.registeredElements)) {\n   // already registered\n   return;\n    }\n\n    \n    touchinfo.registeredElements.push({\n           element: element, \n      functionobj: functionobj\n      }\n   );\n    \n    if (SocialCalc.HasTouch && element.addEventListener) { // Webkit based (?)\n   element.addEventListener(\"touchstart\", SocialCalc.ProcessTouchStart, false);\n   element.addEventListener(\"touchmove\", SocialCalc.ProcessTouchMove, false);\n   element.addEventListener(\"touchend\", SocialCalc.ProcessTouchEnd, false);\n   element.addEventListener(\"touchcancel\", SocialCalc.ProcessTouchCancel, false);\n   // element.addEventListener(\"orientationchange\", SocialCalc.ProcessOrientationChange, false);\n    }\n};\n\nSocialCalc.FindTouchElement = function(event) {\n    \n    var touchinfo = SocialCalc.TouchInfo;\n    \n    var event = event || window.event;\n    \n    var ele = event.target || event.srcElement; // investigate\n    \n    for (wobj=null; !wobj && ele; ele=ele.parentNode) { // investigate\n   wobj = SocialCalc.LookupElement(ele, touchinfo.registeredElements);\n    }\n    \n    return wobj;\n    \n}\n    \nSocialCalc.ProcessTouchStart = function(event) {\n\n    var touchinfo = SocialCalc.TouchInfo;\n    touchinfo.orig_coord_x = event.targetTouches[0].pageX;\n    touchinfo.orig_coord_y = event.targetTouches[0].pageY;  \n    \n    touchinfo.final_coord_x = touchinfo.orig_coord_x;\n    touchinfo.final_coord_y = touchinfo.orig_coord_y;\n\n    touchinfo.touch_start = new Date().getTime()\n    \n    event.preventDefault();\n};\n\nSocialCalc.TouchGetSimulatedMouseEvent = function(event, mouse_evt_name) {\n    var touches = event.changedTouches;\n    var first = touches[0];\n    var simulatedEvent = document.createEvent(\"MouseEvent\");\n    simulatedEvent.initMouseEvent(mouse_evt_name, true, true, window, 1, \n              first.screenX, first.screenY, \n              first.clientX, first.clientY, false, \n              false, false, false, 0, null);\n    return simulatedEvent;\n}\n\nSocialCalc.ProcessTouchMove = function(event) {\n\n    var touchinfo = SocialCalc.TouchInfo;\n    touchinfo.final_coord_x = event.targetTouches[0].pageX;\n    touchinfo.final_coord_y = event.targetTouches[0].pageY;     \n\n\n    var wobj = SocialCalc.FindTouchElement(event);\n\n    if (!wobj) return; // not one of our elements\n\n    if (touchinfo.move_start == 0) {   \n   touchinfo.move_start = new Date().getTime();\n   if (touchinfo.move_start - touchinfo.touch_start > touchinfo.ranging_threshold) {\n       // This is a delayed move\n       // send a mouse down event\n       // This is for ranging and dragging\n\n       touchinfo.ranging = true;\n       var mouseDn = SocialCalc.TouchGetSimulatedMouseEvent(event, \"mousedown\");\n       wobj.functionobj.editor.fullgrid.dispatchEvent(mouseDn);\n   }\n    } else if (touchinfo.ranging) {\n   // already ranging\n   // send a mouse move event\n   \n   var mouseMv = SocialCalc.TouchGetSimulatedMouseEvent(event, \"mousemove\");\n   wobj.functionobj.editor.fullgrid.dispatchEvent(mouseMv);\n    }\n\n    event.preventDefault();\n};\n\nSocialCalc.ProcessTouchEnd = function(e) {\n\n    var touchinfo = SocialCalc.TouchInfo;\n\n    var changeX = touchinfo.orig_coord_x - touchinfo.final_coord_x;    \n    var changeY = touchinfo.orig_coord_y - touchinfo.final_coord_y;\n   \n    var wobj = SocialCalc.FindTouchElement(event);\n\n    if (!wobj) return; // not one of our elements\n\n    var event = e || window.event;\n\n    touchinfo.move_start = 0;\n    touchinfo.touch_start = 0;\n    \n    if (touchinfo.ranging) {\n   // in ranging, and dragging\n   // send a mouseup event\n   touchinfo.ranging = false;    \n   var mouseUp = SocialCalc.TouchGetSimulatedMouseEvent(event, \"mouseup\");\n   wobj.functionobj.editor.fullgrid.dispatchEvent(mouseUp);\n\n    } else  if ( (Math.abs(changeY) > touchinfo.threshold_y) ||\n       (Math.abs(changeX) > touchinfo.threshold_x) ) {\n\n   // check for swipe\n\n   var amount_y = Math.floor(changeY / touchinfo.px_to_rows);\n   var amount_x = Math.floor(changeX / touchinfo.px_to_cols);\n   if (wobj.functionobj && wobj.functionobj.Swipe) {\n       wobj.functionobj.Swipe(event, touchinfo, wobj, amount_y, amount_x);\n   }\n   \n    } else {\n   \n   // detect a double tap\n   var now = new Date().getTime()\n   var lasttouch = touchinfo.last_touch || now + 1\n   var delta = now - lasttouch;\n   if (touchinfo.timeout_handle) {\n       clearTimeout(touchinfo.timeout_handle);\n       touchinfo.timeout_handle = null;\n   }\n\n   if ((delta < touchinfo.doubletap_threshold) && (delta > 0)) {\n       // doubletap seen\n       if (wobj.functionobj && wobj.functionobj.DoubleTap) {\n      wobj.functionobj.DoubleTap(event, touchinfo, wobj);\n       }\n   } else {\n       // this is a single tap\n       touchinfo.last_touch = now;      \n       var timeoutFn = function() {\n      if (wobj.functionobj && wobj.functionobj.SingleTap) {\n          wobj.functionobj.SingleTap(event, touchinfo, wobj);     \n      }\n       };\n       touchinfo.timeout_handle = setTimeout(timeoutFn(), touchinfo.doubletap_threshold);\n   }\n   touchinfo.last_touch = now;\n    }\n    e.preventDefault();\n};\n\nSocialCalc.ProcessTouchCancel = function(event) {\n\n    var wobj = SocialCalc.FindTouchElement(event);\n\n    if (!wobj) {\n   return; // do default behavior\n    } \n\n    var touchinfo = SocialCalc.TouchInfo;\n    touchinfo.orig_coord_x = 0;\n    touchinfo.orig_coord_y = 0;\n    touchinfo.final_coord_x = 0;    \n    touchinfo.final_coord_y = 0;\n    touchinfo.move_start = 0;\n    touchinfo.touch_start = 0;\n    touchinfo.ranging = false;\n};\n\nSocialCalc.EditorProcessSwipe = function(event, touchinfo, wobj, swipevert, swipehoriz) {\n\n    if (wobj.functionobj.editor.busy) {\n   return; // ignore if busy\n    }\n\n    if (wobj.functionobj.editor.state != \"start\") {\n   return; // ignore if cell being edited\n    }\n\n    if ((swipevert != 0) || (swipehoriz != 0) ) {\n\n   //wobj.functionobj.editor.ScrollRelativeBoth(swipevert,swipehoriz);\n   wobj.functionobj.editor.ScrollRelativeBoth(swipevert,0); //ignore horiz swipes entirely\n    }\n    \n};\n\n\nSocialCalc.EditorProcessSingleTap = function(event, touchinfo, wobj) {\n\n\n    if (wobj.functionobj.editor.busy) {\n   return; // ignore if busy\n    }    \n\n    // send mouse down\n    var mouseDn = SocialCalc.TouchGetSimulatedMouseEvent(event, \"mousedown\");\n    wobj.functionobj.editor.fullgrid.dispatchEvent(mouseDn);\n\n    // then send mouse up\n    var mouseUp = SocialCalc.TouchGetSimulatedMouseEvent(event, \"mouseup\");\n    wobj.functionobj.editor.fullgrid.dispatchEvent(mouseUp);\n\n};\n\n\nSocialCalc.EditorProcessDoubleTap = function(event, touchinfo, wobj) {\n\n    if (wobj.functionobj.editor.busy) {\n   return; // ignore if busy\n    }\n    // simulate a mouse double click\n    var mouseDblClick = SocialCalc.TouchGetSimulatedMouseEvent(event, \"dblclick\");\n    wobj.functionobj.editor.fullgrid.dispatchEvent(mouseDblClick);\n    \n};\n\n\n\nSocialCalc.ProcessOrientationChange = function(event) {\n    console.log(\"orientation change\");\n    //var height = $(window).height();\n    //var width = $(window).width(); \n\n    //console.log(\"width=\"+width+\",height=\"+height)\n\n    // $(window).trigger( \"orientationchange.htmlclass\" );   \n    // spreadsheet.DoOnResize(); \n};\n\n\n//\n// SocialCalcTableEditor\n//\n/*\n // The code module of the SocialCalc package that displays a scrolling grid with panes\n // and handles keyboard and mouse I/O.\n //\n // (c) Copyright 2008, 2009, 2010 Socialtext, Inc.\n // All Rights Reserved.\n //\n */\n\n/*\n \n LEGAL NOTICES REQUIRED BY THE COMMON PUBLIC ATTRIBUTION LICENSE:\n \n EXHIBIT A. Common Public Attribution License Version 1.0.\n \n The contents of this file are subject to the Common Public Attribution License Version 1.0 (the\n \"License\"); you may not use this file except in compliance with the License. You may obtain a copy\n of the License at http://socialcalc.org. The License is based on the Mozilla Public License Version 1.1 but\n Sections 14 and 15 have been added to cover use of software over a computer network and provide for\n limited attribution for the Original Developer. In addition, Exhibit A has been modified to be\n consistent with Exhibit B.\n \n Software distributed under the License is distributed on an \"AS IS\" basis, WITHOUT WARRANTY OF ANY\n KIND, either express or implied. See the License for the specific language governing rights and\n limitations under the License.\n \n The Original Code is SocialCalc JavaScript TableEditor.\n \n The Original Developer is the Initial Developer.\n \n The Initial Developer of the Original Code is Socialtext, Inc. All portions of the code written by\n Socialtext, Inc., are Copyright (c) Socialtext, Inc. All Rights Reserved.\n \n Contributor: Dan Bricklin.\n \n \n EXHIBIT B. Attribution Information\n \n When the TableEditor is producing and/or controlling the display the Graphic Image must be\n displayed on the screen visible to the user in a manner comparable to that in the\n Original Code. The Attribution Phrase must be displayed as a \"tooltip\" or \"hover-text\" for\n that image. The image must be linked to the Attribution URL so as to access that page\n when clicked. If the user interface includes a prominent \"about\" display which includes\n factual prominent attribution in a form similar to that in the \"about\" display included\n with the Original Code, including Socialtext copyright notices and URLs, then the image\n need not be linked to the Attribution URL but the \"tool-tip\" is still required.\n \n Attribution Copyright Notice:\n \n Copyright (C) 2010 Socialtext, Inc.\n All Rights Reserved.\n \n Attribution Phrase (not exceeding 10 words): SocialCalc\n \n Attribution URL: http://www.socialcalc.org/xoattrib\n \n Graphic Image: The contents of the sc-logo.gif file in the Original Code or\n a suitable replacement from http://www.socialcalc.org/licenses specified as\n being for SocialCalc.\n \n Display of Attribution Information is required in Larger Works which are defined\n in the CPAL as a work which combines Covered Code or portions thereof with code\n not governed by the terms of the CPAL.\n \n */\n\n//\n// Some of the other files in the SocialCalc package are licensed under\n// different licenses. Please note the licenses of the modules you use.\n//\n// Code History:\n//\n// Initially coded by Dan Bricklin of Software Garden, Inc., for Socialtext, Inc.\n// Based in part on the SocialCalc 1.1.0 code written in Perl.\n// The SocialCalc 1.1.0 code was:\n//    Portions (c) Copyright 2005, 2006, 2007 Software Garden, Inc.\n//    All Rights Reserved.\n//    Portions (c) Copyright 2007 Socialtext, Inc.\n//    All Rights Reserved.\n// The Perl SocialCalc started as modifications to the wikiCalc(R) program, version 1.0.\n// wikiCalc 1.0 was written by Software Garden, Inc.\n// Unless otherwise specified, referring to \"SocialCalc\" in comments refers to this\n// JavaScript version of the code, not the SocialCalc Perl code.\n//\n\n/*\n \n See the comments in the main SocialCalc code module file of the SocialCalc package.\n \n */\n\nvar SocialCalc;\nif (!SocialCalc) { // created here, too, in case load order is wrong, but main routines are required\n    SocialCalc = {};\n}\n\n// *************************************\n//\n// Table Editor class:\n//\n// *************************************\n\n// Constructor:\n\nSocialCalc.TableEditor = function(context) {\n    \n    var scc = SocialCalc.Constants;\n    \n    // Properties:\n    \n    this.context = context; // editing context\n    this.toplevel = null; // top level HTML element for this table editor\n    this.fullgrid = null; // rendered editing context\n    \n    this.noEdit = false; // if true, disable all edit UI and make read-only\n    \n    this.width = null;\n    this.tablewidth = null;\n    this.height = null;\n    this.tableheight = null;\n    \n    this.inputBox = null;\n    this.inputEcho = null;\n    this.verticaltablecontrol = null;\n    this.horizontaltablecontrol = null;\n    \n    this.logo = null;\n    \n    this.cellhandles = null;\n    \n    // Dynamic properties:\n    \n    this.timeout = null; // if non-null, timer id for position calculations\n    this.busy = false; // true when executing command, calculating, etc.\n    this.ensureecell = false; // if true, ensure ecell is visible after timeout\n    this.deferredCommands = []; // commands to execute after busy, in form: {cmdstr: \"cmds\", saveundo: t/f}\n    \n    this.gridposition = null; // screen coords of full grid\n    this.headposition = null; // screen coords of upper left of grid within header rows\n    this.firstscrollingrow = null; // row number of top row in last (the scrolling) pane\n    this.firstscrollingrowtop = null;  // position of top row in last (the scrolling) pane\n    this.lastnonscrollingrow = null; // row number of last displayed row in last non-scrolling\n    // pane, or zero (for thumb position calculations)\n    this.lastvisiblerow = null; // used for paging down\n    this.firstscrollingcol = null; // column number of top col in last (the scrolling) pane\n    this.firstscrollingcolleft = null;  // position of top col in last (the scrolling) pane\n    this.lastnonscrollingcol = null; // col number of last displayed column in last non-scrolling\n    // pane, or zero (for thumb position calculations)\n    this.lastvisiblecol = null; // used for paging right\n    \n    this.rowpositions = []; // screen positions of the top of some rows\n    this.colpositions = []; // screen positions of the left side of some rows\n    this.rowheight = []; // size in pixels of each row when last checked, or null/undefined, for page up\n    this.colwidth = []; // size in pixels of each column when last checked, or null/undefined, for page left\n    \n    this.ecell = null; // either null or {coord: c, row: r, col: c}\n    this.state = \"start\"; // the keyboard states: see EditorProcessKey\n    \n    this.workingvalues = {}; // values used during keyboard editing, etc.\n    \n    // Constants:\n    \n    this.imageprefix = scc.defaultImagePrefix; // URL prefix for images (e.g., \"/www/assets/images/sc\")\n    this.idPrefix = scc.defaultTableEditorIDPrefix;\n    this.pageUpDnAmount = scc.defaultPageUpDnAmount; // number of rows to move cursor on PgUp/PgDn keys (numeric)\n    \n    // Callbacks\n    \n    // recalcFunction: if present, function(editor) {...}, called to do a recalc\n    // Default (sheet.RecalcSheet) does all the right stuff.\n    \n    this.recalcFunction = function(editor) {\n        if (editor.context.sheetobj.RecalcSheet) {\n            editor.context.sheetobj.RecalcSheet(SocialCalc.EditorSheetStatusCallback, editor);\n        }\n        else return null;\n    };\n    \n    // ctrlkeyFunction: if present, function(editor, charname) {...}, called to handle ctrl-V, etc., at top level\n    // Returns true (pass through for continued processing) or false (stop processing this key).\n    \n    this.ctrlkeyFunction = function(editor, charname) {\n        \n        var ta, ha, cell, position, cmd, sel, cliptext;\n        \n        switch (charname) {\ncase \"[ctrl-c]\":\ncase \"[ctrl-x]\":\nta = editor.pasteTextarea;\nta.value = \"\";\ncell=SocialCalc.GetEditorCellElement(editor, editor.ecell.row, editor.ecell.col);\nif (cell) {\nposition = SocialCalc.GetElementPosition(cell.element);\nta.style.left = (position.left-1)+\"px\";\nta.style.top = (position.top-1)+\"px\";\n}\nif (editor.range.hasrange) {\nsel = SocialCalc.crToCoord(editor.range.left, editor.range.top)+\n\":\"+SocialCalc.crToCoord(editor.range.right, editor.range.bottom);\n}\nelse {\nsel = editor.ecell.coord;\n}\n\n// get what to copy to clipboard\ncliptext = SocialCalc.ConvertSaveToOtherFormat(SocialCalc.CreateSheetSave(editor.context.sheetobj, sel), \"tab\");\n\nif (charname == \"[ctrl-c]\" || editor.noEdit || (SocialCalc.Callbacks.IsCellEditable && (!SocialCalc.Callbacks.IsCellEditable(editor)))) { // if copy or cut but in no edit\ncmd = \"copy \"+sel+\" formulas\";\n}\nelse { // [ctrl-x]\ncmd = \"cut \"+sel+\" formulas\";\n}\neditor.EditorScheduleSheetCommands(cmd, true, false); // queue up command to put on SocialCalc clipboard\n\n/* Copy as HTML: This fails rather badly as it won't paste into Notepad as tab-delimited text. Oh well.\n\nha = editor.pasteHTMLarea;\nif (editor.range.hasrange) {\ncell = SocialCalc.GetEditorCellElement(editor, editor.range.top, editor.range.left);\n}\nelse {\ncell = SocialCalc.GetEditorCellElement(editor, editor.ecell.row, editor.ecell.col);\n}\nif (cell) position = SocialCalc.GetElementPosition(cell.element);\n\nif (ha) {\nif (position) {\nha.style.left = (position.left-1)+\"px\";\nha.style.top = (position.top-1)+\"px\";\n}\nha.style.visibility=\"visible\";\ncliptext = SocialCalc.ConvertSaveToOtherFormat(SocialCalc.CreateSheetSave(editor.context.sheetobj, sel), \"html\");\nha.innerHTML = cliptext.replace(/<tr\\b[^>]*>[\\d\\D]*?<\\/tr\\b[^>]*>/i, '');\nha.focus();\n\nvar range = document.body.createControlRange();\nrange.addElement(ha.childNodes[0]);\nrange.select();\n}\n*/\nta.style.display = \"block\";\nta.value = cliptext; // must follow \"block\" setting for Webkit\nta.focus();\nta.select();\nwindow.setTimeout(function() {\nif (!SocialCalc.GetSpreadsheetControlObject) return; // in case not loaded\nvar s = SocialCalc.GetSpreadsheetControlObject();\nif (!s) return;\nvar editor = s.editor;\n/*\nvar ha = editor.pasteHTMLarea;\nif (ha) {\nha.blur();\nha.innerHTML = '';\nha.style.visibility = 'hidden';\n}\n*/\nvar ta = editor.pasteTextarea;\nta.blur();\nta.style.display = \"none\";\nSocialCalc.KeyboardFocus();\n}, 200);\n\nreturn true;\n\ncase \"[ctrl-v]\":\nif (editor.noEdit) return true; // not if no edit\nif (SocialCalc.Callbacks && SocialCalc.Callbacks.IsCellEditable) {\nif (!SocialCalc.Callbacks.IsCellEditable(editor)) {\nreturn true;\n}\n}\n\nvar showPasteTextArea = function() {\nta = editor.pasteTextarea;\nta.value = \"\";\n\ncell=SocialCalc.GetEditorCellElement(editor, editor.ecell.row, editor.ecell.col);\nif (cell) {\nposition = SocialCalc.GetElementPosition(cell.element);\nta.style.left = (position.left-1)+\"px\";\nta.style.top = (position.top-1)+\"px\";\n}\nta.style.display = \"block\";\nta.value = \"\";  // must follow \"block\" setting for Webkit\nta.focus();\n};\n\nha = editor.pasteHTMLarea;\nif (ha) {\n/* Pasting via HTML - Currently IE only */\nha.style.visibility = \"visible\";\nha.focus();\n}\nelse {\nshowPasteTextArea();\n}\nwindow.setTimeout(function() {\nif (!SocialCalc.GetSpreadsheetControlObject) return;\nvar s = SocialCalc.GetSpreadsheetControlObject();\nif (!s) return;\nvar editor = s.editor;\nvar value = null;\nvar isPasteSameAsClipboard = false;\n\nha = editor.pasteHTMLarea;\nif (ha) {\n/* IE: We append a U+FFFC to every TD that's not the last of its row,\n*     then we obtain innerText, then turn U+FFFC back to \\t,\n*     thereby preserving the cell separations (which gets discarded\n*     if we simply paste via textarea.\n*/\nvar _ObjectReplacementCharacter_ = String.fromCharCode(0xFFFC);\nvar html = ha.innerHTML;\n\nif (html.search(/<(?![Bb][Rr])[A-Za-z]/) >= 0) {\n/* HTML Paste: Mark TDs with U+FFFC accordingly.. */\nha.innerHTML = html.replace(\n              /(?:<\\/[Tt][Dd]>)/g,\n              _ObjectReplacementCharacter_\n              );\n}\nelse {\n/* Text Paste: In IE, \\t is transformed into &nbsp;, so replace them with U+FFFC. */\nha.innerHTML = html.replace(\n              /&[Nn][Bb][Ss][Pp];/g,\n              _ObjectReplacementCharacter_\n              );\n}\n\nvalue = ha.innerText.replace(new RegExp(_ObjectReplacementCharacter_, 'g'), '\\t');\n\nha.innerHTML = '';\nha.blur();\nha.style.visibility = \"hidden\";\n}\nelse {\nvar ta = editor.pasteTextarea;\nvalue = ta.value;\nta.blur();\nta.style.display = \"none\";\n}\n\nvalue = value.replace(/\\r\\n/g, \"\\n\").replace(/\\n?$/, '\\n');\nvar clipstr = SocialCalc.ConvertSaveToOtherFormat(SocialCalc.Clipboard.clipboard, \"tab\");\nif (value == clipstr || (value.length-clipstr.length==1 && value.substring(0,value.length-1)==clipstr)) {\nisPasteSameAsClipboard = true;\n}\n\nvar cmd = \"\";\n// pastes SocialCalc clipboard if did a Ctrl-C and contents still the same\n// Webkit adds an extra blank line, so need to allow for that\nif (!isPasteSameAsClipboard) {\ncmd = \"loadclipboard \"+\nSocialCalc.encodeForSave(SocialCalc.ConvertOtherFormatToSave(value, \"tab\")) + \"\\n\";\n}\nvar cr;\nif (editor.range.hasrange) {\ncr = SocialCalc.crToCoord(editor.range.left, editor.range.top);\n}\nelse {\ncr = editor.ecell.coord;\n}\ncmd += \"paste \"+cr+\" formulas\";\neditor.EditorScheduleSheetCommands(cmd, true, false);\nSocialCalc.KeyboardFocus();\n}, 200);\nreturn true;\n\ncase \"[ctrl-z]\":\neditor.EditorScheduleSheetCommands(\"undo\", true, false);\nreturn false;\n\ncase \"[ctrl-s]\": // !!!! temporary hack\nwindow.setTimeout(\nfunction() {\nif (!SocialCalc.GetSpreadsheetControlObject) return;\nvar s = SocialCalc.GetSpreadsheetControlObject();\nif (!s) return;\nvar editor = s.editor;\nvar sheet = editor.context.sheetobj;\nvar cell = sheet.GetAssuredCell(editor.ecell.coord);\nvar ntvf = cell.nontextvalueformat ? sheet.valueformats[cell.nontextvalueformat-0] || \"\" : \"\";\nvar newntvf = window.prompt(\"Advanced Feature:\\n\\nCustom Numeric Format or Command\", ntvf);\nif (newntvf != null) { // not cancelled\nif (newntvf.match(/^cmd:/)) {\ncmd = newntvf.substring(4); // execute as command\n}\nelse if (newntvf.match(/^edit:/)) {\ncmd = newntvf.substring(5); // execute as command\nif (SocialCalc.CtrlSEditor) {\nSocialCalc.CtrlSEditor(cmd);\n}\nreturn;\n}\nelse {\nif (editor.range.hasrange) {\nsel = SocialCalc.crToCoord(editor.range.left, editor.range.top)+\n\":\"+SocialCalc.crToCoord(editor.range.right, editor.range.bottom);\n}\nelse {\nsel = editor.ecell.coord;\n}\ncmd = \"set \"+sel+\" nontextvalueformat \"+newntvf;\n}\neditor.EditorScheduleSheetCommands(cmd, true, false);\n}\n},\n200);\nreturn false;\n                \n            default:\n                break;\n        }\n        return true;\n    };\n    \n    // Set sheet's status callback:\n    \n    context.sheetobj.statuscallback = SocialCalc.EditorSheetStatusCallback;\n    context.sheetobj.statuscallbackparams = this; // this object: the table editor object\n    \n    \n    // StatusCallback: all values are called at appropriate times, add with unique name, delete when done\n    //\n    // Each value must be an object in the form of:\n    //\n    //    func: function(editor, status, arg, params) {...},\n    //    params: params value to call func with\n    //\n    // The values for status and arg are:\n    //\n    //    all the SocialCalc RecalcSheet statuscallbacks, including:\n    //\n    //       calccheckdone, calclist length\n    //       calcorder, {coord: coord, total: celllist length, count: count}\n    //       calcstep, {coord: coord, total: calclist length, count: count}\n    //       calcfinished, time in milliseconds\n    //\n    //    the command callbacks, like cmdstart and cmdend\n    //    cmdendnorender\n    //\n    //    calcstart, null\n    //    moveecell, new ecell coord\n    //    rangechange, \"coord:coord\" or \"coord\" or \"\"\n    //    specialkey, keyname (\"[esc]\")\n    //\n    \n    this.StatusCallback = {};\n    \n    \n    this.MoveECellCallback = {}; // all values are called with editor as arg; add with unique name, delete when done\n    this.RangeChangeCallback = {}; // all values are called with editor as arg; add with unique name, delete when done\n    this.SettingsCallbacks = {}; // See SocialCalc.SaveEditorSettings\n    \n    // Set initial cursor\n    \n    this.ecell = {coord: \"A1\", row: 1, col: 1};\n    context.highlights[this.ecell.coord] = \"cursor\";\n    \n    // Initialize range data\n    // Range has at least hasrange (true/false).\n    // It may also have: anchorcoord, anchorrow, anchorcol, top, bottom, left, and right.\n    \n    this.range = {hasrange: false};\n    \n    // Initialize range2 data (used to show selections, such as for move)\n    // Range2 has at least hasrange (true/false).\n    // It may also have: top, bottom, left, and right.\n    \n    this.range2 = {hasrange: false};\n    \n}\n\n// Methods:\n\nSocialCalc.TableEditor.prototype.CreateTableEditor = function(width, height) {return SocialCalc.CreateTableEditor(this, width, height);};\nSocialCalc.TableEditor.prototype.ResizeTableEditor = function(width, height) {return SocialCalc.ResizeTableEditor(this, width, height);};\n\nSocialCalc.TableEditor.prototype.SaveEditorSettings = function() {return SocialCalc.SaveEditorSettings(this);};\nSocialCalc.TableEditor.prototype.LoadEditorSettings = function(str, flags) {return SocialCalc.LoadEditorSettings(this, str, flags);};\n\nSocialCalc.TableEditor.prototype.EditorRenderSheet = function() {SocialCalc.EditorRenderSheet(this);};\nSocialCalc.TableEditor.prototype.EditorScheduleSheetCommands = function(cmdstr, saveundo, ignorebusy) {SocialCalc.EditorScheduleSheetCommands(this, cmdstr, saveundo, ignorebusy);};\nSocialCalc.TableEditor.prototype.ScheduleSheetCommands = function(cmdstr, saveundo) {\n    this.context.sheetobj.ScheduleSheetCommands(cmdstr, saveundo);\n};\nSocialCalc.TableEditor.prototype.SheetUndo = function() {\n    this.context.sheetobj.SheetUndo();\n};\nSocialCalc.TableEditor.prototype.SheetRedo = function() {\n    this.context.sheetobj.SheetRedo();\n};\nSocialCalc.TableEditor.prototype.EditorStepSet = function(status, arg) {SocialCalc.EditorStepSet(this, status, arg);};\nSocialCalc.TableEditor.prototype.GetStatuslineString = function(status, arg, params) {return SocialCalc.EditorGetStatuslineString(this, status, arg, params);};\n\nSocialCalc.TableEditor.prototype.EditorMouseRegister = function() {return SocialCalc.EditorMouseRegister(this);};\nSocialCalc.TableEditor.prototype.EditorMouseUnregister = function() {return SocialCalc.EditorMouseUnregister(this);};\nSocialCalc.TableEditor.prototype.EditorMouseRange = function(coord) {return SocialCalc.EditorMouseRange(this, coord);};\n\nSocialCalc.TableEditor.prototype.EditorProcessKey = function(ch, e) {return SocialCalc.EditorProcessKey(this, ch, e);};\nSocialCalc.TableEditor.prototype.EditorAddToInput = function(str, prefix) {return SocialCalc.EditorAddToInput(this, str, prefix);};\nSocialCalc.TableEditor.prototype.DisplayCellContents = function() {return SocialCalc.EditorDisplayCellContents(this);};\nSocialCalc.TableEditor.prototype.EditorSaveEdit = function(text) {return SocialCalc.EditorSaveEdit(this, text);};\nSocialCalc.TableEditor.prototype.EditorApplySetCommandsToRange = function(cmdline, type) {return SocialCalc.EditorApplySetCommandsToRange(this, cmdline, type);};\n\nSocialCalc.TableEditor.prototype.MoveECellWithKey = function(ch) {return SocialCalc.MoveECellWithKey(this, ch);};\nSocialCalc.TableEditor.prototype.MoveECell = function(newcell) {return SocialCalc.MoveECell(this, newcell);};\nSocialCalc.TableEditor.prototype.ReplaceCell = function(cell, row, col) {SocialCalc.ReplaceCell(this, cell, row, col);};\nSocialCalc.TableEditor.prototype.UpdateCellCSS = function(cell, row, col) {SocialCalc.UpdateCellCSS(this, cell, row, col);};\nSocialCalc.TableEditor.prototype.SetECellHeaders = function(selected) {SocialCalc.SetECellHeaders(this, selected);};\nSocialCalc.TableEditor.prototype.EnsureECellVisible = function() {SocialCalc.EnsureECellVisible(this);};\nSocialCalc.TableEditor.prototype.RangeAnchor = function(coord) {SocialCalc.RangeAnchor(this, coord);};\nSocialCalc.TableEditor.prototype.RangeExtend = function(coord) {SocialCalc.RangeExtend(this, coord);};\nSocialCalc.TableEditor.prototype.RangeRemove = function() {SocialCalc.RangeRemove(this);};\nSocialCalc.TableEditor.prototype.Range2Remove = function() {SocialCalc.Range2Remove(this);};\n\nSocialCalc.TableEditor.prototype.FitToEditTable = function() {SocialCalc.FitToEditTable(this);};\nSocialCalc.TableEditor.prototype.CalculateEditorPositions = function() {SocialCalc.CalculateEditorPositions(this);};\nSocialCalc.TableEditor.prototype.ScheduleRender = function() {SocialCalc.ScheduleRender(this);};\nSocialCalc.TableEditor.prototype.DoRenderStep = function() {SocialCalc.DoRenderStep(this);};\nSocialCalc.TableEditor.prototype.SchedulePositionCalculations = function() {SocialCalc.SchedulePositionCalculations(this);};\nSocialCalc.TableEditor.prototype.DoPositionCalculations = function() {SocialCalc.DoPositionCalculations(this);};\nSocialCalc.TableEditor.prototype.CalculateRowPositions = function(panenum, positions, sizes) {return SocialCalc.CalculateRowPositions(this,  panenum, positions, sizes);};\nSocialCalc.TableEditor.prototype.CalculateColPositions = function(panenum, positions, sizes) {return SocialCalc.CalculateColPositions(this,  panenum, positions, sizes);};\n\nSocialCalc.TableEditor.prototype.ScrollRelative = function(vertical, amount) {SocialCalc.ScrollRelative(this, vertical, amount);};\nSocialCalc.TableEditor.prototype.ScrollRelativeBoth = function(vamount, hamount) {SocialCalc.ScrollRelativeBoth(this, vamount, hamount);};\nSocialCalc.TableEditor.prototype.PageRelative = function(vertical, direction) {SocialCalc.PageRelative(this, vertical, direction);};\nSocialCalc.TableEditor.prototype.LimitLastPanes = function() {SocialCalc.LimitLastPanes(this);};\n\nSocialCalc.TableEditor.prototype.ScrollTableUpOneRow = function() {return SocialCalc.ScrollTableUpOneRow(this);};\nSocialCalc.TableEditor.prototype.ScrollTableDownOneRow = function() {return SocialCalc.ScrollTableDownOneRow(this);};\nSocialCalc.TableEditor.prototype.ScrollTableLeftOneCol = function() {return SocialCalc.ScrollTableLeftOneCol(this);};\nSocialCalc.TableEditor.prototype.ScrollTableRightOneCol = function() {return SocialCalc.ScrollTableRightOneCol(this);};\n\n//contact prototype\nSocialCalc.TableEditor.prototype.EditorChangecontact = function(text,name,phone,email,street,city,company,val) {return SocialCalc.EditorChangecontact(this,text,name,phone,email,street,city,company,val);};\nSocialCalc.TableEditor.prototype.EditorChangecolorFromWidget = function(text) {return SocialCalc.EditorChangecolorFromWidget(this, text);};\nSocialCalc.TableEditor.prototype.EditorChangeSheetcolor = function(text) {return SocialCalc.EditorChangeSheetcolor(this, text);};\n\nSocialCalc.TableEditor.prototype.EditorChangefontFromWidget = function(text) {return SocialCalc.EditorChangefontFromWidget(this, text);};\nSocialCalc.TableEditor.prototype.EditorChangeSheetfont = function(text) {return SocialCalc.EditorChangeSheetfont(this, text);};\nSocialCalc.TableEditor.prototype.EditorCut = function(text,no_of_cells) {return SocialCalc.EditorCut(this, text,no_of_cells);};\nSocialCalc.TableEditor.prototype.EditorClearSheet = function(text,cell_to_clear) {return SocialCalc.EditorClearSheet(this, text,cell_to_clear);};\n\n// Functions:\n\nSocialCalc.CreateTableEditor = function(editor, width, height) {\n    \n    var scc = SocialCalc.Constants;\n    var AssignID = SocialCalc.AssignID;\n    \n    editor.toplevel = document.createElement(\"div\");\n    editor.width = width;\n    editor.height = height;\n    \n    editor.griddiv = document.createElement(\"div\");\n    editor.tablewidth = Math.max(0, width - scc.defaultTableControlThickness);\n    editor.tableheight = Math.max(0, height - scc.defaultTableControlThickness);\n    editor.griddiv.style.width=editor.tablewidth+\"px\";\n    editor.griddiv.style.height=editor.tableheight+\"px\";\n    editor.griddiv.style.overflow=\"hidden\";\n    editor.griddiv.style.cursor=\"default\";\n    if (scc.cteGriddivClass) editor.griddiv.className = scc.cteGriddivClass;\n    AssignID(editor, editor.griddiv, \"griddiv\");\n    \n    editor.FitToEditTable();\n    \n    editor.EditorRenderSheet();\n    \n    editor.griddiv.appendChild(editor.fullgrid);\n    \n    editor.verticaltablecontrol = new SocialCalc.TableControl(editor, true, editor.tableheight);\n    editor.verticaltablecontrol.CreateTableControl();\n    AssignID(editor, editor.verticaltablecontrol.main, \"tablecontrolv\");\n    \n    editor.horizontaltablecontrol = new SocialCalc.TableControl(editor, false, editor.tablewidth);\n    editor.horizontaltablecontrol.CreateTableControl();\n    AssignID(editor, editor.horizontaltablecontrol.main, \"tablecontrolh\");\n    \n    var table, tbody, tr, td, img, anchor, ta, ha;\n    \n    table = document.createElement(\"table\");\n    editor.layouttable = table;\n    table.cellSpacing = 0;\n    table.cellPadding = 0;\n    AssignID(editor, table, \"layouttable\");\n    \n    tbody = document.createElement(\"tbody\");\n    table.appendChild(tbody);\n    \n    tr = document.createElement(\"tr\");\n    tbody.appendChild(tr);\n    td = document.createElement(\"td\");\n    td.appendChild(editor.griddiv);\n    tr.appendChild(td);\n    td = document.createElement(\"td\");\n    //td.appendChild(editor.verticaltablecontrol.main);\n    tr.appendChild(td);\n    \n    tr = document.createElement(\"tr\");\n    tbody.appendChild(tr);\n    td = document.createElement(\"td\");\n    //td.appendChild(editor.horizontaltablecontrol.main);\n    tr.appendChild(td);\n    \n    td = document.createElement(\"td\"); // logo display: Required by CPAL License for this code!\n    //td.style.background=\"url(\"+editor.imageprefix+\"logo.gif) no-repeat center center\";\n    td.innerHTML = \"<div style='cursor:pointer;font-size:1px;'><img src='\"+editor.imageprefix+\"1x1.gif' border='0' width='18' height='18'></div>\";\n    tr.appendChild(td);\n    editor.logo = td;\n    AssignID(editor, editor.logo, \"logo\");\n    SocialCalc.TooltipRegister(td.firstChild.firstChild, \"SocialCalc\", null);\n    \n    editor.toplevel.appendChild(editor.layouttable);\n    \n    if (!editor.noEdit) {\n        editor.inputEcho = new SocialCalc.InputEcho(editor);\n        AssignID(editor, editor.inputEcho.main, \"inputecho\");\n    }\n    \n    editor.cellhandles = new SocialCalc.CellHandles(editor);\n    \n    ta = document.createElement(\"textarea\"); // used for ctrl-c/ctrl-v where an invisible text area is needed\n    SocialCalc.setStyles(ta, \"display:none;position:absolute;height:1px;width:1px;opacity:0;filter:alpha(opacity=0);\");\n    ta.value = \"\";\n    editor.pasteTextarea = ta;\n    AssignID(editor, editor.pasteTextarea, \"pastetextarea\");\n    \n    if (navigator.userAgent.match(/Safari\\//) &&!navigator.userAgent.match(/Chrome\\//)) { // special code for Safari 5 change\nwindow.removeEventListener('beforepaste', SocialCalc.SafariPasteFunction, false);\nwindow.addEventListener('beforepaste', SocialCalc.SafariPasteFunction, false);\nwindow.removeEventListener('beforecopy', SocialCalc.SafariPasteFunction, false);\nwindow.addEventListener('beforecopy', SocialCalc.SafariPasteFunction, false);\nwindow.removeEventListener('beforecut', SocialCalc.SafariPasteFunction, false);\nwindow.addEventListener('beforecut', SocialCalc.SafariPasteFunction, false);\n}\n\neditor.toplevel.appendChild(editor.pasteTextarea);\n\nvar div = document.createElement(\"div\");\ndiv.innerHTML = '    <br/>';\nif (div.firstChild.nodeType == 1) {\n/* We are running in IE -- Using HTML-based area for Ctrl-V */\nha = document.createElement(\"div\"); // used for ctrl-v where an invisible html area is needed\neditor.pasteHTMLarea = ha;\neditor.toplevel.appendChild(editor.pasteHTMLarea);\nha.contentEditable = true;\nAssignID(editor, editor.pasteHTMLarea, \"pastehtmlarea\");\nSocialCalc.setStyles(ha, \"display:block;visibility:hidden;position:absolute;height:1px;width:1px;opacity:0;filter:alpha(opacity=0);overflow:hidden\");\n}\n\nSocialCalc.MouseWheelRegister(editor.toplevel, {WheelMove: SocialCalc.EditorProcessMouseWheel, editor: editor});\n\nif (SocialCalc.HasTouch) {\nSocialCalc.TouchRegister(editor.toplevel, {Swipe: SocialCalc.EditorProcessSwipe,\nDoubleTap: SocialCalc.EditorProcessDoubleTap,\nSingleTap: SocialCalc.EditorProcessSingleTap,\neditor: editor});\n}\n\nif (editor.inputBox) { // this seems to fix an obscure bug with Firefox 2 Mac where Ctrl-V doesn't get fired right\nif (editor.inputBox.element) {\neditor.inputBox.element.focus();\neditor.inputBox.element.blur();\n}\n}\nSocialCalc.KeyboardSetFocus(editor);\n\n// do status reporting things\n\nSocialCalc.EditorSheetStatusCallback(null, \"startup\", null, editor);\n\n// done\n\nreturn editor.toplevel;\n\n}\n\n// Special code needed for change that occurred with Safari 5 that made paste not work for some reason\n\nSocialCalc.SafariPasteFunction = function(e) {\ne.preventDefault();\n}\n\n//\n// SocialCalc.ResizeTableEditor(editor, width, height)\n//\n// Move things around as appropriate and resize\n//\n\nSocialCalc.ResizeTableEditor = function(editor, width, height) {\n\nvar scc = SocialCalc.Constants;\n\neditor.width = width;\neditor.height = height;\n\neditor.toplevel.style.width = width+\"px\";\neditor.toplevel.style.height = height+\"px\";\n\neditor.tablewidth = Math.max(0, width - scc.defaultTableControlThickness);\neditor.tableheight = Math.max(0, height - scc.defaultTableControlThickness);\neditor.griddiv.style.width=editor.tablewidth+\"px\";\neditor.griddiv.style.height=editor.tableheight+\"px\";\n\neditor.verticaltablecontrol.main.style.height = editor.tableheight + \"px\";\neditor.horizontaltablecontrol.main.style.width = editor.tablewidth + \"px\";\n\neditor.FitToEditTable();\n\neditor.ScheduleRender();\n\nreturn;\n\n}\n\n//\n// str = SaveEditorSettings(editor)\n//\n// Returns a string representation of the pane settings, etc.\n//\n// The format is:\n//\n//    version:1.0\n//    rowpane:panenumber:firstnum:lastnum\n//    colpane:panenumber:firstnum:lastnum\n//    ecell:coord -- if set\n//    range:anchorcoord:top:bottom:left:right -- if set\n//\n// You can add additional values to be saved by using editor.SettingsCallbacks:\n//\n//   editor.SettingsCallbacks[\"item-name\"] = {save: savefunction, load: loadfunction}\n//\n// where savefunction(editor, \"item-name\") returns a string with the new lines to be added to the saved settings\n// which include the trailing newlines, and loadfunction(editor, \"item-name\", line, flags) is given the line to process\n// without the trailing newlines.\n//\n\nSocialCalc.SaveEditorSettings = function(editor) {\n\nvar i, setting;\nvar context = editor.context;\nvar range = editor.range;\nvar result = \"\";\n\nresult += \"version:1.0\\n\";\n\nfor (i=0; i<context.rowpanes.length; i++) {\nresult += \"rowpane:\"+i+\":\"+context.rowpanes[i].first+\":\"+context.rowpanes[i].last+\"\\n\";\n}\nfor (i=0; i<context.colpanes.length; i++) {\nresult += \"colpane:\"+i+\":\"+context.colpanes[i].first+\":\"+context.colpanes[i].last+\"\\n\";\n}\n\nif (editor.ecell) {\nresult += \"ecell:\"+editor.ecell.coord+\"\\n\";\n}\n\nif (range.hasrange) {\nresult += \"range:\"+range.anchorcoord+\":\"+range.top+\":\"+range.bottom+\":\"+range.left+\":\"+range.right+\"\\n\";\n}\n\nfor (setting in editor.SettingsCallbacks) {\nresult += editor.SettingsCallbacks[setting].save(editor, setting);\n}\n\nreturn result;\n\n}\n\n//\n// LoadEditorSettings(editor, str, flags)\n//\n// Sets the editor settings based on str. See SocialCalc.SaveEditorSettings for more details.\n// Unrecognized lines are ignored.\n//\n\nSocialCalc.LoadEditorSettings = function(editor, str, flags) {\n\nvar lines=str.split(/\\r\\n|\\n/);\nvar parts=[];\nvar line, i, cr, row, col, coord, setting;\nvar context = editor.context;\nvar highlights, range;\n\ncontext.rowpanes = [{first: 1, last: 1}]; // reset to start\ncontext.colpanes = [{first: 1, last: 1}];\neditor.ecell = null;\neditor.range = {hasrange: false};\neditor.range2 = {hasrange: false};\nrange = editor.range;\ncontext.highlights = {};\nhighlights = context.highlights;\n\nfor (i=0; i<lines.length; i++) {\nline=lines[i];\nparts = line.split(\":\");\nsetting = parts[0];\nswitch (setting) {\ncase \"version\":\nbreak;\n\ncase \"rowpane\":\ncontext.rowpanes[parts[1]-0] = {first: parts[2]-0, last: parts[3]-0};\nbreak;\n\ncase \"colpane\":\ncontext.colpanes[parts[1]-0] = {first: parts[2]-0, last: parts[3]-0};\nbreak;\n\ncase \"ecell\":\neditor.ecell = SocialCalc.coordToCr(parts[1]);\neditor.ecell.coord = parts[1];\nhighlights[parts[1]] = \"cursor\";\nbreak;\n\ncase \"range\":\nrange.hasrange = true;\nrange.anchorcoord = parts[1];\ncr = SocialCalc.coordToCr(range.anchorcoord);\nrange.anchorrow = cr.row;\nrange.anchorcol = cr.col;\nrange.top = parts[2]-0;\nrange.bottom = parts[3]-0;\nrange.left = parts[4]-0;\nrange.right = parts[5]-0;\nfor (row=range.top; row<=range.bottom; row++) {\nfor (col=range.left; col<=range.right; col++) {\ncoord = SocialCalc.crToCoord(col, row);\nif (highlights[coord]!=\"cursor\") {\nhighlights[coord] = \"range\";\n}\n}\n}\nbreak;\n\ndefault:\nif (editor.SettingsCallbacks[setting]) {\neditor.SettingsCallbacks[setting].load(editor, setting, line, flags);\n}\nbreak;\n}\n}\n\nreturn;\n\n}\n\n//\n// EditorRenderSheet(editor)\n//\n// Renders the sheet and updates editor.fullgrid.\n// Sets event handlers.\n//\n\nSocialCalc.EditorRenderSheet = function(editor) {\n\neditor.EditorMouseUnregister();\n\neditor.fullgrid = editor.context.RenderSheet(editor.fullgrid);\n\nif (editor.ecell) editor.SetECellHeaders(\"selected\");\n\nSocialCalc.AssignID(editor, editor.fullgrid, \"fullgrid\"); // give it an id\n\neditor.EditorMouseRegister();\n\n}\n\n//\n// EditorScheduleSheetCommands(editor, cmdstr, saveundo, ignorebusy)\n//\n\nSocialCalc.EditorScheduleSheetCommands = function(editor, cmdstr, saveundo, ignorebusy) {\n\nif (editor.state!=\"start\" && !ignorebusy) { // ignore commands if editing a cell\nreturn;\n}\n\nif (editor.busy && !ignorebusy) { // hold off on commands if doing one\neditor.deferredCommands.push({cmdstr: cmdstr, saveundo: saveundo});\nreturn;\n}\n\nswitch (cmdstr) {\ncase \"recalc\":\ncase \"redisplay\":\neditor.context.sheetobj.ScheduleSheetCommands(cmdstr, false);\nbreak;\n\ncase \"undo\":\neditor.SheetUndo();\nbreak;\n\ncase \"redo\":\neditor.SheetRedo();\nbreak;\n\ndefault:\neditor.context.sheetobj.ScheduleSheetCommands(cmdstr, saveundo);\nbreak;\n}\n}\n\n\n//\n// EditorSheetStatusCallback(recalcdata, status, arg, editor)\n//\n// Called during recalc, executing commands, etc.\n//\n\nSocialCalc.EditorSheetStatusCallback = function(recalcdata, status, arg, editor) {\n\nvar f, cell, dcmd;\nvar sheetobj = editor.context.sheetobj;\n\nvar signalstatus = function(s) {\nfor (f in editor.StatusCallback) {\nif (editor.StatusCallback[f].func) {\neditor.StatusCallback[f].func(editor, s, arg, editor.StatusCallback[f].params);\n}\n}\n}\n\nswitch (status) {\n\ncase \"startup\":\nbreak;\n\ncase \"cmdstart\":\neditor.busy = true;\nsheetobj.celldisplayneeded = \"\";\nbreak;\n\ncase \"cmdextension\":\nbreak;\n\ncase \"cmdend\":\nsignalstatus(status);\n\nif (sheetobj.changedrendervalues) {\neditor.context.PrecomputeSheetFontsAndLayouts();\neditor.context.CalculateCellSkipData();\nsheetobj.changedrendervalues = false;\n}\n\nif (sheetobj.celldisplayneeded && !sheetobj.renderneeded) {\ncr = SocialCalc.coordToCr(sheetobj.celldisplayneeded);\ncell = SocialCalc.GetEditorCellElement(editor, cr.row, cr.col);\neditor.ReplaceCell(cell, cr.row, cr.col);\n}\n\nif (editor.deferredCommands.length) {\ndcmd = editor.deferredCommands.shift();\neditor.EditorScheduleSheetCommands(dcmd.cmdstr, dcmd.saveundo, true);\nreturn;\n}\n\nif (sheetobj.attribs.needsrecalc &&\n(sheetobj.attribs.recalc!=\"off\" || sheetobj.recalconce)\n&& editor.recalcFunction) {\neditor.FitToEditTable();\nsheetobj.renderneeded = false; // recalc will force a render\nif (sheetobj.recalconce) delete sheetobj.recalconce; // only do once\neditor.recalcFunction(editor);\n}\nelse {\nif (sheetobj.renderneeded) {\neditor.FitToEditTable();\nsheetobj.renderneeded = false;\neditor.ScheduleRender();\n}\nelse {\neditor.SchedulePositionCalculations(); // just in case command changed positions\n//               editor.busy = false;\n//               signalstatus(\"cmdendnorender\");\n}\n}\nreturn;\n\ncase \"calcstart\":\neditor.busy = true;\nbreak;\n\ncase \"calccheckdone\":\ncase \"calcorder\":\ncase \"calcstep\":\ncase \"calcloading\":\ncase \"calcserverfunc\":\nbreak;\n\ncase \"calcfinished\":\nsignalstatus(status);\neditor.ScheduleRender();\nreturn;\n\ncase \"schedrender\":\neditor.busy = true; // in case got here without cmd or recalc\nbreak;\n\ncase \"renderdone\":\nbreak;\n\ncase \"schedposcalc\":\neditor.busy = true; // in case got here without cmd or recalc\nbreak;\n\ncase \"doneposcalc\":\nif (editor.deferredCommands.length) {\nsignalstatus(status);\ndcmd = editor.deferredCommands.shift();\neditor.EditorScheduleSheetCommands(dcmd.cmdstr, dcmd.saveundo, true);\n}\nelse {\neditor.busy = false;\nsignalstatus(status);\nif (editor.state==\"start\") editor.DisplayCellContents(); // make sure up to date\n}\nreturn;\n\ndefault:\naddmsg(\"Unknown status: \"+status);\nbreak;\n\n}\n\nsignalstatus(status);\n\nreturn;\n\n}\n\n// Timer-driven steps for use with SocialCalc.EditorSheetStatusCallback\n\nSocialCalc.EditorStepInfo = {\n//   status: \"\", // saved value to pass to callback\neditor: null // for callback\n//   arg: null, // for callback\n//   timerobj: null\n};\n                                  \n    /*\n     SocialCalc.EditorStepSet = function(editor, status, arg) {\n     var esi = SocialCalc.EditorStepInfo;\n     addmsg(\"step: \"+status);\n     if (esi.timerobj) {\n     alert(\"Already waiting. Old/new: \"+esi.status+\"/\"+status);\n     }\n     esi.editor = editor;\n     esi.status = status;\n     esi.timerobj = window.setTimeout(SocialCalc.EditorStepDone, 1);\n     }\n     \n     SocialCalc.EditorStepDone = function() {\n     var esi = SocialCalc.EditorStepInfo;\n     esi.timerobj = null;\n     SocialCalc.EditorSheetStatusCallback(null, esi.status, null, esi.editor);\n     }\n     */\n\n//\n// str = SocialCalc.EditorGetStatuslineString(editor, status, arg, params)\n//\n// Assumes params is an object where it can use \"calculating\" and \"command\"\n// to keep track of state.\n// Returns string for status line.\n//\n\nSocialCalc.EditorGetStatuslineString = function(editor, status, arg, params) {\n\nvar scc = SocialCalc.Constants;\n\nvar sstr, progress, coord, circ, r, c, cell, sum, ele;\n\nprogress = \"\";\n\nswitch (status) {\ncase \"moveecell\":\ncase \"rangechange\":\ncase \"startup\":\nbreak;\ncase \"cmdstart\":\nparams.command = true;\ndocument.body.style.cursor = \"progress\";\neditor.griddiv.style.cursor = \"progress\";\nprogress = scc.s_statusline_executing;\nbreak;\ncase \"cmdextension\":\nprogress = \"Command Extension: \"+arg;\nbreak;\ncase \"cmdend\":\nparams.command = false;\nbreak;\ncase \"schedrender\":\nprogress = scc.s_statusline_displaying;\nbreak;\ncase \"renderdone\":\nprogress = \" \";\nbreak;\ncase \"schedposcalc\":\nprogress = scc.s_statusline_displaying;\nbreak;\ncase \"cmdendnorender\":\ncase \"doneposcalc\":\ndocument.body.style.cursor = \"default\";\neditor.griddiv.style.cursor = \"default\";\nbreak;\ncase \"calcorder\":\nprogress = scc.s_statusline_ordering+Math.floor(100*arg.count/(arg.total||1))+\"%\";\nbreak;\ncase \"calcstep\":\nprogress = scc.s_statusline_calculating+Math.floor(100*arg.count/(arg.total||1))+\"%\";\nbreak;\ncase \"calcloading\":\nprogress = scc.s_statusline_calculatingls+\": \"+arg.sheetname;\nbreak;\ncase \"calcserverfunc\":\nprogress = scc.s_statusline_calculating+Math.floor(100*arg.count/(arg.total||1))+\"%, \"+scc.s_statusline_doingserverfunc+arg.funcname+scc.s_statusline_incell+arg.coord;\nbreak;\ncase \"calcstart\":\nparams.calculating = true;\ndocument.body.style.cursor = \"progress\";\neditor.griddiv.style.cursor = \"progress\"; // griddiv has an explicit cursor style\nprogress = scc.s_statusline_calcstart;\nbreak;\ncase \"calccheckdone\":\nbreak;\ncase \"calcfinished\":\nparams.calculating = false;\nbreak;\ndefault:\nprogress = status;\nbreak;\n}\n\nif (!progress && params.calculating) {\nprogress = scc.s_statusline_calculating;\n}\n\n// if there is a range, calculate sum (not during busy times)\nif (!params.calculating && !params.command && !progress && editor.range.hasrange\n&& (editor.range.left!=editor.range.right || editor.range.top!=editor.range.bottom)) {\nsum = 0;\nfor (r=editor.range.top; r <= editor.range.bottom; r++) {\nfor (c=editor.range.left; c <= editor.range.right; c++) {\ncell = editor.context.sheetobj.cells[SocialCalc.crToCoord(c, r)];\nif (!cell) continue;\nif (cell.valuetype && cell.valuetype.charAt(0)==\"n\") {\nsum += cell.datavalue-0;\n}\n}\n}\n\nsum = SocialCalc.FormatNumber.formatNumberWithFormat(sum, \"[,]General\", \"\");\n\ncoord = SocialCalc.crToCoord(editor.range.left, editor.range.top) + \":\" +\nSocialCalc.crToCoord(editor.range.right, editor.range.bottom);\nprogress = coord + \" (\" + (editor.range.right-editor.range.left+1) + \"x\" + (editor.range.bottom-editor.range.top+1) +\n\") \"+scc.s_statusline_sum+\"=\" + sum + \" \" + progress;\n}\nsstr = editor.ecell.coord+\" &nbsp; \"+progress;\n\nif (!params.calculating && editor.context.sheetobj.attribs.needsrecalc==\"yes\") {\nsstr += ' &nbsp; '+scc.s_statusline_recalcneeded;\n}\n\ncirc = editor.context.sheetobj.attribs.circularreferencecell;\nif (circ) {\ncirc = circ.replace(/\\|/, \" referenced by \");\nsstr += ' &nbsp; '+scc.s_statusline_circref + circ + '</span>';\n}\n\nreturn sstr;\n\n}\n\n\n//\n// Mouse stuff\n//\n\nSocialCalc.EditorMouseInfo = {\n\n// The registeredElements array is used to identify editor grid in which the mouse is doing things.\n\n// One item for each active editor, each an object with:\n//    .element, .editor\n\nregisteredElements: [],\n\neditor: null, // editor being processed (between mousedown and mouseup)\nelement: null, // element being processed\n\nignore: false, // if true, mousedowns are ignored\n\nmousedowncoord: \"\", // coord where mouse went down for drag range\nmouselastcoord: \"\", // coord where mouse last was during drag\nmouseresizecol: \"\", // col being resized\nmouseresizeclientx: null, // where resize started\nmouseresizedisplay: null // element tracking new size\n}\n\n//\n// EditorMouseRegister(editor)\n//\n\nSocialCalc.EditorMouseRegister = function(editor) {\n\nvar mouseinfo = SocialCalc.EditorMouseInfo;\nvar element = editor.fullgrid;\nvar i;\n\nfor (i=0; i<mouseinfo.registeredElements.length; i++) {\nif (mouseinfo.registeredElements[i].editor == editor) {\nif (mouseinfo.registeredElements[i].element == element) {\nreturn; // already set - don't do it again\n}\nbreak;\n}\n}\n\nif (i<mouseinfo.registeredElements.length) {\nmouseinfo.registeredElements[i].element = element;\n}\nelse {\nmouseinfo.registeredElements.push({element: element, editor: editor});\n}\n\nif (element.addEventListener) { // DOM Level 2 -- Firefox, et al\nelement.addEventListener(\"mousedown\", SocialCalc.ProcessEditorMouseDown, false);\nelement.addEventListener(\"dblclick\", SocialCalc.ProcessEditorDblClick, false);\n}\nelse if (element.attachEvent) { // IE 5+\nelement.attachEvent(\"onmousedown\", SocialCalc.ProcessEditorMouseDown);\nelement.attachEvent(\"ondblclick\", SocialCalc.ProcessEditorDblClick);\n}\nelse { // don't handle this\nthrow \"Browser not supported\";\n}\n\nmouseinfo.ignore = false; // just in case\n\nreturn;\n\n}\n\n//\n// EditorMouseUnregister(editor)\n//\n\nSocialCalc.EditorMouseUnregister = function(editor) {\n\nvar mouseinfo = SocialCalc.EditorMouseInfo;\nvar element = editor.fullgrid;\nvar i, oldelement;\n\nfor (i=0; i<mouseinfo.registeredElements.length; i++) {\nif (mouseinfo.registeredElements[i].editor == editor) {\nbreak;\n}\n}\n\nif (i<mouseinfo.registeredElements.length) {\noldelement = mouseinfo.registeredElements[i].element; // remove old handlers\nif (oldelement.removeEventListener) { // DOM Level 2\noldelement.removeEventListener(\"mousedown\", SocialCalc.ProcessEditorMouseDown, false);\noldelement.removeEventListener(\"dblclick\", SocialCalc.ProcessEditorDblClick, false);\n}\nelse if (oldelement.detachEvent) { // IE\noldelement.detachEvent(\"onmousedown\", SocialCalc.ProcessEditorMouseDown);\noldelement.detachEvent(\"ondblclick\", SocialCalc.ProcessEditorDblClick);\n}\nmouseinfo.registeredElements.splice(i, 1);\n}\n\nreturn;\n\n}\n\nSocialCalc.ProcessEditorMouseDown = function(e) {\n\nvar editor, result, coord, textarea, wval, range;\n\nvar event = e || window.event;\n\nvar viewport = SocialCalc.GetViewportInfo();\nvar clientX = event.clientX + viewport.horizontalScroll;\nvar clientY = event.clientY + viewport.verticalScroll;\n\nvar mouseinfo = SocialCalc.EditorMouseInfo;\nvar ele = event.target || event.srcElement; // source object is often within what we want\nvar mobj;\n\nif (mouseinfo.ignore) return; // ignore this\n\nfor (mobj=null; !mobj && ele; ele=ele.parentNode) { // go up tree looking for one of our elements\nmobj = SocialCalc.LookupElement(ele, mouseinfo.registeredElements);\n}\nif (!mobj) {\nmouseinfo.editor = null;\nreturn; // not one of our elements\n}\n\neditor = mobj.editor;\nmouseinfo.element = ele;\nrange = editor.range;\nresult = SocialCalc.GridMousePosition(editor, clientX, clientY);\n\nif (!result || result.rowheader) return; // not on a cell or col header\nmouseinfo.editor = editor; // remember for later\n\nif (result.colheader && result.coltoresize) { // col header - do drag resize\nSocialCalc.ProcessEditorColsizeMouseDown(e, ele, result);\nreturn;\n}\n\nif (!result.coord) return; // not us\n\nif (!range.hasrange) {\nif (e.shiftKey)\neditor.RangeAnchor();\n}\n\n\nSocialCalc.Callbacks.ToggleCell(result.coord);\ncoord = editor.MoveECell(result.coord);\n\nif (range.hasrange) {\nif (e.shiftKey)\neditor.RangeExtend();\nelse\neditor.RangeRemove();\n}\n\nmouseinfo.mousedowncoord = coord; // remember if starting drag range select\nmouseinfo.mouselastcoord = coord;\n\neditor.EditorMouseRange(coord);\n\nSocialCalc.KeyboardSetFocus(editor);\nif (editor.state!=\"start\" && editor.inputBox) editor.inputBox.element.focus();\n\n// Event code from JavaScript, Flanagan, 5th Edition, pg. 422\nif (document.addEventListener) { // DOM Level 2 -- Firefox, et al\ndocument.addEventListener(\"mousemove\", SocialCalc.ProcessEditorMouseMove, true); // capture everywhere\ndocument.addEventListener(\"mouseup\", SocialCalc.ProcessEditorMouseUp, true); // capture everywhere\n}\nelse if (ele.attachEvent) { // IE 5+\nele.setCapture();\nele.attachEvent(\"onmousemove\", SocialCalc.ProcessEditorMouseMove);\nele.attachEvent(\"onmouseup\", SocialCalc.ProcessEditorMouseUp);\nele.attachEvent(\"onlosecapture\", SocialCalc.ProcessEditorMouseUp);\n}\nif (event.stopPropagation) event.stopPropagation(); // DOM Level 2\nelse event.cancelBubble = true; // IE 5+\nif (event.preventDefault) event.preventDefault(); // DOM Level 2\nelse event.returnValue = false; // IE 5+\n\nreturn;\n\n}\n\nSocialCalc.EditorMouseRange = function(editor, coord) {\n\nvar inputtext, wval;\nvar range = editor.range;\n\n\nswitch (editor.state) { // editing a cell - shouldn't get here if no inputBox\ncase \"input\":\ninputtext = editor.inputBox.GetText();\nwval = editor.workingvalues;\nif ((\"(+-*/,:!&<>=^\".indexOf(inputtext.slice(-1))>=0 && inputtext.slice(0,1)==\"=\") ||\n(inputtext == \"=\")) {\nwval.partialexpr = inputtext;\n}\nif (wval.partialexpr) { // if in pointing operation\nif (coord) {\nif (range.hasrange) {\nvar sheetpref = (wval.currentsheet == wval.startsheet)?\"\":wval.currentsheet+\"!\";\neditor.inputBox.SetText(wval.partialexpr + sheetpref+ SocialCalc.crToCoord(range.left, range.top) + \":\" + sheetpref +\n              SocialCalc.crToCoord(range.right, range.bottom));\n}\nelse {\nvar sheetpref = (wval.currentsheet == wval.startsheet)?\"\":wval.currentsheet+\"!\";\neditor.inputBox.SetText(wval.partialexpr + sheetpref+coord);\n}\n}\n}\nelse { // not in point -- done editing\neditor.inputBox.Blur();\neditor.inputBox.ShowInputBox(false);\neditor.state = \"start\";\neditor.cellhandles.ShowCellHandles(true);\neditor.EditorSaveEdit();\neditor.inputBox.DisplayCellContents(null);\n}\nbreak;\n\ncase \"inputboxdirect\":\neditor.inputBox.Blur();\neditor.inputBox.ShowInputBox(false);\neditor.state = \"start\";\neditor.cellhandles.ShowCellHandles(true);\neditor.EditorSaveEdit();\neditor.inputBox.DisplayCellContents(null);\nbreak;\n}\n}\n\nSocialCalc.ProcessEditorMouseMove = function(e) {\n\nvar editor, element, result, coord, now, textarea, sheetobj, cellobj, wval;\n\nvar event = e || window.event;\n\nvar viewport = SocialCalc.GetViewportInfo();\nvar clientX = event.clientX + viewport.horizontalScroll;\nvar clientY = event.clientY + viewport.verticalScroll;\n\nvar mouseinfo = SocialCalc.EditorMouseInfo;\neditor = mouseinfo.editor;\nif (!editor) return; // not us, ignore\nif (mouseinfo.ignore) return; // ignore this\nelement = mouseinfo.element;\n\nresult = SocialCalc.GridMousePosition(editor, clientX, clientY); // get cell with move\n\nif (!result) return;\n\nif (result && !result.coord) {\nSocialCalc.SetDragAutoRepeat(editor, result);\nreturn;\n}\n\nSocialCalc.SetDragAutoRepeat(editor, null); // stop repeating if it was\n\nif (!result.coord) return;\n\nif (result.coord!=mouseinfo.mouselastcoord) {\nif (!e.shiftKey && !editor.range.hasrange) {\neditor.RangeAnchor(mouseinfo.mousedowncoord);\n}\neditor.MoveECell(result.coord);\neditor.RangeExtend();\n}\nmouseinfo.mouselastcoord = result.coord;\n\neditor.EditorMouseRange(result.coord);\n\nif (event.stopPropagation) event.stopPropagation(); // DOM Level 2\nelse event.cancelBubble = true; // IE 5+\nif (event.preventDefault) event.preventDefault(); // DOM Level 2\nelse event.returnValue = false; // IE 5+\n\nreturn;\n\n}\n\n\nSocialCalc.ProcessEditorMouseUp = function(e) {\n\nvar editor, element, result, coord, now, textarea, sheetobj, cellobj, wval;\n\nvar event = e || window.event;\n\nvar viewport = SocialCalc.GetViewportInfo();\nvar clientX = event.clientX + viewport.horizontalScroll;\nvar clientY = event.clientY + viewport.verticalScroll;\n\nvar mouseinfo = SocialCalc.EditorMouseInfo;\neditor = mouseinfo.editor;\nif (!editor) return; // not us, ignore\nif (mouseinfo.ignore) return; // ignore this\nelement = mouseinfo.element;\n\nresult = SocialCalc.GridMousePosition(editor, clientX, clientY); // get cell with up\n\nSocialCalc.SetDragAutoRepeat(editor, null); // stop repeating if it was\n\nif (!result) return;\n\nif (!result.coord) result.coord = editor.ecell.coord;\n\nif (editor.range.hasrange) {\neditor.MoveECell(result.coord);\neditor.RangeExtend();\n}\nelse if (result.coord && result.coord!=mouseinfo.mousedowncoord) {\neditor.RangeAnchor(mouseinfo.mousedowncoord);\neditor.MoveECell(result.coord);\neditor.RangeExtend();\n}\n\neditor.EditorMouseRange(result.coord);\n\nif (event.stopPropagation) event.stopPropagation(); // DOM Level 2\nelse event.cancelBubble = true; // IE 5+\nif (event.preventDefault) event.preventDefault(); // DOM Level 2\nelse event.returnValue = false; // IE 5+\n\nif (document.removeEventListener) { // DOM Level 2\ndocument.removeEventListener(\"mousemove\", SocialCalc.ProcessEditorMouseMove, true);\ndocument.removeEventListener(\"mouseup\", SocialCalc.ProcessEditorMouseUp, true);\n}\nelse if (element.detachEvent) { // IE\nelement.detachEvent(\"onlosecapture\", SocialCalc.ProcessEditorMouseUp);\nelement.detachEvent(\"onmouseup\", SocialCalc.ProcessEditorMouseUp);\nelement.detachEvent(\"onmousemove\", SocialCalc.ProcessEditorMouseMove);\nelement.releaseCapture();\n}\n\nmouseinfo.editor = null;\n\nreturn false;\n\n}\n\n\nSocialCalc.ProcessEditorColsizeMouseDown = function(e, ele, result) {\n\nvar event = e || window.event;\nvar mouseinfo = SocialCalc.EditorMouseInfo;\nvar editor = mouseinfo.editor;\nvar viewport = SocialCalc.GetViewportInfo();\nvar clientX = event.clientX + viewport.horizontalScroll;\n\nmouseinfo.mouseresizecolnum = result.coltoresize; // remember col being resized\nmouseinfo.mouseresizecol = SocialCalc.rcColname(result.coltoresize);\nmouseinfo.mousedownclientx = clientX;\n\nvar sizedisplay = document.createElement(\"div\");\nmouseinfo.mouseresizedisplay = sizedisplay;\nsizedisplay.style.width = \"auto\";\nsizedisplay.style.position = \"absolute\";\nsizedisplay.style.zIndex = 100;\nsizedisplay.style.top = (editor.headposition.top+0)+\"px\";\nsizedisplay.style.left = editor.colpositions[result.coltoresize]+\"px\";\nsizedisplay.innerHTML = '<table cellpadding=\"0\" cellspacing=\"0\"><tr><td style=\"height:100px;'+\n'border:1px dashed black;background-color:white;width:' +\n(editor.context.colwidth[mouseinfo.mouseresizecolnum]-2) + 'px;\">&nbsp;</td>'+\n'<td><div style=\"font-size:small;color:white;background-color:gray;padding:4px;\">'+\neditor.context.colwidth[mouseinfo.mouseresizecolnum] + '</div></td></tr></table>';\nSocialCalc.setStyles(sizedisplay.firstChild.lastChild.firstChild.childNodes[0], \"filter:alpha(opacity=85);opacity:.85;\"); // so no warning msg with Firefox about filter\n\neditor.toplevel.appendChild(sizedisplay);\n\n// Event code from JavaScript, Flanagan, 5th Edition, pg. 422\nif (document.addEventListener) { // DOM Level 2 -- Firefox, et al\ndocument.addEventListener(\"mousemove\", SocialCalc.ProcessEditorColsizeMouseMove, true); // capture everywhere\ndocument.addEventListener(\"mouseup\", SocialCalc.ProcessEditorColsizeMouseUp, true); // capture everywhere\n}\nelse if (editor.toplevel.attachEvent) { // IE 5+\neditor.toplevel.setCapture();\neditor.toplevel.attachEvent(\"onmousemove\", SocialCalc.ProcessEditorColsizeMouseMove);\neditor.toplevel.attachEvent(\"onmouseup\", SocialCalc.ProcessEditorColsizeMouseUp);\neditor.toplevel.attachEvent(\"onlosecapture\", SocialCalc.ProcessEditorColsizeMouseUp);\n}\nif (event.stopPropagation) event.stopPropagation(); // DOM Level 2\nelse event.cancelBubble = true; // IE 5+\nif (event.preventDefault) event.preventDefault(); // DOM Level 2\nelse event.returnValue = false; // IE 5+\n\nreturn;\n}\n\n\nSocialCalc.ProcessEditorColsizeMouseMove = function(e) {\n\nvar event = e || window.event;\nvar mouseinfo = SocialCalc.EditorMouseInfo;\nvar editor = mouseinfo.editor;\nif (!editor) return; // not us, ignore\nvar viewport = SocialCalc.GetViewportInfo();\nvar clientX = event.clientX + viewport.horizontalScroll;\n\nvar newsize = (editor.context.colwidth[mouseinfo.mouseresizecolnum]-0) + (clientX - mouseinfo.mousedownclientx);\nif (newsize < SocialCalc.Constants.defaultMinimumColWidth) newsize = SocialCalc.Constants.defaultMinimumColWidth;\n\nvar sizedisplay = mouseinfo.mouseresizedisplay;\n//   sizedisplay.firstChild.lastChild.firstChild.childNodes[1].firstChild.innerHTML = newsize+\"\";\n//   sizedisplay.firstChild.lastChild.firstChild.childNodes[0].firstChild.style.width = (newsize-2)+\"px\";\nsizedisplay.innerHTML = '<table cellpadding=\"0\" cellspacing=\"0\"><tr><td style=\"height:100px;'+\n'border:1px dashed black;background-color:white;width:' + (newsize-2) + 'px;\">&nbsp;</td>'+\n'<td><div style=\"font-size:small;color:white;background-color:gray;padding:4px;\">'+\nnewsize + '</div></td></tr></table>';\nSocialCalc.setStyles(sizedisplay.firstChild.lastChild.firstChild.childNodes[0], \"filter:alpha(opacity=85);opacity:.85;\"); // so no warning msg with Firefox about filter\n\nif (event.stopPropagation) event.stopPropagation(); // DOM Level 2\nelse event.cancelBubble = true; // IE 5+\nif (event.preventDefault) event.preventDefault(); // DOM Level 2\nelse event.returnValue = false; // IE 5+\n\nreturn;\n\n}\n\n\nSocialCalc.ProcessEditorColsizeMouseUp = function(e) {\n\nvar event = e || window.event;\nvar mouseinfo = SocialCalc.EditorMouseInfo;\nvar editor = mouseinfo.editor;\nif (!editor) return; // not us, ignore\nelement = mouseinfo.element;\nvar viewport = SocialCalc.GetViewportInfo();\nvar clientX = event.clientX + viewport.horizontalScroll;\n\nif (event.stopPropagation) event.stopPropagation(); // DOM Level 2\nelse event.cancelBubble = true; // IE 5+\nif (event.preventDefault) event.preventDefault(); // DOM Level 2\nelse event.returnValue = false; // IE 5+\n\nif (document.removeEventListener) { // DOM Level 2\ndocument.removeEventListener(\"mousemove\", SocialCalc.ProcessEditorColsizeMouseMove, true);\ndocument.removeEventListener(\"mouseup\", SocialCalc.ProcessEditorColsizeMouseUp, true);\n}\nelse if (editor.toplevel.detachEvent) { // IE\neditor.toplevel.detachEvent(\"onlosecapture\", SocialCalc.ProcessEditorColsizeMouseUp);\neditor.toplevel.detachEvent(\"onmouseup\", SocialCalc.ProcessEditorColsizeMouseUp);\neditor.toplevel.detachEvent(\"onmousemove\", SocialCalc.ProcessEditorColsizeMouseMove);\neditor.toplevel.releaseCapture();\n}\n\nvar newsize = (editor.context.colwidth[mouseinfo.mouseresizecolnum]-0) + (clientX - mouseinfo.mousedownclientx);\nif (newsize < SocialCalc.Constants.defaultMinimumColWidth) newsize = SocialCalc.Constants.defaultMinimumColWidth;\n\neditor.EditorScheduleSheetCommands(\"set \"+mouseinfo.mouseresizecol+\" width \"+newsize, true, false);\n\nif (editor.timeout) window.clearTimeout(editor.timeout);\neditor.timeout = window.setTimeout(SocialCalc.FinishColsize, 1); // wait - Firefox 2 has a bug otherwise with next mousedown\n\nreturn false;\n\n}\n\n\nSocialCalc.FinishColsize = function() {\n\nvar mouseinfo = SocialCalc.EditorMouseInfo;\nvar editor = mouseinfo.editor;\nif (!editor) return;\n\neditor.toplevel.removeChild(mouseinfo.mouseresizedisplay);\nmouseinfo.mouseresizedisplay = null;\n\n//   editor.FitToEditTable();\n//   editor.EditorRenderSheet();\n//   editor.SchedulePositionCalculations();\n\nmouseinfo.editor = null;\n\nreturn;\n\n}\n\n//\n// Handle auto-repeat of dragging the cursor into the borders of the sheet\n//\n\nSocialCalc.AutoRepeatInfo = {\n\ntimer: null, // timer object for repeating\nmouseinfo: null, // result from SocialCalc.GridMousePosition\nrepeatinterval: 1000, // milliseconds to wait between repeats\neditor: null, // editor object to use when it repeats\nrepeatcallback: null // used instead of default when repeating (e.g., for cellhandles)\n// called as: repeatcallback(newcoord, direction)\n\n};\n\n// Control auto-repeat. If mouseinfo==null, cancel.\n\nSocialCalc.SetDragAutoRepeat = function(editor, mouseinfo, callback) {\n\nvar repeatinfo = SocialCalc.AutoRepeatInfo;\nvar coord, direction;\n\nrepeatinfo.repeatcallback = callback; // null in regular case\n\nif (!mouseinfo) { // cancel\nif (repeatinfo.timer) { // If was repeating, stop\nwindow.clearTimeout(repeatinfo.timer); // cancel timer\nrepeatinfo.timer = null;\n}\nrepeatinfo.mouseinfo = null;\nreturn; // done\n}\n\nrepeatinfo.editor = editor;\n\nif (repeatinfo.mouseinfo) { // check for change while repeating\nif (mouseinfo.rowheader || mouseinfo.rowfooter) {\nif (mouseinfo.row != repeatinfo.mouseinfo.row) { // changed row while dragging sidewards\ncoord = SocialCalc.crToCoord(editor.ecell.col, mouseinfo.row); // change to it\nif (repeatinfo.repeatcallback) {\nif (mouseinfo.row < repeatinfo.mouseinfo.row) {\ndirection = \"left\";\n}\nelse if (mouseinfo.row > repeatinfo.mouseinfo.row) {\ndirection = \"right\";\n}\nelse {\ndirection = \"\";\n}\nrepeatinfo.repeatcallback(coord, direction);\n}\nelse {\neditor.MoveECell(coord);\neditor.MoveECell(coord);\neditor.RangeExtend();\neditor.EditorMouseRange(coord);\n}\n}\n}\nelse if (mouseinfo.colheader || mouseinfo.colfooter) {\nif (mouseinfo.col != repeatinfo.mouseinfo.col) { // changed col while dragging vertically\ncoord = SocialCalc.crToCoord(mouseinfo.col, editor.ecell.row); // change to it\nif (repeatinfo.repeatcallback) {\nif (mouseinfo.row < repeatinfo.mouseinfo.row) {\ndirection = \"left\";\n}\nelse if (mouseinfo.row > repeatinfo.mouseinfo.row) {\ndirection = \"right\";\n}\nelse {\ndirection = \"\";\n}\nrepeatinfo.repeatcallback(coord, direction);\n}\nelse {\neditor.MoveECell(coord);\neditor.RangeExtend();\neditor.EditorMouseRange(coord);\n}\n}\n}\n}\n\nrepeatinfo.mouseinfo = mouseinfo;\n\nif (mouseinfo.distance < 5) repeatinfo.repeatinterval = 333;\nelse if (mouseinfo.distance < 10) repeatinfo.repeatinterval = 250;\nelse if (mouseinfo.distance < 25) repeatinfo.repeatinterval = 100;\nelse if (mouseinfo.distance < 35) repeatinfo.repeatinterval = 75;\nelse { // too far - stop repeating\nif (repeatinfo.timer) { // if repeating, cancel it\nwindow.clearTimeout(repeatinfo.timer); // cancel timer\nrepeatinfo.timer = null;\n}\nreturn;\n}\n\nif (!repeatinfo.timer) { // start if not already running\nrepeatinfo.timer = window.setTimeout(SocialCalc.DragAutoRepeat, repeatinfo.repeatinterval);\n}\n\nreturn;\n\n}\n\n//\n// DragAutoRepeat()\n//\n\nSocialCalc.DragAutoRepeat = function() {\n\nvar repeatinfo = SocialCalc.AutoRepeatInfo;\nvar mouseinfo = repeatinfo.mouseinfo;\n\nvar direction, coord, cr;\n\nif (mouseinfo.rowheader) direction = \"left\";\nelse if (mouseinfo.rowfooter) direction = \"right\";\nelse if (mouseinfo.colheader) direction = \"up\";\nelse if (mouseinfo.colfooter) direction = \"down\";\n\nif (repeatinfo.repeatcallback) {\ncr = SocialCalc.coordToCr(repeatinfo.editor.ecell.coord);\nif (direction == \"left\" && cr.col > 1) cr.col--;\nelse if (direction == \"right\") cr.col++;\nelse if (direction == \"up\" && cr.row > 1) cr.row--;\nelse if (direction == \"down\") cr.row++;\ncoord = SocialCalc.crToCoord(cr.col, cr.row);\nrepeatinfo.repeatcallback(coord, direction);\n}\nelse {\ncoord = repeatinfo.editor.MoveECellWithKey(\"[a\"+direction+\"]shifted\");\nif (coord) repeatinfo.editor.EditorMouseRange(coord);\n}\n\nrepeatinfo.timer = window.setTimeout(SocialCalc.DragAutoRepeat, repeatinfo.repeatinterval);\n\n}\n\n//\n// Handling Clicking\n//\n\nSocialCalc.ProcessEditorDblClick = function(e) {\n\nvar editor, result, coord, textarea, wval, range;\n\nvar event = e || window.event;\n\nvar viewport = SocialCalc.GetViewportInfo();\nvar clientX = event.clientX + viewport.horizontalScroll;\nvar clientY = event.clientY + viewport.verticalScroll;\n\nvar mouseinfo = SocialCalc.EditorMouseInfo;\nvar ele = event.target || event.srcElement; // source object is often within what we want\nvar mobj;\n\nif (mouseinfo.ignore) return; // ignore this\n\nfor (mobj=null; !mobj && ele; ele=ele.parentNode) { // go up tree looking for one of our elements\nmobj = SocialCalc.LookupElement(ele, mouseinfo.registeredElements);\n}\nif (!mobj) {\nmouseinfo.editor = null;\nreturn; // not one of our elements\n}\n\neditor = mobj.editor;\n\nresult = SocialCalc.GridMousePosition(editor, clientX, clientY);\nif (!result || !result.coord) return; // not within cell area - ignore\n\nmouseinfo.editor = editor; // remember for later\nmouseinfo.element = ele;\nrange = editor.range;\n\nsheetobj = editor.context.sheetobj;\n\nswitch (editor.state) {\ncase \"start\":\nSocialCalc.EditorOpenCellEdit(editor);\nbreak;\n\ncase \"input\":\nbreak;\n\ndefault:\nbreak;\n}\n\nif (event.stopPropagation) event.stopPropagation(); // DOM Level 2\nelse event.cancelBubble = true; // IE 5+\nif (event.preventDefault) event.preventDefault(); // DOM Level 2\nelse event.returnValue = false; // IE 5+\n\nreturn;\n\n}\n\n\nSocialCalc.EditorOpenCellEdit = function(editor) {\n\nvar wval;\n\nif (!editor.ecell) return true; // no ecell\nif (!editor.inputBox) return true; // no input box, so no editing (happens on noEdit)\nif (SocialCalc.Callbacks && SocialCalc.Callbacks.IsCellEditable) {\nif (!SocialCalc.Callbacks.IsCellEditable(editor)) {\nreturn true;\n}\n}\nif (editor.inputBox.element.disabled) return true; // multi-line: ignore\nif (editor.inputBox.element.style.display == 'none') {\nfor (f in editor.StatusCallback) {\neditor.StatusCallback[f].func(editor, \"editecell\", null, editor.StatusCallback[f].params);\n}\nreturn true; // no inputBox display, so no editing\n}\neditor.inputBox.ShowInputBox(true);\neditor.inputBox.Focus();\n\neditor.state = \"inputboxdirect\";\n\neditor.inputBox.SetText(\"\");\neditor.inputBox.DisplayCellContents();\neditor.inputBox.Select(\"end\");\nwval = editor.workingvalues;\nwval.partialexpr = \"\";\nwval.ecoord = editor.ecell.coord;\nwval.erow = editor.ecell.row;\nwval.ecol = editor.ecell.col;\nwval.startsheet = wval.currentsheet;\nwval.startsheetid = wval.currentsheetid;\n\nreturn;\n\n}\n\n\nSocialCalc.EditorProcessKey = function(editor, ch, e) {\n\nvar result, cell, cellobj, valueinfo, fch, coord, inputtext, f;\n\nvar sheetobj = editor.context.sheetobj;\nvar wval = editor.workingvalues;\nvar range = editor.range;\n\nif (typeof ch != \"string\") ch = \"\";\n\nswitch (editor.state) {\ncase \"start\":\nif (e.shiftKey && ch.substr(0,2)==\"[a\") {\nch = ch + \"shifted\";\n}\nif (ch==\"[enter]\") ch = \"[adown]\";\nif (ch==\"[tab]\") ch = e.shiftKey ? \"[aleft]\" : \"[aright]\";\nif (ch.substr(0,2)==\"[a\" || ch.substr(0,3)==\"[pg\" || ch==\"[home]\") {\nresult = editor.MoveECellWithKey(ch);\nreturn !result;\n}\nif (ch==\"[del]\" || ch==\"[backspace]\") {\nif (!editor.noEdit) {\neditor.EditorApplySetCommandsToRange(\"empty\", \"\");\n}\nif (SocialCalc.Callbacks && SocialCalc.Callbacks.IsCellEditable) {\nif (!SocialCalc.Callbacks.IsCellEditable(editor)) {\nreturn true;\n}\n}\n\nbreak;\n}\nif (ch==\"[esc]\") {\nif (range.hasrange) {\neditor.RangeRemove();\neditor.MoveECell(range.anchorcoord);\nfor (f in editor.StatusCallback) {\neditor.StatusCallback[f].func(editor, \"specialkey\", ch, editor.StatusCallback[f].params);\n}\n}\nreturn false;\n}\n\nif (ch==\"[f2]\") {\nif (editor.noEdit) return true;\nSocialCalc.EditorOpenCellEdit(editor);\nreturn false;\n}\n\nif ((ch.length>1 && ch.substr(0,1)==\"[\") || ch.length==0) { // some control key\nif (editor.ctrlkeyFunction && ch.length>0) {\nreturn editor.ctrlkeyFunction(editor, ch);\n}\nelse {\nreturn true;\n}\n}\nif (!editor.ecell) return true; // no ecell\nif (!editor.inputBox) return true; // no inputBox so no editing\nif (editor.inputBox.element.style.display == 'none') {\nfor (f in editor.StatusCallback) {\neditor.StatusCallback[f].func(editor, \"editecell\", ch, editor.StatusCallback[f].params);\n}\nreturn true; // no inputBox display, so no editing\n}\nif (SocialCalc.Callbacks && SocialCalc.Callbacks.IsCellEditable) {\nif (!SocialCalc.Callbacks.IsCellEditable(editor)) {\nreturn true;\n}\n}\n\neditor.inputBox.element.disabled = false; // make sure editable\neditor.state = \"input\";\neditor.inputBox.ShowInputBox(true);\neditor.inputBox.Focus();\neditor.inputBox.SetText(ch);\neditor.inputBox.Select(\"end\");\nwval.partialexpr = \"\";\nwval.ecoord = editor.ecell.coord;\nwval.erow = editor.ecell.row;\nwval.ecol = editor.ecell.col;\nwval.startsheet = wval.currentsheet;\nwval.startsheetid = wval.currentsheetid;\neditor.RangeRemove();\nbreak;\n\ncase \"input\":\ninputtext = editor.inputBox.GetText(); // should not get here if no inputBox\nif (editor.inputBox.skipOne) return false; // ignore a key already handled\nif (ch==\"[esc]\" || ch==\"[enter]\" || ch==\"[tab]\" || (ch && ch.substr(0,2)==\"[a\")) {\nif ((\"(+-*/,:!&<>=^\".indexOf(inputtext.slice(-1))>=0 && inputtext.slice(0,1)==\"=\") ||\n(inputtext == \"=\")) {\nwval.partialexpr = inputtext;\n}\nif (wval.partialexpr) { // if in pointing operation\nif (e.shiftKey && ch.substr(0,2)==\"[a\") {\nch = ch + \"shifted\";\n}\ncoord = editor.MoveECellWithKey(ch);\nif (coord) {\nif (range.hasrange) {\neditor.inputBox.SetText(wval.partialexpr + SocialCalc.crToCoord(range.left, range.top) + \":\" +\n              SocialCalc.crToCoord(range.right, range.bottom));\n}\nelse {\neditor.inputBox.SetText(wval.partialexpr + coord);\n}\nreturn false;\n}\n}\neditor.inputBox.Blur();\neditor.inputBox.ShowInputBox(false);\neditor.state = \"start\";\neditor.cellhandles.ShowCellHandles(true);\nif (ch != \"[esc]\") {\neditor.EditorSaveEdit();\nif (editor.ecell.coord != wval.ecoord) {\neditor.MoveECell(wval.ecoord);\n}\nif (ch==\"[enter]\") ch = \"[adown]\";\nif (ch==\"[tab]\") ch = e.shiftKey ? \"[aleft]\" : \"[aright]\";\nif (ch.substr(0,2)==\"[a\") {\neditor.MoveECellWithKey(ch);\n}\n}\nelse {\neditor.inputBox.DisplayCellContents();\neditor.RangeRemove();\neditor.MoveECell(wval.ecoord);\n}\nbreak;\n}\nif (wval.partialexpr && ch==\"[backspace]\") {\neditor.inputBox.SetText(wval.partialexpr);\nwval.partialexpr = \"\";\neditor.RangeRemove();\neditor.MoveECell(wval.ecoord);\neditor.inputBox.ShowInputBox(true); // make sure it's moved back if necessary\nreturn false;\n}\nif (ch==\"[f2]\") return false;\nif (range.hasrange) {\neditor.RangeRemove();\n}\neditor.MoveECell(wval.ecoord);\nif (wval.partialexpr) {\neditor.inputBox.ShowInputBox(true); // make sure it's moved back if necessary\nwval.partialexpr = \"\"; // not pointing\n}\nreturn true;\n\ncase \"inputboxdirect\":\ninputtext = editor.inputBox.GetText(); // should not get here if no inputBox\nif (ch==\"[esc]\" || ch==\"[enter]\" || ch==\"[tab]\") {\neditor.inputBox.Blur();\neditor.inputBox.ShowInputBox(false);\neditor.state = \"start\";\neditor.cellhandles.ShowCellHandles(true);\nif (ch == \"[esc]\") {\neditor.inputBox.DisplayCellContents();\n}\nelse {\neditor.EditorSaveEdit();\nif (editor.ecell.coord != wval.ecoord) {\neditor.MoveECell(wval.ecoord);\n}\nif (ch==\"[enter]\") ch = \"[adown]\";\nif (ch==\"[tab]\") ch = e.shiftKey ? \"[aleft]\" : \"[aright]\";\nif (ch.substr(0,2)==\"[a\") {\neditor.MoveECellWithKey(ch);\n}\n}\nbreak;\n}\nif (ch==\"[f2]\") return false;\nreturn true;\n\ncase \"skip-and-start\":\neditor.state = \"start\";\neditor.cellhandles.ShowCellHandles(true);\nreturn false;\n\ndefault:\nreturn true;\n}\n\nreturn false;\n\n}\n\nSocialCalc.EditorAddToInput = function(editor, str, prefix) {\n\nvar wval = editor.workingvalues;\n\nif (editor.noEdit) return;\n\nif (SocialCalc.Callbacks && SocialCalc.Callbacks.IsCellEditable) {\nif (!SocialCalc.Callbacks.IsCellEditable(editor)) {\nreturn true;\n}\n}\n\n\nswitch (editor.state) {\ncase \"start\":\neditor.state = \"input\";\neditor.inputBox.ShowInputBox(true);\neditor.inputBox.element.disabled = false; // make sure editable and overwrite old\neditor.inputBox.Focus();\neditor.inputBox.SetText((prefix||\"\")+str);\neditor.inputBox.Select(\"end\");\nwval.partialexpr = \"\";\nwval.ecoord = editor.ecell.coord;\nwval.erow = editor.ecell.row;\nwval.ecol = editor.ecell.col;\nwval.startsheet = wval.currentsheet;\nwval.startsheetid = wval.currentsheetid;\neditor.RangeRemove();\nbreak;\n\ncase \"input\":\ncase \"inputboxdirect\":\neditor.inputBox.element.focus();\nif (wval.partialexpr) {\neditor.inputBox.SetText(wval.partialexpr);\nwval.partialexpr = \"\";\neditor.RangeRemove();\neditor.MoveECell(wval.ecoord);\n}\neditor.inputBox.SetText(editor.inputBox.GetText()+str);\nbreak;\n\ndefault:\nbreak;\n}\n\n}\n\n\nSocialCalc.EditorDisplayCellContents = function(editor) {\n\nif (editor.inputBox) editor.inputBox.DisplayCellContents();\n\n}\nvar arr=[];\nSocialCalc.EditorSaveEdit = function(editor, text) {\n//console.log(\"editorSaveEdit\");\nvar result, cell, valueinfo, fch, type, value, oldvalue, cmdline;\n\nvar sheetobj = editor.context.sheetobj;\nvar wval = editor.workingvalues;\n\nif (SocialCalc.Callbacks && SocialCalc.Callbacks.IsCellEditable) {\nif (!SocialCalc.Callbacks.IsCellEditable(editor)) {\nreturn true;\n}\n}\n\ntype = \"text t\";\n//changes for prompt\n\nvalue = typeof text == \"string\" ? text : editor.inputBox.GetText(); // either explicit or from input box\n\noldvalue = SocialCalc.GetCellContents(sheetobj, wval.ecoord)+\"\";\n//console.log(\"old:\"+oldvalue)\n//console.log(\"new:\"+value)\nif (value == oldvalue) { // no change\nreturn;\n}\nif (\"'\"+value == oldvalue) {\nreturn;\n}\n\n\nfch = value.charAt(0);\nif (fch==\"=\" && value.indexOf(\"\\n\")==-1) {\ntype = \"formula\";\nvalue = value.substring(1);\n}\nelse if (fch==\"'\") {\ntype = \"text t\";\nvalue = value.substring(1);\n}\nelse if (value.length==0) {\ntype = \"empty\";\n}\nelse {\nvalueinfo = SocialCalc.DetermineValueType(value)\nif (valueinfo.type==\"n\" && value==(valueinfo.value+\"\")) { // see if don't need \"constant\"\ntype = \"value n\";\n}\nelse if (valueinfo.type.charAt(0)==\"t\") {\ntype = \"text \"+valueinfo.type;\n}\nelse if (valueinfo.type==\"\") {\ntype = \"text t\";\n}\nelse {\ntype = \"constant \"+valueinfo.type+\" \"+valueinfo.value;\n}\n}\n\nif (type.charAt(0)==\"t\") { // text\nvalue = SocialCalc.encodeForSave(value); // newlines, :, and \\ are escaped\n}\n\n// if startsheet different from currentsheet, switch to start sheet\n// for the save to take effect\nif (SocialCalc.WorkBook && (wval.currentsheet != wval.startsheet)) {\nvar control = SocialCalc.GetCurrentWorkBookControl();\nvar cmdstr = \"activatesheet \" +wval.startsheetid;\ncontrol.ExecuteWorkBookControlCommand( { cmdtype:\"wcmd\", id:\"0\", cmdstr: cmdstr}\n                            ,false)\n}\n\ncmdline = \"set \"+wval.ecoord+\" \"+type+\" \"+value;\neditor.EditorScheduleSheetCommands(cmdline, true, false);\n\nreturn;\n\n}\n\n//\n// SocialCalc.EditorApplySetCommandsToRange(editor, cmd)\n//\n// Takes ecell or range and does a \"set\" command with cmd.\n//\n\nSocialCalc.EditorApplySetCommandsToRange = function(editor, cmd) {\n\nvar cell, row, col, line, errortext;\n\nvar sheetobj = editor.context.sheetobj;\nvar ecell = editor.ecell;\nvar range = editor.range;\n\nif (range.hasrange) {\ncoord = SocialCalc.crToCoord(range.left, range.top)+\":\"+SocialCalc.crToCoord(range.right, range.bottom);\nline = \"set \"+coord+\" \"+cmd;\nerrortext = editor.EditorScheduleSheetCommands(line, true, false);\n}\nelse {\nline = \"set \"+ecell.coord+\" \"+cmd;\nerrortext = editor.EditorScheduleSheetCommands(line, true, false);\n}\n\neditor.DisplayCellContents();\n\n}\n\nSocialCalc.EditorProcessMouseWheel = function(event, delta, mousewheelinfo, wobj) {\n\nif (wobj.functionobj.editor.busy) return; // ignore if busy\n\nif (delta > 0) {\nwobj.functionobj.editor.ScrollRelative(true, -1);\n}\nif (delta < 0) {\nwobj.functionobj.editor.ScrollRelative(true, +1);\n}\n\n}\n\n//\n// GridMousePosition(editor, clientX, clientY)\n//\n// Returns an object with row and col numbers and coord (spans handled for coords),\n// and rowheader/colheader true if in header (where coord will be undefined).\n// If in colheader, will return coltoresize if on appropriate place in col header.\n// Also, there is rowfooter (on right) and colfooter (on bottom).\n// In row/col header/footer, returns \"distance\" as pixels over the edge.\n//\n\nSocialCalc.GridMousePosition = function(editor, clientX, clientY) {\n\nvar row, col, colpane;\nvar result = {};\n\nfor (row=1; row<editor.rowpositions.length; row++) {\nif (!editor.rowheight[row]) continue; // not rendered yet -- may be above or below us\nif (editor.rowpositions[row]+editor.rowheight[row]>clientY) {\nbreak;\n}\n}\nfor (col=1; col<editor.colpositions.length; col++) {\nif (!editor.colwidth[col]) continue;\nif (editor.colpositions[col]+editor.colwidth[col]>clientX) {\nbreak;\n}\n}\n\nresult.row = row;\nresult.col = col;\n\nif (editor.headposition) {\nif (clientX < editor.headposition.left && clientX >= editor.gridposition.left) {\nresult.rowheader = true;\nresult.distance = editor.headposition.left - clientX;\nreturn result;\n}\nelse if (clientY < editor.headposition.top && clientY > editor.gridposition.top) { // > because of sizing row\nresult.colheader = true;\nresult.distance = editor.headposition.top - clientY;\nresult.coltoresize = col-(editor.colpositions[col]+editor.colwidth[col]/2>clientX?1:0) || 1;\nfor (colpane=0; colpane<editor.context.colpanes.length; colpane++) {\nif (result.coltoresize >= editor.context.colpanes[colpane].first &&\nresult.coltoresize <= editor.context.colpanes[colpane].last) { // visible column\nreturn result;\n}\n}\ndelete result.coltoresize;\nreturn result;\n}\nelse if (clientX >= editor.verticaltablecontrol.controlborder) {\nresult.rowfooter = true;\nresult.distance = clientX - editor.verticaltablecontrol.controlborder;\nreturn result;\n}\nelse if (clientY >= editor.horizontaltablecontrol.controlborder) {\nresult.colfooter = true;\nresult.distance = clientY - editor.horizontaltablecontrol.controlborder;\nreturn result;\n}\nelse if (clientX < editor.gridposition.left) {\nresult.rowheader = true;\nresult.distance = editor.headposition.left - clientX;\nreturn result;\n}\nelse if (clientY <= editor.gridposition.top) {\nresult.colheader = true;\nresult.distance = editor.headposition.top - clientY;\nreturn result;\n}\nelse {\nresult.coord = SocialCalc.crToCoord(result.col, result.row);\nif (editor.context.cellskip[result.coord]) { // handle skipped cells\nresult.coord = editor.context.cellskip[result.coord];\n}\nreturn result;\n}\n}\n\nreturn null;\n\n}\n\n//\n// GetEditorCellElement(editor, row, col)\n//\n// Returns an object with element, the table cell element in the DOM that corresponds to row and column,\n// as well as rowpane and colpane, the panes with the cell.\n// If no such element, then returns null;\n//\n\nSocialCalc.GetEditorCellElement = function(editor, row, col) {\n\nvar rowpane, colpane, c, coord;\nvar rowindex = 0;\nvar colindex = 0;\n\nfor (rowpane=0; rowpane<editor.context.rowpanes.length; rowpane++) {\nif (row >= editor.context.rowpanes[rowpane].first && row <= editor.context.rowpanes[rowpane].last) {\nfor (colpane=0; colpane<editor.context.colpanes.length; colpane++) {\nif (col >= editor.context.colpanes[colpane].first && col <= editor.context.colpanes[colpane].last) {\nrowindex += row - editor.context.rowpanes[rowpane].first + 2;\nfor (c=editor.context.colpanes[colpane].first; c<=col; c++) {\ncoord=editor.context.cellskip[SocialCalc.crToCoord(c,row)];\nif (!coord || !editor.context.CoordInPane(coord, rowpane, colpane)) // don't count col-spanned cells\ncolindex++;\n}\nreturn {\nelement: editor.griddiv.firstChild.lastChild.childNodes[rowindex].childNodes[colindex],\nrowpane: rowpane, colpane: colpane};\n}\nfor (c=editor.context.colpanes[colpane].first; c<=editor.context.colpanes[colpane].last; c++) {\ncoord=editor.context.cellskip[SocialCalc.crToCoord(c,row)];\nif (!coord || !editor.context.CoordInPane(coord, rowpane, colpane)) // don't count col-spanned cells\ncolindex++;\n}\ncolindex += 1;\n}\n}\nrowindex += editor.context.rowpanes[rowpane].last - editor.context.rowpanes[rowpane].first + 1 + 1;\n}\n\nreturn null;\n}\n\n//\n// cellcoord = MoveECellWithKey(editor, ch)\n//\n// Processes an arrow key, etc., moving the edit cell.\n// If not a movement key, returns null.\n//\n\nSocialCalc.MoveECellWithKey = function(editor, ch) {\n\nvar coord, row, col, cell;\nvar shifted = false;\n\nif (!editor.ecell) {\nreturn null;\n}\n\nif (ch.slice(-7)==\"shifted\") {\nch = ch.slice(0,-7);\nshifted = true;\n}\n\nrow = editor.ecell.row;\ncol = editor.ecell.col;\ncell = editor.context.sheetobj.cells[editor.ecell.coord];\n\nswitch (ch) {\ncase \"[adown]\":\nrow += (cell && cell.rowspan) || 1;\nbreak;\ncase \"[aup]\":\nrow--;\nbreak;\ncase \"[pgdn]\":\nrow += editor.pageUpDnAmount - 1 + ((cell && cell.rowspan) || 1);\nbreak;\ncase \"[pgup]\":\nrow -= editor.pageUpDnAmount;\nbreak;\ncase \"[aright]\":\ncol += (cell && cell.colspan) || 1;\nbreak;\ncase \"[aleft]\":\ncol--;\nbreak;\ncase \"[home]\":\nrow = 1;\ncol = 1;\nbreak;\ndefault:\nreturn null;\n}\n\nif (!editor.range.hasrange) {\nif (shifted)\neditor.RangeAnchor();\n}\n\ncoord = editor.MoveECell(SocialCalc.crToCoord(col, row));\n\nif (editor.range.hasrange) {\nif (shifted)\neditor.RangeExtend();\nelse\neditor.RangeRemove();\n}\n\nreturn coord;\n\n}\n\n//\n// cellcoord = MoveECell(editor, newecell)\n//\n// Takes a coordinate and returns the new edit cell coordinate (which may be\n// different if newecell is covered by a span).\n//\n\nSocialCalc.MoveECell = function(editor, newcell) {\n\nvar cell, f;\n\nvar highlights = editor.context.highlights;\n\nif (editor.ecell) {\n//changes for prompt\nif (editor.ecell.coord==newcell) return newcell;\n\nif (SocialCalc.Callbacks.broadcast) {\nSocialCalc.Callbacks.broadcast('ecell', { original: editor.ecell.coord, ecell: newcell });\n}\n\ncell=SocialCalc.GetEditorCellElement(editor, editor.ecell.row, editor.ecell.col);\ndelete highlights[editor.ecell.coord];\nif (editor.range2.hasrange &&\neditor.ecell.row>=editor.range2.top && editor.ecell.row<=editor.range2.bottom &&\neditor.ecell.col>=editor.range2.left && editor.ecell.col<=editor.range2.right) {\nhighlights[editor.ecell.coord] = \"range2\";\n}\neditor.UpdateCellCSS(cell, editor.ecell.row, editor.ecell.col);\neditor.SetECellHeaders(\"\"); // set to regular col/rowname styles\neditor.cellhandles.ShowCellHandles(false);\n}\nelse if (SocialCalc.Callbacks.broadcast) {\nSocialCalc.Callbacks.broadcast('ecell', { ecell: newcell });\n}\nnewcell = editor.context.cellskip[newcell] || newcell;\neditor.ecell = SocialCalc.coordToCr(newcell);\neditor.ecell.coord = newcell;\ncell=SocialCalc.GetEditorCellElement(editor, editor.ecell.row, editor.ecell.col);\nhighlights[newcell] = \"cursor\";\n\nfor (f in editor.MoveECellCallback) { // let others know\neditor.MoveECellCallback[f](editor);\n}\n\neditor.UpdateCellCSS(cell, editor.ecell.row, editor.ecell.col);\neditor.SetECellHeaders(\"selected\");\n\nfor (f in editor.StatusCallback) { // let status line, etc., know\neditor.StatusCallback[f].func(editor, \"moveecell\", newcell, editor.StatusCallback[f].params);\n}\n\nif (editor.busy) {\neditor.ensureecell = true; // wait for when not busy\n}\nelse {\neditor.ensureecell = false;\neditor.EnsureECellVisible();\n}\n\nreturn newcell;\n\n}\n\nSocialCalc.EnsureECellVisible = function(editor) {\n\nvar vamount = 0;\nvar hamount = 0;\n\nif (editor.ecell.row > editor.lastnonscrollingrow) {\nif (editor.ecell.row < editor.firstscrollingrow) {\nvamount = editor.ecell.row - editor.firstscrollingrow;\n}\nelse if (editor.ecell.row > editor.lastvisiblerow) {\nvamount = editor.ecell.row - editor.lastvisiblerow;\n}\n}\nif (editor.ecell.col > editor.lastnonscrollingcol) {\nif (editor.ecell.col < editor.firstscrollingcol) {\nhamount = editor.ecell.col - editor.firstscrollingcol;\n}\nelse if (editor.ecell.col > editor.lastvisiblecol) {\nhamount = editor.ecell.col- editor.lastvisiblecol;\n}\n}\n\nif (vamount!=0 || hamount!=0) {\neditor.ScrollRelativeBoth(vamount, hamount);\n}\nelse {\neditor.cellhandles.ShowCellHandles(true);\n}\n\n}\n\nSocialCalc.ReplaceCell = function(editor, cell, row, col) {\n\nvar newelement, a;\nif (!cell) return;\nnewelement = editor.context.RenderCell(row, col, cell.rowpane, cell.colpane, true, null);\nif (newelement) {\n// Don't use a real element and replaceChild, which seems to have focus issues with IE, Firefox, and speed issues\ncell.element.innerHTML = newelement.innerHTML;\ncell.element.style.cssText = \"\";\ncell.element.className = newelement.className;\nfor (a in newelement.style) {\nif (newelement.style[a]!=\"cssText\")\ncell.element.style[a] = newelement.style[a];\n}\n}\n}\n\n\nSocialCalc.UpdateCellCSS = function(editor, cell, row, col) {\n\nvar newelement, a;\nif (!cell) return;\nnewelement = editor.context.RenderCell(row, col, cell.rowpane, cell.colpane, true, null);\nif (newelement) {\ncell.element.style.cssText = \"\";\ncell.element.className = newelement.className;\nfor (a in newelement.style) {\nif (newelement.style[a]!=\"cssText\")\ncell.element.style[a] = newelement.style[a];\n}\n}\n}\n\n\nSocialCalc.SetECellHeaders = function(editor, selected) {\n\nvar ecell = editor.ecell;\nvar context = editor.context;\n\nvar rowpane, colpane, first, last;\nvar rowindex = 0;\nvar colindex = 0;\nvar headercell;\n\nif (!ecell) return;\n\nfor (rowpane=0; rowpane<context.rowpanes.length; rowpane++) {\nfirst = context.rowpanes[rowpane].first;\nlast = context.rowpanes[rowpane].last;\nif (ecell.row >= first && ecell.row <= last) {\nheadercell = editor.fullgrid.childNodes[1].childNodes[2+rowindex+ecell.row-first].childNodes[0];\nif (headercell) {\nif (context.classnames) headercell.className=context.classnames[selected+\"rowname\"];\nif (context.explicitStyles) headercell.style.cssText=context.explicitStyles[selected+\"rowname\"];\nheadercell.style.verticalAlign=\"top\"; // to get around Safari making top of centered row number be\n// considered top of row (and can't get <row> position in Safari)\n}\n}\nrowindex += last - first + 1 + 1;\n}\n\nfor (colpane=0; colpane<context.colpanes.length; colpane++) {\nfirst = context.colpanes[colpane].first;\nlast = context.colpanes[colpane].last;\nif (ecell.col >= first && ecell.col <= last) {\nheadercell = editor.fullgrid.childNodes[1].childNodes[1].childNodes[1+colindex+ecell.col-first];\nif (headercell) {\nif (context.classnames) headercell.className=context.classnames[selected+\"colname\"];\nif (context.explicitStyles) headercell.style.cssText=context.explicitStyles[selected+\"colname\"];\n}\n}\ncolindex += last - first + 1 + 1;\n}\n}\n\n//\n// RangeAnchor(editor, ecoord)\n//\n// Sets the anchor of a range to ecoord (or ecell if missing).\n//\n\nSocialCalc.RangeAnchor = function(editor, ecoord) {\n\nif (editor.range.hasrange) {\neditor.RangeRemove();\n}\n\neditor.RangeExtend(ecoord);\n\n}\n\n//\n// RangeExtend(editor, ecoord)\n//\n// Sets the other corner of the range to ecoord or, if missing, ecell.\n//\n\nSocialCalc.RangeExtend = function(editor, ecoord) {\n\nvar a, cell, cr, coord, row, col, f;\n\nvar highlights = editor.context.highlights;\nvar range = editor.range;\nvar range2 = editor.range2;\n\nvar ecell;\nif (ecoord) {\necell = SocialCalc.coordToCr(ecoord);\necell.coord = ecoord;\n}\nelse ecell = editor.ecell;\n\nif (!ecell) return; // just in case\nif (SocialCalc.Constants.SCNoRanging) return;\n\nif (!range.hasrange) { // called without RangeAnchor...\nrange.anchorcoord = ecell.coord;\nrange.anchorrow = ecell.row;\nrange.top = ecell.row;\nrange.bottom = ecell.row;\nrange.anchorcol = ecell.col;\nrange.left = ecell.col;\nrange.right = ecell.col;\nrange.hasrange = true;\n}\n\nif (range.anchorrow < ecell.row) {\nrange.top = range.anchorrow;\nrange.bottom = ecell.row;\n}\nelse {\nrange.top = ecell.row;\nrange.bottom = range.anchorrow;\n}\nif (range.anchorcol < ecell.col) {\nrange.left = range.anchorcol;\nrange.right = ecell.col;\n}\nelse {\nrange.left = ecell.col;\nrange.right = range.anchorcol;\n}\n\nfor (coord in highlights) {\nswitch (highlights[coord]) {\ncase \"range\":\nhighlights[coord] = \"unrange\";\nbreak;\ncase \"range2\":\nhighlights[coord] = \"unrange2\";\nbreak;\n}\n}\n\nfor (row=range.top; row<=range.bottom; row++) {\nfor (col=range.left; col<=range.right; col++) {\ncoord = SocialCalc.crToCoord(col, row);\nswitch (highlights[coord]) {\ncase \"unrange\":\nhighlights[coord] = \"range\";\nbreak;\ncase \"cursor\":\nbreak;\ncase \"unrange2\":\ndefault:\nhighlights[coord] = \"newrange\";\nbreak;\n}\n}\n}\n\nfor (row=range2.top; range2.hasrange && row<=range2.bottom; row++) {\nfor (col=range2.left; col<=range2.right; col++) {\ncoord = SocialCalc.crToCoord(col, row);\nswitch (highlights[coord]) {\ncase \"unrange2\":\nhighlights[coord] = \"range2\";\nbreak;\ncase \"range\":\ncase \"newrange\":\ncase \"cursor\":\nbreak;\ndefault:\nhighlights[coord] = \"newrange2\";\nbreak;\n}\n}\n}\n\nfor (coord in highlights) {\n\nswitch (highlights[coord]) {\ncase \"unrange\":\ndelete highlights[coord];\nbreak;\ncase \"newrange\":\nhighlights[coord] = \"range\";\nbreak;\ncase \"newrange2\":\nhighlights[coord] = \"range2\";\nbreak;\ncase \"range\":\ncase \"range2\":\ncase \"cursor\":\ncontinue;\n}\n\ncr = SocialCalc.coordToCr(coord);\ncell = SocialCalc.GetEditorCellElement(editor, cr.row, cr.col);\neditor.UpdateCellCSS(cell, cr.row, cr.col);\n\n}\n\nfor (f in editor.RangeChangeCallback) { // let others know\neditor.RangeChangeCallback[f](editor);\n}\n\n// create range/coord string and do status callback\n\ncoord = SocialCalc.crToCoord(editor.range.left, editor.range.top);\nif (editor.range.left!=editor.range.right || editor.range.top!=editor.range.bottom) { // more than one cell\ncoord += \":\" + SocialCalc.crToCoord(editor.range.right, editor.range.bottom);\n}\nfor (f in editor.StatusCallback) {\neditor.StatusCallback[f].func(editor, \"rangechange\", coord, editor.StatusCallback[f].params);\n}\n\nreturn;\n\n}\n\n//\n// RangeRemove(editor)\n//\n// Turns off the range.\n//\n\nSocialCalc.RangeRemove = function(editor) {\n\nvar cell, cr, coord, row, col, f;\n\nvar highlights = editor.context.highlights;\nvar range = editor.range;\nvar range2 = editor.range2;\n\nif (!range.hasrange && !range2.hasrange) return;\n\nfor (row=range2.top; range2.hasrange && row<=range2.bottom; row++) {\nfor (col=range2.left; col<=range2.right; col++) {\ncoord = SocialCalc.crToCoord(col, row);\nswitch (highlights[coord]) {\ncase \"range\":\nhighlights[coord] = \"newrange2\";\nbreak;\ncase \"range2\":\ncase \"cursor\":\nbreak;\ndefault:\nhighlights[coord] = \"newrange2\";\nbreak;\n}\n}\n}\n\nfor (coord in highlights) {\nswitch (highlights[coord]) {\ncase \"range\":\ndelete highlights[coord];\nbreak;\ncase \"newrange2\":\nhighlights[coord] = \"range2\";\nbreak;\ncase \"cursor\":\ncontinue;\n}\ncr = SocialCalc.coordToCr(coord);\ncell=SocialCalc.GetEditorCellElement(editor, cr.row, cr.col);\neditor.UpdateCellCSS(cell, cr.row, cr.col);\n}\n\nrange.hasrange = false;\n\nfor (f in editor.RangeChangeCallback) { // let others know\neditor.RangeChangeCallback[f](editor);\n}\n\nfor (f in editor.StatusCallback) {\neditor.StatusCallback[f].func(editor, \"rangechange\", \"\", editor.StatusCallback[f].params);\n}\n\nreturn;\n\n}\n\n//\n// Range2Remove(editor)\n//\n// Turns off the range2.\n//\n\nSocialCalc.Range2Remove = function(editor) {\n\nvar cell, cr, coord, row, col, f;\n\nvar highlights = editor.context.highlights;\nvar range2 = editor.range2;\n\nif (!range2.hasrange) return;\n\nfor (coord in highlights) {\nswitch (highlights[coord]) {\ncase \"range2\":\ndelete highlights[coord];\nbreak;\ncase \"range\":\ncase \"cursor\":\ncontinue;\n}\ncr = SocialCalc.coordToCr(coord);\ncell=SocialCalc.GetEditorCellElement(editor, cr.row, cr.col);\neditor.UpdateCellCSS(cell, cr.row, cr.col);\n}\n\nrange2.hasrange = false;\n\nreturn;\n\n}\n\n//\n// FitToEditTable(editor)\n//\n// Figure out (through column width declarations and approximation of pixels per row)\n// how many rendered rows and columns you need to be at least a little larger than\n// the editor's editing area.\n//\n\nSocialCalc.FitToEditTable = function(editor) {\n\nvar colnum, colname, colwidth, totalwidth, totalrows, rowpane, needed;\n\nvar context=editor.context;\nvar sheetobj=context.sheetobj;\nvar sheetcolattribs=sheetobj.colattribs;\n\n// Calculate column width data\n\ntotalwidth=context.showRCHeaders ? context.rownamewidth-0 : 0;\nfor (colpane=0; colpane<context.colpanes.length-1; colpane++) { // Get width of all but last pane\nfor (colnum=context.colpanes[colpane].first; colnum<=context.colpanes[colpane].last; colnum++) {\ncolname=SocialCalc.rcColname(colnum);\ncolwidth = sheetobj.colattribs.width[colname] || sheetobj.attribs.defaultcolwidth || SocialCalc.Constants.defaultColWidth;\nif (colwidth==\"blank\" || colwidth==\"auto\") colwidth=\"\";\ntotalwidth+=(colwidth && ((colwidth-0)>0)) ? (colwidth-0) : 10;\n}\n}\n\nfor (colnum=context.colpanes[colpane].first; colnum<=10000; colnum++) { //!!! max for safety, but makes that col max!!!\ncolname=SocialCalc.rcColname(colnum);\ncolwidth = sheetobj.colattribs.width[colname] || sheetobj.attribs.defaultcolwidth || SocialCalc.Constants.defaultColWidth;\nif (colwidth==\"blank\" || colwidth==\"auto\") colwidth=\"\";\ntotalwidth+=(colwidth && ((colwidth-0)>0)) ? (colwidth-0) : 10;\nif (totalwidth > editor.tablewidth) break;\n}\n\ncontext.colpanes[colpane].last = colnum;\n\n// Calculate row height data\n\ntotalrows=context.showRCHeaders ? 1 : 0;\nfor (rowpane=0; rowpane<context.rowpanes.length-1; rowpane++) { // count all panes but last one\ntotalrows += context.rowpanes[rowpane].last - context.rowpanes[rowpane].first + 1;\n}\n\nneeded = editor.tableheight - totalrows * context.pixelsPerRow; // estimate amount needed\n\ncontext.rowpanes[rowpane].last = context.rowpanes[rowpane].first + Math.floor(needed / context.pixelsPerRow) + 1;\n\n}\n\n//\n// CalculateEditorPositions(editor)\n//\n// Calculate the screen positions and other values of various editing elements\n// These values change and need to be recomputed when the pane first/last or cell contents change,\n// as well as new column widths, etc.\n//\n// Note: Only call this after the grid has been rendered! You may have to wait for a timeout...\n//\n\nSocialCalc.CalculateEditorPositions = function(editor) {\n\nvar rowpane, colpane, i;\n\neditor.gridposition = SocialCalc.GetElementPosition(editor.griddiv);\neditor.headposition =\nSocialCalc.GetElementPosition(editor.griddiv.firstChild.lastChild.childNodes[2].childNodes[1]); // 3rd tr 2nd td\n\neditor.rowpositions = [];\nfor (rowpane=0; rowpane<editor.context.rowpanes.length; rowpane++) {\neditor.CalculateRowPositions(rowpane, editor.rowpositions, editor.rowheight);\n}\nfor (i=0; i<editor.rowpositions.length; i++) {\nif (editor.rowpositions[i]>editor.gridposition.top+editor.tableheight) break;\n}\neditor.lastvisiblerow = i-1;\n\neditor.colpositions = [];\nfor (colpane=0; colpane<editor.context.colpanes.length; colpane++) {\neditor.CalculateColPositions(colpane, editor.colpositions, editor.colwidth);\n}\nfor (i=0; i<editor.colpositions.length; i++) {\nif (editor.colpositions[i]>editor.gridposition.left+editor.tablewidth) break;\n}\neditor.lastvisiblecol = i-1;\n\neditor.firstscrollingrow = editor.context.rowpanes[editor.context.rowpanes.length-1].first;\neditor.firstscrollingrowtop = editor.rowpositions[editor.firstscrollingrow] || editor.headposition.top;\neditor.lastnonscrollingrow = editor.context.rowpanes.length-1 > 0 ?\neditor.context.rowpanes[editor.context.rowpanes.length-2].last : 0;\neditor.firstscrollingcol = editor.context.colpanes[editor.context.colpanes.length-1].first;\neditor.firstscrollingcolleft = editor.colpositions[editor.firstscrollingcol] || editor.headposition.left;\neditor.lastnonscrollingcol = editor.context.colpanes.length-1 > 0 ?\neditor.context.colpanes[editor.context.colpanes.length-2].last : 0;\n\n// Now do the table controls\n\neditor.verticaltablecontrol.ComputeTableControlPositions();\neditor.horizontaltablecontrol.ComputeTableControlPositions();\n}\n\n//\n// ScheduleRender(editor)\n//\n// Do a series of timeouts to render the sheet, wait for background layout and\n// rendering by the browser, and then update editor visuals, sliders, etc.\n//\n\nSocialCalc.ScheduleRender = function(editor) {\n\nif (editor.timeout) window.clearTimeout(editor.timeout); // in case called more than once, just use latest\n\nSocialCalc.EditorSheetStatusCallback(null, \"schedrender\", null, editor);\nSocialCalc.EditorStepInfo.editor = editor;\neditor.timeout = window.setTimeout(SocialCalc.DoRenderStep, 1);\n\n}\n\n// DoRenderStep()\n//\n\nSocialCalc.DoRenderStep = function() {\n\nvar editor = SocialCalc.EditorStepInfo.editor;\n\neditor.timeout = null;\n\neditor.EditorRenderSheet();\n\nSocialCalc.EditorSheetStatusCallback(null, \"renderdone\", null, editor);\n\nSocialCalc.EditorSheetStatusCallback(null, \"schedposcalc\", null, editor);\n\neditor.timeout = window.setTimeout(SocialCalc.DoPositionCalculations, 1);\n\n}\n\n//\n// SocialCalc.SchedulePositionCalculations(editor)\n//\n\nSocialCalc.SchedulePositionCalculations = function(editor) {\n\nSocialCalc.EditorStepInfo.editor = editor;\n\nSocialCalc.EditorSheetStatusCallback(null, \"schedposcalc\", null, editor);\n\neditor.timeout = window.setTimeout(SocialCalc.DoPositionCalculations, 1);\n\n}\n\n// DoPositionCalculations(editor)\n//\n// Update editor visuals, sliders, etc.\n//\n// Note: Only call this after the DOM objects have been modified and rendered!\n//\n\nSocialCalc.DoPositionCalculations = function() {\n\nvar editor = SocialCalc.EditorStepInfo.editor;\n\neditor.timeout = null;\n\nvar ok = false;\ntry {\neditor.CalculateEditorPositions();\nok = true;\n} catch (e) {}\n\nif (!ok) {\nif (typeof $ != 'undefined') {\n$(window).trigger('resize');\nsetTimeout( SocialCalc.DoPositionCalculations, 400);\n}\nreturn; /* Workaround IE6 partial-initialized-DOM bug */\n}\n\neditor.verticaltablecontrol.PositionTableControlElements();\neditor.horizontaltablecontrol.PositionTableControlElements();\n\nSocialCalc.EditorSheetStatusCallback(null, \"doneposcalc\", null, editor);\n\nif (editor.ensureecell && editor.ecell && !editor.deferredCommands.length) { // don't do if deferred cmd to execute\neditor.ensureecell = false;\neditor.EnsureECellVisible(); // this could cause another redisplay\n}\n\neditor.cellhandles.ShowCellHandles(true);\n\n\n//!!! Need to now check to see if this positioned controls out of the editing area\n//!!! (such as when there is a large wrapped cell and it pushes the pane boundary too far down).\n\nif (SocialCalc.Callbacks.broadcast) SocialCalc.Callbacks.broadcast('ask.ecell');\n}\n\nSocialCalc.CalculateRowPositions = function(editor, panenum, positions, sizes) {\n\nvar toprow, rowpane, rownum, offset, trowobj, cellposition;\n\nvar context=editor.context;\nvar sheetobj=context.sheetobj;\n\nvar tbodyobj;\n\nif (!context.showRCHeaders) throw(\"Needs showRCHeaders=true\");\n\ntbodyobj=editor.fullgrid.lastChild;\n\n// Calculate start of this pane as row in this table:\n\ntoprow = 2;\nfor (rowpane=0; rowpane<panenum; rowpane++) {\ntoprow += context.rowpanes[rowpane].last - context.rowpanes[rowpane].first + 2; // skip pane and spacing row\n}\n\noffset = 0;\nfor (rownum=context.rowpanes[rowpane].first; rownum<=context.rowpanes[rowpane].last; rownum++) {\ntrowobj = tbodyobj.childNodes[toprow+offset];\noffset++;\ncellposition = SocialCalc.GetElementPosition(trowobj.firstChild);\n\n// Safari has problem: If a cell in the row is high, cell 1 is centered and it returns top of centered part\n// but if you get position of row element, it always returns the same value (not the row's)\n// So we require row number to be vertical aligned to top\n\nif (!positions[rownum]) {\npositions[rownum] = cellposition.top; // first one takes precedence\nsizes[rownum] = trowobj.firstChild.offsetHeight;\n}\n}\n\nreturn;\n\n}\n\nSocialCalc.CalculateColPositions = function(editor, panenum, positions, sizes) {\n\nvar leftcol, colpane, colnum, offset, trowobj, cellposition;\n\nvar context=editor.context;\nvar sheetobj=context.sheetobj;\n\nvar tbodyobj;\n\nif (!context.showRCHeaders) throw(\"Needs showRCHeaders=true\");\n\ntbodyobj=editor.fullgrid.lastChild;\n\n// Calculate start of this pane as column in this table:\n\nleftcol = 1;\nfor (colpane=0; colpane<panenum; colpane++) {\nleftcol += context.colpanes[colpane].last - context.colpanes[colpane].first + 2; // skip pane and spacing col\n}\n\ntrowobj = tbodyobj.childNodes[1]; // get heading row, which has all columns\noffset = 0;\nfor (colnum=context.colpanes[colpane].first; colnum<=context.colpanes[colpane].last; colnum++) {\ncellposition = SocialCalc.GetElementPosition(trowobj.childNodes[leftcol+offset]);\nif (!positions[colnum]) {\npositions[colnum] = cellposition.left; // first one takes precedence\nif (trowobj.childNodes[leftcol+offset]) {\nsizes[colnum] = trowobj.childNodes[leftcol+offset].offsetWidth;\n}\n}\noffset++;\n}\n\nreturn;\n\n}\n\n\n// ScrollRelative(editor, vertical, amount)\n//\n// If vertical true, scrolls up(-)/down(+), else left(-)/right(+)\n\nSocialCalc.ScrollRelative = function(editor, vertical, amount) {\n\nif (vertical) {\neditor.ScrollRelativeBoth(amount, 0);\n}\nelse {\neditor.ScrollRelativeBoth(0, amount);\n}\nreturn;\n\n}\n\n// ScrollRelativeBoth(editor, vamount, hamount)\n//\n// Does both with one render\n\nSocialCalc.ScrollRelativeBoth = function(editor, vamount, hamount) {\n\nvar context=editor.context;\n\nvar vplen=context.rowpanes.length;\nvar vlimit = vplen>1 ? context.rowpanes[vplen-2].last+1 : 1; // don't scroll past here\nif (context.rowpanes[vplen-1].first+vamount < vlimit) { // limit amount\nvamount = (-context.rowpanes[vplen-1].first) + vlimit;\n}\n\nvar hplen=context.colpanes.length;\nvar hlimit = hplen>1 ? context.colpanes[hplen-2].last+1 : 1; // don't scroll past here\n\nif (context.colpanes[hplen-1].first+hamount < hlimit) { // limit amount\nhamount = (-context.colpanes[hplen-1].first) + hlimit;\n}\n\nif (SocialCalc.IsScrollPossible && !SocialCalc.IsScrollPossible(editor.context.sheetobj.attribs.lastrow,                          editor.context.sheetobj.attribs.lastcol,context.rowpanes[vplen-1].first,\n                                                      context.colpanes[hplen-1].first,vamount,hamount)) {\nreturn;\n}\n\nif ((vamount==1 || vamount==-1) && hamount==0) { // special case quick scrolls\nif (vamount==1) {\neditor.ScrollTableUpOneRow();\n}\nelse {\neditor.ScrollTableDownOneRow();\n}\nif (editor.ecell) editor.SetECellHeaders(\"selected\");\neditor.SchedulePositionCalculations();\nreturn;\n}\n\n\n// Do a gross move and render\n\nif (vamount!=0 || hamount!=0) {\ncontext.rowpanes[vplen-1].first += vamount;\ncontext.rowpanes[vplen-1].last += vamount;\ncontext.colpanes[hplen-1].first += hamount;\ncontext.colpanes[hplen-1].last += hamount;\neditor.FitToEditTable();\neditor.ScheduleRender();\n}\n\n}\n\n\n// PageRelative(editor, vertical, direction)\n//\n// If vertical true, pages up(direction is -)/down(+), else left(-)/right(+)\n\nSocialCalc.PageRelative = function(editor, vertical, direction) {\n\nvar context=editor.context;\nvar panes=vertical ? \"rowpanes\" : \"colpanes\";\nvar lastpane=context[panes][context[panes].length-1];\nvar lastvisible=vertical ? \"lastvisiblerow\" : \"lastvisiblecol\";\nvar sizearray=vertical ? editor.rowheight : editor.colwidth;\nvar defaultsize=vertical ? SocialCalc.Constants.defaultAssumedRowHeight : SocialCalc.Constants.defaultColWidth;\nvar size, newfirst, totalsize, current;\n\nif (direction > 0) { // down/right\nnewfirst = editor[lastvisible];\nif (newfirst == lastpane.first) newfirst += 1; // move at least one\n}\nelse {\nif (vertical) { // calculate amount to scroll\ntotalsize = editor.tableheight - (editor.firstscrollingrowtop - editor.gridposition.top);\n}\nelse {\ntotalsize = editor.tablewidth - (editor.firstscrollingcolleft - editor.gridposition.left);\n}\ntotalsize -= sizearray[editor[lastvisible]] > 0 ? sizearray[editor[lastvisible]] : defaultsize;\n\nfor (newfirst=lastpane.first-1; newfirst>0; newfirst--) {\nsize = sizearray[newfirst] > 0 ? sizearray[newfirst] : defaultsize;\nif (totalsize < size) break;\ntotalsize -= size;\n}\n\ncurrent = lastpane.first;\nif (newfirst >= current) newfirst = current-1; // move at least 1\nif (newfirst < 1) newfirst = 1;\n}\n\nlastpane.first = newfirst;\nlastpane.last = newfirst+1;\neditor.LimitLastPanes();\neditor.FitToEditTable();\neditor.ScheduleRender();\n\n}\n\n// LimitLastPanes(editor)\n//\n// Makes sure that the \"first\" of the last panes isn't before the last of the previous pane\n//\n\nSocialCalc.LimitLastPanes = function(editor) {\n\nvar context=editor.context;\nvar plen;\n\nplen = context.rowpanes.length;\nif (plen>1 && context.rowpanes[plen-1].first <= context.rowpanes[plen-2].last)\ncontext.rowpanes[plen-1].first = context.rowpanes[plen-2].last+1;\n\nplen = context.colpanes.length;\nif (plen>1 && context.colpanes[plen-1].first <= context.colpanes[plen-2].last)\ncontext.colpanes[plen-1].first = context.colpanes[plen-2].last+1;\n\n}\n\nSocialCalc.ScrollTableUpOneRow = function(editor) {\n\nvar toprow, rowpane, rownum, colnum, colpane, cell, oldrownum, maxspan, newbottomrow, newrow, oldchild, bottomrownum;\nvar rowneedsrefresh={};\n\nvar context=editor.context;\nvar sheetobj=context.sheetobj;\nvar tableobj=editor.fullgrid;\n\nvar tbodyobj;\n\ntbodyobj=tableobj.lastChild;\n\ntoprow = context.showRCHeaders ? 2 : 1;\nfor (rowpane=0; rowpane<context.rowpanes.length-1; rowpane++) {\ntoprow += context.rowpanes[rowpane].last - context.rowpanes[rowpane].first + 2; // skip pane and spacing row\n}\n\ntbodyobj.removeChild(tbodyobj.childNodes[toprow]);\n\ncontext.rowpanes[rowpane].first++;\ncontext.rowpanes[rowpane].last++;\neditor.FitToEditTable();\ncontext.CalculateColWidthData(); // Just in case, since normally done in RenderSheet\n\nnewbottomrow = context.RenderRow(context.rowpanes[rowpane].last, rowpane);\ntbodyobj.appendChild(newbottomrow);\n\n// if scrolled off a row with starting rowspans, replace rows for the largest rowspan\n\nmaxrowspan = 1;\noldrownum=context.rowpanes[rowpane].first - 1;\n\nfor (colpane=0; colpane<context.colpanes.length; colpane++) {\nfor (colnum=context.colpanes[colpane].first; colnum<=context.colpanes[colpane].last; colnum++) {\ncoord=SocialCalc.crToCoord(colnum, oldrownum);\nif (context.cellskip[coord]) continue;\ncell=sheetobj.cells[coord];\nif (cell && cell.rowspan>maxrowspan) maxrowspan=cell.rowspan;\n}\n}\n\nif (maxrowspan>1) {\nfor (rownum=1; rownum<maxrowspan; rownum++) {\nif (rownum+oldrownum >= context.rowpanes[rowpane].last) break;\nnewrow=context.RenderRow(rownum+oldrownum, rowpane);\noldchild=tbodyobj.childNodes[toprow+rownum-1];\ntbodyobj.replaceChild(newrow,oldchild);\n}\n}\n\n// if added a row that includes rowspans from above, update the size of those to include new row\n\nbottomrownum=context.rowpanes[rowpane].last;\n\nfor (colpane=0; colpane<context.colpanes.length; colpane++) {\nfor (colnum=context.colpanes[colpane].first; colnum<=context.colpanes[colpane].last; colnum++) {\ncoord=context.cellskip[SocialCalc.crToCoord(colnum, bottomrownum)];\nif (!coord) continue; // only look at spanned cells\nrownum=context.coordToCR[coord].row-0;\nif (rownum==context.rowpanes[rowpane].last ||\nrownum<context.rowpanes[rowpane].first) continue; // this row (colspan) or starts above pane\ncell=sheetobj.cells[coord];\nif (cell && cell.rowspan>1) rowneedsrefresh[rownum]=true; // remember row num to update\n}\n}\n\nfor (rownum in rowneedsrefresh) {\nnewrow=context.RenderRow(rownum, rowpane);\noldchild=tbodyobj.childNodes[(toprow+(rownum-context.rowpanes[rowpane].first))];\ntbodyobj.replaceChild(newrow,oldchild);\n}\n\nreturn tableobj;\n}\n\nSocialCalc.ScrollTableDownOneRow = function(editor) {\n\nvar toprow, rowpane, rownum, colnum, colpane, cell, newrownum, maxspan, newbottomrow, newrow, oldchild, bottomrownum;\nvar rowneedsrefresh={};\n\nvar context=editor.context;\nvar sheetobj=context.sheetobj;\nvar tableobj=editor.fullgrid;\n\nvar tbodyobj;\n\ntbodyobj=tableobj.lastChild;\n\ntoprow = context.showRCHeaders ? 2 : 1;\nfor (rowpane=0; rowpane<context.rowpanes.length-1; rowpane++) {\ntoprow += context.rowpanes[rowpane].last - context.rowpanes[rowpane].first + 2; // skip pane and spacing row\n}\n\ntbodyobj.removeChild(tbodyobj.childNodes[toprow+(context.rowpanes[rowpane].last-context.rowpanes[rowpane].first)]);\n\ncontext.rowpanes[rowpane].first--;\ncontext.rowpanes[rowpane].last--;\neditor.FitToEditTable();\ncontext.CalculateColWidthData(); // Just in case, since normally done in RenderSheet\n\nnewrow = context.RenderRow(context.rowpanes[rowpane].first, rowpane);\ntbodyobj.insertBefore(newrow, tbodyobj.childNodes[toprow]);\n\n// if inserted a row with starting rowspans, replace rows for the largest rowspan\n\nmaxrowspan = 1;\nnewrownum=context.rowpanes[rowpane].first;\n\nfor (colpane=0; colpane<context.colpanes.length; colpane++) {\nfor (colnum=context.colpanes[colpane].first; colnum<=context.colpanes[colpane].last; colnum++) {\ncoord=SocialCalc.crToCoord(colnum, newrownum);\nif (context.cellskip[coord]) continue;\ncell=sheetobj.cells[coord];\nif (cell && cell.rowspan>maxrowspan) maxrowspan=cell.rowspan;\n}\n}\n\nif (maxrowspan>1) {\nfor (rownum=1; rownum<maxrowspan; rownum++) {\nif (rownum+newrownum > context.rowpanes[rowpane].last) break;\nnewrow=context.RenderRow(rownum+newrownum, rowpane);\noldchild=tbodyobj.childNodes[toprow+rownum];\ntbodyobj.replaceChild(newrow,oldchild);\n}\n}\n\n// if last row now includes rowspans or rowspans from above, update the size of those to remove deleted row\n\nbottomrownum=context.rowpanes[rowpane].last;\n\nfor (colpane=0; colpane<context.colpanes.length; colpane++) {\nfor (colnum=context.colpanes[colpane].first; colnum<=context.colpanes[colpane].last; colnum++) {\ncoord=SocialCalc.crToCoord(colnum, bottomrownum);\ncell=sheetobj.cells[coord];\nif (cell && cell.rowspan>1) {\nrowneedsrefresh[bottomrownum]=true; // need to update this row\ncontinue;\n}\ncoord=context.cellskip[SocialCalc.crToCoord(colnum, bottomrownum)];\nif (!coord) continue; // only look at spanned cells\nrownum=context.coordToCR[coord].row-0;\nif (rownum==bottomrownum ||\nrownum<context.rowpanes[rowpane].first) continue; // this row (colspan) or starts above pane\ncell=sheetobj.cells[coord];\nif (cell && cell.rowspan>1) rowneedsrefresh[rownum]=true; // remember row num to update\n}\n}\n\nfor (rownum in rowneedsrefresh) {\nnewrow=context.RenderRow(rownum, rowpane);\noldchild=tbodyobj.childNodes[(toprow+(rownum-context.rowpanes[rowpane].first))];\ntbodyobj.replaceChild(newrow,oldchild);\n}\n\nreturn tableobj;\n}\n\n\n// *************************************\n//\n// InputBox class:\n//\n// This class deals with the text box for editing cell contents.\n// It mainly controls a user input box for typed content and is used to interact with\n// the keyboard code, etc.\n//\n// You can use this inside a formula bar control of some sort.\n// You create this after you have created a table editor object (but not necessarily\n// done the CreateTableEditor method).\n//\n// When the user starts typing text, or double-clicks on a cell, this object\n// comes into play.\n//\n// The element given when this is first constructed should be an input HTMLElement or\n// something that acts like one. Check the code here to see what is done to it.\n//\n// *************************************\n\nSocialCalc.InputBox = function(element, editor) {\n\nif (!element) return; // invoked without enough data to work\n\nthis.element = element; // the input element associated with this InputBox\nthis.editor = editor; // the TableEditor this belongs to\nthis.inputEcho = null;\n\neditor.inputBox = this;\n\nelement.onmousedown = SocialCalc.InputBoxOnMouseDown;\n\neditor.MoveECellCallback.formulabar = function(e){\nif (e.state!=\"start\") { return; }// if not in normal keyboard mode don't replace formula bar\neditor.inputBox.DisplayCellContents(e.ecell.coord);\n};\n}\n\n\n// Methods:\n\nSocialCalc.InputBox.prototype.DisplayCellContents = function(coord) {SocialCalc.InputBoxDisplayCellContents(this, coord);};\nSocialCalc.InputBox.prototype.ShowInputBox = function(show) {this.editor.inputEcho.ShowInputEcho(show);};\nSocialCalc.InputBox.prototype.GetText = function() {return this.element.value;};\nSocialCalc.InputBox.prototype.SetText = function(newtext) {\nif (!this.element) return;\nthis.element.value=newtext;\n\nif (!SocialCalc.Constants.SCNoInputEcho) {\nthis.editor.inputEcho.SetText(newtext+\"_\");\n}\n\n};\nSocialCalc.InputBox.prototype.Focus = function() {SocialCalc.InputBoxFocus(this);};\nSocialCalc.InputBox.prototype.Blur = function() {return this.element.blur();};\nSocialCalc.InputBox.prototype.Select = function(t) {\nif (!this.element) return;\nswitch (t) {\ncase \"end\":\nif (document.selection && document.selection.createRange) {\n/* IE 4+ - Safer than setting .selectionEnd as it also works for Textareas. */\nvar range = document.selection.createRange().duplicate();\nrange.moveToElementText(this.element);\nrange.collapse(false);\nrange.select();\n} else if (this.element.selectionStart!=undefined) {\nthis.element.selectionStart=this.element.value.length;\nthis.element.selectionEnd=this.element.value.length;\n}\nbreak;\n}\n};\n\n// Functions:\n\n//\n// SocialCalc.InputBoxDisplayCellContents(inputbox, coord)\n//\n// Sets input box to the contents of the specified cell (or ecell if null).\n//\nvar CoordForColorChange;var editCoord;\nSocialCalc.InputBoxDisplayCellContents = function(inputbox, coord) {\n\nvar scc = SocialCalc.Constants;\n\nif (!inputbox) return;\n\n//changes for prompt\nif (!coord) {\ncoord = inputbox.editor.ecell.coord;\n}\nvar text = SocialCalc.GetCellContents(inputbox.editor.context.sheetobj, coord);\nif (text.indexOf(\"\\n\")!=-1) {\n//text = scc.s_inputboxdisplaymultilinetext;\ntext = scc.s_inputboxdisplaynoteditable;\ninputbox.element.disabled = true;\nSocialCalc.ToggleInputLineButtons(false);\n}\nelse if (!SocialCalc.Callbacks.IsCellEditable(inputbox.editor)) {\ntext = scc.s_inputboxdisplaynoteditable;\nSocialCalc.ToggleInputLineButtons(false);\ninputbox.element.disabled = true;\ninputbox.element.style.display = \"none\";\n\n}\nelse {\nCoordForColorChange=coord;\neditCoord=coord;\n\n//changes for prompt\n\nvar control = SocialCalc.GetCurrentWorkBookControl();\nvar spreadsheet = control.workbook.spreadsheet;\ncell=SocialCalc.GetEditorCellElement(inputbox.editor, inputbox.editor.ecell.row, inputbox.editor.ecell.col);\nvar left = \"100px\";\nvar top = \"100px\";\nvar width = 100;\nif (cell) {\nposition = SocialCalc.GetElementPosition(cell.element);\nleft = (position.left-2)+\"px\";\ntop = (position.top-7)+\"px\";\nwidth = cell.element.offsetWidth;\n}\nif (!cell || width == 0)\n{\n//scrolled off screen\nSocialCalc.ToggleInputLineButtons(false);\ninputbox.element.disabled = true;\ninputbox.element.style.display = \"none\";\n// do nothing\nreturn;\n}\nvar ele = document.getElementById(spreadsheet.formulabarDiv.id);\nif (ele) {\nspreadsheet.spreadsheetDiv.removeChild(spreadsheet.formulabarDiv);\n}\nspreadsheet.formulabarDiv.style.left = left;\nspreadsheet.formulabarDiv.style.top = top;\n//spreadsheet.formulabarDiv.style.width = \"30px\";\n//spreadsheet.formulabarDiv.style.fontSize = \"10px\";\nspreadsheet.formulabarDiv.style.zIndex = 100;\nspreadsheet.formulabarDiv.style.position = \"absolute\";\nvar input = spreadsheet.formulabarDiv.firstChild;\n//changes for prompt\n\ninput.style.fontSize=\"100%\";\n// input.style.backgroundColor = \"#72A4D2\";\n\ninput.style.borderBottomColor = \"#306eff\";\ninput.style.borderBottomLeftRadius = \"3px\";\ninput.style.borderBottomRightRadius = \"3px\";\ninput.style.borderBottomStyle = \"solid\";\ninput.style.borderBottomWidth = \"2px\";\ninput.style.borderLeftColor = \"#306eff\";\ninput.style.borderLeftStyle = \"solid\";\ninput.style.borderLeftWidth = \"2px\";\ninput.style.borderRightColor = \"#306eff\";\ninput.style.borderRightStyle = \"solid\";\ninput.style.borderRightWidth = \"2px\";\ninput.style.borderTopColor = \"#306eff\";\ninput.style.borderTopLeftRadius = \"3px\";\ninput.style.borderTopRightRadius = \"3px\";\ninput.style.borderTopStyle = \"solid\";\ninput.style.borderTopWidth = \"2px\";\n\n\n//console.log(\"cell width =\"+width)\n//changes for prompt\n\ninput.size = \"\"+(width/8);\nspreadsheet.spreadsheetDiv.appendChild(spreadsheet.formulabarDiv);\n\n\ninputbox.element.disabled = false;\ninputbox.element.style.display = \"inline\";\nSocialCalc.ToggleInputLineButtons(true);\n\n}\nif (scc.SCNoQuoteInInputBox && (text.substring(0,1) == \"'\")) {\ntext = text.substring(1);\n}\ninputbox.SetText(text);\n// autoSave(selectedFile);\n}\n\n//\n// SocialCalc.InputBoxFocus(inputbox)\n//\n// Call this to have the input box get the focus and respond to keystrokes\n// but still pass them off to SocialCalc.ProcessKey.\n//\n\nSocialCalc.InputBoxFocus = function(inputbox) {\n\nif (!inputbox) return;\ninputbox.element.focus();\nvar editor = inputbox.editor;\neditor.state = \"input\";\nvar wval = editor.workingvalues;\nwval.partialexpr = \"\";\nwval.ecoord = editor.ecell.coord;\nwval.erow = editor.ecell.row;\nwval.ecol = editor.ecell.col;\n\n\n};\n\n//\n// SocialCalc.InputBoxOnMouseDown(e)\n//\n// This is called when the input box gets the focus. It then responds to keystrokes\n// and pass them off to SocialCalc.ProcessKey, but in a different editing state.\n//\n\nSocialCalc.InputBoxOnMouseDown = function(e) {\n\nvar editor = SocialCalc.Keyboard.focusTable; // get TableEditor doing keyboard stuff\nif (!editor) return true; // we're not handling it -- let browser do default\nvar wval = editor.workingvalues;\n\nswitch (editor.state) {\ncase \"start\":\neditor.state=\"inputboxdirect\";\nwval.partialexpr = \"\";\nwval.ecoord = editor.ecell.coord;\nwval.erow = editor.ecell.row;\nwval.ecol = editor.ecell.col;\neditor.inputEcho.ShowInputEcho(true);\nbreak;\n\ncase \"input\":\nwval.partialexpr = \"\"; // make sure not pointing\neditor.MoveECell(wval.ecoord);\neditor.state=\"inputboxdirect\";\nSocialCalc.KeyboardFocus(); // may have come here from outside of grid\nbreak;\n\ncase \"inputboxdirect\":\nbreak;\n}\n}\n\n\n// *************************************\n//\n// InputEcho class:\n//\n// This object creates and controls an element that echos what's in the InputBox during editing\n// It is draggable.\n//\n// *************************************\n\nSocialCalc.InputEcho = function(editor) {\n\nvar scc = SocialCalc.Constants;\n\nthis.editor = editor; // the TableEditor this belongs to\nthis.text = \"\"; // current value of what is displayed\nthis.interval = null; // timer handle\n\nthis.container = null; // element containing main echo as well as prompt line\nthis.main = null; // main echo area\nthis.prompt = null;\n\nthis.functionbox = null; // function chooser dialog\n\nthis.container = document.createElement(\"div\");\nSocialCalc.setStyles(this.container, \"display:none;position:absolute;zIndex:10;\");\n\nthis.topprompt = document.createElement(\"div\");\nif (scc.defaultInputEchoPromptClass) this.topprompt.className = scc.defaultInputEchoPromptClass;\nif (scc.defaultInputEchoPromptStyle) SocialCalc.setStyles(this.topprompt, scc.defaultInputEchoPromptStyle);\nthis.topprompt.innerHTML = \"\";\n\nthis.container.appendChild(this.topprompt);\n\n\nthis.main = document.createElement(\"div\");\n\nif (scc.defaultInputEchoClass) this.main.className = scc.defaultInputEchoClass;\nif (scc.defaultInputEchoStyle) SocialCalc.setStyles(this.main, scc.defaultInputEchoStyle);\n\nthis.main.innerHTML = \"&nbsp;\";\n\nthis.container.appendChild(this.main);\n\nthis.prompt = document.createElement(\"div\");\nif (scc.defaultInputEchoPromptClass) this.prompt.className = scc.defaultInputEchoPromptClass;\nif (scc.defaultInputEchoPromptStyle) SocialCalc.setStyles(this.prompt, scc.defaultInputEchoPromptStyle);\nthis.prompt.innerHTML = \"\";\n\nthis.container.appendChild(this.prompt);\n\nSocialCalc.DragRegister(this.main, true, true, {MouseDown: SocialCalc.DragFunctionStart, MouseMove: SocialCalc.DragFunctionPosition,\n              MouseUp: SocialCalc.DragFunctionPosition,\n              Disabled: null, positionobj: this.container});\n\neditor.toplevel.appendChild(this.container);\n\n}\n\n// Methods:\n\nSocialCalc.InputEcho.prototype.ShowInputEcho = function(show) {return SocialCalc.ShowInputEcho(this, show);};\nSocialCalc.InputEcho.prototype.SetText = function(str) {return SocialCalc.SetInputEchoText(this, str);};\n\n// Functions:\n\nSocialCalc.ShowInputEcho = function(inputecho, show) {\n\nvar cell, position;\nvar editor = inputecho.editor;\n\nif (!editor) return;\nif (SocialCalc.Constants.SCNoInputEcho) {\nreturn;\n}\n\nif (show) {\neditor.cellhandles.ShowCellHandles(false);\ncell=SocialCalc.GetEditorCellElement(editor, editor.ecell.row, editor.ecell.col);\nif (cell) {\nposition = SocialCalc.GetElementPosition(cell.element);\ninputecho.container.style.left = (position.left-1)+\"px\";\ninputecho.container.style.top = (position.top-1)+\"px\";\n}\ninputecho.container.style.display = \"block\";\nif (inputecho.interval) window.clearInterval(inputecho.interval); // just in case\ninputecho.interval = window.setInterval(SocialCalc.InputEchoHeartbeat, 50);\n\n}\nelse {\nif (inputecho.interval) window.clearInterval(inputecho.interval);\ninputecho.container.style.display = \"none\";\ninputecho.topprompt.innerHTML = \"\";\n\n}\n\n}\n\nSocialCalc.SetInputEchoText = function(inputecho, str) {\n\nif (SocialCalc.Constants.SCNoInputEcho) {\nreturn;\n}\n\nvar scc = SocialCalc.Constants;\nvar fname, fstr;\nvar newstr = SocialCalc.special_chars(str);\nnewstr = newstr.replace(/\\n/g,\"<br>\");\n\nif (inputecho.text != newstr) {\ninputecho.main.innerHTML = newstr;\ninputecho.text = newstr;\n}\n\n                                  \n                                  \n var parts = str.match(/.*[\\+\\-\\*\\/\\&\\^\\<\\>\\=\\,\\(]([A-Za-z][A-ZA-z]\\w*?)\\([^\\)]*$/);\nif (str.charAt(0)==\"=\" && parts) {\nfname = parts[1].toUpperCase();\nif (SocialCalc.Formula.FunctionList[fname]) {\nSocialCalc.Formula.FillFunctionInfo(); //  make sure filled\nfstr = SocialCalc.special_chars(fname+\"(\"+SocialCalc.Formula.FunctionArgString(fname)+\")\");\n}\nelse {\nfstr = scc.ietUnknownFunction+fname;\n}\nif (inputecho.prompt.innerHTML != fstr) {\ninputecho.prompt.innerHTML = fstr;\ninputecho.prompt.style.display = \"block\";\n}\n}\nelse if (inputecho.prompt.style.display != \"none\") {\ninputecho.prompt.innerHTML = \"\";\ninputecho.prompt.style.display = \"none\";\n}\n\nvar editor = inputecho.editor;\n\n\nif (editor.workingvalues.currentsheet !=\neditor.workingvalues.startsheet) {\n\nvar promptstr = \"Editing:\"+editor.workingvalues.startsheet+\"!\"+editor.workingvalues.ecoord;\nif (promptstr != inputecho.topprompt.innerHTML) {\ninputecho.topprompt.innerHTML = \"Editing:\"+editor.workingvalues.startsheet+\"!\"+editor.workingvalues.ecoord;\ninputecho.topprompt.style.display = \"block\";\n}\n} else {\nif (inputecho.topprompt.style.display != \"none\") {\ninputecho.topprompt.innerHTML = \"\";\ninputecho.topprompt.style.display = \"none\";\n}\n}\n}\n\nSocialCalc.InputEchoHeartbeat = function() {\n\nvar editor = SocialCalc.Keyboard.focusTable; // get TableEditor doing keyboard stuff\nif (!editor) return true; // we're not handling it -- let browser do default\n\nif (SocialCalc.Constants.SCNoInputEcho) {\nreturn;\n}\n\nif (editor.state == \"inputboxdirect\") {\neditor.inputEcho.SetText(editor.inputBox.GetText()+\"_\");\n}\n\n}\n\nSocialCalc.InputEchoMouseDown = function(e) {\nvar event = e || window.event;\n\nvar editor = SocialCalc.Keyboard.focusTable; // get TableEditor doing keyboard stuff\nif (!editor) return true; // we're not handling it -- let browser do default\n\nif (SocialCalc.Constants.SCNoInputEcho) {\nreturn;\n}\n\n\n//      if (event.stopPropagation) event.stopPropagation(); // DOM Level 2\n//      else event.cancelBubble = true; // IE 5+\n//      if (event.preventDefault) event.preventDefault(); // DOM Level 2\n//      else event.returnValue = false; // IE 5+\n\neditor.inputBox.element.focus();\n\n//      return false;\n};\n\n\n// *************************************\n//\n// CellHandles class:\n//\n// This object creates and controls the elements around the cursor cell for dragging, etc.\n//\n// *************************************\n\nSocialCalc.CellHandles = function(editor) {\n\nvar scc = SocialCalc.Constants;\nvar functions;\n\nif (editor.noEdit) return; // leave us with nothing\nif (scc.SCCellHandlesDisable) return;\n\nthis.editor = editor; // the TableEditor this belongs to\n\nthis.noCursorSuffix = false;\n\nthis.movedmouse = false; // used to detect no-op\n\nthis.draghandle = document.createElement(\"div\");\nSocialCalc.setStyles(this.draghandle, \"display:none;position:absolute;zIndex:8;border:1px solid white;width:4px;height:4px;fontSize:1px;backgroundColor:#0E93D8;cursor:default;\");\nthis.draghandle.innerHTML = '&nbsp;';\neditor.toplevel.appendChild(this.draghandle);\nSocialCalc.AssignID(editor, this.draghandle, \"draghandle\");\n\nvar imagetype = \"png\";\nif (navigator.userAgent.match(/MSIE 6\\.0/)) {\nimagetype = \"gif\";\n}\n\nthis.dragpalette = document.createElement(\"div\");\nSocialCalc.setStyles(this.dragpalette, \"display:none;position:absolute;zIndex:8;width:90px;height:90px;fontSize:1px;textAlign:center;cursor:default;\"+\n\"backgroundImage:url(\"+SocialCalc.Constants.defaultImagePrefix+\"drag-handles.\"+imagetype+\");\");\nthis.dragpalette.innerHTML = '&nbsp;';\neditor.toplevel.appendChild(this.dragpalette);\nSocialCalc.AssignID(editor, this.dragpalette, \"dragpalette\");\n\nthis.dragtooltip = document.createElement(\"div\");\nSocialCalc.setStyles(this.dragtooltip, \"display:none;position:absolute;zIndex:9;border:1px solid black;width:100px;height:auto;fontSize:10px;backgroundColor:#FFFFFF;\");\nthis.dragtooltip.innerHTML = '&nbsp;';\neditor.toplevel.appendChild(this.dragtooltip);\nSocialCalc.AssignID(editor, this.dragtooltip, \"dragtooltip\");\n\nthis.fillinghandle = document.createElement(\"div\");\nSocialCalc.setStyles(this.fillinghandle, \"display:none;position:absolute;zIndex:9;border:1px solid black;width:auto;height:14px;fontSize:10px;backgroundColor:#FFFFFF;\");\nthis.fillinghandle.innerHTML = '&nbsp;';\neditor.toplevel.appendChild(this.fillinghandle);\nSocialCalc.AssignID(editor, this.fillinghandle, \"fillinghandle\");\n\nif (this.draghandle.addEventListener) { // DOM Level 2 -- Firefox, et al\nthis.draghandle.addEventListener(\"mousemove\", SocialCalc.CellHandlesMouseMoveOnHandle, false);\nthis.dragpalette.addEventListener(\"mousedown\", SocialCalc.CellHandlesMouseDown, false);\nthis.dragpalette.addEventListener(\"mousemove\", SocialCalc.CellHandlesMouseMoveOnHandle, false);\n}\nelse if (this.draghandle.attachEvent) { // IE 5+\nthis.draghandle.attachEvent(\"onmousemove\", SocialCalc.CellHandlesMouseMoveOnHandle);\nthis.dragpalette.attachEvent(\"onmousedown\", SocialCalc.CellHandlesMouseDown);\nthis.dragpalette.attachEvent(\"onmousemove\", SocialCalc.CellHandlesMouseMoveOnHandle);\n}\nelse { // don't handle this\nthrow \"Browser not supported\";\n}\n\n}\n\n// Methods:\n\nSocialCalc.CellHandles.prototype.ShowCellHandles = function(show, moveshow) {return SocialCalc.ShowCellHandles(this, show, moveshow);};\n\n// Functions:\n\nSocialCalc.ShowCellHandles = function(cellhandles, show, moveshow) {\n\nvar cell, cell2, position, position2;\nvar editor = cellhandles.editor;\nvar doshow = false;\nvar row, col, viewport;\n\nif (!editor) return;\n\ndo { // a block that can you can \"break\" out of easily\n\nif (!show) break;\n\nrow = editor.ecell.row;\ncol = editor.ecell.col;\n\nif (editor.state != \"start\") break;\nif (row >= editor.lastvisiblerow) break;\nif (col >= editor.lastvisiblecol) break;\nif (row < editor.firstscrollingrow) break;\nif (col < editor.firstscrollingcol) break;\n\nif (editor.rowpositions[row+1]+20>editor.horizontaltablecontrol.controlborder) {\nbreak;\n}\nif (editor.rowpositions[row+1]-10<editor.headposition.top) {\nbreak;\n}\nif (editor.colpositions[col+1]+20>editor.verticaltablecontrol.controlborder) {\nbreak;\n}\nif (editor.colpositions[col+1]-30<editor.headposition.left) {\nbreak;\n}\n\ncellhandles.draghandle.style.left = (editor.colpositions[col+1]-1)+\"px\";\ncellhandles.draghandle.style.top = (editor.rowpositions[row+1]-1)+\"px\";\ncellhandles.draghandle.style.display = \"block\";\n\nif (moveshow) {\ncellhandles.draghandle.style.display = \"none\";\ncellhandles.dragpalette.style.left = (editor.colpositions[col+1]-45)+\"px\";\ncellhandles.dragpalette.style.top = (editor.rowpositions[row+1]-45)+\"px\";\ncellhandles.dragpalette.style.display = \"block\";\nviewport = SocialCalc.GetViewportInfo();\ncellhandles.dragtooltip.style.right = (viewport.width-(editor.colpositions[col+1]-1))+\"px\";\ncellhandles.dragtooltip.style.bottom = (viewport.height-(editor.rowpositions[row+1]-1))+\"px\";\ncellhandles.dragtooltip.style.display = \"none\";\n}\n\ndoshow = true;\n\n}\nwhile (false); // only do once\n\nif (!doshow) {\ncellhandles.draghandle.style.display = \"none\";\n}\nif (!moveshow) {\ncellhandles.dragpalette.style.display = \"none\";\ncellhandles.dragtooltip.style.display = \"none\";\n}\n\n}\n\nSocialCalc.CellHandlesMouseMoveOnHandle = function(e) {\n\nvar scc = SocialCalc.Constants;\n\nvar event = e || window.event;\nvar target = event.target || event.srcElement\nvar viewport = SocialCalc.GetViewportInfo();\nvar clientX = event.clientX + viewport.horizontalScroll;\nvar clientY = event.clientY + viewport.verticalScroll;\n\neditor = SocialCalc.Keyboard.focusTable; // get TableEditor doing keyboard stuff\nif (!editor) return true; // we're not handling it -- let browser do default\nvar cellhandles = editor.cellhandles;\nif (!cellhandles.editor) return true; // no handles\n\nif (!editor.cellhandles.mouseDown) {\neditor.cellhandles.ShowCellHandles(true, true); // show move handles, too\n\nif (target == cellhandles.dragpalette) {\nvar whichhandle = SocialCalc.SegmentDivHit([scc.CH_radius1, scc.CH_radius2], editor.cellhandles.dragpalette, clientX, clientY);\nif (whichhandle==0) { // off of active part of palette\nSocialCalc.CellHandlesHoverTimeout();\nreturn;\n}\nif (cellhandles.tooltipstimer) {\nwindow.clearTimeout(cellhandles.tooltipstimer);\ncellhandles.tooltipstimer = null;\n}\ncellhandles.tooltipswhichhandle = whichhandle;\ncellhandles.tooltipstimer = window.setTimeout(SocialCalc.CellHandlesTooltipsTimeout, 700);\n}\n\nif (cellhandles.timer) {\nwindow.clearTimeout(cellhandles.timer);\ncellhandles.timer = null;\n}\ncellhandles.timer = window.setTimeout(SocialCalc.CellHandlesHoverTimeout, 3000);\n}\n\nreturn;\n\n}\n\n//\n// whichsegment = SocialCalc.SegmentDivHit(segtable, divWithMouseHit, x, y)\n//\n// Takes segtable = [upperleft quadrant, upperright, bottomright, bottomleft]\n//  where each quadrant is either:\n//      0 = ignore hits here\n//      number = return this value\n//      array = a new segtable for this subquadrant\n//\n// Alternatively, segtable can be:\n//  [radius 1, radius 2] and it returns 0 if no hit,\n//  -1, -2, -3, -4 for inner quadrants, and +1...+4 for outer quadrants\n//\n\nSocialCalc.SegmentDivHit = function(segtable, divWithMouseHit, x, y) {\n\nvar width = divWithMouseHit.offsetWidth;\nvar height = divWithMouseHit.offsetHeight;\nvar left = divWithMouseHit.offsetLeft;\nvar top = divWithMouseHit.offsetTop;\nvar v = 0;\nvar table = segtable;\nvar len = Math.sqrt(Math.pow(x-left-(width/2.0-.5), 2)+Math.pow(y-top-(height/2.0-.5), 2));\n\nif (table.length==2) { // type 2 segtable\nif (x >= left && x < left+width/2 && y >= top && y < top+height/2) { // upper left\nif (len <= segtable[0]) v = -1;\nelse if (len <= segtable[1]) v = 1;\n}\nif (x >= left+width/2 && x < left+width && y >= top && y < top+height/2) { // upper right\nif (len <= segtable[0]) v = -2;\nelse if (len <= segtable[1]) v = 2;\n}\nif (x >= left+width/2 && x < left+width && y >= top+height/2 && y < top+height) { // bottom right\nif (len <= segtable[0]) v = -3;\nelse if (len <= segtable[1]) v = 3;\n}\nif (x >= left && x < left+width/2 && y >= top+height/2 && y < top+height) { // bottom right\nif (len <= segtable[0]) v = -4;\nelse if (len <= segtable[1]) v = 4;\n}\nreturn v;\n}\n\nwhile (true) {\nif (x >= left && x < left+width/2 && y >= top && y < top+height/2) { // upper left\nquadrant += \"1\";\nv = table[0];\nif (typeof v == \"number\") {\nbreak;\n}\ntable = v;\nwidth = width/2;\nheight = height/2;\ncontinue;\n}\nif (x >= left+width/2 && x < left+width && y >= top && y < top+height/2) { // upper right\nquadrant += \"2\";\nv = table[1];\nif (typeof v == \"number\") {\nbreak;\n}\ntable = v;\nwidth = width/2;\nleft = left+width;\nheight = height/2;\ncontinue;\n}\nif (x >= left+width/2 && x < left+width && y >= top+height/2 && y < top+height) { // bottom right\nquadrant += \"3\";\nv = table[2];\nif (typeof v == \"number\") {\nbreak;\n}\ntable = v;\nwidth = width/2;\nleft = left + width;\nheight = height/2;\ntop = top + height;\ncontinue;\n}\nif (x >= left && x < left+width/2 && y >= top+height/2 && y < top+height) { // bottom right\nquadrant += \"4\";\nv = table[3];\nif (typeof v == \"number\") {\nbreak;\n}\ntable = v;\nwidth = width/2;\nheight = height/2;\ntop = top + height;\ncontinue;\n}\nreturn 0; // didn't match\n}\n\n//addmsg((x-divWithMouseHit.offsetLeft)+\",\"+(y-divWithMouseHit.offsetTop)+\"=\"+quadrant+\" \"+v);\nreturn v;\n\n}\n\nSocialCalc.CellHandlesHoverTimeout = function() {\n\neditor = SocialCalc.Keyboard.focusTable; // get TableEditor doing keyboard stuff\nif (!editor) return true; // we're not handling it -- let browser do default\nvar cellhandles = editor.cellhandles;\nif (cellhandles.timer) {\nwindow.clearTimeout(cellhandles.timer);\ncellhandles.timer = null;\n}\nif (cellhandles.tooltipstimer) {\nwindow.clearTimeout(cellhandles.tooltipstimer);\ncellhandles.tooltipstimer = null;\n}\neditor.cellhandles.ShowCellHandles(true, false); // hide move handles\n\n}\n\nSocialCalc.CellHandlesTooltipsTimeout = function() {\n\neditor = SocialCalc.Keyboard.focusTable; // get TableEditor doing keyboard stuff\nif (!editor) return true; // we're not handling it -- let browser do default\nvar cellhandles = editor.cellhandles;\nif (cellhandles.tooltipstimer) {\nwindow.clearTimeout(cellhandles.tooltipstimer);\ncellhandles.tooltipstimer = null;\n}\n\nvar whichhandle = cellhandles.tooltipswhichhandle;\nif (whichhandle==0) { // off of active part of palette\nSocialCalc.CellHandlesHoverTimeout();\nreturn;\n}\nif (whichhandle==-3) {\ncellhandles.dragtooltip.innerHTML = scc.s_CHfillAllTooltip;\n}\nelse if (whichhandle==3) {\ncellhandles.dragtooltip.innerHTML = scc.s_CHfillContentsTooltip;\n}\nelse if (whichhandle==-2) {\ncellhandles.dragtooltip.innerHTML = scc.s_CHmovePasteAllTooltip;\n}\nelse if (whichhandle==-4) {\ncellhandles.dragtooltip.innerHTML = scc.s_CHmoveInsertAllTooltip;\n}\nelse if (whichhandle==2) {\ncellhandles.dragtooltip.innerHTML = scc.s_CHmovePasteContentsTooltip;\n}\nelse if (whichhandle==4) {\ncellhandles.dragtooltip.innerHTML = scc.s_CHmoveInsertContentsTooltip;\n}\nelse {\ncellhandles.dragtooltip.innerHTML = \"&nbsp;\";\ncellhandles.dragtooltip.style.display = \"none\";\nreturn;\n}\n\ncellhandles.dragtooltip.style.display = \"block\";\n\n}\n\nSocialCalc.CellHandlesMouseDown = function(e) {\n\nvar scc = SocialCalc.Constants;\nvar editor, result, coord, textarea, wval, range;\n\nvar event = e || window.event;\n\nvar viewport = SocialCalc.GetViewportInfo();\nvar clientX = event.clientX + viewport.horizontalScroll;\nvar clientY = event.clientY + viewport.verticalScroll;\n\nvar mouseinfo = SocialCalc.EditorMouseInfo;\n\neditor = SocialCalc.Keyboard.focusTable; // get TableEditor doing keyboard stuff\nif (!editor) return true; // we're not handling it -- let browser do default\n\nif (editor.busy) return; // don't do anything when busy (is this correct?)\n\nvar cellhandles = editor.cellhandles;\n\ncellhandles.movedmouse = false; // detect no-op\n\nif (cellhandles.timer) { // cancel timer\nwindow.clearTimeout(cellhandles.timer);\ncellhandles.timer = null;\n}\nif (cellhandles.tooltipstimer) {\nwindow.clearTimeout(cellhandles.tooltipstimer);\ncellhandles.tooltipstimer = null;\n}\ncellhandles.dragtooltip.innerHTML = \"&nbsp;\";\ncellhandles.dragtooltip.style.display = \"none\";\n\nrange = editor.range;\n\nvar whichhandle = SocialCalc.SegmentDivHit([scc.CH_radius1, scc.CH_radius2], editor.cellhandles.dragpalette, clientX, clientY);\nif (whichhandle==1 || whichhandle==-1 || whichhandle==0) {\ncellhandles.ShowCellHandles(true, false); // hide move handles\nreturn;\n}\n\nmouseinfo.ignore = true; // stop other code from looking at the mouse\n\nif (whichhandle==-3) {\ncellhandles.dragtype = \"Fill\";\n//      mouseinfo.element = editor.cellhandles.fillhandle;\ncellhandles.noCursorSuffix = false;\n}\nelse if (whichhandle==3) {\ncellhandles.dragtype = \"FillC\";\n//      mouseinfo.element = editor.cellhandles.fillhandle;\ncellhandles.noCursorSuffix = false;\n}\nelse if (whichhandle==-2) {\ncellhandles.dragtype = \"Move\";\n//      mouseinfo.element = editor.cellhandles.movehandle1;\ncellhandles.noCursorSuffix = true;\n}\nelse if (whichhandle==-4) {\ncellhandles.dragtype = \"MoveI\";\n//      mouseinfo.element = editor.cellhandles.movehandle2;\ncellhandles.noCursorSuffix = false;\n}\nelse if (whichhandle==2) {\ncellhandles.dragtype = \"MoveC\";\n//      mouseinfo.element = editor.cellhandles.movehandle1;\ncellhandles.noCursorSuffix = true;\n}\nelse if (whichhandle==4) {\ncellhandles.dragtype = \"MoveIC\";\n//      mouseinfo.element = editor.cellhandles.movehandle2;\ncellhandles.noCursorSuffix = false;\n}\n\ncellhandles.filltype = null;\n\nswitch (cellhandles.dragtype) {\ncase \"Fill\":\ncase \"FillC\":\nif (!range.hasrange) {\neditor.RangeAnchor();\n}\nbreak;\n\ncase \"Move\":\ncase \"MoveI\":\ncase \"MoveC\":\ncase \"MoveIC\":\nif (!range.hasrange) {\neditor.RangeAnchor();\n}\neditor.range2.top = editor.range.top;\neditor.range2.right = editor.range.right;\neditor.range2.bottom = editor.range.bottom;\neditor.range2.left = editor.range.left;\neditor.range2.hasrange = true;\neditor.RangeRemove();\nbreak;\n\ndefault:\nreturn; // not for us\n}\n\ncellhandles.fillinghandle.style.left = (clientX)+\"px\";\ncellhandles.fillinghandle.style.top = (clientY - 17)+\"px\";\ncellhandles.fillinghandle.innerHTML = scc.s_CHindicatorOperationLookup[cellhandles.dragtype]+\n(scc.s_CHindicatorDirectionLookup[editor.cellhandles.filltype] || \"\");\ncellhandles.fillinghandle.style.display = \"block\";\n\ncellhandles.ShowCellHandles(true, false); // hide move handles\ncellhandles.mouseDown = true;\n\nmouseinfo.editor = editor; // remember for later\n\ncoord = editor.ecell.coord; // start with cell with handles\n\ncellhandles.startingcoord = coord;\ncellhandles.startingX = clientX;\ncellhandles.startingY = clientY;\n\nmouseinfo.mouselastcoord = coord;\n\nSocialCalc.KeyboardSetFocus(editor);\n\nif (document.addEventListener) { // DOM Level 2 -- Firefox, et al\ndocument.addEventListener(\"mousemove\", SocialCalc.CellHandlesMouseMove, true); // capture everywhere\ndocument.addEventListener(\"mouseup\", SocialCalc.CellHandlesMouseUp, true); // capture everywhere\n}\nelse if (cellhandles.draghandle.attachEvent) { // IE 5+\ncellhandles.draghandle.setCapture();\ncellhandles.draghandle.attachEvent(\"onmousemove\", SocialCalc.CellHandlesMouseMove);\ncellhandles.draghandle.attachEvent(\"onmouseup\", SocialCalc.CellHandlesMouseUp);\ncellhandles.draghandle.attachEvent(\"onlosecapture\", SocialCalc.CellHandlesMouseUp);\n}\nif (event.stopPropagation) event.stopPropagation(); // DOM Level 2\nelse event.cancelBubble = true; // IE 5+\nif (event.preventDefault) event.preventDefault(); // DOM Level 2\nelse event.returnValue = false; // IE 5+\n\nreturn;\n\n}\n\nSocialCalc.CellHandlesMouseMove = function(e) {\n\nvar scc = SocialCalc.Constants;\nvar editor, element, result, coord, now, textarea, sheetobj, cellobj, wval;\nvar crstart, crend, cr, c, r;\n\nvar event = e || window.event;\n\nvar viewport = SocialCalc.GetViewportInfo();\nvar clientX = event.clientX + viewport.horizontalScroll;\nvar clientY = event.clientY + viewport.verticalScroll;\n\nvar mouseinfo = SocialCalc.EditorMouseInfo;\neditor = mouseinfo.editor;\nif (!editor) return; // not us, ignore\nvar cellhandles = editor.cellhandles;\n\nelement = mouseinfo.element;\n\nresult = SocialCalc.GridMousePosition(editor, clientX, clientY); // get cell with move\n\nif (!result) return;\n\nif (result && !result.coord) {\nSocialCalc.SetDragAutoRepeat(editor, result, SocialCalc.CellHandlesDragAutoRepeat);\nreturn;\n}\n\nSocialCalc.SetDragAutoRepeat(editor, null); // stop repeating if it was\n\nif (!result.coord) return;\n\ncrstart = SocialCalc.coordToCr(editor.cellhandles.startingcoord);\ncrend = SocialCalc.coordToCr(result.coord);\n\n\ncellhandles.movedmouse = true; // did move, so not no-op\n\nswitch (cellhandles.dragtype) {\ncase \"Fill\":\ncase \"FillC\":\n\nif (result.coord == cellhandles.startingcoord) { // reset when come back\ncellhandles.filltype = null;\ncellhandles.startingX = clientX;\ncellhandles.startingY = clientY;\n}\nelse {\nif (cellhandles.filltype) { // moving and have already determined filltype\nif (cellhandles.filltype==\"Down\") { // coerse to that\ncrend.col = crstart.col;\nif (crend.row < crstart.row) crend.row = crstart.row;\n}\nelse {\ncrend.row = crstart.row;\nif (crend.col < crstart.col) crend.col = crstart.col;\n}\n}\nelse {\nif (Math.abs(clientY - cellhandles.startingY) > 10) {\ncellhandles.filltype = \"Down\";\n}\nelse if (Math.abs(clientX - cellhandles.startingX) > 10) {\ncellhandles.filltype = \"Right\";\n}\ncrend.col = crstart.col; // until decide, leave it at start\ncrend.row = crstart.row;\n}\n}\nresult.coord = SocialCalc.crToCoord(crend.col, crend.row);\nif (result.coord!=mouseinfo.mouselastcoord) {\neditor.MoveECell(result.coord);\neditor.RangeExtend();\n}\nbreak;\n\ncase \"Move\":\ncase \"MoveC\":\nif (result.coord!=mouseinfo.mouselastcoord) {\neditor.MoveECell(result.coord);\nc = editor.range2.right - editor.range2.left + result.col;\nr = editor.range2.bottom - editor.range2.top + result.row;\neditor.RangeAnchor(SocialCalc.crToCoord(c, r));\neditor.RangeExtend();\n}\nbreak;\n\ncase \"MoveI\":\ncase \"MoveIC\":\nif (result.coord == cellhandles.startingcoord) { // reset when come back\ncellhandles.filltype = null;\ncellhandles.startingX = clientX;\ncellhandles.startingY = clientY;\n}\nelse {\nif (cellhandles.filltype) { // moving and have already determined filltype\nif (cellhandles.filltype==\"Vertical\") { // coerse to that\ncrend.col = editor.range2.left;\nif (crend.row>=editor.range2.top && crend.row<=editor.range2.bottom+1) crend.row = editor.range2.bottom+2;\n}\nelse {\ncrend.row = editor.range2.top;\nif (crend.col>=editor.range2.left && crend.col<=editor.range2.right+1) crend.col = editor.range2.right+2;\n}\n}\nelse {\nif (Math.abs(clientY - cellhandles.startingY) > 10) {\ncellhandles.filltype = \"Vertical\";\n}\nelse if (Math.abs(clientX - cellhandles.startingX) > 10) {\ncellhandles.filltype = \"Horizontal\";\n}\ncrend.col = crstart.col; // until decide, leave it at start\ncrend.row = crstart.row;\n}\n}\nresult.coord = SocialCalc.crToCoord(crend.col, crend.row);\nif (result.coord!=mouseinfo.mouselastcoord) {\neditor.MoveECell(result.coord);\nif (!cellhandles.filltype) { // no fill type\neditor.RangeRemove();\n}\nelse {\nc = editor.range2.right - editor.range2.left + crend.col;\nr = editor.range2.bottom - editor.range2.top + crend.row;\neditor.RangeAnchor(SocialCalc.crToCoord(c, r));\neditor.RangeExtend();\n}\n}\nbreak;\n\n}\n\n\ncellhandles.fillinghandle.style.left = (clientX)+\"px\";\ncellhandles.fillinghandle.style.top = (clientY - 17)+\"px\";\ncellhandles.fillinghandle.innerHTML = scc.s_CHindicatorOperationLookup[cellhandles.dragtype]+\n(scc.s_CHindicatorDirectionLookup[editor.cellhandles.filltype] || \"\");\ncellhandles.fillinghandle.style.display = \"block\";\n\nmouseinfo.mouselastcoord = result.coord;\n\nif (event.stopPropagation) event.stopPropagation(); // DOM Level 2\nelse event.cancelBubble = true; // IE 5+\nif (event.preventDefault) event.preventDefault(); // DOM Level 2\nelse event.returnValue = false; // IE 5+\n\nreturn;\n\n}\n\nSocialCalc.CellHandlesDragAutoRepeat = function(coord, direction) {\n\nvar mouseinfo = SocialCalc.EditorMouseInfo;\nvar editor = mouseinfo.editor;\nif (!editor) return; // not us, ignore\nvar cellhandles = editor.cellhandles;\n\nvar crstart = SocialCalc.coordToCr(editor.cellhandles.startingcoord);\nvar crend = SocialCalc.coordToCr(coord);\n\nvar newcoord, c, r;\n\nvar vscroll = 0;\nvar hscroll = 0;\n\nif (direction == \"left\") hscroll = -1;\nelse if (direction == \"right\") hscroll = 1;\nelse if (direction == \"up\") vscroll = -1;\nelse if (direction == \"down\") vscroll = 1;\neditor.ScrollRelativeBoth(vscroll, hscroll);\n\n\nswitch (cellhandles.dragtype) {\ncase \"Fill\":\ncase \"FillC\":\nif (cellhandles.filltype) { // moving and have already determined filltype\nif (cellhandles.filltype==\"Down\") { // coerse to that\ncrend.col = crstart.col;\nif (crend.row < crstart.row) crend.row = crstart.row;\n}\nelse {\ncrend.row = crstart.row;\nif (crend.col < crstart.col) crend.col = crstart.col;\n}\n}\nelse {\ncrend.col = crstart.col; // until decide, leave it at start\ncrend.row = crstart.row;\n}\n\nnewcoord = SocialCalc.crToCoord(crend.col, crend.row);\nif (newcoord!=mouseinfo.mouselastcoord) {\neditor.MoveECell(coord);\neditor.RangeExtend();\n}\nbreak;\n\ncase \"Move\":\ncase \"MoveC\":\nif (coord!=mouseinfo.mouselastcoord) {\neditor.MoveECell(coord);\nc = editor.range2.right - editor.range2.left + editor.ecell.col;\nr = editor.range2.bottom - editor.range2.top + editor.ecell.row;\neditor.RangeAnchor(SocialCalc.crToCoord(c, r));\neditor.RangeExtend();\n}\nbreak;\n\ncase \"MoveI\":\ncase \"MoveIC\":\nif (cellhandles.filltype) { // moving and have already determined filltype\nif (cellhandles.filltype==\"Vertical\") { // coerse to that\ncrend.col = editor.range2.left;\nif (crend.row>=editor.range2.top && crend.row<=editor.range2.bottom+1) crend.row = editor.range2.bottom+2;\n}\nelse {\ncrend.row = editor.range2.top;\nif (crend.col>=editor.range2.left && crend.col<=editor.range2.right+1) crend.col = editor.range2.right+2;\n}\n}\nelse {\ncrend.col = crstart.col; // until decide, leave it at start\ncrend.row = crstart.row;\n}\n\nnewcoord = SocialCalc.crToCoord(crend.col, crend.row);\nif (newcoord!=mouseinfo.mouselastcoord) {\neditor.MoveECell(newcoord);\nc = editor.range2.right - editor.range2.left + crend.col;\nr = editor.range2.bottom - editor.range2.top + crend.row;\neditor.RangeAnchor(SocialCalc.crToCoord(c, r));\neditor.RangeExtend();\n}\nbreak;\n\n}\n\nmouseinfo.mouselastcoord = newcoord;\n\n}\n\nSocialCalc.CellHandlesMouseUp = function(e) {\n\nvar editor, element, result, coord, now, textarea, sheetobj, cellobj, wval, cstr, cmdtype, cmdtype2;\nvar crstart, crend;\nvar sizec, sizer, deltac, deltar;\n\nvar event = e || window.event;\n\nvar viewport = SocialCalc.GetViewportInfo();\nvar clientX = event.clientX + viewport.horizontalScroll;\nvar clientY = event.clientY + viewport.verticalScroll;\n\nvar mouseinfo = SocialCalc.EditorMouseInfo;\neditor = mouseinfo.editor;\nif (!editor) return; // not us, ignore\nvar cellhandles = editor.cellhandles;\n\nelement = mouseinfo.element;\n\nmouseinfo.ignore = false;\n\nresult = SocialCalc.GridMousePosition(editor, clientX, clientY); // get cell with up\n\nSocialCalc.SetDragAutoRepeat(editor, null); // stop repeating if it was\n\ncellhandles.mouseDown = false;\ncellhandles.noCursorSuffix = false;\n\ncellhandles.fillinghandle.style.display = \"none\";\n\nif (!result) result = {};\nif (!result.coord) result.coord = editor.ecell.coord;\n\nswitch (cellhandles.dragtype) {\ncase \"Fill\":\ncase \"Move\":\ncase \"MoveI\":\ncmdtype2 = \" all\";\nbreak;\ncase \"FillC\":\ncase \"MoveC\":\ncase \"MoveIC\":\ncmdtype2 = \" formulas\";\nbreak;\n}\n\nif (!cellhandles.movedmouse) { // didn't move: just leave one cell selected\ncellhandles.dragtype = \"Nothing\";\n}\n\nswitch (cellhandles.dragtype) {\ncase \"Nothing\":\neditor.Range2Remove();\neditor.RangeRemove();\nbreak;\n\ncase \"Fill\":\ncase \"FillC\":\n\ncrstart = SocialCalc.coordToCr(cellhandles.startingcoord);\ncrend = SocialCalc.coordToCr(result.coord);\nif (cellhandles.filltype) {\nif (cellhandles.filltype==\"Down\") {\ncrend.col = crstart.col;\n}\nelse {\ncrend.row = crstart.row;\n}\n}\nresult.coord = SocialCalc.crToCoord(crend.col, crend.row);\n\neditor.MoveECell(result.coord);\neditor.RangeExtend();\n\nif (editor.cellhandles.filltype==\"Right\") {\ncmdtype = \"right\";\n}\nelse {\ncmdtype = \"down\";\n}\ncstr = \"fill\"+cmdtype+\" \"+SocialCalc.crToCoord(editor.range.left, editor.range.top)+\n\":\"+SocialCalc.crToCoord(editor.range.right, editor.range.bottom)+cmdtype2;\neditor.EditorScheduleSheetCommands(cstr, true, false);\nbreak;\n\ncase \"Move\":\ncase \"MoveC\":\neditor.context.cursorsuffix = \"\";\ncstr = \"movepaste \"+\nSocialCalc.crToCoord(editor.range2.left, editor.range2.top) + \":\" +\nSocialCalc.crToCoord(editor.range2.right, editor.range2.bottom)\n+\" \"+editor.ecell.coord+cmdtype2;\neditor.EditorScheduleSheetCommands(cstr, true, false);\neditor.Range2Remove();\n\nbreak;\n\ncase \"MoveI\":\ncase \"MoveIC\":\neditor.context.cursorsuffix = \"\";\nsizec = editor.range2.right - editor.range2.left;\nsizer = editor.range2.bottom - editor.range2.top;\ndeltac = editor.ecell.col - editor.range2.left;\ndeltar = editor.ecell.row - editor.range2.top;\ncstr = \"moveinsert \"+\nSocialCalc.crToCoord(editor.range2.left, editor.range2.top) + \":\" +\nSocialCalc.crToCoord(editor.range2.right, editor.range2.bottom)\n+\" \"+editor.ecell.coord+cmdtype2;\neditor.EditorScheduleSheetCommands(cstr, true, false);\neditor.Range2Remove();\neditor.RangeRemove();\nif (editor.cellhandles.filltype==\" Horizontal\" && deltac > 0) {\neditor.MoveECell(SocialCalc.crToCoord(editor.ecell.col-sizec-1, editor.ecell.row));\n}\nelse if (editor.cellhandles.filltype==\" Vertical\" && deltar > 0) {\neditor.MoveECell(SocialCalc.crToCoord(editor.ecell.col, editor.ecell.row-sizer-1));\n}\neditor.RangeAnchor(SocialCalc.crToCoord(editor.ecell.col+sizec, editor.ecell.row+sizer));\neditor.RangeExtend();\n\nbreak;\n\n}\n\nif (event.stopPropagation) event.stopPropagation(); // DOM Level 2\nelse event.cancelBubble = true; // IE 5+\nif (event.preventDefault) event.preventDefault(); // DOM Level 2\nelse event.returnValue = false; // IE 5+\n\nif (document.removeEventListener) { // DOM Level 2\ndocument.removeEventListener(\"mousemove\", SocialCalc.CellHandlesMouseMove, true);\ndocument.removeEventListener(\"mouseup\", SocialCalc.CellHandlesMouseUp, true);\n}\nelse if (cellhandles.draghandle.detachEvent) { // IE\ncellhandles.draghandle.detachEvent(\"onlosecapture\", SocialCalc.CellHandlesMouseUp);\ncellhandles.draghandle.detachEvent(\"onmouseup\", SocialCalc.CellHandlesMouseUp);\ncellhandles.draghandle.detachEvent(\"onmousemove\", SocialCalc.CellHandlesMouseMove);\ncellhandles.draghandle.releaseCapture();\n}\n\nmouseinfo.editor = null;\n\nreturn false;\n\n}\n\n// *************************************\n//\n// TableControl class:\n//\n// This class deals with the horizontal and verical scrollbars and pane sliders.\n//\n// +--------------+\n// | Endcap       |\n// +- - - - - - - +\n// |              |\n// +--------------+\n// | Pane Slider  |\n// +--------------+\n// |              |\n// | Less Button  |\n// |              |\n// +--------------+\n// | Scroll Area  |\n// |              |\n// |              |\n// +--------------+\n// | Thumb        |\n// +--------------+\n// |              |\n// +--------------+\n// |              |\n// | More Button  |\n// |              |\n// +--------------+\n//\n// *************************************\n\nSocialCalc.TableControl = function(editor, vertical, size) {\n\nvar scc = SocialCalc.Constants;\n\nthis.editor = editor; // the TableEditor this belongs to\n\nthis.vertical = vertical; // true if vertical control, false if horizontal\nthis.size = size; // length in pixels\n\nthis.main = null; // main element containing all the others\nthis.endcap = null; // the area at the top/left between the end and the pane slider\nthis.paneslider = null; // the slider to adjust the pane split\nthis.lessbutton = null; // the top/left scroll button\nthis.morebutton = null; // the bottom/right scroll button\nthis.scrollarea = null; // the area between the scroll buttons\nthis.thumb = null; // the sliding thing in the scrollarea\n\n// computed position values:\n\nthis.controlborder = null; // left or top screen position for vertical or horizontal control\nthis.endcapstart = null; // top or left screen position for vertical or horizontal control\nthis.panesliderstart = null;\nthis.lessbuttonstart = null;\nthis.morebuttonstart = null;\nthis.scrollareastart = null;\nthis.scrollareaend = null;\nthis.scrollareasize = null;\nthis.thumbpos = null;\n\n// constants:\n\nthis.controlthickness = scc.defaultTableControlThickness; // other dimension of complete control in pixels\nthis.sliderthickness = scc.defaultTCSliderThickness;\nthis.buttonthickness = scc.defaultTCButtonThickness;\nthis.thumbthickness = scc.defaultTCThumbThickness;\nthis.minscrollingpanesize = this.buttonthickness+this.buttonthickness+this.thumbthickness+20; // the 20 is to leave a little space\n\n}\n\n// Methods:\n\nSocialCalc.TableControl.prototype.CreateTableControl = function() {return SocialCalc.CreateTableControl(this);};\nSocialCalc.TableControl.prototype.PositionTableControlElements = function() {SocialCalc.PositionTableControlElements(this);};\nSocialCalc.TableControl.prototype.ComputeTableControlPositions = function() {SocialCalc.ComputeTableControlPositions(this);};\n\n// Functions:\n\nSocialCalc.CreateTableControl = function(control) {\n\nvar s, functions, params;\nvar AssignID = SocialCalc.AssignID;\nvar setStyles = SocialCalc.setStyles;\nvar scc = SocialCalc.Constants;\nvar TooltipRegister = function(element, etype, vh) {\nif (scc[\"s_\"+etype+\"Tooltip\"+vh]) {\nSocialCalc.TooltipRegister(element, scc[\"s_\"+etype+\"Tooltip\"+vh], null);\n}\n}\n\nvar imageprefix = control.editor.imageprefix;\nvar vh = control.vertical ? \"v\" : \"h\";\n\ncontrol.main = document.createElement(\"div\");\ns = control.main.style;\ns.height = (control.vertical ? control.size : control.controlthickness)+\"px\";\ns.width = (control.vertical ? control.controlthickness : control.size)+\"px\";\ns.zIndex = 0;\nsetStyles(control.main, scc.TCmainStyle);\ns.backgroundImage=\"url(\"+imageprefix+\"main-\"+vh+\".gif)\";\nif (scc.TCmainClass) control.main.className = scc.TCmainClass;\n\ncontrol.main.style.display=\"none\"; // wait for layout\n\ncontrol.endcap = document.createElement(\"div\");\ns = control.endcap.style;\ns.height = control.controlthickness+\"px\";\ns.width = control.controlthickness+\"px\";\ns.zIndex = 1;\ns.overflow = \"hidden\"; // IE will make the DIV at least font-size height...so use this\ns.position = \"absolute\";\nsetStyles(control.endcap, scc.TCendcapStyle);\ns.backgroundImage=\"url(\"+imageprefix+\"endcap-\"+vh+\".gif)\";\nif (scc.TCendcapClass) control.endcap.className = scc.TCendcapClass;\nAssignID(control.editor, control.endcap, \"endcap\"+vh);\n\ncontrol.main.appendChild(control.endcap);\n\ncontrol.paneslider = document.createElement(\"div\");\ns = control.paneslider.style;\ns.height = (control.vertical ? control.sliderthickness : control.controlthickness)+\"px\";\ns.overflow = \"hidden\"; // IE will make the DIV at least font-size height...so use this\ns.width = (control.vertical ? control.controlthickness : control.sliderthickness)+\"px\";\ns.position = \"absolute\";\ns[control.vertical?\"top\":\"left\"] = \"4px\";\ns.zIndex = 3;\nsetStyles(control.paneslider, scc.TCpanesliderStyle);\ns.backgroundImage=\"url(\"+imageprefix+\"paneslider-\"+vh+\".gif)\";\nif (scc.TCpanesliderClass) control.paneslider.className = scc.TCpanesliderClass;\nAssignID(control.editor, control.paneslider, \"paneslider\"+vh);\nTooltipRegister(control.paneslider, \"paneslider\", vh);\n\nfunctions = {MouseDown:SocialCalc.TCPSDragFunctionStart,\nMouseMove: SocialCalc.TCPSDragFunctionMove,\nMouseUp: SocialCalc.TCPSDragFunctionStop,\nDisabled: function() {return control.editor.busy;}};\n\nfunctions.control = control; // make sure this is there\n\nSocialCalc.DragRegister(control.paneslider, control.vertical, !control.vertical, functions);\n\ncontrol.main.appendChild(control.paneslider);\n\ncontrol.lessbutton = document.createElement(\"div\");\ns = control.lessbutton.style;\ns.height = (control.vertical ? control.buttonthickness : control.controlthickness)+\"px\";\ns.width = (control.vertical ? control.controlthickness : control.buttonthickness)+\"px\";\ns.zIndex = 2;\ns.overflow = \"hidden\"; // IE will make the DIV at least font-size height...so use this\ns.position = \"absolute\";\nsetStyles(control.lessbutton, scc.TClessbuttonStyle);\ns.backgroundImage=\"url(\"+imageprefix+\"less-\"+vh+\"n.gif)\"\nif (scc.TClessbuttonClass) control.lessbutton.className = scc.TClessbuttonClass;\nAssignID(control.editor, control.lessbutton, \"lessbutton\"+vh);\n\nparams = {repeatwait:scc.TClessbuttonRepeatWait, repeatinterval:scc.TClessbuttonRepeatInterval,\nnormalstyle: \"backgroundImage:url(\"+imageprefix+\"less-\"+vh+\"n.gif);\",\ndownstyle: \"backgroundImage:url(\"+imageprefix+\"less-\"+vh+\"d.gif);\",\nhoverstyle: \"backgroundImage:url(\"+imageprefix+\"less-\"+vh+\"h.gif);\"};\nfunctions = {MouseDown:function(){if(!control.editor.busy) control.editor.ScrollRelative(control.vertical, -1);},\nRepeat:function(){if(!control.editor.busy) control.editor.ScrollRelative(control.vertical, -1);},\nDisabled: function() {return control.editor.busy;}};\n\nSocialCalc.ButtonRegister(control.lessbutton, params, functions);\n\ncontrol.main.appendChild(control.lessbutton);\n\ncontrol.morebutton = document.createElement(\"div\");\ns = control.morebutton.style;\ns.height = (control.vertical ? control.buttonthickness : control.controlthickness)+\"px\";\ns.width = (control.vertical ? control.controlthickness : control.buttonthickness)+\"px\";\ns.zIndex = 2;\ns.overflow = \"hidden\"; // IE will make the DIV at least font-size height...so use this\ns.position = \"absolute\";\nsetStyles(control.morebutton, scc.TCmorebuttonStyle);\ns.backgroundImage=\"url(\"+imageprefix+\"more-\"+vh+\"n.gif)\"\nif (scc.TCmorebuttonClass) control.morebutton.className = scc.TCmorebuttonClass;\nAssignID(control.editor, control.morebutton, \"morebutton\"+vh);\n\nparams = {repeatwait:scc.TCmorebuttonRepeatWait, repeatinterval:scc.TCmorebuttonRepeatInterval,\nnormalstyle: \"backgroundImage:url(\"+imageprefix+\"more-\"+vh+\"n.gif);\",\ndownstyle: \"backgroundImage:url(\"+imageprefix+\"more-\"+vh+\"d.gif);\",\nhoverstyle: \"backgroundImage:url(\"+imageprefix+\"more-\"+vh+\"h.gif);\"};\nfunctions = {MouseDown:function(){if(!control.editor.busy) control.editor.ScrollRelative(control.vertical, +1);},\nRepeat:function(){if(!control.editor.busy) control.editor.ScrollRelative(control.vertical, +1);},\nDisabled: function() {return control.editor.busy;}};\n\nSocialCalc.ButtonRegister(control.morebutton, params, functions);\n\ncontrol.main.appendChild(control.morebutton);\n\ncontrol.scrollarea = document.createElement(\"div\");\ns = control.scrollarea.style;\ns.height = control.controlthickness+\"px\";\ns.width = control.controlthickness+\"px\";\ns.zIndex = 1;\ns.overflow = \"hidden\"; // IE will make the DIV at least font-size height...so use this\ns.position = \"absolute\";\nsetStyles(control.scrollarea, scc.TCscrollareaStyle);\ns.backgroundImage=\"url(\"+imageprefix+\"scrollarea-\"+vh+\".gif)\";\nif (scc.TCscrollareaClass) control.scrollarea.className = scc.TCscrollareaClass;\nAssignID(control.editor, control.scrollarea, \"scrollarea\"+vh);\n\nparams = {repeatwait:scc.TCscrollareaRepeatWait, repeatinterval:scc.TCscrollareaRepeatWait};\nfunctions = {MouseDown:SocialCalc.ScrollAreaClick, Repeat:SocialCalc.ScrollAreaClick,\nDisabled: function() {return control.editor.busy;}};\nfunctions.control = control;\n\nSocialCalc.ButtonRegister(control.scrollarea, params, functions);\n\ncontrol.main.appendChild(control.scrollarea);\n\ncontrol.thumb = document.createElement(\"div\");\ns = control.thumb.style;\ns.height =  (control.vertical ? control.thumbthickness : control.controlthickness)+\"px\";\ns.width = (control.vertical ? control.controlthickness : control.thumbthickness)+\"px\";\ns.zIndex = 2;\ns.overflow = \"hidden\"; // IE will make the DIV at least font-size height...so use this\ns.position = \"absolute\";\nsetStyles(control.thumb, scc.TCthumbStyle);\ncontrol.thumb.style.backgroundImage=\"url(\"+imageprefix+\"thumb-\"+vh+\"n.gif)\";\nif (scc.TCthumbClass) control.thumb.className = scc.TCthumbClass;\nAssignID(control.editor, control.thumb, \"thumb\"+vh);\n\nfunctions = {MouseDown:SocialCalc.TCTDragFunctionStart,\nMouseMove: SocialCalc.TCTDragFunctionMove,\nMouseUp: SocialCalc.TCTDragFunctionStop,\nDisabled: function() {return control.editor.busy;}};\nfunctions.control = control; // make sure this is there\nSocialCalc.DragRegister(control.thumb, control.vertical, !control.vertical, functions);\n\nparams = {normalstyle: \"backgroundImage:url(\"+imageprefix+\"thumb-\"+vh+\"n.gif)\", name:\"Thumb\",\ndownstyle:  \"backgroundImage:url(\"+imageprefix+\"thumb-\"+vh+\"d.gif)\",\nhoverstyle:  \"backgroundImage:url(\"+imageprefix+\"thumb-\"+vh+\"h.gif)\"};\nSocialCalc.ButtonRegister(control.thumb, params, null); // give it button-like visual behavior\n\ncontrol.main.appendChild(control.thumb);\n\nreturn control.main;\n\n}\n\n//\n// ScrollAreaClick - Button function to process pageup/down clicks\n//\n\nSocialCalc.ScrollAreaClick = function(e, buttoninfo, bobj) {\n\nvar control = bobj.functionobj.control;\nvar bposition = SocialCalc.GetElementPosition(bobj.element);\nvar clickpos = control.vertical ? buttoninfo.clientY : buttoninfo.clientX;\nif (control.editor.busy) { // ignore if busy - wait for next repeat\nreturn;\n}\ncontrol.editor.PageRelative(control.vertical, clickpos > control.thumbpos ? 1 : -1);\n\nreturn;\n\n}\n\n//\n// PositionTableControlElements\n//\n\nSocialCalc.PositionTableControlElements = function(control) {\n\nvar border, realend, thumbpos;\n\nvar editor = control.editor;\n\nif (control.vertical) {\nborder = control.controlborder+\"px\";\ncontrol.endcap.style.top = control.endcapstart+\"px\";\ncontrol.endcap.style.left = border;\ncontrol.paneslider.style.top = control.panesliderstart+\"px\";\ncontrol.paneslider.style.left = border\ncontrol.lessbutton.style.top = control.lessbuttonstart+\"px\";\ncontrol.lessbutton.style.left = border;\ncontrol.morebutton.style.top = control.morebuttonstart+\"px\";\ncontrol.morebutton.style.left = border;\ncontrol.scrollarea.style.top = control.scrollareastart+\"px\";\ncontrol.scrollarea.style.left = border;\ncontrol.scrollarea.style.height = control.scrollareasize+\"px\";\nrealend = Math.max(editor.context.sheetobj.attribs.lastrow, editor.firstscrollingrow+1);\nthumbpos = ((editor.firstscrollingrow-(editor.lastnonscrollingrow+1))*(control.scrollareasize-3*control.thumbthickness))/\n(realend-(editor.lastnonscrollingrow+1))+control.scrollareastart-1;\nthumbpos = Math.floor(thumbpos);\ncontrol.thumb.style.top = thumbpos+\"px\";\ncontrol.thumb.style.left = border;\n}\nelse {\nborder = control.controlborder+\"px\";\ncontrol.endcap.style.left = control.endcapstart+\"px\";\ncontrol.endcap.style.top = border;\ncontrol.paneslider.style.left = control.panesliderstart+\"px\";\ncontrol.paneslider.style.top = border\ncontrol.lessbutton.style.left = control.lessbuttonstart+\"px\";\ncontrol.lessbutton.style.top = border;\ncontrol.morebutton.style.left = control.morebuttonstart+\"px\";\ncontrol.morebutton.style.top = border;\ncontrol.scrollarea.style.left = control.scrollareastart+\"px\";\ncontrol.scrollarea.style.top = border;\ncontrol.scrollarea.style.width = control.scrollareasize+\"px\";\nrealend = Math.max(editor.context.sheetobj.attribs.lastcol, editor.firstscrollingcol+1);\nthumbpos = ((editor.firstscrollingcol-(editor.lastnonscrollingcol+1))*(control.scrollareasize-control.thumbthickness))/\n(realend-editor.lastnonscrollingcol)+control.scrollareastart-1;\nthumbpos = Math.floor(thumbpos);\ncontrol.thumb.style.left = thumbpos+\"px\";\ncontrol.thumb.style.top = border;\n}\ncontrol.thumbpos = thumbpos;\ncontrol.main.style.display=\"block\";\n\n}\n\n//\n// ComputeTableControlPositions\n//\n// This routine computes the screen positions and other values needed for laying out\n// the table control elements.\n//\n\nSocialCalc.ComputeTableControlPositions = function(control) {\n\nvar editor = control.editor;\n\nif (!editor.gridposition || !editor.headposition) throw(\"Can't compute table control positions before editor positions\");\n\nif (control.vertical) {\ncontrol.controlborder = editor.gridposition.left+editor.tablewidth; // border=left position\ncontrol.endcapstart = editor.gridposition.top; // start=top position\ncontrol.panesliderstart = editor.firstscrollingrowtop-control.sliderthickness;\ncontrol.lessbuttonstart = editor.firstscrollingrowtop-1;\ncontrol.morebuttonstart = editor.gridposition.top+editor.tableheight-control.buttonthickness;\ncontrol.scrollareastart = editor.firstscrollingrowtop-1+control.buttonthickness;\ncontrol.scrollareaend = control.morebuttonstart-1;\ncontrol.scrollareasize = control.scrollareaend-control.scrollareastart+1;\n}\nelse {\ncontrol.controlborder = editor.gridposition.top+editor.tableheight; // border=top position\ncontrol.endcapstart = editor.gridposition.left; // start=left position\ncontrol.panesliderstart = editor.firstscrollingcolleft-control.sliderthickness;\ncontrol.lessbuttonstart = editor.firstscrollingcolleft-1;\ncontrol.morebuttonstart = editor.gridposition.left+editor.tablewidth-control.buttonthickness;\ncontrol.scrollareastart = editor.firstscrollingcolleft-1+control.buttonthickness;\ncontrol.scrollareaend = control.morebuttonstart-1;\ncontrol.scrollareasize = control.scrollareaend-control.scrollareastart+1;\n}\n}\n\n////// TCPS - TableControl Pan Slider methods\n\n//\n// TCPSDragFunctionStart(event, draginfo, dobj)\n//\n// TableControlPaneSlider function for starting drag\n//\n\nSocialCalc.TCPSDragFunctionStart = function(event, draginfo, dobj) {\n\nvar editor = dobj.functionobj.control.editor;\nvar scc = SocialCalc.Constants;\n\nSocialCalc.DragFunctionStart(event, draginfo, dobj);\n\ndraginfo.trackingline = document.createElement(\"div\");\ndraginfo.trackingline.style.height = dobj.vertical ? scc.TCPStrackinglineThickness :\n(editor.tableheight-(editor.headposition.top-editor.gridposition.top))+\"px\";\ndraginfo.trackingline.style.width = dobj.vertical ? \n(editor.tablewidth-(editor.headposition.left-editor.gridposition.left))+\"px\" : scc.TCPStrackinglineThickness;\ndraginfo.trackingline.style.backgroundImage=\"url(\"+editor.imageprefix+\"trackingline-\"+(dobj.vertical?\"v\":\"h\")+\".gif)\";;\nif (scc.TCPStrackinglineClass) draginfo.trackingline.className = scc.TCPStrackinglineClass;\nSocialCalc.setStyles(draginfo.trackingline, scc.TCPStrackinglineStyle);\n\nif (dobj.vertical) {\nrow = SocialCalc.Lookup(draginfo.clientY+dobj.functionobj.control.sliderthickness, editor.rowpositions);\ndraginfo.trackingline.style.top = (editor.rowpositions[row] || editor.headposition.top)+\"px\";\ndraginfo.trackingline.style.left = editor.headposition.left+\"px\";\nif (editor.context.rowpanes.length-1) { // has 2 already\neditor.context.SetRowPaneFirstLast(1, editor.context.rowpanes[0].last+1, editor.context.rowpanes[0].last+1);\neditor.FitToEditTable();\neditor.ScheduleRender();\n}\n}\nelse {\ncol = SocialCalc.Lookup(draginfo.clientX+dobj.functionobj.control.sliderthickness, editor.colpositions);\ndraginfo.trackingline.style.top = editor.headposition.top+\"px\";\ndraginfo.trackingline.style.left = (editor.colpositions[col] || editor.headposition.left)+\"px\";\nif (editor.context.colpanes.length-1) { // has 2 already\neditor.context.SetColPaneFirstLast(1, editor.context.colpanes[0].last+1, editor.context.colpanes[0].last+1);\neditor.FitToEditTable();\neditor.ScheduleRender();\n}\n}\n\neditor.griddiv.appendChild(draginfo.trackingline);\n\n}\n\n//\n// TCPSDragFunctionMove(event, draginfo, dobj)\n//\n\nSocialCalc.TCPSDragFunctionMove = function(event, draginfo, dobj) {\n\nvar row, col, max, min;\nvar control = dobj.functionobj.control;\nvar sliderthickness = control.sliderthickness;\nvar editor = control.editor;\n\nif (dobj.vertical) {\nmax = control.morebuttonstart - control.minscrollingpanesize - draginfo.offsetY; // restrict movement\nif (draginfo.clientY > max) draginfo.clientY = max;\nmin = editor.headposition.top - sliderthickness - draginfo.offsetY;\nif (draginfo.clientY < min) draginfo.clientY = min;\n\nrow = SocialCalc.Lookup(draginfo.clientY+sliderthickness, editor.rowpositions);\ndraginfo.trackingline.style.top = (editor.rowpositions[row] || editor.headposition.top)+\"px\";\n}\nelse {\nmax = control.morebuttonstart - control.minscrollingpanesize - draginfo.offsetX;\nif (draginfo.clientX > max) draginfo.clientX = max;\nmin = editor.headposition.left - sliderthickness - draginfo.offsetX;\nif (draginfo.clientX < min) draginfo.clientX = min;\n\ncol = SocialCalc.Lookup(draginfo.clientX+sliderthickness, editor.colpositions);\ndraginfo.trackingline.style.left = (editor.colpositions[col] || editor.headposition.left)+\"px\";\n}\n\nSocialCalc.DragFunctionPosition(event, draginfo, dobj);\n\n}\n\n//\n// TCPSDragFunctionStop(event, draginfo, dobj)\n//\n\nSocialCalc.TCPSDragFunctionStop = function(event, draginfo, dobj) {\n\nvar row, col, max, min;\nvar control = dobj.functionobj.control;\nvar sliderthickness = control.sliderthickness;\nvar editor = control.editor;\n\nif (dobj.vertical) {\nmax = control.morebuttonstart - control.minscrollingpanesize - draginfo.offsetY; // restrict movement\nif (draginfo.clientY > max) draginfo.clientY = max;\nmin = editor.headposition.top - sliderthickness - draginfo.offsetY;\nif (draginfo.clientY < min) draginfo.clientY = min;\n\nrow = SocialCalc.Lookup(draginfo.clientY+sliderthickness, editor.rowpositions);\nif (row>editor.context.sheetobj.attribs.lastrow) row=editor.context.sheetobj.attribs.lastrow; // can't extend sheet here\nif (!row || row<=editor.context.rowpanes[0].first) { // set to no panes, leaving first pane settings\nif (editor.context.rowpanes.length>1) editor.context.rowpanes.length = 1;\n}\nelse if (editor.context.rowpanes.length-1) { // has 2 already\nif (!editor.timeout) { // not waiting for position calc (so positions could be wrong)\neditor.context.SetRowPaneFirstLast(0, editor.context.rowpanes[0].first, row-1);\neditor.context.SetRowPaneFirstLast(1, row, row);\n}\n}\nelse {\neditor.context.SetRowPaneFirstLast(0, editor.context.rowpanes[0].first, row-1);\neditor.context.SetRowPaneFirstLast(1, row, row);\n}\n}\nelse {\nmax = control.morebuttonstart - control.minscrollingpanesize - draginfo.offsetX;\nif (draginfo.clientX > max) draginfo.clientX = max;\nmin = editor.headposition.left - sliderthickness - draginfo.offsetX;\nif (draginfo.clientX < min) draginfo.clientX = min;\n\ncol = SocialCalc.Lookup(draginfo.clientX+sliderthickness, editor.colpositions);\nif (col>editor.context.sheetobj.attribs.lastcol) col=editor.context.sheetobj.attribs.lastcol; // can't extend sheet here\nif (!col || col<=editor.context.colpanes[0].first) { // set to no panes, leaving first pane settings\nif (editor.context.colpanes.length>1) editor.context.colpanes.length = 1;\n}\nelse if (editor.context.colpanes.length-1) { // has 2 already\nif (!editor.timeout) { // not waiting for position calc (so positions could be wrong)\neditor.context.SetColPaneFirstLast(0, editor.context.colpanes[0].first, col-1);\neditor.context.SetColPaneFirstLast(1, col, col);\n}\n}\nelse {\neditor.context.SetColPaneFirstLast(0, editor.context.colpanes[0].first, col-1);\neditor.context.SetColPaneFirstLast(1, col, col);\n}\n}\n\neditor.FitToEditTable();\n\neditor.griddiv.removeChild(draginfo.trackingline);\n\neditor.ScheduleRender();\n\n}\n\n////// TCT - TableControl Thumb methods\n\n//!!!! Note: Need to make start use same code as move/stop for determining row/col, since stop will set that\n//!!!! Note: Need to make start/move/stop use positioning code that corresponds closer to\n//!!!!       ComputeTableControlPositions calculations.\n\n//\n// TCTDragFunctionStart(event, draginfo, dobj)\n//\n// TableControlThumb function for starting drag\n//\n\nSocialCalc.TCTDragFunctionStart = function(event, draginfo, dobj) {\n\nvar rowpane, colpane, row, col;\n\nvar control = dobj.functionobj.control;\nvar editor = control.editor;\nvar scc = SocialCalc.Constants;\n\nSocialCalc.DragFunctionStart(event, draginfo, dobj);\n\nif (draginfo.thumbstatus) { // get rid of old one if mouseup was out of window\nif (draginfo.thumbstatus.rowmsgele) draginfo.thumbstatus.rowmsgele = null;\nif (draginfo.thumbstatus.rowpreviewele) draginfo.thumbstatus.rowpreviewele = null;\neditor.toplevel.removeChild(draginfo.thumbstatus);\ndraginfo.thumbstatus = null;\n}\n\ndraginfo.thumbstatus = document.createElement(\"div\");\n\nif (dobj.vertical) {\nif (scc.TCTDFSthumbstatusvClass) draginfo.thumbstatus.className = scc.TCTDFSthumbstatusvClass;\nSocialCalc.setStyles(draginfo.thumbstatus, scc.TCTDFSthumbstatusvStyle);\ndraginfo.thumbstatus.style.top = (draginfo.clientY+scc.TCTDFStopOffsetv)+\"px\";\ndraginfo.thumbstatus.style.left = (control.controlborder-10-(editor.tablewidth/2))+\"px\";\ndraginfo.thumbstatus.style.width = (editor.tablewidth/2)+\"px\";\n\ndraginfo.thumbcontext = new SocialCalc.RenderContext(editor.context.sheetobj);\ndraginfo.thumbcontext.showGrid = true;\ndraginfo.thumbcontext.rowpanes = [{first: 1, last: 1}];\nvar pane = editor.context.colpanes[editor.context.colpanes.length-1];\ndraginfo.thumbcontext.colpanes = [{first: pane.first, last: pane.last}];\ndraginfo.thumbstatus.innerHTML = '<table cellspacing=\"0\" cellpadding=\"0\"><tr><td valign=\"top\" style=\"'+\nscc.TCTDFSthumbstatusrownumStyle+'\" class=\"'+scc.TCTDFSthumbstatusrownumClass+\n'\"><div>msg</div></td><td valign=\"top\"><div style=\"overflow:hidden;\">preview</div></td></tr></table>';\ndraginfo.thumbstatus.rowmsgele = draginfo.thumbstatus.firstChild.firstChild.firstChild.firstChild.firstChild;\ndraginfo.thumbstatus.rowpreviewele = draginfo.thumbstatus.firstChild.firstChild.firstChild.childNodes[1].firstChild;\neditor.toplevel.appendChild(draginfo.thumbstatus);\nSocialCalc.TCTDragFunctionRowSetStatus(draginfo, editor, editor.firstscrollingrow || 1);\n}\nelse {\nif (scc.TCTDFSthumbstatushClass) draginfo.thumbstatus.className = scc.TCTDFSthumbstatushClass;\nSocialCalc.setStyles(draginfo.thumbstatus, scc.TCTDFSthumbstatushStyle);\ndraginfo.thumbstatus.style.top = (control.controlborder+scc.TCTDFStopOffseth)+\"px\";\ndraginfo.thumbstatus.style.left = (draginfo.clientX+scc.TCTDFSleftOffseth)+\"px\";\neditor.toplevel.appendChild(draginfo.thumbstatus);\ndraginfo.thumbstatus.innerHTML = scc.s_TCTDFthumbstatusPrefixh+SocialCalc.rcColname(editor.firstscrollingcol);\n}\n\n}\n\n\n//\n// SocialCalc.TCTDragFunctionRowSetStatus(draginfo, editor, row)\n//\n// Render partial row\n//\n\nSocialCalc.TCTDragFunctionRowSetStatus = function(draginfo, editor, row) {\n\nvar scc = SocialCalc.Constants;\nvar msg = scc.s_TCTDFthumbstatusPrefixv+row+\" \";\n\ndraginfo.thumbstatus.rowmsgele.innerHTML = msg;\n\ndraginfo.thumbcontext.rowpanes = [{first: row, last: row}];\ndraginfo.thumbrowshown = row;\n\nvar ele = draginfo.thumbcontext.RenderSheet(draginfo.thumbstatus.rowpreviewele.firstChild, {type: \"html\"});\n\n}\n\n\n//\n// TCTDragFunctionMove(event, draginfo, dobj)\n//\n\nSocialCalc.TCTDragFunctionMove = function(event, draginfo, dobj) {\n\nvar first, msg;\nvar control = dobj.functionobj.control;\nvar thumbthickness = control.thumbthickness;\nvar editor = control.editor;\nvar scc = SocialCalc.Constants;\n\nif (dobj.vertical) {\nif (draginfo.clientY > control.scrollareaend - draginfo.offsetY - control.thumbthickness + 2)\ndraginfo.clientY = control.scrollareaend - draginfo.offsetY - control.thumbthickness + 2;\nif (draginfo.clientY < control.scrollareastart - draginfo.offsetY - 1)\ndraginfo.clientY = control.scrollareastart - draginfo.offsetY - 1;\ndraginfo.thumbstatus.style.top = draginfo.clientY+\"px\";\n\nfirst =\n((draginfo.clientY+draginfo.offsetY-control.scrollareastart+1)/(control.scrollareasize-control.thumbthickness))\n* (editor.context.sheetobj.attribs.lastrow-editor.lastnonscrollingrow)\n+ editor.lastnonscrollingrow + 1;\nfirst = Math.floor(first);\nif (first <= editor.lastnonscrollingrow) first = editor.lastnonscrollingrow + 1;\nif (first > editor.context.sheetobj.attribs.lastrow) first = editor.context.sheetobj.attribs.lastrow;\n//      msg = scc.s_TCTDFthumbstatusPrefixv+first;\nif (first != draginfo.thumbrowshown) {\nSocialCalc.TCTDragFunctionRowSetStatus(draginfo, editor, first);\n}\n}\nelse {\nif (draginfo.clientX > control.scrollareaend - draginfo.offsetX - control.thumbthickness + 2)\ndraginfo.clientX = control.scrollareaend - draginfo.offsetX - control.thumbthickness + 2;\nif (draginfo.clientX < control.scrollareastart - draginfo.offsetX - 1)\ndraginfo.clientX = control.scrollareastart - draginfo.offsetX - 1;\ndraginfo.thumbstatus.style.left = draginfo.clientX+\"px\";\n\nfirst =\n((draginfo.clientX+draginfo.offsetX-control.scrollareastart+1)/(control.scrollareasize-control.thumbthickness))\n* (editor.context.sheetobj.attribs.lastcol-editor.lastnonscrollingcol)\n+ editor.lastnonscrollingcol + 1;\nfirst = Math.floor(first);\nif (first <= editor.lastnonscrollingcol) first = editor.lastnonscrollingcol + 1;\nif (first > editor.context.sheetobj.attribs.lastcol) first = editor.context.sheetobj.attribs.lastcol;\nmsg = scc.s_TCTDFthumbstatusPrefixh+SocialCalc.rcColname(first);\ndraginfo.thumbstatus.innerHTML = msg;\n}\n\nSocialCalc.DragFunctionPosition(event, draginfo, dobj);\n\n}\n\n//\n// TCTDragFunctionStop(event, draginfo, dobj)\n//\n\nSocialCalc.TCTDragFunctionStop = function(event, draginfo, dobj) {\n\nvar first;\nvar control = dobj.functionobj.control;\nvar editor = control.editor;\n\nif (dobj.vertical) {\nfirst =\n((draginfo.clientY+draginfo.offsetY-control.scrollareastart+1)/(control.scrollareasize-control.thumbthickness))\n* (editor.context.sheetobj.attribs.lastrow-editor.lastnonscrollingrow)\n+ editor.lastnonscrollingrow + 1;\nfirst = Math.floor(first);\nif (first <= editor.lastnonscrollingrow) first = editor.lastnonscrollingrow + 1;\nif (first > editor.context.sheetobj.attribs.lastrow) first = editor.context.sheetobj.attribs.lastrow;\n\neditor.context.SetRowPaneFirstLast(editor.context.rowpanes.length-1, first, first+1);\n}\nelse {\nfirst =\n((draginfo.clientX+draginfo.offsetX-control.scrollareastart+1)/(control.scrollareasize-control.thumbthickness))\n* (editor.context.sheetobj.attribs.lastcol-editor.lastnonscrollingcol)\n+ editor.lastnonscrollingcol + 1;\nfirst = Math.floor(first);\nif (first <= editor.lastnonscrollingcol) first = editor.lastnonscrollingcol + 1;\nif (first > editor.context.sheetobj.attribs.lastcol) first = editor.context.sheetobj.attribs.lastcol;\n\neditor.context.SetColPaneFirstLast(editor.context.colpanes.length-1, first, first+1);\n}\n\neditor.FitToEditTable();\n\nif (draginfo.thumbstatus.rowmsgele) draginfo.thumbstatus.rowmsgele = null;\nif (draginfo.thumbstatus.rowpreviewele) draginfo.thumbstatus.rowpreviewele = null;\neditor.toplevel.removeChild(draginfo.thumbstatus);\ndraginfo.thumbstatus = null;\n\neditor.ScheduleRender();\n\n}\n\n// *************************************\n//\n// Dragging functions:\n//\n// *************************************\n\nSocialCalc.DragInfo = {\n\n// There is only one of these -- no \"new\" is done.\n// Only one dragging operation can be active at a time.\n// The registeredElements array is used to decide which item to drag.\n\n// One item for each draggable thing, each an object with:\n//    .element, .vertical, .horizontal, .functionobj\n\nregisteredElements: [],\n\n// Items used during a drag\n\ndraggingElement: null, // item being processed (.element is the actual element)\nstartX: 0,\nstartY: 0,\nstartZ: 0,\nclientX: 0, // modifyable version to restrict movement\nclientY: 0,\noffsetX: 0,\noffsetY: 0,\nhorizontalScroll: 0, // retrieved at drag start\nverticalScroll: 0\n\n}\n\n//\n// DragRegister(element, vertical, horizontal, functionobj) - make element draggable\n//\n// The functionobj defaults to moving the element contrained only by vertical and horizontal settings.\n//\n\nSocialCalc.DragRegister = function(element, vertical, horizontal, functionobj) {\n\nvar draginfo = SocialCalc.DragInfo;\n\nif (!functionobj) {\nfunctionobj = {MouseDown: SocialCalc.DragFunctionStart, MouseMove: SocialCalc.DragFunctionPosition,\nMouseUp: SocialCalc.DragFunctionPosition,\nDisabled: null};\n}\n\ndraginfo.registeredElements.push(\n{element: element, vertical: vertical, horizontal: horizontal, functionobj: functionobj}\n);\n\nif (element.addEventListener) { // DOM Level 2 -- Firefox, et al\nelement.addEventListener(\"mousedown\", SocialCalc.DragMouseDown, false);\n}\nelse if (element.attachEvent) { // IE 5+\nelement.attachEvent(\"onmousedown\", SocialCalc.DragMouseDown);\n}\nelse { // don't handle this\nthrow SocialCalc.Constants.s_BrowserNotSupported;\n}\n\n}\n\n//\n// DragUnregister(element) - remove object from list\n//\n\nSocialCalc.DragUnregister = function(element) {\n\nvar draginfo = SocialCalc.DragInfo;\n\nvar i;\n\nif (!element) return;\n\nfor (i=0; i<draginfo.registeredElements.length; i++) {\nif (draginfo.registeredElements[i].element == element) {\ndraginfo.registeredElements.splice(i,1);\nif (element.removeEventListener) { // DOM Level 2 -- Firefox, et al\nelement.removeEventListener(\"mousedown\", SocialCalc.DragMouseDown, false);\n}\nelse { // IE 5+\nelement.detachEvent(\"onmousedown\", SocialCalc.DragMouseDown);\n}\nreturn;\n}\n}\n\nreturn; // ignore if not in list\n\n}\n\n//\n// DragMouseDown(event)\n//\n\nSocialCalc.DragMouseDown = function(event) {\n\nvar e = event || window.event;\n\nvar draginfo = SocialCalc.DragInfo;\n\nvar dobj = SocialCalc.LookupElement(e.target || e.srcElement, draginfo.registeredElements);\nif (!dobj) return;\n\nif (dobj && dobj.functionobj && dobj.functionobj.Disabled) {\nif (dobj.functionobj.Disabled(e, draginfo, dobj)) {\nreturn;\n}\n}\n\ndraginfo.draggingElement = dobj;\n\nvar viewportinfo = SocialCalc.GetViewportInfo();\ndraginfo.horizontalScroll = viewportinfo.horizontalScroll;\ndraginfo.verticalScroll = viewportinfo.verticalScroll;\n\ndraginfo.clientX = e.clientX + draginfo.horizontalScroll; // get document-relative coordinates\ndraginfo.clientY = e.clientY + draginfo.verticalScroll;\ndraginfo.startX = draginfo.clientX;\ndraginfo.startY = draginfo.clientY;\ndraginfo.startZ = dobj.element.style.zIndex;\ndraginfo.offsetX = 0;\ndraginfo.offsetY = 0;\n\ndobj.element.style.zIndex = \"100\";\n\n// Event code from JavaScript, Flanagan, 5th Edition, pg. 422\nif (document.addEventListener) { // DOM Level 2 -- Firefox, et al\ndocument.addEventListener(\"mousemove\", SocialCalc.DragMouseMove, true); // capture everywhere\ndocument.addEventListener(\"mouseup\", SocialCalc.DragMouseUp, true);\n}\nelse if (dobj.element.attachEvent) { // IE 5+\ndobj.element.setCapture();\ndobj.element.attachEvent(\"onmousemove\", SocialCalc.DragMouseMove);\ndobj.element.attachEvent(\"onmouseup\", SocialCalc.DragMouseUp);\ndobj.element.attachEvent(\"onlosecapture\", SocialCalc.DragMouseUp);\n}\nif (e.stopPropagation) e.stopPropagation(); // DOM Level 2\nelse e.cancelBubble = true; // IE 5+\nif (e.preventDefault) e.preventDefault(); // DOM Level 2\nelse e.returnValue = false; // IE 5+\n\nif (dobj && dobj.functionobj && dobj.functionobj.MouseDown) dobj.functionobj.MouseDown(e, draginfo, dobj);\n\nreturn false;\n\n}\n\n//\n// DragMouseMove(event)\n//\n\nSocialCalc.DragMouseMove = function(event) {\n\nvar e = event || window.event;\n\nvar draginfo = SocialCalc.DragInfo;\ndraginfo.clientX = e.clientX + draginfo.horizontalScroll;\ndraginfo.clientY = e.clientY + draginfo.verticalScroll;\n\nvar dobj = draginfo.draggingElement;\n\nif (e.stopPropagation) e.stopPropagation(); // DOM Level 2\nelse e.cancelBubble = true; // IE 5+\n\nif (dobj && dobj.functionobj && dobj.functionobj.MouseMove) dobj.functionobj.MouseMove(e, draginfo, dobj);\n\nreturn false;\n\n}\n\n//\n// DragMouseUp(event)\n//\n\nSocialCalc.DragMouseUp = function(event) {\n\nvar e = event || window.event;\n\nvar draginfo = SocialCalc.DragInfo;\ndraginfo.clientX = e.clientX + draginfo.horizontalScroll;\ndraginfo.clientY = e.clientY + draginfo.verticalScroll;\n\nvar dobj = draginfo.draggingElement;\n\ndobj.element.style.zIndex = draginfo.startZ;\n\nif (dobj && dobj.functionobj && dobj.functionobj.MouseUp) dobj.functionobj.MouseUp(e, draginfo, dobj);\n\nif (e.stopPropagation) e.stopPropagation(); // DOM Level 2\nelse e.cancelBubble = true; // IE 5+\n\nif (document.removeEventListener) { // DOM Level 2\ndocument.removeEventListener(\"mousemove\", SocialCalc.DragMouseMove, true);\ndocument.removeEventListener(\"mouseup\", SocialCalc.DragMouseUp, true);\n// Note: In old (1.5?) versions of Firefox, this causes the browser to skip the MouseUp for\n// the button code. https://bugzilla.mozilla.org/show_bug.cgi?id=174320\n// Firefox 1.5 is <1% share (http://marketshare.hitslink.com/report.aspx?qprid=7)\n}\nelse if (dobj.element.detachEvent) { // IE\ndobj.element.detachEvent(\"onlosecapture\", SocialCalc.DragMouseUp);\ndobj.element.detachEvent(\"onmouseup\", SocialCalc.DragMouseUp);\ndobj.element.detachEvent(\"onmousemove\", SocialCalc.DragMouseMove);\ndobj.element.releaseCapture();\n}\n\ndraginfo.draggingElement = null;\n\nreturn false;\n\n}\n\n//\n// DragFunctionStart(event, draginfo, dobj)\n//\n\nSocialCalc.DragFunctionStart = function(event, draginfo, dobj) {\n\nvar val;\nvar element = dobj.functionobj.positionobj || dobj.element;\n\nval = element.style.top.match(/\\d*/);\ndraginfo.offsetY = (val ? val[0]-0 : 0) - draginfo.clientY;\nval = element.style.left.match(/\\d*/);\ndraginfo.offsetX = (val ? val[0]-0 : 0) - draginfo.clientX;\n\n}\n\n//\n// DragFunctionPosition(event, draginfo, dobj)\n//\n\nSocialCalc.DragFunctionPosition = function(event, draginfo, dobj) {\n\nvar element = dobj.functionobj.positionobj || dobj.element;\n\nif (dobj.vertical) element.style.top = (draginfo.clientY + draginfo.offsetY)+\"px\";\nif (dobj.horizontal) element.style.left = (draginfo.clientX + draginfo.offsetX)+\"px\";\n\n}\n\n// *************************************\n//\n// Tooltip functions:\n//\n// *************************************\n\nSocialCalc.TooltipInfo = {\n\n// There is only one of these -- no \"new\" is done.\n// Only one tooltip operation can be active at a time.\n// The registeredElements array is used to identify items.\n\n// One item for each element with a tooltip, each an object with:\n//    .element, .tiptext, .functionobj\n// Currently .functionobj can only contain .offsetx and .offsety.\n// If present they are used instead of the default ones.\n\nregisteredElements: [],\n\nregistered: false, // if true, an event handler has been registered for this functionality\n\n// Items used during hover over an element\n\ntooltipElement: null, // item being processed (.element is the actual element)\ntimer: null, // timer object waiting to see if holding over element\npopupElement: null, // tooltip element being displayed\nclientX: 0, // modifyable version to restrict movement\nclientY: 0,\noffsetX: SocialCalc.Constants.TooltipOffsetX, // modifyable version to allow positioning\noffsetY: SocialCalc.Constants.TooltipOffsetY\n\n}\n\n//\n// TooltipRegister(element, tiptext, functionobj) - make element have a tooltip\n//\n\nSocialCalc.TooltipRegister = function(element, tiptext, functionobj) {\n\nvar tooltipinfo = SocialCalc.TooltipInfo;\ntooltipinfo.registeredElements.push(\n{element: element, tiptext: tiptext, functionobj: functionobj}\n);\n\nif (tooltipinfo.registered) return; // only need to add event listener once\n\nif (document.addEventListener) { // DOM Level 2 -- Firefox, et al\ndocument.addEventListener(\"mousemove\", SocialCalc.TooltipMouseMove, false);\n}\nelse if (document.attachEvent) { // IE 5+\ndocument.attachEvent(\"onmousemove\", SocialCalc.TooltipMouseMove);\n}\nelse { // don't handle this\nthrow SocialCalc.Constants.s_BrowserNotSupported;\n}\n\ntooltipinfo.registered = true; // remember\n\nreturn;\n\n}\n\n//\n// TooltipMouseMove(event)\n//\n\nSocialCalc.TooltipMouseMove = function(event) {\n\nvar e = event || window.event;\n\nvar tooltipinfo = SocialCalc.TooltipInfo;\n\ntooltipinfo.viewport = SocialCalc.GetViewportInfo();\ntooltipinfo.clientX = e.clientX + tooltipinfo.viewport.horizontalScroll;\ntooltipinfo.clientY = e.clientY + tooltipinfo.viewport.verticalScroll;\n\nvar tobj = SocialCalc.LookupElement(e.target || e.srcElement, tooltipinfo.registeredElements);\n\nif (tooltipinfo.timer) { // waiting to see if holding still: didn't hold still\nwindow.clearTimeout(tooltipinfo.timer); // cancel timer\ntooltipinfo.timer = null;\n}\n\nif (tooltipinfo.popupElement) { // currently displaying a tip: hide it\nSocialCalc.TooltipHide();\n}\n\ntooltipinfo.tooltipElement = tobj || null;\n\nif (!tobj || SocialCalc.ButtonInfo.buttonDown) return; // if not an object with a tip or a \"button\" is down, ignore\n\ntooltipinfo.timer = window.setTimeout(SocialCalc.TooltipWaitDone, 700);\n\nif (tooltipinfo.tooltipElement.element.addEventListener) { // Register event for mouse down which cancels tooltip stuff\ntooltipinfo.tooltipElement.element.addEventListener(\"mousedown\", SocialCalc.TooltipMouseDown, false);\n}\nelse if (tooltipinfo.tooltipElement.element.attachEvent) { // IE\ntooltipinfo.tooltipElement.element.attachEvent(\"onmousedown\", SocialCalc.TooltipMouseDown);\n}\n\nreturn;\n\n}\n\n//\n// TooltipMouseDown(event)\n//\n\nSocialCalc.TooltipMouseDown = function(event) {\n\nvar e = event || window.event;\n\nvar tooltipinfo = SocialCalc.TooltipInfo;\n\nif (tooltipinfo.timer) {\nwindow.clearTimeout(tooltipinfo.timer); // cancel timer\ntooltipinfo.timer = null;\n}\n\nif (tooltipinfo.popupElement) { // currently displaying a tip: hide it\nSocialCalc.TooltipHide();\n}\n\nif (tooltipinfo.tooltipElement) {\nif (tooltipinfo.tooltipElement.element.removeEventListener) { // DOM Level 2 -- Firefox, et al\ntooltipinfo.tooltipElement.element.removeEventListener(\"mousedown\", SocialCalc.TooltipMouseDown, false);\n}\nelse if (tooltipinfo.tooltipElement.element.attachEvent) { // IE 5+\ntooltipinfo.tooltipElement.element.detachEvent(\"onmousedown\", SocialCalc.TooltipMouseDown);\n}\ntooltipinfo.tooltipElement = null;\n}\n\nreturn;\n\n}\n\n//\n// TooltipDisplay(tobj)\n//\n\nSocialCalc.TooltipDisplay = function(tobj) {\n\nvar tooltipinfo = SocialCalc.TooltipInfo;\nvar scc = SocialCalc.Constants;\nvar offsetX = (tobj.functionobj && ((typeof tobj.functionobj.offsetx) == \"number\")) ? tobj.functionobj.offsetx : tooltipinfo.offsetX;\nvar offsetY = (tobj.functionobj && ((typeof tobj.functionobj.offsety) == \"number\")) ? tobj.functionobj.offsety : tooltipinfo.offsetY;\n\ntooltipinfo.popupElement = document.createElement(\"div\");\nif (scc.TDpopupElementClass) tooltipinfo.popupElement.className = scc.TDpopupElementClass;\nSocialCalc.setStyles(tooltipinfo.popupElement, scc.TDpopupElementStyle);\n\ntooltipinfo.popupElement.innerHTML = tobj.tiptext;\n\nif (tooltipinfo.clientX > tooltipinfo.viewport.width/2) { // on right side of screen\ntooltipinfo.popupElement.style.bottom = (tooltipinfo.viewport.height - tooltipinfo.clientY + offsetY)+\"px\";\ntooltipinfo.popupElement.style.right = (tooltipinfo.viewport.width - tooltipinfo.clientX + offsetX)+\"px\";\n}\nelse { // on left side of screen\ntooltipinfo.popupElement.style.bottom = (tooltipinfo.viewport.height - tooltipinfo.clientY + offsetY)+\"px\";\ntooltipinfo.popupElement.style.left = (tooltipinfo.clientX + offsetX)+\"px\";\n}\n\nif (tooltipinfo.clientY < 50) { // make sure fits on screen if nothing above grid\ntooltipinfo.popupElement.style.bottom = (tooltipinfo.viewport.height - tooltipinfo.clientY + offsetY - 50)+\"px\";\n}\n\ndocument.body.appendChild(tooltipinfo.popupElement);\n\n}\n\n//\n// TooltipHide()\n//\n\nSocialCalc.TooltipHide = function() {\n\nvar tooltipinfo = SocialCalc.TooltipInfo;\n\nif (tooltipinfo.popupElement) {\ntooltipinfo.popupElement.parentNode.removeChild(tooltipinfo.popupElement);\ntooltipinfo.popupElement = null;\n}\n\n}\n\n//\n// TooltipWaitDone()\n//\n\nSocialCalc.TooltipWaitDone = function() {\n\nvar tooltipinfo = SocialCalc.TooltipInfo;\n\ntooltipinfo.timer = null;\n\nSocialCalc.TooltipDisplay(tooltipinfo.tooltipElement);\n\n}\n\n\n// *************************************\n//\n// Button functions:\n//\n// *************************************\n\nSocialCalc.ButtonInfo = {\n\n// There is only one of these -- no \"new\" is done.\n// Only one button operation can be active at a time.\n// The registeredElements array is used to identify items.\n\n// One item for each clickable element, each an object with:\n//    .element, .normalstyle, .hoverstyle, .downstyle, .repeatinterval, .functionobj\n//\n// .functionobj is an object with optional function objects for:\n//    mouseover, mouseout, mousedown, repeatinterval, mouseup, disabled\n\nregisteredElements: [],\n\n// Items used during hover over an element, clicking, repeating, etc.\n\nbuttonElement: null, // item being processed, hover or down (.element is the actual element)\ndoingHover: false, // true if mouse is over one of our elements\nbuttonDown: false, // true if button down and buttonElement not null\ntimer: null, // timer object for repeating\n\n// Used while processing an event\n\nhorizontalScroll: 0,\nverticalScroll: 0,\nclientX: 0,\nclientY: 0\n\n}\n\n//\n// ButtonRegister(element, paramobj, functionobj) - make element clickable\n//\n// The arguments (other than element) may be null (meaning no change for style and no repeat)\n// The paramobj has the optional normalstyle, hoverstyle, downstyle, repeatwait, repeatinterval settings\n\nSocialCalc.ButtonRegister = function(element, paramobj, functionobj) {\n\nvar buttoninfo = SocialCalc.ButtonInfo;\n\nif (!paramobj) paramobj = {};\n\nbuttoninfo.registeredElements.push(\n{name: paramobj.name, element: element, normalstyle: paramobj.normalstyle, hoverstyle: paramobj.hoverstyle, downstyle: paramobj.downstyle,\nrepeatwait: paramobj.repeatwait, repeatinterval: paramobj.repeatinterval, functionobj: functionobj}\n);\n\nif (element.addEventListener) { // DOM Level 2 -- Firefox, et al\nelement.addEventListener(\"mousedown\", SocialCalc.ButtonMouseDown, false);\nelement.addEventListener(\"mouseover\", SocialCalc.ButtonMouseOver, false);\nelement.addEventListener(\"mouseout\", SocialCalc.ButtonMouseOut, false);\n}\nelse if (element.attachEvent) { // IE 5+\nelement.attachEvent(\"onmousedown\", SocialCalc.ButtonMouseDown);\nelement.attachEvent(\"onmouseover\", SocialCalc.ButtonMouseOver);\nelement.attachEvent(\"onmouseout\", SocialCalc.ButtonMouseOut);\n}\nelse { // don't handle this\nthrow SocialCalc.Constants.s_BrowserNotSupported;\n}\n\nreturn;\n\n}\n\n//\n// ButtonMouseOver(event)\n//\n\nSocialCalc.ButtonMouseOver = function(event) {\n\nvar e = event || window.event;\n\nvar buttoninfo = SocialCalc.ButtonInfo;\n\nvar bobj = SocialCalc.LookupElement(e.target || e.srcElement, buttoninfo.registeredElements);\n\nif (!bobj) return;\n\nif (buttoninfo.buttonDown) {\nif (buttoninfo.buttonElement==bobj) {\nbuttoninfo.doingHover = true; // keep track whether we are on the pressed button or not\n}\nreturn;\n}\n\nif (buttoninfo.buttonElement &&\nbuttoninfo.buttonElement!=bobj && buttoninfo.doingHover) { // moved to a new one, undo hover there\nSocialCalc.setStyles(buttoninfo.buttonElement.element, buttoninfo.buttonElement.normalstyle);\n}\n\nbuttoninfo.buttonElement = bobj; // remember this one is hovering\nbuttoninfo.doingHover = true;\n\nSocialCalc.setStyles(bobj.element, bobj.hoverstyle); // set style (if provided)\n\nif (bobj && bobj.functionobj && bobj.functionobj.MouseOver) bobj.functionobj.MouseOver(e, buttoninfo, bobj);\n\nreturn;\n\n}\n\n//\n// ButtonMouseOut(event)\n//\n\nSocialCalc.ButtonMouseOut = function(event) {\n\nvar e = event || window.event;\n\nvar buttoninfo = SocialCalc.ButtonInfo;\n\nif (buttoninfo.buttonDown) {\nbuttoninfo.doingHover = false; // keep track of overs and outs\nreturn;\n}\n\nvar bobj = SocialCalc.LookupElement(e.target || e.srcElement, buttoninfo.registeredElements);\n\nif (buttoninfo.doingHover) { // if there was a hover, undo it\nif (buttoninfo.buttonElement)\nSocialCalc.setStyles(buttoninfo.buttonElement.element, buttoninfo.buttonElement.normalstyle);\nbuttoninfo.buttonElement = null;\nbuttoninfo.doingHover = false;\n}\n\nif (bobj && bobj.functionobj && bobj.functionobj.MouseOut) bobj.functionobj.MouseOut(e, buttoninfo, bobj);\n\nreturn;\n\n}\n\n//\n// ButtonMouseDown(event)\n//\n\nSocialCalc.ButtonMouseDown = function(event) {\n\nvar e = event || window.event;\n\nvar buttoninfo = SocialCalc.ButtonInfo;\n\nvar viewportinfo = SocialCalc.GetViewportInfo();\n\nvar bobj = SocialCalc.LookupElement(e.target || e.srcElement, buttoninfo.registeredElements);\n\nif (!bobj) return; // not one of our elements\n\nif (bobj && bobj.functionobj && bobj.functionobj.Disabled) {\nif (bobj.functionobj.Disabled(e, buttoninfo, bobj)) {\nreturn;\n}\n}\n\nbuttoninfo.buttonElement = bobj;\nbuttoninfo.buttonDown = true;\n\nSocialCalc.setStyles(bobj.element, buttoninfo.buttonElement.downstyle);\n\n// Register event handler for mouse up\n\n// Event code from JavaScript, Flanagan, 5th Edition, pg. 422\nif (document.addEventListener) { // DOM Level 2 -- Firefox, et al\ndocument.addEventListener(\"mouseup\", SocialCalc.ButtonMouseUp, true); // capture everywhere\n}\nelse if (bobj.element.attachEvent) { // IE 5+\nbobj.element.setCapture();\nbobj.element.attachEvent(\"onmouseup\", SocialCalc.ButtonMouseUp);\nbobj.element.attachEvent(\"onlosecapture\", SocialCalc.ButtonMouseUp);\n}\nif (e.stopPropagation) e.stopPropagation(); // DOM Level 2\nelse e.cancelBubble = true; // IE 5+\nif (e.preventDefault) e.preventDefault(); // DOM Level 2\nelse e.returnValue = false; // IE 5+\n\nbuttoninfo.horizontalScroll = viewportinfo.horizontalScroll;\nbuttoninfo.verticalScroll = viewportinfo.verticalScroll;\nbuttoninfo.clientX = e.clientX + buttoninfo.horizontalScroll; // get document-relative coordinates\nbuttoninfo.clientY = e.clientY + buttoninfo.verticalScroll;\n\nif (bobj && bobj.functionobj && bobj.functionobj.MouseDown) bobj.functionobj.MouseDown(e, buttoninfo, bobj);\n\nif (bobj.repeatwait) { // if a repeat wait is set, then starting waiting for first repetition\nbuttoninfo.timer = window.setTimeout(SocialCalc.ButtonRepeat, bobj.repeatwait);\n}\n\nreturn;\n\n}\n\n//\n// ButtonMouseUp(event)\n//\n\nSocialCalc.ButtonMouseUp = function(event) {\n\nvar e = event || window.event;\n\nvar buttoninfo = SocialCalc.ButtonInfo;\nvar bobj = buttoninfo.buttonElement;\n\nif (buttoninfo.timer) { // if repeating, cancel it\nwindow.clearTimeout(buttoninfo.timer); // cancel timer\nbuttoninfo.timer = null;\n}\n\nif (!buttoninfo.buttonDown) return; // already did this (e.g., in IE, releaseCapture fires losecapture)\n\nif (e.stopPropagation) e.stopPropagation(); // DOM Level 2\nelse e.cancelBubble = true; // IE 5+\nif (e.preventDefault) e.preventDefault(); // DOM Level 2\nelse e.returnValue = false; // IE 5+\n\nif (document.removeEventListener) { // DOM Level 2\ndocument.removeEventListener(\"mouseup\", SocialCalc.ButtonMouseUp, true);\n}\nelse if (document.detachEvent) { // IE\nbobj.element.detachEvent(\"onlosecapture\", SocialCalc.ButtonMouseUp);\nbobj.element.detachEvent(\"onmouseup\", SocialCalc.ButtonMouseUp);\nbobj.element.releaseCapture();\n}\n\nif (buttoninfo.buttonElement.downstyle) {\nif (buttoninfo.doingHover)\nSocialCalc.setStyles(bobj.element, buttoninfo.buttonElement.hoverstyle);\nelse\nSocialCalc.setStyles(bobj.element, buttoninfo.buttonElement.normalstyle);\n}\n\nbuttoninfo.buttonDown = false;\n\nif (bobj && bobj.functionobj && bobj.functionobj.MouseUp) bobj.functionobj.MouseUp(e, buttoninfo, bobj);\n\n}\n\n//\n// ButtonRepeat()\n//\n\nSocialCalc.ButtonRepeat = function() {\n\nvar buttoninfo = SocialCalc.ButtonInfo;\nvar bobj = buttoninfo.buttonElement;\n\nif (!bobj) return;\n\nif (bobj && bobj.functionobj && bobj.functionobj.Repeat) bobj.functionobj.Repeat(null, buttoninfo, bobj);\n\nbuttoninfo.timer = window.setTimeout(SocialCalc.ButtonRepeat, bobj.repeatinterval || 100);\n\n}\n\n// *************************************\n//\n// MouseWheel functions:\n//\n// *************************************\n\nSocialCalc.MouseWheelInfo = {\n\n// There is only one of these -- no \"new\" is done.\n// The mousewheel only affects the one area the mouse pointer is over\n// The registeredElements array is used to identify items.\n\n// One item for each element to respond to the mousewheel, each an object with:\n//    .element, .functionobj\n\nregisteredElements: []\n\n}\n\n//\n// MouseWheelRegister(element, functionobj) - make element respond to mousewheel\n//\n\nSocialCalc.MouseWheelRegister = function(element, functionobj) {\n\nvar mousewheelinfo = SocialCalc.MouseWheelInfo;\n\nmousewheelinfo.registeredElements.push(\n{element: element, functionobj: functionobj}\n);\n\nif (element.addEventListener) { // DOM Level 2 -- Firefox, et al\nelement.addEventListener(\"DOMMouseScroll\", SocialCalc.ProcessMouseWheel, false);\nelement.addEventListener(\"mousewheel\", SocialCalc.ProcessMouseWheel, false); // Opera needs this\n}\nelse if (element.attachEvent) { // IE 5+\nelement.attachEvent(\"onmousewheel\", SocialCalc.ProcessMouseWheel);\n}\nelse { // don't handle this\nthrow SocialCalc.Constants.s_BrowserNotSupported;\n}\n\nreturn;\n\n}\n\nSocialCalc.ProcessMouseWheel = function(e) {\n\nvar event = e || window.event;\nvar delta;\n\nif (SocialCalc.Keyboard.passThru) return; // ignore\n\nvar mousewheelinfo = SocialCalc.MouseWheelInfo;\nvar ele = event.target || event.srcElement; // source object is often within what we want\nvar wobj;\n\nfor (wobj=null; !wobj && ele; ele=ele.parentNode) { // go up tree looking for one of our elements\nwobj = SocialCalc.LookupElement(ele, mousewheelinfo.registeredElements);\n}\nif (!wobj) return; // not one of our elements\n\nif (event.wheelDelta) {\ndelta = event.wheelDelta/120;\n}\nelse delta = -event.detail/3;\nif (!delta) delta = 0;\n\nif (wobj.functionobj && wobj.functionobj.WheelMove) wobj.functionobj.WheelMove(event, delta, mousewheelinfo, wobj);\n\nif (event.preventDefault) event.preventDefault();\nevent.returnValue = false;\n\n}\n\n// *************************************\n//\n// Keyboard functions:\n//\n// For more information about keyboard handling, see: http://unixpapa.com/js/key.html\n//\n// *************************************\n\nSocialCalc.keyboardTables = {\n\nspecialKeysCommon: {\n8: \"[backspace]\", 9: \"[tab]\", 13: \"[enter]\", 25: \"[tab]\", 27: \"[esc]\", 33: \"[pgup]\", 34: \"[pgdn]\",\n35: \"[end]\", 36: \"[home]\", 37: \"[aleft]\", 38: \"[aup]\", 39: \"[aright]\", 40: \"[adown]\", 45: \"[ins]\",\n46: \"[del]\", 113: \"[f2]\"\n},\n\nspecialKeysIE: {\n8: \"[backspace]\", 9: \"[tab]\", 13: \"[enter]\", 25: \"[tab]\", 27: \"[esc]\", 33: \"[pgup]\", 34: \"[pgdn]\",\n35: \"[end]\", 36: \"[home]\", 37: \"[aleft]\", 38: \"[aup]\", 39: \"[aright]\", 40: \"[adown]\", 45: \"[ins]\",\n46: \"[del]\", 113: \"[f2]\"\n},\n\ncontrolKeysIE: {\n67: \"[ctrl-c]\",\n83: \"[ctrl-s]\",\n86: \"[ctrl-v]\",\n88: \"[ctrl-x]\",\n90: \"[ctrl-z]\"\n},\n\nspecialKeysOpera: {\n8: \"[backspace]\", 9: \"[tab]\", 13: \"[enter]\", 25: \"[tab]\", 27: \"[esc]\", 33: \"[pgup]\", 34: \"[pgdn]\",\n35: \"[end]\", 36: \"[home]\", 37: \"[aleft]\", 38: \"[aup]\", 39: \"[aright]\", 40: \"[adown]\",\n45: \"[ins]\", // issues with releases before 9.5 - same as \"-\" (\"-\" changed in 9.5)\n46: \"[del]\", // issues with releases before 9.5 - same as \".\" (\".\" changed in 9.5)\n113: \"[f2]\"\n},\n\ncontrolKeysOpera: {\n67: \"[ctrl-c]\",\n83: \"[ctrl-s]\",\n86: \"[ctrl-v]\",\n88: \"[ctrl-x]\",\n90: \"[ctrl-z]\"\n},\n\nspecialKeysSafari: {\n8: \"[backspace]\", 9: \"[tab]\", 13: \"[enter]\", 25: \"[tab]\", 27: \"[esc]\", 63232: \"[aup]\", 63233: \"[adown]\",\n63234: \"[aleft]\", 63235: \"[aright]\", 63272: \"[del]\", 63273: \"[home]\", 63275: \"[end]\", 63276: \"[pgup]\",\n63277: \"[pgdn]\", 63237: \"[f2]\"\n},\n\ncontrolKeysSafari: {\n99: \"[ctrl-c]\",\n115: \"[ctrl-s]\",\n118: \"[ctrl-v]\",\n120: \"[ctrl-x]\",\n122: \"[ctrl-z]\"\n},\n\nignoreKeysSafari: {\n63236: \"[f1]\", 63238: \"[f3]\", 63239: \"[f4]\", 63240: \"[f5]\", 63241: \"[f6]\", 63242: \"[f7]\",\n63243: \"[f8]\", 63244: \"[f9]\", 63245: \"[f10]\", 63246: \"[f11]\", 63247: \"[f12]\", 63289: \"[numlock]\"\n},\n\nspecialKeysFirefox: {\n8: \"[backspace]\", 9: \"[tab]\", 13: \"[enter]\", 25: \"[tab]\", 27: \"[esc]\", 33: \"[pgup]\", 34: \"[pgdn]\",\n35: \"[end]\", 36: \"[home]\", 37: \"[aleft]\", 38: \"[aup]\", 39: \"[aright]\", 40: \"[adown]\", 45: \"[ins]\",\n46: \"[del]\", 113: \"[f2]\"\n},\n\ncontrolKeysFirefox: {\n99: \"[ctrl-c]\",\n115: \"[ctrl-s]\",\n118: \"[ctrl-v]\",\n120: \"[ctrl-x]\",\n122: \"[ctrl-z]\"\n},\n\nignoreKeysFirefox: {\n16: \"[shift]\", 17: \"[ctrl]\", 18: \"[alt]\", 20: \"[capslock]\", 19: \"[pause]\", 44: \"[printscreen]\",\n91: \"[windows]\", 92: \"[windows]\", 112: \"[f1]\", 114: \"[f3]\", 115: \"[f4]\", 116: \"[f5]\",\n117: \"[f6]\", 118: \"[f7]\", 119: \"[f8]\", 120: \"[f9]\", 121: \"[f10]\", 122: \"[f11]\", 123: \"[f12]\",\n144: \"[numlock]\", 145: \"[scrolllock]\", 224: \"[cmd]\"\n}\n}\n\nSocialCalc.Keyboard = {\nareListener: false, // if true, we have been installed as a listener for keyboard events\nfocusTable: null, // the table editor object that gets keystrokes or null\npassThru: null, // if not null, control element with focus to pass keyboard events to (has blur method), or \"true\"\ndidProcessKey: false, // did SocialCalc.ProcessKey in keydown\nstatusFromProcessKey: false, // the status from the keydown SocialCalc.ProcessKey\nrepeatingKeyPress: false, // some browsers (Opera, Gecko Mac) repeat special keys as KeyPress not KeyDown\nchForProcessKey: \"\" // remember so can do repeat in those cases\n};\n\nSocialCalc.KeyboardSetFocus = function(editor) {\n\nSocialCalc.Keyboard.focusTable = editor;\n\nif (!SocialCalc.Keyboard.areListener) {\ndocument.onkeydown = SocialCalc.ProcessKeyDown;\ndocument.onkeypress = SocialCalc.ProcessKeyPress;\nSocialCalc.Keyboard.areListener = true;\n}\nif (SocialCalc.Keyboard.passThru) {\nif (SocialCalc.Keyboard.passThru.blur) {\nSocialCalc.Keyboard.passThru.blur();\n}\nSocialCalc.Keyboard.passThru = null;\n}\nwindow.focus();\n}\n\nSocialCalc.KeyboardFocus = function() {\n\nSocialCalc.Keyboard.passThru = null;\nwindow.focus();\n\n}\n\nSocialCalc.ProcessKeyDown = function(e) {\n\nvar kt = SocialCalc.keyboardTables;\nkt.didProcessKey = false; // always start false\nkt.statusFromProcessKey = false;\nkt.repeatingKeyPress = false;\n\nvar ch=\"\";\nvar status=true;\n\nif (SocialCalc.Keyboard.passThru) return; // ignore\n\ne = e || window.event;\n\n// IE and Safari 3.1+ won't fire keyPress, so check for special keys here.\nif (e.which==undefined || (typeof e.keyIdentifier == \"string\")) {\nch = kt.specialKeysCommon[e.keyCode];\nif (!ch) {\nif (e.ctrlKey) {\nch=kt.controlKeysIE[e.keyCode];\n}\nif (!ch)\nreturn true;\n}\nstatus = SocialCalc.ProcessKey(ch, e);\n\nif (!status) {\nif (e.preventDefault) e.preventDefault();\ne.returnValue = false;\n}\n}\n\nelse { \nch = kt.specialKeysCommon[e.keyCode];\nif (!ch) {\n//         return true;\nif (e.ctrlKey || e.metaKey) {\nch=kt.controlKeysIE[e.keyCode]; // this works here\n}\nif (!ch)\nreturn true;\n}\n\nstatus = SocialCalc.ProcessKey(ch, e); // process the key\nkt.didProcessKey = true; // remember what happened\nkt.statusFromProcessKey = status;\nkt.chForProcessKey = ch;\n}\n\nreturn status;\n\n}\n\nSocialCalc.ProcessKeyPress = function(e) {\n\nvar kt = SocialCalc.keyboardTables;\n\nvar ch=\"\";\n\ne = e || window.event;\n\nif (SocialCalc.Keyboard.passThru) return; // ignore\nif (kt.didProcessKey) { // already processed this key\nif (kt.repeatingKeyPress) {\nreturn SocialCalc.ProcessKey(kt.chForProcessKey, e); // process the same key as on KeyDown\n}\nelse {\nkt.repeatingKeyPress = true; // see if get another KeyPress before KeyDown\nreturn kt.statusFromProcessKey; // do what it said to do\n}\n}\n\nif (e.which==undefined) { // IE\n// Note: Esc and Enter will come through here, too, if not stopped at KeyDown\nch=String.fromCharCode(e.keyCode); // convert to a character (special chars handled at ev1)\n}\n\nelse { // not IE\nif (!e.which)\nreturn false; // ignore - special key\nif (e.charCode==undefined) { // Opera\nif (e.which!=0) { // character\nif (e.which<32 || e.which==144) { // special char (144 is numlock)\nch = kt.specialKeysOpera[e.which];\nif (ch) {\nreturn true;\n}\n}\nelse {\nif (e.ctrlKey) {\nch=kt.controlKeysOpera[e.keyCode];\n}\nelse {\nch = String.fromCharCode(e.which);\n}\n}\n}\nelse { // special char\nreturn true;\n}\n}\n\nelse if (e.keyCode==0 && e.charCode==0) { // OLPC Fn key or something\nreturn; // ignore\n}\n\nelse if (e.keyCode==e.charCode) { // Safari\nch = kt.specialKeysSafari[e.keyCode];\nif (!ch) {\nif (kt.ignoreKeysSafari[e.keyCode]) // pass this through\nreturn true;\nif (e.metaKey) {\nch=kt.controlKeysSafari[e.keyCode];\n}\nelse {\nch = String.fromCharCode(e.which);\n}\n}\n}\n\nelse { // Firefox\nif (kt.specialKeysFirefox[e.keyCode]) {\nreturn true;\n}\nch = String.fromCharCode(e.which);\nif (e.ctrlKey || e.metaKey) {\nch = kt.controlKeysFirefox[e.which];\n}\n}\n}\n\nvar status = SocialCalc.ProcessKey(ch, e);\n\nif (!status) {\nif (e.preventDefault) e.preventDefault();\ne.returnValue = false;\n}\n\nreturn status;\n\n}\n\n/* \n*\n* OLD ProcessKeyDown and ProcessKeyPress -- replaced for handling newer browsers, including Safari 3.1 and Opera 9.5\n*\n\nSocialCalc.ProcessKeyDown = function(e) {\n\nvar kt = SocialCalc.keyboardTables;\n\nvar ch=\"\";\nvar status=true;\n\nif (SocialCalc.Keyboard.passThru) return; // ignore\n\ne = e || window.event;\n\nif (e.which==undefined) { // IE\nch = kt.specialKeysIE[e.keyCode];\nif (!ch) {\nif (e.ctrlKey) {\nch=kt.controlKeysIE[e.keyCode];\n}\nif (!ch)\nreturn true;\n}\n\nstatus = SocialCalc.ProcessKey(ch, e);\n\nif (!status) {\nif (e.preventDefault) e.preventDefault();\ne.returnValue = false;\n}\n}\n\nelse { // don't do anything for other browsers - wait for keyPress\n; // special key repeats are done as keypress in those browsers\n}\n\nreturn status;\n\n}\n\nSocialCalc.ProcessKeyPress = function(e) {\n\nvar kt = SocialCalc.keyboardTables;\n\nvar ch=\"\";\n\nif (SocialCalc.Keyboard.passThru) return; // ignore\n\ne = e || window.event;\n\nif (e.which==undefined) { // IE\n// Note: Esc and Enter will come through here, too, if not stopped at KeyDown\nch=String.fromCharCode(e.keyCode); // convert to a character (special chars handled at ev1)\n}\n\nelse { // not IE\nif (e.charCode==undefined) { // Opera\nif (e.which!=0) { // character\nif (e.which<32) { // special char\nch = kt.specialKeysOpera[e.keyCode];\nif (!ch)\nreturn true;\n}\nelse {\nif (e.ctrlKey) {\nch=kt.controlKeysOpera[e.keyCode];\n}\nelse {\nch = String.fromCharCode(e.which);\n}\n}\n}\nelse { // special char\nch = kt.specialKeysOpera[e.keyCode];\nif (!ch)\nreturn true;\n}\n}\n\nelse if (e.keyCode==0 && e.charCode==0) { // OLPC Fn key or something\nreturn; // ignore\n}\n\nelse if (e.keyCode==e.charCode) { // Safari\nch = kt.specialKeysSafari[e.keyCode];\nif (!ch) {\nif (kt.ignoreKeysSafari[e.keyCode]) // pass this through\nreturn true;\nif (e.metaKey) {\nch=kt.controlKeysSafari[e.keyCode];\n}\nelse {\nch = String.fromCharCode(e.which);\n}\n}\n}\n\nelse { // Firefox\nch = kt.specialKeysFirefox[e.keyCode];\nif (!ch) {\nif (kt.ignoreKeysFirefox[e.keyCode]) // pass this through\nreturn true;\nif (e.which) { // normal char\nif (e.ctrlKey || e.metaKey) {\nch = kt.controlKeysFirefox[e.which];\n}\nelse {\nch = String.fromCharCode(e.which);\n}\n}\nelse { // usually a special char\nreturn true; // old Firefox gives extra, empty keyPress for \"/\" - ignore\n}\n}\n}\n}\n\nvar status = SocialCalc.ProcessKey(ch, e);\n\nif (!status) {\nif (e.preventDefault) e.preventDefault();\ne.returnValue = false;\n}\n\nreturn status;\n\n}\n*/\n\n//\n// status = SocialCalc.ProcessKey(ch, e)\n//\n// Take a key representation as a character string and dispatch to appropriate routine\n//\n\nSocialCalc.ProcessKey = function (ch, e) {\nvar ft = SocialCalc.Keyboard.focusTable;\n\nif (!ft) return true; // we're not handling it -- let browser do default\n\nreturn ft.EditorProcessKey(ch, e);\n\n}\n\n\n// For Contact\nSocialCalc.EditorChangecontact = function(editor,text,name,phone,email,street,city,company,val) {\n\n// alert('changecontact called');\n//var wval = editor.workingvalues;\nif(name!=\"\"){\ncmdline = \"set \"+name+\" \"+\"text t\"+\" \"+contactname;\neditor.EditorScheduleSheetCommands(cmdline, true, false);\n}\ncmdline = \"set \"+phone+\" \"+\"text t\"+\" \"+contactphoneNumber;\neditor.EditorScheduleSheetCommands(cmdline, true, false);\nif(email!=\"\"){\ncmdline = \"set \"+email+\" \"+\"text t\"+\" \"+contactemail;\neditor.EditorScheduleSheetCommands(cmdline, true, false);}\ncmdline = \"set \"+street+\" \"+\"text t\"+\" \"+contactStreet;\neditor.EditorScheduleSheetCommands(cmdline, true, false);\ncmdline = \"set \"+city+\" \"+\"text t\"+\" \"+contactcity;\neditor.EditorScheduleSheetCommands(cmdline, true, false);\nif(val==\"y\"){ cmdline = \"set \"+company+\" \"+\"text t\"+\" \"+contactcompany;\neditor.EditorScheduleSheetCommands(cmdline, true, false);\n}\n\nreturn;\n\n}\n\n\n//changes by mini for font and color\n\n\nSocialCalc.EditorChangeSheetcolor = function(editor, text) {\n\nvar result, cell, valueinfo, fch, type, value, oldvalue, cmdline;\n\nvar sheetobj = editor.context.sheetobj;\nvar wval = editor.workingvalues;\n\n\n\ntype = \"text t\";\n//value = typeof text == \"string\" ? text : editor.inputBox.GetText(); // either explicit or from input box\nvalue = text;\n\noldvalue = SocialCalc.GetCellContents(sheetobj, wval.ecoord)+\"\";\nif (value == oldvalue) { // no change\nreturn;\n}\nfch = value.charAt(0);\nif (fch==\"=\" && value.indexOf(\"\\n\")==-1) {\ntype = \"formula\";\nvalue = value.substring(1);\n}\nelse if (fch==\"'\") {\ntype = \"text t\";\nvalue = value.substring(1);\n}\nelse if (value.length==0) {\ntype = \"empty\";\n}\nelse {\nvalueinfo = SocialCalc.DetermineValueType(value)\nif (valueinfo.type==\"n\" && value==(valueinfo.value+\"\")) { // see if don't need \"constant\"\ntype = \"value n\";\n}\nelse if (valueinfo.type.charAt(0)==\"t\") {\ntype = \"text \"+valueinfo.type;\n}\nelse if (valueinfo.type==\"\") {\ntype = \"text t\";\n}\nelse {\ntype = \"constant \"+valueinfo.type+\" \"+valueinfo.value;\n}\n}\n\nif (type.charAt(0)==\"t\") { // text\nvalue = SocialCalc.encodeForSave(value); // newlines, :, and \\ are escaped\n}\n\n// if startsheet different from currentsheet, switch to start sheet\n// for the save to take effect\nif (SocialCalc.WorkBook && (wval.currentsheet != wval.startsheet)) {\nvar control = SocialCalc.GetCurrentWorkBookControl();\nvar cmdstr = \"activatesheet \" +wval.startsheetid;\ncontrol.ExecuteWorkBookControlCommand( { cmdtype:\"wcmd\", id:\"0\", cmdstr: cmdstr}\n,false)\n}\n\n//cmdline = \"set \"+wval.ecoord+\" \"+\"font\"+\" \"+value;\ncmdline = \"set \"+\"sheet\"+\" \"+\"defaultcolor\"+\" \"+ value;\n//cmdline = \"set \"+\"sheet\"+\" \"+\"defaultcolor green\";\n//var control = SocialCalc.GetCurrentWorkBookControl();\n//alert('u reach sheet' + \" \"+control.workbook.sheetArr[\"sheet1\"].sheet);\n//cmdline = \"set \"+sheetobj+\" \"+\"font\"+\" \"+value;\n//cmdline=\"set \"+  control.workbook.sheetArr[\"sheet1\"].sheet+\" color blue\" ;\neditor.EditorScheduleSheetCommands(cmdline, true, false);\n\nreturn;\n\n}\n\n\nSocialCalc.EditorChangecolorFromWidget = function(editor, text) {\n\nvar result, cell, valueinfo, fch, type, value, oldvalue, cmdline;\n\nvar sheetobj = editor.context.sheetobj;\nvar wval = editor.workingvalues;\nif(!CoordForColorChange){alert(\"No active cell\");return;}\n\n// if startsheet different from currentsheet, switch to start sheet\n// for the save to take effect\nif (SocialCalc.WorkBook && (wval.currentsheet != wval.startsheet)) {\nvar control = SocialCalc.GetCurrentWorkBookControl();\nvar cmdstr = \"activatesheet \" +wval.startsheetid;\ncontrol.ExecuteWorkBookControlCommand( { cmdtype:\"wcmd\", id:\"0\", cmdstr: cmdstr}\n,false)\n}\n\ncmdline = \"set \"+CoordForColorChange+\" \"+\"color\"+\" \"+text;\neditor.EditorScheduleSheetCommands(cmdline, true, false);\n\nreturn;\n\n}\n\n\n\nSocialCalc.EditorChangefontFromWidget = function(editor, text) {\n\nvar result, cell, valueinfo, fch, type, value, oldvalue, cmdline;\n\nvar sheetobj = editor.context.sheetobj;\nvar wval = editor.workingvalues;\nif(!CoordForColorChange){alert(\"No active cell\");return;}\n//alert(CoordForColorChange);\n// if startsheet different from currentsheet, switch to start sheet\n// for the save to take effect\nif (SocialCalc.WorkBook && (wval.currentsheet != wval.startsheet)) {\nvar control = SocialCalc.GetCurrentWorkBookControl();\nvar cmdstr = \"activatesheet \" +wval.startsheetid;\ncontrol.ExecuteWorkBookControlCommand( { cmdtype:\"wcmd\", id:\"0\", cmdstr: cmdstr}\n,false)\n}\n\n//cmdline = \"set \"+CoordForColorChange+\" \"+\"font\"+\" \"+text;\n//editor.EditorScheduleSheetCommands(cmdline, true, false);\nvar value=text;\nif(value==\"a\"){\n\ncmdline = \"set \"+CoordForColorChange+\" font * 12px *\";editor.EditorScheduleSheetCommands(cmdline, true, false);\n}\nif(value==\"b\"){cmdline=\"set \"+CoordForColorChange+\" font * 14px *\";editor.EditorScheduleSheetCommands(cmdline, true, false);}\nif(value==\"c\"){cmdline=\"set \"+CoordForColorChange+\" font * 16px *\";editor.EditorScheduleSheetCommands(cmdline, true, false);}\nif(value==\"d\"){cmdline=\"set \"+CoordForColorChange+\" font * 18px *\";editor.EditorScheduleSheetCommands(cmdline, true, false);}\n\nreturn;\n\n}\n\n\n\n\n\nSocialCalc.EditorChangeSheetfont = function(editor, text) {\n\nvar result, cell, valueinfo, fch, type, value, oldvalue, cmdline;\n\nvar sheetobj = editor.context.sheetobj;\nvar wval = editor.workingvalues;\n\n\n\ntype = \"text t\";\n//value = typeof text == \"string\" ? text : editor.inputBox.GetText(); // either explicit or from input box\nvalue = text;\n\noldvalue = SocialCalc.GetCellContents(sheetobj, wval.ecoord)+\"\";\nif (value == oldvalue) { // no change\nreturn;\n}\nfch = value.charAt(0);\nif (fch==\"=\" && value.indexOf(\"\\n\")==-1) {\ntype = \"formula\";\nvalue = value.substring(1);\n}\nelse if (fch==\"'\") {\ntype = \"text t\";\nvalue = value.substring(1);\n}\nelse if (value.length==0) {\ntype = \"empty\";\n}\nelse {\nvalueinfo = SocialCalc.DetermineValueType(value)\nif (valueinfo.type==\"n\" && value==(valueinfo.value+\"\")) { // see if don't need \"constant\"\ntype = \"value n\";\n}\nelse if (valueinfo.type.charAt(0)==\"t\") {\ntype = \"text \"+valueinfo.type;\n}\nelse if (valueinfo.type==\"\") {\ntype = \"text t\";\n}\nelse {\ntype = \"constant \"+valueinfo.type+\" \"+valueinfo.value;\n}\n}\n\nif (type.charAt(0)==\"t\") { // text\nvalue = SocialCalc.encodeForSave(value); // newlines, :, and \\ are escaped\n}\n\n// if startsheet different from currentsheet, switch to start sheet\n// for the save to take effect\nif (SocialCalc.WorkBook && (wval.currentsheet != wval.startsheet)) {\nvar control = SocialCalc.GetCurrentWorkBookControl();\nvar cmdstr = \"activatesheet \" +wval.startsheetid;\ncontrol.ExecuteWorkBookControlCommand( { cmdtype:\"wcmd\", id:\"0\", cmdstr: cmdstr}\n,false)\n}\n\n//cmdline = \"set \"+wval.ecoord+\" \"+\"font\"+\" \"+value;\n//cmdline = \"set \"+\"sheet\"+\" \"+\"defaultcolor\"+\" \"+ value;\n\n//cmdline = \"set \"+\"sheet\"+\" \"+\"defaultfont\"+\" * \"+value+\" *\";\n\n//cmdline = \"set sheet defaultfont normal normal \"+value +\" *\";\n//cmdline=\"set sheet defaultfont\";\n// alert(cmdline);\n//editor.EditorScheduleSheetCommands(cmdline, true, false);\nif(value==\"a\"){\ncmdline = \"set sheet defaultfont * 12px *\";editor.EditorScheduleSheetCommands(cmdline, true, false);\n}\nif(value==\"b\"){cmdline=\"set sheet defaultfont * 14px *\";editor.EditorScheduleSheetCommands(cmdline, true, false);}\nif(value==\"c\"){cmdline=\"set sheet defaultfont * 16px *\";editor.EditorScheduleSheetCommands(cmdline, true, false);}\nif(value==\"d\"){cmdline=\"set sheet defaultfont * 18px *\";editor.EditorScheduleSheetCommands(cmdline, true, false);}\n\n//cmdline = \"\"+\"set sheet defaultfont * 8pt *\";\n//cmdline = \"set \"+\"sheet\"+\" \"+\"defaultcolor green\";\n//var control = SocialCalc.GetCurrentWorkBookControl();\n//alert('u reach sheet' + \" \"+control.workbook.sheetArr[\"sheet1\"].sheet);\n//cmdline = \"set \"+sheetobj+\" \"+\"font\"+\" \"+value;\n//cmdline=\"set \"+  control.workbook.sheetArr[\"sheet1\"].sheet+\" color blue\" ;\n\n\nreturn;\n\n}\n\n\nSocialCalc.EditorCut = function(editor, value) {\n   var result, cell, valueinfo, fch, type, value, oldvalue, cmdline;                                                \n   var sheetobj = editor.context.sheetobj;\n   var wval = editor.workingvalues;\n   if (SocialCalc.Callbacks && SocialCalc.Callbacks.IsCellEditable) {\n      if (!SocialCalc.Callbacks.IsCellEditable(editor)) {\n         return true;\n      }\n   }\n   if(value == \"a\"){\n      cmdline = \"cut \"+editCoord+\" all\";\n   }\n   else if(value==\"b\"){\n      cmdline = \"copy \"+editCoord+\" all\";\n   }\n   else if(value==\"c\"){\n      cmdline = \"paste \"+editCoord+\" all\";\n   }\n   else if(value==\"d\"){\n      cmdline = \"erase \"+editCoord+\" formulas\";\n   }\n   editor.EditorScheduleSheetCommands(cmdline, true, false);\n}\n\nSocialCalc.EditorClearSheet = function(editor, cell_to_clear) {\n//alert(\"clear\");\nvar  cmdline;\nvar coord=cell_to_clear;\ncmdline = \"erase \"+coord+\" formulas\";\n//console.log(cmdline);\neditor.EditorScheduleSheetCommands(cmdline, true, false);\n\n}\n\n\n                                                 \n                                                                                  \n                                                                                  \n                                                                                  \n                                                                                  \n                                                                                  \n//\n/*\n// SocialCalc Number Formatting Library\n//\n// Part of the SocialCalc package.\n//\n// (c) Copyright 2008 Socialtext, Inc.\n// All Rights Reserved.\n//\n// The contents of this file are subject to the Artistic License 2.0; you may not\n// use this file except in compliance with the License. You may obtain a copy of \n// the License at http://socialcalc.org/licenses/al-20/.\n//\n// Some of the other files in the SocialCalc package are licensed under\n// different licenses. Please note the licenses of the modules you use.\n//\n// Code History:\n//\n// Initially coded by Dan Bricklin of Software Garden, Inc., for Socialtext, Inc.\n// Based in part on the SocialCalc 1.1.0 code written in Perl.\n// The SocialCalc 1.1.0 code was:\n//    Portions (c) Copyright 2005, 2006, 2007 Software Garden, Inc.\n//    All Rights Reserved.\n//    Portions (c) Copyright 2007 Socialtext, Inc.\n//    All Rights Reserved.\n// The Perl SocialCalc started as modifications to the wikiCalc(R) program, version 1.0.\n// wikiCalc 1.0 was written by Software Garden, Inc.\n// Unless otherwise specified, referring to \"SocialCalc\" in comments refers to this\n// JavaScript version of the code, not the SocialCalc Perl code.\n//\n*/\n\n   var SocialCalc;\n   if (!SocialCalc) SocialCalc = {}; // May be used with other SocialCalc libraries or standalone\n\nSocialCalc.FormatNumber = {};\n\nSocialCalc.FormatNumber.format_definitions = {}; // Parsed formats are stored here globally\n\n// Most constants that are often customized for localization are in the SocialCalc.Constants module.\n// If you use this module standalone, provide at least the \"FormatNumber\" values.\n//\n\n// The following values may be customized externally for further localization of the format definitions themselves,\n// but that would make them incompatible with other uses and is discouraged.\n//\n\nSocialCalc.FormatNumber.separatorchar = \",\";\nSocialCalc.FormatNumber.decimalchar = \".\";\nSocialCalc.FormatNumber.daynames = [\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\"];\nSocialCalc.FormatNumber.daynames3 = [\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"];\nSocialCalc.FormatNumber.monthnames3 = [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"];\nSocialCalc.FormatNumber.monthnames = [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\",\n                                      \"October\", \"November\", \"December\"];\n\nSocialCalc.FormatNumber.allowedcolors =\n   {BLACK: \"#000000\", BLUE: \"#0000FF\", CYAN: \"#00FFFF\", GREEN: \"#00FF00\", MAGENTA: \"#FF00FF\",\n    RED: \"#FF0000\", WHITE: \"#FFFFFF\", YELLOW: \"#FFFF00\"};\n\nSocialCalc.FormatNumber.alloweddates =\n   {H: \"h]\", M: \"m]\", MM: \"mm]\", S: \"s]\", SS: \"ss]\"};\n\n// Other constants\n\nSocialCalc.FormatNumber.commands =\n   {copy: 1, color: 2, integer_placeholder: 3, fraction_placeholder: 4, decimal: 5,\n    currency: 6, general:7, separator: 8, date: 9, comparison: 10, section: 11, style: 12};\n\nSocialCalc.FormatNumber.datevalues = {julian_offset: 2415019, seconds_in_a_day: 24 * 60 * 60, seconds_in_an_hour: 60 * 60};\n\n/* *******************\n\n result = SocialCalc.FormatNumber.formatNumberWithFormat = function(rawvalue, format_string, currency_char)\n\n************************* */\n\nSocialCalc.FormatNumber.formatNumberWithFormat = function(rawvalue, format_string, currency_char) {\n\n   var scc = SocialCalc.Constants;\n   var scfn = SocialCalc.FormatNumber;\n\n   var op, operandstr, fromend, cval, operandstrlc;\n   var startval, estartval;\n   var hrs, mins, secs, ehrs, emins, esecs, ampmstr, ymd;\n   var minOK, mpos;\n   var result=\"\";\n   var thisformat;\n   var section, gotcomparison, compop, compval, cpos, oppos;\n   var sectioninfo;\n   var i, decimalscale, scaledvalue, strvalue, strparts, integervalue, fractionvalue;\n   var integerdigits2, integerpos, fractionpos, textcolor, textstyle, separatorchar, decimalchar;\n   var value; // working copy to change sign, etc.\n\n   rawvalue = rawvalue-0; // make sure a number\n   value = rawvalue;\n   if (!isFinite(value)) return \"NaN\";\n\n   var negativevalue = value < 0 ? 1 : 0; // determine sign, etc.\n   if (negativevalue) value = -value;\n   var zerovalue = value == 0 ? 1 : 0;\n\n   currency_char = currency_char || scc.FormatNumber_DefaultCurrency;\n\n   scfn.parse_format_string(scfn.format_definitions, format_string); // make sure format is parsed\n   thisformat = scfn.format_definitions[format_string]; // Get format structure\n\n   if (!thisformat) throw \"Format not parsed error!\";\n\n   section = thisformat.sectioninfo.length - 1; // get number of sections - 1\n\n   if (thisformat.hascomparison) { // has comparisons - determine which section\n      section = 0; // set to which section we will use\n      gotcomparison = 0; // this section has no comparison\n      for (cpos=0; ;cpos++) { // scan for comparisons\n         op = thisformat.operators[cpos];\n         operandstr = thisformat.operands[cpos]; // get next operator and operand\n         if (!op) { // at end with no match\n            if (gotcomparison) { // if comparison but no match\n               format_string = \"General\"; // use default of General\n               scfn.parse_format_string(scfn.format_definitions, format_string);\n               thisformat = scfn.format_definitions[format_string];\n               section = 0;\n               }\n            break; // if no comparision, matches on this section\n            }\n         if (op == scfn.commands.section) { // end of section\n            if (!gotcomparison) { // no comparison, so it's a match\n               break;\n               }\n            gotcomparison = 0;\n            section++; // check out next one\n            continue;\n            }\n         if (op == scfn.commands.comparison) { // found a comparison - do we meet it?\n            i=operandstr.indexOf(\":\");\n            compop=operandstr.substring(0,i);\n            compval=operandstr.substring(i+1)-0;\n            if ((compop == \"<\" && rawvalue < compval) ||\n                (compop == \"<=\" && rawvalue <= compval) ||\n                (compop == \"=\" && rawvalue == compval) ||\n                (compop == \"<>\" && rawvalue != compval) ||\n                (compop == \">=\" && rawvalue >= compval) ||\n                (compop == \">\" && rawvalue > compval)) { // a match\n               break;\n               }\n            gotcomparison = 1;\n            }\n         }\n      }\n   else if (section > 0) { // more than one section (separated by \";\")\n      if (section == 1) { // two sections\n         if (negativevalue) {\n            negativevalue = 0; // sign will provided by section, not automatically\n            section = 1; // use second section for negative values\n            }\n         else {\n            section = 0; // use first for all others\n            }\n         }\n      else if (section == 2) { // three sections\n         if (negativevalue) {\n            negativevalue = 0; // sign will provided by section, not automatically\n            section = 1; // use second section for negative values\n            }\n         else if (zerovalue) {\n            section = 2; // use third section for zero values\n            }\n         else {\n            section = 0; // use first for positive\n            }\n         }\n      }\n\n   sectioninfo = thisformat.sectioninfo[section]; // look at values for our section\n\n   if (sectioninfo.commas > 0) { // scale by thousands\n      for (i=0; i<sectioninfo.commas; i++) {\n         value /= 1000;\n         }\n      }\n   if (sectioninfo.percent > 0) { // do percent scaling\n      for (i=0; i<sectioninfo.percent; i++) {\n         value *= 100;\n         }\n      }\n\n   decimalscale = 1; // cut down to required number of decimal digits\n   for (i=0; i<sectioninfo.fractiondigits; i++) {\n      decimalscale *= 10;\n      }\n   scaledvalue = Math.floor(value * decimalscale + 0.5);\n   scaledvalue = scaledvalue / decimalscale;\n\n   if (typeof scaledvalue != \"number\") return \"NaN\";\n   if (!isFinite(scaledvalue)) return \"NaN\";\n\n   strvalue = scaledvalue+\"\"; // convert to string (Number.toFixed doesn't do all we need)\n\n//   strvalue = value.toFixed(sectioninfo.fractiondigits); // cut down to required number of decimal digits\n                                                         // and convert to string\n\n   if (scaledvalue == 0 && (sectioninfo.fractiondigits || sectioninfo.integerdigits)) {\n      negativevalue = 0; // no \"-0\" unless using multiple sections or General\n      }\n\n   if (strvalue.indexOf(\"e\")>=0) { // converted to scientific notation\n      return rawvalue+\"\"; // Just return plain converted raw value\n      }\n\n   strparts=strvalue.match(/^\\+{0,1}(\\d*)(?:\\.(\\d*)){0,1}$/); // get integer and fraction parts\n   if (!strparts) return \"NaN\"; // if not a number\n   integervalue = strparts[1];\n   if (!integervalue || integervalue==\"0\") integervalue=\"\";\n   fractionvalue = strparts[2];\n   if (!fractionvalue) fractionvalue = \"\";\n\n   if (sectioninfo.hasdate) { // there are date placeholders\n      if (rawvalue < 0) { // bad date\n         return \"??-???-??&nbsp;??:??:??\";\n         }\n      startval = (rawvalue-Math.floor(rawvalue)) * scfn.datevalues.seconds_in_a_day; // get date/time parts\n      estartval = rawvalue * scfn.datevalues.seconds_in_a_day; // do elapsed time version, too\n      hrs = Math.floor(startval / scfn.datevalues.seconds_in_an_hour);\n      ehrs = Math.floor(estartval / scfn.datevalues.seconds_in_an_hour);\n      startval = startval - hrs * scfn.datevalues.seconds_in_an_hour;\n      mins = Math.floor(startval / 60);\n      emins = Math.floor(estartval / 60);\n      secs = startval - mins * 60;\n      decimalscale = 1; // round appropriately depending if there is ss.0\n      for (i=0; i<sectioninfo.fractiondigits; i++) {\n         decimalscale *= 10;\n         }\n      secs = Math.floor(secs * decimalscale + 0.5);\n      secs = secs / decimalscale;\n      esecs = Math.floor(estartval * decimalscale + 0.5);\n      esecs = esecs / decimalscale;\n      if (secs >= 60) { // handle round up into next second, minute, etc.\n         secs = 0;\n         mins++; emins++;\n         if (mins >= 60) {\n            mins = 0;\n            hrs++; ehrs++;\n            if (hrs >= 24) {\n               hrs = 0;\n               rawvalue++;\n               }\n            }\n         }\n      fractionvalue = (secs-Math.floor(secs))+\"\"; // for \"hh:mm:ss.000\"\n      fractionvalue = fractionvalue.substring(2); // skip \"0.\"\n\n      ymd = SocialCalc.FormatNumber.convert_date_julian_to_gregorian(Math.floor(rawvalue+scfn.datevalues.julian_offset));\n\n      minOK = 0; // says \"m\" can be minutes if true\n      mspos = sectioninfo.sectionstart; // m scan position in ops\n      for ( ; ; mspos++) { // scan for \"m\" and \"mm\" to see if any minutes fields, and am/pm\n         op = thisformat.operators[mspos];\n         operandstr = thisformat.operands[mspos]; // get next operator and operand\n         if (!op) break; // don't go past end\n         if (op==scfn.commands.section) break;\n         if (op==scfn.commands.date) {\n            if ((operandstr.toLowerCase()==\"am/pm\" || operandstr.toLowerCase()==\"a/p\") && !ampmstr) {\n               if (hrs >= 12) {\n                  hrs -= 12;\n                  ampmstr = operandstr.toLowerCase()==\"a/p\" ? scc.s_FormatNumber_pm1 : scc.s_FormatNumber_pm; // \"P\" : \"PM\";\n                  }\n               else {\n                  ampmstr = operandstr.toLowerCase()==\"a/p\" ? scc.s_FormatNumber_am1 : scc.s_FormatNumber_am; // \"A\" : \"AM\";\n                  }\n               if (operandstr.indexOf(ampmstr)<0)\n                  ampmstr = ampmstr.toLowerCase(); // have case match case in format\n               }\n            if (minOK && (operandstr==\"m\" || operandstr==\"mm\")) {\n               thisformat.operands[mspos] += \"in\"; // turn into \"min\" or \"mmin\"\n               }\n            if (operandstr.charAt(0)==\"h\") {\n               minOK = 1; // m following h or hh or [h] is minutes not months\n               }\n            else {\n               minOK = 0;\n               }\n            }\n         else if (op!=scfn.commands.copy) { // copying chars can be between h and m\n            minOK = 0;\n            }\n         }\n      minOK = 0;\n      for (--mspos; ; mspos--) { // scan other way for s after m\n         op = thisformat.operators[mspos];\n         operandstr = thisformat.operands[mspos]; // get next operator and operand\n         if (!op) break; // don't go past end\n         if (op==scfn.commands.section) break;\n         if (op==scfn.commands.date) {\n            if (minOK && (operandstr==\"m\" || operandstr==\"mm\")) {\n               thisformat.operands[mspos] += \"in\"; // turn into \"min\" or \"mmin\"\n               }\n            if (operandstr==\"ss\") {\n               minOK = 1; // m before ss is minutes not months\n               }\n            else {\n               minOK = 0;\n               }\n            }\n         else if (op!=scfn.commands.copy) { // copying chars can be between ss and m\n            minOK = 0;\n            }\n         }\n      }\n\n   integerdigits2 = 0; // init counters, etc.\n   integerpos = 0;\n   fractionpos = 0;\n   textcolor = \"\";\n   textstyle = \"\";\n   separatorchar = scc.FormatNumber_separatorchar;\n   if (separatorchar.indexOf(\" \")>=0) separatorchar = separatorchar.replace(/ /g, \"&nbsp;\");\n   decimalchar = scc.FormatNumber_decimalchar;\n   if (decimalchar.indexOf(\" \")>=0) decimalchar = decimalchar.replace(/ /g, \"&nbsp;\");\n\n   oppos = sectioninfo.sectionstart;\n\n   while (op = thisformat.operators[oppos]) { // execute format\n      operandstr = thisformat.operands[oppos++]; // get next operator and operand\n\n      if (op == scfn.commands.copy) { // put char in result\n         result += operandstr;\n         }\n\n      else if (op == scfn.commands.color) { // set color\n         textcolor = operandstr;\n         }\n\n      else if (op == scfn.commands.style) { // set style\n         textstyle = operandstr;\n         }\n\n      else if (op == scfn.commands.integer_placeholder) { // insert number part\n         if (negativevalue) {\n            result += \"-\";\n            negativevalue = 0;\n            }\n         integerdigits2++;\n         if (integerdigits2 == 1) { // first one\n            if (integervalue.length > sectioninfo.integerdigits) { // see if integer wider than field\n               for (;integerpos < (integervalue.length - sectioninfo.integerdigits); integerpos++) {\n                  result += integervalue.charAt(integerpos);\n                  if (sectioninfo.thousandssep) { // see if this is a separator position\n                     fromend = integervalue.length - integerpos - 1;\n                     if (fromend > 2 && fromend % 3 == 0) {\n                        result += separatorchar;\n                        }\n                     }\n                  }\n               }\n            }\n         if (integervalue.length < sectioninfo.integerdigits\n             && integerdigits2 <= sectioninfo.integerdigits - integervalue.length) { // field is wider than value\n            if (operandstr == \"0\" || operandstr == \"?\") { // fill with appropriate characters\n               result += operandstr == \"0\" ? \"0\" : \"&nbsp;\";\n               if (sectioninfo.thousandssep) { // see if this is a separator position\n                  fromend = sectioninfo.integerdigits - integerdigits2;\n                  if (fromend > 2 && fromend % 3 == 0) {\n                     result += separatorchar;\n                     }\n                  }\n               }\n            }\n         else { // normal integer digit - add it\n            result += integervalue.charAt(integerpos);\n            if (sectioninfo.thousandssep) { // see if this is a separator position\n               fromend = integervalue.length - integerpos - 1;\n               if (fromend > 2 && fromend % 3 == 0) {\n                  result += separatorchar;\n                  }\n               }\n            integerpos++;\n            }\n         }\n      else if (op == scfn.commands.fraction_placeholder) { // add fraction part of number\n         if (fractionpos >= fractionvalue.length) {\n            if (operandstr == \"0\" || operandstr == \"?\") {\n               result += operandstr == \"0\" ? \"0\" : \"&nbsp;\";\n               }\n            }\n         else {\n            result += fractionvalue.charAt(fractionpos);\n            }\n         fractionpos++;\n         }\n\n      else if (op == scfn.commands.decimal) { // decimal point\n         if (negativevalue) {\n            result += \"-\";\n            negativevalue = 0;\n            }\n         result += decimalchar;\n         }\n\n      else if (op == scfn.commands.currency) { // currency symbol\n         if (negativevalue) {\n            result += \"-\";\n            negativevalue = 0;\n            }\n         result += operandstr;\n         }\n\n      else if (op == scfn.commands.general) { // insert \"General\" conversion\n\n         // *** Cut down number of significant digits to avoid floating point artifacts:\n\n         if (value!=0) { // only if non-zero\n            var factor = Math.floor(Math.LOG10E * Math.log(value)); // get integer magnitude as a power of 10\n            factor = Math.pow(10, 13-factor); // turn into scaling factor\n            value = Math.floor(factor * value + 0.5)/factor; // scale positive value, round, undo scaling\n            if (!isFinite(value)) return \"NaN\";\n            }\n         if (negativevalue) {\n            result += \"-\";\n            }\n         strvalue = value+\"\"; // convert original value to string\n         if (strvalue.indexOf(\"e\")>=0) { // converted to scientific notation\n            result += strvalue;\n            continue;\n            }\n         strparts=strvalue.match(/^\\+{0,1}(\\d*)(?:\\.(\\d*)){0,1}$/); // get integer and fraction parts\n         integervalue = strparts[1];\n         if (!integervalue || integervalue==\"0\") integervalue=\"\";\n         fractionvalue = strparts[2];\n         if (!fractionvalue) fractionvalue = \"\";\n         integerpos = 0;\n         fractionpos = 0;\n         if (integervalue.length) {\n            for (;integerpos < integervalue.length; integerpos++) {\n               result += integervalue.charAt(integerpos);\n               if (sectioninfo.thousandssep) { // see if this is a separator position\n                  fromend = integervalue.length - integerpos - 1;\n                  if (fromend > 2 && fromend % 3 == 0) {\n                     result += separatorchar;\n                     }\n                  }\n               }\n             }\n         else {\n            result += \"0\";\n            }\n         if (fractionvalue.length) {\n            result += decimalchar;\n            for (;fractionpos < fractionvalue.length; fractionpos++) {\n               result += fractionvalue.charAt(fractionpos);\n               }\n            }\n         }\n      else if (op==scfn.commands.date) { // date placeholder\n         operandstrlc = operandstr.toLowerCase();\n         if (operandstrlc==\"y\" || operandstrlc==\"yy\") {\n            result += (ymd.year+\"\").substring(2);\n            }\n         else if (operandstrlc==\"yyyy\") {\n            result += ymd.year+\"\";\n            }\n         else if (operandstrlc==\"d\") {\n            result += ymd.day+\"\";\n            }\n         else if (operandstrlc==\"dd\") {\n            cval = 1000 + ymd.day;\n            result += (cval+\"\").substr(2);\n            }\n         else if (operandstrlc==\"ddd\") {\n            cval = Math.floor(rawvalue+6) % 7;\n            result += scc.s_FormatNumber_daynames3[cval];\n            }\n         else if (operandstrlc==\"dddd\") {\n            cval = Math.floor(rawvalue+6) % 7;\n            result += scc.s_FormatNumber_daynames[cval];\n            }\n         else if (operandstrlc==\"m\") {\n            result += ymd.month+\"\";\n            }\n         else if (operandstrlc==\"mm\") {\n            cval = 1000 + ymd.month;\n            result += (cval+\"\").substr(2);\n            }\n         else if (operandstrlc==\"mmm\") {\n            result += scc.s_FormatNumber_monthnames3[ymd.month-1];\n            }\n         else if (operandstrlc==\"mmmm\") {\n            result += scc.s_FormatNumber_monthnames[ymd.month-1];\n            }\n         else if (operandstrlc==\"mmmmm\") {\n            result += scc.s_FormatNumber_monthnames[ymd.month-1].charAt(0);\n            }\n         else if (operandstrlc==\"h\") {\n            result += hrs+\"\";\n            }\n         else if (operandstrlc==\"h]\") {\n            result += ehrs+\"\";\n            }\n         else if (operandstrlc==\"mmin\") {\n            cval = (1000 + mins)+\"\";\n            result += cval.substr(2);\n            }\n         else if (operandstrlc==\"mm]\") {\n            if (emins < 100) {\n               cval = (1000 + emins)+\"\";\n               result += cval.substr(2);\n               }\n            else {\n               result += emins+\"\";\n               }\n            }\n         else if (operandstrlc==\"min\") {\n            result += mins+\"\";\n            }\n         else if (operandstrlc==\"m]\") {\n            result += emins+\"\";\n            }\n         else if (operandstrlc==\"hh\") {\n            cval = (1000 + hrs)+\"\";\n            result += cval.substr(2);\n            }\n         else if (operandstrlc==\"s\") {\n            cval = Math.floor(secs);\n            result += cval+\"\";\n            }\n         else if (operandstrlc==\"ss\") {\n            cval = (1000 + Math.floor(secs))+\"\";\n            result += cval.substr(2);\n            }\n         else if (operandstrlc==\"am/pm\" || operandstrlc==\"a/p\") {\n            result += ampmstr;\n            }\n         else if (operandstrlc==\"ss]\") {\n            if (esecs < 100) {\n               cval = (1000 + Math.floor(esecs))+\"\";\n               result += cval.substr(2);\n               }\n            else {\n               cval = Math.floor(esecs);\n               result += cval+\"\";\n               }\n            }\n         }\n      else if (op == scfn.commands.section) { // end of section\n         break;\n         }\n\n      else if (op == scfn.commands.comparison) { // ignore\n         continue;\n         }\n\n      else {\n         result += \"!! Parse error !!\";\n         }\n      }\n\n   if (textcolor) {\n      result = '<span style=\"color:'+textcolor+';\">'+result+'</span>';\n      }\n   if (textstyle) {\n      result = '<span style=\"'+textstyle+';\">'+result+'</span>';\n      }\n\n   return result;\n\n   };\n\n/* *******************\n\n SocialCalc.FormatNumber.parse_format_string(format_defs, format_string)\n\n Takes a format string (e.g., \"#,##0.00_);(#,##0.00)\") and fills in format_defs with the parsed info\n\n format_defs\n    [\"#,##0.0\"]->{} - elements in the hash are one hash for each format\n       .operators->[] - array of operators from parsing the format string (each a number)\n       .operands->[] - array of corresponding operators (each usually a string)\n       .sectioninfo->[] - one hash for each section of the format\n          .start\n          .integerdigits\n          .fractiondigits\n          .commas\n          .percent\n          .thousandssep\n          .hasdates\n       .hascomparison - true if any section has [<100], etc.\n\n************************* */\n\nSocialCalc.FormatNumber.parse_format_string = function(format_defs, format_string) {\n\n   var scfn = SocialCalc.FormatNumber;\n\n   var thisformat, section, sectionfinfo;\n   var integerpart = 1; // start out in integer part\n   var lastwasinteger; // last char was an integer placeholder\n   var lastwasslash; // last char was a backslash - escaping following character\n   var lastwasasterisk; // repeat next char\n   var lastwasunderscore; // last char was _ which picks up following char for width\n   var inquote, quotestr; // processing a quoted string\n   var inbracket, bracketstr, bracketdata; // processing a bracketed string\n   var ingeneral, gpos; // checks for characters \"General\"\n   var ampmstr, part; // checks for characters \"A/P\" and \"AM/PM\"\n   var indate; // keeps track of date/time placeholders\n   var chpos; // character position being looked at\n   var ch; // character being looked at\n\n   if (format_defs[format_string]) return; // already defined - nothing to do\n\n   thisformat = {operators: [], operands: [], sectioninfo: [{}]}; // create info structure for this format\n   format_defs[format_string] = thisformat; // add to other format definitions\n\n   section = 0; // start with section 0\n   sectioninfo = thisformat.sectioninfo[section]; // get reference to info for current section\n   sectioninfo.sectionstart = 0; // position in operands that starts this section\n   sectioninfo.integerdigits = 0; // number of integer-part placeholders\n   sectioninfo.fractiondigits = 0; // fraction placeholders\n   sectioninfo.commas = 0; // commas encountered, to handle scaling\n   sectioninfo.percent = 0; // times to scale by 100\n\n   for (chpos=0; chpos<format_string.length; chpos++) { // parse\n      ch = format_string.charAt(chpos); // get next char to examine\n      if (inquote) {\n         if (ch == '\"') {\n            inquote = 0;\n            thisformat.operators.push(scfn.commands.copy);\n            thisformat.operands.push(quotestr);\n            continue;\n            }\n         quotestr += ch;\n         continue;\n         }\n      if (inbracket) {\n         if (ch==']') {\n            inbracket = 0;\n            bracketdata=SocialCalc.FormatNumber.parse_format_bracket(bracketstr);\n            if (bracketdata.operator==scfn.commands.separator) {\n               sectioninfo.thousandssep = 1; // explicit [,]\n               continue;\n               }\n            if (bracketdata.operator==scfn.commands.date) {\n               sectioninfo.hasdate = 1;\n               }\n            if (bracketdata.operator==scfn.commands.comparison) {\n               thisformat.hascomparison = 1;\n               }\n            thisformat.operators.push(bracketdata.operator);\n            thisformat.operands.push(bracketdata.operand);\n            continue;\n            }\n         bracketstr += ch;\n         continue;\n         }\n      if (lastwasslash) {\n         thisformat.operators.push(scfn.commands.copy);\n         thisformat.operands.push(ch);\n         lastwasslash=false;\n         continue;\n         }\n      if (lastwasasterisk) {\n         thisformat.operators.push(scfn.commands.copy);\n         thisformat.operands.push(ch+ch+ch+ch+ch); // do 5 of them since no real tabs\n         lastwasasterisk=false;\n         continue;\n         }\n      if (lastwasunderscore) {\n         thisformat.operators.push(scfn.commands.copy);\n         thisformat.operands.push(\"&nbsp;\");\n         lastwasunderscore=false;\n         continue;\n         }\n      if (ingeneral) {\n         if (\"general\".charAt(ingeneral)==ch.toLowerCase()) {\n            ingeneral++;\n            if (ingeneral == 7) {\n               thisformat.operators.push(scfn.commands.general);\n               thisformat.operands.push(ch);\n               ingeneral=0;\n               }\n            continue;\n            }\n         ingeneral = 0;\n         }\n      if (indate) { // last char was part of a date placeholder\n         if (indate.charAt(0)==ch) { // another of the same char\n            indate += ch; // accumulate it\n            continue;\n            }\n         thisformat.operators.push(scfn.commands.date); // something else, save date info\n         thisformat.operands.push(indate);\n         sectioninfo.hasdate=1;\n         indate = \"\";\n         }\n      if (ampmstr) {\n         ampmstr += ch;\n         part=ampmstr.toLowerCase();\n         if (part!=\"am/pm\".substring(0,part.length) && part!=\"a/p\".substring(0,part.length)) {\n            ampstr=\"\";\n            }\n         else if (part==\"am/pm\" || part==\"a/p\") {\n            thisformat.operators.push(scfn.commands.date);\n            thisformat.operands.push(ampmstr);\n            ampmstr = \"\";\n            }\n         continue;\n         }\n      if (ch==\"#\" || ch==\"0\" || ch==\"?\") { // placeholder\n         if (integerpart) {\n            sectioninfo.integerdigits++;\n            if (sectioninfo.commas) { // comma inside of integer placeholders\n               sectioninfo.thousandssep = 1; // any number is thousands separator\n               sectioninfo.commas = 0; // reset count of \"thousand\" factors\n               }\n            lastwasinteger = 1;\n            thisformat.operators.push(scfn.commands.integer_placeholder);\n            thisformat.operands.push(ch);\n            }\n         else {\n            sectioninfo.fractiondigits++;\n            thisformat.operators.push(scfn.commands.fraction_placeholder);\n            thisformat.operands.push(ch);\n            }\n         }\n      else if (ch==\".\") { // decimal point\n         lastwasinteger = 0;\n         thisformat.operators.push(scfn.commands.decimal);\n         thisformat.operands.push(ch);\n         integerpart = 0;\n         }\n      else if (ch=='$') { // currency char\n         lastwasinteger = 0;\n         thisformat.operators.push(scfn.commands.currency);\n         thisformat.operands.push(ch);\n         }\n      else if (ch==\",\") {\n         if (lastwasinteger) {\n            sectioninfo.commas++;\n            }\n         else {\n            thisformat.operators.push(scfn.commands.copy);\n            thisformat.operands.push(ch);\n            }\n         }\n      else if (ch==\"%\") {\n         lastwasinteger = 0;\n         sectioninfo.percent++;\n         thisformat.operators.push(scfn.commands.copy);\n         thisformat.operands.push(ch);\n         }\n      else if (ch=='\"') {\n         lastwasinteger = 0;\n         inquote = 1;\n         quotestr = \"\";\n         }\n      else if (ch=='[') {\n         lastwasinteger = 0;\n         inbracket = 1;\n         bracketstr = \"\";\n         }\n      else if (ch=='\\\\') {\n         lastwasslash = 1;\n         lastwasinteger = 0;\n         }\n      else if (ch=='*') {\n         lastwasasterisk = 1;\n         lastwasinteger = 0;\n         }\n      else if (ch=='_') {\n         lastwasunderscore = 1;\n         lastwasinteger = 0;\n         }\n      else if (ch==\";\") {\n         section++; // start next section\n         thisformat.sectioninfo[section] = {}; // create a new section\n         sectioninfo = thisformat.sectioninfo[section]; // get reference to info for current section\n         sectioninfo.sectionstart = 1 + thisformat.operators.length; // remember where it starts\n         sectioninfo.integerdigits = 0; // number of integer-part placeholders\n         sectioninfo.fractiondigits = 0; // fraction placeholders\n         sectioninfo.commas = 0; // commas encountered, to handle scaling\n         sectioninfo.percent = 0; // times to scale by 100\n         integerpart = 1; // reset for new section\n         lastwasinteger = 0;\n         thisformat.operators.push(scfn.commands.section);\n         thisformat.operands.push(ch);\n         }\n      else if (ch.toLowerCase()==\"g\") {\n         ingeneral = 1;\n         lastwasinteger = 0;\n         }\n      else if (ch.toLowerCase()==\"a\") {\n         ampmstr = ch;\n         lastwasinteger = 0;\n         }\n      else if (\"dmyhHs\".indexOf(ch)>=0) {\n         indate = ch;\n         }\n      else {\n         lastwasinteger = 0;\n         thisformat.operators.push(scfn.commands.copy);\n         thisformat.operands.push(ch);\n         }\n      }\n\n   if (indate) { // last char was part of unsaved date placeholder\n      thisformat.operators.push(scfn.commands.date);\n      thisformat.operands.push(indate);\n      sectioninfo.hasdate = 1;\n      }\n\n   return;\n\n   }\n\n\n/* *******************\n\n bracketdata = SocialCalc.FormatNumber.parse_format_bracket(bracketstr)\n\n Takes a bracket contents (e.g., \"RED\", \">10\") and returns an operator and operand\n\n bracketdata->{}\n    .operator\n    .operand\n\n************************* */\n\nSocialCalc.FormatNumber.parse_format_bracket = function(bracketstr) {\n\n   var scfn = SocialCalc.FormatNumber;\n   var scc = SocialCalc.Constants;\n\n   var bracketdata={};\n   var parts;\n\n   if (bracketstr.charAt(0)=='$') { // currency\n      bracketdata.operator = scfn.commands.currency;\n      parts=bracketstr.match(/^\\$(.+?)(\\-.+?){0,1}$/);\n      if (parts) {\n         bracketdata.operand = parts[1] || scc.FormatNumber_defaultCurrency || '$';\n         }\n      else {\n         bracketdata.operand = bracketstr.substring(1) || scc.FormatNumber_defaultCurrency || '$';\n         }\n      }\n   else if (bracketstr=='?$') {\n      bracketdata.operator = scfn.commands.currency;\n      bracketdata.operand = '[?$]';\n      }\n   else if (scfn.allowedcolors[bracketstr.toUpperCase()]) {\n      bracketdata.operator = scfn.commands.color;\n      bracketdata.operand = scfn.allowedcolors[bracketstr.toUpperCase()];\n      }\n   else if (parts=bracketstr.match(/^style=([^\"]*)$/)) { // [style=...]\n      bracketdata.operator = scfn.commands.style;\n      bracketdata.operand = parts[1];\n      }\n   else if (bracketstr==\",\") {\n      bracketdata.operator = scfn.commands.separator;\n      bracketdata.operand = bracketstr;\n      }\n   else if (scfn.alloweddates[bracketstr.toUpperCase()]) {\n      bracketdata.operator = scfn.commands.date;\n      bracketdata.operand = scfn.alloweddates[bracketstr.toUpperCase()];\n      }\n   else if (parts=bracketstr.match(/^[<>=]/)) { // comparison operator\n      parts=bracketstr.match(/^([<>=]+)(.+)$/); // split operator and value\n      bracketdata.operator = scfn.commands.comparison;\n      bracketdata.operand = parts[1]+\":\"+parts[2];\n      }\n   else { // unknown bracket\n      bracketdata.operator = scfn.commands.copy;\n      bracketdata.operand = \"[\"+bracketstr+\"]\";\n      }\n\n   return bracketdata;\n\n   }\n\n/* *******************\n\n juliandate = SocialCalc.FormatNumber.convert_date_gregorian_to_julian(year, month, day)\n\n From: http://aa.usno.navy.mil/faq/docs/JD_Formula.html\n Uses: Fliegel, H. F. and van Flandern, T. C. (1968). Communications of the ACM, Vol. 11, No. 10 (October, 1968).\n Translated from the FORTRAN\n\n      I= YEAR\n      J= MONTH\n      K= DAY\nC\n      JD= K-32075+1461*(I+4800+(J-14)/12)/4+367*(J-2-(J-14)/12*12)\n     2    /12-3*((I+4900+(J-14)/12)/100)/4\n\n************************* */\n\nSocialCalc.FormatNumber.convert_date_gregorian_to_julian = function(year, month, day) {\n\n   var juliandate;\n\n   juliandate = day-32075+SocialCalc.intFunc(1461*(year+4800+SocialCalc.intFunc((month-14)/12))/4);\n   juliandate += SocialCalc.intFunc(367*(month-2-SocialCalc.intFunc((month-14)/12)*12)/12);\n   juliandate = juliandate - SocialCalc.intFunc(3*SocialCalc.intFunc((year+4900+SocialCalc.intFunc((month-14)/12))/100)/4);\n\n   return juliandate;\n\n   }\n\n\n/* *******************\n\n ymd = SocialCalc.FormatNumber.convert_date_julian_to_gregorian(juliandate)\n\n ymd->{}\n    .year\n    .month\n    .day\n\n From: http://aa.usno.navy.mil/faq/docs/JD_Formula.html\n Uses: Fliegel, H. F. and van Flandern, T. C. (1968). Communications of the ACM, Vol. 11, No. 10 (October, 1968).\n Translated from the FORTRAN\n\n************************* */\n\nSocialCalc.FormatNumber.convert_date_julian_to_gregorian = function(juliandate) {\n\n   var L, N, I, J, K;\n\n   L = juliandate+68569;\n   N = Math.floor(4*L/146097);\n   L = L-Math.floor((146097*N+3)/4);\n   I = Math.floor(4000*(L+1)/1461001);\n   L = L-Math.floor(1461*I/4)+31;\n   J = Math.floor(80*L/2447);\n   K = L-Math.floor(2447*J/80);\n   L = Math.floor(J/11);\n   J = J+2-12*L;\n   I = 100*(N-49)+I+L;\n\n   return {year:I, month:J, day:K};\n\n   }\n\nSocialCalc.intFunc = function(n) {\n   if (n < 0) {\n      return -Math.floor(-n);\n      }\n   else {\n      return Math.floor(n);\n      }\n   }\n\n//\n/*\n// SocialCalc Spreadsheet Formula Library\n//\n// Part of the SocialCalc package\n//\n// (c) Copyright 2008 Socialtext, Inc.\n// All Rights Reserved.\n//\n// The contents of this file are subject to the Artistic License 2.0; you may not\n// use this file except in compliance with the License. You may obtain a copy of \n// the License at http://socialcalc.org/licenses/al-20/.\n//\n// Some of the other files in the SocialCalc package are licensed under\n// different licenses. Please note the licenses of the modules you use.\n//\n// Code History:\n//\n// Initially coded by Dan Bricklin of Software Garden, Inc., for Socialtext, Inc.\n// Based in part on the SocialCalc 1.1.0 code written in Perl.\n// The SocialCalc 1.1.0 code was:\n//    Portions (c) Copyright 2005, 2006, 2007 Software Garden, Inc.\n//    All Rights Reserved.\n//    Portions (c) Copyright 2007 Socialtext, Inc.\n//    All Rights Reserved.\n// The Perl SocialCalc started as modifications to the wikiCalc(R) program, version 1.0.\n// wikiCalc 1.0 was written by Software Garden, Inc.\n// Unless otherwise specified, referring to \"SocialCalc\" in comments refers to this\n// JavaScript version of the code, not the SocialCalc Perl code.\n//\n*/\n\n   var SocialCalc;\n   if (!SocialCalc) SocialCalc = {}; // May be used with other SocialCalc libraries or standalone\n                                     // In any case, requires SocialCalc.Constants.\n\nSocialCalc.Formula = {};\n\n//\n// Formula constants for parsing:\n//\n\n   SocialCalc.Formula.ParseState = {num: 1, alpha: 2, coord: 3, string: 4, stringquote: 5, numexp1: 6, numexp2: 7, alphanumeric: 8, specialvalue:9};\n\n   SocialCalc.Formula.TokenType = {num: 1, coord: 2, op: 3, name: 4, error: 5, string: 6, space: 7};\n\n   SocialCalc.Formula.CharClass = {num: 1, numstart: 2, op: 3, eof: 4, alpha: 5, incoord: 6, error: 7, quote: 8, space: 9, specialstart: 10};\n \n   SocialCalc.Formula.CharClassTable = {\n      \" \": 9, \"!\": 3, '\"': 8, \"#\": 10, \"$\":6, \"%\":3, \"&\":3, \"(\": 3, \")\": 3, \"*\": 3, \"+\": 3, \",\": 3, \"-\": 3, \".\": 2, \"/\": 3,\n       \"0\": 1, \"1\": 1, \"2\": 1, \"3\": 1, \"4\": 1, \"5\": 1, \"6\": 1, \"7\": 1, \"8\": 1, \"9\": 1,\n       \":\": 3, \"<\": 3, \"=\": 3, \">\": 3,\n       \"A\": 5, \"B\": 5, \"C\": 5, \"D\": 5, \"E\": 5, \"F\": 5, \"G\": 5, \"H\": 5, \"I\": 5, \"J\": 5, \"K\": 5, \"L\": 5, \"M\": 5, \"N\": 5,\n       \"O\": 5, \"P\": 5, \"Q\": 5, \"R\": 5, \"S\": 5, \"T\": 5, \"U\": 5, \"V\": 5, \"W\": 5, \"X\": 5, \"Y\": 5, \"Z\": 5,\n       \"^\": 3, \"_\": 5,\n       \"a\": 5, \"b\": 5, \"c\": 5, \"d\": 5, \"e\": 5, \"f\": 5, \"g\": 5, \"h\": 5, \"i\": 5, \"j\": 5, \"k\": 5, \"l\": 5, \"m\": 5, \"n\": 5,\n       \"o\": 5, \"p\": 5, \"q\": 5, \"r\": 5, \"s\": 5, \"t\": 5, \"u\": 5, \"v\": 5, \"w\": 5, \"x\": 5, \"y\": 5, \"z\": 5\n       };\n\n   SocialCalc.Formula.UpperCaseTable = {\n       \"a\": \"A\", \"b\": \"B\", \"c\": \"C\", \"d\": \"D\", \"e\": \"E\", \"f\": \"F\", \"g\": \"G\", \"h\": \"H\", \"i\": \"I\", \"j\": \"J\", \"k\": \"K\", \"l\": \"L\", \"m\": \"M\",\n       \"n\": \"N\", \"o\": \"O\", \"p\": \"P\", \"q\": \"Q\", \"r\": \"R\", \"s\": \"S\", \"t\": \"T\", \"u\": \"U\", \"v\": \"V\", \"w\": \"W\", \"x\": \"X\", \"y\": \"Y\", \"z\": \"Z\"\n       }\n\n   SocialCalc.Formula.SpecialConstants = { // names that turn into constants for name lookup\n      \"#NULL!\": \"0,e#NULL!\", \"#NUM!\": \"0,e#NUM!\", \"#DIV/0!\": \"0,e#DIV/0!\", \"#VALUE!\": \"0,e#VALUE!\",\n      \"#REF!\": \"0,e#REF!\", \"#NAME?\": \"0,e#NAME?\"};\n\n\n   // Operator Precedence table\n   //\n   // 1- !, 2- : ,, 3- M P, 4- %, 5- ^, 6- * /, 7- + -, 8- &, 9- < > = G(>=) L(<=) N(<>),\n   // Negative value means Right Associative\n\n   SocialCalc.Formula.TokenPrecedence = {\n      \"!\": 1,\n      \":\": 2, \",\": 2,\n      \"M\": -3, \"P\": -3,\n      \"%\": 4,\n      \"^\": 5,\n      \"*\": 6, \"/\": 6,\n      \"+\": 7, \"-\": 7,\n      \"&\": 8,\n      \"<\": 9, \">\": 9, \"G\": 9, \"L\": 9, \"N\": 9\n      };\n\n   // Convert one-char token text to input text:\n\n   SocialCalc.Formula.TokenOpExpansion = {'G': '>=', 'L': '<=', 'M': '-', 'N': '<>', 'P': '+'};\n\n   //\n   // Information about the resulting value types when doing operations on values (used by LookupResultType)\n   //\n   // Each object entry is an object with specific types with result type info as follows:\n   //\n   //    'type1a': '|type2a:resulta|type2b:resultb|...\n   //    Type of t* or n* matches any of those types not listed\n   //    Results may be a type or the numbers 1 or 2 specifying to return type1 or type2\n   \n\n   SocialCalc.Formula.TypeLookupTable = {\n       unaryminus: { 'n*': '|n*:1|', 'e*': '|e*:1|', 't*': '|t*:e#VALUE!|', 'b': '|b:n|'},\n       unaryplus: { 'n*': '|n*:1|', 'e*': '|e*:1|', 't*': '|t*:e#VALUE!|', 'b': '|b:n|'},\n       unarypercent: { 'n*': '|n:n%|n*:n|', 'e*': '|e*:1|', 't*': '|t*:e#VALUE!|', 'b': '|b:n|'},\n       plus: {\n                'n%': '|n%:n%|nd:n|nt:n|ndt:n|n$:n|n:n|n*:n|b:n|e*:2|t*:e#VALUE!|',\n                'nd': '|n%:n|nd:nd|nt:ndt|ndt:ndt|n$:n|n:nd|n*:n|b:n|e*:2|t*:e#VALUE!|',\n                'nt': '|n%:n|nd:ndt|nt:nt|ndt:ndt|n$:n|n:nt|n*:n|b:n|e*:2|t*:e#VALUE!|',\n                'ndt': '|n%:n|nd:ndt|nt:ndt|ndt:ndt|n$:n|n:ndt|n*:n|b:n|e*:2|t*:e#VALUE!|',\n                'n$': '|n%:n|nd:n|nt:n|ndt:n|n$:n$|n:n$|n*:n|b:n|e*:2|t*:e#VALUE!|',\n                'nl': '|n%:n|nd:n|nt:n|ndt:n|n$:n|n:n|n*:n|b:n|e*:2|t*:e#VALUE!|',\n                'n': '|n%:n|nd:nd|nt:nt|ndt:ndt|n$:n$|n:n|n*:n|b:n|e*:2|t*:e#VALUE!|',\n                'b': '|n%:n%|nd:nd|nt:nt|ndt:ndt|n$:n$|n:n|n*:n|b:n|e*:2|t*:e#VALUE!|',\n                't*': '|n*:e#VALUE!|t*:e#VALUE!|b:e#VALUE!|e*:2|',\n                'e*': '|e*:1|n*:1|t*:1|b:1|'\n               },\n       concat: {\n                't': '|t:t|th:th|tw:tw|tl:t|t*:2|e*:2|',\n                'th': '|t:th|th:th|tw:t|tl:th|t*:t|e*:2|',\n                'tw': '|t:tw|th:t|tw:tw|tl:tw|t*:t|e*:2|',\n                'tl': '|t:tl|th:th|tw:tw|tl:tl|t*:t|e*:2|',\n                'e*': '|e*:1|n*:1|t*:1|'\n               },\n       oneargnumeric: { 'n*': '|n*:n|', 'e*': '|e*:1|', 't*': '|t*:e#VALUE!|', 'b': '|b:n|'},\n       twoargnumeric: { 'n*': '|n*:n|t*:e#VALUE!|e*:2|', 'e*': '|e*:1|n*:1|t*:1|', 't*': '|t*:e#VALUE!|n*:e#VALUE!|e*:2|'},\n       propagateerror: { 'n*': '|n*:2|e*:2|', 'e*': '|e*:2|', 't*': '|t*:2|e*:2|', 'b': '|b:2|e*:2|'}\n      };\n\n/* *******************\n\n parseinfo = SocialCalc.Formula.ParseFormulaIntoTokens(line)\n\n Parses a text string as if it was a spreadsheet formula\n\n This uses a simple state machine run on each character in turn.\n States remember whether a number is being gathered, etc.\n The result is parseinfo which is an array with one entry for each token:\n   parseinfo[i] = {\n     text: \"the characters making up the parsed token\",\n     type: the type of the token (a number),\n     opcode: a single character version of an operator suitable for use in the\n                  precedence table and distinguishing between unary and binary + and -.\n\n************************* */\n\nSocialCalc.Formula.ParseFormulaIntoTokens = function(line) {\n\n   var i, ch, chclass, haddecimal, last_token, last_token_type, last_token_text, t;\n\n   var scf = SocialCalc.Formula;\n   var scc = SocialCalc.Constants;\n   var parsestate = scf.ParseState;\n   var tokentype = scf.TokenType;\n   var charclass = scf.CharClass;\n   var charclasstable = scf.CharClassTable;\n   var uppercasetable = scf.UpperCaseTable; // much faster than toUpperCase function\n   var pushtoken = scf.ParsePushToken;\n   var coordregex = /^\\$?[A-Z]{1,2}\\$?[1-9]\\d*$/i;\n\n   var parseinfo = [];\n   var str = \"\";\n   var state = 0;\n   var haddecimal = false;\n\n  for (i=0; i<=line.length; i++) {\n      if (i<line.length) {\n         ch = line.charAt(i);\n         cclass = charclasstable[ch];\n         }\n      else {\n         ch = \"\";\n         cclass = charclass.eof;\n         }\n\n      if (state == parsestate.num) {\n         if (cclass == charclass.num) {\n            str += ch;\n            }\n         else if (cclass == charclass.numstart && !haddecimal) {\n            haddecimal = true;\n            str += ch;\n            }\n         else if (ch == \"E\" || ch == \"e\") {\n            str += ch;\n            haddecimal = false;\n            state = parsestate.numexp1;\n            }\n         else { // end of number - save it\n            pushtoken(parseinfo, str, tokentype.num, 0);\n            haddecimal = false;\n            state = 0;\n            }\n         }\n\n      if (state == parsestate.numexp1) {\n         if (cclass == parsestate.num) {\n            state = parsestate.numexp2;\n            }\n         else if ((ch == '+' || ch == '-') && (uppercasetable[str.charAt(str.length-1)] == 'E')) {\n            str += ch;\n            }\n         else if (ch == 'E' || ch == 'e') {\n            ;\n            }\n         else {\n            pushtoken(parseinfo, scc.s_parseerrexponent, tokentype.error, 0);\n            state = 0;\n            }\n         }\n\n      if (state == parsestate.numexp2) {\n         if (cclass == charclass.num) {\n            str += ch;\n            }\n         else { // end of number - save it\n            pushtoken(parseinfo, str, tokentype.num, 0);\n            state = 0;\n            }\n         }\n\n      if (state == parsestate.alpha) {\n         if (cclass == charclass.num) {\n            state = parsestate.coord;\n            }\n         else if (cclass == charclass.alpha || ch == \".\") { // alpha may be letters, numbers, \"_\", or \".\"\n            str += ch;\n            }\n         else if (cclass == charclass.incoord) {\n            state = parsestate.coord;\n            }\n         else if (cclass == charclass.op || cclass == charclass.numstart\n                || cclass == charclass.space || cclass == charclass.eof) {\n            pushtoken(parseinfo, str.toUpperCase(), tokentype.name, 0);\n            state = 0;\n            }\n         else {\n            pushtoken(parseinfo, scc.s_parseerrchar, tokentype.error, 0);\n            state = 0;\n            }\n         }\n\n      if (state == parsestate.coord) {\n         if (cclass == charclass.num) {\n            str += ch;\n            }\n         else if (cclass == charclass.incoord) {\n            str += ch;\n            }\n         else if (cclass == charclass.alpha) {\n            state = parsestate.alphanumeric;\n            }\n         else if (cclass == charclass.op || cclass == charclass.numstart ||\n                  cclass == charclass.eof || cclass == charclass.space) {\n            if (coordregex.test(str)) {\n               t = tokentype.coord;\n               }\n            else {\n               t = tokentype.name;\n               }\n            pushtoken(parseinfo, str.toUpperCase(), t, 0);\n            state = 0;\n            }\n         else {\n            pushtoken(parseinfo, scc.s_parseerrchar, tokentype.error, 0);\n            state = 0;\n           }\n         }\n\n\n      if (state == parsestate.alphanumeric) {\n         if (cclass == charclass.num || cclass == charclass.alpha) {\n            str += ch;\n            }\n         else if (cclass == charclass.op || cclass == charclass.numstart\n                || cclass == charclass.space || cclass == charclass.eof) {\n            pushtoken(parseinfo, str.toUpperCase(), tokentype.name, 0);\n            state = 0;\n            }\n         else {\n            pushtoken(parseinfo, scc.s_parseerrchar, tokentype.error, 0);\n            state = 0;\n            }\n         }\n\n      if (state == parsestate.string) {\n         if (cclass == charclass.quote) {\n            state = parsestate.stringquote; // got quote in string: is it doubled (quote in string) or by itself (end of string)?\n            }\n         else if (cclass == charclass.eof) {\n            pushtoken(parseinfo, scc.s_parseerrstring, tokentype.error, 0);\n            state = 0;\n            }\n         else {\n            str += ch;\n            }\n         }\n      else if (state == parsestate.stringquote) { // note else if here\n         if (cclass == charclass.quote) {\n            str +='\"';\n            state = parsestate.string; // double quote: add one then continue getting string\n            }\n         else { // something else -- end of string\n            pushtoken(parseinfo, str, tokentype.string, 0);\n            state = 0; // drop through to process\n            }\n         }\n\n      else if (state == parsestate.specialvalue) { // special values like #REF!\n         if (str.charAt(str.length-1) == \"!\") { // done - save value as a name\n            pushtoken(parseinfo, str, tokentype.name, 0);\n            state = 0; // drop through to process\n            }\n         else if (cclass == charclass.eof) {\n            pushtoken(parseinfo, scc.s_parseerrspecialvalue, tokentype.error, 0);\n            state = 0;\n            }\n         else {\n            str += ch;\n            }\n         }\n\n      if (state == 0) {\n         if (cclass == charclass.num) {\n            str = ch;\n            state = parsestate.num;\n            }\n         else if (cclass == charclass.numstart) {\n            str = ch;\n            haddecimal = true;\n            state = parsestate.num;\n            }\n         else if (cclass == charclass.alpha || cclass == charclass.incoord) {\n            str = ch;\n            state = parsestate.alpha;\n            }\n         else if (cclass == charclass.specialstart) {\n            str = ch;\n            state = parsestate.specialvalue;\n            }\n         else if (cclass == charclass.op) {\n            str = ch;\n            if (parseinfo.length>0) {\n               last_token = parseinfo[parseinfo.length-1];\n               last_token_type = last_token.type;\n               last_token_text = last_token.text;\n               if (last_token_type == charclass.op) {\n                  if (last_token_text == '<' || last_token_text == \">\") {\n                     str = last_token_text + str;\n                     parseinfo.pop();\n                     if (parseinfo.length>0) {\n                        last_token = parseinfo[parseinfo.length-1];\n                        last_token_type = last_token.type;\n                        last_token_text = last_token.text;\n                        }\n                     else {\n                        last_token_type = charclass.eof;\n                        last_token_text = \"EOF\";\n                        }\n                     }\n                  }\n               }\n            else {\n               last_token_type = charclass.eof;\n               last_token_text = \"EOF\";\n               }\n            t = tokentype.op;\n            if ((parseinfo.length == 0)\n                || (last_token_type == charclass.op && last_token_text != ')' && last_token_text != '%')) { // Unary operator\n               if (str == '-') { // M is unary minus\n                  str = \"M\";\n                  ch = \"M\";\n                  }\n               else if (str == '+') { // P is unary plus\n                  str = \"P\";\n                  ch = \"P\";\n                  }\n               else if (str == ')' && last_token_text == '(') { // null arg list OK\n                  ;\n                  }\n               else if (str != '(') { // binary-op open-paren OK, others no\n                  t = tokentype.error;\n                  str = scc.s_parseerrtwoops;\n                  }\n               }\n            else if (str.length > 1) {\n               if (str == '>=') { // G is >=\n                  str = \"G\";\n                  ch = \"G\";\n                  }\n               else if (str == '<=') { // L is <=\n                  str = \"L\";\n                  ch = \"L\";\n                  }\n               else if (str == '<>') { // N is <>\n                  str = \"N\";\n                  ch = \"N\";\n                  }\n               else {\n                  t = tokentype.error;\n                  str = scc.s_parseerrtwoops;\n                  }\n               }\n            pushtoken(parseinfo, str, t, ch);\n            state = 0;\n            }\n         else if (cclass == charclass.quote) { // starting a string\n            str = \"\";\n            state = parsestate.string;\n            }\n         else if (cclass == charclass.space) { // store so can reconstruct spacing\n            pushtoken(parseinfo, \" \", tokentype.space, 0);\n            }\n         else if (cclass == charclass.eof) { // ignore -- needed to have extra loop to close out other things\n            }\n         else { // unknown class - such as unknown char\n            pushtoken(parseinfo, scc.s_parseerrchar, tokentype.error, 0);\n            }\n         }\n      }\n\n   return parseinfo;\n\n   }\n\nSocialCalc.Formula.ParsePushToken = function(parseinfo, ttext, ttype, topcode) {\n\n   parseinfo.push({text: ttext, type: ttype, opcode: topcode});\n\n   }\n\n/* *******************\n\n result = SocialCalc.Formula.evaluate_parsed_formula(parseinfo, sheet, allowrangereturn)\n\n Does the calculation expressed in a parsed formula, returning a value, its type, and error info\n returns: {value: value, type: valuetype, error: errortext}.\n\n If allowrangereturn is present and true, can return a range (e.g., \"A1:A10\" - translated from \"A1|A10|\")\n\n************************* */\n\nSocialCalc.Formula.evaluate_parsed_formula = function(parseinfo, sheet, allowrangereturn) {\n\n   var result;\n\n   var scf = SocialCalc.Formula;\n   var tokentype = scf.TokenType;\n\n   var revpolish;\n   var parsestack = [];\n\n   var errortext = \"\";\n\n   revpolish = scf.ConvertInfixToPolish(parseinfo); // result is either an array or a string with error text\n\n   result = scf.EvaluatePolish(parseinfo, revpolish, sheet, allowrangereturn);\n\n   return result;\n\n}\n\n//\n// revpolish = SocialCalc.Formula.ConvertInfixToPolish(parseinfo)\n//\n// Convert infix to reverse polish notation\n//\n// Returns revpolish array with a sequence of references to tokens by number if successful.\n// Errors return a string with the error.\n//\n// Based upon the algorithm shown in Wikipedia \"Reverse Polish notation\" article\n// and then enhanced for additional spreadsheet things\n//\n\nSocialCalc.Formula.ConvertInfixToPolish = function(parseinfo) {\n\n   var scf = SocialCalc.Formula;\n   var scc = SocialCalc.Constants;\n   var tokentype = scf.TokenType;\n   var token_precedence = scf.TokenPrecedence;\n\n   var revpolish = [];\n   var parsestack = [];\n\n   var errortext = \"\";\n\n   var function_start = -1;\n\n   var i, pii, ttype, ttext, tprecedence, tstackprecedence;\n\n   for (i=0; i<parseinfo.length; i++) {\n      pii = parseinfo[i];\n      ttype = pii.type;\n      ttext = pii.text;\n      if (ttype == tokentype.num || ttype == tokentype.coord || ttype == tokentype.string) {\n         revpolish.push(i);\n         }\n      else if (ttype == tokentype.name) {\n         parsestack.push(i);\n         revpolish.push(function_start);\n         }\n      else if (ttype == tokentype.space) { // ignore\n         continue;\n         }\n      else if (ttext == ',') {\n         while (parsestack.length && parseinfo[parsestack[parsestack.length-1]].text != \"(\") {\n            revpolish.push(parsestack.pop());\n            }\n         if (parsestack.length == 0) { // no ( -- error\n            errortext = scc.s_parseerrmissingopenparen;\n            break;\n            }\n         }\n      else if (ttext == '(') {\n         parsestack.push(i);\n         }\n      else if (ttext == ')') {\n         while (parsestack.length && parseinfo[parsestack[parsestack.length-1]].text != \"(\") {\n            revpolish.push(parsestack.pop());\n            }\n         if (parsestack.length == 0) { // no ( -- error\n            errortext = scc.s_parseerrcloseparennoopen;\n            break;\n            }\n         parsestack.pop();\n         if (parsestack.length && parseinfo[parsestack[parsestack.length-1]].type == tokentype.name) {\n            revpolish.push(parsestack.pop());\n            }\n         }\n      else if (ttype == tokentype.op) {\n         if (parsestack.length && parseinfo[parsestack[parsestack.length-1]].type == tokentype.name) {\n            revpolish.push(parsestack.pop());\n            }\n         while (parsestack.length && parseinfo[parsestack[parsestack.length-1]].type == tokentype.op\n                && parseinfo[parsestack[parsestack.length-1]].text != '(') {\n            tprecedence = token_precedence[pii.opcode];\n            tstackprecedence = token_precedence[parseinfo[parsestack[parsestack.length-1]].opcode];\n            if (tprecedence >= 0 && tprecedence < tstackprecedence) {\n               break;\n               }\n            else if (tprecedence < 0) {\n               tprecedence = -tprecedence;\n               if (tstackprecedence < 0) tstackprecedence = -tstackprecedence;\n               if (tprecedence <= tstackprecedence) {\n                  break;\n                  }\n               }\n            revpolish.push(parsestack.pop());\n            }\n         parsestack.push(i);\n         }\n      else if (ttype == tokentype.error) {\n         errortext = ttext;\n         break;\n         }\n      else {\n         errortext = \"Internal error while processing parsed formula. \";\n         break;\n         }\n      }\n   while (parsestack.length>0) {\n      if (parseinfo[parsestack[parsestack.length-1]].text == '(') {\n         errortext = scc.s_parseerrmissingcloseparen;\n         break;\n         }\n      revpolish.push(parsestack.pop());\n      }\n\n   if (errortext) {\n      return errortext;\n      }\n\n   return revpolish;\n\n   }\n\n\n//\n// result = SocialCalc.Formula.EvaluatePolish(parseinfo, revpolish, sheet, allowrangereturn)\n//\n// Execute reverse polish representation of formula\n//\n// Operand values are objects in the operand array with a \"type\" and an optional \"value\".\n// Type can have these values (many are type and sub-type as two or more letters):\n//    \"tw\", \"th\", \"t\", \"n\", \"nt\", \"coord\", \"range\", \"start\", \"eErrorType\", \"b\" (blank)\n// The value of a coord is in the form A57 or A57!sheetname\n// The value of a range is coord|coord|number where number starts at 0 and is\n// the offset of the next item to fetch if you are going through the range one by one\n// The number starts as a null string (\"A1|B3|\")\n//\n\nSocialCalc.Formula.EvaluatePolish = function(parseinfo, revpolish, sheet, allowrangereturn) {\n\n   var scf = SocialCalc.Formula;\n   var scc = SocialCalc.Constants;\n   var tokentype = scf.TokenType;\n   var lookup_result_type = scf.LookupResultType;\n   var typelookup = scf.TypeLookupTable;\n   var operand_as_number = scf.OperandAsNumber;\n   var operand_as_text = scf.OperandAsText;\n   var operand_value_and_type = scf.OperandValueAndType;\n   var operands_as_coord_on_sheet = scf.OperandsAsCoordOnSheet;\n   var format_number_for_display = SocialCalc.format_number_for_display || function(v, t, f) {return v+\"\";};\n\n   var errortext = \"\";\n   var function_start = -1;\n   var missingOperandError = {value: \"\", type: \"e#VALUE!\", error: scc.s_parseerrmissingoperand};\n\n   var operand = [];\n   var PushOperand = function(t, v) {operand.push({type: t, value: v});};\n\n   var i, rii, prii, ttype, ttext, value1, value2, tostype, tostype2, resulttype, valuetype, cond, vmatch, smatch;\n\n   if (!parseinfo.length || (! (revpolish instanceof Array))) {\n      return ({value: \"\", type: \"e#VALUE!\", error: (typeof revpolish == \"string\" ? revpolish : \"\")});\n      }\n\n   for (i=0; i<revpolish.length; i++) {\n      rii = revpolish[i];\n      if (rii == function_start) { // Remember the start of a function argument list\n         PushOperand(\"start\", 0);\n         continue;\n         }\n\n      prii = parseinfo[rii];\n      ttype = prii.type;\n      ttext = prii.text;\n\n      if (ttype == tokentype.num) {\n         PushOperand(\"n\", ttext-0);\n         }\n\n      else if (ttype == tokentype.coord) {\n         PushOperand(\"coord\", ttext);\n         }\n\n      else if (ttype == tokentype.string) {\n         PushOperand(\"t\", ttext);\n         }\n\n      else if (ttype == tokentype.op) {\n         if (operand.length <= 0) { // Nothing on the stack...\n            return missingOperandError;\n            break; // done\n            }\n\n         // Unary minus\n\n         if (ttext == 'M') {\n            value1 = operand_as_number(sheet, operand);\n            resulttype = lookup_result_type(value1.type, value1.type, typelookup.unaryminus);\n            PushOperand(resulttype, -value1.value);\n            }\n\n         // Unary plus\n\n         else if (ttext == 'P') {\n            value1 = operand_as_number(sheet, operand);\n            resulttype = lookup_result_type(value1.type, value1.type, typelookup.unaryplus);\n            PushOperand(resulttype, value1.value);\n            }\n\n         // Unary % - percent, left associative\n\n         else if (ttext == '%') {\n            value1 = operand_as_number(sheet, operand);\n            resulttype = lookup_result_type(value1.type, value1.type, typelookup.unarypercent);\n            PushOperand(resulttype, 0.01*value1.value);\n            }\n\n         // & - string concatenate\n\n         else if (ttext == '&') {\n            if (operand.length <= 1) { // Need at least two things on the stack...\n               return missingOperandError;\n               }\n            value2 = operand_as_text(sheet, operand);\n            value1 = operand_as_text(sheet, operand);\n            resulttype = lookup_result_type(value1.type, value1.type, typelookup.concat);\n            PushOperand(resulttype, value1.value + value2.value);\n            }\n\n         // : - Range constructor\n\n         else if (ttext == ':') {\n            if (operand.length <= 1) { // Need at least two things on the stack...\n               return missingOperandError;\n               }\n            value1 = scf.OperandsAsRangeOnSheet(sheet, operand); // get coords even if use name on other sheet\n            if (value1.error) { // not available\n               errortext = errortext || value1.error;\n               }\n            PushOperand(value1.type, value1.value); // push sheetname with range on that sheet\n            }\n\n         // ! - sheetname!coord\n\n         else if (ttext == '!') {\n            if (operand.length <= 1) { // Need at least two things on the stack...\n               return missingOperandError;\n               }\n            value1 = operands_as_coord_on_sheet(sheet, operand); // get coord even if name on other sheet\n            if (value1.error) { // not available\n               errortext = errortext || value1.error;\n               }\n            PushOperand(value1.type, value1.value); // push sheetname with coord or range on that sheet\n            }\n\n         // Comparison operators: < L = G > N (< <= = >= > <>)\n\n         else if (ttext == \"<\" || ttext == \"L\" || ttext == \"=\" || ttext == \"G\" || ttext == \">\" || ttext == \"N\") {\n            if (operand.length <= 1) { // Need at least two things on the stack...\n               errortext = scc.s_parseerrmissingoperand; // remember error\n               break;\n               }\n            value2 = operand_value_and_type(sheet, operand);\n            value1 = operand_value_and_type(sheet, operand);\n            if (value1.type.charAt(0) == \"n\" && value2.type.charAt(0) == \"n\") { // compare two numbers\n               cond = 0;\n               if (ttext == \"<\") { cond = value1.value < value2.value ? 1 : 0; }\n               else if (ttext == \"L\") { cond = value1.value <= value2.value ? 1 : 0; }\n               else if (ttext == \"=\") { cond = value1.value == value2.value ? 1 : 0; }\n               else if (ttext == \"G\") { cond = value1.value >= value2.value ? 1 : 0; }\n               else if (ttext == \">\") { cond = value1.value > value2.value ? 1 : 0; }\n               else if (ttext == \"N\") { cond = value1.value != value2.value ? 1 : 0; }\n               PushOperand(\"nl\", cond);\n               }\n            else if (value1.type.charAt(0) == \"e\") { // error on left\n               PushOperand(value1.type, 0);\n               }               \n            else if (value2.type.charAt(0) == \"e\") { // error on right\n               PushOperand(value2.type, 0);\n               }               \n            else { // text maybe mixed with numbers or blank\n               tostype = value1.type.charAt(0);\n               tostype2 = value2.type.charAt(0);\n               if (tostype == \"n\") {\n                  value1.value = format_number_for_display(value1.value, \"n\", \"\");\n                  }\n               else if (tostype == \"b\") {\n                  value1.value = \"\";\n                  }\n               if (tostype2 == \"n\") {\n                  value2.value = format_number_for_display(value2.value, \"n\", \"\");\n                  }\n               else if (tostype2 == \"b\") {\n                  value2.value = \"\";\n                  }\n               cond = 0;\n               value1.value = value1.value.toLowerCase(); // ignore case\n               value2.value = value2.value.toLowerCase();\n               if (ttext == \"<\") { cond = value1.value < value2.value ? 1 : 0; }\n               else if (ttext == \"L\") { cond = value1.value <= value2.value ? 1 : 0; }\n               else if (ttext == \"=\") { cond = value1.value == value2.value ? 1 : 0; }\n               else if (ttext == \"G\") { cond = value1.value >= value2.value ? 1 : 0; }\n               else if (ttext == \">\") { cond = value1.value > value2.value ? 1 : 0; }\n               else if (ttext == \"N\") { cond = value1.value != value2.value ? 1 : 0; }\n               PushOperand(\"nl\", cond);\n               }\n            }\n\n         // Normal infix arithmethic operators: +, -. *, /, ^\n\n         else { // what's left are the normal infix arithmetic operators\n            if (operand.length <= 1) { // Need at least two things on the stack...\n               errortext = scc.s_parseerrmissingoperand; // remember error\n               break;\n               }\n            value2 = operand_as_number(sheet, operand);\n            value1 = operand_as_number(sheet, operand);\n            if (ttext == '+') {\n               resulttype = lookup_result_type(value1.type, value2.type, typelookup.plus);\n               PushOperand(resulttype, value1.value + value2.value);\n               }\n            else if (ttext == '-') {\n               resulttype = lookup_result_type(value1.type, value2.type, typelookup.plus);\n               PushOperand(resulttype, value1.value - value2.value);\n               }\n            else if (ttext == '*') {\n               resulttype = lookup_result_type(value1.type, value2.type, typelookup.plus);\n               PushOperand(resulttype, value1.value * value2.value);\n               }\n            else if (ttext == '/') {\n               if (value2.value != 0) {\n                  PushOperand(\"n\", value1.value / value2.value); // gives plain numeric result type\n                  }\n               else {\n                  PushOperand(\"e#DIV/0!\", 0);\n                  }\n               }\n            else if (ttext == '^') {\n               value1.value = Math.pow(value1.value, value2.value);\n               value1.type = \"n\"; // gives plain numeric result type\n               if (isNaN(value1.value)) {\n                  value1.value = 0;\n                  value1.type = \"e#NUM!\";\n                  }\n               PushOperand(value1.type, value1.value);\n               }\n            }\n         }\n\n      // function or name\n\n      else if (ttype == tokentype.name) {\n         errortext = scf.CalculateFunction(ttext, operand, sheet);\n         if (errortext) break;\n         }\n\n      else {\n         errortext = scc.s_InternalError+\"Unknown token \"+ttype+\" (\"+ttext+\"). \";\n         break;\n         }\n      }\n\n   // look at final value and handle special cases\n\n   value = operand[0] ? operand[0].value : \"\";\n   tostype = operand[0] ? operand[0].type : \"\";\n\n   if (tostype == \"name\") { // name - expand it\n      value1 = SocialCalc.Formula.LookupName(sheet, value);\n      value = value1.value;\n      tostype = value1.type;\n      errortext = errortext || value1.error;\n      }\n\n   if (tostype == \"coord\") { // the value is a coord reference, get its value and type\n      value1 = operand_value_and_type(sheet, operand);\n      value = value1.value;\n      tostype = value1.type;\n      if (tostype == \"b\") {\n         tostype = \"n\";\n         value = 0;\n         }\n      }\n\n   if (operand.length > 1 && !errortext) { // something left - error\n      errortext += scc.s_parseerrerrorinformula;\n      }\n\n   // set return type\n\n   valuetype = tostype;\n\n   if (tostype.charAt(0) == \"e\") { // error value\n      errortext = errortext || tostype.substring(1) || scc.s_calcerrerrorvalueinformula;\n      }\n   else if (tostype == \"range\") {\n      vmatch = value.match(/^(.*)\\|(.*)\\|/);\n      smatch = vmatch[1].indexOf(\"!\");\n      if (smatch>=0) { // swap sheetname\n         vmatch[1] = vmatch[1].substring(smatch+1) + \"!\" + vmatch[1].substring(0, smatch).toUpperCase();\n         }\n      else {\n         vmatch[1] = vmatch[1].toUpperCase();\n         }\n      value = vmatch[1] + \":\" + vmatch[2].toUpperCase();\n      if (!allowrangereturn) {\n         errortext = scc.s_formularangeresult+\" \"+value;\n         }\n      }\n\n   if (errortext && valuetype.charAt(0) != \"e\") {\n      value = errortext;\n      valuetype = \"e\";\n     }\n\n   // look for overflow\n\n   if (valuetype.charAt(0) == \"n\" && (isNaN(value) || !isFinite(value))) {\n      value = 0;\n      valuetype = \"e#NUM!\";\n      errortext = isNaN(value) ? scc.s_calcerrnumericnan: scc.s_calcerrnumericoverflow;\n      }\n\n   return ({value: value, type: valuetype, error: errortext});\n\n   }\n\n\n/*\n#\n# resulttype = SocialCalc.Formula.LookupResultType(type1, type2, typelookup);\n#\n# typelookup has values of the following form:\n#\n#    typelookup{\"typespec1\"} = \"|typespec2A:resultA|typespec2B:resultB|...\"\n#\n# First type1 is looked up. If no match, then the first letter (major type) of type1 plus \"*\" is looked up\n# resulttype is type1 if result is \"1\", type2 if result is \"2\", otherwise the value of result.\n#\n*/\n\nSocialCalc.Formula.LookupResultType = function(type1, type2, typelookup) {\n\n   var pos1, pos2, result;\n\n   var table1 = typelookup[type1];\n\n   if (!table1) {\n      table1 = typelookup[type1.charAt(0)+'*'];\n      if (!table1) {\n         return \"e#VALUE! (internal error, missing LookupResultType \"+type1.charAt(0)+\"*)\"; // missing from table -- please add it\n         }\n      }\n   pos1 = table1.indexOf(\"|\"+type2+\":\");\n   if (pos1 >= 0) {\n      pos2 = table1.indexOf(\"|\", pos1+1);\n      if (pos2<0) return \"e#VALUE! (internal error, incorrect LookupResultType \"+table1+\")\";\n      result = table1.substring(pos1+type2.length+2, pos2);\n      if (result == \"1\") return type1;\n      if (result == \"2\") return type2;\n      return result;\n      }\n   pos1 = table1.indexOf(\"|\"+type2.charAt(0)+\"*:\");\n   if (pos1 >= 0) {\n      pos2 = table1.indexOf(\"|\", pos1+1);\n      if (pos2<0) return \"e#VALUE! (internal error, incorrect LookupResultType \"+table1+\")\";\n      result = table1.substring(pos1+4, pos2);\n      if (result == \"1\") return type1;\n      if (result == \"2\") return type2;\n      return result;\n      }\n   return \"e#VALUE!\";\n\n   }\n\n/*\n#\n# operandinfo = SocialCalc.Formula.TopOfStackValueAndType(sheet, operand)\n#\n# Returns top of stack value and type and then pops the stack.\n# The result is {value: value, type: type, error: \"only if bad error\"}\n#\n*/\n\nSocialCalc.Formula.TopOfStackValueAndType = function(sheet, operand) {\n\n   var cellvtype, cell, pos, coordsheet;\n   var scf = SocialCalc.Formula;\n\n   var result = {type: \"\", value: \"\"};\n\n   var stacklen = operand.length;\n\n   if (!stacklen) { // make sure something is there\n      result.error = SocialCalc.Constants.s_InternalError+\"no operand on stack\";\n      return result;\n      }\n\n   result.value = operand[stacklen-1].value; // get top of stack\n   result.type = operand[stacklen-1].type;\n   operand.pop(); // we have data - pop stack\n\n   if (result.type == \"name\") {\n      result = scf.LookupName(sheet, result.value);\n      }\n\n   return result;\n\n   }\n\n\n/*\n#\n# operandinfo = OperandAsNumber(sheet, operand)\n#\n# Uses operand_value_and_type to get top of stack and pops it.\n# Returns numeric value and type.\n# Text values are treated as 0 if they can't be converted somehow.\n#\n*/\n\nSocialCalc.Formula.OperandAsNumber = function(sheet, operand) {\n\n   var t, valueinfo;\n   var operandinfo = SocialCalc.Formula.OperandValueAndType(sheet, operand);\n\n   t = operandinfo.type.charAt(0);\n\n   if (t == \"n\") {\n      operandinfo.value = operandinfo.value-0;\n      }\n   else if (t == \"b\") { // blank cell\n      operandinfo.type = \"n\";\n      operandinfo.value = 0;\n      }\n   else if (t == \"e\") { // error\n      operandinfo.value = 0;\n      }\n   else {\n      valueinfo = SocialCalc.DetermineValueType ? SocialCalc.DetermineValueType(operandinfo.value) :\n                                                    {value: operandinfo.value-0, type: \"n\"}; // if without rest of SocialCalc\n      if (valueinfo.type.charAt(0) == \"n\") {\n         operandinfo.value = valueinfo.value-0;\n         operandinfo.type = valueinfo.type;\n         }\n      else {\n         operandinfo.value = 0;\n         operandinfo.type = valueinfo.type;\n         }\n      }\n\n   return operandinfo;\n\n   }\n\n/*\n#\n# operandinfo = OperandAsText(sheet, operand)\n#\n# Uses operand_value_and_type to get top of stack and pops it.\n# Returns text value, preserving sub-type.\n#\n*/\n\nSocialCalc.Formula.OperandAsText = function(sheet, operand) {\n\n   var t, valueinfo;\n   var operandinfo = SocialCalc.Formula.OperandValueAndType(sheet, operand);\n\n   t = operandinfo.type.charAt(0);\n\n   if (t ==  \"t\") { // any flavor of text returns as is\n      ;\n      }\n   else if (t == \"n\") {\n      operandinfo.value = SocialCalc.format_number_for_display ?\n                             SocialCalc.format_number_for_display(operandinfo.value, operandinfo.type, \"\") :\n                             operandinfo.value = operandinfo.value+\"\";\n      operandinfo.type = \"t\";\n      }\n   else if (t == \"b\") { // blank\n      operandinfo.value = \"\";\n      operandinfo.type = \"t\";\n      }\n   else if (t == \"e\") { // error\n      operandinfo.value = \"\";\n      }\n   else {\n      operand.value = operandinfo.value + \"\";\n      operand.type = \"t\";\n      }\n\n   return operandinfo;\n\n   }\n\n/*\n#\n# result = SocialCalc.Formula.OperandValueAndType(sheet, operand)\n#\n# Pops the top of stack and returns it, following a coord reference if necessary.\n# The result is {value: value, type: type, error: \"only if bad error\"}\n# Ranges are returned as if they were pushed onto the stack first coord first\n# Also sets type with \"t\", \"n\", \"th\", etc., as appropriate\n#\n*/\n\nSocialCalc.Formula.OperandValueAndType = function(sheet, operand) {\n\n   var cellvtype, cell, pos, coordsheet;\n   var scf = SocialCalc.Formula;\n\n   var result = {type: \"\", value: \"\"};\n\n   var stacklen = operand.length;\n\n   if (!stacklen) { // make sure something is there\n      result.error = SocialCalc.Constants.s_InternalError+\"no operand on stack\";\n      return result;\n      }\n\n   result.value = operand[stacklen-1].value; // get top of stack\n   result.type = operand[stacklen-1].type;\n   operand.pop(); // we have data - pop stack\n\n   if (result.type == \"name\") {\n      result = scf.LookupName(sheet, result.value);\n      }\n\n   if (result.type == \"range\") {\n      result = scf.StepThroughRangeDown(operand, result.value);\n      }\n\n   if (result.type == \"coord\") { // value is a coord reference\n      coordsheet = sheet;\n      pos = result.value.indexOf(\"!\");\n      if (pos != -1) { // sheet reference\n         coordsheet = scf.FindInSheetCache(result.value.substring(pos+1)); // get other sheet\n         if (coordsheet == null) { // unavailable\n            result.type = \"e#REF!\";\n            result.error = SocialCalc.Constants.s_sheetunavailable+\" \"+result.value.substring(pos+1);\n            result.value = 0;\n            return result;\n            }\n         result.value = result.value.substring(0, pos); // get coord part\n         }\n\n      if (coordsheet) {\n         cell = coordsheet.cells[SocialCalc.Formula.PlainCoord(result.value)];\n         if (cell) {\n            cellvtype = cell.valuetype; // get type of value in the cell it points to\n            result.value = cell.datavalue;\n            }\n         else {\n            cellvtype = \"b\";\n            }\n         }\n      else {\n         cellvtype = \"e#N/A\";\n         result.value = 0;\n         }\n      result.type = cellvtype || \"b\";\n      if (result.type == \"b\") { // blank\n         result.value = 0;\n         }\n      }\n\n   return result;\n\n   }\n\n/*\n#\n# operandinfo = SocialCalc.Formula.OperandAsCoord(sheet, operand)\n#\n# Gets top of stack and pops it.\n# Returns coord value. All others are treated as an error.\n#\n*/\n\n\nSocialCalc.Formula.OperandAsCoord = function(sheet, operand) {\n\n   var scf = SocialCalc.Formula;\n\n   var result = {type: \"\", value: \"\"};\n\n   var stacklen = operand.length;\n\n   result.value = operand[stacklen-1].value; // get top of stack\n   result.type = operand[stacklen-1].type;\n   operand.pop(); // we have data - pop stack\n   if (result.type == \"name\") {\n      result = SocialCalc.Formula.LookupName(sheet, result.value);\n      }\n   if (result.type == \"coord\") { // value is a coord reference\n      return result;\n      }\n   else {\n      result.value = SocialCalc.Constants.s_calcerrcellrefmissing;\n      result.type = \"e#REF!\";\n      return result;\n      }\n}\n\n\n/*\n#\n# result = SocialCalc.Formula.OperandsAsCoordOnSheet(sheet, operand)\n#\n# Gets 2 at top of stack and pops them, treating them as sheetname!coord-or-name.\n# Returns stack-style coord value (coord!sheetname, or coord!sheetname|coord|) with\n# a type of coord or range. All others are treated as an error.\n# If sheetname not available, sets result.error.\n#\n*/\n\nSocialCalc.Formula.OperandsAsCoordOnSheet = function(sheet, operand) {\n\n   var sheetname, othersheet, pos1, pos2;\n   var value1 = {};\n   var result = {};\n   var scf = SocialCalc.Formula;\n\n   var stacklen = operand.length;\n   value1.value = operand[stacklen-1].value; // get top of stack - coord or name\n   value1.type = operand[stacklen-1].type;\n   operand.pop(); // we have data - pop stack\n\n   sheetname = scf.OperandAsSheetName(sheet, operand); // get sheetname as text\n   othersheet = scf.FindInSheetCache(sheetname.value);\n   if (othersheet == null) { // unavailable\n      result.type = \"e#REF!\";\n      result.value = 0;\n      result.error = SocialCalc.Constants.s_sheetunavailable+\" \"+sheetname.value;\n      return result;\n      }\n\n   if (value1.type == \"name\") {\n      value1 = scf.LookupName(othersheet, value1.value);\n      }\n   result.type = value1.type;\n   if (value1.type == \"coord\") { // value is a coord reference\n      result.value = value1.value + \"!\" + sheetname.value; // return in the format as used on stack\n      }\n   else if (value1.type == \"range\") { // value is a range reference\n      pos1 = value1.value.indexOf(\"|\");\n      pos2 = value1.value.indexOf(\"|\", pos1+1);\n      result.value = value1.value.substring(0, pos1) + \"!\" + sheetname.value +\n                    \"|\" + value1.value.substring(pos1+1, pos2) + \"|\";\n      }\n   else if (value1.type.charAt(0)==\"e\") {\n      result.value = value1.value;\n      }\n   else {\n      result.error = SocialCalc.Constants.s_calcerrcellrefmissing;\n      result.type = \"e#REF!\";\n      result.value = 0;\n      }\n   return result;\n   \n   }\n\n/*\n#\n# result = SocialCalc.Formula.OperandsAsRangeOnSheet(sheet, operand)\n#\n# Gets 2 at top of stack and pops them, treating them as coord2-or-name:coord1.\n# Name is evaluated on sheet of coord1.\n# Returns result with \"value\" of stack-style range value (coord!sheetname|coord|) and\n# \"type\" of \"range\". All others are treated as an error.\n#\n*/\n\nSocialCalc.Formula.OperandsAsRangeOnSheet = function(sheet, operand) {\n\n   var value1, othersheet, pos1, pos2;\n   var value2 = {};\n   var scf = SocialCalc.Formula;\n   var scc = SocialCalc.Constants;\n\n   var stacklen = operand.length;\n   value2.value = operand[stacklen-1].value; // get top of stack - coord or name for \"right\" side\n   value2.type = operand[stacklen-1].type;\n   operand.pop(); // we have data - pop stack\n\n   value1 = scf.OperandAsCoord(sheet, operand); // get \"left\" coord\n   if (value1.type != \"coord\") { // not a coord, which it must be\n      return {value: 0, type: \"e#REF!\"};\n      }\n\n   othersheet = sheet;\n   pos1 = value1.value.indexOf(\"!\");\n   if (pos1 != -1) { // sheet reference\n      pos2 = value1.value.indexOf(\"|\", pos1+1);\n      if (pos2 < 0) pos2 = value1.value.length;\n      othersheet = scf.FindInSheetCache(value1.value.substring(pos1+1,pos2)); // get other sheet\n      if (othersheet == null) { // unavailable\n         return {value: 0, type: \"e#REF!\", errortext: scc.s_sheetunavailable+\" \"+value1.value.substring(pos1+1,pos2)};\n         }\n      }\n\n   if (value2.type == \"name\") { // coord:name is allowed, if name is just one cell\n      value2 = scf.LookupName(othersheet, value2.value);\n      }\n\n   if (value2.type == \"coord\") { // value is a coord reference, so return the combined range\n      return {value: value1.value+\"|\"+value2.value+\"|\", type: \"range\"}; // return range in the format as used on stack\n      }\n   else { // bad form\n      return {value: scc.s_calcerrcellrefmissing, type: \"e#REF!\"};\n      }\n   }\n\n\n/*\n#\n# result = SocialCalc.Formula.OperandAsSheetName(sheet, operand)\n#\n# Gets top of stack and pops it.\n# Returns sheetname value. All others are treated as an error.\n# Accepts text, cell reference, and named value which is one of those two.\n#\n*/\n\nSocialCalc.Formula.OperandAsSheetName = function(sheet, operand) {\n\n   var nvalue, cell;\n\n   var scf = SocialCalc.Formula;\n\n   var result = {type: \"\", value: \"\"};\n\n   var stacklen = operand.length;\n\n   result.value = operand[stacklen-1].value; // get top of stack\n   result.type = operand[stacklen-1].type;\n   operand.pop(); // we have data - pop stack\n   if (result.type == \"name\") {\n      nvalue = SocialCalc.Formula.LookupName(sheet, result.value);\n      if (!nvalue.value) { // not a known name - return bare name as the name value\n         return result;\n         }\n      result.value = nvalue.value;\n      result.type = nvalue.type;\n      }\n   if (result.type == \"coord\") { // value is a coord reference, follow it to find sheet name\n      cell = sheet.cells[SocialCalc.Formula.PlainCoord(result.value)];\n      if (cell) {\n         result.value = cell.datavalue;\n         result.type = cell.valuetype;\n         }\n      else {\n         result.value = \"\";\n         result.type = \"b\";\n         }\n      }\n   if (result.type.charAt(0) == \"t\") { // value is a string which could be a sheet name\n      return result;\n      }\n   else {\n      result.value = \"\";\n      result.error = SocialCalc.Constants.s_calcerrsheetnamemissing;\n      return result;\n      }\n\n   }\n\n//\n// value = SocialCalc.Formula.LookupName(sheet, name)\n//\n// Returns value and type of a named value\n// Names are case insensitive\n// Names may have a definition which is a coord (A1), a range (A1:B7), or a formula (=OFFSET(A1,0,0,5,1))\n// Note: The range must not have sheet names (\"!\") in them.\n//\n\nSocialCalc.Formula.LookupName = function(sheet, name) {\n\n   var pos, specialc, parseinfo;\n   var names = sheet.names;\n   var value = {};\n   var startedwalk = false;\n\n   if (names[name.toUpperCase()]) { // is name defined?\n\n      value.value = names[name.toUpperCase()].definition; // yes\n\n      if (value.value.charAt(0) == \"=\") { // formula\n         if (!sheet.checknamecirc) { // are we possibly walking the name tree?\n            sheet.checknamecirc = {}; // not yet\n            startedwalk = true; // remember we are the reference that started it\n            }\n         else {\n            if (sheet.checknamecirc[name]) { // circular reference\n               value.type = \"e#NAME?\";\n               value.error = SocialCalc.Constants.s_circularnameref+' \"' + name + '\".';\n               return value;\n               }\n            }\n         sheet.checknamecirc[name] = true;\n\n         parseinfo = SocialCalc.Formula.ParseFormulaIntoTokens(value.value.substring(1));\n         value = SocialCalc.Formula.evaluate_parsed_formula(parseinfo, sheet, 1); // parse formula, allowing range return\n\n         delete sheet.checknamecirc[name]; // done with us\n         if (startedwalk) {\n            delete sheet.checknamecirc; // done with walk\n            }\n\n         if (value.type != \"range\") {\n            return value;\n            }\n         }\n\n      pos = value.value.indexOf(\":\");\n      if (pos != -1) { // range\n         value.type = \"range\";\n         value.value = value.value.substring(0, pos) + \"|\" + value.value.substring(pos+1)+\"|\";\n         value.value = value.value.toUpperCase();\n         }\n      else {\n         value.type = \"coord\";\n         value.value = value.value.toUpperCase();\n         }\n      return value;\n      }\n   else if (specialc=SocialCalc.Formula.SpecialConstants[name.toUpperCase()]) { // special constant, like #REF!\n      pos = specialc.indexOf(\",\");\n      value.value = specialc.substring(0,pos)-0;\n      value.type = specialc.substring(pos+1);\n      return value;\n      }\n   else {\n      value.value = \"\";\n      value.type = \"e#NAME?\";\n      value.error = SocialCalc.Constants.s_calcerrunknownname+' \"'+name+'\"';\n      return value;\n      }\n   }\n\n/*\n#\n# coord = SocialCalc.Formula.StepThroughRangeDown(operand, rangevalue)\n#\n# Returns next coord in a range, keeping track on the operand stack\n# Goes from upper left across and down to bottom right.\n#\n*/\n\nSocialCalc.Formula.StepThroughRangeDown = function(operand, rangevalue) {\n\n   var value1, value2, sequence, pos1, pos2, sheet1, rp, c, r, count;\n   var scf = SocialCalc.Formula;\n\n   pos1 = rangevalue.indexOf(\"|\");\n   pos2 = rangevalue.indexOf(\"|\", pos1+1);\n   value1 = rangevalue.substring(0, pos1);\n   value2 = rangevalue.substring(pos1+1, pos2);\n   sequence = rangevalue.substring(pos2+1) - 0;\n\n   pos1 = value1.indexOf(\"!\");\n   if (pos1 != -1) {\n      sheet1 = value1.substring(pos1);\n      value1 = value1.substring(0, pos1);\n      }\n   else {\n      sheet1 = \"\";\n      }\n   pos1 = value2.indexOf(\"!\");\n   if (pos1 != -1) {\n      value2 = value2.substring(0, pos1);\n      }\n\n   rp = scf.OrderRangeParts(value1, value2);\n   \n   count = 0;\n   for (r=rp.r1; r<=rp.r2; r++) {\n      for (c=rp.c1; c<=rp.c2; c++) {\n         count++;\n         if (count > sequence) {\n            if (r!=rp.r2 || c!=rp.c2) { // keep on stack until done\n               scf.PushOperand(operand, \"range\", value1+sheet1+\"|\"+value2+\"|\"+count);\n               }\n            return {value: SocialCalc.crToCoord(c, r)+sheet1, type: \"coord\"};\n            }\n         }\n      }\n   }\n\n/*\n#\n# result = SocialCalc.Formula.DecodeRangeParts(sheetdata, range)\n#\n# Returns sheetdata for the sheet where the range is, as well as\n# the number of the first column in the range, the number of columns,\n# and equivalent row information:\n#\n# {sheetdata: sheet, sheetname: name-or-\"\", col1num: n, ncols: n, row1num: n, nrows: n}\n#\n# If any errors, a null result is returned.\n#\n*/\n\nSocialCalc.Formula.DecodeRangeParts = function(sheetdata, range) {\n\n   var value1, value2, pos1, pos2, sheet1, coordsheetdata, rp;\n\n   var scf = SocialCalc.Formula;\n\n   pos1 = range.indexOf(\"|\");\n   pos2 = range.indexOf(\"|\", pos1+1);\n   value1 = range.substring(0, pos1);\n   value2 = range.substring(pos1+1, pos2);\n\n   pos1 = value1.indexOf(\"!\");\n   if (pos1 != -1) {\n      sheet1 = value1.substring(pos1+1);\n      value1 = value1.substring(0, pos1);\n      }\n   else {\n      sheet1 = \"\";\n      }\n   pos1 = value2.indexOf(\"!\");\n   if (pos1 != -1) {\n      value2 = value2.substring(0, pos1);\n      }\n\n   coordsheetdata = sheetdata;\n   if (sheet1) { // sheet reference\n      coordsheetdata = scf.FindInSheetCache(sheet1);\n      if (coordsheetdata == null) { // unavailable\n         return null;\n         }\n      }\n\n   rp = scf.OrderRangeParts(value1, value2);\n\n   return {sheetdata: coordsheetdata, sheetname: sheet1, col1num: rp.c1, ncols: rp.c2-rp.c1+1, row1num: rp.r1, nrows: rp.r2-rp.r1+1}\n\n   }\n\n\n//*********************\n//\n// Function Handling\n//\n//*********************\n\n// List of functions -- Define after functions are defined\n//\n// SocialCalc.Formula.FunctionList[\"function_name\"] = [function_subroutine, number_of_arguments, arg_def, func_def, func_class]\n//   function_subroutine takes arguments (fname, operand, foperand, sheet), returns\n//      errortext or null, pushing result on operand stack.\n//   number_of_arguments is:\n//      0 = no arguments\n//      >0 = exactly that many arguments\n//      <0 = that many arguments (abs value) or more\n//      100 = don't check\n//\n//   arg_def, if present, is the name of the element in SocialCalc.Formula.FunctionArgDefs.\n//   func_def, if present, is a string explaining the function. If not, looked up in SocialCalc.Constants.\n//   func_class, if present, is the comma-separated names of the elements in SocialCalc.Formula.FunctionClasses.\n//\n// To add a function, just add it to this object.\n\n   if (!SocialCalc.Formula.FunctionList) { // make sure it is defined (could have been in another module)\n      SocialCalc.Formula.FunctionList = {};\n      }\n\n   // FunctionClasses[classname] = {name: full-name-string, items: [sorted list of function names]};\n   // filled in by SocialCalc.Formula.FillFunctionInfo\n\n   SocialCalc.Formula.FunctionClasses = null; // start null to say needs filling in\n\n   // FunctionArgDef[argname] = explicit-string-for-arg-list;\n   // filled in by SocialCalc.Formula.FillFunctionInfo\n\n   SocialCalc.Formula.FunctionArgDefs = {};\n\n\n/*\n#\n# errortext = SocialCalc.Formula.CalculateFunction(fname, operand, sheet)\n#\n# Dispatches for function fname.\n#\n*/\n\nSocialCalc.Formula.CalculateFunction = function(fname, operand, sheet) {\n\n   var fobj, foperand, ffunc, argnum, ttext;\n   var scf = SocialCalc.Formula;\n   var ok = 1;\n   var errortext = \"\";\n\n   fobj = scf.FunctionList[fname];\n\n   if (fobj) {\n      foperand = [];\n      ffunc = fobj[0];\n      argnum = fobj[1];\n      scf.CopyFunctionArgs(operand, foperand);\n      if (argnum != 100) {\n         if (argnum < 0) {\n            if (foperand.length < -argnum) {\n               errortext = scf.FunctionArgsError(fname, operand);\n               return errortext;\n               }\n            }\n         else {\n            if (foperand.length != argnum) {\n               errortext = scf.FunctionArgsError(fname, operand);\n               return errortext;\n               }\n            }\n         }\n      errortext = ffunc(fname, operand, foperand, sheet);\n      }\n\n   else {\n         ttext = fname;\n\n         if (operand.length && operand[operand.length-1].type == \"start\") { // no arguments - name or zero arg function\n            operand.pop();\n            scf.PushOperand(operand, \"name\", ttext);\n            }\n\n         else {\n            errortext = SocialCalc.Constants.s_sheetfuncunknownfunction+\" \" + ttext +\". \";\n            }\n      }\n\n   return errortext;\n\n}\n\n//\n// SocialCalc.Formula.PushOperand(operand, t, v)\n//\n// Pushes the type and value onto the operand stack\n//\n\nSocialCalc.Formula.PushOperand = function(operand, t, v) {\n\n   operand.push({type: t, value: v});\n\n   }\n\n//\n// SocialCalc.Formula.CopyFunctionArgs(operand, foperand)\n//\n// Pops operands from operand and pushes on foperand up to function start\n// reversing order in the process.\n//\n\nSocialCalc.Formula.CopyFunctionArgs = function(operand, foperand) {\n\n   var fobj, foperand, ffunc, argnum;\n   var scf = SocialCalc.Formula;\n   var ok = 1;\n   var errortext = null;\n\n   while (operand.length>0 && operand[operand.length-1].type != \"start\") { // get each arg\n      foperand.push(operand.pop()); // copy it\n      }\n   operand.pop(); // get rid of \"start\"\n\n   return;\n\n   }\n\n//\n// errortext = SocialCalc.Formula.FunctionArgsError(fname, operand)\n//\n// Pushes appropriate error on operand stack and returns errortext, including fname\n//\n\nSocialCalc.Formula.FunctionArgsError = function(fname, operand) {\n\n   var errortext = SocialCalc.Constants.s_calcerrincorrectargstofunction+\" \" + fname + \". \";\n   SocialCalc.Formula.PushOperand(operand, \"e#VALUE!\", errortext);\n\n   return errortext;\n\n   }\n\n\n//\n// errortext = SocialCalc.Formula.FunctionSpecificError(fname, operand, errortype, errortext)\n//\n// Pushes specified error and text on operand stack.\n//\n\nSocialCalc.Formula.FunctionSpecificError = function(fname, operand, errortype, errortext) {\n\n   SocialCalc.Formula.PushOperand(operand, errortype, errortext);\n\n   return errortext;\n\n   }\n\n//\n// haserror = SocialCalc.Formula.CheckForErrorValue(operand, v)\n//\n// If v.type is an error, push it on operand stack and return true, otherwise return false.\n//\n\nSocialCalc.Formula.CheckForErrorValue = function(operand, v) {\n\n   if (v.type.charAt(0) == \"e\") {\n      operand.push(v);\n      return true;\n      }\n   else {\n      return false;\n      }\n\n   }\n\n/////////////////////////\n//\n// FUNCTION INFORMATION ROUTINES\n//\n\n//\n// SocialCalc.Formula.FillFunctionInfo()\n//\n// Goes through function definitions and fills out FunctionArgDefs and FunctionClasses.\n// Execute this after any changes to SocialCalc.Constants but before UI is used.\n//\n\nSocialCalc.Formula.FillFunctionInfo = function() {\n\n   var scf = SocialCalc.Formula;\n   var scc = SocialCalc.Constants;\n\n   var fname, f, classes, cname, i;\n\n   if (scf.FunctionClasses) { // only do once\n      return;\n      }\n\n   for (fname in scf.FunctionList) {\n      f = scf.FunctionList[fname];\n      if (f[2]) { // has an arg def\n         scf.FunctionArgDefs[f[2]] = scc[\"s_farg_\"+f[2]] || \"\"; // get it from constants\n         }\n      if (!f[3]) { // no text def, see if in constants\n         if (scc[\"s_fdef_\"+fname]) {\n            scf.FunctionList[fname][3] = scc[\"s_fdef_\"+fname];\n            }\n         }\n      }\n\n   scf.FunctionClasses = {};\n \n   for (i=0; i<scc.function_classlist.length; i++) {\n      cname = scc.function_classlist[i];\n      scf.FunctionClasses[cname] = {name: scc[\"s_fclass_\"+cname], items: []};\n      }\n\n   for (fname in scf.FunctionList) {\n      f = scf.FunctionList[fname];\n      classes = f[4] ? f[4].split(\",\") : []; // get classes\n      classes.push(\"all\");\n      for (i=0; i<classes.length; i++) {\n         cname = classes[i];\n         scf.FunctionClasses[cname].items.push(fname);\n         }\n      }\n   for (cname in scf.FunctionClasses) {\n      scf.FunctionClasses[cname].items.sort();\n      }\n\n   }\n\n//\n// str = SocialCalc.Formula.FunctionArgString(fname)\n//\n// Returns a string representing the arguments to function fname.\n//\n\nSocialCalc.Formula.FunctionArgString = function(fname) {\n\n   var scf = SocialCalc.Formula;\n   var fdata = scf.FunctionList[fname];\n   var nargs, i, str;\n\n   var adef = fdata[2];\n\n   if (!adef) {\n      nargs = fdata[1];\n      if (nargs == 0) {\n         adef = \" \";\n         }\n      else if (nargs > 0) {\n         str = \"v1\";\n         for (i=2; i<=nargs; i++) {\n            str += \", v\"+i;\n            }\n         return str;\n         }\n      else if (nargs < 0) {\n         str = \"v1\";\n         for (i=2; i<-nargs; i++) {\n            str += \", v\"+i;\n            }\n         return str+\", ...\";\n         }\n      else {\n         return \"nargs: \"+nargs;\n         }\n      }\n\n   str = scf.FunctionArgDefs[adef] || adef;\n\n   return str;\n\n   }\n\n\n/////////////////////////\n//\n// FUNCTION DEFINITIONS\n//\n// The standard function definitions follow.\n//\n// Note that some need SocialCalc.DetermineValueType to be defined.\n//\n\n/*\n#\n# AVERAGE(v1,c1:c2,...)\n# COUNT(v1,c1:c2,...)\n# COUNTA(v1,c1:c2,...)\n# COUNTBLANK(v1,c1:c2,...)\n# MAX(v1,c1:c2,...)\n# MIN(v1,c1:c2,...)\n# PRODUCT(v1,c1:c2,...)\n# STDEV(v1,c1:c2,...)\n# STDEVP(v1,c1:c2,...)\n# SUM(v1,c1:c2,...)\n# VAR(v1,c1:c2,...)\n# VARP(v1,c1:c2,...)\n#\n# Calculate all of these and then return the desired one (overhead is in accessing not calculating)\n# If this routine is changed, check the dseries_functions, too.\n#\n*/\n\nSocialCalc.Formula.SeriesFunctions = function(fname, operand, foperand, sheet) {\n\n   var value1, t, v1;\n\n   var scf = SocialCalc.Formula;\n   var operand_value_and_type = scf.OperandValueAndType;\n   var lookup_result_type = scf.LookupResultType;\n   var typelookupplus = scf.TypeLookupTable.plus;\n\n   var PushOperand = function(t, v) {operand.push({type: t, value: v});};\n\n   var sum = 0;\n   var resulttypesum = \"\";\n   var count = 0;\n   var counta = 0;\n   var countblank = 0;\n   var product = 1;\n   var maxval;\n   var minval;\n   var mk, sk, mk1, sk1; // For variance, etc.: M sub k, k-1, and S sub k-1\n                         // as per Knuth \"The Art of Computer Programming\" Vol. 2 3rd edition, page 232\n\n   while (foperand.length > 0) {\n      value1 = operand_value_and_type(sheet, foperand);\n      t = value1.type.charAt(0);\n      if (t == \"n\") count += 1;\n      if (t != \"b\") counta += 1;\n      if (t == \"b\") countblank += 1;\n\n      if (t == \"n\") {\n         v1 = value1.value-0; // get it as a number\n         sum += v1;\n         product *= v1;\n         maxval = (maxval!=undefined) ? (v1 > maxval ? v1 : maxval) : v1;\n         minval = (minval!=undefined) ? (v1 < minval ? v1 : minval) : v1;\n         if (count == 1) { // initialize with first values for variance used in STDEV, VAR, etc.\n            mk1 = v1;\n            sk1 = 0;\n            }\n         else { // Accumulate S sub 1 through n as per Knuth noted above\n            mk = mk1 + (v1 - mk1) / count;\n            sk = sk1 + (v1 - mk1) * (v1 - mk);\n            sk1 = sk;\n            mk1 = mk;\n            }\n         resulttypesum = lookup_result_type(value1.type, resulttypesum || value1.type, typelookupplus);\n         }\n      else if (t == \"e\" && resulttypesum.charAt(0) != \"e\") {\n         resulttypesum = value1.type;\n         }\n      }\n\n   resulttypesum = resulttypesum || \"n\";\n\n   switch (fname) {\n      case \"SUM\":\n         PushOperand(resulttypesum, sum);\n         break;\n\n      case \"PRODUCT\": // may handle cases with text differently than some other spreadsheets\n         PushOperand(resulttypesum, product);\n         break;\n\n      case \"MIN\":\n         PushOperand(resulttypesum, minval || 0);\n         break;\n\n      case \"MAX\":\n         PushOperand(resulttypesum, maxval || 0);\n         break;\n\n      case \"COUNT\":\n         PushOperand(\"n\", count);\n         break;\n\n      case \"COUNTA\":\n         PushOperand(\"n\", counta);\n         break;\n\n      case \"COUNTBLANK\":\n         PushOperand(\"n\", countblank);\n         break;\n\n      case \"AVERAGE\":\n         if (count > 0) {\n            PushOperand(resulttypesum, sum/count);\n            }\n         else {\n            PushOperand(\"e#DIV/0!\", 0);\n            }\n         break;\n\n      case \"STDEV\":\n         if (count > 1) {\n            PushOperand(resulttypesum, Math.sqrt(sk / (count - 1))); // sk is never negative according to Knuth\n            }\n         else {\n            PushOperand(\"e#DIV/0!\", 0);\n            }\n         break;\n\n      case \"STDEVP\":\n         if (count > 1) {\n            PushOperand(resulttypesum, Math.sqrt(sk / count));\n            }\n         else {\n            PushOperand(\"e#DIV/0!\", 0);\n            }\n         break;\n\n      case \"VAR\":\n         if (count > 1) {\n            PushOperand(resulttypesum, sk / (count - 1));\n            }\n         else {\n            PushOperand(\"e#DIV/0!\", 0);\n            }\n         break;\n\n      case \"VARP\":\n         if (count > 1) {\n            PushOperand(resulttypesum, sk / count);\n            }\n         else {\n            PushOperand(\"e#DIV/0!\", 0);\n            }\n         break;\n      }\n\n   return null;\n\n   }\n\n// Add to function list\nSocialCalc.Formula.FunctionList[\"AVERAGE\"] = [SocialCalc.Formula.SeriesFunctions, -1, \"vn\", null, \"stat\"];\nSocialCalc.Formula.FunctionList[\"COUNT\"] = [SocialCalc.Formula.SeriesFunctions, -1, \"vn\", null, \"stat\"];\nSocialCalc.Formula.FunctionList[\"COUNTA\"] = [SocialCalc.Formula.SeriesFunctions, -1, \"vn\", null, \"stat\"];\nSocialCalc.Formula.FunctionList[\"COUNTBLANK\"] = [SocialCalc.Formula.SeriesFunctions, -1, \"vn\", null, \"stat\"];\nSocialCalc.Formula.FunctionList[\"MAX\"] = [SocialCalc.Formula.SeriesFunctions, -1, \"vn\", null, \"stat\"];\nSocialCalc.Formula.FunctionList[\"MIN\"] = [SocialCalc.Formula.SeriesFunctions, -1, \"vn\", null, \"stat\"];\nSocialCalc.Formula.FunctionList[\"PRODUCT\"] = [SocialCalc.Formula.SeriesFunctions, -1, \"vn\", null, \"stat\"];\nSocialCalc.Formula.FunctionList[\"STDEV\"] = [SocialCalc.Formula.SeriesFunctions, -1, \"vn\", null, \"stat\"];\nSocialCalc.Formula.FunctionList[\"STDEVP\"] = [SocialCalc.Formula.SeriesFunctions, -1, \"vn\", null, \"stat\"];\nSocialCalc.Formula.FunctionList[\"SUM\"] = [SocialCalc.Formula.SeriesFunctions, -1, \"vn\", null, \"stat\"];\nSocialCalc.Formula.FunctionList[\"VAR\"] = [SocialCalc.Formula.SeriesFunctions, -1, \"vn\", null, \"stat\"];\nSocialCalc.Formula.FunctionList[\"VARP\"] = [SocialCalc.Formula.SeriesFunctions, -1, \"vn\", null, \"stat\"];\n\n/*\n#\n# DAVERAGE(databaserange, fieldname, criteriarange)\n# DCOUNT(databaserange, fieldname, criteriarange)\n# DCOUNTA(databaserange, fieldname, criteriarange)\n# DGET(databaserange, fieldname, criteriarange)\n# DMAX(databaserange, fieldname, criteriarange)\n# DMIN(databaserange, fieldname, criteriarange)\n# DPRODUCT(databaserange, fieldname, criteriarange)\n# DSTDEV(databaserange, fieldname, criteriarange)\n# DSTDEVP(databaserange, fieldname, criteriarange)\n# DSUM(databaserange, fieldname, criteriarange)\n# DVAR(databaserange, fieldname, criteriarange)\n# DVARP(databaserange, fieldname, criteriarange)\n#\n# Calculate all of these and then return the desired one (overhead is in accessing not calculating)\n# If this routine is changed, check the series_functions, too.\n#\n*/\n\nSocialCalc.Formula.DSeriesFunctions = function(fname, operand, foperand, sheet) {\n\n   var value1, tostype, cr, dbrange, fieldname, criteriarange, dbinfo, criteriainfo;\n   var fieldasnum, targetcol, i, j, k, cell, criteriafieldnums;\n   var testok, criteriacr, criteria, testcol, testcr;\n   var t;\n\n   var scf = SocialCalc.Formula;\n   var operand_value_and_type = scf.OperandValueAndType;\n   var lookup_result_type = scf.LookupResultType;\n   var typelookupplus = scf.TypeLookupTable.plus;\n\n   var PushOperand = function(t, v) {operand.push({type: t, value: v});};\n\n   var value1 = {};\n\n   var sum = 0;\n   var resulttypesum = \"\";\n   var count = 0;\n   var counta = 0;\n   var countblank = 0;\n   var product = 1;\n   var maxval;\n   var minval;\n   var mk, sk, mk1, sk1; // For variance, etc.: M sub k, k-1, and S sub k-1\n                         // as per Knuth \"The Art of Computer Programming\" Vol. 2 3rd edition, page 232\n\n   dbrange = scf.TopOfStackValueAndType(sheet, foperand); // get a range\n   fieldname = scf.OperandValueAndType(sheet, foperand); // get a value\n   criteriarange = scf.TopOfStackValueAndType(sheet, foperand); // get a range\n\n   if (dbrange.type != \"range\" || criteriarange.type != \"range\") {\n      return scf.FunctionArgsError(fname, operand);\n      }\n\n   dbinfo = scf.DecodeRangeParts(sheet, dbrange.value);\n   criteriainfo = scf.DecodeRangeParts(sheet, criteriarange.value);\n\n   fieldasnum = scf.FieldToColnum(dbinfo.sheetdata, dbinfo.col1num, dbinfo.ncols, dbinfo.row1num, fieldname.value, fieldname.type);\n   if (fieldasnum <= 0) {\n      PushOperand(\"e#VALUE!\", 0);\n      return;\n      }\n\n   targetcol = dbinfo.col1num + fieldasnum - 1;\n   criteriafieldnums = [];\n\n   for (i=0; i<criteriainfo.ncols; i++) { // get criteria field colnums\n      cell = criteriainfo.sheetdata.GetAssuredCell(SocialCalc.crToCoord(criteriainfo.col1num + i, criteriainfo.row1num));\n      criterianum = scf.FieldToColnum(dbinfo.sheetdata, dbinfo.col1num, dbinfo.ncols, dbinfo.row1num, cell.datavalue, cell.valuetype);\n      if (criterianum <= 0) {\n         PushOperand(\"e#VALUE!\", 0);\n         return;\n         }\n      criteriafieldnums.push(dbinfo.col1num + criterianum - 1);\n      }\n\n   for (i=1; i<dbinfo.nrows; i++) { // go through each row of the database\n      testok = false;\nCRITERIAROW:\n      for (j=1; j<criteriainfo.nrows; j++) { // go through each criteria row\n         for (k=0; k<criteriainfo.ncols; k++) { // look at each column\n            criteriacr = SocialCalc.crToCoord(criteriainfo.col1num + k, criteriainfo.row1num + j); // where criteria is\n            cell = criteriainfo.sheetdata.GetAssuredCell(criteriacr);\n            criteria = cell.datavalue;\n            if (typeof criteria == \"string\" && criteria.length == 0) continue; // blank items are OK\n            testcol = criteriafieldnums[k];\n            testcr = SocialCalc.crToCoord(testcol, dbinfo.row1num + i); // cell to check\n            cell = criteriainfo.sheetdata.GetAssuredCell(testcr);\n            if (!scf.TestCriteria(cell.datavalue, cell.valuetype || \"b\", criteria)) {\n               continue CRITERIAROW; // does not meet criteria - check next row\n               }\n            }\n         testok = true; // met all the criteria\n         break CRITERIAROW;\n         }\n      if (!testok) {\n         continue;\n         }\n\n      cr = SocialCalc.crToCoord(targetcol, dbinfo.row1num + i); // get cell of this row to do the function on\n      cell = dbinfo.sheetdata.GetAssuredCell(cr);\n\n      value1.value = cell.datavalue;\n      value1.type = cell.valuetype;\n      t = value1.type.charAt(0);\n      if (t == \"n\") count += 1;\n      if (t != \"b\") counta += 1;\n      if (t == \"b\") countblank += 1;\n\n      if (t == \"n\") {\n         v1 = value1.value-0; // get it as a number\n         sum += v1;\n         product *= v1;\n         maxval = (maxval!=undefined) ? (v1 > maxval ? v1 : maxval) : v1;\n         minval = (minval!=undefined) ? (v1 < minval ? v1 : minval) : v1;\n         if (count == 1) { // initialize with first values for variance used in STDEV, VAR, etc.\n            mk1 = v1;\n            sk1 = 0;\n            }\n         else { // Accumulate S sub 1 through n as per Knuth noted above\n            mk = mk1 + (v1 - mk1) / count;\n            sk = sk1 + (v1 - mk1) * (v1 - mk);\n            sk1 = sk;\n            mk1 = mk;\n            }\n         resulttypesum = lookup_result_type(value1.type, resulttypesum || value1.type, typelookupplus);\n         }\n      else if (t == \"e\" && resulttypesum.charAt(0) != \"e\") {\n         resulttypesum = value1.type;\n         }\n      }\n\n   resulttypesum = resulttypesum || \"n\";\n\n   switch (fname) {\n      case \"DSUM\":\n         PushOperand(resulttypesum, sum);\n         break;\n\n      case \"DPRODUCT\": // may handle cases with text differently than some other spreadsheets\n         PushOperand(resulttypesum, product);\n         break;\n\n      case \"DMIN\":\n         PushOperand(resulttypesum, minval || 0);\n         break;\n\n      case \"DMAX\":\n         PushOperand(resulttypesum, maxval || 0);\n         break;\n\n      case \"DCOUNT\":\n         PushOperand(\"n\", count);\n         break;\n\n      case \"DCOUNTA\":\n         PushOperand(\"n\", counta);\n         break;\n\n      case \"DAVERAGE\":\n         if (count > 0) {\n            PushOperand(resulttypesum, sum/count);\n            }\n         else {\n            PushOperand(\"e#DIV/0!\", 0);\n            }\n         break;\n\n      case \"DSTDEV\":\n         if (count > 1) {\n            PushOperand(resulttypesum, Math.sqrt(sk / (count - 1))); // sk is never negative according to Knuth\n            }\n         else {\n            PushOperand(\"e#DIV/0!\", 0);\n            }\n         break;\n\n      case \"DSTDEVP\":\n         if (count > 1) {\n            PushOperand(resulttypesum, Math.sqrt(sk / count));\n            }\n         else {\n            PushOperand(\"e#DIV/0!\", 0);\n            }\n         break;\n\n      case \"DVAR\":\n         if (count > 1) {\n            PushOperand(resulttypesum, sk / (count - 1));\n            }\n         else {\n            PushOperand(\"e#DIV/0!\", 0);\n            }\n         break;\n\n      case \"DVARP\":\n         if (count > 1) {\n            PushOperand(resulttypesum, sk / count);\n            }\n         else {\n            PushOperand(\"e#DIV/0!\", 0);\n            }\n         break;\n\n      case \"DGET\":\n         if (count == 1) {\n            PushOperand(resulttypesum, sum);\n            }\n         else if (count == 0) {\n            PushOperand(\"e#VALUE!\", 0);\n            }\n         else {\n            PushOperand(\"e#NUM!\", 0);\n            }\n         break;\n\n      }\n\n   return;\n\n   }\n\nSocialCalc.Formula.FunctionList[\"DAVERAGE\"] = [SocialCalc.Formula.DSeriesFunctions, 3, \"dfunc\", \"\", \"stat\"];\nSocialCalc.Formula.FunctionList[\"DCOUNT\"] = [SocialCalc.Formula.DSeriesFunctions, 3, \"dfunc\", \"\", \"stat\"];\nSocialCalc.Formula.FunctionList[\"DCOUNTA\"] = [SocialCalc.Formula.DSeriesFunctions, 3, \"dfunc\", \"\", \"stat\"];\nSocialCalc.Formula.FunctionList[\"DGET\"] = [SocialCalc.Formula.DSeriesFunctions, 3, \"dfunc\", \"\", \"stat\"];\nSocialCalc.Formula.FunctionList[\"DMAX\"] = [SocialCalc.Formula.DSeriesFunctions, 3, \"dfunc\", \"\", \"stat\"];\nSocialCalc.Formula.FunctionList[\"DMIN\"] = [SocialCalc.Formula.DSeriesFunctions, 3, \"dfunc\", \"\", \"stat\"];\nSocialCalc.Formula.FunctionList[\"DPRODUCT\"] = [SocialCalc.Formula.DSeriesFunctions, 3, \"dfunc\", \"\", \"stat\"];\nSocialCalc.Formula.FunctionList[\"DSTDEV\"] = [SocialCalc.Formula.DSeriesFunctions, 3, \"dfunc\", \"\", \"stat\"];\nSocialCalc.Formula.FunctionList[\"DSTDEVP\"] = [SocialCalc.Formula.DSeriesFunctions, 3, \"dfunc\", \"\", \"stat\"];\nSocialCalc.Formula.FunctionList[\"DSUM\"] = [SocialCalc.Formula.DSeriesFunctions, 3, \"dfunc\", \"\", \"stat\"];\nSocialCalc.Formula.FunctionList[\"DVAR\"] = [SocialCalc.Formula.DSeriesFunctions, 3, \"dfunc\", \"\", \"stat\"];\nSocialCalc.Formula.FunctionList[\"DVARP\"] = [SocialCalc.Formula.DSeriesFunctions, 3, \"dfunc\", \"\", \"stat\"];\n\n/*\n#\n# colnum = SocialCalc.Formula.FieldToColnum(sheet, col1num, ncols, row1num, fieldname, fieldtype)\n#\n# If fieldname is a number, uses it, otherwise looks up string in cells in row to find field number\n#\n# If not found, returns 0.\n#\n*/\n\nSocialCalc.Formula.FieldToColnum = function(sheet, col1num, ncols, row1num, fieldname, fieldtype) {\n\n   var colnum, cell, value;\n\n   if (fieldtype.charAt(0) == \"n\") { // number - return it if legal\n      colnum = fieldname - 0; // make sure a number\n      if (colnum <= 0 || colnum > ncols) {\n         return 0;\n         }\n      return Math.floor(colnum);\n      }\n\n   if (fieldtype.charAt(0) != \"t\") { // must be text otherwise\n      return 0;\n      }\n\n   fieldname = fieldname ? fieldname.toLowerCase() : \"\";\n\n   for (colnum=0; colnum < ncols; colnum++) { // look through column headers for a match\n      cell = sheet.GetAssuredCell(SocialCalc.crToCoord(col1num+colnum, row1num));\n      value = cell.datavalue;\n      value = (value+\"\").toLowerCase(); // ignore case\n      if (value == fieldname) { // match\n         return colnum+1;\n         }         \n      }\n   return 0; // looked at all and no match\n\n   }\n\n\n/*\n#\n# HLOOKUP(value, range, row, [rangelookup])\n# VLOOKUP(value, range, col, [rangelookup])\n# MATCH(value, range, [rangelookup])\n#\n*/\n\nSocialCalc.Formula.LookupFunctions = function(fname, operand, foperand, sheet) {\n\n   var lookupvalue, range, offset, rangelookup, offsetvalue, rangeinfo;\n   var c, r, cincr, rincr, previousOK, csave, rsave, cell, value, valuetype, cr, lookupvalue;\n\n   var scf = SocialCalc.Formula;\n   var operand_value_and_type = scf.OperandValueAndType;\n   var lookup_result_type = scf.LookupResultType;\n   var typelookupplus = scf.TypeLookupTable.plus;\n\n   var PushOperand = function(t, v) {operand.push({type: t, value: v});};\n\n   lookupvalue = operand_value_and_type(sheet, foperand);\n   if (typeof lookupvalue.value == \"string\") {\n      lookupvalue.value = lookupvalue.value.toLowerCase();\n      }\n\n   range = scf.TopOfStackValueAndType(sheet, foperand);\n\n   rangelookup = 1; // default to true or 1\n   if (fname == \"MATCH\") {\n      if (foperand.length) {\n         rangelookup = scf.OperandAsNumber(sheet, foperand);\n         if (rangelookup.type.charAt(0) != \"n\") {\n            PushOperand(\"e#VALUE!\", 0);\n            return;\n            }\n         if (foperand.length) {\n            scf.FunctionArgsError(fname, operand);\n            return 0;\n            }\n         rangelookup = rangelookup.value - 0;\n         }\n      }\n   else {\n      offsetvalue = scf.OperandAsNumber(sheet, foperand);\n      if (offsetvalue.type.charAt(0) != \"n\") {\n         PushOperand(\"e#VALUE!\", 0);\n         return;\n         }\n      offsetvalue = Math.floor(offsetvalue.value);\n      if (foperand.length) {\n         rangelookup = scf.OperandAsNumber(sheet, foperand);\n         if (rangelookup.type.charAt(0) != \"n\") {\n            PushOperand(\"e#VALUE!\", 0);\n            return;\n            }\n         if (foperand.length) {\n            scf.FunctionArgsError(fname, operand);\n            return 0;\n            }\n         rangelookup = rangelookup.value ? 1 : 0; // convert to 1 or 0\n         }\n      }\n   lookupvalue.type = lookupvalue.type.charAt(0); // only deal with general type\n   if (lookupvalue.type == \"n\") { // if number, make sure a number\n      lookupvalue.value = lookupvalue.value - 0;\n      }\n\n   if (range.type != \"range\") {\n      scf.FunctionArgsError(fname, operand);\n      return 0;\n      }\n\n   rangeinfo = scf.DecodeRangeParts(sheet, range.value, range.type);\n   if (!rangeinfo) {\n      PushOperand(\"e#REF!\", 0);\n      return;\n      }\n\n   c = 0;\n   r = 0;\n   cincr = 0;\n   rincr = 0;\n   if (fname == \"HLOOKUP\") {\n      cincr = 1;\n      if (offsetvalue > rangeinfo.nrows) {\n         PushOperand(\"e#REF!\", 0);\n         return;\n         }\n      }\n   else if (fname == \"VLOOKUP\") {\n      rincr = 1;\n      if (offsetvalue > rangeinfo.ncols) {\n         PushOperand(\"e#REF!\", 0);\n         return;\n         }\n      }\n   else if (fname == \"MATCH\") {\n      if (rangeinfo.ncols > 1) {\n         if (rangeinfo.nrows > 1) {\n            PushOperand(\"e#N/A\", 0);\n            return;\n            }\n         cincr = 1;\n         }\n      else {\n         rincr = 1;\n         }\n      }\n   else {\n      scf.FunctionArgsError(fname, operand);\n      return 0;\n      }\n   if (offsetvalue < 1 && fname != \"MATCH\") {\n      PushOperand(\"e#VALUE!\", 0);\n      return 0;\n      }\n\n   previousOK; // if 1, previous test was <. If 2, also this one wasn't\n\n   while (1) {\n      cr = SocialCalc.crToCoord(rangeinfo.col1num + c, rangeinfo.row1num + r);\n      cell = rangeinfo.sheetdata.GetAssuredCell(cr);\n      value = cell.datavalue;\n      valuetype = cell.valuetype ? cell.valuetype.charAt(0) : \"b\"; // only deal with general types\n      if (valuetype == \"n\") {\n         value = value - 0; // make sure number\n         }\n      if (rangelookup) { // rangelookup type 1 or -1: look for within brackets for matches\n         if (lookupvalue.type == \"n\" && valuetype == \"n\") {\n            if (lookupvalue.value == value) { // match\n               break;\n               }\n            if ((rangelookup > 0 && lookupvalue.value > value)\n                || (rangelookup < 0 && lookupvalue.value < value)) { // possible match: wait and see\n               previousOK = 1;\n               csave = c; // remember col and row of last OK\n               rsave = r;\n               }\n            else if (previousOK) { // last one was OK, this one isn't\n               previousOK = 2;\n               break;\n               }\n            }\n\n         else if (lookupvalue.type == \"t\" && valuetype == \"t\") {\n            value = typeof value == \"string\" ? value.toLowerCase() : \"\";\n            if (lookupvalue.value == value) { // match\n               break;\n               }\n            if ((rangelookup > 0 && lookupvalue.value > value)\n                || (rangelookup < 0 && lookupvalue.value < value)) { // possible match: wait and see\n               previousOK = 1;\n               csave = c;\n               rsave = r;\n               }\n            else if (previousOK) { // last one was OK, this one isn't\n               previousOK = 2;\n               break;\n               }\n            }\n         }\n      else { // exact value matches\n         if (lookupvalue.type == \"n\" && valuetype == \"n\") {\n            if (lookupvalue.value == value) { // match\n               break;\n               }\n            }\n         else if (lookupvalue.type == \"t\" && valuetype == \"t\") {\n            value = typeof value == \"string\" ? value.toLowerCase() : \"\";\n            if (lookupvalue.value == value) { // match\n               break;\n               }\n            }\n         }\n\n      r += rincr;\n      c += cincr;\n      if (r >= rangeinfo.nrows || c >= rangeinfo.ncols) { // end of range to check, no exact match\n         if (previousOK) { // at least one could have been OK\n            previousOK = 2;\n            break;\n            }\n         PushOperand(\"e#N/A\", 0);\n         return;\n         }\n      }\n\n   if (previousOK == 2) { // back to last OK\n      r = rsave;\n      c = csave;\n      }\n\n   if (fname == \"MATCH\") {\n      value = c + r + 1; // only one may be <> 0\n      valuetype = \"n\";\n      }\n   else {\n      cr = SocialCalc.crToCoord(rangeinfo.col1num+c+(fname == \"VLOOKUP\" ? offsetvalue-1 : 0), rangeinfo.row1num+r+(fname == \"HLOOKUP\" ? offsetvalue-1 : 0));\n      cell = rangeinfo.sheetdata.GetAssuredCell(cr);\n      value = cell.datavalue;\n      valuetype = cell.valuetype;\n      }\n   PushOperand(valuetype, value);\n\n   return;\n\n   }\n\nSocialCalc.Formula.FunctionList[\"HLOOKUP\"] = [SocialCalc.Formula.LookupFunctions, -3, \"hlookup\", \"\", \"lookup\"];\nSocialCalc.Formula.FunctionList[\"MATCH\"] = [SocialCalc.Formula.LookupFunctions, -2, \"match\", \"\", \"lookup\"];\nSocialCalc.Formula.FunctionList[\"VLOOKUP\"] = [SocialCalc.Formula.LookupFunctions, -3, \"vlookup\", \"\", \"lookup\"];\n\n/*\n#\n# INDEX(range, rownum, colnum)\n#\n*/\n\nSocialCalc.Formula.IndexFunction = function(fname, operand, foperand, sheet) {\n\n   var range, sheetname, indexinfo, rowindex, colindex, result, resulttype;\n\n   var scf = SocialCalc.Formula;\n\n   var PushOperand = function(t, v) {operand.push({type: t, value: v});};\n\n   range = scf.TopOfStackValueAndType(sheet, foperand); // get range\n   if (range.type != \"range\") {\n      scf.FunctionArgsError(fname, operand);\n      return 0;\n      }\n   indexinfo = scf.DecodeRangeParts(sheet, range.value, range.type);\n   if (indexinfo.sheetname) {\n      sheetname = \"!\" + indexinfo.sheetname;\n      }\n   else {\n      sheetname = \"\";\n      }\n\n   rowindex = {value:0};\n   colindex = {value:0};\n\n   if (foperand.length) { // look for row number\n      rowindex = scf.OperandAsNumber(sheet, foperand);\n      if (rowindex.type.charAt(0) != \"n\" || rowindex.value < 0) {\n         PushOperand(\"e#VALUE!\", 0);\n         return;\n         }\n      if (foperand.length) { // look for col number\n         colindex = scf.OperandAsNumber(sheet, foperand);\n         if (colindex.type.charAt(0) != \"n\" || colindex.value < 0) {\n            PushOperand(\"e#VALUE!\", 0);\n            return;\n            }\n         if (foperand.length) {\n            scf.FunctionArgsError(fname, operand);\n            return 0;\n            }\n         }\n      else { // col number missing\n         if (indexinfo.nrows == 1) { // if only one row, then rowindex is really colindex\n            colindex.value = rowindex.value;\n            rowindex.value = 0;\n            }\n         }\n      }\n\n   if (rowindex.value > indexinfo.nrows || colindex.value > indexinfo.ncols) {\n      PushOperand(\"e#REF!\", 0);\n      return;\n      }\n\n   if (rowindex.value == 0) {\n      if (colindex.value == 0) {\n         if (indexinfo.nrows == 1 && indexinfo.ncols == 1) {\n            result = SocialCalc.crToCoord(indexinfo.col1num, indexinfo.row1num) + sheetname;\n            resulttype = \"coord\";\n            }\n         else {\n            result = SocialCalc.crToCoord(indexinfo.col1num, indexinfo.row1num) + sheetname + \"|\" +\n                     SocialCalc.crToCoord(indexinfo.col1num+indexinfo.ncols-1, indexinfo.row1num+indexinfo.nrows-1) + \n                     \"|\";\n            resulttype = \"range\";\n            }\n         }\n      else {\n         if (indexinfo.nrows == 1) {\n            result = SocialCalc.crToCoord(indexinfo.col1num+colindex.value-1, indexinfo.row1num) + sheetname;\n            resulttype = \"coord\";\n            }\n         else {\n            result = SocialCalc.crToCoord(indexinfo.col1num+colindex.value-1, indexinfo.row1num) + sheetname + \"|\" +\n                     SocialCalc.crToCoord(indexinfo.col1num+colindex.value-1, indexinfo.row1num+indexinfo.nrows-1) +\n                     \"|\";\n            resulttype = \"range\";\n            }\n         }\n      }\n   else {\n      if (colindex.value == 0) {\n         if (indexinfo.ncols == 1) {\n            result = SocialCalc.crToCoord(indexinfo.col1num, indexinfo.row1num+rowindex.value-1) + sheetname;\n            resulttype = \"coord\";\n            }\n         else {\n            result = SocialCalc.crToCoord(indexinfo.col1num, indexinfo.row1num+rowindex.value-1) + sheetname + \"|\" +\n                     SocialCalc.crToCoord(indexinfo.col1num+indexinfo.ncols-1, indexinfo.row1num+rowindex.value-1) +\n                     \"|\";\n            resulttype = \"range\";\n            }\n         }\n      else {\n         result = SocialCalc.crToCoord(indexinfo.col1num+colindex.value-1, indexinfo.row1num+rowindex.value-1) + sheetname;\n         resulttype = \"coord\";\n         }\n      }\n\n   PushOperand(resulttype, result);\n\n   return;\n\n   }\n\nSocialCalc.Formula.FunctionList[\"INDEX\"] = [SocialCalc.Formula.IndexFunction, -1, \"index\", \"\", \"lookup\"];\n\n/*\n#\n# COUNTIF(c1:c2,\"criteria\")\n# SUMIF(c1:c2,\"criteria\",[range2])\n#\n*/\n\nSocialCalc.Formula.CountifSumifFunctions = function(fname, operand, foperand, sheet) {\n\n   var range, criteria, sumrange, f2operand, result, resulttype, value1, value2;\n   var sum = 0;\n   var resulttypesum = \"\";\n   var count = 0;\n\n   var scf = SocialCalc.Formula;\n   var operand_value_and_type = scf.OperandValueAndType;\n   var lookup_result_type = scf.LookupResultType;\n   var typelookupplus = scf.TypeLookupTable.plus;\n\n   var PushOperand = function(t, v) {operand.push({type: t, value: v});};\n\n   range = scf.TopOfStackValueAndType(sheet, foperand); // get range or coord\n   criteria = scf.OperandAsText(sheet, foperand); // get criteria\n   if (fname == \"SUMIF\") {\n      if (foperand.length == 1) { // three arg form of SUMIF\n         sumrange = scf.TopOfStackValueAndType(sheet, foperand);\n         }\n      else if (foperand.length == 0) { // two arg form\n         sumrange = {value: range.value, type: range.type};\n         }\n      else {\n         scf.FunctionArgsError(fname, operand);\n         return 0;\n         }\n      }\n   else {\n      sumrange = {value: range.value, type: range.type};\n      }\n\n   if (criteria.type.charAt(0) == \"n\") {\n      criteria.value = criteria.value + \"\"; // make text\n      }\n   else if (criteria.type.charAt(0) == \"e\") { // error\n      criteria.value = null;\n      }\n   else if (criteria.type.charAt(0) == \"b\") { // blank here is undefined\n      criteria.value = null;\n      }\n\n   if (range.type != \"coord\" && range.type != \"range\") {\n      scf.FunctionArgsError(fname, operand);\n      return 0;\n      }\n\n   if (fname == \"SUMIF\" && sumrange.type != \"coord\" && sumrange.type != \"range\") {\n      scf.FunctionArgsError(fname, operand);\n      return 0;\n      }\n\n   foperand.push(range);\n   f2operand = []; // to allow for 3 arg form\n   f2operand.push(sumrange);\n\n   while (foperand.length) {\n      value1 = operand_value_and_type(sheet, foperand);\n      value2 = operand_value_and_type(sheet, f2operand);\n\n      if (!scf.TestCriteria(value1.value, value1.type, criteria.value)) {\n         continue;\n         }\n\n      count += 1;\n\n      if (value2.type.charAt(0) == \"n\") {\n         sum += value2.value-0;\n         resulttypesum = lookup_result_type(value2.type, resulttypesum || value2.type, typelookupplus);\n         }\n      else if (value2.type.charAt(0) == \"e\" && resulttypesum.charAt(0) != \"e\") {\n         resulttypesum = value2.type;\n         }\n      }\n\n   resulttypesum = resulttypesum || \"n\";\n\n   if (fname == \"SUMIF\") {\n      PushOperand(resulttypesum, sum);\n      }\n   else if (fname == \"COUNTIF\") {\n      PushOperand(\"n\", count);\n      }\n\n   return;\n\n   }\n\nSocialCalc.Formula.FunctionList[\"COUNTIF\"] = [SocialCalc.Formula.CountifSumifFunctions, 2, \"rangec\", \"\", \"stat\"];\nSocialCalc.Formula.FunctionList[\"SUMIF\"] = [SocialCalc.Formula.CountifSumifFunctions, -2, \"sumif\", \"\", \"stat\"];\n\n/*\n#\n# IF(cond,truevalue,falsevalue)\n#\n*/\n\nSocialCalc.Formula.IfFunction = function(fname, operand, foperand, sheet) {\n\n   var cond, t;\n\n   cond = SocialCalc.Formula.OperandValueAndType(sheet, foperand);\n   t = cond.type.charAt(0);\n   if (t != \"n\" && t != \"b\") {\n      operand.push({type: \"e#VALUE!\", value: 0});\n      return;\n      }\n\n   if (!cond.value) foperand.pop();\n   operand.push(foperand.pop());\n   if (cond.value) foperand.pop();\n\n   return null;\n\n   }\n\n// Add to function list\nSocialCalc.Formula.FunctionList[\"IF\"] = [SocialCalc.Formula.IfFunction, 3, \"iffunc\", \"\", \"test\"];\n\n/*\n#\n# DATE(year,month,day)\n#\n*/\n\nSocialCalc.Formula.DateFunction = function(fname, operand, foperand, sheet) {\n\n   var scf = SocialCalc.Formula;\n   var result = 0;\n   var year = scf.OperandAsNumber(sheet, foperand);\n   var month = scf.OperandAsNumber(sheet, foperand);\n   var day = scf.OperandAsNumber(sheet, foperand);\n   var resulttype = scf.LookupResultType(year.type, month.type, scf.TypeLookupTable.twoargnumeric);\n   resulttype = scf.LookupResultType(resulttype, day.type, scf.TypeLookupTable.twoargnumeric);\n   if (resulttype.charAt(0) == \"n\") {\n      result = SocialCalc.FormatNumber.convert_date_gregorian_to_julian(\n                  Math.floor(year.value), Math.floor(month.value), Math.floor(day.value)\n                  ) - SocialCalc.FormatNumber.datevalues.julian_offset;\n      resulttype = \"nd\";\n      }\n   scf.PushOperand(operand, resulttype, result);\n   return;\n\n   }\n\nSocialCalc.Formula.FunctionList[\"DATE\"] = [SocialCalc.Formula.DateFunction, 3, \"date\", \"\", \"datetime\"];\n\n/*\n#\n# TIME(hour,minute,second)\n#\n*/\n\nSocialCalc.Formula.TimeFunction = function(fname, operand, foperand, sheet) {\n\n   var scf = SocialCalc.Formula;\n   var result = 0;\n   var hours = scf.OperandAsNumber(sheet, foperand);\n   var minutes = scf.OperandAsNumber(sheet, foperand);\n   var seconds = scf.OperandAsNumber(sheet, foperand);\n   var resulttype = scf.LookupResultType(hours.type, minutes.type, scf.TypeLookupTable.twoargnumeric);\n   resulttype = scf.LookupResultType(resulttype, seconds.type, scf.TypeLookupTable.twoargnumeric);\n   if (resulttype.charAt(0) == \"n\") {\n      result = ((hours.value * 60 * 60) + (minutes.value * 60) + seconds.value) / (24*60*60);\n      resulttype = \"nt\";\n      }\n   scf.PushOperand(operand, resulttype, result);\n   return;\n\n   }\n\nSocialCalc.Formula.FunctionList[\"TIME\"] = [SocialCalc.Formula.TimeFunction, 3, \"hms\", \"\", \"datetime\"];\n\n/*\n#\n# DAY(date)\n# MONTH(date)\n# YEAR(date)\n# WEEKDAY(date, [type])\n#\n*/\n\nSocialCalc.Formula.DMYFunctions = function(fname, operand, foperand, sheet) {\n\n   var ymd, dtype, doffset;\n   var scf = SocialCalc.Formula;\n   var result = 0;\n\n   var datevalue = scf.OperandAsNumber(sheet, foperand);\n   var resulttype = scf.LookupResultType(datevalue.type, datevalue.type, scf.TypeLookupTable.oneargnumeric);\n\n   if (resulttype.charAt(0) == \"n\") {\n      ymd = SocialCalc.FormatNumber.convert_date_julian_to_gregorian(\n               Math.floor(datevalue.value + SocialCalc.FormatNumber.datevalues.julian_offset));\n      switch (fname) {\n         case \"DAY\":\n            result = ymd.day;\n            break;\n\n         case \"MONTH\":\n            result = ymd.month;\n            break;\n\n         case \"YEAR\":\n            result = ymd.year;\n            break;\n\n         case \"WEEKDAY\":\n            dtype = {value: 1};\n            if (foperand.length) { // get type if present\n               dtype = scf.OperandAsNumber(sheet, foperand);\n               if (dtype.type.charAt(0) != \"n\" || dtype.value < 1 || dtype.value > 3) {\n                  scf.PushOperand(operand, \"e#VALUE!\", 0);\n                  return;\n                  }\n               if (foperand.length) { // extra args\n                  scf.FunctionArgsError(fname, operand);\n                  return;\n                  }\n               }\n            doffset = 6;\n            if (dtype.value > 1) {\n               doffset -= 1;\n               }\n            result = Math.floor(datevalue.value+doffset) % 7 + (dtype.value < 3 ? 1 : 0);\n            break;\n         }\n      }\n\n   scf.PushOperand(operand, resulttype, result);\n   return;\n\n   }\n\nSocialCalc.Formula.FunctionList[\"DAY\"] = [SocialCalc.Formula.DMYFunctions, 1, \"v\", \"\", \"datetime\"];\nSocialCalc.Formula.FunctionList[\"MONTH\"] = [SocialCalc.Formula.DMYFunctions, 1, \"v\", \"\", \"datetime\"];\nSocialCalc.Formula.FunctionList[\"YEAR\"] = [SocialCalc.Formula.DMYFunctions, 1, \"v\", \"\", \"datetime\"];\nSocialCalc.Formula.FunctionList[\"WEEKDAY\"] = [SocialCalc.Formula.DMYFunctions, -1, \"weekday\", \"\", \"datetime\"];\n\n/*\n#\n# HOUR(datetime)\n# MINUTE(datetime)\n# SECOND(datetime)\n#\n*/\n\nSocialCalc.Formula.HMSFunctions = function(fname, operand, foperand, sheet) {\n\n   var hours, minutes, seconds, fraction;\n   var scf = SocialCalc.Formula;\n   var result = 0;\n\n   var datetime = scf.OperandAsNumber(sheet, foperand);\n   var resulttype = scf.LookupResultType(datetime.type, datetime.type, scf.TypeLookupTable.oneargnumeric);\n\n   if (resulttype.charAt(0) == \"n\") {\n      if (datetime.value < 0) {\n         scf.PushOperand(operand, \"e#NUM!\", 0); // must be non-negative\n         return;\n         }\n      fraction = datetime.value - Math.floor(datetime.value); // fraction of a day\n      fraction *= 24;\n      hours = Math.floor(fraction);\n      fraction -= Math.floor(fraction);\n      fraction *= 60;\n      minutes = Math.floor(fraction);\n      fraction -= Math.floor(fraction);\n      fraction *= 60;\n      seconds = Math.floor(fraction + (datetime.value >= 0 ? 0.5: -0.5));\n      if (fname == \"HOUR\") {\n         result = hours;\n         }\n      else if (fname == \"MINUTE\") {\n         result = minutes;\n         }\n      else if (fname == \"SECOND\") {\n         result = seconds;\n         }\n      }\n\n   scf.PushOperand(operand, resulttype, result);\n   return;\n\n   }\n\nSocialCalc.Formula.FunctionList[\"HOUR\"] = [SocialCalc.Formula.HMSFunctions, 1, \"v\", \"\", \"datetime\"];\nSocialCalc.Formula.FunctionList[\"MINUTE\"] = [SocialCalc.Formula.HMSFunctions, 1, \"v\", \"\", \"datetime\"];\nSocialCalc.Formula.FunctionList[\"SECOND\"] = [SocialCalc.Formula.HMSFunctions, 1, \"v\", \"\", \"datetime\"];\n\n/*\n#\n# EXACT(v1,v2)\n#\n*/\n\nSocialCalc.Formula.ExactFunction = function(fname, operand, foperand, sheet) {\n\n   var scf = SocialCalc.Formula;\n   var result = 0;\n   var resulttype = \"nl\";\n\n   var value1 = scf.OperandValueAndType(sheet, foperand);\n   var v1type = value1.type.charAt(0);\n   var value2 = scf.OperandValueAndType(sheet, foperand);\n   var v2type = value2.type.charAt(0);\n\n   if (v1type == \"t\") {\n      if (v2type == \"t\") {\n         result = value1.value == value2.value ? 1 : 0;\n         }\n      else if (v2type == \"b\") {\n         result = value1.value.length ? 0 : 1;\n         }\n      else if (v2type == \"n\") {\n         result = value1.value == value2.value+\"\" ? 1 : 0;\n         }\n      else if (v2type == \"e\") {\n         result = value2.value;\n         resulttype = value2.type;\n         }\n      else {\n         result = 0;\n         }\n      }\n   else if (v1type == \"n\") {\n      if (v2type == \"n\") {\n         result = value1.value-0 == value2.value-0 ? 1 : 0;\n         }\n      else if (v2type == \"b\") {\n         result = 0;\n         }\n      else if (v2type == \"t\") {\n         result = value1.value+\"\" == value2.value ? 1 : 0;\n         }\n      else if (v2type == \"e\") {\n         result = value2.value;\n         resulttype = value2.type;\n         }\n      else {\n         result = 0;\n         }\n      }\n   else if (v1type == \"b\") {\n      if (v2type == \"t\") {\n         result = value2.value.length ? 0 : 1;\n         }\n      else if (v2type == \"b\") {\n         result = 1;\n         }\n      else if (v2type == \"n\") {\n         result = 0;\n         }\n      else if (v2type == \"e\") {\n         result = value2.value;\n         resulttype = value2.type;\n         }\n      else {\n         result = 0;\n         }\n      }\n   else if (v1type == \"e\") {\n      result = value1.value;\n      resulttype = value1.type;\n      }\n\n   scf.PushOperand(operand, resulttype, result);\n   return;\n\n   }\n\nSocialCalc.Formula.FunctionList[\"EXACT\"] = [SocialCalc.Formula.ExactFunction, 2, \"\", \"\", \"text\"];\n\n/*\n#\n# FIND(key,string,[start])\n# LEFT(string,[length])\n# LEN(string)\n# LOWER(string)\n# MID(string,start,length)\n# PROPER(string)\n# REPLACE(string,start,length,new)\n# REPT(string,count)\n# RIGHT(string,[length])\n# SUBSTITUTE(string,old,new,[which])\n# TRIM(string)\n# UPPER(string)\n#\n*/\n\n// SocialCalc.Formula.ArgList has an array for each function, one entry for each possible arg (up to max).\n// Min args are specified in SocialCalc.Formula.FunctionList.\n// If array element is 1 then it's a text argument, if it's 0 then it's numeric, if -1 then just get whatever's there\n// Text values are manipulated as UTF-8, converting from and back to byte strings\n\nSocialCalc.Formula.ArgList = {\n                FIND: [1, 1, 0],\n                LEFT: [1, 0],\n                LEN: [1],\n                LOWER: [1],\n                MID: [1, 0, 0],\n                PROPER: [1],\n                REPLACE: [1, 0, 0, 1],\n                REPT: [1, 0],\n                RIGHT: [1, 0],\n                SUBSTITUTE: [1, 1, 1, 0],\n                TRIM: [1],\n                UPPER: [1]\n               };\n\nSocialCalc.Formula.StringFunctions = function(fname, operand, foperand, sheet) {\n\n   var i, value, offset, len, start, count;\n   var scf = SocialCalc.Formula;\n   var result = 0;\n   var resulttype = \"e#VALUE!\";\n\n   var numargs = foperand.length;\n   var argdef = scf.ArgList[fname];\n   var operand_value = [];\n   var operand_type = [];\n\n   for (i=1; i <= numargs; i++) { // go through each arg, get value and type, and check for errors\n      if (i > argdef.length) { // too many args\n         scf.FunctionArgsError(fname, operand);\n         return;\n         }\n      if (argdef[i-1] == 0) {\n         value = scf.OperandAsNumber(sheet, foperand);\n         }\n      else if (argdef[i-1] == 1) {\n         value = scf.OperandAsText(sheet, foperand);\n         }\n      else if (argdef[i-1] == -1) {\n         value = scf.OperandValueAndType(sheet, foperand);\n         }\n      operand_value[i] = value.value;\n      operand_type[i] = value.type;\n      if (value.type.charAt(0) == \"e\") {\n         scf.PushOperand(operand, value.type, result);\n         return;\n         }\n      }\n\n   switch (fname) {\n      case \"FIND\":\n         offset = operand_type[3] ? operand_value[3]-1 : 0;\n         if (offset < 0) {\n            result = \"Start is before string\"; // !! not displayed, no need to translate\n            }\n         else {\n            result = operand_value[2].indexOf(operand_value[1], offset); // (null string matches first char)\n            if (result >= 0) {\n               result += 1;\n               resulttype = \"n\";\n               }\n            else {\n               result = \"Not found\"; // !! not displayed, error is e#VALUE!\n               }\n            }\n         break;\n\n      case \"LEFT\":\n         len = operand_type[2] ? operand_value[2]-0 : 1;\n         if (len < 0) {\n            result = \"Negative length\";\n            }\n         else {\n            result = operand_value[1].substring(0, len);\n            resulttype = \"t\";\n            }\n         break;\n\n      case \"LEN\":\n         result = operand_value[1].length;\n         resulttype = \"n\";\n         break;\n\n      case \"LOWER\":\n         result = operand_value[1].toLowerCase();\n         resulttype = \"t\";\n         break;\n\n      case \"MID\":\n         start = operand_value[2]-0;\n         len = operand_value[3]-0;\n         if (len < 1 || start < 1) {\n            result = \"Bad arguments\";\n            }\n         else {\n            result = operand_value[1].substring(start-1, start+len-1);\n            resulttype = \"t\";\n            }\n         break;\n\n      case \"PROPER\":\n         result = operand_value[1].replace(/\\b\\w+\\b/g, function(word) {\n                     return word.substring(0,1).toUpperCase() + \n                        word.substring(1);\n                     }); // uppercase first character of words (see JavaScript, Flanagan, 5th edition, page 704)\n         resulttype = \"t\";\n         break;\n\n      case \"REPLACE\":\n         start = operand_value[2]-0;\n         len = operand_value[3]-0;\n         if (len < 0 || start < 1) {\n            result = \"Bad arguments\";\n            }\n         else {\n            result = operand_value[1].substring(0, start-1) + operand_value[4] + \n               operand_value[1].substring(start-1+len);\n            resulttype = \"t\";\n            }\n         break;\n\n      case \"REPT\":\n         count = operand_value[2]-0;\n         if (count < 0) {\n            result = \"Negative count\";\n            }\n         else {\n            result = \"\";\n            for (; count > 0; count--) {\n               result += operand_value[1];\n               }\n            resulttype = \"t\";\n            }\n         break;\n\n      case \"RIGHT\":\n         len = operand_type[2] ? operand_value[2]-0 : 1;\n         if (len < 0) {\n            result = \"Negative length\";\n            }\n         else {\n            result = operand_value[1].slice(-len);\n            resulttype = \"t\";\n            }\n         break;\n\n      case \"SUBSTITUTE\":\n         fulltext = operand_value[1];\n         oldtext = operand_value[2];\n         newtext = operand_value[3];\n         if (operand_value[4] != null) {\n            which = operand_value[4]-0;\n            if (which <= 0) {\n               result = \"Non-positive instance number\";\n               break;\n               }\n            }\n         else {\n            which = 0;\n            }\n         count = 0;\n         oldpos = 0;\n         result = \"\";\n         while (true) {\n            pos = fulltext.indexOf(oldtext, oldpos);\n            if (pos >= 0) {\n               count++; //!!!!!! old test just in case: if (count>1000) {alert(pos); break;}\n               result += fulltext.substring(oldpos, pos);\n               if (which==0) {\n                  result += newtext; // substitute\n                  }\n               else if (which==count) {\n                  result += newtext + fulltext.substring(pos+oldtext.length);\n                  break;\n                  }\n               else {\n                  result += oldtext; // leave as was\n                  }\n               oldpos = pos + oldtext.length;\n               }\n            else { // no more\n               result += fulltext.substring(oldpos);\n               break;\n               }\n            }\n         resulttype = \"t\";\n         break;\n\n      case \"TRIM\":\n         result = operand_value[1];\n         result = result.replace(/^ */, \"\");\n         result = result.replace(/ *$/, \"\");\n         result = result.replace(/ +/g, \" \");\n         resulttype = \"t\";\n         break;\n\n      case \"UPPER\":\n         result = operand_value[1].toUpperCase();\n         resulttype = \"t\";\n         break;\n\n      }\n\n   scf.PushOperand(operand, resulttype, result);\n   return;\n\n   }\n\nSocialCalc.Formula.FunctionList[\"FIND\"] = [SocialCalc.Formula.StringFunctions, -2, \"find\", \"\", \"text\"];\nSocialCalc.Formula.FunctionList[\"LEFT\"] = [SocialCalc.Formula.StringFunctions, -2, \"tc\", \"\", \"text\"];\nSocialCalc.Formula.FunctionList[\"LEN\"] = [SocialCalc.Formula.StringFunctions, 1, \"txt\", \"\", \"text\"];\nSocialCalc.Formula.FunctionList[\"LOWER\"] = [SocialCalc.Formula.StringFunctions, 1, \"txt\", \"\", \"text\"];\nSocialCalc.Formula.FunctionList[\"MID\"] = [SocialCalc.Formula.StringFunctions, 3, \"mid\", \"\", \"text\"];\nSocialCalc.Formula.FunctionList[\"PROPER\"] = [SocialCalc.Formula.StringFunctions, 1, \"v\", \"\", \"text\"];\nSocialCalc.Formula.FunctionList[\"REPLACE\"] = [SocialCalc.Formula.StringFunctions, 4, \"replace\", \"\", \"text\"];\nSocialCalc.Formula.FunctionList[\"REPT\"] = [SocialCalc.Formula.StringFunctions, 2, \"tc\", \"\", \"text\"];\nSocialCalc.Formula.FunctionList[\"RIGHT\"] = [SocialCalc.Formula.StringFunctions, -1, \"tc\", \"\", \"text\"];\nSocialCalc.Formula.FunctionList[\"SUBSTITUTE\"] = [SocialCalc.Formula.StringFunctions, -3, \"subs\", \"\", \"text\"];\nSocialCalc.Formula.FunctionList[\"TRIM\"] = [SocialCalc.Formula.StringFunctions, 1, \"v\", \"\", \"text\"];\nSocialCalc.Formula.FunctionList[\"UPPER\"] = [SocialCalc.Formula.StringFunctions, 1, \"v\", \"\", \"text\"];\n\n/*\n#\n# is_functions:\n#\n# ISBLANK(value)\n# ISERR(value)\n# ISERROR(value)\n# ISLOGICAL(value)\n# ISNA(value)\n# ISNONTEXT(value)\n# ISNUMBER(value)\n# ISTEXT(value)\n#\n*/\n\nSocialCalc.Formula.IsFunctions = function(fname, operand, foperand, sheet) {\n\n   var scf = SocialCalc.Formula;\n   var result = 0;\n   var resulttype = \"nl\";\n\n   var value = scf.OperandValueAndType(sheet, foperand);\n   var t = value.type.charAt(0);\n\n   switch (fname) {\n\n      case \"ISBLANK\":\n         result = value.type == \"b\" ? 1 : 0;\n         break;\n\n      case \"ISERR\":\n         result = t == \"e\" ? (value.type == \"e#N/A\" ? 0 : 1) : 0;\n         break;\n\n      case \"ISERROR\":\n         result = t == \"e\" ? 1 : 0;\n         break;\n\n      case \"ISLOGICAL\":\n         result = value.type == \"nl\" ? 1 : 0;\n         break;\n\n      case \"ISNA\":\n         result = value.type == \"e#N/A\" ? 1 : 0;\n         break;\n\n      case \"ISNONTEXT\":\n         result = t == \"t\" ? 0 : 1;\n         break;\n\n      case \"ISNUMBER\":\n         result = t == \"n\" ? 1 : 0;\n         break;\n\n      case \"ISTEXT\":\n         result = t == \"t\" ? 1 : 0;\n         break;\n      }\n\n   scf.PushOperand(operand, resulttype, result);\n\n   return;\n\n   }\n\nSocialCalc.Formula.FunctionList[\"ISBLANK\"] = [SocialCalc.Formula.IsFunctions, 1, \"v\", \"\", \"test\"];\nSocialCalc.Formula.FunctionList[\"ISERR\"] = [SocialCalc.Formula.IsFunctions, 1, \"v\", \"\", \"test\"];\nSocialCalc.Formula.FunctionList[\"ISERROR\"] = [SocialCalc.Formula.IsFunctions, 1, \"v\", \"\", \"test\"];\nSocialCalc.Formula.FunctionList[\"ISLOGICAL\"] = [SocialCalc.Formula.IsFunctions, 1, \"v\", \"\", \"test\"];\nSocialCalc.Formula.FunctionList[\"ISNA\"] = [SocialCalc.Formula.IsFunctions, 1, \"v\", \"\", \"test\"];\nSocialCalc.Formula.FunctionList[\"ISNONTEXT\"] = [SocialCalc.Formula.IsFunctions, 1, \"v\", \"\", \"test\"];\nSocialCalc.Formula.FunctionList[\"ISNUMBER\"] = [SocialCalc.Formula.IsFunctions, 1, \"v\", \"\", \"test\"];\nSocialCalc.Formula.FunctionList[\"ISTEXT\"] = [SocialCalc.Formula.IsFunctions, 1, \"v\", \"\", \"test\"];\n\n/*\n#\n# ntv_functions:\n#\n# N(value)\n# T(value)\n# VALUE(value)\n#\n*/\n\nSocialCalc.Formula.NTVFunctions = function(fname, operand, foperand, sheet) {\n\n   var scf = SocialCalc.Formula;\n   var result = 0;\n   var resulttype = \"e#VALUE!\";\n\n   var value = scf.OperandValueAndType(sheet, foperand);\n   var t = value.type.charAt(0);\n\n   switch (fname) {\n\n      case \"N\":\n         result = t == \"n\" ? value.value-0 : 0;\n         resulttype = \"n\";\n         break;\n\n      case \"T\":\n         result = t == \"t\" ? value.value+\"\" : \"\";\n         resulttype = \"t\";\n         break;\n\n      case \"VALUE\":\n         if (t == \"n\" || t == \"b\") {\n            result = value.value || 0;\n            resulttype = \"n\";\n            }\n         else if (t == \"t\") {\n            value = SocialCalc.DetermineValueType(value.value);\n            if (value.type.charAt(0) != \"n\") {\n               result = 0;\n               resulttype = \"e#VALUE!\";\n               }\n            else {\n               result = value.value-0;\n               resulttype = \"n\";\n               }\n            }\n         break;\n      }\n\n   if (t == \"e\") { // error trumps\n      resulttype = value.type;\n      }\n\n   scf.PushOperand(operand, resulttype, result);\n\n   return;\n\n   }\n\nSocialCalc.Formula.FunctionList[\"N\"] = [SocialCalc.Formula.NTVFunctions, 1, \"v\", \"\", \"math\"];\nSocialCalc.Formula.FunctionList[\"T\"] = [SocialCalc.Formula.NTVFunctions, 1, \"v\", \"\", \"text\"];\nSocialCalc.Formula.FunctionList[\"VALUE\"] = [SocialCalc.Formula.NTVFunctions, 1, \"v\", \"\", \"text\"];\n\n/*\n#\n# ABS(value)\n# ACOS(value)\n# ASIN(value)\n# ATAN(value)\n# COS(value)\n# DEGREES(value)\n# EVEN(value)\n# EXP(value)\n# FACT(value)\n# INT(value)\n# LN(value)\n# LOG10(value)\n# ODD(value)\n# RADIANS(value)\n# SIN(value)\n# SQRT(value)\n# TAN(value)\n#\n*/\n\nSocialCalc.Formula.Math1Functions = function(fname, operand, foperand, sheet) {\n\n   var v1, value, f;\n   var result = {};\n\n   var scf = SocialCalc.Formula;\n\n   v1 = scf.OperandAsNumber(sheet, foperand);\n   value = v1.value;\n   result.type = scf.LookupResultType(v1.type, v1.type, scf.TypeLookupTable.oneargnumeric);\n\n   if (result.type == \"n\") {\n      switch (fname) {\n         case \"ABS\":\n            value = Math.abs(value);\n            break;\n\n         case \"ACOS\":\n            if (value >= -1 && value <= 1) {\n               value = Math.acos(value);\n               }\n            else {\n               result.type = \"e#NUM!\";\n               }\n            break;\n\n         case \"ASIN\":\n            if (value >= -1 && value <= 1) {\n               value = Math.asin(value);\n               }\n            else {\n               result.type = \"e#NUM!\";\n               }\n            break;\n\n         case \"ATAN\":\n            value = Math.atan(value);\n            break;\n\n         case \"COS\":\n            value = Math.cos(value);\n            break;\n\n         case \"DEGREES\":\n            value = value * 180/Math.PI;\n            break;\n\n         case \"EVEN\":\n            value = value < 0 ? -value : value;\n            if (value != Math.floor(value)) {\n               value = Math.floor(value + 1) + (Math.floor(value + 1) % 2);\n               }\n            else { // integer\n               value = value + (value % 2);\n               }\n            if (v1.value < 0) value = -value;\n            break;\n\n         case \"EXP\":\n            value = Math.exp(value);\n            break;\n\n         case \"FACT\":\n            f = 1;\n            value = Math.floor(value);\n            for (;value>0;value--) {\n               f *= value;\n               }\n            value = f;\n            break;\n\n         case \"INT\":\n            value = Math.floor(value); // spreadsheet INT is floor(), not int()\n            break;\n\n         case \"LN\":\n            if (value <= 0) {\n               result.type = \"e#NUM!\";\n               result.error = SocialCalc.Constants.s_sheetfunclnarg;\n               }\n            value = Math.log(value);\n            break;\n\n         case \"LOG10\":\n            if (value <= 0) {\n               result.type = \"e#NUM!\";\n               result.error = SocialCalc.Constants.s_sheetfunclog10arg;\n               }\n            value = Math.log(value)/Math.log(10);\n            break;\n\n         case \"ODD\":\n            value = value < 0 ? -value : value;\n            if (value != Math.floor(value)) {\n               value = Math.floor(value + 1) + (1 - (Math.floor(value + 1) % 2));\n               }\n            else { // integer\n               value = value + (1 - (value % 2));\n               }\n            if (v1.value < 0) value = -value;\n            break;\n\n         case \"RADIANS\":\n            value = value * Math.PI/180;\n            break;\n\n         case \"SIN\":\n            value = Math.sin(value);\n            break;\n\n         case \"SQRT\":\n            if (value >= 0) {\n               value = Math.sqrt(value);\n               }\n            else {\n               result.type = \"e#NUM!\";\n               }\n            break;\n\n         case \"TAN\":\n            if (Math.cos(value) != 0) {\n               value = Math.tan(value);\n               }\n            else {\n               result.type = \"e#NUM!\";\n               }\n            break;\n         }\n      }\n\n   result.value = value;\n   operand.push(result);\n\n   return null;\n\n   }\n\n// Add to function list\nSocialCalc.Formula.FunctionList[\"ABS\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\nSocialCalc.Formula.FunctionList[\"ACOS\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\nSocialCalc.Formula.FunctionList[\"ASIN\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\nSocialCalc.Formula.FunctionList[\"ATAN\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\nSocialCalc.Formula.FunctionList[\"COS\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\nSocialCalc.Formula.FunctionList[\"DEGREES\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\nSocialCalc.Formula.FunctionList[\"EVEN\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\nSocialCalc.Formula.FunctionList[\"EXP\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\nSocialCalc.Formula.FunctionList[\"FACT\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\nSocialCalc.Formula.FunctionList[\"INT\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\nSocialCalc.Formula.FunctionList[\"LN\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\nSocialCalc.Formula.FunctionList[\"LOG10\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\nSocialCalc.Formula.FunctionList[\"ODD\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\nSocialCalc.Formula.FunctionList[\"RADIANS\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\nSocialCalc.Formula.FunctionList[\"SIN\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\nSocialCalc.Formula.FunctionList[\"SQRT\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\nSocialCalc.Formula.FunctionList[\"TAN\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\n\n\n/*\n#\n# ATAN2(x, y)\n# MOD(a, b)\n# POWER(a, b)\n# TRUNC(value, precision)\n#\n*/\n\nSocialCalc.Formula.Math2Functions = function(fname, operand, foperand, sheet) {\n\n   var xval, yval, value, quotient, decimalscale, i;\n   var result = {};\n\n   var scf = SocialCalc.Formula;\n\n   xval = scf.OperandAsNumber(sheet, foperand);\n   yval = scf.OperandAsNumber(sheet, foperand);\n   value = 0;\n   result.type = scf.LookupResultType(xval.type, yval.type, scf.TypeLookupTable.twoargnumeric);\n\n   if (result.type == \"n\") {\n      switch (fname) {\n         case \"ATAN2\":\n            if (xval.value == 0 && yval.value == 0) {\n               result.type = \"e#DIV/0!\";\n               }\n            else {\n               result.value = Math.atan2(yval.value, xval.value);\n               }\n            break;\n\n         case \"POWER\":\n            result.value = Math.pow(xval.value, yval.value);\n            if (isNaN(result.value)) {\n               result.value = 0;\n               result.type = \"e#NUM!\";\n               }\n            break;\n\n         case \"MOD\": // en.wikipedia.org/wiki/Modulo_operation, etc.\n            if (yval.value == 0) {\n               result.type = \"e#DIV/0!\";\n               }\n            else {\n               quotient = xval.value/yval.value;\n               quotient = Math.floor(quotient);\n               result.value = xval.value - (quotient * yval.value);\n               }\n            break;\n\n         case \"TRUNC\":\n            decimalscale = 1; // cut down to required number of decimal digits\n            if (yval.value >= 0) {\n               yval.value = Math.floor(yval.value);\n               for (i=0; i<yval.value; i++) {\n                  decimalscale *= 10;\n                  }\n               result.value = Math.floor(Math.abs(xval.value) * decimalscale) / decimalscale;\n               }\n            else if (yval.value < 0) {\n               yval.value = Math.floor(-yval.value);\n               for (i=0; i<yval.value; i++) {\n                  decimalscale *= 10;\n                  }\n               result.value = Math.floor(Math.abs(xval.value) / decimalscale) * decimalscale;\n               }\n            if (xval.value < 0) {\n               result.value = -result.value;\n               }\n            }\n         }\n \n   operand.push(result);\n\n   return null;\n\n   }\n\n// Add to function list\nSocialCalc.Formula.FunctionList[\"ATAN2\"] = [SocialCalc.Formula.Math2Functions, 2, \"xy\", \"\", \"math\"];\nSocialCalc.Formula.FunctionList[\"MOD\"] = [SocialCalc.Formula.Math2Functions, 2, \"\", \"\", \"math\"];\nSocialCalc.Formula.FunctionList[\"POWER\"] = [SocialCalc.Formula.Math2Functions, 2, \"\", \"\", \"math\"];\nSocialCalc.Formula.FunctionList[\"TRUNC\"] = [SocialCalc.Formula.Math2Functions, 2, \"valpre\", \"\", \"math\"];\n\n/*\n#\n# LOG(value,[base])\n#\n*/\n\nSocialCalc.Formula.LogFunction = function(fname, operand, foperand, sheet) {\n\n   var value, value2;\n   var result = {};\n\n   var scf = SocialCalc.Formula;\n\n   result.value = 0;\n\n   value = scf.OperandAsNumber(sheet, foperand);\n   result.type = scf.LookupResultType(value.type, value.type, scf.TypeLookupTable.oneargnumeric);\n   if (foperand.length == 1) {\n      value2 = scf.OperandAsNumber(sheet, foperand);\n      if (value2.type.charAt(0) != \"n\" || value2.value <= 0) {\n         scf.FunctionSpecificError(fname, operand, \"e#NUM!\", SocialCalc.Constants.s_sheetfunclogsecondarg);\n         return 0;\n         }\n      }\n   else if (foperand.length != 0) {\n      scf.FunctionArgsError(fname, operand);\n      return 0;\n      }\n   else {\n      value2 = {value: Math.E, type: \"n\"};\n      }\n\n   if (result.type == \"n\") {\n      if (value.value <= 0) {\n         scf.FunctionSpecificError(fname, operand, \"e#NUM!\", SocialCalc.Constants.s_sheetfunclogfirstarg);\n         return 0;\n         }\n      result.value = Math.log(value.value)/Math.log(value2.value);\n      }\n\n   operand.push(result);\n\n   return;\n\n   }\n\nSocialCalc.Formula.FunctionList[\"LOG\"] = [SocialCalc.Formula.LogFunction, -1, \"log\", \"\", \"math\"];\n\n\n/*\n#\n# ROUND(value,[precision])\n#\n*/\n\nSocialCalc.Formula.RoundFunction = function(fname, operand, foperand, sheet) {\n\n   var value2, decimalscale, scaledvalue, i;\n\n   var scf = SocialCalc.Formula;\n   var result = 0;\n   var resulttype = \"e#VALUE!\";\n\n   var value = scf.OperandValueAndType(sheet, foperand);\n   var resulttype = scf.LookupResultType(value.type, value.type, scf.TypeLookupTable.oneargnumeric);\n\n   if (foperand.length == 1) {\n      value2 = scf.OperandValueAndType(sheet, foperand);\n      if (value2.type.charAt(0) != \"n\") {\n         scf.FunctionSpecificError(fname, operand, \"e#NUM!\", SocialCalc.Constants.s_sheetfuncroundsecondarg);\n         return 0;\n         }\n      }\n   else if (foperand.length != 0) {\n      scf.FunctionArgsError(fname, operand);\n      return 0;\n      }\n   else {\n      value2 = {value: 0, type: \"n\"}; // if no second arg, assume 0 for simple round\n      }\n\n   if (resulttype == \"n\") {\n      value2.value = value2.value-0;\n      if (value2.value == 0) {\n         result = Math.round(value.value);\n         }\n      else if (value2.value > 0) {\n         decimalscale = 1; // cut down to required number of decimal digits\n         value2.value = Math.floor(value2.value);\n         for (i=0; i<value2.value; i++) {\n            decimalscale *= 10;\n            }\n         scaledvalue = Math.round(value.value * decimalscale);\n         result = scaledvalue / decimalscale;\n         }\n      else if (value2.value < 0) {\n         decimalscale = 1; // cut down to required number of decimal digits\n         value2.value = Math.floor(-value2.value);\n         for (i=0; i<value2.value; i++) {\n            decimalscale *= 10;\n            }\n         scaledvalue = Math.round(value.value / decimalscale);\n         result = scaledvalue * decimalscale;\n         }\n      }\n\n   scf.PushOperand(operand, resulttype, result);\n\n   return;\n\n   }\n\nSocialCalc.Formula.FunctionList[\"ROUND\"] = [SocialCalc.Formula.RoundFunction, -1, \"vp\", \"\", \"math\"];\n\n/*\n#\n# AND(v1,c1:c2,...)\n# OR(v1,c1:c2,...)\n#\n*/\n\nSocialCalc.Formula.AndOrFunctions = function(fname, operand, foperand, sheet) {\n\n   var value1, result;\n\n   var scf = SocialCalc.Formula;\n   var resulttype = \"\";\n\n   if (fname == \"AND\") {\n      result = 1;\n      }\n   else if (fname == \"OR\") {\n      result = 0;\n      }\n\n   while (foperand.length) {\n      value1 = scf.OperandValueAndType(sheet, foperand);\n      if (value1.type.charAt(0) == \"n\") {\n         value1.value = value1.value-0;\n         if (fname == \"AND\") {\n            result = value1.value != 0 ? result : 0;\n            }\n         else if (fname == \"OR\") {\n            result = value1.value != 0 ? 1 : result;\n            }\n         resulttype = scf.LookupResultType(value1.type, resulttype || \"nl\", scf.TypeLookupTable.propagateerror);\n         }\n      else if (value1.type.charAt(0) == \"e\" && resulttype.charAt(0) != \"e\") {\n         resulttype = value1.type;\n         }\n      }\n   if (resulttype.length < 1) {\n      resulttype = \"e#VALUE!\";\n      result = 0;\n      }\n\n   scf.PushOperand(operand, resulttype, result);\n\n   return;\n\n   }\n\nSocialCalc.Formula.FunctionList[\"AND\"] = [SocialCalc.Formula.AndOrFunctions, -1, \"vn\", \"\", \"test\"];\nSocialCalc.Formula.FunctionList[\"OR\"] = [SocialCalc.Formula.AndOrFunctions, -1, \"vn\", \"\", \"test\"];\n\n/*\n#\n# NOT(value)\n#\n*/\n\nSocialCalc.Formula.NotFunction = function(fname, operand, foperand, sheet) {\n\n   var result = 0;\n   var scf = SocialCalc.Formula;\n   var value = scf.OperandValueAndType(sheet, foperand);\n   var resulttype = scf.LookupResultType(value.type, value.type, scf.TypeLookupTable.propagateerror);\n\n   if (value.type.charAt(0) == \"n\" || value.type == \"b\") {\n      result = value.value-0 != 0 ? 0 : 1; // do the \"not\" operation\n      resulttype = \"nl\";\n      }\n   else if (value.type.charAt(0) == \"t\") {\n      resulttype = \"e#VALUE!\";\n      }\n\n   scf.PushOperand(operand, resulttype, result);\n\n   return;\n\n   }\n\nSocialCalc.Formula.FunctionList[\"NOT\"] = [SocialCalc.Formula.NotFunction, 1, \"v\", \"\", \"test\"];\n\n/*\n#\n# CHOOSE(index,value1,value2,...)\n#\n*/\n\nSocialCalc.Formula.ChooseFunction = function(fname, operand, foperand, sheet) {\n\n   var resulttype, count, value1;\n   var result = 0;\n   var scf = SocialCalc.Formula;\n\n   var cindex = scf.OperandAsNumber(sheet, foperand);\n\n   if (cindex.type.charAt(0) != \"n\") {\n      cindex.value = 0;\n      }\n   cindex.value = Math.floor(cindex.value);\n\n   count = 0;\n   while (foperand.length) {\n      value1 = scf.TopOfStackValueAndType(sheet, foperand);\n      count += 1;\n      if (cindex.value == count) {\n         result = value1.value;\n         resulttype = value1.type;\n         break;\n         }\n      }\n   if (resulttype) { // found something\n      scf.PushOperand(operand, resulttype, result);\n      }\n   else {\n      scf.PushOperand(operand, \"e#VALUE!\", 0);\n      }\n\n   return;\n\n   }\n\nSocialCalc.Formula.FunctionList[\"CHOOSE\"] = [SocialCalc.Formula.ChooseFunction, -2, \"choose\", \"\", \"lookup\"];\n\n/*\n#\n# COLUMNS(c1:c2)\n# ROWS(c1:c2)\n#\n*/\n\nSocialCalc.Formula.ColumnsRowsFunctions = function(fname, operand, foperand, sheet) {\n\n   var resulttype, rangeinfo;\n   var result = 0;\n   var scf = SocialCalc.Formula;\n\n   var value1 = scf.TopOfStackValueAndType(sheet, foperand);\n\n   if (value1.type == \"coord\") {\n      result = 1;\n      resulttype = \"n\";\n      }\n\n   else if (value1.type == \"range\") {\n      rangeinfo = scf.DecodeRangeParts(sheet, value1.value);\n      if (fname == \"COLUMNS\") {\n         result = rangeinfo.ncols;\n         }\n      else if (fname == \"ROWS\") {\n         result = rangeinfo.nrows;\n         }\n      resulttype = \"n\";\n      }\n   else {\n      result = 0;\n      resulttype = \"e#VALUE!\";\n      }\n\n   scf.PushOperand(operand, resulttype, result);\n\n   return;\n\n   }\n\nSocialCalc.Formula.FunctionList[\"COLUMNS\"] = [SocialCalc.Formula.ColumnsRowsFunctions, 1, \"range\", \"\", \"lookup\"];\nSocialCalc.Formula.FunctionList[\"ROWS\"] = [SocialCalc.Formula.ColumnsRowsFunctions, 1, \"range\", \"\", \"lookup\"];\n\n\n/*\n#\n# FALSE()\n# NA()\n# NOW()\n# PI()\n# TODAY()\n# TRUE()\n#\n*/\n\nSocialCalc.Formula.ZeroArgFunctions = function(fname, operand, foperand, sheet) {\n\n   var startval, tzoffset, start_1_1_1970, seconds_in_a_day, nowdays;\n   var result = {value: 0};\n\n   switch (fname) {\n      case \"FALSE\":\n         result.type = \"nl\";\n         result.value = 0;\n         break;\n\n      case \"NA\":\n         result.type = \"e#N/A\";\n         break;\n\n      case \"NOW\":\n         startval = new Date();\n         tzoffset = startval.getTimezoneOffset();\n         startval = startval.getTime() / 1000; // convert to seconds\n         start_1_1_1970 = 25569; // Day number of 1/1/1970 starting with 1/1/1900 as 1\n         seconds_in_a_day = 24 * 60 * 60;\n         nowdays = start_1_1_1970 + startval / seconds_in_a_day - tzoffset/(24*60);\n         result.value = nowdays;\n         result.type = \"ndt\";\n         SocialCalc.Formula.FreshnessInfo.volatile.NOW = true; // remember\n         break;\n\n      case \"PI\":\n         result.type = \"n\";\n         result.value = Math.PI;\n         break;\n\n      case \"TODAY\":\n         startval = new Date();\n         tzoffset = startval.getTimezoneOffset();\n         startval = startval.getTime() / 1000; // convert to seconds\n         start_1_1_1970 = 25569; // Day number of 1/1/1970 starting with 1/1/1900 as 1\n         seconds_in_a_day = 24 * 60 * 60;\n         nowdays = start_1_1_1970 + startval / seconds_in_a_day - tzoffset/(24*60);\n         result.value = Math.floor(nowdays);\n         result.type = \"nd\";\n         SocialCalc.Formula.FreshnessInfo.volatile.TODAY = true; // remember\n         break;\n\n      case \"TRUE\":\n         result.type = \"nl\";\n         result.value = 1;\n         break;\n\n      }\n\n   operand.push(result);\n\n   return null;\n\n}\n\n// Add to function list\nSocialCalc.Formula.FunctionList[\"FALSE\"] = [SocialCalc.Formula.ZeroArgFunctions, 0, \"\", \"\", \"test\"];\nSocialCalc.Formula.FunctionList[\"NA\"] = [SocialCalc.Formula.ZeroArgFunctions, 0, \"\", \"\", \"test\"];\nSocialCalc.Formula.FunctionList[\"NOW\"] = [SocialCalc.Formula.ZeroArgFunctions, 0, \"\", \"\", \"datetime\"];\nSocialCalc.Formula.FunctionList[\"PI\"] = [SocialCalc.Formula.ZeroArgFunctions, 0, \"\", \"\", \"math\"];\nSocialCalc.Formula.FunctionList[\"TODAY\"] = [SocialCalc.Formula.ZeroArgFunctions, 0, \"\", \"\", \"datetime\"];\nSocialCalc.Formula.FunctionList[\"TRUE\"] = [SocialCalc.Formula.ZeroArgFunctions, 0, \"\", \"\", \"test\"];\n\n//\n// * * * * * FINANCIAL FUNCTIONS * * * * *\n//\n\n/*\n#\n# DDB(cost,salvage,lifetime,period,[method])\n#\n# Depreciation, method defaults to 2 for double-declining balance\n# See: http://en.wikipedia.org/wiki/Depreciation\n#\n*/\n\nSocialCalc.Formula.DDBFunction = function(fname, operand, foperand, sheet) {\n\n   var method, depreciation, accumulateddepreciation, i;\n   var scf = SocialCalc.Formula;\n\n   var cost = scf.OperandAsNumber(sheet, foperand);\n   var salvage = scf.OperandAsNumber(sheet, foperand);\n   var lifetime = scf.OperandAsNumber(sheet, foperand);\n   var period = scf.OperandAsNumber(sheet, foperand);\n\n   if (scf.CheckForErrorValue(operand, cost)) return;\n   if (scf.CheckForErrorValue(operand, salvage)) return;\n   if (scf.CheckForErrorValue(operand, lifetime)) return;\n   if (scf.CheckForErrorValue(operand, period)) return;\n\n   if (lifetime.value < 1) {\n      scf.FunctionSpecificError(fname, operand, \"e#NUM!\", SocialCalc.Constants.s_sheetfuncddblife);\n      return 0;\n      }\n\n   method = {value: 2, type: \"n\"};\n   if (foperand.length > 0 ) {\n      method = scf.OperandAsNumber(sheet, foperand);\n      }\n   if (foperand.length != 0) {\n      scf.FunctionArgsError(fname, operand);\n      return 0;\n      }\n   if (scf.CheckForErrorValue(operand, method)) return;\n\n   depreciation = 0; // calculated for each period\n   accumulateddepreciation = 0; // accumulated by adding each period's\n\n   for (i=1; i<=period.value-0 && i<=lifetime.value; i++) { // calculate for each period based on net from previous\n      depreciation = (cost.value - accumulateddepreciation) * (method.value / lifetime.value);\n      if (cost.value - accumulateddepreciation - depreciation < salvage.value) { // don't go lower than salvage value\n         depreciation = cost.value - accumulateddepreciation - salvage.value;\n         }\n      accumulateddepreciation += depreciation;\n      }\n\n   scf.PushOperand(operand, 'n$', depreciation);\n\n   return;\n\n   }\n\nSocialCalc.Formula.FunctionList[\"DDB\"] = [SocialCalc.Formula.DDBFunction, -4, \"ddb\", \"\", \"financial\"];\n\n/*\n#\n# SLN(cost,salvage,lifetime)\n#\n# Depreciation for each period by straight-line method\n# See: http://en.wikipedia.org/wiki/Depreciation\n#\n*/\n\nSocialCalc.Formula.SLNFunction = function(fname, operand, foperand, sheet) {\n\n   var depreciation;\n   var scf = SocialCalc.Formula;\n\n   var cost = scf.OperandAsNumber(sheet, foperand);\n   var salvage = scf.OperandAsNumber(sheet, foperand);\n   var lifetime = scf.OperandAsNumber(sheet, foperand);\n\n   if (scf.CheckForErrorValue(operand, cost)) return;\n   if (scf.CheckForErrorValue(operand, salvage)) return;\n   if (scf.CheckForErrorValue(operand, lifetime)) return;\n\n   if (lifetime.value < 1) {\n      scf.FunctionSpecificError(fname, operand, \"e#NUM!\", SocialCalc.Constants.s_sheetfuncslnlife);\n      return 0;\n      }\n\n   depreciation = (cost.value - salvage.value) / lifetime.value;\n\n   scf.PushOperand(operand, 'n$', depreciation);\n\n   return;\n\n   }\n\nSocialCalc.Formula.FunctionList[\"SLN\"] = [SocialCalc.Formula.SLNFunction, 3, \"csl\", \"\", \"financial\"];\n\n/*\n#\n# SYD(cost,salvage,lifetime,period)\n#\n# Depreciation by Sum of Year's Digits method\n#\n*/\n\nSocialCalc.Formula.SYDFunction = function(fname, operand, foperand, sheet) {\n\n   var depreciation, sumperiods;\n   var scf = SocialCalc.Formula;\n\n   var cost = scf.OperandAsNumber(sheet, foperand);\n   var salvage = scf.OperandAsNumber(sheet, foperand);\n   var lifetime = scf.OperandAsNumber(sheet, foperand);\n   var period = scf.OperandAsNumber(sheet, foperand);\n\n   if (scf.CheckForErrorValue(operand, cost)) return;\n   if (scf.CheckForErrorValue(operand, salvage)) return;\n   if (scf.CheckForErrorValue(operand, lifetime)) return;\n   if (scf.CheckForErrorValue(operand, period)) return;\n\n   if (lifetime.value < 1 || period.value <= 0) {\n      scf.PushOperand(operand, \"e#NUM!\", 0);\n      return 0;\n      }\n\n   sumperiods = ((lifetime.value + 1) * lifetime.value)/2; // add up 1 through lifetime\n   depreciation = (cost.value - salvage.value) * (lifetime.value - period.value + 1) / sumperiods; // calc depreciation\n\n   scf.PushOperand(operand, 'n$', depreciation);\n\n   return;\n\n   }\n\nSocialCalc.Formula.FunctionList[\"SYD\"] = [SocialCalc.Formula.SYDFunction, 4, \"cslp\", \"\", \"financial\"];\n\n/*\n#\n# FV(rate, n, payment, [pv, [paytype]])\n# NPER(rate, payment, pv, [fv, [paytype]])\n# PMT(rate, n, pv, [fv, [paytype]])\n# PV(rate, n, payment, [fv, [paytype]])\n# RATE(n, payment, pv, [fv, [paytype, [guess]]])\n#\n# Following the Open Document Format formula specification:\n#\n#    PV = - Fv - (Payment * Nper) [if rate equals 0]\n#    Pv*(1+Rate)^Nper + Payment * (1 + Rate*PaymentType) * ( (1+Rate)^nper -1)/Rate + Fv = 0\n#\n# For each function, the formulas are solved for the appropriate value (transformed using\n# basic algebra).\n#\n*/\n\nSocialCalc.Formula.InterestFunctions = function(fname, operand, foperand, sheet) {\n\n   var resulttype, result, dval, evalue, fval;\n   var pv, fv, rate, n, payment, paytype, guess, part1, part2, part3, part4, part5;\n   var olddelta, maxloop, tries, deltaepsilon, rate, oldrate, m;\n\n   var scf = SocialCalc.Formula;\n\n   var aval = scf.OperandAsNumber(sheet, foperand);\n   var bval = scf.OperandAsNumber(sheet, foperand);\n   var cval = scf.OperandAsNumber(sheet, foperand);\n\n   resulttype = scf.LookupResultType(aval.type, bval.type, scf.TypeLookupTable.twoargnumeric);\n   resulttype = scf.LookupResultType(resulttype, cval.type, scf.TypeLookupTable.twoargnumeric);\n   if (foperand.length) { // optional arguments\n      dval = scf.OperandAsNumber(sheet, foperand);\n      resulttype = scf.LookupResultType(resulttype, dval.type, scf.TypeLookupTable.twoargnumeric);\n      if (foperand.length) { // optional arguments\n         evalue = scf.OperandAsNumber(sheet, foperand);\n         resulttype = scf.LookupResultType(resulttype, evalue.type, scf.TypeLookupTable.twoargnumeric);\n         if (foperand.length) { // optional arguments\n            if (fname != \"RATE\") { // only rate has 6 possible args\n               scf.FunctionArgsError(fname, operand);\n               return 0;\n               }\n            fval = scf.OperandAsNumber(sheet, foperand);\n            resulttype = scf.LookupResultType(resulttype, fval.type, scf.TypeLookupTable.twoargnumeric);\n            }\n         }\n      }\n\n   if (resulttype == \"n\") {\n      switch (fname) {\n         case \"FV\": // FV(rate, n, payment, [pv, [paytype]])\n            rate = aval.value;\n            n = bval.value;\n            payment = cval.value;\n            pv = dval!=null ? dval.value : 0; // get value if present, or use default\n            paytype = evalue!=null ? (evalue.value ? 1 : 0) : 0;\n            if (rate == 0) { // simple calculation if no interest\n               fv = -pv - (payment * n);\n               }\n            else {\n               fv = -(pv*Math.pow(1+rate,n) + payment * (1 + rate*paytype) * ( Math.pow(1+rate,n) -1)/rate);\n               }\n            result = fv;\n            resulttype = 'n$';\n            break;\n\n         case \"NPER\": // NPER(rate, payment, pv, [fv, [paytype]])\n            rate = aval.value;\n            payment = bval.value;\n            pv = cval.value;\n            fv = dval!=null ? dval.value : 0;\n            paytype = evalue!=null ? (evalue.value ? 1 : 0) : 0;\n            if (rate == 0) { // simple calculation if no interest\n               if (payment == 0) {\n                  scf.PushOperand(operand, \"e#NUM!\", 0);\n                  return;\n                  }\n               n = (pv + fv)/(-payment);\n               }\n            else {\n               part1 = payment * (1 + rate * paytype) / rate;\n               part2 = pv + part1;\n               if (part2 == 0 || rate <= -1) {\n                  scf.PushOperand(operand, \"e#NUM!\", 0);\n                  return;\n                  }\n               part3 = (part1 - fv) / part2;\n               if (part3 <= 0) {\n                  scf.PushOperand(operand, \"e#NUM!\", 0);\n                  return;\n                  }\n               part4 = Math.log(part3);\n               part5 = Math.log(1 + rate); // rate > -1\n               n = part4/part5;\n               }\n            result = n;\n            resulttype = 'n';\n            break;\n\n         case \"PMT\": // PMT(rate, n, pv, [fv, [paytype]])\n            rate = aval.value;\n            n = bval.value;\n            pv = cval.value;\n            fv = dval!=null ? dval.value : 0;\n            paytype = evalue!=null ? (evalue.value ? 1 : 0) : 0;\n            if (n == 0) {\n               scf.PushOperand(operand, \"e#NUM!\", 0);\n               return;\n               }\n            else if (rate == 0) { // simple calculation if no interest\n               payment = (fv - pv)/n;\n               }\n            else {\n               payment = (0 - fv - pv*Math.pow(1+rate,n))/((1 + rate*paytype) * ( Math.pow(1+rate,n) -1)/rate);\n               }\n            result = payment;\n            resulttype = 'n$';\n            break;\n\n         case \"PV\": // PV(rate, n, payment, [fv, [paytype]])\n            rate = aval.value;\n            n = bval.value;\n            payment = cval.value;\n            fv = dval!=null ? dval.value : 0;\n            paytype = evalue!=null ? (eval.value ? 1 : 0) : 0;\n            if (rate == -1) {\n               scf.PushOperand(operand, \"e#DIV/0!\", 0);\n               return;\n               }\n            else if (rate == 0) { // simple calculation if no interest\n               pv = -fv - (payment * n);\n               }\n            else {\n               pv = (-fv - payment * (1 + rate*paytype) * ( Math.pow(1+rate,n) -1)/rate)/(Math.pow(1+rate,n));\n               }\n            result = pv;\n            resulttype = 'n$';\n            break;\n\n            case \"RATE\": // RATE(n, payment, pv, [fv, [paytype, [guess]]])\n               n = aval.value;\n               payment = bval.value;\n               pv = cval.value;\n               fv = dval!=null ? dval.value : 0;\n               paytype = evalue!=null ? (evalue.value ? 1 : 0) : 0;\n               guess = fval!=null ? fval.value : 0.1;\n\n               // rate is calculated by repeated approximations\n               // The deltas are used to calculate new guesses\n\n               maxloop = 100;\n               tries = 0;\n               delta = 1;\n               epsilon = 0.0000001; // this is close enough\n               rate = guess || 0.00000001; // zero is not allowed\n               while ((delta >= 0 ? delta : -delta) > epsilon && (rate != oldrate)) {\n                  delta = fv + pv*Math.pow(1+rate,n) + payment * (1 + rate*paytype) * ( Math.pow(1+rate,n) -1)/rate;\n                  if (olddelta!=null) {\n                     m = (delta - olddelta)/(rate - oldrate) || .001; // get slope (not zero)\n                     oldrate = rate;\n                     rate = rate - delta / m; // look for zero crossing\n                     olddelta = delta;\n                     }\n                  else { // first time - no old values\n                     oldrate = rate;\n                     rate = 1.1 * rate;\n                     olddelta = delta;\n                     }\n                  tries++;\n                  if (tries >= maxloop) { // didn't converge yet\n                     scf.PushOperand(operand, \"e#NUM!\", 0);\n                     return;\n                     }\n                  }\n               result = rate;\n               resulttype = 'n%';\n               break;\n         }\n      }\n \n   scf.PushOperand(operand, resulttype, result);\n\n   return;\n\n   }\n\nSocialCalc.Formula.FunctionList[\"FV\"] = [SocialCalc.Formula.InterestFunctions, -3, \"fv\", \"\", \"financial\"];\nSocialCalc.Formula.FunctionList[\"NPER\"] = [SocialCalc.Formula.InterestFunctions, -3, \"nper\", \"\", \"financial\"];\nSocialCalc.Formula.FunctionList[\"PMT\"] = [SocialCalc.Formula.InterestFunctions, -3, \"pmt\", \"\", \"financial\"];\nSocialCalc.Formula.FunctionList[\"PV\"] = [SocialCalc.Formula.InterestFunctions, -3, \"pv\", \"\", \"financial\"];\nSocialCalc.Formula.FunctionList[\"RATE\"] = [SocialCalc.Formula.InterestFunctions, -3, \"rate\", \"\", \"financial\"];\n\n/*\n#\n# NPV(rate,v1,v2,c1:c2,...)\n#\n*/\n\nSocialCalc.Formula.NPVFunction = function(fname, operand, foperand, sheet) {\n\n   var resulttypenpv, rate, sum, factor, value1;\n\n   var scf = SocialCalc.Formula;\n\n   var rate = scf.OperandAsNumber(sheet, foperand);\n   if (scf.CheckForErrorValue(operand, rate)) return;\n\n   sum = 0;\n   resulttypenpv = \"n\";\n   factor = 1;\n\n   while (foperand.length) {\n      value1 = scf.OperandValueAndType(sheet, foperand);\n      if (value1.type.charAt(0) == \"n\") {\n         factor *= (1 + rate.value);\n         if (factor == 0) {\n            scf.PushOperand(operand, \"e#DIV/0!\", 0);\n            return;\n            }\n         sum += value1.value / factor;\n         resulttypenpv = scf.LookupResultType(value1.type, resulttypenpv || value1.type, scf.TypeLookupTable.plus);\n         }\n      else if (value1.type.charAt(0) == \"e\" && resulttypenpv.charAt(0) != \"e\") {\n         resulttypenpv = value1.type;\n         break;\n         }\n      }\n\n   if (resulttypenpv.charAt(0) == \"n\") {\n      resulttypenpv = 'n$';\n      }\n\n   scf.PushOperand(operand, resulttypenpv, sum);\n\n   return;\n\n   }\n\nSocialCalc.Formula.FunctionList[\"NPV\"] = [SocialCalc.Formula.NPVFunction, -2, \"npv\", \"\", \"financial\"];\n\n/*\n#\n# IRR(c1:c2,[guess])\n#\n*/\n\nSocialCalc.Formula.IRRFunction = function(fname, operand, foperand, sheet) {\n\n   var value1, guess, oldsum, maxloop, tries, epsilon, rate, oldrate, m, sum, factor, i;\n   var rangeoperand = [];\n   var cashflows = [];\n\n   var scf = SocialCalc.Formula;\n\n   rangeoperand.push(foperand.pop()); // first operand is a range\n\n   while (rangeoperand.length) { // get values from range so we can do iterative approximations\n      value1 = scf.OperandValueAndType(sheet, rangeoperand);\n      if (value1.type.charAt(0) == \"n\") {\n         cashflows.push(value1.value);\n         }\n      else if (value1.type.charAt(0) == \"e\") {\n         scf.PushOperand(operand, \"e#VALUE!\", 0);\n         return;\n         }\n      }\n\n   if (!cashflows.length) {\n      scf.PushOperand(operand, \"e#NUM!\", 0);\n      return;\n      }\n\n   guess = {value: 0};\n\n   if (foperand.length) { // guess is provided\n      guess = scf.OperandAsNumber(sheet, foperand);\n      if (guess.type.charAt(0) != \"n\" && guess.type.charAt(0) != \"b\") {\n         scf.PushOperand(operand, \"e#VALUE!\", 0);\n         return;\n         }\n      if (foperand.length) { // should be no more args\n         scf.FunctionArgsError(fname, operand);\n         return;\n         }\n      }\n\n   guess.value = guess.value || 0.1;\n\n   // rate is calculated by repeated approximations\n   // The deltas are used to calculate new guesses\n\n   maxloop = 20;\n   tries = 0;\n   epsilon = 0.0000001; // this is close enough\n   rate = guess.value;\n   sum = 1;\n\n   while ((sum >= 0 ? sum : -sum) > epsilon && (rate != oldrate)) {\n      sum = 0;\n      factor = 1;\n      for (i=0; i<cashflows.length; i++) {\n         factor *= (1 + rate);\n         if (factor == 0) {\n            scf.PushOperand(operand, \"e#DIV/0!\", 0);\n            return;\n            }\n         sum += cashflows[i] / factor;\n         }\n\n      if (oldsum!=null) {\n         m = (sum - oldsum)/(rate - oldrate); // get slope\n         oldrate = rate;\n         rate = rate - sum / m; // look for zero crossing\n         oldsum = sum;\n         }\n      else { // first time - no old values\n         oldrate = rate;\n         rate = 1.1 * rate;\n         oldsum = sum;\n         }\n      tries++;\n      if (tries >= maxloop) { // didn't converge yet\n         scf.PushOperand(operand, \"e#NUM!\", 0);\n         return;\n         }\n      }\n\n   scf.PushOperand(operand, 'n%', rate);\n\n   return;\n\n   }\n\nSocialCalc.Formula.FunctionList[\"IRR\"] = [SocialCalc.Formula.IRRFunction, -1, \"irr\", \"\", \"financial\"];\n\n//\n// SHEET CACHE\n//\n\nSocialCalc.Formula.SheetCache = {\n\n   // Sheet data: Attributes are each sheet in the cache with values of an object with:\n   //\n   //    sheet: sheet-obj (or null, meaning not found)\n   //    recalcstate: constants.asloaded = as loaded\n   //                 constants.recalcing = being recalced now\n   //                 constants.recalcdone = recalc done\n   //    name: name of sheet (in case just have object and don't know name)\n   //\n\n   sheets: {},\n\n   // Waiting for loading:\n   // If sheet is not in cache, this is set to the sheetname being loaded\n   // so it can be tested in the recalc loop to start load and then wait until restarted.\n   // Reset to null before restarting.\n\n   waitingForLoading: null,\n\n   // Constants to use for setting sheets[*].recalcstate:\n\n   constants: {asloaded: 0, recalcing: 1, recalcdone: 2},\n\n   loadsheet: null // (deprecated - use SocialCalc.RecalcInfo.LoadSheet)\n\n   };\n\n//\n// othersheet = SocialCalc.Formula.FindInSheetCache(sheetname)\n//\n// Returns a SocialCalc.Sheet object corresponding to string sheetname\n// or null if the sheet is not available or in error.\n//\n// Each sheet is loaded only once and then stored in a cache.\n// Loading is handled elsewhere, e.g., in the recalc loop.\n//\n\nSocialCalc.Formula.FindInSheetCache = function(sheetname) {\n\n   var str;\n   var sfsc = SocialCalc.Formula.SheetCache;\n\n   var nsheetname = SocialCalc.Formula.NormalizeSheetName(sheetname); // normalize different versions\n\n   if (sfsc.sheets[nsheetname]) { // a sheet by that name is in the cache already\n      return sfsc.sheets[nsheetname].sheet; // return it\n      }\n\n   if (sfsc.waitingForLoading) { // waiting already - only queue up one\n      return null; // return not found\n      }\n\n   sfsc.waitingForLoading = nsheetname; // let recalc loop know that we have a sheet to load\n\n   return null; // return not found\n\n   }\n\n//\n// newsheet = SocialCalc.Formula.AddSheetToCache(sheetname, str)\n//\n// Adds a new sheet to the sheet cache.\n// Returns the sheet object filled out with the str (a saved sheet).\n//\n\nSocialCalc.Formula.AddSheetToCache = function(sheetname, str) {\n\n   var newsheet = null;\n   var sfsc = SocialCalc.Formula.SheetCache;\n   var sfscc = sfsc.constants;\n   var newsheetname = SocialCalc.Formula.NormalizeSheetName(sheetname);\n\n   if (str) {\n      newsheet = new SocialCalc.Sheet();\n      newsheet.ParseSheetSave(str);\n      }\n\n   sfsc.sheets[newsheetname] = {sheet: newsheet, recalcstate: sfscc.asloaded, name: newsheetname};\n\n   SocialCalc.Formula.FreshnessInfo.sheets[newsheetname] = true;\n\n   return newsheet;\n\n   }\n\n//\n// nsheet = SocialCalc.Formula.NormalizeSheetName(sheetname)\n//\n\nSocialCalc.Formula.NormalizeSheetName = function(sheetname) {\n\n   if (SocialCalc.Callbacks.NormalizeSheetName) {\n      return SocialCalc.Callbacks.NormalizeSheetName(sheetname);\n      }\n   else {\n      return sheetname.toLowerCase();\n      }\n   }\n\n//\n// REMOTE FUNCTION INFO\n//\n\nSocialCalc.Formula.RemoteFunctionInfo = {\n\n   // Waiting for server:\n   // If waiting for an XHR response from the server, this is set to some non-blank status text\n   // so it can be tested in the recalc loop to start load and then wait until restarted.\n   // Reset to null before restarting.\n\n   waitingForServer: null\n\n   };\n\n//\n// FRESHNESS INFO\n//\n// This information is generated during recalc.\n// It may be used to help determine when the recalc data in a spreadsheet\n// may be out of date.\n// For example, it may be used to display a message like:\n// \"Dependent on sheet 'FOO' which was updated more recently than this printout\"\n\nSocialCalc.Formula.FreshnessInfo = {\n\n   // For each external sheet referenced successfully an attribute of that name with value true.\n\n   sheets: {},\n\n   // For each volatile function that is called an attribute of that name with value true.\n\n   volatile: {},\n\n   // Set to false when started and true when recalc completes\n\n   recalc_completed: false\n\n   };\n\nSocialCalc.Formula.FreshnessInfoReset = function() {\n\n   var scffi = SocialCalc.Formula.FreshnessInfo;\n\n   scffi.sheets = {};\n   scffi.volatile = {};\n   scffi.recalc_completed = false;\n\n   }\n\n//\n// MISC ROUTINES\n//\n\n//\n// result = SocialCalc.Formula.PlainCoord(coord)\n//\n// Returns: coord without any $'s\n//\n\nSocialCalc.Formula.PlainCoord = function(coord) {\n\n   if (coord.indexOf(\"$\") == -1) return coord;\n\n   return coord.replace(/\\$/g, \"\"); // remove any $'s\n\n   }\n\n//\n// result = SocialCalc.Formula.OrderRangeParts(coord1, coord2)\n//\n// Returns: {c1: col, r1: row, c2: col, r2 = row} with c1/r1 upper left\n//\n\nSocialCalc.Formula.OrderRangeParts = function(coord1, coord2) {\n\n   var cr1, cr2;\n   var result = {};\n\n   cr1 = SocialCalc.coordToCr(coord1);\n   cr2 = SocialCalc.coordToCr(coord2);\n   if (cr1.col > cr2.col) { result.c1 = cr2.col; result.c2 = cr1.col; }\n   else { result.c1 = cr1.col; result.c2 = cr2.col; }\n   if (cr1.row > cr2.row) { result.r1 = cr2.row; result.r2 = cr1.row; }\n   else { result.r1 = cr1.row; result.r2 = cr2.row; }\n\n   return result;\n\n   }\n\n//\n// cond = SocialCalc.Formula.TestCriteria(value, type, criteria)\n//\n// Determines whether a value/type meets the criteria.\n// A criteria can be a numeric value, text beginning with <, <=, =, >=, >, <>, text by itself is start of text to match.\n// Used by a variety of functions, including the \"D\" functions (DSUM, etc.).\n//\n// Returns true or false\n//\n\nSocialCalc.Formula.TestCriteria = function(value, type, criteria) {\n\n   var comparitor, basestring, basevalue, cond, testvalue;\n\n   if (criteria == null) { // undefined (e.g., error value) is always false\n      return false;\n      }\n\n   criteria = criteria + \"\";\n   comparitor = criteria.charAt(0); // look for comparitor\n   if (comparitor == \"=\" || comparitor == \"<\" || comparitor == \">\") {\n      basestring = criteria.substring(1);\n      }\n   else {\n      comparitor = criteria.substring(0,2);\n      if (comparitor == \"<=\" || comparitor == \"<>\" || comparitor == \">=\") {\n         basestring = criteria.substring(2);\n         }\n      else {\n         comparitor = \"none\";\n         basestring = criteria;\n         }\n      }\n\n   basevalue = SocialCalc.DetermineValueType(basestring); // get type of value being compared\n   if (!basevalue.type) { // no criteria base value given\n      if (comparitor == \"none\") { // blank criteria matches nothing\n         return false;\n         }\n      if (type.charAt(0) == \"b\") { // comparing to empty cell\n         if (comparitor == \"=\") { // empty equals empty\n            return true;\n            }\n         }\n      else {\n         if (comparitor == \"<>\") { // \"something\" does not equal empty\n            return true;\n            }\n         }\n      return false; // otherwise false\n      }\n\n   cond = false;\n\n   if (basevalue.type.charAt(0) == \"n\" && type.charAt(0) == \"t\") { // criteria is number, but value is text\n      testvalue = SocialCalc.DetermineValueType(value);\n      if (testvalue.type.charAt(0) == \"n\") { // could be number - make it one\n         value = testvalue.value;\n         type = testvalue.type;\n         }\n      }\n\n   if (type.charAt(0) == \"n\" && basevalue.type.charAt(0) == \"n\") { // compare two numbers\n      value = value - 0; // make sure numbers\n      basevalue.value = basevalue.value - 0;\n      switch (comparitor) {\n         case \"<\":\n            cond = value < basevalue.value;\n            break;\n\n         case \"<=\":\n            cond = value <= basevalue.value;\n            break;\n\n         case \"=\":\n         case \"none\":\n            cond = value == basevalue.value;\n            break;\n\n         case \">=\":\n            cond = value >= basevalue.value;\n            break;\n\n         case \">\":\n            cond = value > basevalue.value;\n            break;\n\n         case \"<>\":\n            cond = value != basevalue.value;\n            break;\n         }\n      }\n\n   else if (type.charAt(0) == \"e\") { // error on left\n      cond = false;\n      }\n\n   else if (basevalue.type.charAt(0) == \"e\") { // error on right\n      cond = false;\n      }\n\n   else { // text, maybe mixed with number or blank\n      if (type.charAt(0) == \"n\") {\n         value = SocialCalc.format_number_for_display(value, \"n\", \"\");\n         }\n      if (basevalue.type.charAt(0) == \"n\") {\n         return false; // if number and didn't match already, isn't a match\n         }\n\n      value = value ? value.toLowerCase() : \"\";\n      basevalue.value = basevalue.value ? basevalue.value.toLowerCase() : \"\";\n\n      switch (comparitor) {\n         case \"<\":\n            cond = value < basevalue.value;\n            break;\n\n         case \"<=\":\n            cond = value <= basevalue.value;\n            break;\n\n         case \"=\":\n            cond = value == basevalue.value;\n            break;\n\n         case \"none\":\n            cond = value.substring(0, basevalue.value.length) == basevalue.value;\n            break;\n\n         case \">=\":\n            cond = value >= basevalue.value;\n            break;\n\n         case \">\":\n            cond = value > basevalue.value;\n            break;\n\n         case \"<>\":\n            cond = value != basevalue.value;\n            break;\n         }\n      }\n\n   return cond;\n\n   }\n\n//\n/*\n// The module of the SocialCalc package for the optional popup menus in socialcalcspreadsheetcontrol.js\n//\n// (c) Copyright 2009 Socialtext, Inc.\n// All Rights Reserved.\n//\n// The contents of this file are subject to the Artistic License 2.0; you may not\n// use this file except in compliance with the License. You may obtain a copy of \n// the License at http://socialcalc.org/licenses/al-20/.\n//\n// Some of the other files in the SocialCalc package are licensed under\n// different licenses. Please note the licenses of the modules you use.\n//\n// Code History:\n//\n// Initially coded by Dan Bricklin of Software Garden, Inc., for Socialtext, Inc.\n//\n*/\n\n   var SocialCalc; // All values are stored in the master SocialCalc object\n   if (!SocialCalc) {\n      SocialCalc = {};\n      }\n\n   // The main Popup data -- there is only one set\n\n   SocialCalc.Popup = {};\n\n   // Routines and values for each type of control, indexed by type name\n   // The value for each is an object constructed as follows:\n   //\n   //    Create = function(type, id, attribs)\n   //    Initialize = function(type, id, data)\n   //    SetValue = function(type, id, value)\n   //    GetValue = function(type, id) returns value\n   //    SetDisabled = function(type, id, t/f)\n   //    Show = function(type, id)\n   //    Hide = function(type, id)\n   //    Cancel = function(type, id)\n   //    Reset = function(type)\n   //\n   //    data = object to hold type-specific data\n   //\n\n   SocialCalc.Popup.Types = {};\n\n   // Definitions for each individual control, indexed by id\n   // The value for each is an object constructed as follows:\n   //\n   //    type: type name of the control\n   //    value: current value of the control (usually a string, but can depend on type)\n   //    data: object with type-specific items\n   //\n\n   SocialCalc.Popup.Controls = {};\n\n   // System-wide values of currently active control\n   //\n   //    id: id of current control or null\n   //\n\n   SocialCalc.Popup.Current = {};\n\n   // Other values used by the Popup system\n   //\n\n   SocialCalc.Popup.imagePrefix = \"www/assets/images/sc_\"; // image prefix\n\n   // Override this for localization\n\n   SocialCalc.Popup.LocalizeString = function(str) {return str;};\n\n\n// * * * * * * * * * * * * * * * *\n//\n// GENERAL ROUTINES\n//\n// * * * * * * * * * * * * * * * *\n\n//\n// SocialCalc.Popup.Create(type, id, attribs)\n//\n// Creates a control of type \"type\" as the children of document element \"id\" using \"attribs\"\n//\n\nSocialCalc.Popup.Create = function(type, id, attribs) {\n\n   var pt = SocialCalc.Popup.Types[type];\n   if (pt && pt.Create) {\n      pt.Create(type, id, attribs);\n      }\n\n   }\n\n\n//\n// SocialCalc.Popup.SetValue(id, value)\n//\n// Sets the value of control.\n//\n\nSocialCalc.Popup.SetValue = function(id, value) {\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n\n   if (!spc[id]) {alert(\"Unknown control \"+id);return;}\n\n   var type = spc[id].type;\n   var pt = spt[type];\n   var spcdata = spc[id].data;\n\n   if (pt && pt.Create) {\n      pt.SetValue(type, id, value);\n      if (spcdata.attribs && spcdata.attribs.changedcallback) {\n         spcdata.attribs.changedcallback(spcdata.attribs, id, value);\n         }\n      }\n\n   }\n\n\n//\n// SocialCalc.Popup.SetDisabled(id, disabled)\n//\n// Sets whether the control is disabled (true) or not (false).\n//\n\nSocialCalc.Popup.SetDisabled = function(id, disabled) {\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n\n   if (!spc[id]) {alert(\"Unknown control \"+id);return;}\n\n   var type = spc[id].type;\n\n   var pt = spt[type];\n   if (pt && pt.Create) {\n      if (sp.Current.id && id == sp.Current.id) {\n         pt.Hide(type, sp.Current.id);\n         sp.Current.id = null;\n         }\n      pt.SetDisabled(type, id, disabled);\n      }\n\n   }\n\n\n//\n// SocialCalc.Popup.GetValue(id)\n//\n// Returns the value of control.\n//\n\nSocialCalc.Popup.GetValue = function(id) {\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n\n   if (!spc[id]) {alert(\"Unknown control \"+id);return;}\n\n   var type = spc[id].type;\n\n   var pt = spt[type];\n   if (pt && pt.Create) {\n      return pt.GetValue(type, id);\n      }\n\n   return null;\n\n   }\n\n\n//\n// SocialCalc.Popup.Initialize(id, data)\n//\n// Gives \"data\" to the appropriate initialization code.\n//\n\nSocialCalc.Popup.Initialize = function(id, data) {\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n\n   if (!spc[id]) {alert(\"Unknown control \"+id);return;}\n\n   var type = spc[id].type;\n\n   var pt = spt[type];\n   if (pt && pt.Initialize) {\n      pt.Initialize(type, id, data);\n      }\n\n   }\n\n\n//\n// SocialCalc.Popup.Reset(type)\n//\n// Resets Popup, such as when turning to page.\n//\n\nSocialCalc.Popup.Reset = function(type) {\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n\n   if (spt[type].Reset) spt[type].Reset(type);\n\n   }\n\n\n//\n// SocialCalc.Popup.CClick(id)\n//\n// Should be called when the user clicks on a control to do the popup\n//\n\nSocialCalc.Popup.CClick = function(id) {\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n\n   if (!spc[id]) {alert(\"Unknown control \"+id);return;}\n\n   if (spc[id].data && spc[id].data.disabled) return;\n\n   var type = spc[id].type;\n\n   var pt = spt[type];\n\n   if (sp.Current.id) {\n      spt[spc[sp.Current.id].type].Hide(type, sp.Current.id);\n      if (id == sp.Current.id) { // same one - done\n         sp.Current.id = null;\n         return;\n         }\n      }\n\n   if (pt && pt.Show) {\n      pt.Show(type, id);\n      }\n\n   sp.Current.id = id;\n\n   }\n\n\n//\n// SocialCalc.Popup.Close()\n//\n// Used to close any open popup.\n//\n\nSocialCalc.Popup.Close = function() {\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n\n   if (!sp.Current.id) return;\n\n   sp.CClick(sp.Current.id);\n\n   }\n\n//\n// SocialCalc.Popup.Cancel()\n//\n// Closes Popup and restores old value\n//\n\nSocialCalc.Popup.Cancel = function() {\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n\n   if (!sp.Current.id) return;\n\n   var type = spc[sp.Current.id].type;\n\n   var pt = spt[type];\n\n   pt.Cancel(type, sp.Current.id);\n\n   sp.Current.id = null;\n\n   }\n\n//\n// ele = SocialCalc.Popup.CreatePopupDiv(id, attribs)\n//\n// Utility function to create the main popup div of width attribs.width.\n// If attribs.title, create one with that text, and optionally attribs.moveable.\n//\n\nSocialCalc.Popup.CreatePopupDiv = function(id, attribs) {\n\n   var pos, ele;\n\n   var sp = SocialCalc.Popup;\n   var spc = sp.Controls;\n   var spcdata = spc[id].data;\n\n   var main = document.createElement(\"div\");\n   main.style.position = \"absolute\";\n\n   pos = SocialCalc.GetElementPositionWithScroll(spcdata.mainele);\n\n   main.style.top = (pos.top+spcdata.mainele.offsetHeight)+\"px\";\n   main.style.left = (pos.left)+\"px\";\n   main.style.zIndex = 100;\n   main.style.backgroundColor = \"#FFF\";\n   main.style.border = \"1px solid black\";\n\n   if (attribs.width) {\n      main.style.width = attribs.width;\n      }\n\n   spcdata.mainele.appendChild(main);\n\n   if (attribs.title) {\n      main.innerHTML = '<table cellspacing=\"0\" cellpadding=\"0\" style=\"border-bottom:1px solid black;\"><tr>'+\n         '<td style=\"font-size:10px;cursor:default;width:100%;background-color:#999;color:#FFF;\">'+attribs.title+'</td>'+\n         '<td style=\"font-size:10px;cursor:default;color:#666;\" onclick=\"SocialCalc.Popup.Cancel();\">&nbsp;X&nbsp;</td></tr></table>';\n\n      if (attribs.moveable) {\n         spcdata.dragregistered = main.firstChild.firstChild.firstChild.firstChild;\n         SocialCalc.DragRegister(spcdata.dragregistered, true, true, {MouseDown: SocialCalc.DragFunctionStart, MouseMove: SocialCalc.DragFunctionPosition,\n                     MouseUp: SocialCalc.DragFunctionPosition,\n                     Disabled: null, positionobj: main});\n         }\n      }\n\n   return main;\n\n   }\n\n//\n// SocialCalc.Popup.EnsurePosition(id, container)\n//\n// Utility function to make sure popup is positioned completely within container (both element objects)\n// and appropriate with respect to the main element controlling the popup.\n//\n\nSocialCalc.Popup.EnsurePosition = function(id, container) {\n\n   var sp = SocialCalc.Popup;\n   var spc = sp.Controls;\n   var spcdata = spc[id].data;\n\n   var main = spcdata.mainele.firstChild;\n   if (!main) {alert(\"No main popup element firstChild.\");return};\n   var popup = spcdata.popupele;\n\n   function GetLayoutValues(ele) {\n      var r = SocialCalc.GetElementPositionWithScroll(ele);\n      r.height = ele.offsetHeight;\n      r.width = ele.offsetWidth;\n      r.bottom = r.top+r.height;\n      r.right = r.left+r.width;\n      return r;\n      }\n\n   var p = GetLayoutValues(popup);\n   var c = GetLayoutValues(container);\n   var m = GetLayoutValues(main);\n   var t = 0; // type of placement\n//addmsg(\"popup t/r/b/l/h/w= \"+p.top+\"/\"+p.right+\"/\"+p.bottom+\"/\"+p.left+\"/\"+p.height+\"/\"+p.width);\n//addmsg(\"container t/r/b/l/h/w= \"+c.top+\"/\"+c.right+\"/\"+c.bottom+\"/\"+c.left+\"/\"+c.height+\"/\"+c.width);\n//addmsg(\"main t/r/b/l/h/w= \"+m.top+\"/\"+m.right+\"/\"+m.bottom+\"/\"+m.left+\"/\"+m.height+\"/\"+m.width);\n\n   // Check various layout cases in priority order\n\n   if (m.bottom+p.height < c.bottom && m.left+p.width < c.right) { // normal case: room on bottom and right\n      popup.style.top = m.bottom + \"px\";\n      popup.style.left = m.left + \"px\";\n      t = 1;\n      }\n\n   else if (m.top-p.height > c.top && m.left+p.width < c.right) { // room on top and right\n      popup.style.top = (m.top-p.height) + \"px\";\n      popup.style.left = m.left + \"px\";\n      t = 2;\n      }\n\n   else if (m.bottom+p.height < c.bottom && m.right-p.width > c.left) { // room on bottom and left\n      popup.style.top = m.bottom + \"px\";\n      popup.style.left = (m.right-p.width) + \"px\";\n      t = 3;\n      }\n\n   else if (m.top-p.height > c.top && m.right-p.width > c.left) { // room on top and left\n      popup.style.top = (m.top-p.height) + \"px\";\n      popup.style.left = (m.right-p.width) + \"px\";\n      t = 4;\n      }\n\n   else if (m.bottom+p.height < c.bottom && p.width < c.width) { // room on bottom and middle\n      popup.style.top = m.bottom + \"px\";\n      popup.style.left = (c.left+Math.floor((c.width-p.width)/2)) + \"px\";\n      t = 5;\n      }\n\n   else if (m.top-p.height > c.top && p.width < c.width) { // room on top and middle\n      popup.style.top = (m.top-p.height) + \"px\";\n      popup.style.left = (c.left+Math.floor((c.width-p.width)/2)) + \"px\";\n      t = 6;\n      }\n\n   else if (p.height < c.height && m.right+p.width < c.right) { // room on middle and right\n      popup.style.top = (c.top+Math.floor((c.height-p.height)/2)) + \"px\";\n      popup.style.left = m.right + \"px\";\n      t = 7;\n      }\n\n   else if (p.height < c.height && m.left-p.width > c.left) { // room on middle and left\n      popup.style.top = (c.top+Math.floor((c.height-p.height)/2)) + \"px\";\n      popup.style.left = (m.left-p.width) + \"px\";\n      t = 8;\n      }\n\n   else { // nothing works, so leave as it is\n      }\n//addmsg(\"Popup layout \"+t);\n\n}\n\n//\n// ele = SocialCalc.Popup.DestroyPopupDiv(ele, dragregistered)\n//\n// Utility function to get rid of the main popup div.\n//\n\nSocialCalc.Popup.DestroyPopupDiv = function(ele, dragregistered) {\n\n   if (!ele) return;\n\n   ele.innerHTML = \"\";\n\n   SocialCalc.DragUnregister(dragregistered); // OK to do this even if not registered\n\n   if (ele.parentNode) {\n      ele.parentNode.removeChild(ele);\n      }\n\n   }\n\n//\n// Color Utility Functions\n//\n\nSocialCalc.Popup.RGBToHex = function(val) {\n\n   var sp = SocialCalc.Popup;\n\n   if (val==\"\") {\n      return \"000000\";\n      }\n   var rgbvals = val.match(/(\\d+)\\D+(\\d+)\\D+(\\d+)/);\n   if (rgbvals) {\n      return sp.ToHex(rgbvals[1])+sp.ToHex(rgbvals[2])+sp.ToHex(rgbvals[3]);\n      }\n   else {\n      return \"000000\";\n      }\n   }\n\nSocialCalc.Popup.HexDigits=\"0123456789ABCDEF\";\n\nSocialCalc.Popup.ToHex = function(num) {\n   var sp = SocialCalc.Popup;\n   var first=Math.floor(num / 16);\n   var second=num % 16;\n   return sp.HexDigits.charAt(first)+sp.HexDigits.charAt(second);\n   }\n\nSocialCalc.Popup.FromHex = function(str) {\n\n   var sp = SocialCalc.Popup;\n   var first = sp.HexDigits.indexOf(str.charAt(0).toUpperCase());\n   var second = sp.HexDigits.indexOf(str.charAt(1).toUpperCase());\n   return ((first>=0)?first:0)*16+((second>=0)?second:0);\n   }\n\nSocialCalc.Popup.HexToRGB = function(val) {\n\n   var sp = SocialCalc.Popup;\n\n   return \"rgb(\"+sp.FromHex(val.substring(1,3))+\",\"+sp.FromHex(val.substring(3,5))+\",\"+sp.FromHex(val.substring(5,7))+\")\";\n\n   }\n\nSocialCalc.Popup.makeRGB = function(r, g, b) {\n   return \"rgb(\"+(r>0?r:0)+\",\"+(g>0?g:0)+\",\"+(b>0?b:0)+\")\";\n   }\n\nSocialCalc.Popup.splitRGB = function(rgb) {\n   var parts = rgb.match(/(\\d+)\\D+(\\d+)\\D+(\\d+)\\D/);\n   if (!parts) {\n      return {r:0, g:0, b:0};\n      }\n   else {\n      return {r: parts[1]-0, g: parts[2]-0, b: parts[3]-0};\n      }\n   }\n\n// * * * * * * * * * * * * * * * *\n//\n// ROUTINES FOR EACH TYPE\n//\n// * * * * * * * * * * * * * * * *\n\n//\n// List\n//\n// type: List\n// value: value of control,\n// display: \"value to display\",\n// custom: true if custom value,\n// disabled: t/f,\n// attribs: {\n//    title: \"popup title string\",\n//    moveable: t/f,\n//    width: optional width, e.g., \"100px\",\n//    ensureWithin: optional element object to ensure popup fits within if possible\n//    changedcallback: optional function(attribs, id, newvalue),\n//    ...\n//    }\n// data: {\n//    ncols: calculated number of columns\n//    options: [\n//       {o: option-name, v: value-to-return,\n//        a: {option attribs} // optional: {skip: true, custom: true, cancel: true, newcol: true}\n//       },\n//       ...]\n//    }\n//\n// popupele: gets popup element object when created\n// contentele: gets element created with all the content\n// listdiv: gets div with list of items\n// customele: gets input element with custom value\n// dragregistered: gets element, if any, registered as draggable\n//\n\nSocialCalc.Popup.Types.List = {};\n\nSocialCalc.Popup.Types.List.Create = function(type, id, attribs) {\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n\n   var spcid = {type: type, value: \"\", display: \"\", data: {}};\n   if (spc[id]) { return;}\n   spc[id] = spcid;\n   var spcdata = spcid.data;\n\n   spcdata.attribs = attribs || {};\n\n   var ele = document.getElementById(id);\n   if (!ele) {alert(\"Missing element \"+id); return;}\n\n   spcdata.mainele = ele;\n\n   ele.innerHTML = '<input style=\"cursor:pointer;width:'+(spcdata.attribs.inputWidth||'100px')+';font-size:smaller;\" onfocus=\"this.blur();\" onclick=\"SocialCalc.Popup.CClick(\\''+id+'\\');\" value=\"\">';\n\n   spcdata.options = []; // set to nothing - use Initialize to fill\n\n   }\n\nSocialCalc.Popup.Types.List.SetValue = function(type, id, value) {\n\n   var i;\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n   var spcdata = spc[id].data;\n\n   spcdata.value = value;\n   spcdata.custom = false;\n\n   for (i=0; i<spcdata.options.length; i++) {\n      o = spcdata.options[i];\n      if (o.a) {\n         if (o.a.skip || o.a.custom || o.a.cancel) {\n            continue;\n            }\n         }\n      if (o.v == spcdata.value) { // matches value\n         spcdata.display = o.o;\n         break;\n         }\n      }\n   if (i==spcdata.options.length) { // none found\n      spcdata.display = \"Custom\";\n      spcdata.custom = true;\n      }\n\n   if (spcdata.mainele && spcdata.mainele.firstChild) {\n      spcdata.mainele.firstChild.value = spcdata.display;\n      }\n\n   }\n\n\nSocialCalc.Popup.Types.List.SetDisabled = function(type, id, disabled) {\n\n   var i;\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n   var spcdata = spc[id].data;\n\n   spcdata.disabled = disabled;\n\n   if (spcdata.mainele && spcdata.mainele.firstChild) {\n      spcdata.mainele.firstChild.disabled = disabled;\n      }\n\n   }\n\n\nSocialCalc.Popup.Types.List.GetValue = function(type, id) {\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n   var spcdata = spc[id].data;\n\n   return spcdata.value;\n\n   }\n\n\n// data is: {value: initial value, attribs: {attribs stuff}, options: [{o: option-name, v: value-to-return, a: optional-attribs}, ...]}\n\nSocialCalc.Popup.Types.List.Initialize = function(type, id, data) {\n\n   var a;\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n   var spcdata = spc[id].data;\n\n   for (a in data.attribs) {\n      spcdata.attribs[a] = data.attribs[a];\n      }\n\n   spcdata.options = data ? data.options : [];\n\n   if (data.value) { // if has a value, set to it\n      sp.SetValue(id, data.value);\n      }\n\n   }\n\n\nSocialCalc.Popup.Types.List.Reset = function(type) {\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n\n   if (sp.Current.id && spc[sp.Current.id].type == type) { // we have a popup\n      spt[type].Hide(type, sp.Current.id);\n      sp.Current.id = null;\n      }\n\n   }\n\n\nSocialCalc.Popup.Types.List.Show = function(type, id) {\n\n   var i, ele, o, bg;\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n   var spcdata = spc[id].data\n\n   var str = \"\";\n\n   spcdata.popupele = sp.CreatePopupDiv(id, spcdata.attribs);\n\n   if (spcdata.custom) {\n      str = SocialCalc.Popup.Types.List.MakeCustom(type, id);\n\n      ele = document.createElement(\"div\");\n      ele.innerHTML = '<div style=\"cursor:default;padding:4px;background-color:#CCC;\">'+str+'</div>';\n\n      spcdata.customele = ele.firstChild.firstChild.childNodes[1];\n      spcdata.listdiv = null;\n      spcdata.contentele = ele;\n      }\n   else {\n      str = SocialCalc.Popup.Types.List.MakeList(type, id);\n\n      ele = document.createElement(\"div\");\n      ele.innerHTML = '<div style=\"cursor:default;padding:4px;\">'+str+'</div>';\n\n      spcdata.customele = null;\n      spcdata.listdiv = ele.firstChild;\n      spcdata.contentele = ele;\n      }\n\n   if (spcdata.mainele && spcdata.mainele.firstChild) {\n      spcdata.mainele.firstChild.disabled = true;\n      }\n\n   spcdata.popupele.appendChild(ele);\n\n   if (spcdata.attribs.ensureWithin) {\n      SocialCalc.Popup.EnsurePosition(id, spcdata.attribs.ensureWithin);\n      }\n\n   }\n\n\nSocialCalc.Popup.Types.List.MakeList = function(type, id) {\n\n   var i, ele, o, bg;\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n   var spcdata = spc[id].data\n\n   var str = '<table cellspacing=\"0\" cellpadding=\"0\"><tr>';\n   var td = '<td style=\"vertical-align:top;\">';\n\n   str += td;\n\n   spcdata.ncols = 1;\n\n   for (i=0; i<spcdata.options.length; i++) {\n      o = spcdata.options[i];\n      if (o.a) {\n         if ( o.a.newcol) {\n            str += '</td>'+td+\"&nbsp;&nbsp;&nbsp;&nbsp;\"+'</td>'+td;\n            spcdata.ncols += 1;\n            continue;\n            }\n         if (o.a.skip) {\n            str += '<div style=\"font-size:x-small;white-space:nowrap;\">'+o.o+'</div>';\n            continue;\n            }\n         }\n      if (o.v == spcdata.value && !(o.a && (o.a.custom || o.a.cancel))) { // matches value\n         bg = \"background-color:#DDF;\";\n         }\n      else {\n         bg = \"\";\n         }\n      str += '<div style=\"font-size:x-small;white-space:nowrap;'+bg+'\" onclick=\"SocialCalc.Popup.Types.List.ItemClicked(\\''+id+'\\',\\''+i+'\\');\" onmousemove=\"SocialCalc.Popup.Types.List.MouseMove(\\''+id+'\\',this);\">'+o.o+'</div>';\n      }\n\n   str += \"</td></tr></table>\";\n\n   return str;\n\n   }\n\n\nSocialCalc.Popup.Types.List.MakeCustom = function(type, id) {\n\n   var SPLoc = SocialCalc.Popup.LocalizeString;\n\n   var i, ele, o, bg;\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n   var spcdata = spc[id].data;\n\n   var style = 'style=\"font-size:smaller;\"';\n\n   var str = \"\";\n\n   var val = spcdata.value;\n   val = SocialCalc.special_chars(val);\n\n   str = '<div style=\"white-space:nowrap;\"><br>'+\n         '<input id=\"customvalue\" value=\"'+val+'\"><br><br>'+\n         '<input '+style+' type=\"button\" value=\"'+SPLoc(\"OK\")+'\" onclick=\"SocialCalc.Popup.Types.List.CustomOK(\\''+id+'\\');return false;\">'+\n         '<input '+style+' type=\"button\" value=\"'+SPLoc(\"List\")+'\" onclick=\"SocialCalc.Popup.Types.List.CustomToList(\\''+id+'\\');\">'+\n         '<input '+style+' type=\"button\" value=\"'+SPLoc(\"Cancel\")+'\" onclick=\"SocialCalc.Popup.Close();\">'+\n         '<br></div>';\n\n   return str;\n\n   }\n\n\nSocialCalc.Popup.Types.List.ItemClicked = function(id, num) {\n\n   var oele, str, nele;\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n   var spcdata = spc[id].data;\n\n   var a = spcdata.options[num].a;\n\n   if (a && a.custom) {\n      oele = spcdata.contentele;\n      str = SocialCalc.Popup.Types.List.MakeCustom(\"List\", id);\n      nele = document.createElement(\"div\");\n      nele.innerHTML = '<div style=\"cursor:default;padding:4px;background-color:#CCC;\">'+str+'</div>';\n      spcdata.customele = nele.firstChild.firstChild.childNodes[1];\n      spcdata.listdiv = null;\n      spcdata.contentele = nele;\n      spcdata.popupele.replaceChild(nele, oele);\n      if (spcdata.attribs.ensureWithin) {\n         SocialCalc.Popup.EnsurePosition(id, spcdata.attribs.ensureWithin);\n         }\n      return;\n      }\n\n   if (a && a.cancel) {\n      SocialCalc.Popup.Close();\n      return;\n      }\n\n   SocialCalc.Popup.SetValue(id, spcdata.options[num].v);\n\n   SocialCalc.Popup.Close();\n   \n   }\n\n\nSocialCalc.Popup.Types.List.CustomToList = function(id) {\n\n   var oele, str, nele;\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n   var spcdata = spc[id].data;\n\n   oele = spcdata.contentele;\n   str = SocialCalc.Popup.Types.List.MakeList(\"List\", id);\n   nele = document.createElement(\"div\");\n   nele.innerHTML = '<div style=\"cursor:default;padding:4px;\">'+str+'</div>';\n   spcdata.customele = null;\n   spcdata.listdiv = nele.firstChild;\n   spcdata.contentele = nele;\n   spcdata.popupele.replaceChild(nele, oele);\n   \n   if (spcdata.attribs.ensureWithin) {\n      SocialCalc.Popup.EnsurePosition(id, spcdata.attribs.ensureWithin);\n      }\n   }\n\n\nSocialCalc.Popup.Types.List.CustomOK = function(id) {\n\n   var i, c;\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n   var spcdata = spc[id].data;\n\n   SocialCalc.Popup.SetValue(id, spcdata.customele.value);\n\n   SocialCalc.Popup.Close();\n   \n   }\n\n\nSocialCalc.Popup.Types.List.MouseMove = function(id, ele) {\n\n   var col, i, c;\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n   var spcdata = spc[id].data;\n\n   var list = spcdata.listdiv;\n\n   if (!list) return;\n\n   var rowele = list.firstChild.firstChild.firstChild; // div.table.tbody.tr\n\n   for (col=0; col<spcdata.ncols; col++) {\n      for (i=0; i<rowele.childNodes[col*2].childNodes.length; i++) {\n         rowele.childNodes[col*2].childNodes[i].style.backgroundColor = \"#FFF\";\n         }\n      }\n\n   ele.style.backgroundColor = \"#DDF\";\n   \n   }\n\nSocialCalc.Popup.Types.List.Hide = function(type, id) {\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n   var spcdata = spc[id].data;\n\n   sp.DestroyPopupDiv(spcdata.popupele, spcdata.dragregistered);\n   spcdata.popupele = null;\n\n   if (spcdata.mainele && spcdata.mainele.firstChild) {\n      spcdata.mainele.firstChild.disabled = false;\n      }\n\n   }\n\nSocialCalc.Popup.Types.List.Cancel = function(type, id) {\n\n   SocialCalc.Popup.Types.List.Hide(type, id);\n\n   }\n\n\n//\n// ColorChooser\n//\n// type: ColorChooser\n// value: value of control as \"rgb(r,g,b)\" or \"\" if default,\n// oldvalue: starting value to reset to on close,\n// display: \"value to display\" as hex color value,\n// custom: true if custom value,\n// disabled: t/f,\n// attribs: {\n//    title: \"popup title string\",\n//    moveable: t/f,\n//    width: optional width, e.g., \"100px\", of popup chooser\n//    ensureWithin: optional element object to ensure popup fits within if possible\n//    sampleWidth: optional width, e.g., \"20px\",\n//    sampleHeight: optional height, e.g., \"20px\",\n//    backgroundImage: optional background image for sample (transparent where want to show current color), e.g., \"colorbg.gif\"\n//    backgroundImageDefault: optional background image for sample when default (transparent shows white)\n//    backgroundImageDisabled: optional background image for sample when disabled (transparent shows gray)\n//    changedcallback: optional function(attribs, id, newvalue),\n//    ...\n//    }\n// data: {\n//    }\n//\n// popupele: gets popup element object when created\n// contentele: gets element created with all the content\n// customele: gets input element with custom value\n//\n\nSocialCalc.Popup.Types.ColorChooser = {};\n\nSocialCalc.Popup.Types.ColorChooser.Create = function(type, id, attribs) {\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n\n   var spcid = {type: type, value: \"\", display: \"\", data: {}};\n   if (spc[id]) { return;}\n   spc[id] = spcid;\n   var spcdata = spcid.data;\n\n   spcdata.attribs = attribs || {};\n   var spca = spcdata.attribs;\n\n   spcdata.value = \"\";\n\n   var ele = document.getElementById(id);\n   if (!ele) {alert(\"Missing element \"+id); return;}\n\n   spcdata.mainele = ele;\n\n   ele.innerHTML = '<div style=\"cursor:pointer;border:1px solid black;vertical-align:top;width:'+\n                   (spca.sampleWidth || '15px')+';height:'+(spca.sampleHeight || '15px')+\n                   ';\" onclick=\"SocialCalc.Popup.Types.ColorChooser.ControlClicked(\\''+id+'\\');\">&nbsp;</div>';\n\n   }\n\nSocialCalc.Popup.Types.ColorChooser.SetValue = function(type, id, value) {\n\n   var i, img, pos;\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n   var spcdata = spc[id].data;\n   var spca = spcdata.attribs;\n\n   spcdata.value = value;\n   spcdata.custom = false;\n\n   if (spcdata.mainele && spcdata.mainele.firstChild) {\n      if (spcdata.value) {\n         spcdata.mainele.firstChild.style.backgroundColor = spcdata.value;\n         if (spca.backgroundImage) {\n            img = \"url(\"+sp.imagePrefix+spca.backgroundImage+\")\";\n            }\n         else {\n            img = \"\";\n            }\n         pos = \"center center\";\n         }\n      else {\n         spcdata.mainele.firstChild.style.backgroundColor = \"#FFF\";\n         if (spca.backgroundImageDefault) {\n            img = \"url(\"+sp.imagePrefix+spca.backgroundImageDefault+\")\";\n            pos = \"center center\";\n            }\n         else {\n            img = \"url(\"+sp.imagePrefix+\"defaultcolor.gif)\";\n            pos = \"left top\";\n            }\n         }\n      spcdata.mainele.firstChild.style.backgroundPosition = pos;\n      spcdata.mainele.firstChild.style.backgroundImage = img;\n      }\n\n   }\n\n\nSocialCalc.Popup.Types.ColorChooser.SetDisabled = function(type, id, disabled) {\n\n   var i;\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n   var spcdata = spc[id].data;\n   var spca = spcdata.attribs;\n\n   spcdata.disabled = disabled;\n\n   if (spcdata.mainele && spcdata.mainele.firstChild) {\n      if (disabled) {\n         spcdata.mainele.firstChild.style.backgroundColor = \"#DDD\";\n         if (spca.backgroundImageDisabled) {\n            img = \"url(\"+sp.imagePrefix+spca.backgroundImageDisabled+\")\";\n            pos = \"center center\";\n            }\n         else {\n            img = \"url(\"+sp.imagePrefix+\"defaultcolor.gif)\";\n            pos = \"left top\";\n            }\n         spcdata.mainele.firstChild.style.backgroundPosition = pos;\n         spcdata.mainele.firstChild.style.backgroundImage = img;\n         }\n      else {\n         sp.SetValue(id, spcdata.value);\n         }\n      }\n\n   }\n\n\nSocialCalc.Popup.Types.ColorChooser.GetValue = function(type, id) {\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n   var spcdata = spc[id].data;\n\n   return spcdata.value;\n\n   }\n\n\nSocialCalc.Popup.Types.ColorChooser.Initialize = function(type, id, data) {\n\n   var a;\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n   var spcdata = spc[id].data;\n\n   for (a in data.attribs) {\n      spcdata.attribs[a] = data.attribs[a];\n      }\n\n   if (data.value) { // if has a value, set to it\n      sp.SetValue(id, data.value);\n      }\n\n   }\n\n\nSocialCalc.Popup.Types.ColorChooser.Reset = function(type) {\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n\n   if (sp.Current.id && spc[sp.Current.id].type == type) { // we have a popup\n      spt[type].Hide(type, sp.Current.id);\n      sp.Current.id = null;\n      }\n\n   }\n\n\nSocialCalc.Popup.Types.ColorChooser.Show = function(type, id) {\n\n   var i, ele, mainele;\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n   var spcdata = spc[id].data\n\n   var str = \"\";\n\n   spcdata.oldvalue = spcdata.value; // remember starting value\n\n   spcdata.popupele = sp.CreatePopupDiv(id, spcdata.attribs);\n\n   if (spcdata.custom) {\n      str = SocialCalc.Popup.Types.ColorChooser.MakeCustom(type, id);\n\n      ele = document.createElement(\"div\");\n      ele.innerHTML = '<div style=\"cursor:default;padding:4px;background-color:#CCC;\">'+str+'</div>';\n\n      spcdata.customele = ele.firstChild.firstChild.childNodes[2];\n      spcdata.contentele = ele;\n      }\n   else {\n      mainele = SocialCalc.Popup.Types.ColorChooser.CreateGrid(type, id);\n\n      ele = document.createElement(\"div\");\n      ele.style.padding = \"3px\";\n      ele.style.backgroundColor = \"#CCC\";\n      ele.appendChild(mainele);\n\n      spcdata.customele = null;\n      spcdata.contentele = ele;\n      }\n\n   spcdata.popupele.appendChild(ele);\n\n   if (spcdata.attribs.ensureWithin) {\n      SocialCalc.Popup.EnsurePosition(id, spcdata.attribs.ensureWithin);\n      }\n\n   }\n\n\nSocialCalc.Popup.Types.ColorChooser.MakeCustom = function(type, id) {\n\n   var i, ele, o, bg;\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n   var spcdata = spc[id].data;\n\n   var SPLoc = sp.LocalizeString;\n\n   var style = 'style=\"font-size:smaller;\"';\n\n   var str = \"\";\n\n   str = '<div style=\"white-space:nowrap;\"><br>'+\n         '#<input id=\"customvalue\" style=\"width:75px;\" value=\"'+spcdata.value+'\"><br><br>'+\n         '<input '+style+' type=\"button\" value=\"'+SPLoc(\"OK\")+'\" onclick=\"SocialCalc.Popup.Types.ColorChooser.CustomOK(\\''+id+'\\');return false;\">'+\n         '<input '+style+' type=\"button\" value=\"'+SPLoc(\"Grid\")+'\" onclick=\"SocialCalc.Popup.Types.ColorChooser.CustomToGrid(\\''+id+'\\');\">'+\n         '<br></div>';\n\n   return str;\n\n   }\n\n\nSocialCalc.Popup.Types.ColorChooser.ItemClicked = function(id, num) {\n\n   var oele, str, nele;\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n   var spcdata = spc[id].data;\n\n   SocialCalc.Popup.Close();\n   \n   }\n\n\nSocialCalc.Popup.Types.ColorChooser.CustomToList = function(id) {\n\n   var oele, str, nele;\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n   var spcdata = spc[id].data;\n\n   }\n\n\nSocialCalc.Popup.Types.ColorChooser.CustomOK = function(id) {\n\n   var i, c;\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n   var spcdata = spc[id].data;\n\n   sp.SetValue(id, spcdata.customele.value);\n\n   sp.Close();\n   \n   }\n\n\nSocialCalc.Popup.Types.ColorChooser.Hide = function(type, id) {\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n   var spcdata = spc[id].data;\n\n   sp.DestroyPopupDiv(spcdata.popupele, spcdata.dragregistered);\n   spcdata.popupele = null;\n\n   }\n\n\nSocialCalc.Popup.Types.ColorChooser.Cancel = function(type, id) {\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n   var spcdata = spc[id].data;\n\n   sp.SetValue(id, spcdata.oldvalue); // reset to old value\n\n   SocialCalc.Popup.Types.ColorChooser.Hide(type, id);\n\n   }\n\n\nSocialCalc.Popup.Types.ColorChooser.CreateGrid = function (type, id) {\n\n   var ele, pos, row, rowele, col, g;\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n   var SPLoc = sp.LocalizeString;\n   var spcdata = spc[id].data;\n   spcdata.grid = {};\n   var grid = spcdata.grid;\n\n   var mainele = document.createElement(\"div\");\n\n   ele = document.createElement(\"table\");\n   ele.cellSpacing = 0;\n   ele.cellPadding = 0;\n   ele.style.width = \"100px\";\n   grid.table = ele;\n\n   ele = document.createElement(\"tbody\");\n   grid.table.appendChild(ele);\n   grid.tbody = ele;\n\n   for (row=0; row<16; row++) {\n      rowele = document.createElement(\"tr\");\n      for (col=0; col<5; col++) {\n         g = {};\n         grid[row+\",\"+col] = g;\n         ele = document.createElement(\"td\");\n         ele.style.fontSize = \"1px\";\n         ele.innerHTML = \"&nbsp;\";\n         ele.style.height = \"10px\";\n         if (col<=1) {\n            ele.style.width = \"17px\";\n            ele.style.borderRight = \"3px solid white\";\n            }\n         else {\n            ele.style.width = \"20px\";\n            ele.style.backgroundRepeat = \"no-repeat\";\n            }\n         rowele.appendChild(ele);\n         g.ele = ele;\n         }\n      grid.tbody.appendChild(rowele);\n      }\n   mainele.appendChild(grid.table);\n\n   ele = document.createElement(\"div\");\n   ele.style.marginTop = \"3px\";\n   ele.innerHTML = '<table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\n      '<td style=\"width:17px;background-color:#FFF;background-image:url('+sp.imagePrefix+'defaultcolor.gif);height:16px;font-size:10px;cursor:pointer;\" title=\"'+SPLoc(\"Default\")+'\">&nbsp;</td>'+\n      '<td style=\"width:23px;height:16px;font-size:10px;text-align:center;cursor:pointer;\" title=\"'+SPLoc(\"Custom\")+'\">#</td>'+\n      '<td style=\"width:60px;height:16px;font-size:10px;text-align:center;cursor:pointer;\">'+SPLoc(\"OK\")+'</td>'+\n      '</tr></table>';\n   grid.defaultbox = ele.firstChild.firstChild.firstChild.childNodes[0];\n   grid.defaultbox.onclick = spt.ColorChooser.DefaultClicked;\n   grid.custom = ele.firstChild.firstChild.firstChild.childNodes[1];\n   grid.custom.onclick = spt.ColorChooser.CustomClicked;\n   grid.msg = ele.firstChild.firstChild.firstChild.childNodes[2];\n   grid.msg.onclick = spt.ColorChooser.CloseOK;\n   mainele.appendChild(ele);\n\n   grid.table.onmousedown = spt.ColorChooser.GridMouseDown;\n\n   spt.ColorChooser.DetermineColors(id);\n   spt.ColorChooser.SetColors(id);\n\n   return mainele;\n\n   }\n\nSocialCalc.Popup.Types.ColorChooser.gridToG = function(grid, row, col) {\n\n   return grid[row+\",\"+col];\n\n   }\n\nSocialCalc.Popup.Types.ColorChooser.DetermineColors = function(id) {\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var sptc = spt.ColorChooser;\n   var spc = sp.Controls;\n   var spcdata = spc[id].data;\n   var grid = spcdata.grid;\n\n   var col, row;\n   var rgb = sp.splitRGB(spcdata.value);\n   var color;\n\n   col = 2;\n   row = 16-Math.floor((rgb.r+16)/16);\n   grid[\"selectedrow\"+col] = row;\n   for (row=0; row<16; row++) {\n      sptc.gridToG(grid,row,col).rgb = sp.makeRGB(17*(15-row),0,0);\n      }\n\n   col = 3;\n   row = 16-Math.floor((rgb.g+16)/16);\n   grid[\"selectedrow\"+col] = row;\n   for (row=0; row<16; row++) {\n      sptc.gridToG(grid,row,col).rgb = sp.makeRGB(0,17*(15-row),0);\n      }\n\n   col = 4;\n   row = 16-Math.floor((rgb.b+16)/16);\n   grid[\"selectedrow\"+col] = row;\n   for (row=0; row<16; row++) {\n      sptc.gridToG(grid,row,col).rgb = sp.makeRGB(0,0,17*(15-row));\n      }\n\n   col = 1;\n   for (row=0; row<16; row++) {\n      sptc.gridToG(grid,row,col).rgb = sp.makeRGB(17*(15-row),17*(15-row),17*(15-row));\n      }\n\n   col = 0;\n   var steps = [0, 68, 153, 204, 255];\n   var commonrgb = [\"400\", \"310\", \"420\", \"440\", \"442\", \"340\", \"040\", \"042\", \"032\", \"044\", \"024\", \"004\", \"204\", \"314\", \"402\", \"414\"];\n   var x;\n   for (row=0; row<16; row++) {\n      x = commonrgb[row];\n      sptc.gridToG(grid,row,col).rgb = \"rgb(\"+steps[x.charAt(0)-0]+\",\"+steps[x.charAt(1)-0]+\",\"+steps[x.charAt(2)-0]+\")\";\n      }\n\n   }\n\nSocialCalc.Popup.Types.ColorChooser.SetColors = function(id) {\n\n   var row, col, g, ele, rgb;\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var sptc = spt.ColorChooser;\n   var spc = sp.Controls;\n   var spcdata = spc[id].data;\n   var grid = spcdata.grid;\n\n   for (row=0; row<16; row++) {\n      for (col=0; col<5; col++) {\n         g = sptc.gridToG(grid,row, col);\n         g.ele.style.backgroundColor = g.rgb;\n         g.ele.title = sp.RGBToHex(g.rgb);\n         if (grid[\"selectedrow\"+col]==row) {\n            g.ele.style.backgroundImage = \"url(\"+sp.imagePrefix+\"chooserarrow.gif)\";\n            }\n         else {\n            g.ele.style.backgroundImage = \"\";\n            }\n         }\n      }\n\n   sp.SetValue(id, spcdata.value);\n\n   grid.msg.style.backgroundColor = spcdata.value;\n   rgb = sp.splitRGB(spcdata.value || \"rgb(255,255,255)\");\n   if (rgb.r+rgb.g+rgb.b < 220) {\n      grid.msg.style.color = \"#FFF\";\n      }\n   else {\n      grid.msg.style.color = \"#000\";\n      }\n   if (!spcdata.value) { // default\n      grid.msg.style.backgroundColor = \"#FFF\";\n      grid.msg.style.backgroundImage = \"url(\"+sp.imagePrefix+\"defaultcolor.gif)\";\n      grid.msg.title = \"Default\";\n      }\n   else {\n      grid.msg.style.backgroundImage = \"\";\n      grid.msg.title = sp.RGBToHex(spcdata.value);\n      }\n\n   }\n\nSocialCalc.Popup.Types.ColorChooser.GridMouseDown = function(e) {\n\n   var event = e || window.event;\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var sptc = spt.ColorChooser;\n   var spc = sp.Controls;\n\n   var id = sp.Current.id;\n   if (!id) return;\n\n   var spcdata = spc[id].data;\n   var grid = spcdata.grid;\n\n   switch (event.type) {\n      case \"mousedown\":\n         grid.mousedown = true;\n         break;\n      case \"mouseup\":\n         grid.mousedown = false;\n         break;\n      case \"mousemove\":\n         if (!grid.mousedown) {\n            return;\n            }\n         break;\n      }\n\n   var viewport = SocialCalc.GetViewportInfo();\n   var clientX = event.clientX + viewport.horizontalScroll;\n   var clientY = event.clientY + viewport.verticalScroll;\n   var gpos = SocialCalc.GetElementPosition(grid.table);\n   var row = Math.floor((clientY-gpos.top-2)/10); // -2 is to split the diff btw IE & FF\n   row = row < 0 ? 0 : row;\n   var col = Math.floor((clientX-gpos.left)/20);\n   row = row < 0 ? 0 : (row > 15 ? 15 : row);\n   col = col < 0 ? 0 : (col > 4 ? 4 : col);\n   var color = sptc.gridToG(grid,row,col).ele.style.backgroundColor;\n   var newrgb = sp.splitRGB(color);\n   var oldrgb = sp.splitRGB(spcdata.value);\n\n   switch (col) {\n      case 2:\n         spcdata.value = sp.makeRGB(newrgb.r, oldrgb.g, oldrgb.b);\n         break;\n      case 3:\n         spcdata.value = sp.makeRGB(oldrgb.r, newrgb.g, oldrgb.b);\n         break;\n      case 4:\n         spcdata.value = sp.makeRGB(oldrgb.r, oldrgb.g, newrgb.b);\n         break;\n      case 0:\n      case 1:\n         spcdata.value = color;\n      }\n\n   sptc.DetermineColors(id);\n   sptc.SetColors(id);\n\n   }\n\n\nSocialCalc.Popup.Types.ColorChooser.ControlClicked = function(id) {\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var sptc = spt.ColorChooser;\n   var spc = sp.Controls;\n\n   var cid = sp.Current.id;\n   if (!cid || id != cid) {\n      sp.CClick(id);\n      return;\n      }\n\n   sptc.CloseOK();\n\n   }\n\nSocialCalc.Popup.Types.ColorChooser.DefaultClicked = function(e) {\n\n   var event = e || window.event;\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var sptc = spt.ColorChooser;\n   var spc = sp.Controls;\n\n   var id = sp.Current.id;\n   if (!id) return;\n\n   var spcdata = spc[id].data;\n\n   spcdata.value = \"\";\n   SocialCalc.Popup.SetValue(id, spcdata.value);\n\n   SocialCalc.Popup.Close();\n\n   }\n\nSocialCalc.Popup.Types.ColorChooser.CustomClicked = function(e) {\n\n   var event = e || window.event;\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var sptc = spt.ColorChooser;\n   var spc = sp.Controls;\n\n   var id = sp.Current.id;\n   if (!id) return;\n\n   var spcdata = spc[id].data;\n\n   var oele, str, nele;\n\n   oele = spcdata.contentele;\n   str = SocialCalc.Popup.Types.ColorChooser.MakeCustom(\"ColorChooser\", id);\n   nele = document.createElement(\"div\");\n   nele.innerHTML = '<div style=\"cursor:default;padding:4px;background-color:#CCC;\">'+str+'</div>';\n   spcdata.customele = nele.firstChild.firstChild.childNodes[2];\n   spcdata.contentele = nele;\n   spcdata.popupele.replaceChild(nele, oele);\n\n   spcdata.customele.value = sp.RGBToHex(spcdata.value);\n\n   if (spcdata.attribs.ensureWithin) {\n      SocialCalc.Popup.EnsurePosition(id, spcdata.attribs.ensureWithin);\n      }\n\n   }\n\n\n\nSocialCalc.Popup.Types.ColorChooser.CustomToGrid = function(id) {\n\n   var oele, str, nele;\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n   var spcdata = spc[id].data;\n\n   SocialCalc.Popup.SetValue(id, sp.HexToRGB(\"#\"+spcdata.customele.value));\n\n   var oele, mainele, nele;\n\n   oele = spcdata.contentele;\n   mainele = SocialCalc.Popup.Types.ColorChooser.CreateGrid(\"ColorChooser\", id);\n   nele = document.createElement(\"div\");\n   nele.style.padding = \"3px\";\n   nele.style.backgroundColor = \"#CCC\";\n   nele.appendChild(mainele);\n   spcdata.customele = null;\n   spcdata.contentele = nele;\n   spcdata.popupele.replaceChild(nele, oele);\n   \n   if (spcdata.attribs.ensureWithin) {\n      SocialCalc.Popup.EnsurePosition(id, spcdata.attribs.ensureWithin);\n      }\n   }\n\n\nSocialCalc.Popup.Types.ColorChooser.CustomOK = function(id) {\n\n   var i, c;\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n   var spcdata = spc[id].data;\n\n   SocialCalc.Popup.SetValue(id, sp.HexToRGB(\"#\"+spcdata.customele.value));\n\n   SocialCalc.Popup.Close();\n   \n   }\n\nSocialCalc.Popup.Types.ColorChooser.CloseOK = function(e) {\n\n   var event = e || window.event;\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var sptc = spt.ColorChooser;\n   var spc = sp.Controls;\n\n   var id = sp.Current.id;\n   if (!id) return;\n\n   var spcdata = spc[id].data;\n\n   SocialCalc.Popup.SetValue(id, spcdata.value);\n\n   SocialCalc.Popup.Close();\n\n   }\n\n//\n// SocialCalcSpreadsheetControl\n//\n/*\n// The code module of the SocialCalc package that lets you embed a spreadsheet\n// control with toolbar, etc., into a web page.\n//\n// (c) Copyright 2008, 2009, 2010 Socialtext, Inc.\n// All Rights Reserved.\n//\n*/\n\n/*\n\nLEGAL NOTICES REQUIRED BY THE COMMON PUBLIC ATTRIBUTION LICENSE:\n\nEXHIBIT A. Common Public Attribution License Version 1.0.\n\nThe contents of this file are subject to the Common Public Attribution License Version 1.0 (the \n\"License\"); you may not use this file except in compliance with the License. You may obtain a copy \nof the License at http://socialcalc.org. The License is based on the Mozilla Public License Version 1.1 but \nSections 14 and 15 have been added to cover use of software over a computer network and provide for \nlimited attribution for the Original Developer. In addition, Exhibit A has been modified to be \nconsistent with Exhibit B.\n\nSoftware distributed under the License is distributed on an \"AS IS\" basis, WITHOUT WARRANTY OF ANY \nKIND, either express or implied. See the License for the specific language governing rights and \nlimitations under the License.\n\nThe Original Code is SocialCalc JavaScript SpreadsheetControl.\n\nThe Original Developer is the Initial Developer.\n\nThe Initial Developer of the Original Code is Socialtext, Inc. All portions of the code written by \nSocialtext, Inc., are Copyright (c) Socialtext, Inc. All Rights Reserved.\n\nContributor: Dan Bricklin.\n\n\nEXHIBIT B. Attribution Information\n\nWhen the SpreadsheetControl is producing and/or controlling the display the Graphic Image must be\ndisplayed on the screen visible to the user in a manner comparable to that in the \nOriginal Code. The Attribution Phrase must be displayed as a \"tooltip\" or \"hover-text\" for\nthat image. The image must be linked to the Attribution URL so as to access that page\nwhen clicked. If the user interface includes a prominent \"about\" display which includes\nfactual prominent attribution in a form similar to that in the \"about\" display included\nwith the Original Code, including Socialtext copyright notices and URLs, then the image\nneed not be linked to the Attribution URL but the \"tool-tip\" is still required.\n\nAttribution Copyright Notice:\n\n Copyright (C) 2010 Socialtext, Inc.\n All Rights Reserved.\n\nAttribution Phrase (not exceeding 10 words): SocialCalc\n\nAttribution URL: http://www.socialcalc.org/\n\nGraphic Image: The contents of the sc-logo.gif file in the Original Code or\na suitable replacement from http://www.socialcalc.org/licenses specified as\nbeing for SocialCalc.\n\nDisplay of Attribution Information is required in Larger Works which are defined \nin the CPAL as a work which combines Covered Code or portions thereof with code \nnot governed by the terms of the CPAL.\n\n*/\n\n//\n// Some of the other files in the SocialCalc package are licensed under\n// different licenses. Please note the licenses of the modules you use.\n//\n// Code History:\n//\n// Initially coded by Dan Bricklin of Software Garden, Inc., for Socialtext, Inc.\n// Unless otherwise specified, referring to \"SocialCalc\" in comments refers to this\n// JavaScript version of the code, not the SocialCalc Perl code.\n//\n\n/*\n\nSee the comments in the main SocialCalc code module file of the SocialCalc package.\n\n*/\n\n   var SocialCalc;\n   if (!SocialCalc) {\n      alert(\"Main SocialCalc code module needed\");\n      SocialCalc = {};\n      }\n   if (!SocialCalc.TableEditor) {\n      alert(\"SocialCalc TableEditor code module needed\");\n      }\n\n// *************************************\n//\n// SpreadsheetControl class:\n//\n// *************************************\n\n// Global constants:\n\n   SocialCalc.CurrentSpreadsheetControlObject = null; // right now there can only be one active at a time\n\n\n// Constructor:\n\nSocialCalc.SpreadsheetControl = function() {\n\n   var scc = SocialCalc.Constants;\n\n   // Properties:\n\n   this.parentNode = null;\n   this.spreadsheetDiv = null;\n   this.requestedHeight = 0;\n   this.requestedWidth = 0;\n   this.requestedSpaceBelow = 0;\n   this.height = 0;\n   this.width = 0;\n   this.viewheight = 0; // calculated amount for views below toolbar, etc.\n\n   // Tab definitions: An array where each tab is an object of the form:\n   //\n   //    name: \"name\",\n   //    text: \"text-on-tab\",\n   //    html: \"html-to-create div\",\n   //       replacements:\n   //         \"%s.\": \"SocialCalc\", \"%id.\": spreadsheet.idPrefix, \"%tbt.\": spreadsheet.toolbartext\n   //         Other replacements from spreadsheet.tabreplacements:\n   //            replacementname: {regex: regular-expression-to-match-with-g, replacement: string}\n   //    view: \"viewname\", // view to show when selected; \"sheet\" or missing/null is spreadsheet\n   //    oncreate: function(spreadsheet, tab-name), // called when first created to initialize\n   //    onclick: function(spreadsheet, tab-name), missing/null is sheet default\n   //    onclickFocus: text, // spreadsheet.idPrefix+text is given the focus if present instead of normal KeyboardFocus\n   //       or if text isn't a string, that value (e.g., true) is used for SocialCalc.CmdGotFocus\n   //    onunclick: function(spreadsheet, tab-name), missing/null is sheet default\n\n   this.tabs = [];\n   this.tabnums = {}; // when adding tabs, add tab-name: array-index to this object\n   this.tabreplacements = {}; // see use above\n   this.currentTab = -1; // currently selected tab index in this.tabs or -1 (maintained by SocialCalc.SetTab)\n\n   // View definitions: An object where each view is an object of the form:\n   //\n   //    name: \"name\", // localized when first set using SocialCalc.LocalizeString\n   //    element: node-in-the-dom, // filled in when initialized\n   //    replacements: {}, // see below\n   //    html: \"html-to-create div\",\n   //       replacements:\n   //         \"%s.\": \"SocialCalc\", \"%id.\": spreadsheet.idPrefix, \"%tbt.\": spreadsheet.toolbartext, \"%img.\": spreadsheet.imagePrefix,\n   //         SocialCalc.LocalizeSubstring replacements (\"%loc!string!\" and \"%ssc!constant-name!\")\n   //         Other replacements from viewobject.replacements:\n   //            replacementname: {regex: regular-expression-to-match-with-g, replacement: string}\n   //    divStyle: attributes for sheet div (SocialCalc.setStyles format)\n   //    oncreate: function(spreadsheet, viewobject), // called when first created to initialize\n   //    needsresize: true/false/null, // if true, do resize calc after displaying\n   //    onresize: function(spreadsheet, viewobject), // called if needs resize\n   //    values: {} // optional values to share with onclick handlers, etc.\n   //\n   // There is always a \"sheet\" view.\n\n   this.views = {}; // {viewname: view-object, ...}\n\n   // Dynamic properties:\n\n   this.sheet = null;\n   this.context = null;\n   this.editor = null;\n\n   this.spreadsheetDiv = null;\n   this.editorDiv = null;\n\n   this.sortrange = \"\"; // remembered range for sort tab\n\n   this.moverange = \"\"; // remembered range from movefrom used by movepaste/moveinsert\n\n   // Constants:\n\n   this.idPrefix = \"SocialCalc-\"; // prefix added to element ids used here, should end in \"-\"\n   this.multipartBoundary = \"SocialCalcSpreadsheetControlSave\"; // boundary used by SpreadsheetControlCreateSpreadsheetSave\n   this.imagePrefix = scc.defaultImagePrefix; // prefix added to img src\n\n   this.toolbarbackground = scc.SCToolbarbackground;\n   this.tabbackground = scc.SCTabbackground; // \"background-color:#CCC;\";\n   this.tabselectedCSS = scc.SCTabselectedCSS;\n   this.tabplainCSS = scc.SCTabplainCSS;\n   this.toolbartext = scc.SCToolbartext;\n\n   this.formulabarheight = scc.SCFormulabarheight; // in pixels, will contain a text input box\n\n\n   if (scc.doWorkBook) {\n       this.sheetbarheight = scc.SCSheetBarHeight; \n       this.sheetbarCSS = scc.SCSheetBarCSS;\n   } else {\n       this.sheetbarheight = 0;\n   }\n\n\n   this.statuslineheight = scc.SCStatuslineheight; // in pixels\n   this.statuslineCSS = scc.SCStatuslineCSS;\n\n   // Callbacks:\n\n   this.ExportCallback = null; // a function called for Clipboard Export button: this.ExportCallback(spreadsheet_control_object)\n\n   // Initialization Code:\n\n   this.sheet = new SocialCalc.Sheet();\n   this.context = new SocialCalc.RenderContext(this.sheet);\n   this.context.showGrid=true;\n   this.context.showRCHeaders=true;\n   this.editor = new SocialCalc.TableEditor(this.context);\n   this.editor.StatusCallback.statusline =\n      {func: SocialCalc.SpreadsheetControlStatuslineCallback,\n       params: {statuslineid: this.idPrefix+\"statusline\",\n                recalcid1: this.idPrefix+\"divider_recalc\",\n                recalcid2: this.idPrefix+\"button_recalc\"}};\n\n   SocialCalc.CurrentSpreadsheetControlObject = this; // remember this for rendezvousing on events\n\n   this.editor.MoveECellCallback.movefrom = function(editor) {\n      var cr;\n      var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\n      spreadsheet.context.cursorsuffix = \"\";\n      if (editor.range2.hasrange && !editor.cellhandles.noCursorSuffix) {\n         if (editor.ecell.row==editor.range2.top && (editor.ecell.col<editor.range2.left || editor.ecell.col>editor.range2.right+1)) {\n            spreadsheet.context.cursorsuffix = \"insertleft\";\n            }\n         if (editor.ecell.col==editor.range2.left && (editor.ecell.row<editor.range2.top || editor.ecell.row>editor.range2.bottom+1)) {\n            spreadsheet.context.cursorsuffix = \"insertup\";\n            }\n         }\n      };\n\n   // formula bar buttons\n\n   this.formulabuttons = {\n      formulafunctions: {image: \"formuladialog.gif\", tooltip: \"Functions\", // tooltips are localized when set below\n                         command: SocialCalc.SpreadsheetControl.DoFunctionList},\n      multilineinput: {image: \"multilinedialog.gif\", tooltip: \"Multi-line Input Box\",\n                         command: SocialCalc.SpreadsheetControl.DoMultiline},\n      link: {image: \"linkdialog.gif\", tooltip: \"Link Input Box\",\n                         command: SocialCalc.SpreadsheetControl.DoLink},\n      sum: {image: \"sumdialog.gif\", tooltip: \"Auto Sum\",\n                         command: SocialCalc.SpreadsheetControl.DoSum},\n/*   image: {image: \"sumdialog.gif\", tooltip: \"Insert\",\n                   command: SocialCalc.Images.Insert }*/\n      }\n\n   // Default tabs:\n\n   // Edit\n\n   this.tabnums.edit = this.tabs.length;\n   this.tabs.push({name: \"edit\", text: \"Edit\", html:\n      ' <div id=\"%id.edittools\" style=\"padding:10px 0px 0px 0px;\">'+\n'&nbsp;<img id=\"%id.button_undo\" src=\"%img.undo.gif\" style=\"vertical-align:bottom;\">'+\n' <img id=\"%id.button_redo\" src=\"%img.redo.gif\" style=\"vertical-align:bottom;\">'+\n' &nbsp;<img src=\"%img.divider1.gif\" style=\"vertical-align:bottom;\">&nbsp; '+\n'<img id=\"%id.button_copy\" src=\"%img.copy.gif\" style=\"vertical-align:bottom;\">'+\n' <img id=\"%id.button_cut\" src=\"%img.cut.gif\" style=\"vertical-align:bottom;\">'+\n' <img id=\"%id.button_paste\" src=\"%img.paste.gif\" style=\"vertical-align:bottom;\">'+\n' &nbsp;<img src=\"%img.divider1.gif\" style=\"vertical-align:bottom;\">&nbsp; '+\n'<img id=\"%id.button_delete\" src=\"%img.delete.gif\" style=\"vertical-align:bottom;\">'+\n' <img id=\"%id.button_pasteformats\" src=\"%img.pasteformats.gif\" style=\"vertical-align:bottom;\">'+\n' &nbsp;<img src=\"%img.divider1.gif\" style=\"vertical-align:bottom;\">&nbsp; '+\n'<img id=\"%id.button_filldown\" src=\"%img.filldown.gif\" style=\"vertical-align:bottom;\">'+\n' <img id=\"%id.button_fillright\" src=\"%img.fillright.gif\" style=\"vertical-align:bottom;\">'+\n' &nbsp;<img src=\"%img.divider1.gif\" style=\"vertical-align:bottom;\">&nbsp; '+\n'<img id=\"%id.button_movefrom\" src=\"%img.movefromoff.gif\" style=\"vertical-align:bottom;\">'+\n' <img id=\"%id.button_movepaste\" src=\"%img.movepasteoff.gif\" style=\"vertical-align:bottom;\">'+\n' <img id=\"%id.button_moveinsert\" src=\"%img.moveinsertoff.gif\" style=\"vertical-align:bottom;\">'+\n' &nbsp;<img src=\"%img.divider1.gif\" style=\"vertical-align:bottom;\">&nbsp; '+\n'<img id=\"%id.button_alignleft\" src=\"%img.alignleft.gif\" style=\"vertical-align:bottom;\">'+\n' <img id=\"%id.button_aligncenter\" src=\"%img.aligncenter.gif\" style=\"vertical-align:bottom;\">'+\n' <img id=\"%id.button_alignright\" src=\"%img.alignright.gif\" style=\"vertical-align:bottom;\">'+\n' &nbsp;<img src=\"%img.divider1.gif\" style=\"vertical-align:bottom;\">&nbsp; '+\n'<img id=\"%id.button_borderon\" src=\"%img.borderson.gif\" style=\"vertical-align:bottom;\"> '+\n' <img id=\"%id.button_borderoff\" src=\"%img.bordersoff.gif\" style=\"vertical-align:bottom;\"> '+\n' <img id=\"%id.button_swapcolors\" src=\"%img.swapcolors.gif\" style=\"vertical-align:bottom;\"> '+\n' &nbsp;<img src=\"%img.divider1.gif\" style=\"vertical-align:bottom;\">&nbsp; '+\n'<img id=\"%id.button_merge\" src=\"%img.merge.gif\" style=\"vertical-align:bottom;\"> '+\n' <img id=\"%id.button_unmerge\" src=\"%img.unmerge.gif\" style=\"vertical-align:bottom;\"> '+\n' &nbsp;<img src=\"%img.divider1.gif\" style=\"vertical-align:bottom;\">&nbsp; '+\n'<img id=\"%id.button_insertrow\" src=\"%img.insertrow.gif\" style=\"vertical-align:bottom;\"> '+\n' <img id=\"%id.button_insertcol\" src=\"%img.insertcol.gif\" style=\"vertical-align:bottom;\"> '+\n'&nbsp; <img id=\"%id.button_deleterow\" src=\"%img.deleterow.gif\" style=\"vertical-align:bottom;\"> '+\n' <img id=\"%id.button_deletecol\" src=\"%img.deletecol.gif\" style=\"vertical-align:bottom;\"> '+\n' &nbsp;<img id=\"%id.divider_recalc\" src=\"%img.divider1.gif\" style=\"vertical-align:bottom;\">&nbsp; '+\n'<img id=\"%id.button_recalc\" src=\"%img.recalc.gif\" style=\"vertical-align:bottom;\"> '+\n      ' </div>',\n      oncreate: null, //function(spreadsheet, viewobject) {SocialCalc.DoCmd(null, \"fill-rowcolstuff\");},\n      onclick: null});\n\n   // Settings (Format)\n\n   this.tabnums.settings = this.tabs.length;\n   this.tabs.push({name: \"settings\", text: \"Format\", html:\n      '<div id=\"%id.settingstools\" style=\"display:none;\">'+\n      ' <div id=\"%id.sheetsettingstoolbar\" style=\"display:none;\">'+\n      '  <table cellspacing=\"0\" cellpadding=\"0\"><tr><td>'+\n      '   <div style=\"%tbt.\">%loc!SHEET SETTINGS!:</div>'+\n      '   </td></tr><tr><td>'+\n      '   <input id=\"%id.settings-savesheet\" type=\"button\" value=\"%loc!Save!\" onclick=\"SocialCalc.SettingsControlSave(\\'sheet\\');\">'+\n      '   <input type=\"button\" value=\"%loc!Cancel!\" onclick=\"SocialCalc.SettingsControlSave(\\'cancel\\');\">'+\n      '   <input type=\"button\" value=\"%loc!Show Cell Settings!\" onclick=\"SocialCalc.SpreadsheetControlSettingsSwitch(\\'cell\\');return false;\">'+\n      '   </td></tr></table>'+\n      ' </div>'+\n      ' <div id=\"%id.cellsettingstoolbar\" style=\"display:none;\">'+\n      '  <table cellspacing=\"0\" cellpadding=\"0\"><tr><td>'+\n      '   <div style=\"%tbt.\">%loc!CELL SETTINGS!: <span id=\"%id.settingsecell\">&nbsp;</span></div>'+\n      '   </td></tr><tr><td>'+\n      '  <input id=\"%id.settings-savecell\" type=\"button\" value=\"%loc!Save!\" onclick=\"SocialCalc.SettingsControlSave(\\'cell\\');\">'+\n      '  <input type=\"button\" value=\"%loc!Cancel!\" onclick=\"SocialCalc.SettingsControlSave(\\'cancel\\');\">'+\n      '  <input type=\"button\" value=\"%loc!Show Sheet Settings!\" onclick=\"SocialCalc.SpreadsheetControlSettingsSwitch(\\'sheet\\');return false;\">'+\n      '  </td></tr></table>'+\n      ' </div>'+\n      '</div>',\n      view: \"settings\",\n      onclick: function(s, t) {\n         SocialCalc.SettingsControls.idPrefix = s.idPrefix; // used to get color chooser div\n         SocialCalc.SettingControlReset();\n         var sheetattribs = s.sheet.EncodeSheetAttributes();\n         var cellattribs = s.sheet.EncodeCellAttributes(s.editor.ecell.coord);\n         SocialCalc.SettingsControlLoadPanel(s.views.settings.values.sheetspanel, sheetattribs);\n         SocialCalc.SettingsControlLoadPanel(s.views.settings.values.cellspanel, cellattribs);\n         document.getElementById(s.idPrefix+\"settingsecell\").innerHTML = s.editor.ecell.coord;\n         SocialCalc.SpreadsheetControlSettingsSwitch(\"cell\");\n         s.views.settings.element.style.height = s.viewheight+\"px\";\n         s.views.settings.element.firstChild.style.height = s.viewheight+\"px\";\n\n         var range;  // set save message\n         if (s.editor.range.hasrange) {\n            range = SocialCalc.crToCoord(s.editor.range.left, s.editor.range.top) + \":\" +\n               SocialCalc.crToCoord(s.editor.range.right, s.editor.range.bottom);\n            }\n         else {\n            range = s.editor.ecell.coord;\n            }\n         document.getElementById(s.idPrefix+\"settings-savecell\").value = SocialCalc.LocalizeString(\"Save to\")+\": \"+range;\n         },\n      onclickFocus: true\n         });\n\n   this.views[\"settings\"] = {name: \"settings\", values: {},\n      oncreate: function(s, viewobj) {\n         var scc = SocialCalc.Constants;\n\n         viewobj.values.sheetspanel = {\n//            name: \"sheet\",\n            colorchooser: {id: s.idPrefix+\"scolorchooser\"},\n            formatnumber: {setting: \"numberformat\", type: \"PopupList\", id: s.idPrefix+\"formatnumber\",\n               initialdata: scc.SCFormatNumberFormats},\n            formattext: {setting: \"textformat\", type: \"PopupList\", id: s.idPrefix+\"formattext\",\n               initialdata: scc.SCFormatTextFormats},\n            fontfamily: {setting: \"fontfamily\", type: \"PopupList\", id: s.idPrefix+\"fontfamily\",\n               initialdata: scc.SCFormatFontfamilies},\n            fontlook: {setting: \"fontlook\", type: \"PopupList\", id: s.idPrefix+\"fontlook\",\n               initialdata: scc.SCFormatFontlook},\n            fontsize: {setting: \"fontsize\", type: \"PopupList\", id: s.idPrefix+\"fontsize\",\n               initialdata: scc.SCFormatFontsizes},\n            textalignhoriz: {setting: \"textalignhoriz\", type: \"PopupList\", id: s.idPrefix+\"textalignhoriz\",\n               initialdata: scc.SCFormatTextAlignhoriz},\n            numberalignhoriz: {setting: \"numberalignhoriz\", type: \"PopupList\", id: s.idPrefix+\"numberalignhoriz\",\n               initialdata: scc.SCFormatNumberAlignhoriz},\n            alignvert: {setting: \"alignvert\", type: \"PopupList\", id: s.idPrefix+\"alignvert\",\n               initialdata: scc.SCFormatAlignVertical},\n            textcolor: {setting: \"textcolor\", type: \"ColorChooser\", id: s.idPrefix+\"textcolor\"},\n            bgcolor: {setting: \"bgcolor\", type: \"ColorChooser\", id: s.idPrefix+\"bgcolor\"},\n            padtop: {setting: \"padtop\", type: \"PopupList\", id: s.idPrefix+\"padtop\",\n               initialdata: scc.SCFormatPadsizes},\n            padright: {setting: \"padright\", type: \"PopupList\", id: s.idPrefix+\"padright\",\n               initialdata: scc.SCFormatPadsizes},\n            padbottom: {setting: \"padbottom\", type: \"PopupList\", id: s.idPrefix+\"padbottom\",\n               initialdata: scc.SCFormatPadsizes},\n            padleft: {setting: \"padleft\", type: \"PopupList\", id: s.idPrefix+\"padleft\",\n               initialdata: scc.SCFormatPadsizes},\n            colwidth: {setting: \"colwidth\", type: \"PopupList\", id: s.idPrefix+\"colwidth\",\n               initialdata: scc.SCFormatColwidth},\n            recalc: {setting: \"recalc\", type: \"PopupList\", id: s.idPrefix+\"recalc\",\n               initialdata: scc.SCFormatRecalc}\n            };\n         viewobj.values.cellspanel = {\n            name: \"cell\",\n            colorchooser: {id: s.idPrefix+\"scolorchooser\"},\n            cformatnumber: {setting: \"numberformat\", type: \"PopupList\", id: s.idPrefix+\"cformatnumber\",\n               initialdata: scc.SCFormatNumberFormats},\n            cformattext: {setting: \"textformat\", type: \"PopupList\", id: s.idPrefix+\"cformattext\",\n               initialdata: scc.SCFormatTextFormats},\n            cfontfamily: {setting: \"fontfamily\", type: \"PopupList\", id: s.idPrefix+\"cfontfamily\",\n               initialdata: scc.SCFormatFontfamilies},\n            cfontlook: {setting: \"fontlook\", type: \"PopupList\", id: s.idPrefix+\"cfontlook\",\n               initialdata: scc.SCFormatFontlook},\n            cfontsize: {setting: \"fontsize\", type: \"PopupList\", id: s.idPrefix+\"cfontsize\",\n               initialdata: scc.SCFormatFontsizes},\n            calignhoriz: {setting: \"alignhoriz\", type: \"PopupList\", id: s.idPrefix+\"calignhoriz\",\n               initialdata: scc.SCFormatTextAlignhoriz},\n            calignvert: {setting: \"alignvert\", type: \"PopupList\", id: s.idPrefix+\"calignvert\",\n               initialdata: scc.SCFormatAlignVertical},\n            ctextcolor: {setting: \"textcolor\", type: \"ColorChooser\", id: s.idPrefix+\"ctextcolor\"},\n            cbgcolor: {setting: \"bgcolor\", type: \"ColorChooser\", id: s.idPrefix+\"cbgcolor\"},\n            cbt: {setting: \"bt\", type: \"BorderSide\", id: s.idPrefix+\"cbt\"},\n            cbr: {setting: \"br\", type: \"BorderSide\", id: s.idPrefix+\"cbr\"},\n            cbb: {setting: \"bb\", type: \"BorderSide\", id: s.idPrefix+\"cbb\"},\n            cbl: {setting: \"bl\", type: \"BorderSide\", id: s.idPrefix+\"cbl\"},\n            cpadtop: {setting: \"padtop\", type: \"PopupList\", id: s.idPrefix+\"cpadtop\",\n               initialdata: scc.SCFormatPadsizes},\n            cpadright: {setting: \"padright\", type: \"PopupList\", id: s.idPrefix+\"cpadright\",\n               initialdata: scc.SCFormatPadsizes},\n            cpadbottom: {setting: \"padbottom\", type: \"PopupList\", id: s.idPrefix+\"cpadbottom\",\n               initialdata: scc.SCFormatPadsizes},\n            cpadleft: {setting: \"padleft\", type: \"PopupList\", id: s.idPrefix+\"cpadleft\",\n               initialdata: scc.SCFormatPadsizes}\n            };\n\n         SocialCalc.SettingsControlInitializePanel(viewobj.values.sheetspanel);\n         SocialCalc.SettingsControlInitializePanel(viewobj.values.cellspanel);\n         },\n      replacements: {\n         itemtitle: {regex: /\\%itemtitle\\./g, replacement: 'style=\"padding:12px 10px 0px 10px;font-weight:bold;text-align:right;vertical-align:top;font-size:small;\"'},\n         sectiontitle: {regex: /\\%sectiontitle\\./g, replacement: 'style=\"padding:16px 10px 0px 0px;font-weight:bold;vertical-align:top;font-size:small;color:#C00;\"'},\n         parttitle: {regex: /\\%parttitle\\./g, replacement: 'style=\"font-weight:bold;font-size:x-small;padding:0px 0px 3px 0px;\"'},\n         itembody: {regex: /\\%itembody\\./g, replacement: 'style=\"padding:12px 0px 0px 0px;vertical-align:top;font-size:small;\"'},\n         bodypart: {regex: /\\%bodypart\\./g, replacement: 'style=\"padding:0px 10px 0px 0px;font-size:small;vertical-align:top;\"'}\n         },\n      divStyle: \"border:1px solid black;overflow:auto;\",\n      html:\n '<div id=\"%id.scolorchooser\" style=\"display:none;position:absolute;z-index:20;\"></div>'+\n'<table cellspacing=\"0\" cellpadding=\"0\">'+\n' <tr><td style=\"vertical-align:top;\">'+\n'<table id=\"%id.sheetsettingstable\" style=\"display:none;\" cellspacing=\"0\" cellpadding=\"0\">'+\n'<tr>'+\n' <td %itemtitle.><br>%loc!Default Format!:</td>'+\n' <td %itembody.>'+\n'   <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\n'    <td %bodypart.>'+\n'     <div %parttitle.>%loc!Number!</div>'+\n'     <span id=\"%id.formatnumber\"></span>'+\n'    </td>'+\n'    <td %bodypart.>'+\n'     <div %parttitle.>%loc!Text!</div>'+\n'     <span id=\"%id.formattext\"></span>'+\n'    </td>'+\n'   </tr></table>'+\n' </td>'+\n'</tr>'+\n'<tr>'+\n' <td %itemtitle.><br>%loc!Default Alignment!:</td>'+\n' <td %itembody.>'+\n'   <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\n'    <td %bodypart.>'+\n'     <div %parttitle.>%loc!Text Horizontal!</div>'+\n'     <span id=\"%id.textalignhoriz\"></span>'+\n'    </td>'+\n'    <td %bodypart.>'+\n'     <div %parttitle.>%loc!Number Horizontal!</div>'+\n'     <span id=\"%id.numberalignhoriz\"></span>'+\n'    </td>'+\n'    <td %bodypart.>'+\n'     <div %parttitle.>%loc!Vertical!</div>'+\n'     <span id=\"%id.alignvert\"></span>'+\n'    </td>'+\n'   </tr></table>'+\n' </td>'+\n'</tr>'+\n'<tr>'+\n' <td %itemtitle.><br>%loc!Default Font!:</td>'+\n' <td %itembody.>'+\n'   <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\n'    <td %bodypart.>'+\n'     <div %parttitle.>%loc!Family!</div>'+\n'     <span id=\"%id.fontfamily\"></span>'+\n'    </td>'+\n'    <td %bodypart.>'+\n'     <div %parttitle.>%loc!Bold &amp; Italics!</div>'+\n'     <span id=\"%id.fontlook\"></span>'+\n'    </td>'+\n'    <td %bodypart.>'+\n'     <div %parttitle.>%loc!Size!</div>'+\n'     <span id=\"%id.fontsize\"></span>'+\n'    </td>'+\n'    <td %bodypart.>'+\n'     <div %parttitle.>%loc!Color!</div>'+\n'     <div id=\"%id.textcolor\"></div>'+\n'    </td>'+\n'    <td %bodypart.>'+\n'     <div %parttitle.>%loc!Background!</div>'+\n'     <div id=\"%id.bgcolor\"></div>'+\n'    </td>'+\n'   </tr></table>'+\n' </td>'+\n'</tr>'+\n'<tr>'+\n' <td %itemtitle.><br>%loc!Default Padding!:</td>'+\n' <td %itembody.>'+\n'   <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\n'    <td %bodypart.>'+\n'     <div %parttitle.>%loc!Top!</div>'+\n'     <span id=\"%id.padtop\"></span>'+\n'    </td>'+\n'    <td %bodypart.>'+\n'     <div %parttitle.>%loc!Right!</div>'+\n'     <span id=\"%id.padright\"></span>'+\n'    </td>'+\n'    <td %bodypart.>'+\n'     <div %parttitle.>%loc!Bottom!</div>'+\n'     <span id=\"%id.padbottom\"></span>'+\n'    </td>'+\n'    <td %bodypart.>'+\n'     <div %parttitle.>%loc!Left!</div>'+\n'     <span id=\"%id.padleft\"></span>'+\n'    </td>'+\n'   </tr></table>'+\n' </td>'+\n'</tr>'+\n'<tr>'+\n' <td %itemtitle.><br>%loc!Default Column Width!:</td>'+\n' <td %itembody.>'+\n'   <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\n'    <td %bodypart.>'+\n'     <div %parttitle.>&nbsp;</div>'+\n'     <span id=\"%id.colwidth\"></span>'+\n'    </td>'+\n'   </tr></table>'+\n' </td>'+\n'</tr>'+\n'<tr>'+\n' <td %itemtitle.><br>%loc!Recalculation!:</td>'+\n' <td %itembody.>'+\n'   <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\n'    <td %bodypart.>'+\n'     <div %parttitle.>&nbsp;</div>'+\n'     <span id=\"%id.recalc\"></span>'+\n'    </td>'+\n'   </tr></table>'+\n' </td>'+\n'</tr>'+\n'</table>'+\n'<table id=\"%id.cellsettingstable\" cellspacing=\"0\" cellpadding=\"0\">'+\n'<tr>'+\n' <td %itemtitle.><br>%loc!Format!:</td>'+\n' <td %itembody.>'+\n'   <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\n'    <td %bodypart.>'+\n'     <div %parttitle.>%loc!Number!</div>'+\n'     <span id=\"%id.cformatnumber\"></span>'+\n'    </td>'+\n'    <td %bodypart.>'+\n'     <div %parttitle.>%loc!Text!</div>'+\n'     <span id=\"%id.cformattext\"></span>'+\n'    </td>'+\n'   </tr></table>'+\n' </td>'+\n'</tr>'+\n'<tr>'+\n' <td %itemtitle.><br>%loc!Alignment!:</td>'+\n' <td %itembody.>'+\n'   <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\n'    <td %bodypart.>'+\n'     <div %parttitle.>%loc!Horizontal!</div>'+\n'     <span id=\"%id.calignhoriz\"></span>'+\n'    </td>'+\n'    <td %bodypart.>'+\n'     <div %parttitle.>%loc!Vertical!</div>'+\n'     <span id=\"%id.calignvert\"></span>'+\n'    </td>'+\n'   </tr></table>'+\n' </td>'+\n'</tr>'+\n'<tr>'+\n' <td %itemtitle.><br>%loc!Font!:</td>'+\n' <td %itembody.>'+\n'   <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\n'    <td %bodypart.>'+\n'     <div %parttitle.>%loc!Family!</div>'+\n'     <span id=\"%id.cfontfamily\"></span>'+\n'    </td>'+\n'    <td %bodypart.>'+\n'     <div %parttitle.>%loc!Bold &amp; Italics!</div>'+\n'     <span id=\"%id.cfontlook\"></span>'+\n'    </td>'+\n'    <td %bodypart.>'+\n'     <div %parttitle.>%loc!Size!</div>'+\n'     <span id=\"%id.cfontsize\"></span>'+\n'    </td>'+\n'    <td %bodypart.>'+\n'     <div %parttitle.>%loc!Color!</div>'+\n'     <div id=\"%id.ctextcolor\"></div>'+\n'    </td>'+\n'    <td %bodypart.>'+\n'     <div %parttitle.>%loc!Background!</div>'+\n'     <div id=\"%id.cbgcolor\"></div>'+\n'    </td>'+\n'   </tr></table>'+\n' </td>'+\n'</tr>'+\n'<tr>'+\n' <td %itemtitle.><br>%loc!Borders!:</td>'+\n' <td %itembody.>'+\n'   <table cellspacing=\"0\" cellpadding=\"0\">'+\n'    <tr><td %bodypart. colspan=\"3\"><div %parttitle.>%loc!Top Border!</div></td>'+\n'     <td %bodypart. colspan=\"3\"><div %parttitle.>%loc!Right Border!</div></td>'+\n'     <td %bodypart. colspan=\"3\"><div %parttitle.>%loc!Bottom Border!</div></td>'+\n'     <td %bodypart. colspan=\"3\"><div %parttitle.>%loc!Left Border!</div></td>'+\n'    </tr><tr>'+\n'    <td %bodypart.>'+\n'     <input id=\"%id.cbt-onoff-bcb\" onclick=\"SocialCalc.SettingsControlOnchangeBorder(this);\" type=\"checkbox\">'+\n'    </td>'+\n'    <td %bodypart.>'+\n'     <div id=\"%id.cbt-color\"></div>'+\n'    </td>'+\n'    <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>'+\n'    <td %bodypart.>'+\n'     <input id=\"%id.cbr-onoff-bcb\" onclick=\"SocialCalc.SettingsControlOnchangeBorder(this);\" type=\"checkbox\">'+\n'    </td>'+\n'    <td %bodypart.>'+\n'     <div id=\"%id.cbr-color\"></div>'+\n'    </td>'+\n'    <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>'+\n'    <td %bodypart.>'+\n'     <input id=\"%id.cbb-onoff-bcb\" onclick=\"SocialCalc.SettingsControlOnchangeBorder(this);\" type=\"checkbox\">'+\n'    </td>'+\n'    <td %bodypart.>'+\n'     <div id=\"%id.cbb-color\"></div>'+\n'    </td>'+\n'    <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>'+\n'    <td %bodypart.>'+\n'     <input id=\"%id.cbl-onoff-bcb\" onclick=\"SocialCalc.SettingsControlOnchangeBorder(this);\" type=\"checkbox\">'+\n'    </td>'+\n'    <td %bodypart.>'+\n'     <div id=\"%id.cbl-color\"></div>'+\n'    </td>'+\n'    <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>'+\n'   </tr></table>'+\n' </td>'+\n'</tr>'+\n'<tr>'+\n' <td %itemtitle.><br>%loc!Padding!:</td>'+\n' <td %itembody.>'+\n'   <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\n'    <td %bodypart.>'+\n'     <div %parttitle.>%loc!Top!</div>'+\n'     <span id=\"%id.cpadtop\"></span>'+\n'    </td>'+\n'    <td %bodypart.>'+\n'     <div %parttitle.>%loc!Right!</div>'+\n'     <span id=\"%id.cpadright\"></span>'+\n'    </td>'+\n'    <td %bodypart.>'+\n'     <div %parttitle.>%loc!Bottom!</div>'+\n'     <span id=\"%id.cpadbottom\"></span>'+\n'    </td>'+\n'    <td %bodypart.>'+\n'     <div %parttitle.>%loc!Left!</div>'+\n'     <span id=\"%id.cpadleft\"></span>'+\n'    </td>'+\n'   </tr></table>'+\n' </td>'+\n'</tr>'+\n'</table>'+\n' </td><td style=\"vertical-align:top;padding:12px 0px 0px 12px;\">'+\n'  <div style=\"width:100px;height:100px;overflow:hidden;border:1px solid black;background-color:#EEE;padding:6px;\">'+\n'   <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\n'    <td id=\"sample-text\" style=\"height:100px;width:100px;\"><div>%loc!This is a<br>sample!</div><div>-1234.5</div></td>'+\n'   </tr></table>'+\n'  </div>'+\n' </td></tr></table>'+\n'<br>'\n      };\n\n   // Sort\n\n   this.tabnums.sort = this.tabs.length;\n   this.tabs.push({name: \"sort\", text: \"Sort\", html:\n      ' <div id=\"%id.sorttools\" style=\"display:none;\">'+\n      '  <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\n      '   <td style=\"vertical-align:top;padding-right:4px;width:160px;\">'+\n      '    <div style=\"%tbt.\">%loc!Set Cells To Sort!</div>'+\n      '    <select id=\"%id.sortlist\" size=\"1\" onfocus=\"%s.CmdGotFocus(this);\"><option selected>[select range]</option></select>'+\n      '    <input type=\"button\" value=\"%loc!OK!\" onclick=\"%s.DoCmd(this, \\'ok-setsort\\');\" style=\"font-size:x-small;\">'+\n      '   </td>'+\n      '   <td style=\"vertical-align:middle;padding-right:16px;width:100px;text-align:right;\">'+\n      '    <div style=\"%tbt.\">&nbsp;</div>'+\n      '    <input type=\"button\" id=\"%id.sortbutton\" value=\"%loc!Sort Cells! A1:A1\" onclick=\"%s.DoCmd(this, \\'dosort\\');\" style=\"visibility:hidden;\">'+\n      '   </td>'+\n      '   <td style=\"vertical-align:top;padding-right:16px;\">'+\n      '    <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\n      '     <td style=\"vertical-align:top;\">'+\n      '      <div style=\"%tbt.\">%loc!Major Sort!</div>'+\n      '      <select id=\"%id.majorsort\" size=\"1\" onfocus=\"%s.CmdGotFocus(this);\"></select>'+\n      '     </td><td>'+\n      '      <input type=\"radio\" name=\"majorsort\" id=\"%id.majorsortup\" value=\"up\" checked><span style=\"font-size:x-small;color:#FFF;\">%loc!Up!</span><br>'+\n      '      <input type=\"radio\" name=\"majorsort\" id=\"%id.majorsortdown\" value=\"down\"><span style=\"font-size:x-small;color:#FFF;\">%loc!Down!</span>'+\n      '     </td>'+\n      '    </tr></table>'+\n      '   </td>'+\n      '   <td style=\"vertical-align:top;padding-right:16px;\">'+\n      '    <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\n      '     <td style=\"vertical-align:top;\">'+\n      '      <div style=\"%tbt.\">%loc!Minor Sort!</div>'+\n      '      <select id=\"%id.minorsort\" size=\"1\" onfocus=\"%s.CmdGotFocus(this);\"></select>'+\n      '     </td><td>'+\n      '      <input type=\"radio\" name=\"minorsort\" id=\"%id.minorsortup\" value=\"up\" checked><span style=\"font-size:x-small;color:#FFF;\">%loc!Up!</span><br>'+\n      '      <input type=\"radio\" name=\"minorsort\" id=\"%id.minorsortdown\" value=\"down\"><span style=\"font-size:x-small;color:#FFF;\">%loc!Down!</span>'+\n      '     </td>'+\n      '    </tr></table>'+\n      '   </td>'+\n      '   <td style=\"vertical-align:top;padding-right:16px;\">'+\n      '    <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\n      '     <td style=\"vertical-align:top;\">'+\n      '      <div style=\"%tbt.\">%loc!Last Sort!</div>'+\n      '      <select id=\"%id.lastsort\" size=\"1\" onfocus=\"%s.CmdGotFocus(this);\"></select>'+\n      '     </td><td>'+\n      '      <input type=\"radio\" name=\"lastsort\" id=\"%id.lastsortup\" value=\"up\" checked><span style=\"font-size:x-small;color:#FFF;\">%loc!Up!</span><br>'+\n      '      <input type=\"radio\" name=\"lastsort\" id=\"%id.lastsortdown\" value=\"down\"><span style=\"font-size:x-small;color:#FFF;\">%loc!Down!</span>'+\n      '     </td>'+\n      '    </tr></table>'+\n      '   </td>'+\n      '  </tr></table>'+\n      ' </div>',\n      onclick: SocialCalc.SpreadsheetControlSortOnclick});\n   this.editor.SettingsCallbacks.sort = {save: SocialCalc.SpreadsheetControlSortSave, load: SocialCalc.SpreadsheetControlSortLoad};\n\n   // Audit\n\n   this.tabnums.audit = this.tabs.length;\n   this.tabs.push({name: \"audit\", text: \"Audit\", html:\n      '<div id=\"%id.audittools\" style=\"display:none;\">'+\n      ' <div style=\"%tbt.\">&nbsp;</div>'+\n      '</div>',\n      view: \"audit\",\n      onclick:\n         function(s, t) {\n            var SCLoc = SocialCalc.LocalizeString;\n            var i, j;\n            var str = '<table cellspacing=\"0\" cellpadding=\"0\" style=\"margin-bottom:10px;\"><tr><td style=\"font-size:small;padding:6px;\"><b>'+SCLoc(\"Audit Trail This Session\")+':</b><br><br>';\n            var stack = s.sheet.changes.stack;\n            var tos = s.sheet.changes.tos;\n            for (i=0; i<stack.length; i++) {\n               if (i==tos+1) str += '<br></td></tr><tr><td style=\"font-size:small;background-color:#EEE;padding:6px;\">'+SCLoc(\"UNDONE STEPS\")+':<br>';\n               for (j=0; j<stack[i].command.length; j++) {\n                  str += SocialCalc.special_chars(stack[i].command[j]) + \"<br>\";\n                  }\n               }\n            s.views.audit.element.innerHTML = str+\"</td></tr></table>\";\n            SocialCalc.CmdGotFocus(true);\n            },\n      onclickFocus: true\n         });\n\n   this.views[\"audit\"] = {name: \"audit\",\n      divStyle: \"border:1px solid black;overflow:auto;\",\n      html: 'Audit Trail'\n      };\n\n   // Comment\n\n   this.tabnums.comment = this.tabs.length;\n   this.tabs.push({name: \"comment\", text: \"Comment\", html:\n      '<div id=\"%id.commenttools\" style=\"display:none;\">'+\n      '<table cellspacing=\"0\" cellpadding=\"0\"><tr><td>'+\n      '<textarea id=\"%id.commenttext\" style=\"font-size:small;height:32px;width:600px;overflow:auto;\" onfocus=\"%s.CmdGotFocus(this);\"></textarea>'+\n      '</td><td style=\"vertical-align:top;\">'+\n      '&nbsp;<input type=\"button\" value=\"%loc!Save!\" onclick=\"%s.SpreadsheetControlCommentSet();\" style=\"font-size:x-small;\">'+\n      '</td></tr></table>'+\n      '</div>',\n      view: \"sheet\",\n      onclick: SocialCalc.SpreadsheetControlCommentOnclick,\n      onunclick: SocialCalc.SpreadsheetControlCommentOnunclick\n      });\n\n   // Names\n\n   this.tabnums.names = this.tabs.length;\n   this.tabs.push({name: \"names\", text: \"Names\", html:\n      '<div id=\"%id.namestools\" style=\"display:none;\">'+\n      '  <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\n      '   <td style=\"vertical-align:top;padding-right:24px;\">'+\n      '    <div style=\"%tbt.\">%loc!Existing Names!</div>'+\n      '    <select id=\"%id.nameslist\" size=\"1\" onchange=\"%s.SpreadsheetControlNamesChangedName();\" onfocus=\"%s.CmdGotFocus(this);\"><option selected>[New]</option></select>'+\n      '   </td>'+\n      '   <td style=\"vertical-align:top;padding-right:6px;\">'+\n      '    <div style=\"%tbt.\">%loc!Name!</div>'+\n      '    <input type=\"text\" id=\"%id.namesname\" style=\"font-size:x-small;width:75px;\" onfocus=\"%s.CmdGotFocus(this);\">'+\n      '   </td>'+\n      '   <td style=\"vertical-align:top;padding-right:6px;\">'+\n      '    <div style=\"%tbt.\">%loc!Description!</div>'+\n      '    <input type=\"text\" id=\"%id.namesdesc\" style=\"font-size:x-small;width:150px;\" onfocus=\"%s.CmdGotFocus(this);\">'+\n      '   </td>'+\n      '   <td style=\"vertical-align:top;padding-right:6px;\">'+\n      '    <div style=\"%tbt.\">%loc!Value!</div>'+\n      '    <input type=\"text\" id=\"%id.namesvalue\" width=\"16\" style=\"font-size:x-small;width:100px;\" onfocus=\"%s.CmdGotFocus(this);\">'+\n      '   </td>'+\n      '   <td style=\"vertical-align:top;padding-right:12px;width:100px;\">'+\n      '    <div style=\"%tbt.\">%loc!Set Value To!</div>'+\n      '    <input type=\"button\" id=\"%id.namesrangeproposal\" value=\"A1\" onclick=\"%s.SpreadsheetControlNamesSetValue();\" style=\"font-size:x-small;\">'+\n      '   </td>'+\n      '   <td style=\"vertical-align:top;padding-right:6px;\">'+\n      '    <div style=\"%tbt.\">&nbsp;</div>'+\n      '    <input type=\"button\" value=\"%loc!Save!\" onclick=\"%s.SpreadsheetControlNamesSave();\" style=\"font-size:x-small;\">'+\n      '    <input type=\"button\" value=\"%loc!Delete!\" onclick=\"%s.SpreadsheetControlNamesDelete()\" style=\"font-size:x-small;\">'+\n      '   </td>'+\n      '  </tr></table>'+\n      '</div>',\n      view: \"sheet\",\n      onclick: SocialCalc.SpreadsheetControlNamesOnclick,\n      onunclick: SocialCalc.SpreadsheetControlNamesOnunclick\n      });\n\n   // Clipboard\n\n   this.tabnums.clipboard = this.tabs.length;\n   this.tabs.push({name: \"clipboard\", text: \"Clipboard\", html:\n      '<div id=\"%id.clipboardtools\" style=\"display:none;\">'+\n      '  <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\n      '   <td style=\"vertical-align:top;padding-right:24px;\">'+\n      '    <div style=\"%tbt.\">'+\n      '     &nbsp;'+\n      '    </div>'+\n      '   </td>'+\n      '  </tr></table>'+\n      '</div>',\n      view: \"clipboard\",\n      onclick: SocialCalc.SpreadsheetControlClipboardOnclick,\n      onclickFocus: \"clipboardtext\"\n      });\n\n   this.views[\"clipboard\"] = {name: \"clipboard\", divStyle: \"overflow:auto;\", html:\n      ' <div style=\"font-size:x-small;padding:5px 0px 10px 0px;\">'+\n      '  <b>%loc!Display Clipboard in!:</b>'+\n      '  <input type=\"radio\" id=\"%id.clipboardformat-tab\" name=\"%id.clipboardformat\" checked onclick=\"%s.SpreadsheetControlClipboardFormat(\\'tab\\');\"> %loc!Tab-delimited format! &nbsp;'+\n      '  <input type=\"radio\" id=\"%id.clipboardformat-csv\" name=\"%id.clipboardformat\" onclick=\"%s.SpreadsheetControlClipboardFormat(\\'csv\\');\"> %loc!CSV format! &nbsp;'+\n      '  <input type=\"radio\" id=\"%id.clipboardformat-scsave\" name=\"%id.clipboardformat\" onclick=\"%s.SpreadsheetControlClipboardFormat(\\'scsave\\');\"> %loc!SocialCalc-save format!'+\n      ' </div>'+\n      ' <input type=\"button\" value=\"%loc!Load SocialCalc Clipboard With This!\" style=\"font-size:x-small;\" onclick=\"%s.SpreadsheetControlClipboardLoad();\">&nbsp; '+\n      ' <input type=\"button\" value=\"%loc!Clear SocialCalc Clipboard!\" style=\"font-size:x-small;\" onclick=\"%s.SpreadsheetControlClipboardClear();\">&nbsp; '+\n      ' <br>'+\n      ' <textarea id=\"%id.clipboardtext\" style=\"font-size:small;height:350px;width:800px;overflow:auto;\" onfocus=\"%s.CmdGotFocus(this);\"></textarea>'\n      };\n\n   return;\n\n   }\n\n// Methods:\n\nSocialCalc.SpreadsheetControl.prototype.InitializeSpreadsheetControl =\n   function(node, height, width, spacebelow) {return SocialCalc.InitializeSpreadsheetControl(this, node, height, width, spacebelow);};\nSocialCalc.SpreadsheetControl.prototype.DoOnResize = function() {return SocialCalc.DoOnResize(this);};\nSocialCalc.SpreadsheetControl.prototype.SizeSSDiv = function() {return SocialCalc.SizeSSDiv(this);};\nSocialCalc.SpreadsheetControl.prototype.ExecuteCommand = \n   function(combostr, sstr) {return SocialCalc.SpreadsheetControlExecuteCommand(this, combostr, sstr);};\nSocialCalc.SpreadsheetControl.prototype.CreateSheetHTML = \n   function() {return SocialCalc.SpreadsheetControlCreateSheetHTML(this);};\nSocialCalc.SpreadsheetControl.prototype.CreateSpreadsheetSave = \n   function(otherparts) {return SocialCalc.SpreadsheetControlCreateSpreadsheetSave(this, otherparts);};\nSocialCalc.SpreadsheetControl.prototype.DecodeSpreadsheetSave = \n   function(str) {return SocialCalc.SpreadsheetControlDecodeSpreadsheetSave(this, str);};\nSocialCalc.SpreadsheetControl.prototype.CreateCellHTML = \n   function(coord) {return SocialCalc.SpreadsheetControlCreateCellHTML(this, coord);};\nSocialCalc.SpreadsheetControl.prototype.CreateCellHTMLSave = \n   function(range) {return SocialCalc.SpreadsheetControlCreateCellHTMLSave(this, range);};\n\n\n// Sheet Methods to make things a little easier:\n\nSocialCalc.SpreadsheetControl.prototype.ParseSheetSave = function(str) {return this.sheet.ParseSheetSave(str);};\nSocialCalc.SpreadsheetControl.prototype.CreateSheetSave = function() {return this.sheet.CreateSheetSave();};\n\n\n// Functions:\n\n//\n// InitializeSpreadsheetControl(spreadsheet, node, height, width, spacebelow)\n//\n// Creates the control elements and makes them the child of node (string or element).\n// If present, height and width specify size.\n// If either is 0 or null (missing), the maximum that fits on the screen\n// (taking spacebelow into account) is used.\n//\n// Displays the tabs and creates the views (other than \"sheet\").\n// The first tab is set as selected, but onclick is not invoked.\n//\n// You should do a redisplay or recalc (which redisplays) after running this.\n//\n\nSocialCalc.InitializeSpreadsheetControl = function(spreadsheet, node, height, width, spacebelow) {\n\n   var scc = SocialCalc.Constants;\n   var SCLoc = SocialCalc.LocalizeString;\n   var SCLocSS = SocialCalc.LocalizeSubstrings;\n\n   var html, child, i, vname, v, style, button, bele;\n   var tabs = spreadsheet.tabs;\n   var views = spreadsheet.views;\n\n   spreadsheet.requestedHeight = height;\n   spreadsheet.requestedWidth = width;\n   spreadsheet.requestedSpaceBelow = spacebelow;\n\n   if (typeof node == \"string\") node = document.getElementById(node);\n\n   if (node == null) {\n      alert(\"SocialCalc.SpreadsheetControl not given parent node.\");\n      }\n\n   spreadsheet.parentNode = node;\n\n   // create node to hold spreadsheet control\n\n   spreadsheet.spreadsheetDiv = document.createElement(\"div\");\n\n   spreadsheet.SizeSSDiv(); // calculate and fill in the size values\n\n   for (child=node.firstChild; child!=null; child=node.firstChild) {\n      node.removeChild(child);\n      }\n\n   // create the tabbed UI at the top\n\n   html = '<div><div style=\"'+spreadsheet.toolbarbackground+'padding:12px 10px 10px 4px;height:0px;display:none;\">';\n\n   for (i=0; i<tabs.length; i++) {\n      html += tabs[i].html;\n      }\n\n   html += '</div>'+\n      '<div style=\"'+spreadsheet.tabbackground+'padding-bottom:4px;margin:0px 0px 8px 0px;display:none;\">'+\n      '<table cellpadding=\"0\" cellspacing=\"0\"><tr>';\n\n   for (i=0; i<tabs.length; i++) {\n      html += '  <td id=\"%id.' + tabs[i].name + 'tab\" style=\"' +\n         (i==0 ? spreadsheet.tabselectedCSS : spreadsheet.tabplainCSS) +\n         '\" onclick=\"%s.SetTab(this);\">' + SCLoc(tabs[i].text) + '</td>';\n      }\n\n   html += ' </tr></table></div></div>';\n\n   spreadsheet.currentTab = 0; // this is where we started\n\n   for (style in spreadsheet.tabreplacements) {\n      html = html.replace(spreadsheet.tabreplacements[style].regex, spreadsheet.tabreplacements[style].replacement);\n      }\n   html = html.replace(/\\%s\\./g, \"SocialCalc.\");\n   html = html.replace(/\\%id\\./g, spreadsheet.idPrefix);\n   html = html.replace(/\\%tbt\\./g, spreadsheet.toolbartext);\n   html = html.replace(/\\%img\\./g, spreadsheet.imagePrefix);\n\n   html = SCLocSS(html); // localize with %loc!string! and %scc!constant!\n\n   spreadsheet.spreadsheetDiv.innerHTML = html;\n\n   node.appendChild(spreadsheet.spreadsheetDiv);\n\n   // Initialize SocialCalc buttons\n\nspreadsheet.Buttons = {\n   button_undo: {tooltip: \"Undo\", command: \"undo\"},\n   button_redo: {tooltip: \"Redo\", command: \"redo\"},\n   button_copy: {tooltip: \"Copy\", command: \"copy\"},\n   button_cut: {tooltip: \"Cut\", command: \"cut\"},\n   button_paste: {tooltip: \"Paste\", command: \"paste\"},\n   button_pasteformats: {tooltip: \"Paste Formats\", command: \"pasteformats\"},\n   button_delete: {tooltip: \"Delete Contents\", command: \"delete\"},\n   button_filldown: {tooltip: \"Fill Down\", command: \"filldown\"},\n   button_fillright: {tooltip: \"Fill Right\", command: \"fillright\"},\n   button_movefrom: {tooltip: \"Set/Clear Move From\", command: \"movefrom\"},\n   button_movepaste: {tooltip: \"Move Paste\", command: \"movepaste\"},\n   button_moveinsert: {tooltip: \"Move Insert\", command: \"moveinsert\"},\n   button_alignleft: {tooltip: \"Align Left\", command: \"align-left\"},\n   button_aligncenter: {tooltip: \"Align Center\", command: \"align-center\"},\n   button_alignright: {tooltip: \"Align Right\", command: \"align-right\"},\n   button_borderon: {tooltip: \"Borders On\", command: \"borderon\"},\n   button_borderoff: {tooltip: \"Borders Off\", command: \"borderoff\"},\n   button_swapcolors: {tooltip: \"Swap Colors\", command: \"swapcolors\"},\n   button_merge: {tooltip: \"Merge Cells\", command: \"merge\"},\n   button_unmerge: {tooltip: \"Unmerge Cells\", command: \"unmerge\"},\n   button_insertrow: {tooltip: \"Insert Row\", command: \"insertrow\"},\n   button_insertcol: {tooltip: \"Insert Column\", command: \"insertcol\"},\n   button_deleterow: {tooltip: \"Delete Row\", command: \"deleterow\"},\n   button_deletecol: {tooltip: \"Delete Column\", command: \"deletecol\"},\n   button_recalc: {tooltip: \"Recalc\", command: \"recalc\"}\n   }\n\n   for (button in spreadsheet.Buttons) {\n      bele = document.getElementById(spreadsheet.idPrefix+button);\n      if (!bele) {/*alert(\"Button \"+(spreadsheet.idPrefix+button)+\" missing\");*/ continue;}\n      bele.style.border = \"1px solid \"+scc.ISCButtonBorderNormal;\n      SocialCalc.TooltipRegister(bele, SCLoc(spreadsheet.Buttons[button].tooltip), {});\n      SocialCalc.ButtonRegister(bele,\n         {normalstyle: \"border:1px solid \"+scc.ISCButtonBorderNormal+\";backgroundColor:\"+scc.ISCButtonBorderNormal+\";\",\n          hoverstyle: \"border:1px solid \"+scc.ISCButtonBorderHover+\";backgroundColor:\"+scc.ISCButtonBorderNormal+\";\",\n          downstyle: \"border:1px solid \"+scc.ISCButtonBorderDown+\";backgroundColor:\"+scc.ISCButtonDownBackground+\";\"}, \n         {MouseDown: SocialCalc.DoButtonCmd, command: spreadsheet.Buttons[button].command});\n      }\n\n   // create formula bar\n\n   spreadsheet.dummyFormulaDiv = document.createElement(\"div\");\n   spreadsheet.dummyFormulaDiv.style.height = spreadsheet.formulabarheight + \"px\";\n   spreadsheet.spreadsheetDiv.appendChild(spreadsheet.dummyFormulaDiv);\n\n    spreadsheet.formulabarDiv = document.createElement(\"div\");\n    spreadsheet.formulabarDiv.id = \"formulabardiv\";\n   spreadsheet.formulabarDiv.style.height = spreadsheet.formulabarheight + \"px\";\n   spreadsheet.formulabarDiv.innerHTML = '<input type=\"text\" size=\"20\" value=\"\" disabled=\"true\">'; //'<textarea rows=\"4\" cols=\"60\" style=\"z-index:5;background-color:white;position:relative;\"></textarea>&nbsp;';\n   //spreadsheet.spreadsheetDiv.appendChild(spreadsheet.formulabarDiv);\n   var inputbox = new SocialCalc.InputBox(spreadsheet.formulabarDiv.firstChild, spreadsheet.editor);\n  \n    bele = document.createElement(\"img\");\n    bele.id = \"testtest\";\n    bele.src = \"lib/aspiring/www/assets/images/delete24.png\";\n    bele.style.verticalAlign = \"middle\";\n    //bele.style.border = \"1px solid #FFF\";\n    //bele.style.marginLeft = \"4px\";   \n    bele.style.display = \"none\";\n      SocialCalc.ButtonRegister(bele,\n         {normalstyle: \"\",\n          hoverstyle: \"\",\n          downstyle: \"\"}, \n         {MouseDown: SocialCalc.InputLineClearText});\n\n\n    // spreadsheet.formulabarDiv.appendChild(bele);\n\n    /*\n   for (button in spreadsheet.formulabuttons) {\n      bele = document.createElement(\"img\");\n      bele.id = spreadsheet.idPrefix+button;\n      bele.src = spreadsheet.imagePrefix+spreadsheet.formulabuttons[button].image;\n      bele.style.verticalAlign = \"middle\";\n      bele.style.border = \"1px solid #FFF\";\n      bele.style.marginLeft = \"4px\";\n      SocialCalc.TooltipRegister(bele, SCLoc(spreadsheet.formulabuttons[button].tooltip), {});\n      SocialCalc.ButtonRegister(bele,\n         {normalstyle: \"border:1px solid #FFF;backgroundColor:#FFF;\",\n          hoverstyle: \"border:1px solid #CCC;backgroundColor:#FFF;\",\n          downstyle: \"border:1px solid #000;backgroundColor:#FFF;\"}, \n         {MouseDown: spreadsheet.formulabuttons[button].command});\n      spreadsheet.formulabarDiv.appendChild(bele);\n      }\n   */\n   // initialize tabs that need it\n\n   for (i=0; i<tabs.length; i++) { // execute any tab-specific initialization code\n      if (tabs[i].oncreate) {\n         tabs[i].oncreate(spreadsheet, tabs[i].name);\n         }\n      }\n\n   // create sheet view and others\n    if (!scc.doWorkBook) {\n   spreadsheet.nonviewheight = spreadsheet.statuslineheight +\n   spreadsheet.spreadsheetDiv.firstChild.offsetHeight +\n   spreadsheet.spreadsheetDiv.lastChild.offsetHeight;\n    } else {\n   spreadsheet.nonviewheight = 28 + spreadsheet.sheetbarheight  +\n     spreadsheet.spreadsheetDiv.firstChild.offsetHeight +\n     spreadsheet.spreadsheetDiv.lastChild.offsetHeight;\n    }\n   spreadsheet.viewheight = spreadsheet.height-spreadsheet.nonviewheight;\n   spreadsheet.editorDiv=spreadsheet.editor.CreateTableEditor(spreadsheet.width, spreadsheet.viewheight);\n\n   spreadsheet.spreadsheetDiv.appendChild(spreadsheet.editorDiv);\n\n   for (vname in views) {\n      html = views[vname].html;\n      for (style in views[vname].replacements) {\n         html = html.replace(views[vname].replacements[style].regex, views[vname].replacements[style].replacement);\n         }\n      html = html.replace(/\\%s\\./g, \"SocialCalc.\");\n      html = html.replace(/\\%id\\./g, spreadsheet.idPrefix);\n      html = html.replace(/\\%tbt\\./g, spreadsheet.toolbartext);\n      html = html.replace(/\\%img\\./g, spreadsheet.imagePrefix);\n      v = document.createElement(\"div\");\n      SocialCalc.setStyles(v, views[vname].divStyle);\n      v.style.display = \"none\";\n      v.style.width = spreadsheet.width + \"px\";\n      v.style.height = spreadsheet.viewheight + \"px\";\n\n      html = SCLocSS(html); // localize with %loc!string!, etc.\n\n      v.innerHTML = html;\n      spreadsheet.spreadsheetDiv.appendChild(v);\n      views[vname].element = v;\n      if (views[vname].oncreate) {\n         views[vname].oncreate(spreadsheet, views[vname]);\n         }\n      }\n\n   views.sheet = {name: \"sheet\", element: spreadsheet.editorDiv};\n\n   // create statusline\n\n \n   if (!scc.doWorkBook) {\n       spreadsheet.statuslineDiv = document.createElement(\"div\");\n       spreadsheet.statuslineDiv.style.cssText = spreadsheet.statuslineCSS;\n       //   spreadsheet.statuslineDiv.style.height = spreadsheet.statuslineheight + \"px\"; // didn't take padding into account!\n       spreadsheet.statuslineDiv.style.height = spreadsheet.statuslineheight -\n      (spreadsheet.statuslineDiv.style.paddingTop.slice(0,-2)-0) -\n      (spreadsheet.statuslineDiv.style.paddingBottom.slice(0,-2)-0) + \"px\";\n       spreadsheet.statuslineDiv.id = spreadsheet.idPrefix+\"statusline\";\n       spreadsheet.spreadsheetDiv.appendChild(spreadsheet.statuslineDiv);\n   } else {\n       SocialCalc.CreateSheetStatusBar(spreadsheet, scc);       \n   }\n\n   // done - refresh screen needed\n\n   return;\n\n}\n\nSocialCalc.CreateSheetStatusBar = function(spreadsheet, scc) {\n    // create sheetbar\n    if (!scc.doWorkBook) {\n   return;\n    }\n   \n    // create a table with 1 row, containing 3 columns, 1 for sheetbar, 1 for separator, 1 for statusline\n\n    \n    spreadsheet.sheetstatusbarDiv = document.createElement(\"div\");\n    spreadsheet.sheetstatusbarDiv.style.height = spreadsheet.sheetbarheight + 3 + \"px\";\n    spreadsheet.sheetstatusbarDiv.style.backgroundColor = \"#CCC\";\n    spreadsheet.sheetstatusbarDiv.id = spreadsheet.idPrefix+\"sheetstatusbar\";\n\n\n    spreadsheet.sheetbarDiv = document.createElement(\"div\");\n    //spreadsheet.sheetbarDiv.style.cssText = spreadsheet.sheetbarCSS;\n    spreadsheet.sheetbarDiv.id = spreadsheet.idPrefix+\"sheetbar\";\n\n\n    spreadsheet.statuslineDiv = document.createElement(\"div\");\n    spreadsheet.statuslineDiv.style.cssText = spreadsheet.statuslineCSS;\n    spreadsheet.statuslineDiv.id = spreadsheet.idPrefix+\"statusline\";\n\n    var table = document.createElement(\"table\");\n    spreadsheet.sheetstatusbartable = table;\n    table.cellSpacing = 0;\n    table.cellPadding = 0;\n    table.width=\"100%\";\n    \n    var tbody = document.createElement(\"tbody\");\n    table.appendChild(tbody);\n\n    var tr = document.createElement(\"tr\");\n    tbody.appendChild(tr);\n    var td = document.createElement(\"td\");\n    td.appendChild(spreadsheet.sheetbarDiv);\n    td.width = scc.SCSheetBarWidth;\n    tr.appendChild(td);\n\n\n    td = document.createElement(\"td\");\n    td.innerHTML = \"<span>&nbsp|&nbsp</span>\";\n    td.width=\"1%\";\n    tr.appendChild(td);\n\n\n    td = document.createElement(\"td\");\n    td.appendChild(spreadsheet.statuslineDiv);\n    tr.appendChild(td);\n\n    spreadsheet.sheetstatusbarDiv.appendChild(table);\n\n    spreadsheet.spreadsheetDiv.appendChild(spreadsheet.sheetstatusbarDiv);\n\n    spreadsheet.sheetstatusbarDiv.style.display = \"none\";    \n\n}\n\n//\n// outstr = SocialCalc.LocalizeString(str)\n//\n// SocialCalc function to make localization easier.\n// If str is \"Text to localize\", it returns\n// SocialCalc.Constants.s_loc_text_to_localize if\n// it exists, or else with just \"Text to localize\".\n// Note that spaces are replaced with \"_\" and other special\n// chars with \"X\" in the name of the constant (e.g., \"A & B\"\n// would look for SocialCalc.Constants.s_loc_a_X_b.\n//\n\nSocialCalc.LocalizeString = function(str) {\n   var cstr = SocialCalc.LocalizeStringList[str]; // found already this session?\n   if (!cstr) { // no - look up\n      cstr = SocialCalc.Constants[\"s_loc_\"+str.toLowerCase().replace(/\\s/g, \"_\").replace(/\\W/g, \"X\")] || str;\n      SocialCalc.LocalizeStringList[str] = cstr;\n      }\n   return cstr;\n   }\n\nSocialCalc.LocalizeStringList = {}; // a list of strings to localize accumulated by the routine\n\n//\n// outstr = SocialCalc.LocalizeSubstrings(str)\n//\n// SocialCalc function to make localization easier using %loc and %scc.\n//\n// Replaces sections of str with:\n//    %loc!Text to localize!\n// with SocialCalc.Constants.s_loc_text_to_localize if\n// it exists, or else with just \"Text to localize\".\n// Note that spaces are replaced with \"_\" and other special\n// chars with \"X\" in the name of the constant (e.g., %loc!A & B!\n// would look for SocialCalc.Constants.s_loc_a_X_b.\n// Uses SocialCalc.LocalizeString for this.\n//\n// Replaces sections of str with:\n//    %ssc!constant-name!\n// with SocialCalc.Constants.constant-name.\n// If the constant doesn't exist, throws and alert.\n//\n\nSocialCalc.LocalizeSubstrings = function(str) {\n\n   var SCLoc = SocialCalc.LocalizeString;\n\n   return str.replace(/%(loc|ssc)!(.*?)!/g, function(a, t, c) {\n      if (t==\"ssc\") {\n         return SocialCalc.Constants[c] || alert(\"Missing constant: \"+c);\n         }\n      else {\n         return SCLoc(c);\n         }\n      });\n\n   }\n\n//\n// obj = GetSpreadsheetControlObject()\n//\n// Returns the current spreadsheet control object\n//\n\nSocialCalc.GetSpreadsheetControlObject = function() {\n\n   var csco = SocialCalc.CurrentSpreadsheetControlObject;\n   if (csco) return csco;\n\n//   throw (\"No current SpreadsheetControl object.\");\n\n   }\n\n\n//\n// SocialCalc.DoOnResize(spreadsheet)\n//\n// Processes an onResize event, setting the different views.\n//\n\nSocialCalc.DoOnResize = function(spreadsheet) {\n\n   var v;\n   var views = spreadsheet.views;\n\n   var needresize = spreadsheet.SizeSSDiv();\n   if (!needresize) return;\n\n   for (vname in views) {\n      v = views[vname].element;\n      v.style.width = spreadsheet.width + \"px\";\n      v.style.height = (spreadsheet.height-spreadsheet.nonviewheight) + \"px\";\n      }\n\n   spreadsheet.editor.ResizeTableEditor(spreadsheet.width, spreadsheet.height-spreadsheet.nonviewheight);\n\n   }\n\n\n//\n// resized = SocialCalc.SizeSSDiv(spreadsheet)\n//\n// Figures out a reasonable size for the spreadsheet, given any requested values and viewport.\n// Sets ssdiv to that.\n// Return true if different than existing values.\n//\n\nSocialCalc.SizeSSDiv = function(spreadsheet) {\n\n   var sizes, pos, resized, nodestyle, newval;\n   var fudgefactorX = 10; // for IE\n   var fudgefactorY = 10;\n\n   resized = false;\n\n   sizes = SocialCalc.GetViewportInfo();\n   pos = SocialCalc.GetElementPosition(spreadsheet.parentNode);\n   pos.bottom = 0;\n   pos.right = 0;\n\n   nodestyle = spreadsheet.parentNode.style;\n\n   if (nodestyle.marginTop) {\n      pos.top += nodestyle.marginTop.slice(0,-2)-0;\n      }\n   if (nodestyle.marginBottom) {\n      pos.bottom += nodestyle.marginBottom.slice(0,-2)-0;\n      }\n   if (nodestyle.marginLeft) {\n      pos.left += nodestyle.marginLeft.slice(0,-2)-0;\n      }\n   if (nodestyle.marginRight) {\n      pos.right += nodestyle.marginRight.slice(0,-2)-0;\n      }\n\n   newval = spreadsheet.requestedHeight ||\n            sizes.height - (pos.top + pos.bottom + fudgefactorY) -\n               (spreadsheet.requestedSpaceBelow || 0);\n   if (spreadsheet.height != newval) {\n      spreadsheet.height = newval;\n      spreadsheet.spreadsheetDiv.style.height = newval + \"px\";\n      resized = true;\n      }\n   newval = spreadsheet.requestedWidth ||\n            sizes.width - (pos.left + pos.right + fudgefactorX) || 700;\n   if (spreadsheet.width != newval) {\n      spreadsheet.width = newval;\n      spreadsheet.spreadsheetDiv.style.width = newval + \"px\";\n      resized = true;\n      }\n\n   return resized;\n\n   }\n\n\n//\n// SocialCalc.SetTab(obj)\n//\n// The obj argument is either a string with the tab name or a DOM element with an ID\n//\n\nSocialCalc.SetTab = function(obj) {\n\n   var newtab, tname, newtabnum, newview, i, vname, ele;\n   var menutabs = {};\n   var tools = {};\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\n   var tabs = spreadsheet.tabs;\n   var views = spreadsheet.views;\n\n   if (typeof obj == \"string\") {\n      newtab = obj;\n      }\n   else {\n      newtab = obj.id.slice(spreadsheet.idPrefix.length,-3);\n      }\n\n   if (spreadsheet.editor.busy && // if busy and switching from \"sheet\", ignore\n         (!tabs[spreadsheet.currentTab].view || tabs[spreadsheet.currentTab].view==\"sheet\")) {\n      for (i=0; i<tabs.length; i++) {\n         if(tabs[i].name==newtab && (tabs[i].view && tabs[i].view!=\"sheet\")) {\n            return;\n            }\n         }\n      }\n\n   if (spreadsheet.tabs[spreadsheet.currentTab].onunclick) {\n      spreadsheet.tabs[spreadsheet.currentTab].onunclick(spreadsheet, spreadsheet.tabs[spreadsheet.currentTab].name);\n      }\n\n   for (i=0; i<tabs.length; i++) {\n      tname = tabs[i].name;\n      menutabs[tname] = document.getElementById(spreadsheet.idPrefix+tname+\"tab\");\n      tools[tname] = document.getElementById(spreadsheet.idPrefix+tname+\"tools\");\n      if (tname==newtab) {\n         newtabnum = i;\n         tools[tname].style.display = \"block\";\n         menutabs[tname].style.cssText = spreadsheet.tabselectedCSS;\n         }\n      else {\n         tools[tname].style.display = \"none\";\n         menutabs[tname].style.cssText = spreadsheet.tabplainCSS;\n         }\n      }\n\n   spreadsheet.currentTab = newtabnum;\n\n   if (tabs[newtabnum].onclick) {\n      tabs[newtabnum].onclick(spreadsheet, newtab);\n      }\n\n   for (vname in views) {\n      if ((!tabs[newtabnum].view && vname == \"sheet\") || tabs[newtabnum].view == vname) {\n         views[vname].element.style.display = \"block\";\n         newview = vname;\n         }\n      else {\n         views[vname].element.style.display = \"none\";\n         }\n      }\n\n   if (tabs[newtabnum].onclickFocus) {\n      ele = tabs[newtabnum].onclickFocus;\n      if (typeof ele == \"string\") {\n         ele = document.getElementById(spreadsheet.idPrefix+ele);\n         ele.focus();\n         }\n      SocialCalc.CmdGotFocus(ele);\n      }\n   else {\n      SocialCalc.KeyboardFocus();\n      }\n\n   if (views[newview].needsresize && views[newview].onresize) {\n      views[newview].needsresize = false;\n      views[newview].onresize(spreadsheet, views[newview]);\n      }\n\n   if (newview == \"sheet\") {\n      spreadsheet.statuslineDiv.style.display = \"block\";\n      spreadsheet.editor.ScheduleRender();\n      }\n   else {\n      spreadsheet.statuslineDiv.style.display = \"none\";\n      }\n\n   return;\n\n   }\n\n//\n// SocialCalc.SpreadsheetControlStatuslineCallback\n//\n\nSocialCalc.SpreadsheetControlStatuslineCallback = function(editor, status, arg, params) {\n\n   var rele1, rele2;\n\n   var ele = document.getElementById(params.statuslineid);\n\n   if (ele) {\n      ele.innerHTML = editor.GetStatuslineString(status, arg, params);\n      }\n\n   switch (status) {\n      case \"cmdendnorender\":\n      case \"calcfinished\":\n      case \"doneposcalc\":\n         rele1 = document.getElementById(params.recalcid1);\n         rele2 = document.getElementById(params.recalcid2);\n         if (!rele1 || !rele2) break;\n         if (editor.context.sheetobj.attribs.needsrecalc==\"yes\") {\n            rele1.style.display = \"inline\";\n            rele2.style.display = \"inline\";\n            }\n         else {\n            rele1.style.display = \"none\";\n            rele2.style.display = \"none\";\n            }\n         break;\n\n      default:\n         break;\n      }\n\n   }\n\n\n//\n// SocialCalc.UpdateSortRangeProposal(editor)\n//\n// Updates sort range proposed in the UI in element idPrefix+sortlist\n//\n\nSocialCalc.UpdateSortRangeProposal = function(editor) {\n\n   var ele = document.getElementById(SocialCalc.GetSpreadsheetControlObject().idPrefix+\"sortlist\");\n   if (editor.range.hasrange) {\n      ele.options[0].text = SocialCalc.crToCoord(editor.range.left, editor.range.top) + \":\" +\n                            SocialCalc.crToCoord(editor.range.right, editor.range.bottom);\n      }\n   else {\n      ele.options[0].text = SocialCalc.LocalizeString(\"[select range]\");\n      }\n\n   }\n\n//\n// SocialCalc.LoadColumnChoosers(spreadsheet)\n//\n// Updates list of columns for choosing which to sort for Major, Minor, and Last sort\n//\n\nSocialCalc.LoadColumnChoosers = function(spreadsheet) {\n\n   var SCLoc = SocialCalc.LocalizeString;\n\n   var sortrange, nrange, rparts, col, colname, sele, oldindex;\n\n   if (spreadsheet.sortrange && spreadsheet.sortrange.indexOf(\":\")==-1) { // sortrange is a named range\n      nrange = SocialCalc.Formula.LookupName(spreadsheet.sheet, spreadsheet.sortrange || \"\");\n      if (nrange.type == \"range\") {\n         rparts = nrange.value.match(/^(.*)\\|(.*)\\|$/);\n         sortrange = rparts[1] + \":\" + rparts[2];\n         }\n      else {\n         sortrange = \"A1:A1\";\n         }\n      }\n   else {\n      sortrange = spreadsheet.sortrange;\n      }\n   var range = SocialCalc.ParseRange(sortrange);\n   sele = document.getElementById(spreadsheet.idPrefix+\"majorsort\");\n   oldindex = sele.selectedIndex;\n   sele.options.length = 0;\n   sele.options[sele.options.length] = new Option(SCLoc(\"[None]\"), \"\");\n   for (var col=range.cr1.col; col<=range.cr2.col; col++) {\n      colname = SocialCalc.rcColname(col);\n      sele.options[sele.options.length] = new Option(SCLoc(\"Column \")+colname, colname);\n      }\n   sele.selectedIndex = oldindex > 1 && oldindex <= (range.cr2.col-range.cr1.col+1) ? oldindex : 1; // restore what was there if reasonable\n   sele = document.getElementById(spreadsheet.idPrefix+\"minorsort\");\n   oldindex = sele.selectedIndex;\n   sele.options.length = 0;\n   sele.options[sele.options.length] = new Option(SCLoc(\"[None]\"), \"\");\n   for (var col=range.cr1.col; col<=range.cr2.col; col++) {\n      colname = SocialCalc.rcColname(col);\n      sele.options[sele.options.length] = new Option(colname, colname);\n      }\n   sele.selectedIndex = oldindex > 0 && oldindex <= (range.cr2.col-range.cr1.col+1) ? oldindex : 0; // default to [none]\n   sele = document.getElementById(spreadsheet.idPrefix+\"lastsort\");\n   oldindex = sele.selectedIndex;\n   sele.options.length = 0;\n   sele.options[sele.options.length] = new Option(SCLoc(\"[None]\"), \"\");\n   for (var col=range.cr1.col; col<=range.cr2.col; col++) {\n      colname = SocialCalc.rcColname(col);\n      sele.options[sele.options.length] = new Option(colname, colname);\n      }\n   sele.selectedIndex = oldindex > 0 && oldindex <= (range.cr2.col-range.cr1.col+1) ? oldindex : 0; // default to [none]\n\n   }\n\n//\n// SocialCalc.CmdGotFocus(obj)\n//\n// Sets SocialCalc.Keyboard.passThru: obj should be element with focus or \"true\"\n//\n\nSocialCalc.CmdGotFocus = function(obj) {\n\n   SocialCalc.Keyboard.passThru = obj;\n\n   }\n\n\n//\n// SocialCalc.DoButtonCmd(e, buttoninfo, bobj)\n//\n\nSocialCalc.DoButtonCmd = function(e, buttoninfo, bobj) {\n\n   SocialCalc.DoCmd(bobj.element, bobj.functionobj.command);\n\n   }\n\n//\n// SocialCalc.DoCmd(obj, which)\n//\n// xxx\n//\n\nSocialCalc.DoCmd = function(obj, which) {\n\n   var combostr, sstr, cl, i, clele, slist, slistele, str, sele, rele, lele, ele, sortrange, nrange, rparts;\n   var sheet, cell, color, bgcolor, defaultcolor, defaultbgcolor;\n\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\n   var editor = spreadsheet.editor;\n\n   switch (which) {\n      case \"undo\":\n         spreadsheet.ExecuteCommand(\"undo\", \"\");\n         break;\n\n      case \"redo\":\n         spreadsheet.ExecuteCommand(\"redo\", \"\");\n         break;\n\n      case \"fill-rowcolstuff\":\n      case \"fill-text\":\n         cl = which.substring(5);\n         clele = document.getElementById(spreadsheet.idPrefix+cl+\"list\");\n         clele.length = 0;\n         for (i=0; i<SocialCalc.SpreadsheetCmdTable[cl].length; i++) {\n            clele.options[i] = new Option(SocialCalc.SpreadsheetCmdTable[cl][i].t);\n            }\n         which = \"changed-\"+cl; // fall through to changed code\n\n      case \"changed-rowcolstuff\":\n      case \"changed-text\":\n         cl = which.substring(8);\n         clele = document.getElementById(spreadsheet.idPrefix+cl+\"list\");\n         slist = SocialCalc.SpreadsheetCmdTable.slists[SocialCalc.SpreadsheetCmdTable[cl][clele.selectedIndex].s]; // get sList for this command\n         slistele = document.getElementById(spreadsheet.idPrefix+cl+\"slist\");\n         slistele.length = 0; // reset\n         for (i=0; i<(slist.length||0); i++) {\n            slistele.options[i] = new Option(slist[i].t, slist[i].s);\n            }\n         return; // nothing else to do\n\n      case \"ok-rowcolstuff\":\n      case \"ok-text\":\n         cl = which.substring(3);\n         clele = document.getElementById(spreadsheet.idPrefix+cl+\"list\");\n         slistele = document.getElementById(spreadsheet.idPrefix+cl+\"slist\");\n         combostr = SocialCalc.SpreadsheetCmdTable[cl][clele.selectedIndex].c;\n         sstr = slistele[slistele.selectedIndex].value;\n         SocialCalc.SpreadsheetControlExecuteCommand(obj, combostr, sstr);\n         break;\n\n      case \"ok-setsort\":\n         lele = document.getElementById(spreadsheet.idPrefix+\"sortlist\");\n         if (lele.selectedIndex==0) {\n            if (editor.range.hasrange) {\n               spreadsheet.sortrange = SocialCalc.crToCoord(editor.range.left, editor.range.top) + \":\" +\n                          SocialCalc.crToCoord(editor.range.right, editor.range.bottom);\n               }\n            else {\n               spreadsheet.sortrange = editor.ecell.coord+\":\"+editor.ecell.coord;\n               }\n            }\n         else {\n            spreadsheet.sortrange = lele.options[lele.selectedIndex].value;\n            }\n         ele = document.getElementById(spreadsheet.idPrefix+\"sortbutton\");\n         ele.value = SocialCalc.LocalizeString(\"Sort \")+spreadsheet.sortrange;\n         ele.style.visibility = \"visible\";\n         SocialCalc.LoadColumnChoosers(spreadsheet);\n         if (obj && obj.blur) obj.blur();\n         SocialCalc.KeyboardFocus();   \n         return;\n\n      case \"dosort\":\n         if (spreadsheet.sortrange && spreadsheet.sortrange.indexOf(\":\")==-1) { // sortrange is a named range\n            nrange = SocialCalc.Formula.LookupName(spreadsheet.sheet, spreadsheet.sortrange || \"\");\n            if (nrange.type != \"range\") return;\n            rparts = nrange.value.match(/^(.*)\\|(.*)\\|$/);\n            sortrange = rparts[1] + \":\" + rparts[2];\n            }\n         else {\n            sortrange = spreadsheet.sortrange;\n            }\n         if (sortrange == \"A1:A1\") return;\n         str = \"sort \"+sortrange+\" \";\n         sele = document.getElementById(spreadsheet.idPrefix+\"majorsort\");\n         rele = document.getElementById(spreadsheet.idPrefix+\"majorsortup\");\n         str += sele.options[sele.selectedIndex].value + (rele.checked ? \" up\" : \" down\");\n         sele = document.getElementById(spreadsheet.idPrefix+\"minorsort\");\n         if (sele.selectedIndex>0) {\n           rele = document.getElementById(spreadsheet.idPrefix+\"minorsortup\");\n           str += \" \"+sele.options[sele.selectedIndex].value + (rele.checked ? \" up\" : \" down\");\n           }\n         sele = document.getElementById(spreadsheet.idPrefix+\"lastsort\");\n         if (sele.selectedIndex>0) {\n           rele = document.getElementById(spreadsheet.idPrefix+\"lastsortup\");\n           str += \" \"+sele.options[sele.selectedIndex].value + (rele.checked ? \" up\" : \" down\");\n           }\n         spreadsheet.ExecuteCommand(str, \"\");\n         break;\n\n      case \"merge\":\n         combostr = SocialCalc.SpreadsheetCmdLookup[which] || \"\";\n         sstr = SocialCalc.SpreadsheetCmdSLookup[which] || \"\";\n         spreadsheet.ExecuteCommand(combostr, sstr);\n         if (editor.range.hasrange) { // set ecell to upper left\n            editor.MoveECell(SocialCalc.crToCoord(editor.range.left, editor.range.top));\n            editor.RangeRemove();\n            }\n         break;\n\n      case \"movefrom\":\n         if (editor.range2.hasrange) { // toggle if already there\n            spreadsheet.context.cursorsuffix = \"\";\n            editor.Range2Remove();\n            spreadsheet.ExecuteCommand(\"redisplay\", \"\");\n            }\n         else if (editor.range.hasrange) { // set range2 to range or one cell\n            editor.range2.top = editor.range.top;\n            editor.range2.right = editor.range.right;\n            editor.range2.bottom = editor.range.bottom;\n            editor.range2.left = editor.range.left;\n            editor.range2.hasrange = true;\n            editor.MoveECell(SocialCalc.crToCoord(editor.range.left, editor.range.top));\n            }\n         else {\n            editor.range2.top = editor.ecell.row;\n            editor.range2.right = editor.ecell.col;\n            editor.range2.bottom = editor.ecell.row;\n            editor.range2.left = editor.ecell.col;\n            editor.range2.hasrange = true;\n            }\n         str = editor.range2.hasrange ? \"\" : \"off\";\n         ele = document.getElementById(spreadsheet.idPrefix+\"button_movefrom\");\n         ele.src=spreadsheet.imagePrefix+\"movefrom\"+str+\".gif\";\n         ele = document.getElementById(spreadsheet.idPrefix+\"button_movepaste\");\n         ele.src=spreadsheet.imagePrefix+\"movepaste\"+str+\".gif\";\n         ele = document.getElementById(spreadsheet.idPrefix+\"button_moveinsert\");\n         ele.src=spreadsheet.imagePrefix+\"moveinsert\"+str+\".gif\";\n         if (editor.range2.hasrange) editor.RangeRemove();\n         break;\n\n      case \"movepaste\":\n      case \"moveinsert\":\n         if (editor.range2.hasrange) {\n            spreadsheet.context.cursorsuffix = \"\";\n            combostr = which+\" \"+\n               SocialCalc.crToCoord(editor.range2.left, editor.range2.top) + \":\" +\n               SocialCalc.crToCoord(editor.range2.right, editor.range2.bottom)\n               +\" \"+editor.ecell.coord;\n            spreadsheet.ExecuteCommand(combostr, \"\");\n            editor.Range2Remove();\n            ele = document.getElementById(spreadsheet.idPrefix+\"button_movefrom\");\n            ele.src=spreadsheet.imagePrefix+\"movefromoff.gif\";\n            ele = document.getElementById(spreadsheet.idPrefix+\"button_movepaste\");\n            ele.src=spreadsheet.imagePrefix+\"movepasteoff.gif\";\n            ele = document.getElementById(spreadsheet.idPrefix+\"button_moveinsert\");\n            ele.src=spreadsheet.imagePrefix+\"moveinsertoff.gif\";\n            }\n         break;\n\n      case \"swapcolors\":\n         sheet = spreadsheet.sheet;\n         cell = sheet.GetAssuredCell(editor.ecell.coord);\n         defaultcolor = sheet.attribs.defaultcolor ? sheet.colors[sheet.attribs.defaultcolor] : \"rgb(0,0,0)\";\n         defaultbgcolor = sheet.attribs.defaultbgcolor ? sheet.colors[sheet.attribs.defaultbgcolor] : \"rgb(255,255,255)\";\n         color = cell.color ? sheet.colors[cell.color] : defaultcolor; // get color\n         if (color == defaultbgcolor) color = \"\"; // going to swap, so if same as background default, use default\n         bgcolor = cell.bgcolor ? sheet.colors[cell.bgcolor] : defaultbgcolor;\n         if (bgcolor == defaultcolor) bgcolor = \"\"; // going to swap, so if same as foreground default, use default\n         spreadsheet.ExecuteCommand(\"set %C color \"+bgcolor+\"%Nset %C bgcolor \"+color, \"\");\n         break;\n\n      default:\n         combostr = SocialCalc.SpreadsheetCmdLookup[which] || \"\";\n         sstr = SocialCalc.SpreadsheetCmdSLookup[which] || \"\";\n         spreadsheet.ExecuteCommand(combostr, sstr);\n         break;\n      }\n\n   if (obj && obj.blur) obj.blur();\n   SocialCalc.KeyboardFocus();   \n\n   }\n\nSocialCalc.SpreadsheetCmdLookup = {\n 'copy': 'copy %C all',\n 'cut': 'cut %C all',\n 'paste': 'paste %C all',\n 'pasteformats': 'paste %C formats',\n 'delete': 'erase %C formulas',\n 'filldown': 'filldown %C all',\n 'fillright': 'fillright %C all',\n 'erase': 'erase %C all',\n 'borderon': 'set %C bt %S%Nset %C br %S%Nset %C bb %S%Nset %C bl %S',\n 'borderoff': 'set %C bt %S%Nset %C br %S%Nset %C bb %S%Nset %C bl %S',\n 'merge': 'merge %C',\n 'unmerge': 'unmerge %C',\n 'align-left': 'set %C cellformat left',\n 'align-center': 'set %C cellformat center',\n 'align-right': 'set %C cellformat right',\n 'align-default': 'set %C cellformat',\n 'insertrow': 'insertrow %C',\n 'insertcol': 'insertcol %C',\n 'deleterow': 'deleterow %C',\n 'deletecol': 'deletecol %C',\n 'undo': 'undo',\n 'redo': 'redo',\n 'recalc': 'recalc'\n }\n\nSocialCalc.SpreadsheetCmdSLookup = {\n 'borderon': '1px solid rgb(0,0,0)',\n 'borderoff': ''\n }\n\n/******* NO LONGER USED\n\nSocialCalc.SpreadsheetCmdTable = {\n cmd: [\n  {t:\"Fill Right\", s:\"ffal\", c:\"fillright %C %S\"},\n  {t:\"Fill Down\", s:\"ffal\", c:\"filldown %C %S\"},\n  {t:\"Copy\", s:\"all\", c:\"copy %C %S\"},\n  {t:\"Cut\", s:\"all\", c:\"cut %C %S\"},\n  {t:\"Paste\", s:\"ffal\", c:\"paste %C %S\"},\n  {t:\"Erase\", s:\"ffal\", c:\"erase %C %S\"},\n  {t:\"Insert\", s:\"rowcol\", c:\"insert%S %C\"},\n  {t:\"Delete\", s:\"rowcol\", c:\"delete%S %C\"},\n  {t:\"Merge Cells\", s:\"none\", c:\"merge %C\"},\n  {t:\"Unmerge\", s:\"none\", c:\"unmerge %C\"},\n  {t:\"Sort\", s:\"sortcol\", c:\"sort %R %S\"},\n  {t:\"Cell Color\", s:\"colors\", c:\"set %C color %S\"},\n  {t:\"Cell Background\", s:\"colors\", c:\"set %C bgcolor %S\"},\n  {t:\"Cell Number Format\", s:\"ntvf\", c:\"set %C nontextvalueformat %S\"},\n  {t:\"Cell Font\", s:\"fonts\", c:\"set %C font %S\"},\n  {t:\"Cell Align\", s:\"cellformat\", c:\"set %C cellformat %S\"},\n  {t:\"Cell Borders\", s:\"borderOnOff\", c:\"set %C bt %S%Nset %C br %S%Nset %C bb %S%Nset %C bl %S\"},\n  {t:\"Column Width\", s:\"colWidths\", c:\"set %W width %S\"},\n  {t:\"Default Color\", s:\"colors\", c:\"set sheet defaultcolor %S\"},\n  {t:\"Default Background\", s:\"colors\", c:\"set sheet defaultbgcolor %S\"},\n  {t:\"Default Number Format\", s:\"ntvf\", c:\"set sheet defaultnontextvalueformat %S\"},\n  {t:\"Default Font\", s:\"fonts\", c:\"set sheet defaultfont %S\"},\n  {t:\"Default Text Align\", s:\"cellformat\", c:\"set sheet defaulttextformat %S\"},\n  {t:\"Default Number Align\", s:\"cellformat\", c:\"set sheet defaultnontextformat %S\"},\n  {t:\"Default Column Width\", s:\"colWidths\", c:\"set sheet defaultcolwidth %S\"}\n  ],\n rowcolstuff: [\n  {t:\"Insert\", s:\"rowcol\", c:\"insert%S %C\"},\n  {t:\"Delete\", s:\"rowcol\", c:\"delete%S %C\"},\n  {t:\"Paste\", s:\"ffal\", c:\"paste %C %S\"},\n  {t:\"Erase\", s:\"ffal\", c:\"erase %C %S\"},\n  {t:\"Fill Right\", s:\"ffal\", c:\"fillright %C %S\"},\n  {t:\"Fill Down\", s:\"ffal\", c:\"filldown %C %S\"}\n  ],\n text: [\n  {t:\"Cell Color\", s:\"colors\", c:\"set %C color %S\"},\n  {t:\"Cell Background\", s:\"colors\", c:\"set %C bgcolor %S\"},\n  {t:\"Cell Number Format\", s:\"ntvf\", c:\"set %C nontextvalueformat %S\"},\n  {t:\"Cell Text Format\", s:\"tvf\", c:\"set %C textvalueformat %S\"},\n  {t:\"Cell Font\", s:\"fonts\", c:\"set %C font %S\"},\n  {t:\"Cell Align\", s:\"cellformat\", c:\"set %C cellformat %S\"},\n  {t:\"Default Color\", s:\"colors\", c:\"set sheet defaultcolor %S\"},\n  {t:\"Default Background\", s:\"colors\", c:\"set sheet defaultbgcolor %S\"},\n  {t:\"Default Number Format\", s:\"ntvf\", c:\"set sheet defaultnontextvalueformat %S\"},\n  {t:\"Default Text Format\", s:\"tvf\", c:\"set sheet defaulttextvalueformat %S\"},\n  {t:\"Default Font\", s:\"fonts\", c:\"set sheet defaultfont %S\"},\n  {t:\"Default Text Align\", s:\"cellformat\", c:\"set sheet defaulttextformat %S\"},\n  {t:\"Default Number Align\", s:\"cellformat\", c:\"set sheet defaultnontextformat %S\"}\n  ],\n slists: {\n  \"colors\": [\n   {t:\"Default\", s:\"\"},\n   {t:\"Black\", s:\"rgb(0,0,0)\"},\n   {t:\"Dark Gray\", s:\"rgb(102,102,102)\"}, // #666\n   {t:\"Gray\", s:\"rgb(204,204,204)\"}, // #CCC\n   {t:\"White\", s:\"rgb(255,255,255)\"},\n   {t:\"Red\", s:\"rgb(255,0,0)\"},\n   {t:\"Dark Red\", s:\"rgb(153,0,0)\"},\n   {t:\"Orange\", s:\"rgb(255,153,0)\"},\n   {t:\"Yellow\", s:\"rgb(255,255,0)\"},\n   {t:\"Light Yellow\", s:\"rgb(255,255,204)\"},\n   {t:\"Green\", s:\"rgb(0,255,0)\"},\n   {t:\"Dark Green\", s:\"rgb(0,153,0)\"},\n   {t:\"Blue\", s:\"rgb(0,0,255)\"},\n   {t:\"Dark Blue\", s:\"rgb(0,0,153)\"},\n   {t:\"Light Blue\", s:\"rgb(204,204,255)\"}\n   ],\n  \"fonts\": [ // style weight size family\n   {t:\"Default\", s:\"\"},\n   {t:\"Bold\", s:\"normal bold * *\"},\n   {t:\"Italic\", s:\"italic normal * *\"},\n   {t:\"Small\", s:\"* small *\"},\n   {t:\"Medium\", s:\"* medium *\"},\n   {t:\"Large\", s:\"* large *\"},\n   {t:\"Bold Small\", s:\"normal bold small *\"},\n   {t:\"Bold Medium\", s:\"normal bold medium *\"},\n   {t:\"Bold Large\", s:\"normal bold large *\"}\n   ],\n  \"cellformat\": [\n   {t:\"Default\", s:\"\"},\n   {t:\"Left\", s:\"left\"},\n   {t:\"Right\", s:\"right\"},\n   {t:\"Center\", s:\"center\"}\n   ],\n  \"borderOnOff\": [\n   {t:\"On\", s:\"1px solid rgb(0,0,0)\"},\n   {t:\"Off\", s:\"\"}\n   ],\n  \"colWidths\": [\n   {t:\"Default\", s:\"\"},\n   {t:\"20\", s:\"20\"},\n   {t:\"40\", s:\"40\"},\n   {t:\"60\", s:\"60\"},\n   {t:\"80\", s:\"80\"},\n   {t:\"100\", s:\"100\"},\n   {t:\"120\", s:\"120\"},\n   {t:\"140\", s:\"140\"},\n   {t:\"160\", s:\"160\"},\n   {t:\"180\", s:\"180\"},\n   {t:\"200\", s:\"200\"},\n   {t:\"220\", s:\"220\"},\n   {t:\"240\", s:\"240\"},\n   {t:\"260\", s:\"260\"},\n   {t:\"280\", s:\"280\"},\n   {t:\"300\", s:\"300\"}\n   ],\n  \"ntvf\": [\n   {t:\"Default\", s:\"\"},\n   {t:\"1234\", s:\"0\"},\n   {t:\"1,234\", s:\"#,##0\"},\n   {t:\"1,234.5\", s:\"#,##0.0\"},\n   {t:\"1,234.56\", s:\"#,##0.00\"},\n   {t:\"1,234.567\", s:\"#,##0.000\"},\n   {t:\"1,234%\", s:\"#,##0%\"},\n   {t:\"1,234.5%\", s:\"#,##0.0%\"},\n   {t:\"(1,234)\", s:\"#,##0_);(#,##0)\"},\n   {t:\"(1,234.5)\", s:\"#,##0.0_);(#,##0.0)\"},\n   {t:\"(1,234.56)\", s:\"#,##0.00_);(#,##0.00)\"},\n   {t:\"00\", s:\"00\"},\n   {t:\"000\", s:\"000\"},\n   {t:\"0000\", s:\"0000\"},\n   {t:\"$1,234.56\", s:\"$#,##0.00\"},\n   {t:\"2006-01-04\", s:\"yyyy-mm-dd\"},\n   {t:\"01:23:45\", s:\"hh:mm:ss\"},\n   {t:\"2006-01-04 01:23:45\", s:\"yyyy-mm-dd hh:mm:ss\"},\n   {t:\"Hidden\", s:\"hidden\"}\n   ],\n  \"tvf\": [\n   {t:\"Default\", s:\"\"},\n   {t:\"Automatic\", s:\"general\"},\n   {t:\"Plain Text\", s:\"text-plain\"},\n   {t:\"HTML\", s:\"text-html\"},\n   {t:\"Wiki\", s:\"text-wiki\"},\n   {t:\"Hidden\", s:\"hidden\"}\n   ],\n  \"ffal\": [ // Formulas, Formats, All\n   {t:\"All\", s:\"all\"},\n   {t:\"Contents\", s:\"formulas\"},\n   {t:\"Formats\", s:\"formats\"}\n   ],\n  \"all\": [ // All\n   {t:\"All\", s:\"all\"}\n   ],\n  \"rowcol\": [\n   {t:\"Row\", s:\"row\"},\n   {t:\"Column\", s:\"col\"}\n   ],\n  \"sortcol\": [\n   {t:\"A up\", s:\"A up\"},\n   {t:\"B up\", s:\"B up\"},\n   {t:\"C up\", s:\"C up\"},\n   {t:\"A down\", s:\"A down\"},\n   {t:\"B down\", s:\"B down\"},\n   {t:\"C down\", s:\"C down\"},\n   {t:\"A, B, C up\", s:\"A up B up C up\"}\n   ],\n  \"none\": [ // nothing\n   {t:\" \", s:\" \"}\n   ]\n  }\n }\n*********/\n\n//\n// SocialCalc.SpreadsheetControlExecuteCommand(obj, combostr, sstr)\n//\n// xxx\n//\n\nSocialCalc.SpreadsheetControlExecuteCommand = function(obj, combostr, sstr) {\n\n   var i, commands;\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\n   var eobj = spreadsheet.editor;\n\n   var str = {};\n   str.P = \"%\";\n   str.N = \"\\n\"\n   if (eobj.range.hasrange) {\n      str.R = SocialCalc.crToCoord(eobj.range.left, eobj.range.top)+\n             \":\"+SocialCalc.crToCoord(eobj.range.right, eobj.range.bottom);\n      str.C = str.R;\n      str.W = SocialCalc.rcColname(eobj.range.left) + \":\" + SocialCalc.rcColname(eobj.range.right);\n      }\n   else {\n      str.C = eobj.ecell.coord;\n      str.R = eobj.ecell.coord+\":\"+eobj.ecell.coord;\n      str.W = SocialCalc.rcColname(SocialCalc.coordToCr(eobj.ecell.coord).col);\n      }\n   str.S = sstr;\n   combostr = combostr.replace(/%C/g, str.C);\n   combostr = combostr.replace(/%R/g, str.R);\n   combostr = combostr.replace(/%N/g, str.N);\n   combostr = combostr.replace(/%S/g, str.S);\n   combostr = combostr.replace(/%W/g, str.W);\n   combostr = combostr.replace(/%P/g, str.P);\n\n   eobj.EditorScheduleSheetCommands(combostr, true, false);\n\n   }\n\n//\n// result = SocialCalc.SpreadsheetControlCreateSheetHTML(spreadsheet)\n//\n// Returns the HTML representation of the whole spreadsheet\n//\n\nSocialCalc.SpreadsheetControlCreateSheetHTML = function(spreadsheet) {\n\n   var context, div, ele;\n\n   var result = \"\";\n\n   context = new SocialCalc.RenderContext(spreadsheet.sheet);\n   div = document.createElement(\"div\");\n   ele = context.RenderSheet(null, {type: \"html\"});\n   div.appendChild(ele);\n   context = undefined;\n   result = div.innerHTML;\n   ele = undefined;\n   div = undefined;\n   return result;\n\n   }\n\n//\n// result = SocialCalc.SpreadsheetControlCreateCellHTML(spreadsheet, coord, linkstyle)\n//\n// Returns the HTML representation of a cell. Blank is \"\", not \"&nbsp;\".\n//\n\nSocialCalc.SpreadsheetControlCreateCellHTML = function(spreadsheet, coord, linkstyle) {\n\n   var result = \"\";\n   var cell = spreadsheet.sheet.cells[coord];\n\n   if (!cell) return \"\";\n\n   if (cell.displaystring == undefined) {\n      result = SocialCalc.FormatValueForDisplay(spreadsheet.sheet, cell.datavalue, coord, (linkstyle || spreadsheet.context.defaultHTMLlinkstyle));\n      }\n   else {\n      result = cell.displaystring;\n      }\n\n   if (result == \"&nbsp;\") result = \"\";\n\n   return result;\n\n   }\n\n//\n// result = SocialCalc.SpreadsheetControlCreateCellHTMLSave(spreadsheet, range, linkstyle)\n//\n// Returns the HTML representation of a range of cells, or the whole sheet if range is null.\n// The form is:\n//    version:1.0\n//    coord:cell-HTML\n//    coord:cell-HTML\n//    ...\n//\n// Empty cells are skipped. The cell-HTML is encoded with \":\"=>\"\\c\", newline=>\"\\n\", and \"\\\"=>\"\\b\".\n//\n\nSocialCalc.SpreadsheetControlCreateCellHTMLSave = function(spreadsheet, range, linkstyle) {\n\n   var cr1, cr2, row, col, coord, cell, cellHTML;\n   var result = [];\n   var prange;\n\n   if (range) {\n      prange = SocialCalc.ParseRange(range);\n      }\n   else {\n      prange = {cr1: {row: 1, col:1},\n                cr2: {row: spreadsheet.sheet.attribs.lastrow, col: spreadsheet.sheet.attribs.lastcol}};\n      }\n   cr1 = prange.cr1;\n   cr2 = prange.cr2;\n\n   result.push(\"version:1.0\");\n\n   for (row=cr1.row; row <= cr2.row; row++) {\n      for (col=cr1.col; col <= cr2.col; col++) {\n         coord = SocialCalc.crToCoord(col, row);\n         cell=spreadsheet.sheet.cells[coord];\n         if (!cell) continue;\n         if (cell.displaystring == undefined) {\n            cellHTML = SocialCalc.FormatValueForDisplay(spreadsheet.sheet, cell.datavalue, coord, (linkstyle || spreadsheet.context.defaultHTMLlinkstyle));\n            }\n         else {\n            cellHTML = cell.displaystring;\n            }\n         if (cellHTML == \"&nbsp;\") continue;\n         result.push(coord+\":\"+SocialCalc.encodeForSave(cellHTML));\n         }\n      }\n\n   result.push(\"\"); // one extra to get extra \\n\n   return result.join(\"\\n\");\n   }\n\n//\n// Formula Bar Button Routines\n//\n\nSocialCalc.SpreadsheetControl.DoFunctionList = function() {\n\n   var i, cname, str, f, ele;\n\n   var scf = SocialCalc.Formula;\n   var scc = SocialCalc.Constants;\n   var fcl = scc.function_classlist;\n\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\n   var idp = spreadsheet.idPrefix+\"function\";\n\n   ele = document.getElementById(idp+\"dialog\");\n   if (ele) return; // already have one\n\n   scf.FillFunctionInfo();\n\n   str = '<table><tr><td><span style=\"font-size:x-small;font-weight:bold\">%loc!Category!</span><br>'+\n      '<select id=\"'+idp+'class\" size=\"'+fcl.length+'\" style=\"width:120px;\" onchange=\"SocialCalc.SpreadsheetControl.FunctionClassChosen(this.options[this.selectedIndex].value);\">';\n   for (i=0; i<fcl.length; i++) {\n      str += '<option value=\"'+fcl[i]+'\"'+(i==0?' selected>':'>')+SocialCalc.special_chars(scf.FunctionClasses[fcl[i]].name)+'</option>';\n      }\n   str += '</select></td><td>&nbsp;&nbsp;</td><td id=\"'+idp+'list\"><span style=\"font-size:x-small;font-weight:bold\">%loc!Functions!</span><br>'+\n      '<select id=\"'+idp+'name\" size=\"'+fcl.length+'\" style=\"width:240px;\" '+\n      'onchange=\"SocialCalc.SpreadsheetControl.FunctionChosen(this.options[this.selectedIndex].value);\" ondblclick=\"SocialCalc.SpreadsheetControl.DoFunctionPaste();\">';\n   str += SocialCalc.SpreadsheetControl.GetFunctionNamesStr(\"all\");\n   str += '</td></tr><tr><td colspan=\"3\">'+\n          '<div id=\"'+idp+'desc\" style=\"width:380px;height:80px;overflow:auto;font-size:x-small;\">'+SocialCalc.SpreadsheetControl.GetFunctionInfoStr(scf.FunctionClasses[fcl[0]].items[0])+'</div>'+\n          '<div style=\"width:380px;text-align:right;padding-top:6px;font-size:small;\">'+\n          '<input type=\"button\" value=\"%loc!Paste!\" style=\"font-size:smaller;\" onclick=\"SocialCalc.SpreadsheetControl.DoFunctionPaste();\">&nbsp;'+\n          '<input type=\"button\" value=\"%loc!Cancel!\" style=\"font-size:smaller;\" onclick=\"SocialCalc.SpreadsheetControl.HideFunctions();\"></div>'+\n          '</td></tr></table>';\n\n   var main = document.createElement(\"div\");\n   main.id = idp+\"dialog\";\n\n   main.style.position = \"absolute\";\n\n   var vp = SocialCalc.GetViewportInfo();\n\n   main.style.top = (vp.height/3)+\"px\";\n   main.style.left = (vp.width/3)+\"px\";\n   main.style.zIndex = 100;\n   main.style.backgroundColor = \"#FFF\";\n   main.style.border = \"1px solid black\";\n\n   main.style.width = \"400px\";\n\n   str = '<table cellspacing=\"0\" cellpadding=\"0\" style=\"border-bottom:1px solid black;\"><tr>'+\n      '<td style=\"font-size:10px;cursor:default;width:100%;background-color:#999;color:#FFF;\">'+\"&nbsp;%loc!Function List!\"+'</td>'+\n      '<td style=\"font-size:10px;cursor:default;color:#666;\" onclick=\"SocialCalc.SpreadsheetControl.HideFunctions();\">&nbsp;X&nbsp;</td></tr></table>'+\n      '<div style=\"background-color:#DDD;\">'+str+'</div>';\n\n   str = SocialCalc.LocalizeSubstrings(str);\n\n   main.innerHTML = str;\n\n   SocialCalc.DragRegister(main.firstChild.firstChild.firstChild.firstChild, true, true, {MouseDown: SocialCalc.DragFunctionStart, MouseMove: SocialCalc.DragFunctionPosition,\n                  MouseUp: SocialCalc.DragFunctionPosition,\n                  Disabled: null, positionobj: main});\n\n   spreadsheet.spreadsheetDiv.appendChild(main);\n\n   ele = document.getElementById(idp+\"name\");\n   ele.focus();\n   SocialCalc.CmdGotFocus(ele);\n//!!! need to do keyboard handling: if esc, hide; if All, letter scrolls to there\n\n   }\n\nSocialCalc.SpreadsheetControl.GetFunctionNamesStr = function(cname) {\n\n   var i, f;\n   var scf = SocialCalc.Formula;\n   var str = \"\";\n\n   f = scf.FunctionClasses[cname];\n   for (i=0; i<f.items.length; i++) {\n      str += '<option value=\"'+f.items[i]+'\"'+(i==0?' selected>':'>')+f.items[i]+'</option>';\n      }\n\n   return str;\n\n   }\n\nSocialCalc.SpreadsheetControl.FillFunctionNames = function(cname, ele) {\n\n   var i, f;\n   var scf = SocialCalc.Formula;\n\n   ele.length = 0;\n   f = scf.FunctionClasses[cname];\n   for (i=0; i<f.items.length; i++) {\n      ele.options[i] = new Option(f.items[i], f.items[i]);\n      if (i==0) {\n         ele.options[i].selected = true;\n         }\n      }\n   }\n\nSocialCalc.SpreadsheetControl.GetFunctionInfoStr = function(fname) {\n   \n   var scf = SocialCalc.Formula;\n   var f = scf.FunctionList[fname];\n   var scsc = SocialCalc.special_chars;\n\n   var str = \"<b>\"+fname+\"(\"+scsc(scf.FunctionArgString(fname))+\")</b><br>\";\n   str += scsc(f[3]);\n\n   return str;\n\n   }\n\nSocialCalc.SpreadsheetControl.FunctionClassChosen = function(cname) {\n\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\n   var idp = spreadsheet.idPrefix+\"function\";\n   var scf = SocialCalc.Formula;\n\n   SocialCalc.SpreadsheetControl.FillFunctionNames(cname, document.getElementById(idp+\"name\"));\n\n   SocialCalc.SpreadsheetControl.FunctionChosen(scf.FunctionClasses[cname].items[0]);\n\n   }\n\nSocialCalc.SpreadsheetControl.FunctionChosen = function(fname) {\n\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\n   var idp = spreadsheet.idPrefix+\"function\";\n\n   document.getElementById(idp+\"desc\").innerHTML = SocialCalc.SpreadsheetControl.GetFunctionInfoStr(fname);\n\n   }\n\nSocialCalc.SpreadsheetControl.HideFunctions = function() {\n\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\n\n   var ele = document.getElementById(spreadsheet.idPrefix+\"functiondialog\");\n   ele.innerHTML = \"\";\n\n   SocialCalc.DragUnregister(ele);\n\n   SocialCalc.KeyboardFocus();\n\n   if (ele.parentNode) {\n      ele.parentNode.removeChild(ele);\n      }\n\n   }\n\nSocialCalc.SpreadsheetControl.DoFunctionPaste = function() {\n\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\n   var editor = spreadsheet.editor;\n   var ele = document.getElementById(spreadsheet.idPrefix+\"functionname\");\n   var mele = document.getElementById(spreadsheet.idPrefix+\"multilinetextarea\");\n\n   var text = ele.value+\"(\";\n\n   SocialCalc.SpreadsheetControl.HideFunctions();\n\n   if (mele) { // multi-line editing is in progress\n      mele.value += text;\n      mele.focus();\n      SocialCalc.CmdGotFocus(mele);\n      }\n   else {\n      editor.EditorAddToInput(text, \"=\");\n      }\n\n   }\n\n\nSocialCalc.SpreadsheetControl.DoMultiline = function() {\n\n   var SCLocSS = SocialCalc.LocalizeSubstrings;\n\n   var str, ele, text;\n\n   var scc = SocialCalc.Constants;\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\n   var editor = spreadsheet.editor;\n   var wval = editor.workingvalues;\n\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\n   var idp = spreadsheet.idPrefix+\"multiline\";\n\n   ele = document.getElementById(idp+\"dialog\");\n   if (ele) return; // already have one\n\n   switch (editor.state) {\n      case \"start\":\n         wval.ecoord = editor.ecell.coord;\n         wval.erow = editor.ecell.row;\n         wval.ecol = editor.ecell.col;\n         editor.RangeRemove();\n         text = SocialCalc.GetCellContents(editor.context.sheetobj, wval.ecoord);\n         break;\n\n      case \"input\":\n      case \"inputboxdirect\":\n         text = editor.inputBox.GetText();\n         break;\n      }\n\n   editor.inputBox.element.disabled = true;\n\n   text = SocialCalc.special_chars(text);\n\n   str = '<textarea id=\"'+idp+'textarea\" style=\"width:380px;height:120px;margin:10px 0px 0px 6px;\">'+text+'</textarea>'+\n         '<div style=\"width:380px;text-align:right;padding:6px 0px 4px 6px;font-size:small;\">'+\n         SCLocSS('<input type=\"button\" value=\"%loc!Set Cell Contents!\" style=\"font-size:smaller;\" onclick=\"SocialCalc.SpreadsheetControl.DoMultilinePaste();\">&nbsp;'+\n         '<input type=\"button\" value=\"%loc!Clear!\" style=\"font-size:smaller;\" onclick=\"SocialCalc.SpreadsheetControl.DoMultilineClear();\">&nbsp;'+\n         '<input type=\"button\" value=\"%loc!Cancel!\" style=\"font-size:smaller;\" onclick=\"SocialCalc.SpreadsheetControl.HideMultiline();\"></div>'+\n         '</div>');\n\n   var main = document.createElement(\"div\");\n   main.id = idp+\"dialog\";\n\n   main.style.position = \"absolute\";\n\n   var vp = SocialCalc.GetViewportInfo();\n\n   main.style.top = (vp.height/3)+\"px\";\n   main.style.left = (vp.width/3)+\"px\";\n   main.style.zIndex = 100;\n   main.style.backgroundColor = \"#FFF\";\n   main.style.border = \"1px solid black\";\n\n   main.style.width = \"400px\";\n\n   main.innerHTML = '<table cellspacing=\"0\" cellpadding=\"0\" style=\"border-bottom:1px solid black;\"><tr>'+\n      '<td style=\"font-size:10px;cursor:default;width:100%;background-color:#999;color:#FFF;\">'+\n      SCLocSS(\"&nbsp;%loc!Multi-line Input Box!\")+'</td>'+\n      '<td style=\"font-size:10px;cursor:default;color:#666;\" onclick=\"SocialCalc.SpreadsheetControl.HideMultiline();\">&nbsp;X&nbsp;</td></tr></table>'+\n      '<div style=\"background-color:#DDD;\">'+str+'</div>';\n\n   SocialCalc.DragRegister(main.firstChild.firstChild.firstChild.firstChild, true, true, {MouseDown: SocialCalc.DragFunctionStart, MouseMove: SocialCalc.DragFunctionPosition,\n                  MouseUp: SocialCalc.DragFunctionPosition,\n                  Disabled: null, positionobj: main});\n\n   spreadsheet.spreadsheetDiv.appendChild(main);\n\n   ele = document.getElementById(idp+\"textarea\");\n   ele.focus();\n   SocialCalc.CmdGotFocus(ele);\n//!!! need to do keyboard handling: if esc, hide?\n\n   }\n\n\nSocialCalc.SpreadsheetControl.HideMultiline = function() {\n\n   var scc = SocialCalc.Constants;\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\n   var editor = spreadsheet.editor;\n\n   var ele = document.getElementById(spreadsheet.idPrefix+\"multilinedialog\");\n   ele.innerHTML = \"\";\n\n   SocialCalc.DragUnregister(ele);\n\n   SocialCalc.KeyboardFocus();\n\n   if (ele.parentNode) {\n      ele.parentNode.removeChild(ele);\n      }\n\n   switch (editor.state) {\n      case \"start\":\n         editor.inputBox.DisplayCellContents(null);\n         break;\n\n      case \"input\":\n      case \"inputboxdirect\":\n         editor.inputBox.element.disabled = false;\n         editor.inputBox.Focus();\n         break;\n      }\n\n   }\n\nSocialCalc.SpreadsheetControl.DoMultilineClear = function() {\n\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\n\n   var ele = document.getElementById(spreadsheet.idPrefix+\"multilinetextarea\");\n\n   ele.value = \"\";\n   ele.focus();\n\n   }\n\n\nSocialCalc.SpreadsheetControl.DoMultilinePaste = function() {\n\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\n   var editor = spreadsheet.editor;\n   var wval = editor.workingvalues;\n\n   var ele = document.getElementById(spreadsheet.idPrefix+\"multilinetextarea\");\n\n   var text = ele.value;\n\n   SocialCalc.SpreadsheetControl.HideMultiline();\n\n   switch (editor.state) {\n      case \"start\":\n         wval.partialexpr = \"\";\n         wval.ecoord = editor.ecell.coord;\n         wval.erow = editor.ecell.row;\n         wval.ecol = editor.ecell.col;\n         break;\n      case \"input\":\n      case \"inputboxdirect\":\n         editor.inputBox.Blur();\n         editor.inputBox.ShowInputBox(false);\n         editor.state = \"start\";\n         break;\n      }\n\n   editor.EditorSaveEdit(text);\n\n   }\n\n\nSocialCalc.SpreadsheetControl.DoLink = function() {\n\n   var SCLoc = SocialCalc.LocalizeString;\n\n   var str, ele, text, cell, setformat, popup;\n\n   var scc = SocialCalc.Constants;\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\n   var editor = spreadsheet.editor;\n   var wval = editor.workingvalues;\n\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\n   var idp = spreadsheet.idPrefix+\"link\";\n\n   ele = document.getElementById(idp+\"dialog\");\n   if (ele) return; // already have one\n\n   switch (editor.state) {\n      case \"start\":\n         wval.ecoord = editor.ecell.coord;\n         wval.erow = editor.ecell.row;\n         wval.ecol = editor.ecell.col;\n         editor.RangeRemove();\n         text = SocialCalc.GetCellContents(editor.context.sheetobj, wval.ecoord);\n         break;\n\n      case \"input\":\n      case \"inputboxdirect\":\n         text = editor.inputBox.GetText();\n         break;\n      }\n\n   editor.inputBox.element.disabled = true;\n\n   if (text.charAt(0)==\"'\") {\n      text = text.slice(1);\n      }\n\n   var parts = SocialCalc.ParseCellLinkText(text);\n\n   text = SocialCalc.special_chars(text);\n\n   cell = spreadsheet.sheet.cells[editor.ecell.coord];\n   if (!cell || !cell.textvalueformat) { // set to link format, but don't override\n      setformat = \" checked\";\n      }\n   else {\n      setformat = \"\";\n      }\n\n   popup = parts.newwin ? \" checked\" : \"\";\n\n   str = '<div style=\"padding:6px 0px 4px 6px;\">'+\n         '<span style=\"font-size:smaller;\">'+SCLoc(\"Description\")+'</span><br>'+\n         '<input type=\"text\" id=\"'+idp+'desc\" style=\"width:380px;\" value=\"'+SocialCalc.special_chars(parts.desc)+'\"><br>'+\n         '<span style=\"font-size:smaller;\">'+SCLoc(\"URL\")+'</span><br>'+\n         '<input type=\"text\" id=\"'+idp+'url\" style=\"width:380px;\" value=\"'+SocialCalc.special_chars(parts.url)+'\"><br>';\n   if (SocialCalc.Callbacks.MakePageLink) { // only show if handling pagenames here\n      str += '<span style=\"font-size:smaller;\">'+SCLoc(\"Page Name\")+'</span><br>'+\n             '<input type=\"text\" id=\"'+idp+'pagename\" style=\"width:380px;\" value=\"'+SocialCalc.special_chars(parts.pagename)+'\"><br>'+\n             '<span style=\"font-size:smaller;\">'+SCLoc(\"Workspace\")+'</span><br>'+\n             '<input type=\"text\" id=\"'+idp+'workspace\" style=\"width:380px;\" value=\"'+SocialCalc.special_chars(parts.workspace)+'\"><br>';\n      }\n   str += SocialCalc.LocalizeSubstrings('<input type=\"checkbox\" id=\"'+idp+'format\"'+setformat+'>&nbsp;'+\n         '<span style=\"font-size:smaller;\">%loc!Set to Link format!</span><br>'+\n         '<input type=\"checkbox\" id=\"'+idp+'popup\"'+popup+'>&nbsp;'+\n         '<span style=\"font-size:smaller;\">%loc!Show in new browser window!</span>'+\n         '</div>'+\n         '<div style=\"width:380px;text-align:right;padding:6px 0px 4px 6px;font-size:small;\">'+\n         '<input type=\"button\" value=\"%loc!Set Cell Contents!\" style=\"font-size:smaller;\" onclick=\"SocialCalc.SpreadsheetControl.DoLinkPaste();\">&nbsp;'+\n         '<input type=\"button\" value=\"%loc!Clear!\" style=\"font-size:smaller;\" onclick=\"SocialCalc.SpreadsheetControl.DoLinkClear();\">&nbsp;'+\n         '<input type=\"button\" value=\"%loc!Cancel!\" style=\"font-size:smaller;\" onclick=\"SocialCalc.SpreadsheetControl.HideLink();\"></div>'+\n         '</div>');\n\n   var main = document.createElement(\"div\");\n   main.id = idp+\"dialog\";\n\n   main.style.position = \"absolute\";\n\n   var vp = SocialCalc.GetViewportInfo();\n\n   main.style.top = (vp.height/3)+\"px\";\n   main.style.left = (vp.width/3)+\"px\";\n   main.style.zIndex = 100;\n   main.style.backgroundColor = \"#FFF\";\n   main.style.border = \"1px solid black\";\n\n   main.style.width = \"400px\";\n\n   main.innerHTML = '<table cellspacing=\"0\" cellpadding=\"0\" style=\"border-bottom:1px solid black;\"><tr>'+\n      '<td style=\"font-size:10px;cursor:default;width:100%;background-color:#999;color:#FFF;\">'+\"&nbsp;\"+SCLoc(\"Link Input Box\")+'</td>'+\n      '<td style=\"font-size:10px;cursor:default;color:#666;\" onclick=\"SocialCalc.SpreadsheetControl.HideLink();\">&nbsp;X&nbsp;</td></tr></table>'+\n      '<div style=\"background-color:#DDD;\">'+str+'</div>';\n\n   SocialCalc.DragRegister(main.firstChild.firstChild.firstChild.firstChild, true, true, {MouseDown: SocialCalc.DragFunctionStart, MouseMove: SocialCalc.DragFunctionPosition,\n                  MouseUp: SocialCalc.DragFunctionPosition,\n                  Disabled: null, positionobj: main});\n\n   spreadsheet.spreadsheetDiv.appendChild(main);\n\n   ele = document.getElementById(idp+\"url\");\n   ele.focus();\n   SocialCalc.CmdGotFocus(ele);\n//!!! need to do keyboard handling: if esc, hide?\n\n   }\n\n\nSocialCalc.SpreadsheetControl.HideLink = function() {\n\n   var scc = SocialCalc.Constants;\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\n   var editor = spreadsheet.editor;\n\n   var ele = document.getElementById(spreadsheet.idPrefix+\"linkdialog\");\n   ele.innerHTML = \"\";\n\n   SocialCalc.DragUnregister(ele);\n\n   SocialCalc.KeyboardFocus();\n\n   if (ele.parentNode) {\n      ele.parentNode.removeChild(ele);\n      }\n\n   switch (editor.state) {\n      case \"start\":\n         editor.inputBox.DisplayCellContents(null);\n         break;\n\n      case \"input\":\n      case \"inputboxdirect\":\n         editor.inputBox.element.disabled = false;\n         editor.inputBox.Focus();\n         break;\n      }\n\n   }\n\nSocialCalc.SpreadsheetControl.DoLinkClear = function() {\n\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\n\n   document.getElementById(spreadsheet.idPrefix+\"linkdesc\").value = \"\";\n   document.getElementById(spreadsheet.idPrefix+\"linkpagename\").value = \"\";\n   document.getElementById(spreadsheet.idPrefix+\"linkworkspace\").value = \"\";\n\n   var ele = document.getElementById(spreadsheet.idPrefix+\"linkurl\");\n   ele.value = \"\";\n   ele.focus();\n\n   }\n\n\nSocialCalc.SpreadsheetControl.DoLinkPaste = function() {\n\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\n   var editor = spreadsheet.editor;\n   var wval = editor.workingvalues;\n\n   var descele = document.getElementById(spreadsheet.idPrefix+\"linkdesc\");\n   var urlele = document.getElementById(spreadsheet.idPrefix+\"linkurl\");\n   var pagenameele = document.getElementById(spreadsheet.idPrefix+\"linkpagename\");\n   var workspaceele = document.getElementById(spreadsheet.idPrefix+\"linkworkspace\");\n   var formatele = document.getElementById(spreadsheet.idPrefix+\"linkformat\");\n   var popupele = document.getElementById(spreadsheet.idPrefix+\"linkpopup\");\n\n   var text = \"\";\n\n   var ltsym, gtsym, obsym, cbsym;\n\n   if (popupele.checked) {\n      ltsym = \"<<\"; gtsym = \">>\"; obsym = \"[[\"; cbsym = \"]]\";\n      }\n   else {\n      ltsym = \"<\"; gtsym = \">\"; obsym = \"[\"; cbsym = \"]\";\n      }\n\n   if (pagenameele && pagenameele.value) {\n      if (workspaceele.value) {\n         text = descele.value+\"{\"+workspaceele.value+obsym+pagenameele.value+cbsym+\"}\";\n         }\n      else {\n         text = descele.value+obsym+pagenameele.value+cbsym;\n         }\n      }\n   else {\n      text = descele.value+ltsym+urlele.value+gtsym;\n      }\n\n   SocialCalc.SpreadsheetControl.HideLink();\n\n   switch (editor.state) {\n      case \"start\":\n         wval.partialexpr = \"\";\n         wval.ecoord = editor.ecell.coord;\n         wval.erow = editor.ecell.row;\n         wval.ecol = editor.ecell.col;\n         break;\n      case \"input\":\n      case \"inputboxdirect\":\n         editor.inputBox.Blur();\n         editor.inputBox.ShowInputBox(false);\n         editor.state = \"start\";\n         break;\n      }\n\n   if (formatele.checked) {\n      SocialCalc.SpreadsheetControlExecuteCommand(null, \"set %C textvalueformat text-link\", \"\");\n      }\n\n   editor.EditorSaveEdit(text);\n\n   }\n\nSocialCalc.SpreadsheetControl.DoSum = function() {\n\n   var cmd, cell, row, col, sel, cr, foundvalue;\n\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\n   var editor = spreadsheet.editor;\n   var sheet = editor.context.sheetobj;\n\n   if (editor.range.hasrange) {\n      sel = SocialCalc.crToCoord(editor.range.left, editor.range.top)+\n         \":\"+SocialCalc.crToCoord(editor.range.right, editor.range.bottom);\n      cmd = \"set \"+SocialCalc.crToCoord(editor.range.right, editor.range.bottom+1)+\n         \" formula sum(\"+sel+\")\";\n      }\n   else {\n      row = editor.ecell.row - 1;\n      col = editor.ecell.col;\n      if (row<=1) {\n         cmd = \"set \"+editor.ecell.coord+\" constant e#REF! 0 #REF!\";\n         }\n      else {\n         foundvalue = false;\n         while (row>0) {\n            cr = SocialCalc.crToCoord(col, row);\n            cell = sheet.GetAssuredCell(cr);\n            if (!cell.datatype || cell.datatype==\"t\") {\n               if (foundvalue) {\n                  row++;\n                  break;\n                  }\n               }\n            else {\n               foundvalue = true;\n               }\n            row--;\n            }\n         cmd = \"set \"+editor.ecell.coord+\" formula sum(\"+\n            SocialCalc.crToCoord(col,row)+\":\"+SocialCalc.crToCoord(col, editor.ecell.row-1)+\")\";\n         }\n      }\n\n   editor.EditorScheduleSheetCommands(cmd, true, false);\n\n   }\n\n\n//\n// TAB Routines\n//\n\n// Sort\n\nSocialCalc.SpreadsheetControlSortOnclick = function(s, t) {\n\n   var name, i;\n   var namelist = [];\n   var nl = document.getElementById(s.idPrefix+\"sortlist\");\n   SocialCalc.LoadColumnChoosers(s);\n   s.editor.RangeChangeCallback.sort = SocialCalc.UpdateSortRangeProposal;\n\n   for (name in s.sheet.names) {\n      namelist.push(name);\n      }\n   namelist.sort();\n   nl.length = 0;\n   nl.options[0] = new Option(SocialCalc.LocalizeString(\"[select range]\"));\n   for (i=0; i<namelist.length; i++) {\n      name = namelist[i];\n      nl.options[i+1] = new Option(name, name);\n      if (name == s.sortrange) {\n         nl.options[i+1].selected = true;\n         }\n      }\n   if (s.sortrange == \"\") {\n      nl.options[0].selected = true;\n      }\n\n   SocialCalc.UpdateSortRangeProposal(s.editor);\n   SocialCalc.KeyboardFocus();\n   return;\n\n   }\n\nSocialCalc.SpreadsheetControlSortSave = function(editor, setting) {\n   // Format is:\n   //    sort:sortrange:major:up/down:minor:up/down:last:up/down\n\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\n   var str, sele, rele;\n\n   str = \"sort:\"+SocialCalc.encodeForSave(spreadsheet.sortrange)+\":\";\n   sele = document.getElementById(spreadsheet.idPrefix+\"majorsort\");\n   rele = document.getElementById(spreadsheet.idPrefix+\"majorsortup\");\n   str += sele.selectedIndex + (rele.checked ? \":up\" : \":down\");\n   sele = document.getElementById(spreadsheet.idPrefix+\"minorsort\");\n   if (sele.selectedIndex>0) {\n      rele = document.getElementById(spreadsheet.idPrefix+\"minorsortup\");\n      str += \":\"+sele.selectedIndex + (rele.checked ? \":up\" : \":down\");\n      }\n   else {\n      str += \"::\";\n      }\n   sele = document.getElementById(spreadsheet.idPrefix+\"lastsort\");\n   if (sele.selectedIndex>0) {\n      rele = document.getElementById(spreadsheet.idPrefix+\"lastsortup\");\n      str += \":\"+sele.selectedIndex + (rele.checked ? \":up\" : \":down\");\n      }\n    else {\n      str += \"::\";\n      }\n   return str+\"\\n\";\n   }\n\nSocialCalc.SpreadsheetControlSortLoad = function(editor, setting, line, flags) {\n   var parts, ele;\n\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\n\n   parts = line.split(\":\");\n   spreadsheet.sortrange = SocialCalc.decodeFromSave(parts[1]);\n   ele = document.getElementById(spreadsheet.idPrefix+\"sortbutton\");\n   if (spreadsheet.sortrange) {\n      ele.value = SocialCalc.LocalizeString(\"Sort \")+spreadsheet.sortrange;\n      ele.style.visibility = \"visible\";\n      }\n   else {\n      ele.style.visibility = \"hidden\";\n      }\n   SocialCalc.LoadColumnChoosers(spreadsheet);\n\n   sele = document.getElementById(spreadsheet.idPrefix+\"majorsort\");\n   sele.selectedIndex = parts[2]-0;\n   document.getElementById(spreadsheet.idPrefix+\"majorsort\"+parts[3]).checked = true;\n   sele = document.getElementById(spreadsheet.idPrefix+\"minorsort\");\n   if (parts[4]) {\n      sele.selectedIndex = parts[4]-0;\n      document.getElementById(spreadsheet.idPrefix+\"minorsort\"+parts[5]).checked = true;\n      }\n   else {\n      sele.selectedIndex = 0;\n      document.getElementById(spreadsheet.idPrefix+\"minorsortup\").checked = true;\n      }\n   sele = document.getElementById(spreadsheet.idPrefix+\"lastsort\");\n   if (parts[6]) {\n      sele.selectedIndex = parts[6]-0;\n      document.getElementById(spreadsheet.idPrefix+\"lastsort\"+parts[7]).checked = true;\n      }\n    else {\n      sele.selectedIndex = 0;\n      document.getElementById(spreadsheet.idPrefix+\"lastsortup\").checked = true;\n      }\n\n   return true;\n   }\n\n// Comment\n\nSocialCalc.SpreadsheetControlCommentOnclick = function(s, t) {\n   s.editor.MoveECellCallback.comment = SocialCalc.SpreadsheetControlCommentMoveECell;\n   SocialCalc.SpreadsheetControlCommentDisplay(s, t);\n   SocialCalc.KeyboardFocus();\n   return;\n   }\n\nSocialCalc.SpreadsheetControlCommentDisplay = function(s, t) {\n   var c = \"\";\n   if (s.editor.ecell && s.editor.ecell.coord && s.sheet.cells[s.editor.ecell.coord]) {\n      c = s.sheet.cells[s.editor.ecell.coord].comment || \"\";\n      }\n   document.getElementById(s.idPrefix+\"commenttext\").value = c;\n   }\n\nSocialCalc.SpreadsheetControlCommentMoveECell = function(editor) {\n   SocialCalc.SpreadsheetControlCommentDisplay(SocialCalc.GetSpreadsheetControlObject(), \"comment\");\n   }\n\nSocialCalc.SpreadsheetControlCommentSet = function() {\n   var s=SocialCalc.GetSpreadsheetControlObject();\n   s.ExecuteCommand(\"set %C comment \"+SocialCalc.encodeForSave(document.getElementById(s.idPrefix+\"commenttext\").value));\n   var cell=SocialCalc.GetEditorCellElement(s.editor, s.editor.ecell.row, s.editor.ecell.col);\n   s.editor.UpdateCellCSS(cell, s.editor.ecell.row, s.editor.ecell.col);\n   SocialCalc.KeyboardFocus();\n   }\n\nSocialCalc.SpreadsheetControlCommentOnunclick = function(s, t) {\n   delete s.editor.MoveECellCallback.comment;\n   }\n\n// Names\n\nSocialCalc.SpreadsheetControlNamesOnclick = function(s, t) {\n   document.getElementById(s.idPrefix+\"namesname\").value = \"\";\n   document.getElementById(s.idPrefix+\"namesdesc\").value = \"\";\n   document.getElementById(s.idPrefix+\"namesvalue\").value = \"\";\n   s.editor.RangeChangeCallback.names = SocialCalc.SpreadsheetControlNamesRangeChange;\n   s.editor.MoveECellCallback.names = SocialCalc.SpreadsheetControlNamesRangeChange;\n   SocialCalc.SpreadsheetControlNamesRangeChange(s.editor);\n   SocialCalc.SpreadsheetControlNamesFillNameList();\n   SocialCalc.SpreadsheetControlNamesChangedName();\n   }\n\nSocialCalc.SpreadsheetControlNamesFillNameList = function() {\n   var SCLoc = SocialCalc.LocalizeString;\n   var name, i;\n   var namelist = [];\n   var s=SocialCalc.GetSpreadsheetControlObject();\n   var nl = document.getElementById(s.idPrefix+\"nameslist\");\n   var currentname = document.getElementById(s.idPrefix+\"namesname\").value.toUpperCase().replace(/[^A-Z0-9_\\.]/g, \"\");\n   for (name in s.sheet.names) {\n      namelist.push(name);\n      }\n   namelist.sort();\n   nl.length = 0;\n   if (namelist.length > 0) {\n      nl.options[0] = new Option(SCLoc(\"[New]\"));\n      }\n   else {\n      nl.options[0] = new Option(SCLoc(\"[None]\"));\n      }\n   for (i=0; i<namelist.length; i++) {\n      name = namelist[i];\n      nl.options[i+1] = new Option(name, name);\n      if (name == currentname) {\n         nl.options[i+1].selected = true;\n         }\n      }\n   if (currentname == \"\") {\n      nl.options[0].selected = true;\n      }\n   }\n\nSocialCalc.SpreadsheetControlNamesChangedName = function() {\n   var s=SocialCalc.GetSpreadsheetControlObject();\n   var nl = document.getElementById(s.idPrefix+\"nameslist\");\n   var name = nl.options[nl.selectedIndex].value;\n   if (s.sheet.names[name]) {\n      document.getElementById(s.idPrefix+\"namesname\").value = name;\n      document.getElementById(s.idPrefix+\"namesdesc\").value = s.sheet.names[name].desc || \"\";\n      document.getElementById(s.idPrefix+\"namesvalue\").value = s.sheet.names[name].definition || \"\";\n      }\n   else {\n      document.getElementById(s.idPrefix+\"namesname\").value = \"\";\n      document.getElementById(s.idPrefix+\"namesdesc\").value = \"\";\n      document.getElementById(s.idPrefix+\"namesvalue\").value = \"\";\n      }\n   }\n\nSocialCalc.SpreadsheetControlNamesRangeChange = function(editor) {\n   var s = SocialCalc.GetSpreadsheetControlObject();\n   var ele = document.getElementById(s.idPrefix+\"namesrangeproposal\");\n   if (editor.range.hasrange) {\n      ele.value = SocialCalc.crToCoord(editor.range.left, editor.range.top) + \":\" +\n                            SocialCalc.crToCoord(editor.range.right, editor.range.bottom);\n      }\n   else {\n      ele.value = editor.ecell.coord;\n      }\n   }\n\nSocialCalc.SpreadsheetControlNamesOnunclick = function(s, t) {\n   delete s.editor.RangeChangeCallback.names;\n   delete s.editor.MoveECellCallback.names;\n   }\n\nSocialCalc.SpreadsheetControlNamesSetValue = function() {\n   var s = SocialCalc.GetSpreadsheetControlObject();\n   document.getElementById(s.idPrefix+\"namesvalue\").value = document.getElementById(s.idPrefix+\"namesrangeproposal\").value;\n   SocialCalc.KeyboardFocus();\n   }\n\nSocialCalc.SpreadsheetControlNamesSave = function() {\n   var s = SocialCalc.GetSpreadsheetControlObject();\n   var name = document.getElementById(s.idPrefix+\"namesname\").value;\n   SocialCalc.SetTab(s.tabs[0].name); // return to first tab\n   SocialCalc.KeyboardFocus();\n   if (name != \"\") {\n      s.ExecuteCommand(\"name define \"+name+\" \"+document.getElementById(s.idPrefix+\"namesvalue\").value+\"\\n\"+\n         \"name desc \"+name+\" \"+document.getElementById(s.idPrefix+\"namesdesc\").value);\n      }\n   }\n\nSocialCalc.SpreadsheetControlNamesDelete = function() {\n   var s = SocialCalc.GetSpreadsheetControlObject();\n   var name = document.getElementById(s.idPrefix+\"namesname\").value;\n   SocialCalc.SetTab(s.tabs[0].name); // return to first tab\n   SocialCalc.KeyboardFocus();\n   if (name != \"\") {\n      s.ExecuteCommand(\"name delete \"+name);\n//      document.getElementById(s.idPrefix+\"namesname\").value = \"\";\n//      document.getElementById(s.idPrefix+\"namesvalue\").value = \"\";\n//      document.getElementById(s.idPrefix+\"namesdesc\").value = \"\";\n//      SocialCalc.SpreadsheetControlNamesFillNameList();\n      }\n   SocialCalc.KeyboardFocus();\n   }\n\n// Clipboard\n\nSocialCalc.SpreadsheetControlClipboardOnclick = function(s, t) {\n   var s = SocialCalc.GetSpreadsheetControlObject();\n   clipele = document.getElementById(s.idPrefix+\"clipboardtext\");\n   document.getElementById(s.idPrefix+\"clipboardformat-tab\").checked = true;\n   clipele.value = SocialCalc.ConvertSaveToOtherFormat(SocialCalc.Clipboard.clipboard, \"tab\");\n   return;\n   }\n\nSocialCalc.SpreadsheetControlClipboardFormat = function(which) {\n   var s = SocialCalc.GetSpreadsheetControlObject();\n   clipele = document.getElementById(s.idPrefix+\"clipboardtext\");\n   clipele.value = SocialCalc.ConvertSaveToOtherFormat(SocialCalc.Clipboard.clipboard, which);\n   }\n\nSocialCalc.SpreadsheetControlClipboardLoad = function() {\n   var s = SocialCalc.GetSpreadsheetControlObject();\n   var savetype = \"tab\";\n   SocialCalc.SetTab(s.tabs[0].name); // return to first tab\n   SocialCalc.KeyboardFocus();\n   if (document.getElementById(s.idPrefix+\"clipboardformat-csv\").checked) {\n      savetype = \"csv\";\n      }\n   else if (document.getElementById(s.idPrefix+\"clipboardformat-scsave\").checked) {\n      savetype = \"scsave\";\n      }\n   s.editor.EditorScheduleSheetCommands(\"loadclipboard \"+\n      SocialCalc.encodeForSave(\n         SocialCalc.ConvertOtherFormatToSave(document.getElementById(s.idPrefix+\"clipboardtext\").value, savetype)), true, false);\n   }\n\nSocialCalc.SpreadsheetControlClipboardClear = function() {\n   var s = SocialCalc.GetSpreadsheetControlObject();\n   var clipele = document.getElementById(s.idPrefix+\"clipboardtext\");\n   clipele.value = \"\";\n   s.editor.EditorScheduleSheetCommands(\"clearclipboard\", true, false);\n   clipele.focus();\n   }\n\nSocialCalc.SpreadsheetControlClipboardExport = function() {\n   var s = SocialCalc.GetSpreadsheetControlObject();\n   if (s.ExportCallback) {\n      s.ExportCallback(s);\n      }\n   SocialCalc.SetTab(s.tabs[0].name); // return to first tab\n   SocialCalc.KeyboardFocus();\n   }\n\n// Settings\n\nSocialCalc.SpreadsheetControlSettingsSwitch = function(target) {\n   SocialCalc.SettingControlReset();\n   var s = SocialCalc.GetSpreadsheetControlObject();\n   var sheettable = document.getElementById(s.idPrefix+\"sheetsettingstable\");\n   var celltable = document.getElementById(s.idPrefix+\"cellsettingstable\");\n   var sheettoolbar = document.getElementById(s.idPrefix+\"sheetsettingstoolbar\");\n   var celltoolbar = document.getElementById(s.idPrefix+\"cellsettingstoolbar\");\n   if (target==\"sheet\") {\n      sheettable.style.display = \"block\";\n      celltable.style.display = \"none\";\n      sheettoolbar.style.display = \"block\";\n      celltoolbar.style.display = \"none\";\n      SocialCalc.SettingsControlSetCurrentPanel(s.views.settings.values.sheetspanel);\n      }\n   else {\n      sheettable.style.display = \"none\";\n      celltable.style.display = \"block\";\n      sheettoolbar.style.display = \"none\";\n      celltoolbar.style.display = \"block\";\n      SocialCalc.SettingsControlSetCurrentPanel(s.views.settings.values.cellspanel);\n      }\n   }\n\nSocialCalc.SettingsControlSave = function(target) {\n   var range, cmdstr;\n   var s = SocialCalc.GetSpreadsheetControlObject();\n   var sc = SocialCalc.SettingsControls;\n   var panelobj = sc.CurrentPanel;\n   var attribs = SocialCalc.SettingsControlUnloadPanel(panelobj);\n\n   SocialCalc.SetTab(s.tabs[0].name); // return to first tab\n   SocialCalc.KeyboardFocus();\n\n   if (target==\"sheet\") {\n      cmdstr = s.sheet.DecodeSheetAttributes(attribs);\n      }\n   else if (target==\"cell\") {\n      if (s.editor.range.hasrange) {\n         range = SocialCalc.crToCoord(s.editor.range.left, s.editor.range.top) + \":\" +\n            SocialCalc.crToCoord(s.editor.range.right, s.editor.range.bottom);\n         }\n      cmdstr = s.sheet.DecodeCellAttributes(s.editor.ecell.coord, attribs, range);\n      }\n   else { // Cancel\n      }\n   if (cmdstr) {\n      s.editor.EditorScheduleSheetCommands(cmdstr, true, false);\n      }\n   }\n\n///////////////////////\n//\n// SAVE / LOAD ROUTINES\n//\n///////////////////////\n\n//\n// result = SocialCalc.SpreadsheetControlCreateSpreadsheetSave(spreadsheet, otherparts)\n//\n// Saves the spreadsheet's sheet data, editor settings, and audit trail (redo stack).\n// The serialized data strings are concatenated together in multi-part MIME format.\n// The first part lists the types of the subsequent parts (e.g., \"sheet\", \"editor\", and \"audit\")\n// in this format:\n//   # comments\n//   version:1.0\n//   part:type1\n//   part:type2\n//   ...\n//\n// If otherparts is non-null, it is an object with:\n//   partname1: \"part contents - should end with \\n\",\n//   partname2: \"part contents - should end with \\n\"\n//\n\n\nSocialCalc.SpreadsheetControlCreateSpreadsheetSave = function(spreadsheet, otherparts) {\n\n   var result;\n\n   var otherpartsstr = \"\";\n   var otherpartsnames = \"\";\n   var partname, extranl;\n\n   if (otherparts) {\n      for (partname in otherparts) {\n         if (otherparts[partname].charAt(otherparts[partname]-1) != \"\\n\") {\n            extranl = \"\\n\";\n            }\n         else {\n            extranl = \"\";\n            }\n         otherpartsstr += \"--\" + spreadsheet.multipartBoundary + \"\\nContent-type: text/plain; charset=UTF-8\\n\\n\" +\n            otherparts[partname] + extranl;\n         otherpartsnames += \"part:\"+partname + \"\\n\";\n         }\n      }\n\n   result = \"socialcalc:version:1.0\\n\" +\n      \"MIME-Version: 1.0\\nContent-Type: multipart/mixed; boundary=\"+\n      spreadsheet.multipartBoundary + \"\\n\" +\n      \"--\" + spreadsheet.multipartBoundary + \"\\nContent-type: text/plain; charset=UTF-8\\n\\n\" +\n      \"# SocialCalc Spreadsheet Control Save\\nversion:1.0\\npart:sheet\\npart:edit\\npart:audit\\n\" + otherpartsnames +\n      \"--\" + spreadsheet.multipartBoundary + \"\\nContent-type: text/plain; charset=UTF-8\\n\\n\" +\n      spreadsheet.CreateSheetSave() +\n      \"--\" + spreadsheet.multipartBoundary + \"\\nContent-type: text/plain; charset=UTF-8\\n\\n\" +\n      spreadsheet.editor.SaveEditorSettings() +\n      \"--\" + spreadsheet.multipartBoundary + \"\\nContent-type: text/plain; charset=UTF-8\\n\\n\" +\n      spreadsheet.sheet.CreateAuditString() +\n      otherpartsstr +\n      \"--\" + spreadsheet.multipartBoundary + \"--\\n\";\n\n   return result;\n\n   }\n\n\n//\n// parts = SocialCalc.SpreadsheetControlDecodeSpreadsheetSave(spreadsheet, str)\n//\n// Separates the parts from a spreadsheet save string, returning an object with the sub-strings.\n//\n//    {type1: {start: startpos, end: endpos}, type2:...}\n//\n\nSocialCalc.SpreadsheetControlDecodeSpreadsheetSave = function(spreadsheet, str) {\n\n   var pos1, mpregex, searchinfo, boundary, boundaryregex, blanklineregex, start, ending, lines, i, lines, p, pnun;\n   var parts = {};\n   var partlist = [];\n\n   pos1 = str.search(/^MIME-Version:\\s1\\.0/mi);\n   if (pos1 < 0) return parts;\n\n   mpregex = /^Content-Type:\\s*multipart\\/mixed;\\s*boundary=(\\S+)/mig;\n   mpregex.lastIndex = pos1;\n\n   searchinfo = mpregex.exec(str);\n   if (mpregex.lastIndex <= 0) return parts;\n   boundary = searchinfo[1];\n\n   boundaryregex = new RegExp(\"^--\"+boundary+\"(?:\\r\\n|\\n)\", \"mg\");\n   boundaryregex.lastIndex = mpregex.lastIndex;\n\n   searchinfo = boundaryregex.exec(str); // find header top boundary\n   blanklineregex = /(?:\\r\\n|\\n)(?:\\r\\n|\\n)/gm;\n   blanklineregex.lastIndex = boundaryregex.lastIndex;\n   searchinfo = blanklineregex.exec(str); // skip to after blank line\n   if (!searchinfo) return parts;\n   start = blanklineregex.lastIndex;\n   boundaryregex.lastIndex = start;\n   searchinfo = boundaryregex.exec(str); // find end of header\n   if (!searchinfo) return parts;\n   ending = searchinfo.index;\n\n   lines = str.substring(start, ending).split(/\\r\\n|\\n/); // get header as lines\n   for (i=0;i<lines.length;i++) {\n      line=lines[i];\n      p = line.split(\":\");\n      switch (p[0]) {\n         case \"version\":\n            break;\n         case \"part\":\n            partlist.push(p[1]);\n            break;\n         }\n      }\n\n   for (pnum=0; pnum<partlist.length; pnum++) { // get each part\n      blanklineregex.lastIndex = ending;\n      searchinfo = blanklineregex.exec(str); // find blank line ending mime-part header\n      if (!searchinfo) return parts;\n      start = blanklineregex.lastIndex;\n      if (pnum==partlist.length-1) { // last one has different boundary\n         boundaryregex = new RegExp(\"^--\"+boundary+\"--$\", \"mg\");\n         }\n      boundaryregex.lastIndex = start;\n      searchinfo = boundaryregex.exec(str); // find ending boundary\n      if (!searchinfo) return parts;\n      ending = searchinfo.index;\n      parts[partlist[pnum]] = {start: start, end: ending}; // return position within full string\n      }\n\n   return parts;\n\n   }\n\n\n/*\n* SettingsControls\n*\n* Each settings panel has an object in the following form:\n*\n*    {ctrl-name1: {setting: setting-nameA, type: ctrl-type, id: id-component},\n*     ctrl-name2: {setting: setting-nameB, type: ctrl-type, id: id-component, initialdata: optional-initialdata-override},\n*     ...}\n*\n* The ctrl-types are names that correspond to:\n*\n*    SocialCalc.SettingsControls.Controls = {\n*       ctrl-type1: {\n*          SetValue: function(panel-obj, ctrl-name, {def: true/false, val: value}) {...;},\n*          ColorValues: if true, Onchanged converts between hex and RGB\n*          GetValue: function(panel-obj, ctrl-name) {...return {def: true/false, val: value};},\n*          Initialize: function(panel-obj, ctrl-name) {...;}, // used to fill dropdowns, etc.\n*          InitialData: control-dependent, // used by Initialize (if no panel ctrlname.initialdata)\n*          OnReset: function(ctrl-name) {...;}, // called to put down popups, etc.\n*          ChangedCallback: function(ctrl-name) {...;} // if not null, called by control when user changes value\n*       }\n*\n*/\n\nSocialCalc.SettingsControls = {\n   Controls: {},\n   CurrentPanel: null // panel object to search on events\n   };\n\n//\n// SocialCalc.SettingsControlSetCurrentPanel(panel-object)\n//\n\nSocialCalc.SettingsControlSetCurrentPanel = function(panelobj) {\n\n   SocialCalc.SettingsControls.CurrentPanel = panelobj;\n\n   SocialCalc.SettingsControls.PopupChangeCallback({panelobj: panelobj}, \"\", null);\n\n   }\n\n\n//\n// SocialCalc.SettingsControlInitializePanel(panel-object)\n//\n\nSocialCalc.SettingsControlInitializePanel = function(panelobj) {\n\n   var ctrlname;\n   var sc = SocialCalc.SettingsControls;\n\n   for (ctrlname in panelobj) {\n      if (ctrlname==\"name\") continue;\n      ctrl = sc.Controls[panelobj[ctrlname].type];\n      if (ctrl && ctrl.Initialize) ctrl.Initialize(panelobj, ctrlname);\n      }\n\n   }\n\n\n//\n// SocialCalc.SettingsControlLoadPanel(panel-object, attribs)\n//\n\nSocialCalc.SettingsControlLoadPanel = function(panelobj, attribs) {\n\n   var ctrlname;\n   var sc = SocialCalc.SettingsControls;\n\n   for (ctrlname in panelobj) {\n      if (ctrlname==\"name\") continue;\n      ctrl = sc.Controls[panelobj[ctrlname].type];\n      if (ctrl && ctrl.SetValue) ctrl.SetValue(panelobj, ctrlname, attribs[panelobj[ctrlname].setting]);\n      }\n\n   }\n\n//\n// attribs = SocialCalc.SettingsControlUnloadPanel(panel-object)\n//\n\nSocialCalc.SettingsControlUnloadPanel = function(panelobj) {\n\n   var ctrlname;\n   var sc = SocialCalc.SettingsControls;\n   var attribs = {};\n\n   for (ctrlname in panelobj) {\n      if (ctrlname==\"name\") continue;\n      ctrl = sc.Controls[panelobj[ctrlname].type];\n      if (ctrl && ctrl.GetValue) attribs[panelobj[ctrlname].setting] = ctrl.GetValue(panelobj, ctrlname);\n      }\n\n   return attribs;\n\n   }\n\n//\n// SocialCalc.SettingsControls.PopupChangeCallback\n//\n\nSocialCalc.SettingsControls.PopupChangeCallback = function(attribs, id, value) {\n\n   var sc = SocialCalc.Constants;\n\n   var ele = document.getElementById(\"sample-text\");\n\n   if (!ele || !attribs || !attribs.panelobj) return;\n\n   var idPrefix = SocialCalc.CurrentSpreadsheetControlObject.idPrefix;\n\n   var c = attribs.panelobj.name == \"cell\" ? \"c\" : \"\";\n\n   var v, a, parts, str1, str2, i;\n\n   parts = sc.defaultCellLayout.match(/^padding.(\\S+) (\\S+) (\\S+) (\\S+).vertical.align.(\\S+);$/) || [];\n\n   var cv = {color: [\"textcolor\"], backgroundColor: [\"bgcolor\", \"#FFF\"],\n             fontSize: [\"fontsize\", sc.defaultCellFontSize], fontFamily: [\"fontfamily\"],\n             paddingTop: [\"padtop\", parts[1]], paddingRight: [\"padright\", parts[2]],\n             paddingBottom: [\"padbottom\", parts[3]], paddingLeft: [\"padleft\", parts[4]],\n             verticalAlign: [\"alignvert\", parts[5]]};\n\n   for (a in cv) {\n      v = SocialCalc.Popup.GetValue(idPrefix+c+cv[a][0]) || cv[a][1] || \"\";\n      ele.style[a] = v;\n      }\n\n   if (c==\"c\") {\n      cv = {borderTop: \"cbt\", borderRight: \"cbr\", borderBottom: \"cbb\", borderLeft: \"cbl\"};\n      for (a in cv) {\n         v = SocialCalc.SettingsControls.BorderSideGetValue(attribs.panelobj, cv[a]);\n         ele.style[a] = v ? (v.val || \"\") : \"\";\n         }\n      v = SocialCalc.Popup.GetValue(idPrefix+\"calignhoriz\");\n      ele.style.textAlign = v || \"left\";\n      ele.childNodes[1].style.textAlign = v || \"right\";\n      }\n   else {\n      ele.style.border = \"\";\n      v = SocialCalc.Popup.GetValue(idPrefix+\"textalignhoriz\");\n      ele.style.textAlign = v || \"left\";\n      v = SocialCalc.Popup.GetValue(idPrefix+\"numberalignhoriz\");\n      ele.childNodes[1].style.textAlign = v || \"right\";\n      }\n\n   v = SocialCalc.Popup.GetValue(idPrefix+c+\"fontlook\");\n   parts = v ? (v.match(/^(\\S+) (\\S+)$/) || []) : [];\n   ele.style.fontStyle = parts[1] || \"\";\n   ele.style.fontWeight = parts[2] || \"\";\n\n   v = SocialCalc.Popup.GetValue(idPrefix+c+\"formatnumber\") || \"General\";\n   str1 = SocialCalc.FormatNumber.formatNumberWithFormat(9.8765, v, \"\");\n   str2 = SocialCalc.FormatNumber.formatNumberWithFormat(-1234.5, v, \"\");\n   if (str2 != \"??-???-??&nbsp;??:??:??\") { // not bad date from negative number\n      str1 += \"<br>\"+str2;\n      }\n      \n   ele.childNodes[1].innerHTML = str1;\n\n   }\n\n//\n// PopupList Control\n//\n\nSocialCalc.SettingsControls.PopupListSetValue = function(panelobj, ctrlname, value) {\n\n   if (!value) {alert(ctrlname+\" no value\"); return;}\n\n   var sp = SocialCalc.Popup;\n\n   if (!value.def) {\n      sp.SetValue(panelobj[ctrlname].id, value.val);\n      }\n   else {\n      sp.SetValue(panelobj[ctrlname].id, \"\");\n      }\n\n   }\n\n//\n// SocialCalc.SettingsControls.PopupListGetValue\n//\n\nSocialCalc.SettingsControls.PopupListGetValue = function(panelobj, ctrlname) {\n\n   var ctl = panelobj[ctrlname];\n   if (!ctl) return null;\n\n   var value = SocialCalc.Popup.GetValue(ctl.id);\n   if (value) {\n      return {def: false, val: value};\n      }\n   else {\n      return {def: true, val: 0};\n      }\n\n   }\n\n//\n// SocialCalc.SettingsControls.PopupListInitialize\n//\n\nSocialCalc.SettingsControls.PopupListInitialize = function(panelobj, ctrlname) {\n\n   var i, val, pos, otext;\n   var sc = SocialCalc.SettingsControls;\n   var initialdata = panelobj[ctrlname].initialdata || sc.Controls[panelobj[ctrlname].type].InitialData || \"\";\n   initialdata = SocialCalc.LocalizeSubstrings(initialdata);\n   var optionvals = initialdata.split(/\\|/);\n\n   var options = [];\n\n   for (i=0; i<(optionvals.length||0); i++) {\n      val = optionvals[i];\n      pos = val.indexOf(\":\");\n      otext = val.substring(0, pos);\n      if (otext.indexOf(\"\\\\\")!=-1) { // escape any colons\n         otext = otext.replace(/\\\\c/g,\":\");\n         otext = otext.replace(/\\\\b/g,\"\\\\\");\n\n         }\n      otext = SocialCalc.special_chars(otext);\n      if (otext == \"[custom]\") {\n         options[i] = {o: SocialCalc.Constants.s_PopupListCustom, v: val.substring(pos+1), a:{custom: true}};\n         }\n      else if (otext == \"[cancel]\") {\n         options[i] = {o: SocialCalc.Constants.s_PopupListCancel, v: \"\", a:{cancel: true}};\n         }\n      else if (otext == \"[break]\") {\n         options[i] = {o: \"-----\", v: \"\", a:{skip: true}};\n         }\n      else if (otext == \"[newcol]\") {\n         options[i] = {o: \"\", v: \"\", a:{newcol: true}};\n         }\n      else {\n         options[i] = {o: otext, v: val.substring(pos+1)};\n         }\n      }\n\n   SocialCalc.Popup.Create(\"List\", panelobj[ctrlname].id, {});\n   SocialCalc.Popup.Initialize(panelobj[ctrlname].id, \n      {options: options, \n       attribs:{changedcallback: SocialCalc.SettingsControls.PopupChangeCallback, panelobj: panelobj}});\n\n   }\n\n\n//\n// SocialCalc.SettingsControls.PopupListReset\n//\n\nSocialCalc.SettingsControls.PopupListReset = function(ctrlname) {\n\n   SocialCalc.Popup.Reset(\"List\");\n\n   }\n\nSocialCalc.SettingsControls.Controls.PopupList = {\n   SetValue: SocialCalc.SettingsControls.PopupListSetValue,\n   GetValue: SocialCalc.SettingsControls.PopupListGetValue,\n   Initialize: SocialCalc.SettingsControls.PopupListInitialize,\n   OnReset: SocialCalc.SettingsControls.PopupListReset,\n   ChangedCallback: null\n   }\n\n//\n// ColorChooser Control\n//\n\nSocialCalc.SettingsControls.ColorChooserSetValue = function(panelobj, ctrlname, value) {\n\n   if (!value) {alert(ctrlname+\" no value\"); return;}\n\n   var sp = SocialCalc.Popup;\n\n   if (!value.def) {\n      sp.SetValue(panelobj[ctrlname].id, value.val);\n      }\n   else {\n      sp.SetValue(panelobj[ctrlname].id, \"\");\n      }\n\n   }\n\n//\n// SocialCalc.SettingsControls.ColorChooserGetValue\n//\n\nSocialCalc.SettingsControls.ColorChooserGetValue = function(panelobj, ctrlname) {\n\n   var value = SocialCalc.Popup.GetValue(panelobj[ctrlname].id);\n   if (value) {\n      return {def: false, val: value};\n      }\n   else {\n      return {def: true, val: 0};\n      }\n\n   }\n\n//\n// SocialCalc.SettingsControls.ColorChooserInitialize\n//\n\nSocialCalc.SettingsControls.ColorChooserInitialize = function(panelobj, ctrlname) {\n\n   var i, val, pos, otext;\n   var sc = SocialCalc.SettingsControls;\n\n   SocialCalc.Popup.Create(\"ColorChooser\", panelobj[ctrlname].id, {});\n   SocialCalc.Popup.Initialize(panelobj[ctrlname].id,\n      {attribs:{title: \"&nbsp;\", moveable: true, width: \"106px\",\n                changedcallback: SocialCalc.SettingsControls.PopupChangeCallback, panelobj: panelobj}});\n\n   }\n\n\n//\n// SocialCalc.SettingsControls.ColorChooserReset\n//\n\nSocialCalc.SettingsControls.ColorChooserReset = function(ctrlname) {\n\n   SocialCalc.Popup.Reset(\"ColorChooser\");\n\n   }\n\nSocialCalc.SettingsControls.Controls.ColorChooser = {\n   SetValue: SocialCalc.SettingsControls.ColorChooserSetValue,\n   GetValue: SocialCalc.SettingsControls.ColorChooserGetValue,\n   Initialize: SocialCalc.SettingsControls.ColorChooserInitialize,\n   OnReset: SocialCalc.SettingsControls.ColorChooserReset,\n   ChangedCallback: null\n   }\n\n\n//\n// SocialCalc.SettingsControls.BorderSideSetValue\n//\n\nSocialCalc.SettingsControls.BorderSideSetValue = function(panelobj, ctrlname, value) {\n\n   var sc = SocialCalc.SettingsControls;\n   var ele, found, idname, parts;\n   var idstart = panelobj[ctrlname].id;\n\n   if (!value) {alert(ctrlname+\" no value\"); return;}\n\n   ele = document.getElementById(idstart+\"-onoff-bcb\"); // border checkbox\n   if (!ele) return;\n\n   if (value.val) { // border does not use default: it looks only to the value currently\n      ele.checked = true;\n      ele.value = value.val;\n      parts = value.val.match(/(\\S+)\\s+(\\S+)\\s+(\\S.+)/);\n      idname = idstart+\"-color\";\n      SocialCalc.Popup.SetValue(idname, parts[3]);\n      SocialCalc.Popup.SetDisabled(idname, false);\n      }\n   else {\n      ele.checked = false;\n      ele.value = value.val;\n      idname = idstart+\"-color\";\n      SocialCalc.Popup.SetValue(idname, \"\");\n      SocialCalc.Popup.SetDisabled(idname, true);\n      }\n\n   }\n\n//\n// SocialCalc.SettingsControls.BorderSideGetValue\n//\n\nSocialCalc.SettingsControls.BorderSideGetValue = function(panelobj, ctrlname) {\n\n   var sc = SocialCalc.SettingsControls;\n   var ele, value;\n   var idstart = panelobj[ctrlname].id;\n\n   ele = document.getElementById(idstart+\"-onoff-bcb\"); // border checkbox\n   if (!ele) return;\n\n\n   if (ele.checked) { // on\n      value = SocialCalc.Popup.GetValue(idstart+\"-color\");\n      value = \"1px solid \" + (value || \"rgb(0,0,0)\");\n      return {def: false, val: value};\n      }\n   else { // off\n      return {def: false, val: \"\"};\n      }\n\n   }\n\n//\n// SocialCalc.SettingsControls.BorderSideInitialize\n//\n\nSocialCalc.SettingsControls.BorderSideInitialize = function(panelobj, ctrlname) {\n\n   var sc = SocialCalc.SettingsControls;\n   var idstart = panelobj[ctrlname].id;\n\n   SocialCalc.Popup.Create(\"ColorChooser\", idstart+\"-color\", {});\n   SocialCalc.Popup.Initialize(idstart+\"-color\",\n      {attribs:{title: \"&nbsp;\", width: \"106px\", moveable: true,\n                changedcallback: SocialCalc.SettingsControls.PopupChangeCallback, panelobj: panelobj}});\n\n   }\n\n\n//\n// SocialCalc.SettingsControlOnchangeBorder = function(ele)\n//\n\nSocialCalc.SettingsControlOnchangeBorder = function(ele) {\n\n   var idname, value, found, ele2;\n   var sc = SocialCalc.SettingsControls;\n   var panelobj = sc.CurrentPanel;\n\n   var nameparts = ele.id.match(/(^.*\\-)(\\w+)\\-(\\w+)\\-(\\w+)$/);\n   if (!nameparts) return;\n   var prefix = nameparts[1];\n   var ctrlname = nameparts[2];\n   var ctrlsubid = nameparts[3]\n   var ctrlidsuffix = nameparts[4];\n   var ctrltype = panelobj[ctrlname].type;\n\n   switch (ctrlidsuffix) {\n      case \"bcb\": // border checkbox\n         if (ele.checked) {\n            sc.Controls[ctrltype].SetValue(sc.CurrentPanel, ctrlname, {def: false, val: ele.value || \"1px solid rgb(0,0,0)\"});\n            }\n         else {\n            sc.Controls[ctrltype].SetValue(sc.CurrentPanel, ctrlname, {def: false, val: \"\"});\n            }\n         break;\n      }\n\n   }\n\n\nSocialCalc.SettingsControls.Controls.BorderSide = {\n   SetValue: SocialCalc.SettingsControls.BorderSideSetValue,\n   GetValue: SocialCalc.SettingsControls.BorderSideGetValue,\n   OnClick: SocialCalc.SettingsControls.ColorComboOnClick,\n   Initialize: SocialCalc.SettingsControls.BorderSideInitialize,\n   InitialData: {thickness: \"1 pixel:1px\", style: \"Solid:solid\"},\n   ChangedCallback: null\n   }\n\n\nSocialCalc.SettingControlReset = function() {\n\n   var sc = SocialCalc.SettingsControls;\n   var ctrlname;\n\n   for (ctrlname in sc.Controls) {\n      if (sc.Controls[ctrlname].OnReset) sc.Controls[ctrlname].OnReset(ctrlname);\n      }\n   }\n\n\n/**********************\n*\n* CtrlSEditor implementation for editing SocialCalc.OtherSaveParts\n*\n*/\n\nSocialCalc.OtherSaveParts = {}; // holds other parts to save - must be set when loaded if you want to keep\n\nSocialCalc.CtrlSEditor = function(whichpart) {\n\n   var strtoedit, partname;\n   if (whichpart.length > 0) {\n      strtoedit = SocialCalc.special_chars(SocialCalc.OtherSaveParts[whichpart] || \"\");\n      }\n   else {\n      strtoedit = \"Listing of Parts\\n\";\n      for (partname in SocialCalc.OtherSaveParts) {\n         strtoedit += SocialCalc.special_chars(\"\\nPart: \"+partname+\"\\n=====\\n\"+SocialCalc.OtherSaveParts[partname]+\"\\n\");\n         }\n      }\n   var editbox = document.createElement(\"div\");\n   editbox.style.cssText = \"position:absolute;z-index:500;width:300px;height:300px;left:100px;top:200px;border:1px solid black;background-color:#EEE;text-align:center;\";\n   editbox.id = \"socialcalc-editbox\";\n   editbox.innerHTML = whichpart+'<br><br><textarea id=\"socialcalc-editbox-textarea\" style=\"width:250px;height:200px;\">'+\n      strtoedit + '</textarea><br><br><input type=button ' +\n      'onclick=\"SocialCalc.CtrlSEditorDone (\\'socialcalc-editbox\\', \\''+whichpart+'\\');\" value=\"OK\">';\n   document.body.appendChild(editbox);\n\n   var ebta = document.getElementById(\"socialcalc-editbox-textarea\");\n   ebta.focus();\n   SocialCalc.CmdGotFocus(ebta);\n\n   }\n\nSocialCalc.CtrlSEditorDone = function(idprefix, whichpart) {\n\n   var edittextarea = document.getElementById(idprefix+\"-textarea\");\n   var text = edittextarea.value;\n   if (whichpart.length > 0) {\n      if (text.length > 0) {\n         SocialCalc.OtherSaveParts[whichpart] = text;\n         }\n      else {\n         delete SocialCalc.OtherSaveParts[whichpart];\n         }\n      }\n\n   var editbox = document.getElementById(idprefix);\n   SocialCalc.KeyboardFocus();\n   editbox.parentNode.removeChild(editbox);\n\n   }\n\n\n//\n// Workbook is a collection of sheets that are worked upon together\n// \n// The WorkBook class models and manages the collection of sheets\n//\n// Author: Ramu Ramamurthy\n//\n//\n\nvar SocialCalc;\nif (!SocialCalc) {\n   alert(\"Main SocialCalc code module needed\");\n    SocialCalc = {};\n}\n\n// Constructor:\n\nSocialCalc.WorkBook = function(spread) {\n   this.spreadsheet = spread; // this is the spreadsheet control\n      this.defaultsheetname = null;\n   this.sheetArr = {};  // misnomer, this is not really an array\n   this.clipsheet = {}; // for copy paste of sheets\n}\n\n// Methods\n\nSocialCalc.WorkBook.prototype.InitializeWorkBook = function(defaultsheet) {\n   return SocialCalc.InitializeWorkBook(this, defaultsheet);\n}\n\n\nSocialCalc.WorkBook.prototype.AddNewWorkBookSheetNoSwitch = function(sheetid,sheetname, savestr) {return SocialCalc.AddNewWorkBookSheetNoSwitch(this, sheetid,sheetname,savestr);};\nSocialCalc.WorkBook.prototype.AddNewWorkBookSheet = function(sheetname,oldsheetname, fromclip, spread) {return SocialCalc.AddNewWorkBookSheet(this, sheetname,oldsheetname, fromclip, spread);};\nSocialCalc.WorkBook.prototype.ActivateWorkBookSheet = function(sheetname,oldsheetname) {return SocialCalc.ActivateWorkBookSheet(this,sheetname,oldsheetname);};\nSocialCalc.WorkBook.prototype.DeleteWorkBookSheet = function(sheetname,cursheetname) {return SocialCalc.DeleteWorkBookSheet(this,sheetname,cursheetname);};\nSocialCalc.WorkBook.prototype.SaveWorkBookSheet = function(sheetid) {return SocialCalc.SaveWorkBookSheet(this, sheetid);};\nSocialCalc.WorkBook.prototype.LoadRenameWorkBookSheet = function(sheetid, savestr, newname) {return SocialCalc.LoadRenameWorkBookSheet(this, sheetid, savestr, newname);};\nSocialCalc.WorkBook.prototype.RenameWorkBookSheet = function(oldname, newname, sheetid) {return SocialCalc.RenameWorkBookSheet(this, oldname, newname, sheetid);};\nSocialCalc.WorkBook.prototype.CopyWorkBookSheet = function(sheetid) {return SocialCalc.CopyWorkBookSheet(this, sheetid);};\nSocialCalc.WorkBook.prototype.PasteWorkBookSheet = function(newid, oldid) {return SocialCalc.PasteWorkBookSheet(this, newid, oldid);};\nSocialCalc.WorkBook.prototype.RenderWorkBookSheet = function() {return SocialCalc.RenderWorkBookSheet(this);};\n\nSocialCalc.WorkBook.prototype.SheetNameExistsInWorkBook = function(name) {\n    return SocialCalc.SheetNameExistsInWorkBook(this,name);\n}\n\nSocialCalc.WorkBook.prototype.WorkbookScheduleCommand = function(cmd, isremote) {\n    return SocialCalc.WorkbookScheduleCommand(this, cmd, isremote);\n    };\n\nSocialCalc.WorkBook.prototype.WorkbookScheduleSheetCommand = function(cmd, isremote) {\n    return SocialCalc.WorkbookScheduleSheetCommand(this, cmd, isremote);\n    };\n\n// schedule some command - could be for sheet or for the workbook itself\nSocialCalc.WorkbookScheduleCommand = function WorkbookScheduleCommand(workbook, cmd, isremote) {\n    \n    //console.log(\"cmd \", cmd.cmdstr, cmd.cmdtype);\n\n    if (cmd.cmdtype == \"scmd\") {\n   workbook.WorkbookScheduleSheetCommand(cmd, isremote);\n    }\n}\n\nSocialCalc.WorkbookScheduleSheetCommand = function WorkbookScheduleSheetCommand(workbook, cmd, isremote) {\n    //console.log(cmd.cmdtype,cmd.id,cmd.cmdstr);\n  \n    // check if sheet exists first\n    if (workbook.sheetArr[cmd.id]) {\n   workbook.sheetArr[cmd.id].sheet.ScheduleSheetCommands(\n       cmd.cmdstr,\n       cmd.saveundo,\n       isremote);\n    }\n};\n\n\nSocialCalc.InitializeWorkBook = function InitializeWorkBook(workbook, defaultsheet) {\n\n      workbook.defaultsheetname = defaultsheet;\n   \n   var spreadsheet = workbook.spreadsheet;\n   var defaultsheetname = workbook.defaultsheetname;\n   \n    // Initialize the Spreadsheet Control and display it\n\n   SocialCalc.Formula.SheetCache.sheets[defaultsheetname] = {sheet: spreadsheet.sheet, name: defaultsheetname}; \n\n        spreadsheet.sheet.sheetid = defaultsheetname;\n        spreadsheet.sheet.sheetname = defaultsheetname;\n\n      workbook.sheetArr[defaultsheetname] = {};\n      workbook.sheetArr[defaultsheetname].sheet = spreadsheet.sheet;\n      workbook.sheetArr[defaultsheetname].context = spreadsheet.context;\n   \n   // if these were properties of the sheet, then we wouldnt need to do this !\n      workbook.sheetArr[defaultsheetname].editorprop = {};\n      workbook.sheetArr[defaultsheetname].editorprop.ecell = null;\n      workbook.sheetArr[defaultsheetname].editorprop.range = null;\n      workbook.sheetArr[defaultsheetname].editorprop.range2 = null;\n   \n   workbook.clipsheet.savestr = null;\n   workbook.clipsheet.copiedfrom = null;\n   workbook.clipsheet.editorprop = {};\n\n   spreadsheet.editor.workingvalues.currentsheet = spreadsheet.sheet.sheetname;\n   spreadsheet.editor.workingvalues.startsheet = spreadsheet.editor.workingvalues.currentsheet;\n        spreadsheet.editor.workingvalues.currentsheetid = spreadsheet.sheet.sheetid;\n   \n}\n\nSocialCalc.AddNewWorkBookSheetNoSwitch = function AddNewWorkBookSheetNoSwitch(workbook, sheetid, sheetname, savestr) {\n\n   //alert(sheetid+\",\"+sheetname+\",\"+savestr);\n   \n   var spreadsheet = workbook.spreadsheet;\n   \n   var newsheet = new SocialCalc.Sheet();\n   \n   SocialCalc.Formula.SheetCache.sheets[sheetname] = {\n      sheet: newsheet,\n      name: sheetname\n   };\n\n   newsheet.sheetid = sheetid;\n   newsheet.sheetname = sheetname;\n\n        if (savestr) {\n       newsheet.ParseSheetSave(savestr);\n   }\n   \n   workbook.sheetArr[sheetid] = {};\n   workbook.sheetArr[sheetid].sheet = newsheet;\n   workbook.sheetArr[sheetid].context = null;\n\n   if (workbook.sheetArr[sheetid].sheet.attribs) {\n       workbook.sheetArr[sheetid].sheet.attribs.needsrecalc = \"yes\";\n   }\n   \n   workbook.sheetArr[sheetid].editorprop = {};\n   workbook.sheetArr[sheetid].editorprop.ecell = {\n         coord: \"A1\",\n         row: 1,\n         col: 1\n      };\n   workbook.sheetArr[sheetid].editorprop.range = null;\n   workbook.sheetArr[sheetid].editorprop.range2 = null;\n   \n}\n\nSocialCalc.AddNewWorkBookSheet = function AddNewWorkBookSheet(workbook, sheetid, oldsheetid, fromclip, spread){\n\n   var spreadsheet = workbook.spreadsheet;\n   \n   //alert(\"create new sheet \"+sheetid+\" old=\"+oldsheetid+\" def=\"+workbook.defaultsheetname);\n   \n   if (spread == null) {\n      spreadsheet.sheet = new SocialCalc.Sheet();\n      SocialCalc.Formula.SheetCache.sheets[sheetid] = {\n         sheet: spreadsheet.sheet,\n         name: sheetid\n      }\n           spreadsheet.sheet.sheetid = sheetid;\n      spreadsheet.sheet.sheetname = sheetid;\n   }\n   else {\n      //alert(\"existing spread\")\n      spreadsheet.sheet = spread\n   }\n\n   spreadsheet.context = new SocialCalc.RenderContext(spreadsheet.sheet);\n   \n   spreadsheet.sheet.statuscallback = SocialCalc.EditorSheetStatusCallback;\n   spreadsheet.sheet.statuscallbackparams = spreadsheet.editor;\n   \n   workbook.sheetArr[sheetid] = {};\n   workbook.sheetArr[sheetid].sheet = spreadsheet.sheet;\n   workbook.sheetArr[sheetid].context = spreadsheet.context;\n   \n   workbook.sheetArr[sheetid].editorprop = {};\n   workbook.sheetArr[sheetid].editorprop.ecell = null;\n   workbook.sheetArr[sheetid].editorprop.range = null;\n   workbook.sheetArr[sheetid].editorprop.range2 = null;\n   \n   if (oldsheetid != null) {\n      workbook.sheetArr[oldsheetid].editorprop.ecell = spreadsheet.editor.ecell;\n      workbook.sheetArr[oldsheetid].editorprop.range = spreadsheet.editor.range;\n      workbook.sheetArr[oldsheetid].editorprop.range2 = spreadsheet.editor.range2;\n   }\n   \n   \n   spreadsheet.context.showGrid = true;\n   spreadsheet.context.showRCHeaders = true;\n   spreadsheet.editor.context = spreadsheet.context;\n   \n   if (!fromclip) {\n      spreadsheet.editor.ecell = {\n         coord: \"A1\",\n         row: 1,\n         col: 1\n      };\n      \n      spreadsheet.editor.range = {\n         hasrange: false\n      };\n      spreadsheet.editor.range2 = {\n         hasrange: false\n      };\n   }\n   \n   // set highlights\n   spreadsheet.context.highlights[spreadsheet.editor.ecell.coord] = \"cursor\";\n   \n   if (fromclip) {\n      // this is the result of a paste sheet\n      //alert(\"from clip\");\n      \n      if (workbook.clipsheet.savestr != null) {\n         //alert(\"sheetdata = \"+workbook.clipsheet.savestr);\n         spreadsheet.sheet.ParseSheetSave(workbook.clipsheet.savestr);\n      }\n      \n      spreadsheet.editor.ecell = workbook.clipsheet.editorprop.ecell;\n      spreadsheet.context.highlights[spreadsheet.editor.ecell.coord] = \"cursor\";\n      \n      // range is not pasted ??!??\n   \n   }\n\n   spreadsheet.editor.workingvalues.currentsheet = spreadsheet.sheet.sheetname;\n   spreadsheet.editor.workingvalues.startsheet = spreadsheet.editor.workingvalues.currentsheet;\n        spreadsheet.editor.workingvalues.currentsheetid = spreadsheet.sheet.sheetid;\n\n   spreadsheet.editor.FitToEditTable();\n   spreadsheet.editor.ScheduleRender();\n   //spreadsheet.ExecuteCommand('recalc', '');\n   \n}\n\nSocialCalc.ActivateWorkBookSheet = function ActivateWorkBookSheet(workbook, sheetnamestr, oldsheetnamestr) {\n\n   var spreadsheet = workbook.spreadsheet;\n   \n   //alert(\"activate \"+sheetnamestr+\" old=\"+oldsheetnamestr);\n   \n   spreadsheet.sheet = workbook.sheetArr[sheetnamestr].sheet;\n   spreadsheet.context = workbook.sheetArr[sheetnamestr].context;\n\n   if (spreadsheet.context == null) {\n      //alert(\"context null\")\n      //for (var sheet in workbook.sheetArr) alert(sheet+spreadsheet.sheet )\n      workbook.AddNewWorkBookSheet(sheetnamestr, oldsheetnamestr, false, spreadsheet.sheet)\n      return\n   }\n\n   spreadsheet.editor.context = spreadsheet.context;\n\n   if (oldsheetnamestr != null) {\n      workbook.sheetArr[oldsheetnamestr].editorprop.ecell = spreadsheet.editor.ecell;\n   }\n   spreadsheet.editor.ecell = workbook.sheetArr[sheetnamestr].editorprop.ecell;\n   \n   if (oldsheetnamestr != null) {\n      workbook.sheetArr[oldsheetnamestr].editorprop.range = spreadsheet.editor.range;\n   }\n   spreadsheet.editor.range = workbook.sheetArr[sheetnamestr].editorprop.range;\n            \n   if (oldsheetnamestr != null) {\n      workbook.sheetArr[oldsheetnamestr].editorprop.range2 = spreadsheet.editor.range2;\n   }\n   spreadsheet.editor.range2 = workbook.sheetArr[sheetnamestr].editorprop.range2;\n\n   spreadsheet.sheet.statuscallback = SocialCalc.EditorSheetStatusCallback;\n    spreadsheet.sheet.statuscallbackparams = spreadsheet.editor;\n               \n   // reset highlights ??\n   \n   //spreadsheet.editor.FitToEditTable();             \n\n   spreadsheet.editor.workingvalues.currentsheet = spreadsheet.sheet.sheetname;\n        spreadsheet.editor.workingvalues.currentsheetid = spreadsheet.sheet.sheetid;\n\n   if (spreadsheet.editor.state!=\"start\" && spreadsheet.editor.inputBox) \n     spreadsheet.editor.inputBox.element.focus();\n\n   if (spreadsheet.editor.state == \"start\") {\n       spreadsheet.editor.workingvalues.startsheet = spreadsheet.editor.workingvalues.currentsheet;\n   }\n   \n   //spreadsheet.editor.ScheduleRender();\n   \n        if (spreadsheet.editor.state != \"start\" && spreadsheet.editor.inputBox) {\n       spreadsheet.editor.ScheduleRender();\n   } else {\n       if (spreadsheet.sheet.attribs) {\n         spreadsheet.sheet.attribs.needsrecalc = \"yes\";\n       } else {\n         spreadsheet.sheet.attribs = {}\n         spreadsheet.sheet.attribs.needsrecalc = \"yes\";\n       }\n\n       spreadsheet.ExecuteCommand('redisplay','');\n   } \n\n   \n}   \n\nSocialCalc.DeleteWorkBookSheet = function DeleteWorkBookSheet(workbook, oldname, curname) {\n   \n   //alert(\"delete \"+oldname+\",\"+curname);\n   \n   delete workbook.sheetArr[oldname].context;\n   delete workbook.sheetArr[oldname].sheet;\n   delete workbook.sheetArr[oldname];\n   // take sheet out of the formula cache\n   delete SocialCalc.Formula.SheetCache.sheets[curname];\n}\n\n\nSocialCalc.SaveWorkBookSheet = function CreateSaveWorkBook(workbook, sheetid) {\n   var sheetstr = {}\n   sheetstr.savestr = workbook.sheetArr[sheetid].sheet.CreateSheetSave();\n   return sheetstr;\n} \n\nSocialCalc.LoadRenameWorkBookSheet = function LoadRenameWorkBookSheet(workbook, sheetid, savestr, newname) {\n   \n   workbook.sheetArr[sheetid].sheet.ResetSheet();\n   workbook.sheetArr[sheetid].sheet.ParseSheetSave(savestr);\n\n   if (workbook.sheetArr[sheetid].sheet.attribs) {\n       workbook.sheetArr[sheetid].sheet.attribs.needsrecalc = \"yes\";\n   }\n   \n   delete SocialCalc.Formula.SheetCache.sheets[workbook.sheetArr[sheetid].sheet.sheetname];\n   workbook.sheetArr[sheetid].sheet.sheetname = newname;\n   SocialCalc.Formula.SheetCache.sheets[newname] = {sheet: workbook.sheetArr[sheetid].sheet, name: newname};\n}\n\nSocialCalc.RenderWorkBookSheet = function RenderWorkBookSheet(workbook) {\n   workbook.spreadsheet.editor.ScheduleRender();\n}\n\nSocialCalc.RenameWorkBookSheetCell = function(formula, oldname, newname) {\n   var ttype, ttext, i, newcr;\n      var updatedformula = \"\";\n      var sheetref = false;\n      var scf = SocialCalc.Formula;\n      if (!scf) {\n         return \"Need SocialCalc.Formula\";\n    }\n      var tokentype = scf.TokenType;\n      var token_op = tokentype.op;\n      var token_string = tokentype.string;\n      var token_coord = tokentype.coord;\n      var tokenOpExpansion = scf.TokenOpExpansion;\n\n      var parseinfo = SocialCalc.Formula.ParseFormulaIntoTokens(formula);\n\n      for (i = 0; i < parseinfo.length; i++) {\n         ttype = parseinfo[i].type;\n         ttext = parseinfo[i].text;\n      //alert(ttype+\",\"+ttext);\n      //console.log (scf.NormalizeSheetName(ttext) + \"   \" + oldname);\n      if ((ttype == tokentype.name) && (scf.NormalizeSheetName(ttext) == oldname) && (i < parseinfo.length)) {\n            if ((parseinfo[i + 1].type == token_op) && (parseinfo[i + 1].text == \"!\")) {\n            updatedformula += newname;//console.log (updatedformula);\n         } else {\n            updatedformula += ttext;//console.log (updatedformula);\n         }\n      } else {\n         updatedformula += ttext;\n      }\n      }\n   //alert(updatedformula);\n   return updatedformula;\n}\n\nSocialCalc.RenameWorkBookSheet = function RenameWorkBookSheet(workbook, oldname, newname, sheetid) {\n\n   // for each sheet, fix up all the formula references\n   //\n   //alert (sheetid);\n   var oldsheet = SocialCalc.Formula.SheetCache.sheets[oldname].sheet;\n   delete SocialCalc.Formula.SheetCache.sheets[oldname];\n   //alert (newname); // to check the newname\n   SocialCalc.Formula.SheetCache.sheets[newname] = {sheet: oldsheet, name: newname};\n   workbook.sheetArr[sheetid].sheet.sheetname = newname\n   //\n   // fix up formulas for sheet rename\n   // if formulas should not be fixed up upon sheet rename, then comment out the following\n   // block\n   //\n   for (var sheet in workbook.sheetArr) {\n      //alert(\"found sheet-\"+sheet)\n      for (var cr in workbook.sheetArr[sheet].sheet.cells) { // update cell references to sheet name\n         //alert(cr);\n         var cell = workbook.sheetArr[sheet].sheet.cells[cr];\n         //if (cell) alert(cell.datatype)\n         if (cell && cell.datatype == \"f\") {\n            cell.formula = SocialCalc.RenameWorkBookSheetCell(cell.formula, oldname, newname);\n            if (cell.parseinfo) {\n               delete cell.parseinfo;\n            }\n         }\n      }\n   }\n   // recalculate\n   workbook.spreadsheet.ExecuteCommand('recalc', '');\n}\n\nSocialCalc.CopyWorkBookSheet = function CopyWorkBookSheet(workbook, sheetid) {\n\n   //alert(\"in copy \"+sheetid);\n    workbook.clipsheet.savestr = workbook.sheetArr[sheetid].sheet.CreateSheetSave();\n   //alert(\"in copy save=\"+workbook.clipsheet.savestr);\n    workbook.clipsheet.copiedfrom = sheetid;\n    workbook.clipsheet.editorprop = {};\n    workbook.clipsheet.editorprop.ecell = workbook.spreadsheet.editor.ecell;\n    //workbook.clipsheet.editorprop.range = workbook.spreadsheet.editor.range;\n   //workbook.clipsheet.editorprop.range2 = workbook.spreadsheet.editor.range2;\n   //workbook.clipsheet.highlights = workbook.spreadsheet.context.highlights;\n   \n   //alert(\"copied \"+sheetid);\n}\n\nSocialCalc.PasteWorkBookSheet = function PasteWorkBookSheet(workbook, newsheetid, oldsheetid) {\n   \n   //alert(newsheetid+oldsheetid);\n   workbook.AddNewWorkBookSheet(newsheetid, oldsheetid, true);\n   \n   // clear the clip ?\n   \n}\n\n\nSocialCalc.SheetNameExistsInWorkBook = function SheetNameExistsInWorkBook(workbook, name) {\n    for (var sheet in workbook.sheetArr) {    \n   if (workbook.sheetArr[sheet].sheet.sheetname == name) {\n       return sheet;\n   }\n    }\n    return null;\n}\n\n//\n// Workbook Control controls workbook actions (add/del/rename etc) and can appear at the\n// bottom of the screen (?). Right now its just a proof of concept \n// and appears at the top of the screen\n//\n// Author: Ramu Ramamurthy\n//\n//\n\nvar SocialCalc;\nif (!SocialCalc) {\n   alert(\"Main SocialCalc code module needed\");\n   SocialCalc = {};\n}\n\nSocialCalc.CurrentWorkbookControlObject = null; \n\nSocialCalc.TestWorkBookSaveStr = \"\";\n\n\n// Constructor:\n\nSocialCalc.WorkBookControl = function(book, divid, defaultsheetname) {\n\n   this.workbook = book;\n   this.div = divid;\n   this.defaultsheetname = defaultsheetname;\n   this.sheetButtonArr = {};\n   this.sheetCnt = 0;\n   this.numSheets = 0;\n   this.currentSheetButton = null;\n   this.renameDialogId = \"sheetRenameDialog\";\n   this.deleteDialogId = \"sheetDeleteDialog\";\n   this.hideDialogId   = \"sheetHideDialog\";\n   this.unhideDialogId = \"sheetUnhideDialog\";\n   \n   this.sheetshtml = '<div id=\"fooBar\" style=\"background-color:#80A9F3;display:none\"></div>';\n   \n//this.buttonshtml = \n//'<form>'+\n//'<div id=\"workbookControls\" style=\"padding:6px;background-color:#80A9F3;\">'+\n//'<input type=\"button\" value=\"add sheet\" onclick=\"SocialCalc.WorkBookControlAddSheet(true)\" class=\"smaller\">'+\n//'<input type=\"button\" value=\"delete sheet\" onclick=\"SocialCalc.WorkBookControlDelSheet()\" class=\"smaller\">'+\n//'<input type=\"button\" value=\"rename sheet\" onclick=\"SocialCalc.WorkBookControlRenameSheet()\" class=\"smaller\">'+\n\n// '<input type=\"button\" value=\"save workbook\" onclick=\"SocialCalc.WorkBookControlSaveSheet()\" class=\"smaller\">'+\n// '<input type=\"button\" value=\"new workbook\" onclick=\"SocialCalc.WorkBookControlNewBook()\" class=\"smaller\">'+\n// '<input type=\"button\" value=\"load workbook\" onclick=\"SocialCalc.WorkBookControlLoad()\" class=\"smaller\">'+\n\n//'<input type=\"button\" value=\"copy sheet\" onclick=\"SocialCalc.WorkBookControlCopySheet()\" class=\"smaller\">'+\n//'<input type=\"button\" value=\"paste sheet\" onclick=\"SocialCalc.WorkBookControlPasteSheet()\" class=\"smaller\">'+\n//'</div>'+\n//'</form>';\n\n   SocialCalc.CurrentWorkbookControlObject = this;\n   this.sheetbar = new SocialCalc.SheetBar();\n}\n\n// methods\nSocialCalc.WorkBookControl.prototype.GetCurrentWorkBookControl = function() {return SocialCalc.GetCurrentWorkBookControl();};\nSocialCalc.WorkBookControl.prototype.InitializeWorkBookControl = function() {return SocialCalc.InitializeWorkBookControl(this);};\n\n\nSocialCalc.WorkBookControl.prototype.ExecuteWorkBookControlCommand = function(cmd, isremote) {\n   return SocialCalc.ExecuteWorkBookControlCommand(this, cmd, isremote);\n}\n\nSocialCalc.ExecuteWorkBookControlCommand = function(control, cmd, isremote) {\n   //console.log(\"cmd \", cmd.cmdstr, cmd.cmdtype);\n\n   //if (!isremote) {\n   // return;\n   //}\n\n   if (cmd.cmdtype == \"scmd\") {\n   // dispatch a sheet command\n   control.workbook.WorkbookScheduleCommand(cmd, isremote);\n   return;\n   \n   }\n   \n   if (cmd.cmdtype != \"wcmd\") {\n   return;\n   }\n\n   var parseobj = new SocialCalc.Parse(cmd.cmdstr);\n   \n   var cmd1 = parseobj.NextToken();\n\n   switch (cmd1) {\n   case \"addsheet\":\n   SocialCalc.WorkBookControlAddSheetRemote(null);\n   break;\n   \n   case \"addsheetstr\":\n   var sheetstr = cmd.sheetstr;  \n   SocialCalc.WorkBookControlAddSheetRemote(sheetstr);\n   break;\n\n   case \"delsheet\":\n   var sheetid = parseobj.NextToken();\n   SocialCalc.WorkBookControlDelSheetRemote(sheetid);\n   break;\n\n   case \"rensheet\":\n   var sheetid = parseobj.NextToken();\n   var oldname = parseobj.NextToken();\n   var newname = parseobj.NextToken(); \n   SocialCalc.WorkBookControlRenameSheetRemote(sheetid, oldname, newname);\n   break;\n\n   case \"activatesheet\":\n   var sheetid = parseobj.NextToken();\n   SocialCalc.WorkBookControlActivateSheet(sheetid);\n   break;\n   \n   case \"hidesheet\":\n   var sheetid = parseobj.NextToken();\n   \n   break;\n   \n   case \"unhidesheet\":\n   var sheetid = parseobj.NextToken();\n   \n   break;\n   }\n}\n\nSocialCalc.GetCurrentWorkBookControl = function() {\n   return SocialCalc.CurrentWorkbookControlObject;\n}\n\nSocialCalc.InitializeWorkBookControl = function(control) {\n   var element = document.createElement(\"div\");\n   element.innerHTML = control.sheetshtml;\n   var foo = document.getElementById(control.div);\n   foo.appendChild(element);\n   //var element2 = document.createElement(\"div\");\n   //element2.innerHTML = control.buttonshtml;\n   //foo.appendChild(element2);\n   SocialCalc.WorkBookControlAddSheet(false); // this is for the default sheet\n}\n\nSocialCalc.WorkBookControlDelSheetRemote = function(sheetid) {\n\n   var control = SocialCalc.GetCurrentWorkBookControl();\n   if (sheetid == control.currentSheetButton.id) {\n   // the active sheet is being deleted\n   SocialCalc.WorkBookControlDelSheet();\n   return;\n   }\n   // some non active sheet is being deleted\n   var foo = document.getElementById(\"fooBar\");\n   var deletedbutton = document.getElementById(sheetid);\n   \n   var did = deletedbutton.id;\n   var dname = deletedbutton.value;\n   delete control.sheetButtonArr[did];\n      \n   foo.removeChild(deletedbutton);\n   var sheetbar = document.getElementById(\"SocialCalc-sheetbar-buttons\");\n   var sheetbarbutton = document.getElementById(\"sbsb-\"+did);\n   // unregister with mouse ? etc\n   sheetbar.removeChild(sheetbarbutton);\n\n\n   // delete the sheet\n   control.workbook.DeleteWorkBookSheet(did, dname);\n   control.numSheets = control.numSheets-1;\n   \n}\n\n// assumes that the current active sheet is being deleted\nSocialCalc.WorkBookControlDelSheet = function() {\n\n   var control = SocialCalc.GetCurrentWorkBookControl();\n   if (control.workbook.spreadsheet.editor.state != \"start\") {\n   // if in edit mode return\n   return;\n   }\nif (control.numSheets == 1) {          //disallow this\n   var str = '<div style=\"padding:6px 0px 4px 6px;\">'+\n      '<span>'+'<b> A workbook must contain at least one worksheet </b>' + '</span><br/><br/>';\n   str +='<span>To delete the selected sheet, you must first insert a new sheet. </span><br/></div>';\nstr +='<div style=\"width:380px;text-align:right;padding:6px 0px 4px 6px;font-size:small;\">'+\n      '<input type=\"button\" value=\"Ok\" style=\"font-size:smaller;\" onclick=\"SocialCalc.WorkBookControlDeleteSheetHide();\"></div>';\n   var main = document.createElement(\"div\");\nmain.id = control.deleteDialogId;\n\nmain.style.position = \"absolute\";\n\nvar vp = SocialCalc.GetViewportInfo();\n\nmain.style.top = (vp.height/3)+\"px\";\nmain.style.left = (vp.width/3)+\"px\";\nmain.style.zIndex = 100;\nmain.style.backgroundColor = \"#FFF\";\nmain.style.border = \"1px solid black\";\n\nmain.style.width = \"400px\";\n\nmain.innerHTML = '<table cellspacing=\"0\" cellpadding=\"0\" style=\"border-bottom:1px solid black;\"><tr>'+\n   '<td style=\"font-size:10px;cursor:default;width:100%;background-color:#999;color:#FFF;\">'+\"&nbsp;\"+'</td>'+\n   '<td style=\"font-size:10px;cursor:default;color:#666;\" onclick=\"SocialCalc.WorkBookControlDeleteSheetHide();\">&nbsp;X&nbsp;</td></tr></table>'+\n   '<div style=\"background-color:#DDD;\">'+str+'</div>';\n\n   //alert(main.innerHTML);\n\nSocialCalc.DragRegister(main.firstChild.firstChild.firstChild.firstChild, true, true, {MouseDown: SocialCalc.DragFunctionStart, MouseMove: SocialCalc.DragFunctionPosition,\n            MouseUp: SocialCalc.DragFunctionPosition,\n            Disabled: null, positionobj: main});\n\ncontrol.workbook.spreadsheet.spreadsheetDiv.appendChild(main);\n   return;\n   }\n\n   \n   // do a popup to reaffirm the deletion of the sheet\n   // the popup has two buttons : Confirm and Cancel\nvar element = document.getElementById(control.deleteDialogId);\nif (element) return;\n\nvar currentsheet = control.currentSheetButton.value;\nvar str = '<div style=\"padding:6px 0px 4px 6px;\">'+\n      '<span>'+ '<b>The selected sheet will be permanently deleted.</b>'+ '</span><br/>';\nstr +='<span><ul>';\n   str +='<li> To delete the selected sheet, click OK.</li>';\n   str +='<li> To cancel the deletion, click cancel.</li>';\nstr+='</ul></span></div>';\nstr +='<div style=\"width:380px;text-align:right;padding:6px 0px 4px 6px;font-size:small;\">'+\n      '<input type=\"button\" value=\"Cancel\" style=\"font-size:smaller;\" onclick=\"SocialCalc.WorkBookControlDeleteSheetHide();\">&nbsp;'+\n      '<input type=\"button\" value=\"OK\" style=\"font-size:smaller;\" onclick=\"SocialCalc.WorkBookControlDeleteSheetSubmit();\"></div>';\n\nvar main = document.createElement(\"div\");\nmain.id = control.deleteDialogId;\n\nmain.style.position = \"absolute\";\n\nvar vp = SocialCalc.GetViewportInfo();\n\nmain.style.top = (vp.height/3)+\"px\";\nmain.style.left = (vp.width/3)+\"px\";\nmain.style.zIndex = 100;\nmain.style.backgroundColor = \"#FFF\";\nmain.style.border = \"1px solid black\";\n\nmain.style.width = \"400px\";\n\nmain.innerHTML = '<table cellspacing=\"0\" cellpadding=\"0\" style=\"border-bottom:1px solid black;\"><tr>'+\n   '<td style=\"font-size:10px;cursor:default;width:100%;background-color:#999;color:#FFF;\">'+\"&nbsp;\"+'</td>'+\n   '<td style=\"font-size:10px;cursor:default;color:#666;\" onclick=\"SocialCalc.WorkBookControlDeleteSheetHide();\">&nbsp;X&nbsp;</td></tr></table>'+\n   '<div style=\"background-color:#DDD;\">'+str+'</div>';\n\n   //alert(main.innerHTML);\n\nSocialCalc.DragRegister(main.firstChild.firstChild.firstChild.firstChild, true, true, {MouseDown: SocialCalc.DragFunctionStart, MouseMove: SocialCalc.DragFunctionPosition,\n            MouseUp: SocialCalc.DragFunctionPosition,\n            Disabled: null, positionobj: main});\n\ncontrol.workbook.spreadsheet.spreadsheetDiv.appendChild(main);\n}\n\nSocialCalc.WorkBookControlDeleteSheetHide = function(){\n\nvar control = SocialCalc.GetCurrentWorkBookControl();\nvar spreadsheet = control.workbook.spreadsheet;\n\nvar ele = document.getElementById(control.deleteDialogId);\nele.innerHTML = \"\";\n\nSocialCalc.DragUnregister(ele);\n\nSocialCalc.KeyboardFocus();\n\nif (ele.parentNode) {\n   ele.parentNode.removeChild(ele);\n}\n}\n\nSocialCalc.WorkBookControlDeleteSheetSubmit = function() {\n\n      var control = SocialCalc.GetCurrentWorkBookControl();\n      SocialCalc.WorkBookControlDeleteSheetHide();\n      var foo = document.getElementById(\"fooBar\");\n      var current = document.getElementById(control.currentSheetButton.id);\n      \n      var name = current.id;\n      var curname = control.currentSheetButton.value;\n      delete control.sheetButtonArr[name];\n      \n      foo.removeChild(current);\n         \n      var sheetbar = document.getElementById(\"SocialCalc-sheetbar-buttons\");\n      var sheetbarbutton = document.getElementById(\"sbsb-\"+current.id);\n      // unregister with mouse ? etc\n      sheetbar.removeChild(sheetbarbutton);\n\n      control.currentSheetButton = null;\n      // delete the sheets\n      control.workbook.DeleteWorkBookSheet(name, curname);\n      control.numSheets = control.numSheets-1;\n\n      var cmdstr = \"delsheet \"+name;\n      SocialCalc.Callbacks.broadcast('execute', { cmdtype:\"wcmd\", id:\"0\", cmdstr: cmdstr});\n   \n      // reset current sheet\n      for (var sheet in control.sheetButtonArr) {\n      if (sheet != null) {\n         control.currentSheetButton = control.sheetButtonArr[sheet];\n         control.currentSheetButton.setAttribute(\"style\",\"background-color:lightgreen\");\n            SocialCalc.SheetBarButtonActivate(control.currentSheetButton.id, true)\n         break;\n      }\n   }\n   if (control.currentSheetButton != null) {\n      control.workbook.ActivateWorkBookSheet(control.currentSheetButton.id, null);\n   }\n}\n\n// assumes that the current active sheet is being hidden\nSocialCalc.WorkBookControlHideSheet = function() {\n\n      var control = SocialCalc.GetCurrentWorkBookControl();\n\n      var control = SocialCalc.GetCurrentWorkBookControl();\n      if (control.workbook.spreadsheet.editor.state != \"start\") {\n      // if in edit mode return\n      return;\n      }\n      if (control.numSheets == 1) {          //disallow this\n      var str = '<div style=\"padding:6px 0px 4px 6px;\">'+\n         '<span>'+'<b> A workbook must contain at least one worksheet </b>' + '</span><br/><br/>';\n      str +='<span>Before hiding the selected sheet, you must first insert a new sheet. </span><br/></div>';\n      str +='<div style=\"width:380px;text-align:right;padding:6px 0px 4px 6px;font-size:small;\">'+\n         '<input type=\"button\" value=\"Ok\" style=\"font-size:smaller;\" onclick=\"SocialCalc.WorkBookControlHideSheetHide();\"></div>';\n      var main = document.createElement(\"div\");\n      main.id = control.hideDialogId;\n\n   main.style.position = \"absolute\";\n\n   var vp = SocialCalc.GetViewportInfo();\n\n   main.style.top = (vp.height/3)+\"px\";\n   main.style.left = (vp.width/3)+\"px\";\n   main.style.zIndex = 100;\n   main.style.backgroundColor = \"#FFF\";\n   main.style.border = \"1px solid black\";\n\n   main.style.width = \"400px\";\n\n   main.innerHTML = '<table cellspacing=\"0\" cellpadding=\"0\" style=\"border-bottom:1px solid black;\"><tr>'+\n      '<td style=\"font-size:10px;cursor:default;width:100%;background-color:#999;color:#FFF;\">'+\"&nbsp;\"+'</td>'+\n      '<td style=\"font-size:10px;cursor:default;color:#666;\" onclick=\"SocialCalc.WorkBookControlHideSheetHide();\">&nbsp;X&nbsp;</td></tr></table>'+\n      '<div style=\"background-color:#DDD;\">'+str+'</div>';\n\n      //alert(main.innerHTML);\n\n   SocialCalc.DragRegister(main.firstChild.firstChild.firstChild.firstChild, true, true, {MouseDown: SocialCalc.DragFunctionStart, MouseMove: SocialCalc.DragFunctionPosition,\n               MouseUp: SocialCalc.DragFunctionPosition,\n               Disabled: null, positionobj: main});\n\n   control.workbook.spreadsheet.spreadsheetDiv.appendChild(main);\n      return;\n      }\n\n      \n      // do a popup to reaffirm the hiding of the sheet\n      // the popup has two buttons : Confirm and Cancel\n   var element = document.getElementById(control.hideDialogId);\n   if (element) return;\n\n   var currentsheet = control.currentSheetButton.value;\n   var str = '<div style=\"padding:6px 0px 4px 6px;\">'+\n         '<span>'+ '<b>The selected sheet will be hidden.</b>'+ '</span><br/>';\n   str +='<span><ul>';\n      str +='<li> To hide the selected sheet, click OK.</li>';\n      str +='<li> To cancel the hiding, click cancel.</li>';\n   str+='</ul></span></div>';\n   str +='<div style=\"width:380px;text-align:right;padding:6px 0px 4px 6px;font-size:small;\">'+\n         '<input type=\"button\" value=\"Cancel\" style=\"font-size:smaller;\" onclick=\"SocialCalc.WorkBookControlHideSheetHide();\">&nbsp;'+\n         '<input type=\"button\" value=\"OK\" style=\"font-size:smaller;\" onclick=\"SocialCalc.WorkBookControlHideSheetSubmit();\"></div>';\n\n   var main = document.createElement(\"div\");\n   main.id = control.hideDialogId;\n\n   main.style.position = \"absolute\";\n\n   var vp = SocialCalc.GetViewportInfo();\n\n   main.style.top = (vp.height/3)+\"px\";\n   main.style.left = (vp.width/3)+\"px\";\n   main.style.zIndex = 100;\n   main.style.backgroundColor = \"#FFF\";\n   main.style.border = \"1px solid black\";\n\n   main.style.width = \"400px\";\n\n   main.innerHTML = '<table cellspacing=\"0\" cellpadding=\"0\" style=\"border-bottom:1px solid black;\"><tr>'+\n      '<td style=\"font-size:10px;cursor:default;width:100%;background-color:#999;color:#FFF;\">'+\"&nbsp;\"+'</td>'+\n      '<td style=\"font-size:10px;cursor:default;color:#666;\" onclick=\"SocialCalc.WorkBookControlHideSheetHide();\">&nbsp;X&nbsp;</td></tr></table>'+\n      '<div style=\"background-color:#DDD;\">'+str+'</div>';\n\n      //alert(main.innerHTML);\n\n   SocialCalc.DragRegister(main.firstChild.firstChild.firstChild.firstChild, true, true, {MouseDown: SocialCalc.DragFunctionStart, MouseMove: SocialCalc.DragFunctionPosition,\n               MouseUp: SocialCalc.DragFunctionPosition,\n               Disabled: null, positionobj: main});\n\n   control.workbook.spreadsheet.spreadsheetDiv.appendChild(main);\n   }\n\nSocialCalc.WorkBookControlHideSheetHide = function(){\n\nvar control = SocialCalc.GetCurrentWorkBookControl();\nvar spreadsheet = control.workbook.spreadsheet;\n\nvar ele = document.getElementById(control.hideDialogId);\nele.innerHTML = \"\";\n\nSocialCalc.DragUnregister(ele);\n\nSocialCalc.KeyboardFocus();\n\nif (ele.parentNode) {\n   ele.parentNode.removeChild(ele);\n}\n}\n\nSocialCalc.WorkBookControlHideSheetSubmit = function() {\n\n      var control = SocialCalc.GetCurrentWorkBookControl();\n      SocialCalc.WorkBookControlHideSheetHide();\n      var foo = document.getElementById(\"fooBar\");\n      var current = document.getElementById(control.currentSheetButton.id);\n\n      var name = current.id;\n      var curname = control.currentSheetButton.value;\n         \n      var sheetbar = document.getElementById(\"SocialCalc-sheetbar-buttons\");\n      var sheetbarbutton = document.getElementById(\"sbsb-\"+current.id);\n      // unregister with mouse ? etc\n      SocialCalc.SheetBarButtonActivate(control.currentSheetButton.id, false);\n      sheetbarbutton.style.display=\"none\";\n      control.currentSheetButton = null;\n      // delete the sheets\n\n      control.numSheets = control.numSheets-1;\n\n                var cmdstr = \"hidesheet \"+name;\n                SocialCalc.Callbacks.broadcast('execute', { cmdtype:\"wcmd\", id:\"0\", cmdstr: cmdstr});\n   \n      // reset current sheet\n      for (var sheet in control.sheetButtonArr) {\n         if (sheet != null && document.getElementById(\"sbsb-\"+sheet).style.display != \"none\") {\n            control.currentSheetButton = control.sheetButtonArr[sheet];\n            break;\n            }\n         }\n      if (control.currentSheetButton != null) {\n         control.currentSheetButton.setAttribute(\"style\",\"background-color:lightgreen\");\n              SocialCalc.SheetBarButtonActivate(control.currentSheetButton.id, true);\n         control.workbook.ActivateWorkBookSheet(control.currentSheetButton.id, null);\n      }\n   }\n   \n// displays all hidden sheets, and then unhides whatever is selected\nSocialCalc.WorkBookControlUnhideSheet = function() {\n\n      var control = SocialCalc.GetCurrentWorkBookControl();\n      if (control.workbook.spreadsheet.editor.state != \"start\") {\n      // if in edit mode return\n      return;\n      }\n\n   var unhiddencount = 0;\n   for(var sheet in control.sheetButtonArr) {\n      if(document.getElementById(\"sbsb-\" + sheet).style.display == \"none\") {\n         unhiddencount++;\n         }\n      }\n\n   if(unhiddencount==0) {  //no hidden sheets, error message here\n      var str = '<div style=\"padding:6px 0px 4px 6px;\">'+\n         '<span>'+'<b> There are no hidden worksheets. </b>' + '</span><br/><br/>';\n      str +='<span>Before unhiding any sheets, you must first hide a sheet. </span><br/></div>';\n      str +='<div style=\"width:380px;text-align:right;padding:6px 0px 4px 6px;font-size:small;\">'+\n         '<input type=\"button\" value=\"Ok\" style=\"font-size:smaller;\" onclick=\"SocialCalc.WorkBookControlUnhideSheetHide();\"></div>';\n      var main = document.createElement(\"div\");\n      main.id = control.unhideDialogId;\n\n      main.style.position = \"absolute\";\n\n      var vp = SocialCalc.GetViewportInfo();\n\n      main.style.top = (vp.height/3)+\"px\";\n      main.style.left = (vp.width/3)+\"px\";\n      main.style.zIndex = 100;\n      main.style.backgroundColor = \"#FFF\";\n      main.style.border = \"1px solid black\";\n\n      main.style.width = \"400px\";\n\n      main.innerHTML = '<table cellspacing=\"0\" cellpadding=\"0\" style=\"border-bottom:1px solid black;\"><tr>'+\n         '<td style=\"font-size:10px;cursor:default;width:100%;background-color:#999;color:#FFF;\">'+\"&nbsp;\"+'</td>'+\n         '<td style=\"font-size:10px;cursor:default;color:#666;\" onclick=\"SocialCalc.WorkBookControlUnhideSheetHide();\">&nbsp;<b>X</b>&nbsp;</td></tr></table>'+\n         '<div style=\"background-color:#DDD;\">'+str+'</div>';\n\n         //alert(main.innerHTML);\n\n      SocialCalc.DragRegister(main.firstChild.firstChild.firstChild.firstChild, true, true, {MouseDown: SocialCalc.DragFunctionStart, MouseMove: SocialCalc.DragFunctionPosition,\n                  MouseUp: SocialCalc.DragFunctionPosition,\n                  Disabled: null, positionobj: main});\n\n      control.workbook.spreadsheet.spreadsheetDiv.appendChild(main);\n         return;\n      }\n\n   var element = document.getElementById(control.unhideDialogId);\n   if (element) return;\n\n   var currentsheet = control.currentSheetButton.value;\n   var str = '<div style=\"padding:6px 0px 4px 6px;\">'+\n         '<span>'+ '<b>The following sheets are hidden.</b>'+ '</span><br/><form id=\"unhidesheetform\"><ul>' +\n         '<input type=\"hidden\" name=\"unhidesheet\" value=\"\"/>';\n   for(var sheet in control.sheetButtonArr) {\n      if(document.getElementById(\"sbsb-\" + sheet).style.display == \"none\") {\n         str += '<input type=\"radio\" value=\"'+sheet+'\" onclick=\"document.getElementById(&quot;unhidesheetform&quot;).unhidesheet.value=&quot;'+sheet+'&quot;;\"/>' + control.sheetButtonArr[sheet].value +'<br/>';\n         }\n      }\n\n   str +='</ul></form>\\n<span><ul>';\n      str +='<li> To unhide the selected sheet, click OK.</li>';\n      str +='<li> To cancel the unhiding, click cancel.</li>';\n   str+='</ul></span></div>';\n   str +='<div style=\"width:380px;text-align:right;padding:6px 0px 4px 6px;font-size:small;\">'+\n         '<input type=\"button\" value=\"Cancel\" style=\"font-size:smaller;\" onclick=\"SocialCalc.WorkBookControlUnhideSheetHide();\">&nbsp;'+\n         '<input type=\"button\" value=\"OK\" style=\"font-size:smaller;\" onclick=\"SocialCalc.WorkBookControlUnhideSheetSubmit(document.getElementById(&quot;unhidesheetform&quot;).unhidesheet.value);\"></div>';\n\n   var main = document.createElement(\"div\");\n   main.id = control.unhideDialogId;\n\n   main.style.position = \"absolute\";\n\n   var vp = SocialCalc.GetViewportInfo();\n\n   main.style.top = (vp.height/3)+\"px\";\n   main.style.left = (vp.width/3)+\"px\";\n   main.style.zIndex = 100;\n   main.style.backgroundColor = \"#FFF\";\n   main.style.border = \"1px solid black\";\n\n   main.style.width = \"400px\";\n\n   main.innerHTML = '<table cellspacing=\"0\" cellpadding=\"0\" style=\"border-bottom:1px solid black;\"><tr>'+\n      '<td style=\"font-size:10px;cursor:default;width:100%;background-color:#999;color:#FFF;\">'+\"&nbsp;\"+'</td>'+\n      '<td style=\"font-size:10px;cursor:default;color:#666;\" onclick=\"SocialCalc.WorkBookControlUnhideSheetHide();\">&nbsp;X&nbsp;</td></tr></table>'+\n      '<div style=\"background-color:#DDD;\">'+str+'</div>';\n\n      //alert(main.innerHTML);\n\n   SocialCalc.DragRegister(main.firstChild.firstChild.firstChild.firstChild, true, true, {MouseDown: SocialCalc.DragFunctionStart, MouseMove: SocialCalc.DragFunctionPosition,\n               MouseUp: SocialCalc.DragFunctionPosition,\n               Disabled: null, positionobj: main});\n\n   control.workbook.spreadsheet.spreadsheetDiv.appendChild(main);\n   }\n\n\n\nSocialCalc.WorkBookControlUnhideSheetHide = function(){\n\nvar control = SocialCalc.GetCurrentWorkBookControl();\nvar spreadsheet = control.workbook.spreadsheet;\n\nvar ele = document.getElementById(control.unhideDialogId);\nele.innerHTML = \"\";\n\nSocialCalc.DragUnregister(ele);\n\nSocialCalc.KeyboardFocus();\n\nif (ele.parentNode) {\n   ele.parentNode.removeChild(ele);\n   }\n}\n\n\nSocialCalc.WorkBookControlUnhideSheetSubmit = function(name) {\n\n      var control = SocialCalc.GetCurrentWorkBookControl();\n      SocialCalc.WorkBookControlUnhideSheetHide();\n      var current = document.getElementById(control.currentSheetButton.id);\n      \n      var curid = current.id;\n      var curname = control.currentSheetButton.value;\n      \n      control.currentSheetButton.setAttribute(\"style\",\"\");\n      var old = control.currentSheetButton.id;\n      console.log(old);\n      SocialCalc.SheetBarButtonActivate(old, false);\n      \n      var sheetbarbutton = document.getElementById(\"sbsb-\"+name);\n      // unhide the button\n      sheetbarbutton.style.display = \"inline\";\n      control.currentSheetButton = null;\n      \n      control.numSheets = control.numSheets+1;\n\n                var cmdstr = \"unhidesheet \"+name;\n      SocialCalc.Callbacks.broadcast('execute', { cmdtype:\"wcmd\", id:\"0\", cmdstr: cmdstr});\n   \n      // reset current sheet\n      for (var sheet in control.sheetButtonArr) {\n          if (sheet != null && document.getElementById(\"sbsb-\"+sheet).style.display != \"none\") {\n         control.currentSheetButton = control.sheetButtonArr[sheet];\n         break;\n          }\n      }\n\n      if (control.currentSheetButton != null) {\n         control.currentSheetButton.setAttribute(\"style\",\"background-color:lightgreen\");\n              SocialCalc.SheetBarButtonActivate(control.currentSheetButton.id, true);\n         control.workbook.ActivateWorkBookSheet(control.currentSheetButton.id, null);\n      }\n   }\n\n\n\nSocialCalc.WorkBookControlAddSheetButton = function(sheetname, sheetid) {\n   \n   var control = SocialCalc.GetCurrentWorkBookControl();\n   \n   //Create an input type dynamically.\n   var element = document.createElement(\"input\");\n\n   var name = null;\n\n   if (sheetid != null) {\n      name = sheetid\n   } else {\n      name = \"sheet\"+ (control.sheetCnt+1).toString();\n      control.sheetCnt = control.sheetCnt + 1;\n   }\n\n   //Assign different attributes to the element.\n   element.setAttribute(\"type\", \"button\");\n   if (sheetname == null) {\n      element.setAttribute(\"value\", name);\n   } else {\n      element.setAttribute(\"value\", sheetname);\n   }\n   element.setAttribute(\"id\", name);\n   element.setAttribute(\"name\", name);\n   \n   var fnname = \"SocialCalc.WorkBookControlActivateSheet(\"+\"'\"+name+\"'\"+\")\";\n   \n   element.setAttribute(\"onclick\",fnname);\n\n   control.sheetButtonArr[name] = element;\n   \n   \n   var foo = document.getElementById(\"fooBar\");\n\n   //Append the element in page (in span).\n   foo.appendChild(element);\n\n   control.numSheets = control.numSheets + 1;\n   \n      var el = new SocialCalc.SheetBarSheetButton(\"sbsb-\"+name, (sheetname?sheetname:name),\n                  document.getElementById(\"SocialCalc-sheetbar-buttons\"),\n                  {\n                     //normalstyle: \"border:1px solid #000;backgroundColor:#FFF;\",\n                     //downstyle: \"border:1px solid #000;backgroundColor:#CCC;\",\n                     //hoverstyle: \"border:1px solid #000;backgroundColor:#FFF;\"\n                  },\n                  {\n                     MouseDown:function() {SocialCalc.SheetBarSheetButtonPress(name);},\n                     Repeat:function(){},\n                     Disabled: function() {}\n                  }\n                  );\n\n   return element;\n}\n\nSocialCalc.WorkBookControlAddSheet = function(addworksheet, sheetname){\n\n   var control = SocialCalc.GetCurrentWorkBookControl();\n\n\n   if (control.workbook.spreadsheet.editor.state != \"start\") {\n   // if in edit return\n   return;\n   }  \n\n\n   // first add the button\n   var element = SocialCalc.WorkBookControlAddSheetButton(sheetname);\n   \n   // then change the highlight\n   \n   var old=\"sheet1\";\n   if (control.currentSheetButton != null) {\n      control.currentSheetButton.setAttribute(\"style\", \"\");\n      old = control.currentSheetButton.id;\n      SocialCalc.SheetBarButtonActivate(old, false);\n      }\n   \n   element.setAttribute(\"style\",\"background-color:lightgreen\");\n   control.currentSheetButton = element;\n   var newsheetid = element.id;\n   SocialCalc.SheetBarButtonActivate(newsheetid, true);\n   \n   // create the sheet\n   if (addworksheet) {\n      control.workbook.AddNewWorkBookSheet(newsheetid, old, false);\n         // broadcast an add command here\n      var cmdstr = \"addsheet\"\n      SocialCalc.Callbacks.broadcast('execute', { cmdtype:\"wcmd\", id:\"0\", cmdstr: cmdstr});\n   }\n   \n}\n\nSocialCalc.WorkBookControlAddSheetRemote = function(savestr){\n\n   var control = SocialCalc.GetCurrentWorkBookControl();\n   \n   // first add the button\n   var element = SocialCalc.WorkBookControlAddSheetButton();\n\n   // add the sheet, dont switch to it\n   control.workbook.AddNewWorkBookSheetNoSwitch(element.id,\n                  element.value, savestr);        \n}\n\n   \nSocialCalc.WorkBookControlActivateSheet = function(name) {\n\n   //alert(\"in activate sheet=\"+name)\n\n   var control = SocialCalc.GetCurrentWorkBookControl();\n   \n   var foo = document.getElementById(name);\n   foo.setAttribute(\"style\",\"background-color:lightgreen;\");\n   SocialCalc.SheetBarButtonActivate(name, true)\n\n   var old = control.currentSheetButton.id;\n   if (control.currentSheetButton.id != foo.id) {\n      control.currentSheetButton.setAttribute(\"style\", \"\");\n      SocialCalc.SheetBarButtonActivate(old, false)\n   }\n   \n   control.currentSheetButton = foo;\n\n   control.workbook.ActivateWorkBookSheet(name, old);\n   \n}\n\nSocialCalc.WorkBookControlHttpRequest = null;\n\nSocialCalc.WorkBookControlAlertContents = function(){\n\n   var loadedstr = \"\";\n   var http_request = SocialCalc.WorkBookControlHttpRequest;\n   \n   if (http_request.readyState == 4) {\n      //addmsg(\"received:\" + http_request.responseText.length + \" chars\");\n      try {\n         if (http_request.status == 200) {\n            loadedstr = http_request.responseText || \"\";\n            http_request = null;\n         }\n         else {\n            ;\n         }\n      } \n      catch (e) {\n      }\n      // do something with loaded str\n      //alert(\"loaded=\"+loadedstr);\n      SocialCalc.TestWorkBookSaveStr = loadedstr;\n      SocialCalc.Clipboard.clipboard = loadedstr;\n   }\n}\n\n\nSocialCalc.WorkBookControlAjaxCall = function(url, contents) {\n\n   var http_request = null;\n   \n   alert(\"in ajax\")\n   if (window.XMLHttpRequest) { // Mozilla, Safari,...\n      http_request = new XMLHttpRequest();\n   }\n   else \n      if (window.ActiveXObject) { // IE\n         try {\n            http_request = new ActiveXObject(\"Msxml2.XMLHTTP\");\n         } \n         catch (e) {\n            try {\n               http_request = new ActiveXObject(\"Microsoft.XMLHTTP\");\n            } \n            catch (e) {\n            }\n         }\n      }\n   if (!http_request) {\n      alert('Giving up :( Cannot create an XMLHTTP instance');\n      return false;\n   }\n   \n   // Make the actual request\n   SocialCalc.WorkBookControlHttpRequest = http_request;\n   \n   http_request.onreadystatechange = SocialCalc.WorkBookControlAlertContents;\n   http_request.open('POST', document.URL, true); // async\n   http_request.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');\n   http_request.send(contents);\n   \n   return true;\n   \n}\n\nSocialCalc.WorkBookControlSaveSheet = function(){\n\n   var control = SocialCalc.GetCurrentWorkBookControl();\n   \n   var sheetsave = {};\n\n   sheetsave.numsheets = control.numSheets;\n   sheetsave.currentid = control.currentSheetButton.id;\n   sheetsave.currentname = control.currentSheetButton.value;\n\n   sheetsave.sheetArr = {}\n   for (var sheet in control.sheetButtonArr) {\n      var sheetstr = control.workbook.SaveWorkBookSheet(sheet);\n      sheetsave.sheetArr[sheet] = {}\n      sheetsave.sheetArr[sheet].sheetstr = sheetstr;\n      sheetsave.sheetArr[sheet].name = control.sheetButtonArr[sheet].value;\n      sheetsave.sheetArr[sheet].hidden = document.getElementById(\"sbsb-\" + sheet).style.display == \"none\" ? \"1\" : \"0\";\n      }\n   \n    // Save the editable cells if specified\n    if (SocialCalc.EditableCells && SocialCalc.EditableCells.allow) {\n   sheetsave.EditableCells = {};\n   for (var i in SocialCalc.EditableCells) {\n       sheetsave.EditableCells[i] = SocialCalc.EditableCells[i];\n   }\n    }\n\n    var d = new Date();\n    sheetsave[\"timestamp\"] = d.toString();\n\n   SocialCalc.TestWorkBookSaveStr = JSON.stringify(sheetsave);\n      //alert(SocialCalc.TestWorkBookSaveStr);\n   // send it to the backend\n   // SocialCalc.WorkBookControlAjaxCall(\"/\", \"&sheetdata=\"+encodeURIComponent(SocialCalc.TestWorkBookSaveStr));\n      return SocialCalc.TestWorkBookSaveStr;\n}\n\n\n// insert another workbook into an existing workbook \n// assumption is at least 1 sheet exists in existing workbook\n// sheets with same names will be overwritten !\nSocialCalc.WorkBookControlInsertWorkbook = function(savestr) {\n   var sheetsave\n   if (savestr)  {\n      sheetsave = JSON.parse(savestr);\n   }\n   var control = SocialCalc.GetCurrentWorkBookControl();\n   for (var sheet in sheetsave.sheetArr) {\n   \n   var savestr = sheetsave.sheetArr[sheet].sheetstr.savestr;\n   var parts = control.workbook.spreadsheet.DecodeSpreadsheetSave(savestr);\n   if (parts) {\n      if (parts.sheet) {\n      savestr = savestr.substring(parts.sheet.start, parts.sheet.end)\n      }\n   }\n   // check if sheetname already exists\n   var sheetname = sheetsave.sheetArr[sheet].name\n   var sheetid = control.workbook.SheetNameExistsInWorkBook(sheetname);\n   if (sheetid) {\n      console.log(sheetname+\"exists\")      \n      control.workbook.LoadRenameWorkBookSheet(sheetid, savestr, sheetname)\n   }\n   else {\n      //just test-brand new insert first\n      sheetid = \"sheet\"+(control.sheetCnt+1).toString()\n      control.sheetCnt = control.sheetCnt+1\n      SocialCalc.WorkBookControlAddSheetButton(sheetsave.sheetArr[sheet].name, sheetid)\n      // create the sheet\n      control.workbook.AddNewWorkBookSheetNoSwitch(sheetid, sheetsave.sheetArr[sheet].name, savestr)\n      \n   }\n   }\n\n}\n\nSocialCalc.WorkBookControlLoad = function(savestr){\n\n    var sheetsave;\n    \n    if (savestr == \"\") return;\n    \n    if (savestr)  {\n   sheetsave = JSON.parse(savestr);\n    } else {\n      sheetsave = JSON.parse(SocialCalc.TestWorkBookSaveStr);\n    }\n    //alert(sheetsave.currentid+\",\"+sheetsave.currentname)\n    \n    // first create a new workbook\n    var control = SocialCalc.GetCurrentWorkBookControl();\n    \n    SocialCalc.WorkBookControlCreateNewBook();\n    \n    // at this point there is one sheet, and 1 button\n    // create the sequence of buttons, and sheets\n    var firstrun = true;\n    var newbuttons = 0\n    var sheetid = null;\n    var currentsheetid = sheetsave.currentid;\n    //alert(\"button=\"+newbuttons)\n    for (var sheet in sheetsave.sheetArr) {\n   //alert(sheet);\n   if (newbuttons > sheetsave.numsheets) {\n       break;\n   }\n   //alert(\"button=\"+newbuttons)\n   var savestr = sheetsave.sheetArr[sheet].sheetstr.savestr;\n   var parts = control.workbook.spreadsheet.DecodeSpreadsheetSave(savestr);\n   if (parts) {\n       if (parts.sheet) {\n      savestr = savestr.substring(parts.sheet.start, parts.sheet.end);\n       }\n   }\n   if (firstrun) {\n       firstrun=false;\n       // set the first button's name correctly\n       sheetid = control.currentSheetButton.id;\n       control.currentSheetButton.value = sheetsave.sheetArr[sheet].name;\n       SocialCalc.SheetBarButtonSetName(sheetid, sheetsave.sheetArr[sheet].name);\n       // set the sheet data for the first sheet which already exists\n       control.workbook.LoadRenameWorkBookSheet(sheetid, savestr, control.currentSheetButton.value);\n       // need to also set the formula cache\n       currentsheetid = sheetid;\n   }\n   else {\n       sheetid = \"sheet\"+(control.sheetCnt+1).toString();\n       control.sheetCnt = control.sheetCnt+1;\n       SocialCalc.WorkBookControlAddSheetButton(sheetsave.sheetArr[sheet].name, sheetid);\n       // create the sheet\n       control.workbook.AddNewWorkBookSheetNoSwitch(sheetid, sheetsave.sheetArr[sheet].name, savestr);\n   }\n   if(sheetsave.sheetArr[sheet].hidden==\"1\") {\n       // unregister with mouse ? etc\n       var sheetbarbutton = document.getElementById(\"sbsb-\" + sheetid);\n       sheetbarbutton.style.display=\"none\";\n       SocialCalc.SheetBarButtonActivate(sheet, false);\n       newbuttons= newbuttons - 1;\n   }\n   if (sheet == sheetsave.currentid) {\n       currentsheetid = sheetid\n   }\n   newbuttons = newbuttons + 1;\n    }\n   // Save the user script data\n    if (sheetsave.EditableCells) {\n        SocialCalc.EditableCells = {};\n   for (var i in sheetsave.EditableCells) {\n       SocialCalc.EditableCells[i] = sheetsave.EditableCells[i];\n   }\n    }\n    var timeoutFn = function() {\n   SocialCalc.WorkBookControlActivateSheet(currentsheetid);\n    };\n    window.setTimeout(timeoutFn, 200);\n}\n\n\nSocialCalc.WorkBookControlRenameSheet = function(){\n\n   var control = SocialCalc.GetCurrentWorkBookControl();\n\n   if (control.workbook.spreadsheet.editor.state != \"start\") {\n   // if in edit return\n   return;\n   }  \n\n   \n   // do a popup to get the new name of the sheet\n   // the popup has an input element with submit, and cancel buttons\n   var   element = document.getElementById(control.renameDialogId);\nif (element) return;\n\nvar currentsheet = control.currentSheetButton.value;\nvar str = '<div style=\"padding:6px 0px 4px 6px;\">'+\n      '<span style=\"font-size:smaller;\">'+'Rename-'+ currentsheet + '</span><br>'+\n      '<span style=\"font-size:smaller;\">' + 'Please ensure that you DO NOT have ANY spaces in the sheet name.' + '</span>' +\n      '<input type=\"text\" id=\"newSheetName\" style=\"width:380px;\" value=\"'+currentsheet+'\"><br>'+'</div>';\n\nstr +='<div style=\"width:380px;text-align:right;padding:6px 0px 4px 6px;font-size:small;\">'+\n      '<input type=\"button\" value=\"Submit\" style=\"font-size:smaller;\" onclick=\"SocialCalc.WorkBookControlRenameSheetSubmit();\">&nbsp;'+\n      '<input type=\"button\" value=\"Cancel\" style=\"font-size:smaller;\" onclick=\"SocialCalc.WorkBookControlRenameSheetHide();\"></div>';\n\nvar main = document.createElement(\"div\");\nmain.id = control.renameDialogId;\n\nmain.style.position = \"absolute\";\n\nvar vp = SocialCalc.GetViewportInfo();\n\nmain.style.top = (vp.height/3)+\"px\";\nmain.style.left = (vp.width/3)+\"px\";\nmain.style.zIndex = 100;\nmain.style.backgroundColor = \"#FFF\";\nmain.style.border = \"1px solid black\";\n\nmain.style.width = \"400px\";\n\nmain.innerHTML = '<table cellspacing=\"0\" cellpadding=\"0\" style=\"border-bottom:1px solid black;\"><tr>'+\n   '<td style=\"font-size:10px;cursor:default;width:100%;background-color:#999;color:#FFF;\">'+\"&nbsp;\"+'</td>'+\n   '<td style=\"font-size:10px;cursor:default;color:#666;\" onclick=\"SocialCalc.WorkBookControlRenameSheetHide();\">&nbsp;X&nbsp;</td></tr></table>'+\n   '<div style=\"background-color:#DDD;\">'+str+'</div>';\n\n\nSocialCalc.DragRegister(main.firstChild.firstChild.firstChild.firstChild, true, true, {MouseDown: SocialCalc.DragFunctionStart, MouseMove: SocialCalc.DragFunctionPosition,\n            MouseUp: SocialCalc.DragFunctionPosition,\n            Disabled: null, positionobj: main});\n\ncontrol.workbook.spreadsheet.spreadsheetDiv.appendChild(main);\n\nvar ele = document.getElementById(\"newSheetName\");\nele.focus();\nSocialCalc.CmdGotFocus(ele);\n\n}\n\nSocialCalc.WorkBookControlRenameSheetHide = function(){\n\nvar control = SocialCalc.GetCurrentWorkBookControl();\nvar spreadsheet = control.workbook.spreadsheet;\n\nvar ele = document.getElementById(control.renameDialogId);\nele.innerHTML = \"\";\n\nSocialCalc.DragUnregister(ele);\n\nSocialCalc.KeyboardFocus();\n\nif (ele.parentNode) {\n   ele.parentNode.removeChild(ele);\n}\n}\n\nSocialCalc.WorkBookControlRenameSheetSubmit = function(){\n\n// this handles all the rename action\nvar ele = document.getElementById(\"newSheetName\");\n//console.log(ele.value);\nvar control = SocialCalc.GetCurrentWorkBookControl();\nif (ele.value.length == 0) {\n   ele.focus();\n   return;\n}\nvar oldname = control.currentSheetButton.value;\nvar newname = ele.value;\nif(newname.indexOf(\" \")!=-1) {\n   alert(\"A space was found in the new name. Please ensure that the new name has no sapces\");\n   return;\n   }\nSocialCalc.WorkBookControlRenameSheetHide();\n// verify newname does not clash with any existing sheet name\n// if so reject\nvar smallname = newname.toLowerCase();//converting to lower case to normalise\n//console.log(smallname + \" old \" + ele.value);\nfor (var sheet in workbook.sheetArr) {\n   console.log(workbook.sheetArr[sheet].sheet.sheetname);//checking in sheetarr for repeated names\n         if (workbook.sheetArr[sheet].sheet.sheetname == smallname) {\n         alert(newname+\" already exists\");\n         return;\n      }   \n   } // variation of Case in letters of a sheet name will give an error if smallname is used.\n\ncontrol.currentSheetButton.value = smallname;\n\nSocialCalc.SheetBarButtonSetName (control.currentSheetButton.id, newname);\n\n// perform a rename for formula references to this sheet in all the \n// sheets in the workbook\ncontrol.workbook.RenameWorkBookSheet(oldname, smallname, control.currentSheetButton.id);\n\n   var cmdstr = \"rensheet \"+control.currentSheetButton.id+\" \"+oldname+\" \"+newname;\n   //console.log(cmdstr);\n   SocialCalc.Callbacks.broadcast('execute', { cmdtype:\"wcmd\", id:\"0\", cmdstr: cmdstr});\n\n}\n\nSocialCalc.WorkBookControlRenameSheetRemote = function(sheetid, oldname, newname) {\n   //console.log(\"rename sheet \",sheetid, oldname, newname)\n   var control = SocialCalc.GetCurrentWorkBookControl();\n\n   var foo = document.getElementById(\"fooBar\");\n   var renbutton = document.getElementById(sheetid);\n   \n   renbutton.value = newname;\n\n   SocialCalc.SheetBarButtonSetName(sheetid, newname);\n\ncontrol.workbook.RenameWorkBookSheet(oldname, newname, sheetid);\n   \n}\n\n\nSocialCalc.WorkBookControlCreateNewBook = function() {\n\n   var control = SocialCalc.GetCurrentWorkBookControl();\n   \n   // delete all the sheets except 1\n   for (var sheet in control.sheetButtonArr) {\n      if (sheet != control.currentSheetButton.id) {\n         control.workbook.DeleteWorkBookSheet(control.sheetButtonArr[sheet].id, control.sheetButtonArr[sheet].value);\n      }\n   }\n   // Reset that 1 sheet\n   \n   control.workbook.LoadRenameWorkBookSheet(control.currentSheetButton.id, \"\", control.workbook.defaultsheetname)\n   \n   \n   // delete all the buttons except 1\n   for (var sheet in control.sheetButtonArr) {\n      if (sheet != control.currentSheetButton.id) {\n         var foo = document.getElementById(\"fooBar\");\n         var current = document.getElementById(control.sheetButtonArr[sheet].id);\n         \n         var name = current.id;\n         delete control.sheetButtonArr[name];\n         \n         foo.removeChild(current);\n\n         var sheetbar = document.getElementById(\"SocialCalc-sheetbar-buttons\");\n         var sheetbarbutton = document.getElementById(\"sbsb-\"+name);\n         // unregister with mouse ? etc\n         sheetbar.removeChild(sheetbarbutton);\n\n\n         control.numSheets = control.numSheets - 1;\n      }\n   }\n   // rename that button\n   control.currentSheetButton.value = control.workbook.defaultsheetname;   \n   //alert(\"done new workbook\")\n}\n\nSocialCalc.WorkBookControlNewBook = function() {\n   var control = SocialCalc.GetCurrentWorkBookControl();\n   SocialCalc.WorkBookControlCreateNewBook();\n   control.workbook.RenderWorkBookSheet();\n}\n\n\nSocialCalc.WorkBookControlMove = function(direction){\n\n   var control = SocialCalc.GetCurrentWorkBookControl();\n   if (control.workbook.spreadsheet.editor.state != \"start\") {\n       return;\n   }\n   var sheetArr = control.sheetButtonArr;\n   var newSheetArr = {};\n   var sheetid = control.currentSheetButton.id;\n\n   var curr_button = document.getElementById(sheetid);\n   var curr_sb_button = document.getElementById(\"sbsb-\"+sheetid);\n   var sib_button = null;\n   var sib_sb_button = null;\n   if (direction == \"left\") {\n      sib_button = curr_button.previousSibling;\n      sib_sb_button = curr_sb_button.previousSibling;\n      if(!sib_sb_button) {\n         alert(\"Cannot move leftmost Sheet further to the left\");\n         return;\n         }\n      }\n   else {\n      sib_button = curr_button.nextSibling;\n      sib_sb_button = curr_sb_button.nextSibling;    \n      if(!sib_sb_button) {\n         alert(\"Cannot move rightmost Sheet further to the right\");\n         return;\n         }  \n      }\n   var currid = sheetid;\n   var sibid = sib_button.id;\n   var parent = curr_button.parentNode;\n   var sb_parent = curr_sb_button.parentNode;\n\n   var cloned = {};\n   var clonedsb = {};\n   for(button in sheetArr) {\n      clonedsb[button] = document.getElementById(\"sbsb-\"+button);\n      cloned[button] = document.getElementById(button);\n      sb_parent.removeChild(document.getElementById(\"sbsb-\"+button));\n      parent.removeChild(document.getElementById(button));\n        }\n   for(button in sheetArr) {\n      if(button != currid && button != sibid) {\n          newSheetArr[button] = sheetArr[button];\n          sb_parent.appendChild(clonedsb[button]);\n          parent.appendChild(cloned[button]);\n      }\n      else if(button == currid) {\n          if (direction == \"left\") {\n            newSheetArr[currid] = sheetArr[currid];\n            newSheetArr[sibid] = sheetArr[sibid];\n              sb_parent.appendChild(clonedsb[currid]);\n              parent.appendChild(cloned[currid]);\n              sb_parent.appendChild(clonedsb[sibid]);\n              parent.appendChild(cloned[sibid]);\n          } else {\n            newSheetArr[sibid] = sheetArr[sibid];\n            newSheetArr[currid] = sheetArr[currid];\n              sb_parent.appendChild(clonedsb[sibid]);\n              parent.appendChild(cloned[sibid]);\n              sb_parent.appendChild(clonedsb[currid]);\n              parent.appendChild(cloned[currid]);\n          }\n      }\n   }\n   control.sheetButtonArr = newSheetArr;\n   SocialCalc.SheetBarButtonActivate(currid,true);\n}\n\nSocialCalc.WorkBookControlMoveLeft = function(){\n    SocialCalc.WorkBookControlMove(\"left\");\n}\nSocialCalc.WorkBookControlMoveRight = function(){\n    SocialCalc.WorkBookControlMove(\"right\");\n}\n\n\n\nSocialCalc.WorkBookControlCopySheet = function(){\n\n   //alert(\"in copy\");\n\n   var control = SocialCalc.GetCurrentWorkBookControl();\n\n   if (control.workbook.spreadsheet.editor.state != \"start\") {\n   // if in edit return\n   return;\n   }  \n\n   \n   control.workbook.CopyWorkBookSheet(control.currentSheetButton.id);\n   \n   alert(\"copied sheet:\"+control.currentSheetButton.value);\n}\n\nSocialCalc.WorkBookControlPasteSheet = function() {\n\n   //alert(\"in paste\");\n\n   var control = SocialCalc.GetCurrentWorkBookControl();\n\n   if (control.workbook.spreadsheet.editor.state != \"start\") {\n   // if in edit return\n   return;\n   }  \n\n   \n   var oldid = control.currentSheetButton.id;\n   \n   SocialCalc.WorkBookControlAddSheet(false);\n   \n   var newid = control.currentSheetButton.id;\n   \n   //alert(newid+oldid);\n   \n   control.workbook.PasteWorkBookSheet(newid, oldid);\n\n      var cmdstr = \"addsheetstr\";\n   SocialCalc.Callbacks.broadcast('execute', { cmdtype:\"wcmd\", id:\"0\", cmdstr: cmdstr, sheetstr: control.workbook.clipsheet.savestr});\n   \n}\n\nSocialCalc.SheetBar = function() {\n   this.baseDiv = document.getElementById(\"SocialCalc-sheetbar\");\n\n   this.prebuttonsDiv = document.createElement(\"div\");\n   this.prebuttonsDiv.style.cssText = \"display:inline;\"; \n   this.prebuttonsDiv.innerHTML=\"&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp\";\n   this.prebuttonsDiv.id = \"SocialCalc-sheetbar-prebuttons\";\n\n   this.buttonsDiv = document.createElement(\"div\");\n   this.buttonsDiv.id = \"SocialCalc-sheetbar-buttons\";\n   this.buttonsDiv.style.cssText = \"display:inline;\"; \n\n   this.buttonActionsDiv = document.createElement(\"div\");\n   this.buttonActionsDiv.id = \"SocialCalc-sheetbar-buttonactions\";\n   this.buttonActionsDiv.style.display = \"inline\"; \n   var addbutton = new SocialCalc.SheetBarSheetButton(\"sbsba-add\", \"sbsba-add\", this.buttonActionsDiv, \n                     {}, \n                     {\n                     MouseDown:function(){var abc=SocialCalc.WorkBookControlAddSheet(true);}\n                     },\n                     \"add-2.png\");\n   \n\n   this.baseDiv.appendChild(this.prebuttonsDiv);\n   this.baseDiv.appendChild(this.buttonsDiv);\n   this.baseDiv.appendChild(this.buttonActionsDiv);\n}\n\n// define a new class for sheetbarsheetbutton\n\nSocialCalc.SheetBarSheetButton = function(id, name, parentdiv, params, functions, img) {\n   this.ele = document.createElement(\"div\");\n   this.ele.id = id;\n   this.ele.name = name;\n   if (!img) {\n      this.ele.innerHTML = name;\n      this.ele.style.cssText = \"font-size:small;display:inline;padding:5px 5px 2px 5px;border:1px solid #000;\";\n      imgele = document.createElement(\"img\");\n      imgele.id = id+\"-img\";\n      imgele.src = SocialCalc.Constants.defaultImagePrefix +\"menu-dropdown.png\";\n      imgele.style.cssText = \"padding:0px 2px;width:16px;height:16px;vertical-align:middle;\"\n      this.ele.appendChild(imgele);\n      SocialCalc.ButtonRegister(this.ele, params, functions);\n      SocialCalc.ButtonRegister(imgele, params, functions);\n   } else {\n   var imgele = document.createElement(\"img\");\n   imgele.src = SocialCalc.Constants.defaultImagePrefix +img;\n   imgele.style.cssText = \"width:16px;height:16px;vertical-align:middle;\"\n   this.ele.appendChild(imgele);\n   this.ele.style.cssText = \"display:inline;padding:5px 5px 2px 5px;\";\n   SocialCalc.ButtonRegister(imgele, params, functions);\n   }\n   parentdiv.appendChild(this.ele);\n}\n\nSocialCalc.SheetBarButtonActivate = function(id, active) {\n   var sbbutton = document.getElementById(\"sbsb-\"+id);\n   sbbutton.isactive = active;\n   if (active) {\n   sbbutton.style.backgroundColor = \"#FFF\";\n   var imgele = document.getElementById(\"sbsb-\"+id+\"-img\");\n   if (!imgele) {\n      imgele = document.createElement(\"img\");\n      imgele.id = \"sbsb-\"+id+\"-img\";\n      imgele.src = SocialCalc.Constants.defaultImagePrefix +\"menu-dropdown.png\";\n      imgele.style.cssText = \"padding:0px 2px;width:16px;height:16px;vertical-align:middle;\"\n      }\n      sbbutton.appendChild(imgele);\n      SocialCalc.ButtonRegister(imgele, {}, {\n                                       MouseDown:function() {SocialCalc.SheetBarSheetButtonPress(id);},\n                                       Repeat:function(){},\n                                       Disabled: function() {}\n                                       }  );\n   } \n   else {\n   sbbutton.style.backgroundColor = \"#CCC\";\n   var imgele = document.getElementById(\"sbsb-\"+id+\"-img\");\n   if (imgele) {\n      sbbutton.removeChild(imgele);\n      }\n   }\n   var menu = document.getElementById(\"sbsb-menu\");\n   if (menu && menu.style.display != \"none\") {\n   menu.style.display = \"none\";\n   }\n}\n\nSocialCalc.SheetBarButtonSetName = function(id, name) {\n   var sbbutton = document.getElementById(\"sbsb-\"+id);\n   sbbutton.name = name;\n   sbbutton.innerHTML = name;\n   if (sbbutton.isactive) {\n   SocialCalc.SheetBarButtonActivate(id, true);\n   }\n}\n\n\nSocialCalc.SheetBarSheetButtonPress = function(id) {\n   //console.log(\"button press\")\n   var sbbutton = document.getElementById(\"sbsb-\"+id);    \n   if (sbbutton && sbbutton.isactive) {\n   var menu = document.getElementById(\"sbsb-menu\");\n   if (!menu) {\n      var sbsbm = new SocialCalc.SheetBarSheetButtonMenu(\"sbsb-menu\", id);     \n   } else {\n      menu.clickedsheetid = id;\n      if (menu.style.display == \"none\") {\n      menu.style.display = \"inline\";\n      SocialCalc.SheetBarSheetButtonMenuPosition(menu, id);\n      } else {\n      menu.style.display = \"none\";\n      }\n   }\n\n   } else if (sbbutton) {\n   SocialCalc.WorkBookControlActivateSheet(id);\n   }    \n\n}\n\n\n// define a new class for sheetbarsheet button menu item\n\nSocialCalc.SheetBarSheetButtonMenuItem = function(id, t) {\n   this.ele = document.createElement(\"div\");\n   this.ele.id = id;\n   this.ele.innerHTML = t;\n   this.ele.className = \"\";\n   this.ele.style.cssText = \"padding:3px 4px;width:100px;height:20px;background-color:#FFF;\";\n\n   var params = {\n         normalstyle: \"backgroundColor:#FFF;\",\n         downstyle: \"backgroundColor:#CCC;\",\n         hoverstyle: \"backgroundColor:#CCC;\"};\n   var functions = {MouseDown:function(){SocialCalc.SheetBarMenuItemPress(id);},\n            Repeat:function(){},\n            Disabled: function() {}};\n\n   SocialCalc.ButtonRegister(this.ele, params, functions);\n\n   SocialCalc.TouchRegister(this.ele, {SingleTap:functions.MouseDown});\n\n   return this.ele;\n   \n}\n\nSocialCalc.SheetBarMenuItemPress = function(id) {\n\n   var menu = document.getElementById(\"sbsb-menu\");\n   if (!menu) return;\n\n   var clickedsheetid = menu.clickedsheetid;\n\n   switch(id)    {\n   case \"sbsb_deletesheet\":\n   //console.log(\"delete \"+clickedsheetid);\n   SocialCalc.WorkBookControlDelSheet();\n   break;\n   case \"sbsb_hidesheet\":\n   //console.log(\"hide\" +clickedsheetid);\n   SocialCalc.WorkBookControlHideSheet();\n   break;\n   case \"sbsb_unhidesheet\":\n   //console.log(\"hide\" +clickedsheetid);\n   SocialCalc.WorkBookControlUnhideSheet();\n   break;\n   case \"sbsb_copysheet\":\n   //console.log(\"copy \"+clickedsheetid);\n   SocialCalc.WorkBookControlCopySheet();\n   break;\n   case \"sbsb_moveleft\":\n   //console.log(\"rename \"+clickedsheetid);  \n   SocialCalc.WorkBookControlMoveLeft();\n   break;\n   case \"sbsb_moveright\":\n   //console.log(\"rename \"+clickedsheetid);  \n   SocialCalc.WorkBookControlMoveRight();\n   break;\n\n   case \"sbsb_pastesheet\":\n   //console.log(\"paste \"+clickedsheetid);\n   SocialCalc.WorkBookControlPasteSheet();\n   break;\n   case \"sbsb_renamesheet\":\n   //console.log(\"rename \"+clickedsheetid);  \n   SocialCalc.WorkBookControlRenameSheet();\n   break;\n   case \"sbsb_closemenu\":\n   //console.log(\"rename \"+clickedsheetid);  \n   menu.style.display = \"none\";\n   break;\n   default:\n   break;\n   }\n   menu.style.display = \"none\";\n\n}\n\n// define a new class for sheetbarsheet button menu \nSocialCalc.SheetBarSheetButtonMenu = function(id, clickedsheetid) {\n   this.ele = document.createElement(\"div\");\n   this.ele.id = id;\n   this.ele.className = \"\";\n   this.ele.clickedsheetid = clickedsheetid;\n   this.ele.style.cssText = \"border:1px solid #000;position:absolute;top:200px;left:0px;width=100px;z-index:120\";\n\n   var ele1 = new SocialCalc.SheetBarSheetButtonMenuItem(\"sbsb_deletesheet\",\" Delete Sheet\");\n   this.ele.appendChild(ele1);\n   ele1 = new SocialCalc.SheetBarSheetButtonMenuItem(\"sbsb_hidesheet\",\" Hide Sheet \");\n   this.ele.appendChild(ele1);\n   ele1 = new SocialCalc.SheetBarSheetButtonMenuItem(\"sbsb_unhidesheet\",\" Unhide Sheet \");\n   this.ele.appendChild(ele1);\n   ele1 = new SocialCalc.SheetBarSheetButtonMenuItem(\"sbsb_renamesheet\",\" Rename Sheet \");\n   this.ele.appendChild(ele1);\n   ele1 = new SocialCalc.SheetBarSheetButtonMenuItem(\"sbsb_moveleft\",\" Move Left \");\n   this.ele.appendChild(ele1);\n   ele1 = new SocialCalc.SheetBarSheetButtonMenuItem(\"sbsb_moveright\",\" Move Right \");\n   this.ele.appendChild(ele1);\n   ele1 = new SocialCalc.SheetBarSheetButtonMenuItem(\"sbsb_copysheet\",\" Copy Sheet \");\n   this.ele.appendChild(ele1);\n   ele1 = new SocialCalc.SheetBarSheetButtonMenuItem(\"sbsb_pastesheet\",\" Paste Sheet \");\n   this.ele.appendChild(ele1);\n   ele1 = new SocialCalc.SheetBarSheetButtonMenuItem(\"sbsb_closemenu\",\" Cancel\");\n   this.ele.appendChild(ele1);\n\n\n   SocialCalc.SheetBarSheetButtonMenuPosition(this.ele, clickedsheetid);\n\n   //var clickedsheet = document.getElementById(clickedsheetid);\n   //var position = SocialCalc.GetElementPosition(clickedsheet);\n   //console.log(clickedsheet.offsetHeight,clickedsheet.offsetWidth,clickedsheet.offsetLeft, clickedsheet.offsetTop);\n\n   var control = SocialCalc.GetCurrentWorkBookControl();\n   control.workbook.spreadsheet.editor.toplevel.appendChild(this.ele);\n\n\n\n\n\n}\n\n// position the sheet menu\nSocialCalc.SheetBarSheetButtonMenuPosition = function(menu, clickedsheetid) {\n\n   var hlessbutton = document.getElementById(\"te_lessbuttonh\");\n   \n   //console.log(hlessbutton.style.top, hlessbutton.style.left);\n\n   var sbbutton = document.getElementById(\"sbsb-\"+clickedsheetid);    \n\n   //console.log(sbbutton.offsetLeft,clickedsheetid);\n\n   var top = hlessbutton.style.top.slice(0,-2)-220;\n   var left = sbbutton.offsetLeft+7;\n\n   menu.style.top = top+\"px\";\n   menu.style.left = left+\"px\";\n\n   //console.log(menu.style.top, menu.style.left);    \n}\n\nSocialCalc.ScriptInfo = {\n   scripts : {},\n   handle:null\n};\n\nSocialCalc.ScriptCheck = function(sheetid, coord, text) {\nvar commentstart = text.indexOf(\"<!--script\");\nvar commentend = text.indexOf(\"script-->\");\nif ((commentstart != -1) && (commentend != -1)) {\n   script = text.slice(commentstart+10,commentend);\n   //alert(script);\n   SocialCalc.ScriptInfo.scripts[coord] = script;\n   if (SocialCalc.ScriptInfo.handle == null) {\n   SocialCalc.ScriptInfo.handle =\n   window.setTimeout(SocialCalc.EvalUserScripts,500);\n   }\n   //alert(coord+\"-\"+sheetid);\n}\n}\n\nSocialCalc.EvalUserScript = function(data) {\n   var head = document.getElementsByTagName(\"head\")[0] ||\n            document.documentElement;\n\n   if (data == \"\") return;\n\n   var script = document.createElement(\"script\");\n\n   script.type = \"text/javascript\";\n   try {\n   // doesn't work on ie...\n   script.appendChild(document.createTextNode(data));      \n   } catch(e) {\n   // IE has funky script nodes\n   script.text = data;\n   }\n\n   head.insertBefore(script, head.firstChild);\n   head.removeChild(script);   \n}\n\nSocialCalc.EvalUserScripts = function() {\nfor (var cr in SocialCalc.ScriptInfo.scripts) {\n   SocialCalc.EvalUserScript(SocialCalc.ScriptInfo.scripts[cr]);\n   //console.log(cr,SocialCalc.ScriptInfo.scripts[cr])\n}\nSocialCalc.ScriptInfo.handle = null;\nSocialCalc.ScriptInfo.scripts = {};\n}\n\nSocialCalc.CallOutOnRenderCell = function(sheetobj, value, cr) {\nvar cell=sheetobj.cells[cr];\nif (!cell) return;\nvar valuetype = cell.valuetype || \"\"; // get type of value to determine formatting\nvar valuesubtype = valuetype.substring(1);\nvar sheetattribs=sheetobj.attribs;\nvaluetype = valuetype.charAt(0);\nif (valuetype==\"t\") {\n   valueformat = sheetobj.valueformats[cell.textvalueformat-0] || sheetobj.valueformats[sheetattribs.defaulttextvalueformat-0] || \"\";\n   if (valueformat == \"text-html\") {SocialCalc.ScriptCheck(sheetobj.sheetid,cr,value);}\n}\n}\n\nSocialCalc.GetCellDataValue = function(coord) {\n\n   var sheetname = null;\n   var sheetid = \"\";\n   var bindex = coord.indexOf(\"!\");\n   if (bindex != -1) {\n   sheetname = coord.slice(0,bindex);\n   coord = coord.slice(bindex+1);\n   //console.log(sheetname,coord)\n   }\n   var control = SocialCalc.GetCurrentWorkBookControl();\n   \n   \n   if (sheetname == null) {\n   sheetid = control.currentSheetButton.id\n      } else {\n   sheetid = control.workbook.SheetNameExistsInWorkBook(sheetname);\n   }\n   \n   if ((sheetid == null) || (sheetid == \"\")) {\n   return \"0\";\n   }\n   \n   var sheetobj = control.workbook.sheetArr[sheetid].sheet\n   \n   var cell = sheetobj.cells[coord]\n   \n   if (cell) {return cell.datavalue;} else {return 0;}\n}\n\nSocialCalc.GetCellDataArray = function(coordstr,sheetname) {\n   var vals = []\n   var coords = coordstr.split(\",\");\n   if (sheetname == null) { sheetname=\"\"; }\n   else {\n   sheetname = sheetname+\"!\";\n   }\n   for (var c in coords) {\n   \n   vals.push(SocialCalc.GetCellDataValue(sheetname+coords[c]));\n   }\n   return vals;\n}\n   \nSocialCalc.UserScriptData = {}\n   \n\nSocialCalc.WorkBookRecalculateInfo = {\n   sheets : [],\n   calcorder: [],\n   current: 0,\n   pass: 0\n};\n\nSocialCalc.WorkBookRecalculateAll = function() {\n   // do it from the last sheet to the first sheet\n   // using the recalc-done signal to trigger the next sheet\n\n   // if already in the middle of a recalculate-all, ignore this.\n   if ((SocialCalc.WorkBookRecalculateInfo.current != 0) ||\n      (SocialCalc.WorkBookRecalculateInfo.calcorder.length != 0) ||\n      (SocialCalc.WorkBookRecalculateInfo.sheets.length != 0)) {\n   return;\n   }\n\n\n   var control = SocialCalc.GetCurrentWorkBookControl();\n\n   if (control.workbook.spreadsheet.editor.state != \"start\") {\n   // if in edit return\n   return;\n   }  \n\n\n   SocialCalc.WorkBookRecalculateInfo.current = 0;\n\n   for (var sheet in control.workbook.sheetArr) {\n   SocialCalc.WorkBookRecalculateInfo.sheets.push(sheet);\n   }\n   \n   var i = 0;\n   for (var c=SocialCalc.WorkBookRecalculateInfo.sheets.length;\n   c>0; c--) {\n   SocialCalc.WorkBookRecalculateInfo.calcorder[i] = \n      SocialCalc.WorkBookRecalculateInfo.sheets[c-1];\n   i++;\n   }\n   window.setTimeout(SocialCalc.WorkBookRecalculateStep,500);\n}\n\nSocialCalc.WorkBookRecalculateStep = function() {\n   if (SocialCalc.WorkBookRecalculateInfo.current ==  \n   SocialCalc.WorkBookRecalculateInfo.calcorder.length) {\n   SocialCalc.WorkBookRecalculateInfo.current = 0;\n   SocialCalc.WorkBookRecalculateInfo.calcorder = [];\n      SocialCalc.WorkBookRecalculateInfo.sheets = [];\n   if (SocialCalc.WorkBookRecalculateInfo.pass == \n      1) {\n      SocialCalc.WorkBookRecalculateInfo.pass = 0;\n      SocialCalc.SpinnerWaitHide();\n      //alert(\"load done\");\n      return;\n   } else {\n      SocialCalc.WorkBookRecalculateInfo.pass++;\n      SocialCalc.WorkBookRecalculateAll();\n      return;\n   }\n   }\n   var control = SocialCalc.GetCurrentWorkBookControl();\n   //alert(\"recalculate \"+\n   //   SocialCalc.WorkBookRecalculateInfo.calcorder[\n   //     SocialCalc.WorkBookRecalculateInfo.current]\n   //   );\n   var sheetid = \nSocialCalc.WorkBookRecalculateInfo.calcorder[                     \n                  SocialCalc.WorkBookRecalculateInfo.current];\n   SocialCalc.WorkBookControlActivateSheet(sheetid);\n   SocialCalc.WorkBookRecalculateInfo.current++;\n\n\n   window.setTimeout(SocialCalc.WorkBookRecalculateStep,1000);    \n}\n\n\nSocialCalc.SpinnerWaitCreate = function() {\n   // if the div exists already just use it\n   var ele = document.getElementById(\"waitloadingspinner\");\n   if (ele) {\n   return;\n   }\n   var main = document.createElement(\"div\");\n   main.id = \"waitloadingspinner\";\n\n   main.style.position = \"absolute\";\n\n   var vp = SocialCalc.GetViewportInfo();\n   main.style.top = (vp.height/2)+\"px\";\n   main.style.left = (vp.width/2)+\"px\";\n   main.style.zIndex = 110;\n\n   main.style.width='50px'\n   main.style.height = '50px'\n   main.innerHTML = '<img src=\"static/www/assets/images/spinner.gif\" alt=\"Loading...\" />';\n\n   var control = SocialCalc.GetCurrentWorkBookControl();    \n   control.workbook.spreadsheet.spreadsheetDiv.appendChild(main);\n}\n\nSocialCalc.SpinnerWaitHide = function() {\n   // if the div exists already just use it\n\nvar ele = document.getElementById(\"waitloadingspinner\");\nif (ele) {\n   ele.innerHTML = \"\";\n\n   if (ele.parentNode) {\n   ele.parentNode.removeChild(ele);\n   }\n}\n}\n\nSocialCalc.EditableCells = {};\nSocialCalc.EditableCells.allow = false;\nSocialCalc.EditableCells.cells = {};\n\nSocialCalc.Callbacks.IsCoordEditable = function(sheetcoord) {\n    if (!(SocialCalc.EditableCells.allow)) {\n      // by default all cells are editable\n      return true;\n    }\n    if (SocialCalc.EditableCells.cells[sheetcoord]) {\n      // by default all cells are editable\n      return true;\n    }    \n\n    return false;    \n}\n\nSocialCalc.Callbacks.IsCellEditable = function(editor) {\n    var cellname = editor.workingvalues.currentsheet+\"!\"+editor.ecell.coord;\n    if (!(SocialCalc.EditableCells.allow)) {\n      // by default all cells are editable\n      return true;\n    }\n    if (SocialCalc.EditableCells.cells[cellname]) {\n      // by default all cells are editable\n      return true;\n    }    \n\n    return false;\n}\n\nSocialCalc.IsScrollPossible = function(lastrow, lastcol,\n                   curr_vpos, curr_hpos,\n                   vamount, hamount\n                  ) {\n    //return false;\n    //console.log(lastrow+\",\"+lastcol);\n    //console.log(curr_vpos+\",\"+curr_hpos);    \n    //console.log(vamount+\",\"+hamount);    \n    \n    if (curr_vpos+10+vamount > lastrow ) {\n   return false;\n    }\n    if (curr_hpos+hamount > lastcol) {\n      return false;\n    }\n    return true;\n}\n\n\n\n// this is for checkmark toggling\nSocialCalc.Callbacks.ToggleCell = function(cellname)\n{\n    var control = SocialCalc.GetCurrentWorkBookControl();\n    var sheetid = control.currentSheetButton.id;\n    var sheetobj = control.workbook.sheetArr[sheetid].sheet;\n    var cell = sheetobj.cells[cellname];\n    var sheetname = sheetobj.sheetname;\n    \n    // check if cell is in constraints\n    //console.log(sheetname);\n    //console.log(cellname);\n    \n    var constraint = SocialCalc.EditableCells.constraints[sheetname+\"!\"+cellname];\n    if (!constraint || (constraint[0] != \"tc\")) {\n        return;\n    }\n    \n    var cellinner = document.getElementById(\"cell_\"+cellname)\n    \n    \n    \n    if ((cellinner.innerHTML.indexOf(\"&nbsp;\") != -1)) {\n        // set the value to the img value\n        cellinner.innerHTML = '<div><img src=\"http://imageshack.com/a/img924/3599/c5fBZx.png\" height=\"15\" width=\"15\"></img></div>'\n        if (cell) {//cell.displaystring = '<div><img src=\"http://img689.imageshack.us/img689/9234/checkmark.png\"></img></div>'    ;\n            //cell.datavalue = '<div><img src=\"http://img689.imageshack.us/img689/9234/checkmark.png\"></img></div>'   ;\n            //console.log(\"found cell\")\n            cell.displaystring = '<div><img src=\"http://imageshack.com/a/img924/3599/c5fBZx.png\" height=\"15\" width=\"15\"></img></div>'  ;\n            cell.datavalue = '<div><img src=\"http://imageshack.com/a/img924/3599/c5fBZx.png\" height=\"15\" width=\"15\"></img></div>'   ;\n            //http://img689.imageshack.us/img689/9234/checkmark.png\n        }\n    } else {\n        // set the value to a space\n        cellinner.innerHTML = \"<div>&nbsp;</div>\";\n        if (cell) {cell.datavalue = \"<div>&nbsp;</div>\";cell.displaystring = \"<div>&nbsp;</div>\";}\n    }\n    \n}\n\nSocialCalc.WorkbookControlCreateSheetHTML = function(sheetlist) {\n    \n    var context, div, ele;\n    \n    var result = \"\";\n    \n    var control = SocialCalc.GetCurrentWorkBookControl();\n    \n    div = document.createElement(\"div\");\n    \n    if (!sheetlist) {\n        context = new SocialCalc.RenderContext(spreadsheet.sheet);\n        ele = context.RenderSheet(null, {type: \"html\"});\n        div.appendChild(ele);\n        context = undefined;\n    } else {\n        for (var sheetid in sheetlist) {\n            context = new SocialCalc.RenderContext(control.workbook.sheetArr[sheetid].sheet);\n            ele = context.RenderSheet(null, {type: \"html\"});\n            context = undefined;\n            div.appendChild(ele);\n            if(sheetid.substring(5) == control.sheetCnt){\n                ele.style.pageBreakAfter = \"auto\";\n            }\n            else{\n                ele.style.pageBreakAfter = \"always\";\n            }\n        }\n    }\n    \n    result = div.innerHTML;\n    ele = undefined;\n    div = undefined;\n    //console.log(result);\n    return result;\n    \n}\n\n\n\n\n\n\n\n/*\n    http://www.JSON.org/json2.js\n    2010-08-25\n\n    Public Domain.\n\n    NO WARRANTY EXPRESSED OR IMPLIED. USE AT YOUR OWN RISK.\n\n    See http://www.JSON.org/js.html\n\n\n    This code should be minified before deployment.\n    See http://javascript.crockford.com/jsmin.html\n\n    USE YOUR OWN COPY. IT IS EXTREMELY UNWISE TO LOAD CODE FROM SERVERS YOU DO\n    NOT CONTROL.\n\n\n    This file creates a global JSON object containing two methods: stringify\n    and parse.\n\n        JSON.stringify(value, replacer, space)\n            value       any JavaScript value, usually an object or array.\n\n            replacer    an optional parameter that determines how object\n                        values are stringified for objects. It can be a\n                        function or an array of strings.\n\n            space       an optional parameter that specifies the indentation\n                        of nested structures. If it is omitted, the text will\n                        be packed without extra whitespace. If it is a number,\n                        it will specify the number of spaces to indent at each\n                        level. If it is a string (such as '\\t' or '&nbsp;'),\n                        it contains the characters used to indent at each level.\n\n            This method produces a JSON text from a JavaScript value.\n\n            When an object value is found, if the object contains a toJSON\n            method, its toJSON method will be called and the result will be\n            stringified. A toJSON method does not serialize: it returns the\n            value represented by the name/value pair that should be serialized,\n            or undefined if nothing should be serialized. The toJSON method\n            will be passed the key associated with the value, and this will be\n            bound to the value\n\n            For example, this would serialize Dates as ISO strings.\n\n                Date.prototype.toJSON = function (key) {\n                    function f(n) {\n                        // Format integers to have at least two digits.\n                        return n < 10 ? '0' + n : n;\n                    }\n\n                    return this.getUTCFullYear()   + '-' +\n                         f(this.getUTCMonth() + 1) + '-' +\n                         f(this.getUTCDate())      + 'T' +\n                         f(this.getUTCHours())     + ':' +\n                         f(this.getUTCMinutes())   + ':' +\n                         f(this.getUTCSeconds())   + 'Z';\n                };\n\n            You can provide an optional replacer method. It will be passed the\n            key and value of each member, with this bound to the containing\n            object. The value that is returned from your method will be\n            serialized. If your method returns undefined, then the member will\n            be excluded from the serialization.\n\n            If the replacer parameter is an array of strings, then it will be\n            used to select the members to be serialized. It filters the results\n            such that only members with keys listed in the replacer array are\n            stringified.\n\n            Values that do not have JSON representations, such as undefined or\n            functions, will not be serialized. Such values in objects will be\n            dropped; in arrays they will be replaced with null. You can use\n            a replacer function to replace those with JSON values.\n            JSON.stringify(undefined) returns undefined.\n\n            The optional space parameter produces a stringification of the\n            value that is filled with line breaks and indentation to make it\n            easier to read.\n\n            If the space parameter is a non-empty string, then that string will\n            be used for indentation. If the space parameter is a number, then\n            the indentation will be that many spaces.\n\n            Example:\n\n            text = JSON.stringify(['e', {pluribus: 'unum'}]);\n            // text is '[\"e\",{\"pluribus\":\"unum\"}]'\n\n\n            text = JSON.stringify(['e', {pluribus: 'unum'}], null, '\\t');\n            // text is '[\\n\\t\"e\",\\n\\t{\\n\\t\\t\"pluribus\": \"unum\"\\n\\t}\\n]'\n\n            text = JSON.stringify([new Date()], function (key, value) {\n                return this[key] instanceof Date ?\n                    'Date(' + this[key] + ')' : value;\n            });\n            // text is '[\"Date(---current time---)\"]'\n\n\n        JSON.parse(text, reviver)\n            This method parses a JSON text to produce an object or array.\n            It can throw a SyntaxError exception.\n\n            The optional reviver parameter is a function that can filter and\n            transform the results. It receives each of the keys and values,\n            and its return value is used instead of the original value.\n            If it returns what it received, then the structure is not modified.\n            If it returns undefined then the member is deleted.\n\n            Example:\n\n            // Parse the text. Values that look like ISO date strings will\n            // be converted to Date objects.\n\n            myData = JSON.parse(text, function (key, value) {\n                var a;\n                if (typeof value === 'string') {\n                    a =\n/^(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2}(?:\\.\\d*)?)Z$/.exec(value);\n                    if (a) {\n                        return new Date(Date.UTC(+a[1], +a[2] - 1, +a[3], +a[4],\n                            +a[5], +a[6]));\n                    }\n                }\n                return value;\n            });\n\n            myData = JSON.parse('[\"Date(09/09/2001)\"]', function (key, value) {\n                var d;\n                if (typeof value === 'string' &&\n                        value.slice(0, 5) === 'Date(' &&\n                        value.slice(-1) === ')') {\n                    d = new Date(value.slice(5, -1));\n                    if (d) {\n                        return d;\n                    }\n                }\n                return value;\n            });\n\n\n    This is a reference implementation. You are free to copy, modify, or\n    redistribute.\n*/\n\n/*jslint evil: true, strict: false */\n\n/*members \"\", \"\\b\", \"\\t\", \"\\n\", \"\\f\", \"\\r\", \"\\\"\", JSON, \"\\\\\", apply,\n    call, charCodeAt, getUTCDate, getUTCFullYear, getUTCHours,\n    getUTCMinutes, getUTCMonth, getUTCSeconds, hasOwnProperty, join,\n    lastIndex, length, parse, prototype, push, replace, slice, stringify,\n    test, toJSON, toString, valueOf\n*/\n\n\n// Create a JSON object only if one does not already exist. We create the\n// methods in a closure to avoid creating global variables.\n\nif (!this.JSON) {\n    this.JSON = {};\n}\n\n(function () {\n\n    function f(n) {\n        // Format integers to have at least two digits.\n        return n < 10 ? '0' + n : n;\n    }\n\n    if (typeof Date.prototype.toJSON !== 'function') {\n\n        Date.prototype.toJSON = function (key) {\n\n            return isFinite(this.valueOf()) ?\n                   this.getUTCFullYear()   + '-' +\n                 f(this.getUTCMonth() + 1) + '-' +\n                 f(this.getUTCDate())      + 'T' +\n                 f(this.getUTCHours())     + ':' +\n                 f(this.getUTCMinutes())   + ':' +\n                 f(this.getUTCSeconds())   + 'Z' : null;\n        };\n\n        String.prototype.toJSON =\n        Number.prototype.toJSON =\n        Boolean.prototype.toJSON = function (key) {\n            return this.valueOf();\n        };\n    }\n\n    var cx = /[\\u0000\\u00ad\\u0600-\\u0604\\u070f\\u17b4\\u17b5\\u200c-\\u200f\\u2028-\\u202f\\u2060-\\u206f\\ufeff\\ufff0-\\uffff]/g,\n        escapable = /[\\\\\\\"\\x00-\\x1f\\x7f-\\x9f\\u00ad\\u0600-\\u0604\\u070f\\u17b4\\u17b5\\u200c-\\u200f\\u2028-\\u202f\\u2060-\\u206f\\ufeff\\ufff0-\\uffff]/g,\n        gap,\n        indent,\n        meta = {    // table of character substitutions\n            '\\b': '\\\\b',\n            '\\t': '\\\\t',\n            '\\n': '\\\\n',\n            '\\f': '\\\\f',\n            '\\r': '\\\\r',\n            '\"' : '\\\\\"',\n            '\\\\': '\\\\\\\\'\n        },\n        rep;\n\n\n    function quote(string) {\n\n// If the string contains no control characters, no quote characters, and no\n// backslash characters, then we can safely slap some quotes around it.\n// Otherwise we must also replace the offending characters with safe escape\n// sequences.\n\n        escapable.lastIndex = 0;\n        return escapable.test(string) ?\n            '\"' + string.replace(escapable, function (a) {\n                var c = meta[a];\n                return typeof c === 'string' ? c :\n                    '\\\\u' + ('0000' + a.charCodeAt(0).toString(16)).slice(-4);\n            }) + '\"' :\n            '\"' + string + '\"';\n    }\n\n\n    function str(key, holder) {\n\n// Produce a string from holder[key].\n\n        var i,          // The loop counter.\n            k,          // The member key.\n            v,          // The member value.\n            length,\n            mind = gap,\n            partial,\n            value = holder[key];\n\n// If the value has a toJSON method, call it to obtain a replacement value.\n\n        if (value && typeof value === 'object' &&\n                typeof value.toJSON === 'function') {\n            value = value.toJSON(key);\n        }\n\n// If we were called with a replacer function, then call the replacer to\n// obtain a replacement value.\n\n        if (typeof rep === 'function') {\n            value = rep.call(holder, key, value);\n        }\n\n// What happens next depends on the value's type.\n\n        switch (typeof value) {\n        case 'string':\n            return quote(value);\n\n        case 'number':\n\n// JSON numbers must be finite. Encode non-finite numbers as null.\n\n            return isFinite(value) ? String(value) : 'null';\n\n        case 'boolean':\n        case 'null':\n\n// If the value is a boolean or null, convert it to a string. Note:\n// typeof null does not produce 'null'. The case is included here in\n// the remote chance that this gets fixed someday.\n\n            return String(value);\n\n// If the type is 'object', we might be dealing with an object or an array or\n// null.\n\n        case 'object':\n\n// Due to a specification blunder in ECMAScript, typeof null is 'object',\n// so watch out for that case.\n\n            if (!value) {\n                return 'null';\n            }\n\n// Make an array to hold the partial results of stringifying this object value.\n\n            gap += indent;\n            partial = [];\n\n// Is the value an array?\n\n            if (Object.prototype.toString.apply(value) === '[object Array]') {\n\n// The value is an array. Stringify every element. Use null as a placeholder\n// for non-JSON values.\n\n                length = value.length;\n                for (i = 0; i < length; i += 1) {\n                    partial[i] = str(i, value) || 'null';\n                }\n\n// Join all of the elements together, separated with commas, and wrap them in\n// brackets.\n\n                v = partial.length === 0 ? '[]' :\n                    gap ? '[\\n' + gap +\n                            partial.join(',\\n' + gap) + '\\n' +\n                                mind + ']' :\n                          '[' + partial.join(',') + ']';\n                gap = mind;\n                return v;\n            }\n\n// If the replacer is an array, use it to select the members to be stringified.\n\n            if (rep && typeof rep === 'object') {\n                length = rep.length;\n                for (i = 0; i < length; i += 1) {\n                    k = rep[i];\n                    if (typeof k === 'string') {\n                        v = str(k, value);\n                        if (v) {\n                            partial.push(quote(k) + (gap ? ': ' : ':') + v);\n                        }\n                    }\n                }\n            } else {\n\n// Otherwise, iterate through all of the keys in the object.\n\n                for (k in value) {\n                    if (Object.hasOwnProperty.call(value, k)) {\n                        v = str(k, value);\n                        if (v) {\n                            partial.push(quote(k) + (gap ? ': ' : ':') + v);\n                        }\n                    }\n                }\n            }\n\n// Join all of the member texts together, separated with commas,\n// and wrap them in braces.\n\n            v = partial.length === 0 ? '{}' :\n                gap ? '{\\n' + gap + partial.join(',\\n' + gap) + '\\n' +\n                        mind + '}' : '{' + partial.join(',') + '}';\n            gap = mind;\n            return v;\n        }\n    }\n\n// If the JSON object does not yet have a stringify method, give it one.\n\n    if (typeof JSON.stringify !== 'function') {\n        JSON.stringify = function (value, replacer, space) {\n\n// The stringify method takes a value and an optional replacer, and an optional\n// space parameter, and returns a JSON text. The replacer can be a function\n// that can replace values, or an array of strings that will select the keys.\n// A default replacer method can be provided. Use of the space parameter can\n// produce text that is more easily readable.\n\n            var i;\n            gap = '';\n            indent = '';\n\n// If the space parameter is a number, make an indent string containing that\n// many spaces.\n\n            if (typeof space === 'number') {\n                for (i = 0; i < space; i += 1) {\n                    indent += ' ';\n                }\n\n// If the space parameter is a string, it will be used as the indent string.\n\n            } else if (typeof space === 'string') {\n                indent = space;\n            }\n\n// If there is a replacer, it must be a function or an array.\n// Otherwise, throw an error.\n\n            rep = replacer;\n            if (replacer && typeof replacer !== 'function' &&\n                    (typeof replacer !== 'object' ||\n                     typeof replacer.length !== 'number')) {\n                throw new Error('JSON.stringify');\n            }\n\n// Make a fake root object containing our value under the key of ''.\n// Return the result of stringifying the value.\n\n            return str('', {'': value});\n        };\n    }\n\n\n// If the JSON object does not yet have a parse method, give it one.\n\n    if (typeof JSON.parse !== 'function') {\n        JSON.parse = function (text, reviver) {\n\n// The parse method takes a text and an optional reviver function, and returns\n// a JavaScript value if the text is a valid JSON text.\n\n            var j;\n\n            function walk(holder, key) {\n\n// The walk method is used to recursively walk the resulting structure so\n// that modifications can be made.\n\n                var k, v, value = holder[key];\n                if (value && typeof value === 'object') {\n                    for (k in value) {\n                        if (Object.hasOwnProperty.call(value, k)) {\n                            v = walk(value, k);\n                            if (v !== undefined) {\n                                value[k] = v;\n                            } else {\n                                delete value[k];\n                            }\n                        }\n                    }\n                }\n                return reviver.call(holder, key, value);\n            }\n\n\n// Parsing happens in four stages. In the first stage, we replace certain\n// Unicode characters with escape sequences. JavaScript handles many characters\n// incorrectly, either silently deleting them, or treating them as line endings.\n\n            text = String(text);\n            cx.lastIndex = 0;\n            if (cx.test(text)) {\n                text = text.replace(cx, function (a) {\n                    return '\\\\u' +\n                        ('0000' + a.charCodeAt(0).toString(16)).slice(-4);\n                });\n            }\n\n// In the second stage, we run the text against regular expressions that look\n// for non-JSON patterns. We are especially concerned with '()' and 'new'\n// because they can cause invocation, and '=' because it can cause mutation.\n// But just to be safe, we want to reject all unexpected forms.\n\n// We split the second stage into 4 regexp operations in order to work around\n// crippling inefficiencies in IE's and Safari's regexp engines. First we\n// replace the JSON backslash pairs with '@' (a non-JSON character). Second, we\n// replace all simple value tokens with ']' characters. Third, we delete all\n// open brackets that follow a colon or comma or that begin the text. Finally,\n// we look to see that the remaining characters are only whitespace or ']' or\n// ',' or ':' or '{' or '}'. If that is so, then the text is safe for eval.\n\n            if (/^[\\],:{}\\s]*$/\n.test(text.replace(/\\\\(?:[\"\\\\\\/bfnrt]|u[0-9a-fA-F]{4})/g, '@')\n.replace(/\"[^\"\\\\\\n\\r]*\"|true|false|null|-?\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d+)?/g, ']')\n.replace(/(?:^|:|,)(?:\\s*\\[)+/g, ''))) {\n\n// In the third stage we use the eval function to compile the text into a\n// JavaScript structure. The '{' operator is subject to a syntactic ambiguity\n// in JavaScript: it can begin a block or an object literal. We wrap the text\n// in parens to eliminate the ambiguity.\n\n                j = eval('(' + text + ')');\n\n// In the optional fourth stage, we recursively walk the new structure, passing\n// each name/value pair to a reviver function for possible transformation.\n\n                return typeof reviver === 'function' ?\n                    walk({'': j}, '') : j;\n            }\n\n// If the text is not JSON parseable, then a SyntaxError is thrown.\n\n            throw new SyntaxError('JSON.parse');\n        };\n    }\n}());\n\n\nSocialCalc.oldBtnActive = 1;\nSocialCalc.Constants.defaultImagePrefix = \"www/assets/images/sc_\";\nSocialCalc.Constants.defaultGridCSS = \"\";\nSocialCalc.Constants.SCNoColNames = true;\nSocialCalc.Constants.SCNoRowName = true;\nSocialCalc.Constants.defaultRownameStyle = \"\";\nSocialCalc.Constants.defaultSelectedRownameStyle = \"\";\nSocialCalc.Popup.imagePrefix = \"www/assets/images/sc_\";\n\nSocialCalc.ToggleInputLineButtons = function(show) {\n    var bele = document.getElementById(\"testtest\");\n    if (!bele) return;\n        if (show) {\n            bele.style.display = \"inline\";\n        } else {\n            bele.style.display = \"none\";\n        }\n    }\n\nSocialCalc.InputLineClearText = function() {\n    spreadsheet.editor.inputBox.SetText(\"\");\n}\n\nSocialCalc.Callbacks.broadcast = function(type, data) {\n\n}\n\n\n\n\n// END OF FILE\n\nif('undefined' === typeof document) {\n  // We don't really need a DOM-based presentation layer on the server\n  SocialCalc.GetEditorCellElement = function () {};\n  SocialCalc.ReplaceCell = function () {};\n  SocialCalc.EditorRenderSheet = function () {};\n  SocialCalc.SpreadsheetControlSortSave = function () { return \"\" };\n  SocialCalc.SpreadsheetControlStatuslineCallback = function () {};\n  SocialCalc.DoPositionCalculations = function (editor) {\n      SocialCalc.EditorSheetStatusCallback(\n     null, \"doneposcalc\", null, editor\n      );\n  }\n}\n\n// Compatibility with webworker-threads\nif (typeof self !== 'undefined' && self.thread) {\n    window.setTimeout = function (cb, ms) {\n        if (ms <= 1) { self.thread.nextTick(cb); }\n    };\n    window.clearTimeout = function () {};\n}\n\n    // Just return a value to define the module export.\n    return SocialCalc;\n}));\n\n\n// WEBPACK FOOTER //\n// ./src/socialcalc/aspiring/SocialCalc.js","import 'whatwg-fetch';\n\nconst BASE_URL = 'http://aspiringapps.com/api';\n\nexport class Cloud {\n\n\t_auth(data){\n        let url = BASE_URL+\"/login\";\n        let body = JSON.stringify({ data: data});\n        return fetch(url, {\n\t\t  method: 'POST',\n\t\t  headers: {\n\t\t    'Content-Type': 'application/json'\n\t\t  },\n\t\t  body: body\n\t\t}).then(response => {\n\t\t\tconsole.log('request succeeded with JSON response', response)\n\t\t});\n    }\n\n    _checkStatus(response) {\n\t\tif (response.status >= 200 && response.status < 300) {\n\t\t\treturn response\n\t\t} else {\n\t\t\tvar error = new Error(response.statusText)\n\t\t\terror.response = response\n\t\t\tthrow error\n\t\t}\n\t}\n\n\t_parseJSON(response) {\n  \t\treturn response.json()\n\t}\n\n}\n\n\n// WEBPACK FOOTER //\n// ./src/storage/CloudStorage.js","'use strict';\n\n//This file contains the ES6 extensions to the core Promises/A+ API\n\nvar Promise = require('./core.js');\n\nmodule.exports = Promise;\n\n/* Static Functions */\n\nvar TRUE = valuePromise(true);\nvar FALSE = valuePromise(false);\nvar NULL = valuePromise(null);\nvar UNDEFINED = valuePromise(undefined);\nvar ZERO = valuePromise(0);\nvar EMPTYSTRING = valuePromise('');\n\nfunction valuePromise(value) {\n  var p = new Promise(Promise._61);\n  p._81 = 1;\n  p._65 = value;\n  return p;\n}\nPromise.resolve = function (value) {\n  if (value instanceof Promise) return value;\n\n  if (value === null) return NULL;\n  if (value === undefined) return UNDEFINED;\n  if (value === true) return TRUE;\n  if (value === false) return FALSE;\n  if (value === 0) return ZERO;\n  if (value === '') return EMPTYSTRING;\n\n  if (typeof value === 'object' || typeof value === 'function') {\n    try {\n      var then = value.then;\n      if (typeof then === 'function') {\n        return new Promise(then.bind(value));\n      }\n    } catch (ex) {\n      return new Promise(function (resolve, reject) {\n        reject(ex);\n      });\n    }\n  }\n  return valuePromise(value);\n};\n\nPromise.all = function (arr) {\n  var args = Array.prototype.slice.call(arr);\n\n  return new Promise(function (resolve, reject) {\n    if (args.length === 0) return resolve([]);\n    var remaining = args.length;\n    function res(i, val) {\n      if (val && (typeof val === 'object' || typeof val === 'function')) {\n        if (val instanceof Promise && val.then === Promise.prototype.then) {\n          while (val._81 === 3) {\n            val = val._65;\n          }\n          if (val._81 === 1) return res(i, val._65);\n          if (val._81 === 2) reject(val._65);\n          val.then(function (val) {\n            res(i, val);\n          }, reject);\n          return;\n        } else {\n          var then = val.then;\n          if (typeof then === 'function') {\n            var p = new Promise(then.bind(val));\n            p.then(function (val) {\n              res(i, val);\n            }, reject);\n            return;\n          }\n        }\n      }\n      args[i] = val;\n      if (--remaining === 0) {\n        resolve(args);\n      }\n    }\n    for (var i = 0; i < args.length; i++) {\n      res(i, args[i]);\n    }\n  });\n};\n\nPromise.reject = function (value) {\n  return new Promise(function (resolve, reject) {\n    reject(value);\n  });\n};\n\nPromise.race = function (values) {\n  return new Promise(function (resolve, reject) {\n    values.forEach(function(value){\n      Promise.resolve(value).then(resolve, reject);\n    });\n  });\n};\n\n/* Prototype Methods */\n\nPromise.prototype['catch'] = function (onRejected) {\n  return this.then(null, onRejected);\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/promise/lib/es6-extensions.js\n// module id = 20\n// module chunks = 0","'use strict';\n\nvar Promise = require('./core');\n\nvar DEFAULT_WHITELIST = [\n  ReferenceError,\n  TypeError,\n  RangeError\n];\n\nvar enabled = false;\nexports.disable = disable;\nfunction disable() {\n  enabled = false;\n  Promise._10 = null;\n  Promise._97 = null;\n}\n\nexports.enable = enable;\nfunction enable(options) {\n  options = options || {};\n  if (enabled) disable();\n  enabled = true;\n  var id = 0;\n  var displayId = 0;\n  var rejections = {};\n  Promise._10 = function (promise) {\n    if (\n      promise._81 === 2 && // IS REJECTED\n      rejections[promise._72]\n    ) {\n      if (rejections[promise._72].logged) {\n        onHandled(promise._72);\n      } else {\n        clearTimeout(rejections[promise._72].timeout);\n      }\n      delete rejections[promise._72];\n    }\n  };\n  Promise._97 = function (promise, err) {\n    if (promise._45 === 0) { // not yet handled\n      promise._72 = id++;\n      rejections[promise._72] = {\n        displayId: null,\n        error: err,\n        timeout: setTimeout(\n          onUnhandled.bind(null, promise._72),\n          // For reference errors and type errors, this almost always\n          // means the programmer made a mistake, so log them after just\n          // 100ms\n          // otherwise, wait 2 seconds to see if they get handled\n          matchWhitelist(err, DEFAULT_WHITELIST)\n            ? 100\n            : 2000\n        ),\n        logged: false\n      };\n    }\n  };\n  function onUnhandled(id) {\n    if (\n      options.allRejections ||\n      matchWhitelist(\n        rejections[id].error,\n        options.whitelist || DEFAULT_WHITELIST\n      )\n    ) {\n      rejections[id].displayId = displayId++;\n      if (options.onUnhandled) {\n        rejections[id].logged = true;\n        options.onUnhandled(\n          rejections[id].displayId,\n          rejections[id].error\n        );\n      } else {\n        rejections[id].logged = true;\n        logError(\n          rejections[id].displayId,\n          rejections[id].error\n        );\n      }\n    }\n  }\n  function onHandled(id) {\n    if (rejections[id].logged) {\n      if (options.onHandled) {\n        options.onHandled(rejections[id].displayId, rejections[id].error);\n      } else if (!rejections[id].onUnhandled) {\n        console.warn(\n          'Promise Rejection Handled (id: ' + rejections[id].displayId + '):'\n        );\n        console.warn(\n          '  This means you can ignore any previous messages of the form \"Possible Unhandled Promise Rejection\" with id ' +\n          rejections[id].displayId + '.'\n        );\n      }\n    }\n  }\n}\n\nfunction logError(id, error) {\n  console.warn('Possible Unhandled Promise Rejection (id: ' + id + '):');\n  var errStr = (error && (error.stack || error)) + '';\n  errStr.split('\\n').forEach(function (line) {\n    console.warn('  ' + line);\n  });\n}\n\nfunction matchWhitelist(error, list) {\n  return list.some(function (cls) {\n    return error instanceof cls;\n  });\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/promise/lib/rejection-tracking.js\n// module id = 21\n// module chunks = 0","/** @license React v16.14.0\n * react-dom.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n/*\n Modernizr 3.0.0pre (Custom Build) | MIT\n*/\n'use strict';var aa=require(\"react\"),n=require(\"object-assign\"),r=require(\"scheduler\");function u(a){for(var b=\"https://reactjs.org/docs/error-decoder.html?invariant=\"+a,c=1;c<arguments.length;c++)b+=\"&args[]=\"+encodeURIComponent(arguments[c]);return\"Minified React error #\"+a+\"; visit \"+b+\" for the full message or use the non-minified dev environment for full errors and additional helpful warnings.\"}if(!aa)throw Error(u(227));\nfunction ba(a,b,c,d,e,f,g,h,k){var l=Array.prototype.slice.call(arguments,3);try{b.apply(c,l)}catch(m){this.onError(m)}}var da=!1,ea=null,fa=!1,ha=null,ia={onError:function(a){da=!0;ea=a}};function ja(a,b,c,d,e,f,g,h,k){da=!1;ea=null;ba.apply(ia,arguments)}function ka(a,b,c,d,e,f,g,h,k){ja.apply(this,arguments);if(da){if(da){var l=ea;da=!1;ea=null}else throw Error(u(198));fa||(fa=!0,ha=l)}}var la=null,ma=null,na=null;\nfunction oa(a,b,c){var d=a.type||\"unknown-event\";a.currentTarget=na(c);ka(d,b,void 0,a);a.currentTarget=null}var pa=null,qa={};\nfunction ra(){if(pa)for(var a in qa){var b=qa[a],c=pa.indexOf(a);if(!(-1<c))throw Error(u(96,a));if(!sa[c]){if(!b.extractEvents)throw Error(u(97,a));sa[c]=b;c=b.eventTypes;for(var d in c){var e=void 0;var f=c[d],g=b,h=d;if(ta.hasOwnProperty(h))throw Error(u(99,h));ta[h]=f;var k=f.phasedRegistrationNames;if(k){for(e in k)k.hasOwnProperty(e)&&ua(k[e],g,h);e=!0}else f.registrationName?(ua(f.registrationName,g,h),e=!0):e=!1;if(!e)throw Error(u(98,d,a));}}}}\nfunction ua(a,b,c){if(va[a])throw Error(u(100,a));va[a]=b;wa[a]=b.eventTypes[c].dependencies}var sa=[],ta={},va={},wa={};function xa(a){var b=!1,c;for(c in a)if(a.hasOwnProperty(c)){var d=a[c];if(!qa.hasOwnProperty(c)||qa[c]!==d){if(qa[c])throw Error(u(102,c));qa[c]=d;b=!0}}b&&ra()}var ya=!(\"undefined\"===typeof window||\"undefined\"===typeof window.document||\"undefined\"===typeof window.document.createElement),za=null,Aa=null,Ba=null;\nfunction Ca(a){if(a=ma(a)){if(\"function\"!==typeof za)throw Error(u(280));var b=a.stateNode;b&&(b=la(b),za(a.stateNode,a.type,b))}}function Da(a){Aa?Ba?Ba.push(a):Ba=[a]:Aa=a}function Ea(){if(Aa){var a=Aa,b=Ba;Ba=Aa=null;Ca(a);if(b)for(a=0;a<b.length;a++)Ca(b[a])}}function Fa(a,b){return a(b)}function Ga(a,b,c,d,e){return a(b,c,d,e)}function Ha(){}var Ia=Fa,Ja=!1,Ka=!1;function La(){if(null!==Aa||null!==Ba)Ha(),Ea()}\nfunction Ma(a,b,c){if(Ka)return a(b,c);Ka=!0;try{return Ia(a,b,c)}finally{Ka=!1,La()}}var Na=/^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$/,Oa=Object.prototype.hasOwnProperty,Pa={},Qa={};\nfunction Ra(a){if(Oa.call(Qa,a))return!0;if(Oa.call(Pa,a))return!1;if(Na.test(a))return Qa[a]=!0;Pa[a]=!0;return!1}function Sa(a,b,c,d){if(null!==c&&0===c.type)return!1;switch(typeof b){case \"function\":case \"symbol\":return!0;case \"boolean\":if(d)return!1;if(null!==c)return!c.acceptsBooleans;a=a.toLowerCase().slice(0,5);return\"data-\"!==a&&\"aria-\"!==a;default:return!1}}\nfunction Ta(a,b,c,d){if(null===b||\"undefined\"===typeof b||Sa(a,b,c,d))return!0;if(d)return!1;if(null!==c)switch(c.type){case 3:return!b;case 4:return!1===b;case 5:return isNaN(b);case 6:return isNaN(b)||1>b}return!1}function v(a,b,c,d,e,f){this.acceptsBooleans=2===b||3===b||4===b;this.attributeName=d;this.attributeNamespace=e;this.mustUseProperty=c;this.propertyName=a;this.type=b;this.sanitizeURL=f}var C={};\n\"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style\".split(\" \").forEach(function(a){C[a]=new v(a,0,!1,a,null,!1)});[[\"acceptCharset\",\"accept-charset\"],[\"className\",\"class\"],[\"htmlFor\",\"for\"],[\"httpEquiv\",\"http-equiv\"]].forEach(function(a){var b=a[0];C[b]=new v(b,1,!1,a[1],null,!1)});[\"contentEditable\",\"draggable\",\"spellCheck\",\"value\"].forEach(function(a){C[a]=new v(a,2,!1,a.toLowerCase(),null,!1)});\n[\"autoReverse\",\"externalResourcesRequired\",\"focusable\",\"preserveAlpha\"].forEach(function(a){C[a]=new v(a,2,!1,a,null,!1)});\"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope\".split(\" \").forEach(function(a){C[a]=new v(a,3,!1,a.toLowerCase(),null,!1)});\n[\"checked\",\"multiple\",\"muted\",\"selected\"].forEach(function(a){C[a]=new v(a,3,!0,a,null,!1)});[\"capture\",\"download\"].forEach(function(a){C[a]=new v(a,4,!1,a,null,!1)});[\"cols\",\"rows\",\"size\",\"span\"].forEach(function(a){C[a]=new v(a,6,!1,a,null,!1)});[\"rowSpan\",\"start\"].forEach(function(a){C[a]=new v(a,5,!1,a.toLowerCase(),null,!1)});var Ua=/[\\-:]([a-z])/g;function Va(a){return a[1].toUpperCase()}\n\"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height\".split(\" \").forEach(function(a){var b=a.replace(Ua,\nVa);C[b]=new v(b,1,!1,a,null,!1)});\"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type\".split(\" \").forEach(function(a){var b=a.replace(Ua,Va);C[b]=new v(b,1,!1,a,\"http://www.w3.org/1999/xlink\",!1)});[\"xml:base\",\"xml:lang\",\"xml:space\"].forEach(function(a){var b=a.replace(Ua,Va);C[b]=new v(b,1,!1,a,\"http://www.w3.org/XML/1998/namespace\",!1)});[\"tabIndex\",\"crossOrigin\"].forEach(function(a){C[a]=new v(a,1,!1,a.toLowerCase(),null,!1)});\nC.xlinkHref=new v(\"xlinkHref\",1,!1,\"xlink:href\",\"http://www.w3.org/1999/xlink\",!0);[\"src\",\"href\",\"action\",\"formAction\"].forEach(function(a){C[a]=new v(a,1,!1,a.toLowerCase(),null,!0)});var Wa=aa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;Wa.hasOwnProperty(\"ReactCurrentDispatcher\")||(Wa.ReactCurrentDispatcher={current:null});Wa.hasOwnProperty(\"ReactCurrentBatchConfig\")||(Wa.ReactCurrentBatchConfig={suspense:null});\nfunction Xa(a,b,c,d){var e=C.hasOwnProperty(b)?C[b]:null;var f=null!==e?0===e.type:d?!1:!(2<b.length)||\"o\"!==b[0]&&\"O\"!==b[0]||\"n\"!==b[1]&&\"N\"!==b[1]?!1:!0;f||(Ta(b,c,e,d)&&(c=null),d||null===e?Ra(b)&&(null===c?a.removeAttribute(b):a.setAttribute(b,\"\"+c)):e.mustUseProperty?a[e.propertyName]=null===c?3===e.type?!1:\"\":c:(b=e.attributeName,d=e.attributeNamespace,null===c?a.removeAttribute(b):(e=e.type,c=3===e||4===e&&!0===c?\"\":\"\"+c,d?a.setAttributeNS(d,b,c):a.setAttribute(b,c))))}\nvar Ya=/^(.*)[\\\\\\/]/,E=\"function\"===typeof Symbol&&Symbol.for,Za=E?Symbol.for(\"react.element\"):60103,$a=E?Symbol.for(\"react.portal\"):60106,ab=E?Symbol.for(\"react.fragment\"):60107,bb=E?Symbol.for(\"react.strict_mode\"):60108,cb=E?Symbol.for(\"react.profiler\"):60114,db=E?Symbol.for(\"react.provider\"):60109,eb=E?Symbol.for(\"react.context\"):60110,fb=E?Symbol.for(\"react.concurrent_mode\"):60111,gb=E?Symbol.for(\"react.forward_ref\"):60112,hb=E?Symbol.for(\"react.suspense\"):60113,ib=E?Symbol.for(\"react.suspense_list\"):\n60120,jb=E?Symbol.for(\"react.memo\"):60115,kb=E?Symbol.for(\"react.lazy\"):60116,lb=E?Symbol.for(\"react.block\"):60121,mb=\"function\"===typeof Symbol&&Symbol.iterator;function nb(a){if(null===a||\"object\"!==typeof a)return null;a=mb&&a[mb]||a[\"@@iterator\"];return\"function\"===typeof a?a:null}function ob(a){if(-1===a._status){a._status=0;var b=a._ctor;b=b();a._result=b;b.then(function(b){0===a._status&&(b=b.default,a._status=1,a._result=b)},function(b){0===a._status&&(a._status=2,a._result=b)})}}\nfunction pb(a){if(null==a)return null;if(\"function\"===typeof a)return a.displayName||a.name||null;if(\"string\"===typeof a)return a;switch(a){case ab:return\"Fragment\";case $a:return\"Portal\";case cb:return\"Profiler\";case bb:return\"StrictMode\";case hb:return\"Suspense\";case ib:return\"SuspenseList\"}if(\"object\"===typeof a)switch(a.$$typeof){case eb:return\"Context.Consumer\";case db:return\"Context.Provider\";case gb:var b=a.render;b=b.displayName||b.name||\"\";return a.displayName||(\"\"!==b?\"ForwardRef(\"+b+\")\":\n\"ForwardRef\");case jb:return pb(a.type);case lb:return pb(a.render);case kb:if(a=1===a._status?a._result:null)return pb(a)}return null}function qb(a){var b=\"\";do{a:switch(a.tag){case 3:case 4:case 6:case 7:case 10:case 9:var c=\"\";break a;default:var d=a._debugOwner,e=a._debugSource,f=pb(a.type);c=null;d&&(c=pb(d.type));d=f;f=\"\";e?f=\" (at \"+e.fileName.replace(Ya,\"\")+\":\"+e.lineNumber+\")\":c&&(f=\" (created by \"+c+\")\");c=\"\\n    in \"+(d||\"Unknown\")+f}b+=c;a=a.return}while(a);return b}\nfunction rb(a){switch(typeof a){case \"boolean\":case \"number\":case \"object\":case \"string\":case \"undefined\":return a;default:return\"\"}}function sb(a){var b=a.type;return(a=a.nodeName)&&\"input\"===a.toLowerCase()&&(\"checkbox\"===b||\"radio\"===b)}\nfunction tb(a){var b=sb(a)?\"checked\":\"value\",c=Object.getOwnPropertyDescriptor(a.constructor.prototype,b),d=\"\"+a[b];if(!a.hasOwnProperty(b)&&\"undefined\"!==typeof c&&\"function\"===typeof c.get&&\"function\"===typeof c.set){var e=c.get,f=c.set;Object.defineProperty(a,b,{configurable:!0,get:function(){return e.call(this)},set:function(a){d=\"\"+a;f.call(this,a)}});Object.defineProperty(a,b,{enumerable:c.enumerable});return{getValue:function(){return d},setValue:function(a){d=\"\"+a},stopTracking:function(){a._valueTracker=\nnull;delete a[b]}}}}function xb(a){a._valueTracker||(a._valueTracker=tb(a))}function yb(a){if(!a)return!1;var b=a._valueTracker;if(!b)return!0;var c=b.getValue();var d=\"\";a&&(d=sb(a)?a.checked?\"true\":\"false\":a.value);a=d;return a!==c?(b.setValue(a),!0):!1}function zb(a,b){var c=b.checked;return n({},b,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=c?c:a._wrapperState.initialChecked})}\nfunction Ab(a,b){var c=null==b.defaultValue?\"\":b.defaultValue,d=null!=b.checked?b.checked:b.defaultChecked;c=rb(null!=b.value?b.value:c);a._wrapperState={initialChecked:d,initialValue:c,controlled:\"checkbox\"===b.type||\"radio\"===b.type?null!=b.checked:null!=b.value}}function Bb(a,b){b=b.checked;null!=b&&Xa(a,\"checked\",b,!1)}\nfunction Cb(a,b){Bb(a,b);var c=rb(b.value),d=b.type;if(null!=c)if(\"number\"===d){if(0===c&&\"\"===a.value||a.value!=c)a.value=\"\"+c}else a.value!==\"\"+c&&(a.value=\"\"+c);else if(\"submit\"===d||\"reset\"===d){a.removeAttribute(\"value\");return}b.hasOwnProperty(\"value\")?Db(a,b.type,c):b.hasOwnProperty(\"defaultValue\")&&Db(a,b.type,rb(b.defaultValue));null==b.checked&&null!=b.defaultChecked&&(a.defaultChecked=!!b.defaultChecked)}\nfunction Eb(a,b,c){if(b.hasOwnProperty(\"value\")||b.hasOwnProperty(\"defaultValue\")){var d=b.type;if(!(\"submit\"!==d&&\"reset\"!==d||void 0!==b.value&&null!==b.value))return;b=\"\"+a._wrapperState.initialValue;c||b===a.value||(a.value=b);a.defaultValue=b}c=a.name;\"\"!==c&&(a.name=\"\");a.defaultChecked=!!a._wrapperState.initialChecked;\"\"!==c&&(a.name=c)}\nfunction Db(a,b,c){if(\"number\"!==b||a.ownerDocument.activeElement!==a)null==c?a.defaultValue=\"\"+a._wrapperState.initialValue:a.defaultValue!==\"\"+c&&(a.defaultValue=\"\"+c)}function Fb(a){var b=\"\";aa.Children.forEach(a,function(a){null!=a&&(b+=a)});return b}function Gb(a,b){a=n({children:void 0},b);if(b=Fb(b.children))a.children=b;return a}\nfunction Hb(a,b,c,d){a=a.options;if(b){b={};for(var e=0;e<c.length;e++)b[\"$\"+c[e]]=!0;for(c=0;c<a.length;c++)e=b.hasOwnProperty(\"$\"+a[c].value),a[c].selected!==e&&(a[c].selected=e),e&&d&&(a[c].defaultSelected=!0)}else{c=\"\"+rb(c);b=null;for(e=0;e<a.length;e++){if(a[e].value===c){a[e].selected=!0;d&&(a[e].defaultSelected=!0);return}null!==b||a[e].disabled||(b=a[e])}null!==b&&(b.selected=!0)}}\nfunction Ib(a,b){if(null!=b.dangerouslySetInnerHTML)throw Error(u(91));return n({},b,{value:void 0,defaultValue:void 0,children:\"\"+a._wrapperState.initialValue})}function Jb(a,b){var c=b.value;if(null==c){c=b.children;b=b.defaultValue;if(null!=c){if(null!=b)throw Error(u(92));if(Array.isArray(c)){if(!(1>=c.length))throw Error(u(93));c=c[0]}b=c}null==b&&(b=\"\");c=b}a._wrapperState={initialValue:rb(c)}}\nfunction Kb(a,b){var c=rb(b.value),d=rb(b.defaultValue);null!=c&&(c=\"\"+c,c!==a.value&&(a.value=c),null==b.defaultValue&&a.defaultValue!==c&&(a.defaultValue=c));null!=d&&(a.defaultValue=\"\"+d)}function Lb(a){var b=a.textContent;b===a._wrapperState.initialValue&&\"\"!==b&&null!==b&&(a.value=b)}var Mb={html:\"http://www.w3.org/1999/xhtml\",mathml:\"http://www.w3.org/1998/Math/MathML\",svg:\"http://www.w3.org/2000/svg\"};\nfunction Nb(a){switch(a){case \"svg\":return\"http://www.w3.org/2000/svg\";case \"math\":return\"http://www.w3.org/1998/Math/MathML\";default:return\"http://www.w3.org/1999/xhtml\"}}function Ob(a,b){return null==a||\"http://www.w3.org/1999/xhtml\"===a?Nb(b):\"http://www.w3.org/2000/svg\"===a&&\"foreignObject\"===b?\"http://www.w3.org/1999/xhtml\":a}\nvar Pb,Qb=function(a){return\"undefined\"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(b,c,d,e){MSApp.execUnsafeLocalFunction(function(){return a(b,c,d,e)})}:a}(function(a,b){if(a.namespaceURI!==Mb.svg||\"innerHTML\"in a)a.innerHTML=b;else{Pb=Pb||document.createElement(\"div\");Pb.innerHTML=\"<svg>\"+b.valueOf().toString()+\"</svg>\";for(b=Pb.firstChild;a.firstChild;)a.removeChild(a.firstChild);for(;b.firstChild;)a.appendChild(b.firstChild)}});\nfunction Rb(a,b){if(b){var c=a.firstChild;if(c&&c===a.lastChild&&3===c.nodeType){c.nodeValue=b;return}}a.textContent=b}function Sb(a,b){var c={};c[a.toLowerCase()]=b.toLowerCase();c[\"Webkit\"+a]=\"webkit\"+b;c[\"Moz\"+a]=\"moz\"+b;return c}var Tb={animationend:Sb(\"Animation\",\"AnimationEnd\"),animationiteration:Sb(\"Animation\",\"AnimationIteration\"),animationstart:Sb(\"Animation\",\"AnimationStart\"),transitionend:Sb(\"Transition\",\"TransitionEnd\")},Ub={},Vb={};\nya&&(Vb=document.createElement(\"div\").style,\"AnimationEvent\"in window||(delete Tb.animationend.animation,delete Tb.animationiteration.animation,delete Tb.animationstart.animation),\"TransitionEvent\"in window||delete Tb.transitionend.transition);function Wb(a){if(Ub[a])return Ub[a];if(!Tb[a])return a;var b=Tb[a],c;for(c in b)if(b.hasOwnProperty(c)&&c in Vb)return Ub[a]=b[c];return a}\nvar Xb=Wb(\"animationend\"),Yb=Wb(\"animationiteration\"),Zb=Wb(\"animationstart\"),$b=Wb(\"transitionend\"),ac=\"abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting\".split(\" \"),bc=new (\"function\"===typeof WeakMap?WeakMap:Map);function cc(a){var b=bc.get(a);void 0===b&&(b=new Map,bc.set(a,b));return b}\nfunction dc(a){var b=a,c=a;if(a.alternate)for(;b.return;)b=b.return;else{a=b;do b=a,0!==(b.effectTag&1026)&&(c=b.return),a=b.return;while(a)}return 3===b.tag?c:null}function ec(a){if(13===a.tag){var b=a.memoizedState;null===b&&(a=a.alternate,null!==a&&(b=a.memoizedState));if(null!==b)return b.dehydrated}return null}function fc(a){if(dc(a)!==a)throw Error(u(188));}\nfunction gc(a){var b=a.alternate;if(!b){b=dc(a);if(null===b)throw Error(u(188));return b!==a?null:a}for(var c=a,d=b;;){var e=c.return;if(null===e)break;var f=e.alternate;if(null===f){d=e.return;if(null!==d){c=d;continue}break}if(e.child===f.child){for(f=e.child;f;){if(f===c)return fc(e),a;if(f===d)return fc(e),b;f=f.sibling}throw Error(u(188));}if(c.return!==d.return)c=e,d=f;else{for(var g=!1,h=e.child;h;){if(h===c){g=!0;c=e;d=f;break}if(h===d){g=!0;d=e;c=f;break}h=h.sibling}if(!g){for(h=f.child;h;){if(h===\nc){g=!0;c=f;d=e;break}if(h===d){g=!0;d=f;c=e;break}h=h.sibling}if(!g)throw Error(u(189));}}if(c.alternate!==d)throw Error(u(190));}if(3!==c.tag)throw Error(u(188));return c.stateNode.current===c?a:b}function hc(a){a=gc(a);if(!a)return null;for(var b=a;;){if(5===b.tag||6===b.tag)return b;if(b.child)b.child.return=b,b=b.child;else{if(b===a)break;for(;!b.sibling;){if(!b.return||b.return===a)return null;b=b.return}b.sibling.return=b.return;b=b.sibling}}return null}\nfunction ic(a,b){if(null==b)throw Error(u(30));if(null==a)return b;if(Array.isArray(a)){if(Array.isArray(b))return a.push.apply(a,b),a;a.push(b);return a}return Array.isArray(b)?[a].concat(b):[a,b]}function jc(a,b,c){Array.isArray(a)?a.forEach(b,c):a&&b.call(c,a)}var kc=null;\nfunction lc(a){if(a){var b=a._dispatchListeners,c=a._dispatchInstances;if(Array.isArray(b))for(var d=0;d<b.length&&!a.isPropagationStopped();d++)oa(a,b[d],c[d]);else b&&oa(a,b,c);a._dispatchListeners=null;a._dispatchInstances=null;a.isPersistent()||a.constructor.release(a)}}function mc(a){null!==a&&(kc=ic(kc,a));a=kc;kc=null;if(a){jc(a,lc);if(kc)throw Error(u(95));if(fa)throw a=ha,fa=!1,ha=null,a;}}\nfunction nc(a){a=a.target||a.srcElement||window;a.correspondingUseElement&&(a=a.correspondingUseElement);return 3===a.nodeType?a.parentNode:a}function oc(a){if(!ya)return!1;a=\"on\"+a;var b=a in document;b||(b=document.createElement(\"div\"),b.setAttribute(a,\"return;\"),b=\"function\"===typeof b[a]);return b}var pc=[];function qc(a){a.topLevelType=null;a.nativeEvent=null;a.targetInst=null;a.ancestors.length=0;10>pc.length&&pc.push(a)}\nfunction rc(a,b,c,d){if(pc.length){var e=pc.pop();e.topLevelType=a;e.eventSystemFlags=d;e.nativeEvent=b;e.targetInst=c;return e}return{topLevelType:a,eventSystemFlags:d,nativeEvent:b,targetInst:c,ancestors:[]}}\nfunction sc(a){var b=a.targetInst,c=b;do{if(!c){a.ancestors.push(c);break}var d=c;if(3===d.tag)d=d.stateNode.containerInfo;else{for(;d.return;)d=d.return;d=3!==d.tag?null:d.stateNode.containerInfo}if(!d)break;b=c.tag;5!==b&&6!==b||a.ancestors.push(c);c=tc(d)}while(c);for(c=0;c<a.ancestors.length;c++){b=a.ancestors[c];var e=nc(a.nativeEvent);d=a.topLevelType;var f=a.nativeEvent,g=a.eventSystemFlags;0===c&&(g|=64);for(var h=null,k=0;k<sa.length;k++){var l=sa[k];l&&(l=l.extractEvents(d,b,f,e,g))&&(h=\nic(h,l))}mc(h)}}function uc(a,b,c){if(!c.has(a)){switch(a){case \"scroll\":vc(b,\"scroll\",!0);break;case \"focus\":case \"blur\":vc(b,\"focus\",!0);vc(b,\"blur\",!0);c.set(\"blur\",null);c.set(\"focus\",null);break;case \"cancel\":case \"close\":oc(a)&&vc(b,a,!0);break;case \"invalid\":case \"submit\":case \"reset\":break;default:-1===ac.indexOf(a)&&F(a,b)}c.set(a,null)}}\nvar wc,xc,yc,zc=!1,Ac=[],Bc=null,Cc=null,Dc=null,Ec=new Map,Fc=new Map,Gc=[],Hc=\"mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput close cancel copy cut paste click change contextmenu reset submit\".split(\" \"),Ic=\"focus blur dragenter dragleave mouseover mouseout pointerover pointerout gotpointercapture lostpointercapture\".split(\" \");\nfunction Jc(a,b){var c=cc(b);Hc.forEach(function(a){uc(a,b,c)});Ic.forEach(function(a){uc(a,b,c)})}function Kc(a,b,c,d,e){return{blockedOn:a,topLevelType:b,eventSystemFlags:c|32,nativeEvent:e,container:d}}\nfunction Lc(a,b){switch(a){case \"focus\":case \"blur\":Bc=null;break;case \"dragenter\":case \"dragleave\":Cc=null;break;case \"mouseover\":case \"mouseout\":Dc=null;break;case \"pointerover\":case \"pointerout\":Ec.delete(b.pointerId);break;case \"gotpointercapture\":case \"lostpointercapture\":Fc.delete(b.pointerId)}}function Mc(a,b,c,d,e,f){if(null===a||a.nativeEvent!==f)return a=Kc(b,c,d,e,f),null!==b&&(b=Nc(b),null!==b&&xc(b)),a;a.eventSystemFlags|=d;return a}\nfunction Oc(a,b,c,d,e){switch(b){case \"focus\":return Bc=Mc(Bc,a,b,c,d,e),!0;case \"dragenter\":return Cc=Mc(Cc,a,b,c,d,e),!0;case \"mouseover\":return Dc=Mc(Dc,a,b,c,d,e),!0;case \"pointerover\":var f=e.pointerId;Ec.set(f,Mc(Ec.get(f)||null,a,b,c,d,e));return!0;case \"gotpointercapture\":return f=e.pointerId,Fc.set(f,Mc(Fc.get(f)||null,a,b,c,d,e)),!0}return!1}\nfunction Pc(a){var b=tc(a.target);if(null!==b){var c=dc(b);if(null!==c)if(b=c.tag,13===b){if(b=ec(c),null!==b){a.blockedOn=b;r.unstable_runWithPriority(a.priority,function(){yc(c)});return}}else if(3===b&&c.stateNode.hydrate){a.blockedOn=3===c.tag?c.stateNode.containerInfo:null;return}}a.blockedOn=null}function Qc(a){if(null!==a.blockedOn)return!1;var b=Rc(a.topLevelType,a.eventSystemFlags,a.container,a.nativeEvent);if(null!==b){var c=Nc(b);null!==c&&xc(c);a.blockedOn=b;return!1}return!0}\nfunction Sc(a,b,c){Qc(a)&&c.delete(b)}function Tc(){for(zc=!1;0<Ac.length;){var a=Ac[0];if(null!==a.blockedOn){a=Nc(a.blockedOn);null!==a&&wc(a);break}var b=Rc(a.topLevelType,a.eventSystemFlags,a.container,a.nativeEvent);null!==b?a.blockedOn=b:Ac.shift()}null!==Bc&&Qc(Bc)&&(Bc=null);null!==Cc&&Qc(Cc)&&(Cc=null);null!==Dc&&Qc(Dc)&&(Dc=null);Ec.forEach(Sc);Fc.forEach(Sc)}function Uc(a,b){a.blockedOn===b&&(a.blockedOn=null,zc||(zc=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,Tc)))}\nfunction Vc(a){function b(b){return Uc(b,a)}if(0<Ac.length){Uc(Ac[0],a);for(var c=1;c<Ac.length;c++){var d=Ac[c];d.blockedOn===a&&(d.blockedOn=null)}}null!==Bc&&Uc(Bc,a);null!==Cc&&Uc(Cc,a);null!==Dc&&Uc(Dc,a);Ec.forEach(b);Fc.forEach(b);for(c=0;c<Gc.length;c++)d=Gc[c],d.blockedOn===a&&(d.blockedOn=null);for(;0<Gc.length&&(c=Gc[0],null===c.blockedOn);)Pc(c),null===c.blockedOn&&Gc.shift()}\nvar Wc={},Yc=new Map,Zc=new Map,$c=[\"abort\",\"abort\",Xb,\"animationEnd\",Yb,\"animationIteration\",Zb,\"animationStart\",\"canplay\",\"canPlay\",\"canplaythrough\",\"canPlayThrough\",\"durationchange\",\"durationChange\",\"emptied\",\"emptied\",\"encrypted\",\"encrypted\",\"ended\",\"ended\",\"error\",\"error\",\"gotpointercapture\",\"gotPointerCapture\",\"load\",\"load\",\"loadeddata\",\"loadedData\",\"loadedmetadata\",\"loadedMetadata\",\"loadstart\",\"loadStart\",\"lostpointercapture\",\"lostPointerCapture\",\"playing\",\"playing\",\"progress\",\"progress\",\"seeking\",\n\"seeking\",\"stalled\",\"stalled\",\"suspend\",\"suspend\",\"timeupdate\",\"timeUpdate\",$b,\"transitionEnd\",\"waiting\",\"waiting\"];function ad(a,b){for(var c=0;c<a.length;c+=2){var d=a[c],e=a[c+1],f=\"on\"+(e[0].toUpperCase()+e.slice(1));f={phasedRegistrationNames:{bubbled:f,captured:f+\"Capture\"},dependencies:[d],eventPriority:b};Zc.set(d,b);Yc.set(d,f);Wc[e]=f}}\nad(\"blur blur cancel cancel click click close close contextmenu contextMenu copy copy cut cut auxclick auxClick dblclick doubleClick dragend dragEnd dragstart dragStart drop drop focus focus input input invalid invalid keydown keyDown keypress keyPress keyup keyUp mousedown mouseDown mouseup mouseUp paste paste pause pause play play pointercancel pointerCancel pointerdown pointerDown pointerup pointerUp ratechange rateChange reset reset seeked seeked submit submit touchcancel touchCancel touchend touchEnd touchstart touchStart volumechange volumeChange\".split(\" \"),0);\nad(\"drag drag dragenter dragEnter dragexit dragExit dragleave dragLeave dragover dragOver mousemove mouseMove mouseout mouseOut mouseover mouseOver pointermove pointerMove pointerout pointerOut pointerover pointerOver scroll scroll toggle toggle touchmove touchMove wheel wheel\".split(\" \"),1);ad($c,2);for(var bd=\"change selectionchange textInput compositionstart compositionend compositionupdate\".split(\" \"),cd=0;cd<bd.length;cd++)Zc.set(bd[cd],0);\nvar dd=r.unstable_UserBlockingPriority,ed=r.unstable_runWithPriority,fd=!0;function F(a,b){vc(b,a,!1)}function vc(a,b,c){var d=Zc.get(b);switch(void 0===d?2:d){case 0:d=gd.bind(null,b,1,a);break;case 1:d=hd.bind(null,b,1,a);break;default:d=id.bind(null,b,1,a)}c?a.addEventListener(b,d,!0):a.addEventListener(b,d,!1)}function gd(a,b,c,d){Ja||Ha();var e=id,f=Ja;Ja=!0;try{Ga(e,a,b,c,d)}finally{(Ja=f)||La()}}function hd(a,b,c,d){ed(dd,id.bind(null,a,b,c,d))}\nfunction id(a,b,c,d){if(fd)if(0<Ac.length&&-1<Hc.indexOf(a))a=Kc(null,a,b,c,d),Ac.push(a);else{var e=Rc(a,b,c,d);if(null===e)Lc(a,d);else if(-1<Hc.indexOf(a))a=Kc(e,a,b,c,d),Ac.push(a);else if(!Oc(e,a,b,c,d)){Lc(a,d);a=rc(a,d,null,b);try{Ma(sc,a)}finally{qc(a)}}}}\nfunction Rc(a,b,c,d){c=nc(d);c=tc(c);if(null!==c){var e=dc(c);if(null===e)c=null;else{var f=e.tag;if(13===f){c=ec(e);if(null!==c)return c;c=null}else if(3===f){if(e.stateNode.hydrate)return 3===e.tag?e.stateNode.containerInfo:null;c=null}else e!==c&&(c=null)}}a=rc(a,d,c,b);try{Ma(sc,a)}finally{qc(a)}return null}\nvar jd={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,\nfloodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},kd=[\"Webkit\",\"ms\",\"Moz\",\"O\"];Object.keys(jd).forEach(function(a){kd.forEach(function(b){b=b+a.charAt(0).toUpperCase()+a.substring(1);jd[b]=jd[a]})});function ld(a,b,c){return null==b||\"boolean\"===typeof b||\"\"===b?\"\":c||\"number\"!==typeof b||0===b||jd.hasOwnProperty(a)&&jd[a]?(\"\"+b).trim():b+\"px\"}\nfunction md(a,b){a=a.style;for(var c in b)if(b.hasOwnProperty(c)){var d=0===c.indexOf(\"--\"),e=ld(c,b[c],d);\"float\"===c&&(c=\"cssFloat\");d?a.setProperty(c,e):a[c]=e}}var nd=n({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});\nfunction od(a,b){if(b){if(nd[a]&&(null!=b.children||null!=b.dangerouslySetInnerHTML))throw Error(u(137,a,\"\"));if(null!=b.dangerouslySetInnerHTML){if(null!=b.children)throw Error(u(60));if(!(\"object\"===typeof b.dangerouslySetInnerHTML&&\"__html\"in b.dangerouslySetInnerHTML))throw Error(u(61));}if(null!=b.style&&\"object\"!==typeof b.style)throw Error(u(62,\"\"));}}\nfunction pd(a,b){if(-1===a.indexOf(\"-\"))return\"string\"===typeof b.is;switch(a){case \"annotation-xml\":case \"color-profile\":case \"font-face\":case \"font-face-src\":case \"font-face-uri\":case \"font-face-format\":case \"font-face-name\":case \"missing-glyph\":return!1;default:return!0}}var qd=Mb.html;function rd(a,b){a=9===a.nodeType||11===a.nodeType?a:a.ownerDocument;var c=cc(a);b=wa[b];for(var d=0;d<b.length;d++)uc(b[d],a,c)}function sd(){}\nfunction td(a){a=a||(\"undefined\"!==typeof document?document:void 0);if(\"undefined\"===typeof a)return null;try{return a.activeElement||a.body}catch(b){return a.body}}function ud(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function vd(a,b){var c=ud(a);a=0;for(var d;c;){if(3===c.nodeType){d=a+c.textContent.length;if(a<=b&&d>=b)return{node:c,offset:b-a};a=d}a:{for(;c;){if(c.nextSibling){c=c.nextSibling;break a}c=c.parentNode}c=void 0}c=ud(c)}}\nfunction wd(a,b){return a&&b?a===b?!0:a&&3===a.nodeType?!1:b&&3===b.nodeType?wd(a,b.parentNode):\"contains\"in a?a.contains(b):a.compareDocumentPosition?!!(a.compareDocumentPosition(b)&16):!1:!1}function xd(){for(var a=window,b=td();b instanceof a.HTMLIFrameElement;){try{var c=\"string\"===typeof b.contentWindow.location.href}catch(d){c=!1}if(c)a=b.contentWindow;else break;b=td(a.document)}return b}\nfunction yd(a){var b=a&&a.nodeName&&a.nodeName.toLowerCase();return b&&(\"input\"===b&&(\"text\"===a.type||\"search\"===a.type||\"tel\"===a.type||\"url\"===a.type||\"password\"===a.type)||\"textarea\"===b||\"true\"===a.contentEditable)}var zd=\"$\",Ad=\"/$\",Bd=\"$?\",Cd=\"$!\",Dd=null,Ed=null;function Fd(a,b){switch(a){case \"button\":case \"input\":case \"select\":case \"textarea\":return!!b.autoFocus}return!1}\nfunction Gd(a,b){return\"textarea\"===a||\"option\"===a||\"noscript\"===a||\"string\"===typeof b.children||\"number\"===typeof b.children||\"object\"===typeof b.dangerouslySetInnerHTML&&null!==b.dangerouslySetInnerHTML&&null!=b.dangerouslySetInnerHTML.__html}var Hd=\"function\"===typeof setTimeout?setTimeout:void 0,Id=\"function\"===typeof clearTimeout?clearTimeout:void 0;function Jd(a){for(;null!=a;a=a.nextSibling){var b=a.nodeType;if(1===b||3===b)break}return a}\nfunction Kd(a){a=a.previousSibling;for(var b=0;a;){if(8===a.nodeType){var c=a.data;if(c===zd||c===Cd||c===Bd){if(0===b)return a;b--}else c===Ad&&b++}a=a.previousSibling}return null}var Ld=Math.random().toString(36).slice(2),Md=\"__reactInternalInstance$\"+Ld,Nd=\"__reactEventHandlers$\"+Ld,Od=\"__reactContainere$\"+Ld;\nfunction tc(a){var b=a[Md];if(b)return b;for(var c=a.parentNode;c;){if(b=c[Od]||c[Md]){c=b.alternate;if(null!==b.child||null!==c&&null!==c.child)for(a=Kd(a);null!==a;){if(c=a[Md])return c;a=Kd(a)}return b}a=c;c=a.parentNode}return null}function Nc(a){a=a[Md]||a[Od];return!a||5!==a.tag&&6!==a.tag&&13!==a.tag&&3!==a.tag?null:a}function Pd(a){if(5===a.tag||6===a.tag)return a.stateNode;throw Error(u(33));}function Qd(a){return a[Nd]||null}\nfunction Rd(a){do a=a.return;while(a&&5!==a.tag);return a?a:null}\nfunction Sd(a,b){var c=a.stateNode;if(!c)return null;var d=la(c);if(!d)return null;c=d[b];a:switch(b){case \"onClick\":case \"onClickCapture\":case \"onDoubleClick\":case \"onDoubleClickCapture\":case \"onMouseDown\":case \"onMouseDownCapture\":case \"onMouseMove\":case \"onMouseMoveCapture\":case \"onMouseUp\":case \"onMouseUpCapture\":case \"onMouseEnter\":(d=!d.disabled)||(a=a.type,d=!(\"button\"===a||\"input\"===a||\"select\"===a||\"textarea\"===a));a=!d;break a;default:a=!1}if(a)return null;if(c&&\"function\"!==typeof c)throw Error(u(231,\nb,typeof c));return c}function Td(a,b,c){if(b=Sd(a,c.dispatchConfig.phasedRegistrationNames[b]))c._dispatchListeners=ic(c._dispatchListeners,b),c._dispatchInstances=ic(c._dispatchInstances,a)}function Ud(a){if(a&&a.dispatchConfig.phasedRegistrationNames){for(var b=a._targetInst,c=[];b;)c.push(b),b=Rd(b);for(b=c.length;0<b--;)Td(c[b],\"captured\",a);for(b=0;b<c.length;b++)Td(c[b],\"bubbled\",a)}}\nfunction Vd(a,b,c){a&&c&&c.dispatchConfig.registrationName&&(b=Sd(a,c.dispatchConfig.registrationName))&&(c._dispatchListeners=ic(c._dispatchListeners,b),c._dispatchInstances=ic(c._dispatchInstances,a))}function Wd(a){a&&a.dispatchConfig.registrationName&&Vd(a._targetInst,null,a)}function Xd(a){jc(a,Ud)}var Yd=null,Zd=null,$d=null;\nfunction ae(){if($d)return $d;var a,b=Zd,c=b.length,d,e=\"value\"in Yd?Yd.value:Yd.textContent,f=e.length;for(a=0;a<c&&b[a]===e[a];a++);var g=c-a;for(d=1;d<=g&&b[c-d]===e[f-d];d++);return $d=e.slice(a,1<d?1-d:void 0)}function be(){return!0}function ce(){return!1}\nfunction G(a,b,c,d){this.dispatchConfig=a;this._targetInst=b;this.nativeEvent=c;a=this.constructor.Interface;for(var e in a)a.hasOwnProperty(e)&&((b=a[e])?this[e]=b(c):\"target\"===e?this.target=d:this[e]=c[e]);this.isDefaultPrevented=(null!=c.defaultPrevented?c.defaultPrevented:!1===c.returnValue)?be:ce;this.isPropagationStopped=ce;return this}\nn(G.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():\"unknown\"!==typeof a.returnValue&&(a.returnValue=!1),this.isDefaultPrevented=be)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():\"unknown\"!==typeof a.cancelBubble&&(a.cancelBubble=!0),this.isPropagationStopped=be)},persist:function(){this.isPersistent=be},isPersistent:ce,destructor:function(){var a=this.constructor.Interface,\nb;for(b in a)this[b]=null;this.nativeEvent=this._targetInst=this.dispatchConfig=null;this.isPropagationStopped=this.isDefaultPrevented=ce;this._dispatchInstances=this._dispatchListeners=null}});G.Interface={type:null,target:null,currentTarget:function(){return null},eventPhase:null,bubbles:null,cancelable:null,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:null,isTrusted:null};\nG.extend=function(a){function b(){}function c(){return d.apply(this,arguments)}var d=this;b.prototype=d.prototype;var e=new b;n(e,c.prototype);c.prototype=e;c.prototype.constructor=c;c.Interface=n({},d.Interface,a);c.extend=d.extend;de(c);return c};de(G);function ee(a,b,c,d){if(this.eventPool.length){var e=this.eventPool.pop();this.call(e,a,b,c,d);return e}return new this(a,b,c,d)}\nfunction fe(a){if(!(a instanceof this))throw Error(u(279));a.destructor();10>this.eventPool.length&&this.eventPool.push(a)}function de(a){a.eventPool=[];a.getPooled=ee;a.release=fe}var ge=G.extend({data:null}),he=G.extend({data:null}),ie=[9,13,27,32],je=ya&&\"CompositionEvent\"in window,ke=null;ya&&\"documentMode\"in document&&(ke=document.documentMode);\nvar le=ya&&\"TextEvent\"in window&&!ke,me=ya&&(!je||ke&&8<ke&&11>=ke),ne=String.fromCharCode(32),oe={beforeInput:{phasedRegistrationNames:{bubbled:\"onBeforeInput\",captured:\"onBeforeInputCapture\"},dependencies:[\"compositionend\",\"keypress\",\"textInput\",\"paste\"]},compositionEnd:{phasedRegistrationNames:{bubbled:\"onCompositionEnd\",captured:\"onCompositionEndCapture\"},dependencies:\"blur compositionend keydown keypress keyup mousedown\".split(\" \")},compositionStart:{phasedRegistrationNames:{bubbled:\"onCompositionStart\",\ncaptured:\"onCompositionStartCapture\"},dependencies:\"blur compositionstart keydown keypress keyup mousedown\".split(\" \")},compositionUpdate:{phasedRegistrationNames:{bubbled:\"onCompositionUpdate\",captured:\"onCompositionUpdateCapture\"},dependencies:\"blur compositionupdate keydown keypress keyup mousedown\".split(\" \")}},pe=!1;\nfunction qe(a,b){switch(a){case \"keyup\":return-1!==ie.indexOf(b.keyCode);case \"keydown\":return 229!==b.keyCode;case \"keypress\":case \"mousedown\":case \"blur\":return!0;default:return!1}}function re(a){a=a.detail;return\"object\"===typeof a&&\"data\"in a?a.data:null}var se=!1;function te(a,b){switch(a){case \"compositionend\":return re(b);case \"keypress\":if(32!==b.which)return null;pe=!0;return ne;case \"textInput\":return a=b.data,a===ne&&pe?null:a;default:return null}}\nfunction ue(a,b){if(se)return\"compositionend\"===a||!je&&qe(a,b)?(a=ae(),$d=Zd=Yd=null,se=!1,a):null;switch(a){case \"paste\":return null;case \"keypress\":if(!(b.ctrlKey||b.altKey||b.metaKey)||b.ctrlKey&&b.altKey){if(b.char&&1<b.char.length)return b.char;if(b.which)return String.fromCharCode(b.which)}return null;case \"compositionend\":return me&&\"ko\"!==b.locale?null:b.data;default:return null}}\nvar ve={eventTypes:oe,extractEvents:function(a,b,c,d){var e;if(je)b:{switch(a){case \"compositionstart\":var f=oe.compositionStart;break b;case \"compositionend\":f=oe.compositionEnd;break b;case \"compositionupdate\":f=oe.compositionUpdate;break b}f=void 0}else se?qe(a,c)&&(f=oe.compositionEnd):\"keydown\"===a&&229===c.keyCode&&(f=oe.compositionStart);f?(me&&\"ko\"!==c.locale&&(se||f!==oe.compositionStart?f===oe.compositionEnd&&se&&(e=ae()):(Yd=d,Zd=\"value\"in Yd?Yd.value:Yd.textContent,se=!0)),f=ge.getPooled(f,\nb,c,d),e?f.data=e:(e=re(c),null!==e&&(f.data=e)),Xd(f),e=f):e=null;(a=le?te(a,c):ue(a,c))?(b=he.getPooled(oe.beforeInput,b,c,d),b.data=a,Xd(b)):b=null;return null===e?b:null===b?e:[e,b]}},we={color:!0,date:!0,datetime:!0,\"datetime-local\":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function xe(a){var b=a&&a.nodeName&&a.nodeName.toLowerCase();return\"input\"===b?!!we[a.type]:\"textarea\"===b?!0:!1}\nvar ye={change:{phasedRegistrationNames:{bubbled:\"onChange\",captured:\"onChangeCapture\"},dependencies:\"blur change click focus input keydown keyup selectionchange\".split(\" \")}};function ze(a,b,c){a=G.getPooled(ye.change,a,b,c);a.type=\"change\";Da(c);Xd(a);return a}var Ae=null,Be=null;function Ce(a){mc(a)}function De(a){var b=Pd(a);if(yb(b))return a}function Ee(a,b){if(\"change\"===a)return b}var Fe=!1;ya&&(Fe=oc(\"input\")&&(!document.documentMode||9<document.documentMode));\nfunction Ge(){Ae&&(Ae.detachEvent(\"onpropertychange\",He),Be=Ae=null)}function He(a){if(\"value\"===a.propertyName&&De(Be))if(a=ze(Be,a,nc(a)),Ja)mc(a);else{Ja=!0;try{Fa(Ce,a)}finally{Ja=!1,La()}}}function Ie(a,b,c){\"focus\"===a?(Ge(),Ae=b,Be=c,Ae.attachEvent(\"onpropertychange\",He)):\"blur\"===a&&Ge()}function Je(a){if(\"selectionchange\"===a||\"keyup\"===a||\"keydown\"===a)return De(Be)}function Ke(a,b){if(\"click\"===a)return De(b)}function Le(a,b){if(\"input\"===a||\"change\"===a)return De(b)}\nvar Me={eventTypes:ye,_isInputEventSupported:Fe,extractEvents:function(a,b,c,d){var e=b?Pd(b):window,f=e.nodeName&&e.nodeName.toLowerCase();if(\"select\"===f||\"input\"===f&&\"file\"===e.type)var g=Ee;else if(xe(e))if(Fe)g=Le;else{g=Je;var h=Ie}else(f=e.nodeName)&&\"input\"===f.toLowerCase()&&(\"checkbox\"===e.type||\"radio\"===e.type)&&(g=Ke);if(g&&(g=g(a,b)))return ze(g,c,d);h&&h(a,e,b);\"blur\"===a&&(a=e._wrapperState)&&a.controlled&&\"number\"===e.type&&Db(e,\"number\",e.value)}},Ne=G.extend({view:null,detail:null}),\nOe={Alt:\"altKey\",Control:\"ctrlKey\",Meta:\"metaKey\",Shift:\"shiftKey\"};function Pe(a){var b=this.nativeEvent;return b.getModifierState?b.getModifierState(a):(a=Oe[a])?!!b[a]:!1}function Qe(){return Pe}\nvar Re=0,Se=0,Te=!1,Ue=!1,Ve=Ne.extend({screenX:null,screenY:null,clientX:null,clientY:null,pageX:null,pageY:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,getModifierState:Qe,button:null,buttons:null,relatedTarget:function(a){return a.relatedTarget||(a.fromElement===a.srcElement?a.toElement:a.fromElement)},movementX:function(a){if(\"movementX\"in a)return a.movementX;var b=Re;Re=a.screenX;return Te?\"mousemove\"===a.type?a.screenX-b:0:(Te=!0,0)},movementY:function(a){if(\"movementY\"in a)return a.movementY;\nvar b=Se;Se=a.screenY;return Ue?\"mousemove\"===a.type?a.screenY-b:0:(Ue=!0,0)}}),We=Ve.extend({pointerId:null,width:null,height:null,pressure:null,tangentialPressure:null,tiltX:null,tiltY:null,twist:null,pointerType:null,isPrimary:null}),Xe={mouseEnter:{registrationName:\"onMouseEnter\",dependencies:[\"mouseout\",\"mouseover\"]},mouseLeave:{registrationName:\"onMouseLeave\",dependencies:[\"mouseout\",\"mouseover\"]},pointerEnter:{registrationName:\"onPointerEnter\",dependencies:[\"pointerout\",\"pointerover\"]},pointerLeave:{registrationName:\"onPointerLeave\",\ndependencies:[\"pointerout\",\"pointerover\"]}},Ye={eventTypes:Xe,extractEvents:function(a,b,c,d,e){var f=\"mouseover\"===a||\"pointerover\"===a,g=\"mouseout\"===a||\"pointerout\"===a;if(f&&0===(e&32)&&(c.relatedTarget||c.fromElement)||!g&&!f)return null;f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window;if(g){if(g=b,b=(b=c.relatedTarget||c.toElement)?tc(b):null,null!==b){var h=dc(b);if(b!==h||5!==b.tag&&6!==b.tag)b=null}}else g=null;if(g===b)return null;if(\"mouseout\"===a||\"mouseover\"===\na){var k=Ve;var l=Xe.mouseLeave;var m=Xe.mouseEnter;var p=\"mouse\"}else if(\"pointerout\"===a||\"pointerover\"===a)k=We,l=Xe.pointerLeave,m=Xe.pointerEnter,p=\"pointer\";a=null==g?f:Pd(g);f=null==b?f:Pd(b);l=k.getPooled(l,g,c,d);l.type=p+\"leave\";l.target=a;l.relatedTarget=f;c=k.getPooled(m,b,c,d);c.type=p+\"enter\";c.target=f;c.relatedTarget=a;d=g;p=b;if(d&&p)a:{k=d;m=p;g=0;for(a=k;a;a=Rd(a))g++;a=0;for(b=m;b;b=Rd(b))a++;for(;0<g-a;)k=Rd(k),g--;for(;0<a-g;)m=Rd(m),a--;for(;g--;){if(k===m||k===m.alternate)break a;\nk=Rd(k);m=Rd(m)}k=null}else k=null;m=k;for(k=[];d&&d!==m;){g=d.alternate;if(null!==g&&g===m)break;k.push(d);d=Rd(d)}for(d=[];p&&p!==m;){g=p.alternate;if(null!==g&&g===m)break;d.push(p);p=Rd(p)}for(p=0;p<k.length;p++)Vd(k[p],\"bubbled\",l);for(p=d.length;0<p--;)Vd(d[p],\"captured\",c);return 0===(e&64)?[l]:[l,c]}};function Ze(a,b){return a===b&&(0!==a||1/a===1/b)||a!==a&&b!==b}var $e=\"function\"===typeof Object.is?Object.is:Ze,af=Object.prototype.hasOwnProperty;\nfunction bf(a,b){if($e(a,b))return!0;if(\"object\"!==typeof a||null===a||\"object\"!==typeof b||null===b)return!1;var c=Object.keys(a),d=Object.keys(b);if(c.length!==d.length)return!1;for(d=0;d<c.length;d++)if(!af.call(b,c[d])||!$e(a[c[d]],b[c[d]]))return!1;return!0}\nvar cf=ya&&\"documentMode\"in document&&11>=document.documentMode,df={select:{phasedRegistrationNames:{bubbled:\"onSelect\",captured:\"onSelectCapture\"},dependencies:\"blur contextmenu dragend focus keydown keyup mousedown mouseup selectionchange\".split(\" \")}},ef=null,ff=null,gf=null,hf=!1;\nfunction jf(a,b){var c=b.window===b?b.document:9===b.nodeType?b:b.ownerDocument;if(hf||null==ef||ef!==td(c))return null;c=ef;\"selectionStart\"in c&&yd(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset});return gf&&bf(gf,c)?null:(gf=c,a=G.getPooled(df.select,ff,a,b),a.type=\"select\",a.target=ef,Xd(a),a)}\nvar kf={eventTypes:df,extractEvents:function(a,b,c,d,e,f){e=f||(d.window===d?d.document:9===d.nodeType?d:d.ownerDocument);if(!(f=!e)){a:{e=cc(e);f=wa.onSelect;for(var g=0;g<f.length;g++)if(!e.has(f[g])){e=!1;break a}e=!0}f=!e}if(f)return null;e=b?Pd(b):window;switch(a){case \"focus\":if(xe(e)||\"true\"===e.contentEditable)ef=e,ff=b,gf=null;break;case \"blur\":gf=ff=ef=null;break;case \"mousedown\":hf=!0;break;case \"contextmenu\":case \"mouseup\":case \"dragend\":return hf=!1,jf(c,d);case \"selectionchange\":if(cf)break;\ncase \"keydown\":case \"keyup\":return jf(c,d)}return null}},lf=G.extend({animationName:null,elapsedTime:null,pseudoElement:null}),mf=G.extend({clipboardData:function(a){return\"clipboardData\"in a?a.clipboardData:window.clipboardData}}),nf=Ne.extend({relatedTarget:null});function of(a){var b=a.keyCode;\"charCode\"in a?(a=a.charCode,0===a&&13===b&&(a=13)):a=b;10===a&&(a=13);return 32<=a||13===a?a:0}\nvar pf={Esc:\"Escape\",Spacebar:\" \",Left:\"ArrowLeft\",Up:\"ArrowUp\",Right:\"ArrowRight\",Down:\"ArrowDown\",Del:\"Delete\",Win:\"OS\",Menu:\"ContextMenu\",Apps:\"ContextMenu\",Scroll:\"ScrollLock\",MozPrintableKey:\"Unidentified\"},qf={8:\"Backspace\",9:\"Tab\",12:\"Clear\",13:\"Enter\",16:\"Shift\",17:\"Control\",18:\"Alt\",19:\"Pause\",20:\"CapsLock\",27:\"Escape\",32:\" \",33:\"PageUp\",34:\"PageDown\",35:\"End\",36:\"Home\",37:\"ArrowLeft\",38:\"ArrowUp\",39:\"ArrowRight\",40:\"ArrowDown\",45:\"Insert\",46:\"Delete\",112:\"F1\",113:\"F2\",114:\"F3\",115:\"F4\",\n116:\"F5\",117:\"F6\",118:\"F7\",119:\"F8\",120:\"F9\",121:\"F10\",122:\"F11\",123:\"F12\",144:\"NumLock\",145:\"ScrollLock\",224:\"Meta\"},rf=Ne.extend({key:function(a){if(a.key){var b=pf[a.key]||a.key;if(\"Unidentified\"!==b)return b}return\"keypress\"===a.type?(a=of(a),13===a?\"Enter\":String.fromCharCode(a)):\"keydown\"===a.type||\"keyup\"===a.type?qf[a.keyCode]||\"Unidentified\":\"\"},location:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,repeat:null,locale:null,getModifierState:Qe,charCode:function(a){return\"keypress\"===\na.type?of(a):0},keyCode:function(a){return\"keydown\"===a.type||\"keyup\"===a.type?a.keyCode:0},which:function(a){return\"keypress\"===a.type?of(a):\"keydown\"===a.type||\"keyup\"===a.type?a.keyCode:0}}),sf=Ve.extend({dataTransfer:null}),tf=Ne.extend({touches:null,targetTouches:null,changedTouches:null,altKey:null,metaKey:null,ctrlKey:null,shiftKey:null,getModifierState:Qe}),uf=G.extend({propertyName:null,elapsedTime:null,pseudoElement:null}),vf=Ve.extend({deltaX:function(a){return\"deltaX\"in a?a.deltaX:\"wheelDeltaX\"in\na?-a.wheelDeltaX:0},deltaY:function(a){return\"deltaY\"in a?a.deltaY:\"wheelDeltaY\"in a?-a.wheelDeltaY:\"wheelDelta\"in a?-a.wheelDelta:0},deltaZ:null,deltaMode:null}),wf={eventTypes:Wc,extractEvents:function(a,b,c,d){var e=Yc.get(a);if(!e)return null;switch(a){case \"keypress\":if(0===of(c))return null;case \"keydown\":case \"keyup\":a=rf;break;case \"blur\":case \"focus\":a=nf;break;case \"click\":if(2===c.button)return null;case \"auxclick\":case \"dblclick\":case \"mousedown\":case \"mousemove\":case \"mouseup\":case \"mouseout\":case \"mouseover\":case \"contextmenu\":a=\nVe;break;case \"drag\":case \"dragend\":case \"dragenter\":case \"dragexit\":case \"dragleave\":case \"dragover\":case \"dragstart\":case \"drop\":a=sf;break;case \"touchcancel\":case \"touchend\":case \"touchmove\":case \"touchstart\":a=tf;break;case Xb:case Yb:case Zb:a=lf;break;case $b:a=uf;break;case \"scroll\":a=Ne;break;case \"wheel\":a=vf;break;case \"copy\":case \"cut\":case \"paste\":a=mf;break;case \"gotpointercapture\":case \"lostpointercapture\":case \"pointercancel\":case \"pointerdown\":case \"pointermove\":case \"pointerout\":case \"pointerover\":case \"pointerup\":a=\nWe;break;default:a=G}b=a.getPooled(e,b,c,d);Xd(b);return b}};if(pa)throw Error(u(101));pa=Array.prototype.slice.call(\"ResponderEventPlugin SimpleEventPlugin EnterLeaveEventPlugin ChangeEventPlugin SelectEventPlugin BeforeInputEventPlugin\".split(\" \"));ra();var xf=Nc;la=Qd;ma=xf;na=Pd;xa({SimpleEventPlugin:wf,EnterLeaveEventPlugin:Ye,ChangeEventPlugin:Me,SelectEventPlugin:kf,BeforeInputEventPlugin:ve});var yf=[],zf=-1;function H(a){0>zf||(a.current=yf[zf],yf[zf]=null,zf--)}\nfunction I(a,b){zf++;yf[zf]=a.current;a.current=b}var Af={},J={current:Af},K={current:!1},Bf=Af;function Cf(a,b){var c=a.type.contextTypes;if(!c)return Af;var d=a.stateNode;if(d&&d.__reactInternalMemoizedUnmaskedChildContext===b)return d.__reactInternalMemoizedMaskedChildContext;var e={},f;for(f in c)e[f]=b[f];d&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=b,a.__reactInternalMemoizedMaskedChildContext=e);return e}function L(a){a=a.childContextTypes;return null!==a&&void 0!==a}\nfunction Df(){H(K);H(J)}function Ef(a,b,c){if(J.current!==Af)throw Error(u(168));I(J,b);I(K,c)}function Ff(a,b,c){var d=a.stateNode;a=b.childContextTypes;if(\"function\"!==typeof d.getChildContext)return c;d=d.getChildContext();for(var e in d)if(!(e in a))throw Error(u(108,pb(b)||\"Unknown\",e));return n({},c,{},d)}function Gf(a){a=(a=a.stateNode)&&a.__reactInternalMemoizedMergedChildContext||Af;Bf=J.current;I(J,a);I(K,K.current);return!0}\nfunction Hf(a,b,c){var d=a.stateNode;if(!d)throw Error(u(169));c?(a=Ff(a,b,Bf),d.__reactInternalMemoizedMergedChildContext=a,H(K),H(J),I(J,a)):H(K);I(K,c)}\nvar If=r.unstable_runWithPriority,Jf=r.unstable_scheduleCallback,Kf=r.unstable_cancelCallback,Lf=r.unstable_requestPaint,Mf=r.unstable_now,Nf=r.unstable_getCurrentPriorityLevel,Of=r.unstable_ImmediatePriority,Pf=r.unstable_UserBlockingPriority,Qf=r.unstable_NormalPriority,Rf=r.unstable_LowPriority,Sf=r.unstable_IdlePriority,Tf={},Uf=r.unstable_shouldYield,Vf=void 0!==Lf?Lf:function(){},Wf=null,Xf=null,Yf=!1,Zf=Mf(),$f=1E4>Zf?Mf:function(){return Mf()-Zf};\nfunction ag(){switch(Nf()){case Of:return 99;case Pf:return 98;case Qf:return 97;case Rf:return 96;case Sf:return 95;default:throw Error(u(332));}}function bg(a){switch(a){case 99:return Of;case 98:return Pf;case 97:return Qf;case 96:return Rf;case 95:return Sf;default:throw Error(u(332));}}function cg(a,b){a=bg(a);return If(a,b)}function dg(a,b,c){a=bg(a);return Jf(a,b,c)}function eg(a){null===Wf?(Wf=[a],Xf=Jf(Of,fg)):Wf.push(a);return Tf}function gg(){if(null!==Xf){var a=Xf;Xf=null;Kf(a)}fg()}\nfunction fg(){if(!Yf&&null!==Wf){Yf=!0;var a=0;try{var b=Wf;cg(99,function(){for(;a<b.length;a++){var c=b[a];do c=c(!0);while(null!==c)}});Wf=null}catch(c){throw null!==Wf&&(Wf=Wf.slice(a+1)),Jf(Of,gg),c;}finally{Yf=!1}}}function hg(a,b,c){c/=10;return 1073741821-(((1073741821-a+b/10)/c|0)+1)*c}function ig(a,b){if(a&&a.defaultProps){b=n({},b);a=a.defaultProps;for(var c in a)void 0===b[c]&&(b[c]=a[c])}return b}var jg={current:null},kg=null,lg=null,mg=null;function ng(){mg=lg=kg=null}\nfunction og(a){var b=jg.current;H(jg);a.type._context._currentValue=b}function pg(a,b){for(;null!==a;){var c=a.alternate;if(a.childExpirationTime<b)a.childExpirationTime=b,null!==c&&c.childExpirationTime<b&&(c.childExpirationTime=b);else if(null!==c&&c.childExpirationTime<b)c.childExpirationTime=b;else break;a=a.return}}function qg(a,b){kg=a;mg=lg=null;a=a.dependencies;null!==a&&null!==a.firstContext&&(a.expirationTime>=b&&(rg=!0),a.firstContext=null)}\nfunction sg(a,b){if(mg!==a&&!1!==b&&0!==b){if(\"number\"!==typeof b||1073741823===b)mg=a,b=1073741823;b={context:a,observedBits:b,next:null};if(null===lg){if(null===kg)throw Error(u(308));lg=b;kg.dependencies={expirationTime:0,firstContext:b,responders:null}}else lg=lg.next=b}return a._currentValue}var tg=!1;function ug(a){a.updateQueue={baseState:a.memoizedState,baseQueue:null,shared:{pending:null},effects:null}}\nfunction vg(a,b){a=a.updateQueue;b.updateQueue===a&&(b.updateQueue={baseState:a.baseState,baseQueue:a.baseQueue,shared:a.shared,effects:a.effects})}function wg(a,b){a={expirationTime:a,suspenseConfig:b,tag:0,payload:null,callback:null,next:null};return a.next=a}function xg(a,b){a=a.updateQueue;if(null!==a){a=a.shared;var c=a.pending;null===c?b.next=b:(b.next=c.next,c.next=b);a.pending=b}}\nfunction yg(a,b){var c=a.alternate;null!==c&&vg(c,a);a=a.updateQueue;c=a.baseQueue;null===c?(a.baseQueue=b.next=b,b.next=b):(b.next=c.next,c.next=b)}\nfunction zg(a,b,c,d){var e=a.updateQueue;tg=!1;var f=e.baseQueue,g=e.shared.pending;if(null!==g){if(null!==f){var h=f.next;f.next=g.next;g.next=h}f=g;e.shared.pending=null;h=a.alternate;null!==h&&(h=h.updateQueue,null!==h&&(h.baseQueue=g))}if(null!==f){h=f.next;var k=e.baseState,l=0,m=null,p=null,x=null;if(null!==h){var z=h;do{g=z.expirationTime;if(g<d){var ca={expirationTime:z.expirationTime,suspenseConfig:z.suspenseConfig,tag:z.tag,payload:z.payload,callback:z.callback,next:null};null===x?(p=x=\nca,m=k):x=x.next=ca;g>l&&(l=g)}else{null!==x&&(x=x.next={expirationTime:1073741823,suspenseConfig:z.suspenseConfig,tag:z.tag,payload:z.payload,callback:z.callback,next:null});Ag(g,z.suspenseConfig);a:{var D=a,t=z;g=b;ca=c;switch(t.tag){case 1:D=t.payload;if(\"function\"===typeof D){k=D.call(ca,k,g);break a}k=D;break a;case 3:D.effectTag=D.effectTag&-4097|64;case 0:D=t.payload;g=\"function\"===typeof D?D.call(ca,k,g):D;if(null===g||void 0===g)break a;k=n({},k,g);break a;case 2:tg=!0}}null!==z.callback&&\n(a.effectTag|=32,g=e.effects,null===g?e.effects=[z]:g.push(z))}z=z.next;if(null===z||z===h)if(g=e.shared.pending,null===g)break;else z=f.next=g.next,g.next=h,e.baseQueue=f=g,e.shared.pending=null}while(1)}null===x?m=k:x.next=p;e.baseState=m;e.baseQueue=x;Bg(l);a.expirationTime=l;a.memoizedState=k}}\nfunction Cg(a,b,c){a=b.effects;b.effects=null;if(null!==a)for(b=0;b<a.length;b++){var d=a[b],e=d.callback;if(null!==e){d.callback=null;d=e;e=c;if(\"function\"!==typeof d)throw Error(u(191,d));d.call(e)}}}var Dg=Wa.ReactCurrentBatchConfig,Eg=(new aa.Component).refs;function Fg(a,b,c,d){b=a.memoizedState;c=c(d,b);c=null===c||void 0===c?b:n({},b,c);a.memoizedState=c;0===a.expirationTime&&(a.updateQueue.baseState=c)}\nvar Jg={isMounted:function(a){return(a=a._reactInternalFiber)?dc(a)===a:!1},enqueueSetState:function(a,b,c){a=a._reactInternalFiber;var d=Gg(),e=Dg.suspense;d=Hg(d,a,e);e=wg(d,e);e.payload=b;void 0!==c&&null!==c&&(e.callback=c);xg(a,e);Ig(a,d)},enqueueReplaceState:function(a,b,c){a=a._reactInternalFiber;var d=Gg(),e=Dg.suspense;d=Hg(d,a,e);e=wg(d,e);e.tag=1;e.payload=b;void 0!==c&&null!==c&&(e.callback=c);xg(a,e);Ig(a,d)},enqueueForceUpdate:function(a,b){a=a._reactInternalFiber;var c=Gg(),d=Dg.suspense;\nc=Hg(c,a,d);d=wg(c,d);d.tag=2;void 0!==b&&null!==b&&(d.callback=b);xg(a,d);Ig(a,c)}};function Kg(a,b,c,d,e,f,g){a=a.stateNode;return\"function\"===typeof a.shouldComponentUpdate?a.shouldComponentUpdate(d,f,g):b.prototype&&b.prototype.isPureReactComponent?!bf(c,d)||!bf(e,f):!0}\nfunction Lg(a,b,c){var d=!1,e=Af;var f=b.contextType;\"object\"===typeof f&&null!==f?f=sg(f):(e=L(b)?Bf:J.current,d=b.contextTypes,f=(d=null!==d&&void 0!==d)?Cf(a,e):Af);b=new b(c,f);a.memoizedState=null!==b.state&&void 0!==b.state?b.state:null;b.updater=Jg;a.stateNode=b;b._reactInternalFiber=a;d&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=e,a.__reactInternalMemoizedMaskedChildContext=f);return b}\nfunction Mg(a,b,c,d){a=b.state;\"function\"===typeof b.componentWillReceiveProps&&b.componentWillReceiveProps(c,d);\"function\"===typeof b.UNSAFE_componentWillReceiveProps&&b.UNSAFE_componentWillReceiveProps(c,d);b.state!==a&&Jg.enqueueReplaceState(b,b.state,null)}\nfunction Ng(a,b,c,d){var e=a.stateNode;e.props=c;e.state=a.memoizedState;e.refs=Eg;ug(a);var f=b.contextType;\"object\"===typeof f&&null!==f?e.context=sg(f):(f=L(b)?Bf:J.current,e.context=Cf(a,f));zg(a,c,e,d);e.state=a.memoizedState;f=b.getDerivedStateFromProps;\"function\"===typeof f&&(Fg(a,b,f,c),e.state=a.memoizedState);\"function\"===typeof b.getDerivedStateFromProps||\"function\"===typeof e.getSnapshotBeforeUpdate||\"function\"!==typeof e.UNSAFE_componentWillMount&&\"function\"!==typeof e.componentWillMount||\n(b=e.state,\"function\"===typeof e.componentWillMount&&e.componentWillMount(),\"function\"===typeof e.UNSAFE_componentWillMount&&e.UNSAFE_componentWillMount(),b!==e.state&&Jg.enqueueReplaceState(e,e.state,null),zg(a,c,e,d),e.state=a.memoizedState);\"function\"===typeof e.componentDidMount&&(a.effectTag|=4)}var Og=Array.isArray;\nfunction Pg(a,b,c){a=c.ref;if(null!==a&&\"function\"!==typeof a&&\"object\"!==typeof a){if(c._owner){c=c._owner;if(c){if(1!==c.tag)throw Error(u(309));var d=c.stateNode}if(!d)throw Error(u(147,a));var e=\"\"+a;if(null!==b&&null!==b.ref&&\"function\"===typeof b.ref&&b.ref._stringRef===e)return b.ref;b=function(a){var b=d.refs;b===Eg&&(b=d.refs={});null===a?delete b[e]:b[e]=a};b._stringRef=e;return b}if(\"string\"!==typeof a)throw Error(u(284));if(!c._owner)throw Error(u(290,a));}return a}\nfunction Qg(a,b){if(\"textarea\"!==a.type)throw Error(u(31,\"[object Object]\"===Object.prototype.toString.call(b)?\"object with keys {\"+Object.keys(b).join(\", \")+\"}\":b,\"\"));}\nfunction Rg(a){function b(b,c){if(a){var d=b.lastEffect;null!==d?(d.nextEffect=c,b.lastEffect=c):b.firstEffect=b.lastEffect=c;c.nextEffect=null;c.effectTag=8}}function c(c,d){if(!a)return null;for(;null!==d;)b(c,d),d=d.sibling;return null}function d(a,b){for(a=new Map;null!==b;)null!==b.key?a.set(b.key,b):a.set(b.index,b),b=b.sibling;return a}function e(a,b){a=Sg(a,b);a.index=0;a.sibling=null;return a}function f(b,c,d){b.index=d;if(!a)return c;d=b.alternate;if(null!==d)return d=d.index,d<c?(b.effectTag=\n2,c):d;b.effectTag=2;return c}function g(b){a&&null===b.alternate&&(b.effectTag=2);return b}function h(a,b,c,d){if(null===b||6!==b.tag)return b=Tg(c,a.mode,d),b.return=a,b;b=e(b,c);b.return=a;return b}function k(a,b,c,d){if(null!==b&&b.elementType===c.type)return d=e(b,c.props),d.ref=Pg(a,b,c),d.return=a,d;d=Ug(c.type,c.key,c.props,null,a.mode,d);d.ref=Pg(a,b,c);d.return=a;return d}function l(a,b,c,d){if(null===b||4!==b.tag||b.stateNode.containerInfo!==c.containerInfo||b.stateNode.implementation!==\nc.implementation)return b=Vg(c,a.mode,d),b.return=a,b;b=e(b,c.children||[]);b.return=a;return b}function m(a,b,c,d,f){if(null===b||7!==b.tag)return b=Wg(c,a.mode,d,f),b.return=a,b;b=e(b,c);b.return=a;return b}function p(a,b,c){if(\"string\"===typeof b||\"number\"===typeof b)return b=Tg(\"\"+b,a.mode,c),b.return=a,b;if(\"object\"===typeof b&&null!==b){switch(b.$$typeof){case Za:return c=Ug(b.type,b.key,b.props,null,a.mode,c),c.ref=Pg(a,null,b),c.return=a,c;case $a:return b=Vg(b,a.mode,c),b.return=a,b}if(Og(b)||\nnb(b))return b=Wg(b,a.mode,c,null),b.return=a,b;Qg(a,b)}return null}function x(a,b,c,d){var e=null!==b?b.key:null;if(\"string\"===typeof c||\"number\"===typeof c)return null!==e?null:h(a,b,\"\"+c,d);if(\"object\"===typeof c&&null!==c){switch(c.$$typeof){case Za:return c.key===e?c.type===ab?m(a,b,c.props.children,d,e):k(a,b,c,d):null;case $a:return c.key===e?l(a,b,c,d):null}if(Og(c)||nb(c))return null!==e?null:m(a,b,c,d,null);Qg(a,c)}return null}function z(a,b,c,d,e){if(\"string\"===typeof d||\"number\"===typeof d)return a=\na.get(c)||null,h(b,a,\"\"+d,e);if(\"object\"===typeof d&&null!==d){switch(d.$$typeof){case Za:return a=a.get(null===d.key?c:d.key)||null,d.type===ab?m(b,a,d.props.children,e,d.key):k(b,a,d,e);case $a:return a=a.get(null===d.key?c:d.key)||null,l(b,a,d,e)}if(Og(d)||nb(d))return a=a.get(c)||null,m(b,a,d,e,null);Qg(b,d)}return null}function ca(e,g,h,k){for(var l=null,t=null,m=g,y=g=0,A=null;null!==m&&y<h.length;y++){m.index>y?(A=m,m=null):A=m.sibling;var q=x(e,m,h[y],k);if(null===q){null===m&&(m=A);break}a&&\nm&&null===q.alternate&&b(e,m);g=f(q,g,y);null===t?l=q:t.sibling=q;t=q;m=A}if(y===h.length)return c(e,m),l;if(null===m){for(;y<h.length;y++)m=p(e,h[y],k),null!==m&&(g=f(m,g,y),null===t?l=m:t.sibling=m,t=m);return l}for(m=d(e,m);y<h.length;y++)A=z(m,e,y,h[y],k),null!==A&&(a&&null!==A.alternate&&m.delete(null===A.key?y:A.key),g=f(A,g,y),null===t?l=A:t.sibling=A,t=A);a&&m.forEach(function(a){return b(e,a)});return l}function D(e,g,h,l){var k=nb(h);if(\"function\"!==typeof k)throw Error(u(150));h=k.call(h);\nif(null==h)throw Error(u(151));for(var m=k=null,t=g,y=g=0,A=null,q=h.next();null!==t&&!q.done;y++,q=h.next()){t.index>y?(A=t,t=null):A=t.sibling;var D=x(e,t,q.value,l);if(null===D){null===t&&(t=A);break}a&&t&&null===D.alternate&&b(e,t);g=f(D,g,y);null===m?k=D:m.sibling=D;m=D;t=A}if(q.done)return c(e,t),k;if(null===t){for(;!q.done;y++,q=h.next())q=p(e,q.value,l),null!==q&&(g=f(q,g,y),null===m?k=q:m.sibling=q,m=q);return k}for(t=d(e,t);!q.done;y++,q=h.next())q=z(t,e,y,q.value,l),null!==q&&(a&&null!==\nq.alternate&&t.delete(null===q.key?y:q.key),g=f(q,g,y),null===m?k=q:m.sibling=q,m=q);a&&t.forEach(function(a){return b(e,a)});return k}return function(a,d,f,h){var k=\"object\"===typeof f&&null!==f&&f.type===ab&&null===f.key;k&&(f=f.props.children);var l=\"object\"===typeof f&&null!==f;if(l)switch(f.$$typeof){case Za:a:{l=f.key;for(k=d;null!==k;){if(k.key===l){switch(k.tag){case 7:if(f.type===ab){c(a,k.sibling);d=e(k,f.props.children);d.return=a;a=d;break a}break;default:if(k.elementType===f.type){c(a,\nk.sibling);d=e(k,f.props);d.ref=Pg(a,k,f);d.return=a;a=d;break a}}c(a,k);break}else b(a,k);k=k.sibling}f.type===ab?(d=Wg(f.props.children,a.mode,h,f.key),d.return=a,a=d):(h=Ug(f.type,f.key,f.props,null,a.mode,h),h.ref=Pg(a,d,f),h.return=a,a=h)}return g(a);case $a:a:{for(k=f.key;null!==d;){if(d.key===k)if(4===d.tag&&d.stateNode.containerInfo===f.containerInfo&&d.stateNode.implementation===f.implementation){c(a,d.sibling);d=e(d,f.children||[]);d.return=a;a=d;break a}else{c(a,d);break}else b(a,d);d=\nd.sibling}d=Vg(f,a.mode,h);d.return=a;a=d}return g(a)}if(\"string\"===typeof f||\"number\"===typeof f)return f=\"\"+f,null!==d&&6===d.tag?(c(a,d.sibling),d=e(d,f),d.return=a,a=d):(c(a,d),d=Tg(f,a.mode,h),d.return=a,a=d),g(a);if(Og(f))return ca(a,d,f,h);if(nb(f))return D(a,d,f,h);l&&Qg(a,f);if(\"undefined\"===typeof f&&!k)switch(a.tag){case 1:case 0:throw a=a.type,Error(u(152,a.displayName||a.name||\"Component\"));}return c(a,d)}}var Xg=Rg(!0),Yg=Rg(!1),Zg={},$g={current:Zg},ah={current:Zg},bh={current:Zg};\nfunction ch(a){if(a===Zg)throw Error(u(174));return a}function dh(a,b){I(bh,b);I(ah,a);I($g,Zg);a=b.nodeType;switch(a){case 9:case 11:b=(b=b.documentElement)?b.namespaceURI:Ob(null,\"\");break;default:a=8===a?b.parentNode:b,b=a.namespaceURI||null,a=a.tagName,b=Ob(b,a)}H($g);I($g,b)}function eh(){H($g);H(ah);H(bh)}function fh(a){ch(bh.current);var b=ch($g.current);var c=Ob(b,a.type);b!==c&&(I(ah,a),I($g,c))}function gh(a){ah.current===a&&(H($g),H(ah))}var M={current:0};\nfunction hh(a){for(var b=a;null!==b;){if(13===b.tag){var c=b.memoizedState;if(null!==c&&(c=c.dehydrated,null===c||c.data===Bd||c.data===Cd))return b}else if(19===b.tag&&void 0!==b.memoizedProps.revealOrder){if(0!==(b.effectTag&64))return b}else if(null!==b.child){b.child.return=b;b=b.child;continue}if(b===a)break;for(;null===b.sibling;){if(null===b.return||b.return===a)return null;b=b.return}b.sibling.return=b.return;b=b.sibling}return null}function ih(a,b){return{responder:a,props:b}}\nvar jh=Wa.ReactCurrentDispatcher,kh=Wa.ReactCurrentBatchConfig,lh=0,N=null,O=null,P=null,mh=!1;function Q(){throw Error(u(321));}function nh(a,b){if(null===b)return!1;for(var c=0;c<b.length&&c<a.length;c++)if(!$e(a[c],b[c]))return!1;return!0}\nfunction oh(a,b,c,d,e,f){lh=f;N=b;b.memoizedState=null;b.updateQueue=null;b.expirationTime=0;jh.current=null===a||null===a.memoizedState?ph:qh;a=c(d,e);if(b.expirationTime===lh){f=0;do{b.expirationTime=0;if(!(25>f))throw Error(u(301));f+=1;P=O=null;b.updateQueue=null;jh.current=rh;a=c(d,e)}while(b.expirationTime===lh)}jh.current=sh;b=null!==O&&null!==O.next;lh=0;P=O=N=null;mh=!1;if(b)throw Error(u(300));return a}\nfunction th(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};null===P?N.memoizedState=P=a:P=P.next=a;return P}function uh(){if(null===O){var a=N.alternate;a=null!==a?a.memoizedState:null}else a=O.next;var b=null===P?N.memoizedState:P.next;if(null!==b)P=b,O=a;else{if(null===a)throw Error(u(310));O=a;a={memoizedState:O.memoizedState,baseState:O.baseState,baseQueue:O.baseQueue,queue:O.queue,next:null};null===P?N.memoizedState=P=a:P=P.next=a}return P}\nfunction vh(a,b){return\"function\"===typeof b?b(a):b}\nfunction wh(a){var b=uh(),c=b.queue;if(null===c)throw Error(u(311));c.lastRenderedReducer=a;var d=O,e=d.baseQueue,f=c.pending;if(null!==f){if(null!==e){var g=e.next;e.next=f.next;f.next=g}d.baseQueue=e=f;c.pending=null}if(null!==e){e=e.next;d=d.baseState;var h=g=f=null,k=e;do{var l=k.expirationTime;if(l<lh){var m={expirationTime:k.expirationTime,suspenseConfig:k.suspenseConfig,action:k.action,eagerReducer:k.eagerReducer,eagerState:k.eagerState,next:null};null===h?(g=h=m,f=d):h=h.next=m;l>N.expirationTime&&\n(N.expirationTime=l,Bg(l))}else null!==h&&(h=h.next={expirationTime:1073741823,suspenseConfig:k.suspenseConfig,action:k.action,eagerReducer:k.eagerReducer,eagerState:k.eagerState,next:null}),Ag(l,k.suspenseConfig),d=k.eagerReducer===a?k.eagerState:a(d,k.action);k=k.next}while(null!==k&&k!==e);null===h?f=d:h.next=g;$e(d,b.memoizedState)||(rg=!0);b.memoizedState=d;b.baseState=f;b.baseQueue=h;c.lastRenderedState=d}return[b.memoizedState,c.dispatch]}\nfunction xh(a){var b=uh(),c=b.queue;if(null===c)throw Error(u(311));c.lastRenderedReducer=a;var d=c.dispatch,e=c.pending,f=b.memoizedState;if(null!==e){c.pending=null;var g=e=e.next;do f=a(f,g.action),g=g.next;while(g!==e);$e(f,b.memoizedState)||(rg=!0);b.memoizedState=f;null===b.baseQueue&&(b.baseState=f);c.lastRenderedState=f}return[f,d]}\nfunction yh(a){var b=th();\"function\"===typeof a&&(a=a());b.memoizedState=b.baseState=a;a=b.queue={pending:null,dispatch:null,lastRenderedReducer:vh,lastRenderedState:a};a=a.dispatch=zh.bind(null,N,a);return[b.memoizedState,a]}function Ah(a,b,c,d){a={tag:a,create:b,destroy:c,deps:d,next:null};b=N.updateQueue;null===b?(b={lastEffect:null},N.updateQueue=b,b.lastEffect=a.next=a):(c=b.lastEffect,null===c?b.lastEffect=a.next=a:(d=c.next,c.next=a,a.next=d,b.lastEffect=a));return a}\nfunction Bh(){return uh().memoizedState}function Ch(a,b,c,d){var e=th();N.effectTag|=a;e.memoizedState=Ah(1|b,c,void 0,void 0===d?null:d)}function Dh(a,b,c,d){var e=uh();d=void 0===d?null:d;var f=void 0;if(null!==O){var g=O.memoizedState;f=g.destroy;if(null!==d&&nh(d,g.deps)){Ah(b,c,f,d);return}}N.effectTag|=a;e.memoizedState=Ah(1|b,c,f,d)}function Eh(a,b){return Ch(516,4,a,b)}function Fh(a,b){return Dh(516,4,a,b)}function Gh(a,b){return Dh(4,2,a,b)}\nfunction Hh(a,b){if(\"function\"===typeof b)return a=a(),b(a),function(){b(null)};if(null!==b&&void 0!==b)return a=a(),b.current=a,function(){b.current=null}}function Ih(a,b,c){c=null!==c&&void 0!==c?c.concat([a]):null;return Dh(4,2,Hh.bind(null,b,a),c)}function Jh(){}function Kh(a,b){th().memoizedState=[a,void 0===b?null:b];return a}function Lh(a,b){var c=uh();b=void 0===b?null:b;var d=c.memoizedState;if(null!==d&&null!==b&&nh(b,d[1]))return d[0];c.memoizedState=[a,b];return a}\nfunction Mh(a,b){var c=uh();b=void 0===b?null:b;var d=c.memoizedState;if(null!==d&&null!==b&&nh(b,d[1]))return d[0];a=a();c.memoizedState=[a,b];return a}function Nh(a,b,c){var d=ag();cg(98>d?98:d,function(){a(!0)});cg(97<d?97:d,function(){var d=kh.suspense;kh.suspense=void 0===b?null:b;try{a(!1),c()}finally{kh.suspense=d}})}\nfunction zh(a,b,c){var d=Gg(),e=Dg.suspense;d=Hg(d,a,e);e={expirationTime:d,suspenseConfig:e,action:c,eagerReducer:null,eagerState:null,next:null};var f=b.pending;null===f?e.next=e:(e.next=f.next,f.next=e);b.pending=e;f=a.alternate;if(a===N||null!==f&&f===N)mh=!0,e.expirationTime=lh,N.expirationTime=lh;else{if(0===a.expirationTime&&(null===f||0===f.expirationTime)&&(f=b.lastRenderedReducer,null!==f))try{var g=b.lastRenderedState,h=f(g,c);e.eagerReducer=f;e.eagerState=h;if($e(h,g))return}catch(k){}finally{}Ig(a,\nd)}}\nvar sh={readContext:sg,useCallback:Q,useContext:Q,useEffect:Q,useImperativeHandle:Q,useLayoutEffect:Q,useMemo:Q,useReducer:Q,useRef:Q,useState:Q,useDebugValue:Q,useResponder:Q,useDeferredValue:Q,useTransition:Q},ph={readContext:sg,useCallback:Kh,useContext:sg,useEffect:Eh,useImperativeHandle:function(a,b,c){c=null!==c&&void 0!==c?c.concat([a]):null;return Ch(4,2,Hh.bind(null,b,a),c)},useLayoutEffect:function(a,b){return Ch(4,2,a,b)},useMemo:function(a,b){var c=th();b=void 0===b?null:b;a=a();c.memoizedState=[a,\nb];return a},useReducer:function(a,b,c){var d=th();b=void 0!==c?c(b):b;d.memoizedState=d.baseState=b;a=d.queue={pending:null,dispatch:null,lastRenderedReducer:a,lastRenderedState:b};a=a.dispatch=zh.bind(null,N,a);return[d.memoizedState,a]},useRef:function(a){var b=th();a={current:a};return b.memoizedState=a},useState:yh,useDebugValue:Jh,useResponder:ih,useDeferredValue:function(a,b){var c=yh(a),d=c[0],e=c[1];Eh(function(){var c=kh.suspense;kh.suspense=void 0===b?null:b;try{e(a)}finally{kh.suspense=\nc}},[a,b]);return d},useTransition:function(a){var b=yh(!1),c=b[0];b=b[1];return[Kh(Nh.bind(null,b,a),[b,a]),c]}},qh={readContext:sg,useCallback:Lh,useContext:sg,useEffect:Fh,useImperativeHandle:Ih,useLayoutEffect:Gh,useMemo:Mh,useReducer:wh,useRef:Bh,useState:function(){return wh(vh)},useDebugValue:Jh,useResponder:ih,useDeferredValue:function(a,b){var c=wh(vh),d=c[0],e=c[1];Fh(function(){var c=kh.suspense;kh.suspense=void 0===b?null:b;try{e(a)}finally{kh.suspense=c}},[a,b]);return d},useTransition:function(a){var b=\nwh(vh),c=b[0];b=b[1];return[Lh(Nh.bind(null,b,a),[b,a]),c]}},rh={readContext:sg,useCallback:Lh,useContext:sg,useEffect:Fh,useImperativeHandle:Ih,useLayoutEffect:Gh,useMemo:Mh,useReducer:xh,useRef:Bh,useState:function(){return xh(vh)},useDebugValue:Jh,useResponder:ih,useDeferredValue:function(a,b){var c=xh(vh),d=c[0],e=c[1];Fh(function(){var c=kh.suspense;kh.suspense=void 0===b?null:b;try{e(a)}finally{kh.suspense=c}},[a,b]);return d},useTransition:function(a){var b=xh(vh),c=b[0];b=b[1];return[Lh(Nh.bind(null,\nb,a),[b,a]),c]}},Oh=null,Ph=null,Qh=!1;function Rh(a,b){var c=Sh(5,null,null,0);c.elementType=\"DELETED\";c.type=\"DELETED\";c.stateNode=b;c.return=a;c.effectTag=8;null!==a.lastEffect?(a.lastEffect.nextEffect=c,a.lastEffect=c):a.firstEffect=a.lastEffect=c}\nfunction Th(a,b){switch(a.tag){case 5:var c=a.type;b=1!==b.nodeType||c.toLowerCase()!==b.nodeName.toLowerCase()?null:b;return null!==b?(a.stateNode=b,!0):!1;case 6:return b=\"\"===a.pendingProps||3!==b.nodeType?null:b,null!==b?(a.stateNode=b,!0):!1;case 13:return!1;default:return!1}}\nfunction Uh(a){if(Qh){var b=Ph;if(b){var c=b;if(!Th(a,b)){b=Jd(c.nextSibling);if(!b||!Th(a,b)){a.effectTag=a.effectTag&-1025|2;Qh=!1;Oh=a;return}Rh(Oh,c)}Oh=a;Ph=Jd(b.firstChild)}else a.effectTag=a.effectTag&-1025|2,Qh=!1,Oh=a}}function Vh(a){for(a=a.return;null!==a&&5!==a.tag&&3!==a.tag&&13!==a.tag;)a=a.return;Oh=a}\nfunction Wh(a){if(a!==Oh)return!1;if(!Qh)return Vh(a),Qh=!0,!1;var b=a.type;if(5!==a.tag||\"head\"!==b&&\"body\"!==b&&!Gd(b,a.memoizedProps))for(b=Ph;b;)Rh(a,b),b=Jd(b.nextSibling);Vh(a);if(13===a.tag){a=a.memoizedState;a=null!==a?a.dehydrated:null;if(!a)throw Error(u(317));a:{a=a.nextSibling;for(b=0;a;){if(8===a.nodeType){var c=a.data;if(c===Ad){if(0===b){Ph=Jd(a.nextSibling);break a}b--}else c!==zd&&c!==Cd&&c!==Bd||b++}a=a.nextSibling}Ph=null}}else Ph=Oh?Jd(a.stateNode.nextSibling):null;return!0}\nfunction Xh(){Ph=Oh=null;Qh=!1}var Yh=Wa.ReactCurrentOwner,rg=!1;function R(a,b,c,d){b.child=null===a?Yg(b,null,c,d):Xg(b,a.child,c,d)}function Zh(a,b,c,d,e){c=c.render;var f=b.ref;qg(b,e);d=oh(a,b,c,d,f,e);if(null!==a&&!rg)return b.updateQueue=a.updateQueue,b.effectTag&=-517,a.expirationTime<=e&&(a.expirationTime=0),$h(a,b,e);b.effectTag|=1;R(a,b,d,e);return b.child}\nfunction ai(a,b,c,d,e,f){if(null===a){var g=c.type;if(\"function\"===typeof g&&!bi(g)&&void 0===g.defaultProps&&null===c.compare&&void 0===c.defaultProps)return b.tag=15,b.type=g,ci(a,b,g,d,e,f);a=Ug(c.type,null,d,null,b.mode,f);a.ref=b.ref;a.return=b;return b.child=a}g=a.child;if(e<f&&(e=g.memoizedProps,c=c.compare,c=null!==c?c:bf,c(e,d)&&a.ref===b.ref))return $h(a,b,f);b.effectTag|=1;a=Sg(g,d);a.ref=b.ref;a.return=b;return b.child=a}\nfunction ci(a,b,c,d,e,f){return null!==a&&bf(a.memoizedProps,d)&&a.ref===b.ref&&(rg=!1,e<f)?(b.expirationTime=a.expirationTime,$h(a,b,f)):di(a,b,c,d,f)}function ei(a,b){var c=b.ref;if(null===a&&null!==c||null!==a&&a.ref!==c)b.effectTag|=128}function di(a,b,c,d,e){var f=L(c)?Bf:J.current;f=Cf(b,f);qg(b,e);c=oh(a,b,c,d,f,e);if(null!==a&&!rg)return b.updateQueue=a.updateQueue,b.effectTag&=-517,a.expirationTime<=e&&(a.expirationTime=0),$h(a,b,e);b.effectTag|=1;R(a,b,c,e);return b.child}\nfunction fi(a,b,c,d,e){if(L(c)){var f=!0;Gf(b)}else f=!1;qg(b,e);if(null===b.stateNode)null!==a&&(a.alternate=null,b.alternate=null,b.effectTag|=2),Lg(b,c,d),Ng(b,c,d,e),d=!0;else if(null===a){var g=b.stateNode,h=b.memoizedProps;g.props=h;var k=g.context,l=c.contextType;\"object\"===typeof l&&null!==l?l=sg(l):(l=L(c)?Bf:J.current,l=Cf(b,l));var m=c.getDerivedStateFromProps,p=\"function\"===typeof m||\"function\"===typeof g.getSnapshotBeforeUpdate;p||\"function\"!==typeof g.UNSAFE_componentWillReceiveProps&&\n\"function\"!==typeof g.componentWillReceiveProps||(h!==d||k!==l)&&Mg(b,g,d,l);tg=!1;var x=b.memoizedState;g.state=x;zg(b,d,g,e);k=b.memoizedState;h!==d||x!==k||K.current||tg?(\"function\"===typeof m&&(Fg(b,c,m,d),k=b.memoizedState),(h=tg||Kg(b,c,h,d,x,k,l))?(p||\"function\"!==typeof g.UNSAFE_componentWillMount&&\"function\"!==typeof g.componentWillMount||(\"function\"===typeof g.componentWillMount&&g.componentWillMount(),\"function\"===typeof g.UNSAFE_componentWillMount&&g.UNSAFE_componentWillMount()),\"function\"===\ntypeof g.componentDidMount&&(b.effectTag|=4)):(\"function\"===typeof g.componentDidMount&&(b.effectTag|=4),b.memoizedProps=d,b.memoizedState=k),g.props=d,g.state=k,g.context=l,d=h):(\"function\"===typeof g.componentDidMount&&(b.effectTag|=4),d=!1)}else g=b.stateNode,vg(a,b),h=b.memoizedProps,g.props=b.type===b.elementType?h:ig(b.type,h),k=g.context,l=c.contextType,\"object\"===typeof l&&null!==l?l=sg(l):(l=L(c)?Bf:J.current,l=Cf(b,l)),m=c.getDerivedStateFromProps,(p=\"function\"===typeof m||\"function\"===\ntypeof g.getSnapshotBeforeUpdate)||\"function\"!==typeof g.UNSAFE_componentWillReceiveProps&&\"function\"!==typeof g.componentWillReceiveProps||(h!==d||k!==l)&&Mg(b,g,d,l),tg=!1,k=b.memoizedState,g.state=k,zg(b,d,g,e),x=b.memoizedState,h!==d||k!==x||K.current||tg?(\"function\"===typeof m&&(Fg(b,c,m,d),x=b.memoizedState),(m=tg||Kg(b,c,h,d,k,x,l))?(p||\"function\"!==typeof g.UNSAFE_componentWillUpdate&&\"function\"!==typeof g.componentWillUpdate||(\"function\"===typeof g.componentWillUpdate&&g.componentWillUpdate(d,\nx,l),\"function\"===typeof g.UNSAFE_componentWillUpdate&&g.UNSAFE_componentWillUpdate(d,x,l)),\"function\"===typeof g.componentDidUpdate&&(b.effectTag|=4),\"function\"===typeof g.getSnapshotBeforeUpdate&&(b.effectTag|=256)):(\"function\"!==typeof g.componentDidUpdate||h===a.memoizedProps&&k===a.memoizedState||(b.effectTag|=4),\"function\"!==typeof g.getSnapshotBeforeUpdate||h===a.memoizedProps&&k===a.memoizedState||(b.effectTag|=256),b.memoizedProps=d,b.memoizedState=x),g.props=d,g.state=x,g.context=l,d=m):\n(\"function\"!==typeof g.componentDidUpdate||h===a.memoizedProps&&k===a.memoizedState||(b.effectTag|=4),\"function\"!==typeof g.getSnapshotBeforeUpdate||h===a.memoizedProps&&k===a.memoizedState||(b.effectTag|=256),d=!1);return gi(a,b,c,d,f,e)}\nfunction gi(a,b,c,d,e,f){ei(a,b);var g=0!==(b.effectTag&64);if(!d&&!g)return e&&Hf(b,c,!1),$h(a,b,f);d=b.stateNode;Yh.current=b;var h=g&&\"function\"!==typeof c.getDerivedStateFromError?null:d.render();b.effectTag|=1;null!==a&&g?(b.child=Xg(b,a.child,null,f),b.child=Xg(b,null,h,f)):R(a,b,h,f);b.memoizedState=d.state;e&&Hf(b,c,!0);return b.child}function hi(a){var b=a.stateNode;b.pendingContext?Ef(a,b.pendingContext,b.pendingContext!==b.context):b.context&&Ef(a,b.context,!1);dh(a,b.containerInfo)}\nvar ii={dehydrated:null,retryTime:0};\nfunction ji(a,b,c){var d=b.mode,e=b.pendingProps,f=M.current,g=!1,h;(h=0!==(b.effectTag&64))||(h=0!==(f&2)&&(null===a||null!==a.memoizedState));h?(g=!0,b.effectTag&=-65):null!==a&&null===a.memoizedState||void 0===e.fallback||!0===e.unstable_avoidThisFallback||(f|=1);I(M,f&1);if(null===a){void 0!==e.fallback&&Uh(b);if(g){g=e.fallback;e=Wg(null,d,0,null);e.return=b;if(0===(b.mode&2))for(a=null!==b.memoizedState?b.child.child:b.child,e.child=a;null!==a;)a.return=e,a=a.sibling;c=Wg(g,d,c,null);c.return=\nb;e.sibling=c;b.memoizedState=ii;b.child=e;return c}d=e.children;b.memoizedState=null;return b.child=Yg(b,null,d,c)}if(null!==a.memoizedState){a=a.child;d=a.sibling;if(g){e=e.fallback;c=Sg(a,a.pendingProps);c.return=b;if(0===(b.mode&2)&&(g=null!==b.memoizedState?b.child.child:b.child,g!==a.child))for(c.child=g;null!==g;)g.return=c,g=g.sibling;d=Sg(d,e);d.return=b;c.sibling=d;c.childExpirationTime=0;b.memoizedState=ii;b.child=c;return d}c=Xg(b,a.child,e.children,c);b.memoizedState=null;return b.child=\nc}a=a.child;if(g){g=e.fallback;e=Wg(null,d,0,null);e.return=b;e.child=a;null!==a&&(a.return=e);if(0===(b.mode&2))for(a=null!==b.memoizedState?b.child.child:b.child,e.child=a;null!==a;)a.return=e,a=a.sibling;c=Wg(g,d,c,null);c.return=b;e.sibling=c;c.effectTag|=2;e.childExpirationTime=0;b.memoizedState=ii;b.child=e;return c}b.memoizedState=null;return b.child=Xg(b,a,e.children,c)}\nfunction ki(a,b){a.expirationTime<b&&(a.expirationTime=b);var c=a.alternate;null!==c&&c.expirationTime<b&&(c.expirationTime=b);pg(a.return,b)}function li(a,b,c,d,e,f){var g=a.memoizedState;null===g?a.memoizedState={isBackwards:b,rendering:null,renderingStartTime:0,last:d,tail:c,tailExpiration:0,tailMode:e,lastEffect:f}:(g.isBackwards=b,g.rendering=null,g.renderingStartTime=0,g.last=d,g.tail=c,g.tailExpiration=0,g.tailMode=e,g.lastEffect=f)}\nfunction mi(a,b,c){var d=b.pendingProps,e=d.revealOrder,f=d.tail;R(a,b,d.children,c);d=M.current;if(0!==(d&2))d=d&1|2,b.effectTag|=64;else{if(null!==a&&0!==(a.effectTag&64))a:for(a=b.child;null!==a;){if(13===a.tag)null!==a.memoizedState&&ki(a,c);else if(19===a.tag)ki(a,c);else if(null!==a.child){a.child.return=a;a=a.child;continue}if(a===b)break a;for(;null===a.sibling;){if(null===a.return||a.return===b)break a;a=a.return}a.sibling.return=a.return;a=a.sibling}d&=1}I(M,d);if(0===(b.mode&2))b.memoizedState=\nnull;else switch(e){case \"forwards\":c=b.child;for(e=null;null!==c;)a=c.alternate,null!==a&&null===hh(a)&&(e=c),c=c.sibling;c=e;null===c?(e=b.child,b.child=null):(e=c.sibling,c.sibling=null);li(b,!1,e,c,f,b.lastEffect);break;case \"backwards\":c=null;e=b.child;for(b.child=null;null!==e;){a=e.alternate;if(null!==a&&null===hh(a)){b.child=e;break}a=e.sibling;e.sibling=c;c=e;e=a}li(b,!0,c,null,f,b.lastEffect);break;case \"together\":li(b,!1,null,null,void 0,b.lastEffect);break;default:b.memoizedState=null}return b.child}\nfunction $h(a,b,c){null!==a&&(b.dependencies=a.dependencies);var d=b.expirationTime;0!==d&&Bg(d);if(b.childExpirationTime<c)return null;if(null!==a&&b.child!==a.child)throw Error(u(153));if(null!==b.child){a=b.child;c=Sg(a,a.pendingProps);b.child=c;for(c.return=b;null!==a.sibling;)a=a.sibling,c=c.sibling=Sg(a,a.pendingProps),c.return=b;c.sibling=null}return b.child}var ni,oi,pi,qi;\nni=function(a,b){for(var c=b.child;null!==c;){if(5===c.tag||6===c.tag)a.appendChild(c.stateNode);else if(4!==c.tag&&null!==c.child){c.child.return=c;c=c.child;continue}if(c===b)break;for(;null===c.sibling;){if(null===c.return||c.return===b)return;c=c.return}c.sibling.return=c.return;c=c.sibling}};oi=function(){};\npi=function(a,b,c,d,e){var f=a.memoizedProps;if(f!==d){var g=b.stateNode;ch($g.current);a=null;switch(c){case \"input\":f=zb(g,f);d=zb(g,d);a=[];break;case \"option\":f=Gb(g,f);d=Gb(g,d);a=[];break;case \"select\":f=n({},f,{value:void 0});d=n({},d,{value:void 0});a=[];break;case \"textarea\":f=Ib(g,f);d=Ib(g,d);a=[];break;default:\"function\"!==typeof f.onClick&&\"function\"===typeof d.onClick&&(g.onclick=sd)}od(c,d);var h,k;c=null;for(h in f)if(!d.hasOwnProperty(h)&&f.hasOwnProperty(h)&&null!=f[h])if(\"style\"===\nh)for(k in g=f[h],g)g.hasOwnProperty(k)&&(c||(c={}),c[k]=\"\");else\"dangerouslySetInnerHTML\"!==h&&\"children\"!==h&&\"suppressContentEditableWarning\"!==h&&\"suppressHydrationWarning\"!==h&&\"autoFocus\"!==h&&(va.hasOwnProperty(h)?a||(a=[]):(a=a||[]).push(h,null));for(h in d){var l=d[h];g=null!=f?f[h]:void 0;if(d.hasOwnProperty(h)&&l!==g&&(null!=l||null!=g))if(\"style\"===h)if(g){for(k in g)!g.hasOwnProperty(k)||l&&l.hasOwnProperty(k)||(c||(c={}),c[k]=\"\");for(k in l)l.hasOwnProperty(k)&&g[k]!==l[k]&&(c||(c={}),\nc[k]=l[k])}else c||(a||(a=[]),a.push(h,c)),c=l;else\"dangerouslySetInnerHTML\"===h?(l=l?l.__html:void 0,g=g?g.__html:void 0,null!=l&&g!==l&&(a=a||[]).push(h,l)):\"children\"===h?g===l||\"string\"!==typeof l&&\"number\"!==typeof l||(a=a||[]).push(h,\"\"+l):\"suppressContentEditableWarning\"!==h&&\"suppressHydrationWarning\"!==h&&(va.hasOwnProperty(h)?(null!=l&&rd(e,h),a||g===l||(a=[])):(a=a||[]).push(h,l))}c&&(a=a||[]).push(\"style\",c);e=a;if(b.updateQueue=e)b.effectTag|=4}};\nqi=function(a,b,c,d){c!==d&&(b.effectTag|=4)};function ri(a,b){switch(a.tailMode){case \"hidden\":b=a.tail;for(var c=null;null!==b;)null!==b.alternate&&(c=b),b=b.sibling;null===c?a.tail=null:c.sibling=null;break;case \"collapsed\":c=a.tail;for(var d=null;null!==c;)null!==c.alternate&&(d=c),c=c.sibling;null===d?b||null===a.tail?a.tail=null:a.tail.sibling=null:d.sibling=null}}\nfunction si(a,b,c){var d=b.pendingProps;switch(b.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:return L(b.type)&&Df(),null;case 3:return eh(),H(K),H(J),c=b.stateNode,c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),null!==a&&null!==a.child||!Wh(b)||(b.effectTag|=4),oi(b),null;case 5:gh(b);c=ch(bh.current);var e=b.type;if(null!==a&&null!=b.stateNode)pi(a,b,e,d,c),a.ref!==b.ref&&(b.effectTag|=128);else{if(!d){if(null===b.stateNode)throw Error(u(166));\nreturn null}a=ch($g.current);if(Wh(b)){d=b.stateNode;e=b.type;var f=b.memoizedProps;d[Md]=b;d[Nd]=f;switch(e){case \"iframe\":case \"object\":case \"embed\":F(\"load\",d);break;case \"video\":case \"audio\":for(a=0;a<ac.length;a++)F(ac[a],d);break;case \"source\":F(\"error\",d);break;case \"img\":case \"image\":case \"link\":F(\"error\",d);F(\"load\",d);break;case \"form\":F(\"reset\",d);F(\"submit\",d);break;case \"details\":F(\"toggle\",d);break;case \"input\":Ab(d,f);F(\"invalid\",d);rd(c,\"onChange\");break;case \"select\":d._wrapperState=\n{wasMultiple:!!f.multiple};F(\"invalid\",d);rd(c,\"onChange\");break;case \"textarea\":Jb(d,f),F(\"invalid\",d),rd(c,\"onChange\")}od(e,f);a=null;for(var g in f)if(f.hasOwnProperty(g)){var h=f[g];\"children\"===g?\"string\"===typeof h?d.textContent!==h&&(a=[\"children\",h]):\"number\"===typeof h&&d.textContent!==\"\"+h&&(a=[\"children\",\"\"+h]):va.hasOwnProperty(g)&&null!=h&&rd(c,g)}switch(e){case \"input\":xb(d);Eb(d,f,!0);break;case \"textarea\":xb(d);Lb(d);break;case \"select\":case \"option\":break;default:\"function\"===typeof f.onClick&&\n(d.onclick=sd)}c=a;b.updateQueue=c;null!==c&&(b.effectTag|=4)}else{g=9===c.nodeType?c:c.ownerDocument;a===qd&&(a=Nb(e));a===qd?\"script\"===e?(a=g.createElement(\"div\"),a.innerHTML=\"<script>\\x3c/script>\",a=a.removeChild(a.firstChild)):\"string\"===typeof d.is?a=g.createElement(e,{is:d.is}):(a=g.createElement(e),\"select\"===e&&(g=a,d.multiple?g.multiple=!0:d.size&&(g.size=d.size))):a=g.createElementNS(a,e);a[Md]=b;a[Nd]=d;ni(a,b,!1,!1);b.stateNode=a;g=pd(e,d);switch(e){case \"iframe\":case \"object\":case \"embed\":F(\"load\",\na);h=d;break;case \"video\":case \"audio\":for(h=0;h<ac.length;h++)F(ac[h],a);h=d;break;case \"source\":F(\"error\",a);h=d;break;case \"img\":case \"image\":case \"link\":F(\"error\",a);F(\"load\",a);h=d;break;case \"form\":F(\"reset\",a);F(\"submit\",a);h=d;break;case \"details\":F(\"toggle\",a);h=d;break;case \"input\":Ab(a,d);h=zb(a,d);F(\"invalid\",a);rd(c,\"onChange\");break;case \"option\":h=Gb(a,d);break;case \"select\":a._wrapperState={wasMultiple:!!d.multiple};h=n({},d,{value:void 0});F(\"invalid\",a);rd(c,\"onChange\");break;case \"textarea\":Jb(a,\nd);h=Ib(a,d);F(\"invalid\",a);rd(c,\"onChange\");break;default:h=d}od(e,h);var k=h;for(f in k)if(k.hasOwnProperty(f)){var l=k[f];\"style\"===f?md(a,l):\"dangerouslySetInnerHTML\"===f?(l=l?l.__html:void 0,null!=l&&Qb(a,l)):\"children\"===f?\"string\"===typeof l?(\"textarea\"!==e||\"\"!==l)&&Rb(a,l):\"number\"===typeof l&&Rb(a,\"\"+l):\"suppressContentEditableWarning\"!==f&&\"suppressHydrationWarning\"!==f&&\"autoFocus\"!==f&&(va.hasOwnProperty(f)?null!=l&&rd(c,f):null!=l&&Xa(a,f,l,g))}switch(e){case \"input\":xb(a);Eb(a,d,!1);\nbreak;case \"textarea\":xb(a);Lb(a);break;case \"option\":null!=d.value&&a.setAttribute(\"value\",\"\"+rb(d.value));break;case \"select\":a.multiple=!!d.multiple;c=d.value;null!=c?Hb(a,!!d.multiple,c,!1):null!=d.defaultValue&&Hb(a,!!d.multiple,d.defaultValue,!0);break;default:\"function\"===typeof h.onClick&&(a.onclick=sd)}Fd(e,d)&&(b.effectTag|=4)}null!==b.ref&&(b.effectTag|=128)}return null;case 6:if(a&&null!=b.stateNode)qi(a,b,a.memoizedProps,d);else{if(\"string\"!==typeof d&&null===b.stateNode)throw Error(u(166));\nc=ch(bh.current);ch($g.current);Wh(b)?(c=b.stateNode,d=b.memoizedProps,c[Md]=b,c.nodeValue!==d&&(b.effectTag|=4)):(c=(9===c.nodeType?c:c.ownerDocument).createTextNode(d),c[Md]=b,b.stateNode=c)}return null;case 13:H(M);d=b.memoizedState;if(0!==(b.effectTag&64))return b.expirationTime=c,b;c=null!==d;d=!1;null===a?void 0!==b.memoizedProps.fallback&&Wh(b):(e=a.memoizedState,d=null!==e,c||null===e||(e=a.child.sibling,null!==e&&(f=b.firstEffect,null!==f?(b.firstEffect=e,e.nextEffect=f):(b.firstEffect=b.lastEffect=\ne,e.nextEffect=null),e.effectTag=8)));if(c&&!d&&0!==(b.mode&2))if(null===a&&!0!==b.memoizedProps.unstable_avoidThisFallback||0!==(M.current&1))S===ti&&(S=ui);else{if(S===ti||S===ui)S=vi;0!==wi&&null!==T&&(xi(T,U),yi(T,wi))}if(c||d)b.effectTag|=4;return null;case 4:return eh(),oi(b),null;case 10:return og(b),null;case 17:return L(b.type)&&Df(),null;case 19:H(M);d=b.memoizedState;if(null===d)return null;e=0!==(b.effectTag&64);f=d.rendering;if(null===f)if(e)ri(d,!1);else{if(S!==ti||null!==a&&0!==(a.effectTag&\n64))for(f=b.child;null!==f;){a=hh(f);if(null!==a){b.effectTag|=64;ri(d,!1);e=a.updateQueue;null!==e&&(b.updateQueue=e,b.effectTag|=4);null===d.lastEffect&&(b.firstEffect=null);b.lastEffect=d.lastEffect;for(d=b.child;null!==d;)e=d,f=c,e.effectTag&=2,e.nextEffect=null,e.firstEffect=null,e.lastEffect=null,a=e.alternate,null===a?(e.childExpirationTime=0,e.expirationTime=f,e.child=null,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null):(e.childExpirationTime=a.childExpirationTime,\ne.expirationTime=a.expirationTime,e.child=a.child,e.memoizedProps=a.memoizedProps,e.memoizedState=a.memoizedState,e.updateQueue=a.updateQueue,f=a.dependencies,e.dependencies=null===f?null:{expirationTime:f.expirationTime,firstContext:f.firstContext,responders:f.responders}),d=d.sibling;I(M,M.current&1|2);return b.child}f=f.sibling}}else{if(!e)if(a=hh(f),null!==a){if(b.effectTag|=64,e=!0,c=a.updateQueue,null!==c&&(b.updateQueue=c,b.effectTag|=4),ri(d,!0),null===d.tail&&\"hidden\"===d.tailMode&&!f.alternate)return b=\nb.lastEffect=d.lastEffect,null!==b&&(b.nextEffect=null),null}else 2*$f()-d.renderingStartTime>d.tailExpiration&&1<c&&(b.effectTag|=64,e=!0,ri(d,!1),b.expirationTime=b.childExpirationTime=c-1);d.isBackwards?(f.sibling=b.child,b.child=f):(c=d.last,null!==c?c.sibling=f:b.child=f,d.last=f)}return null!==d.tail?(0===d.tailExpiration&&(d.tailExpiration=$f()+500),c=d.tail,d.rendering=c,d.tail=c.sibling,d.lastEffect=b.lastEffect,d.renderingStartTime=$f(),c.sibling=null,b=M.current,I(M,e?b&1|2:b&1),c):null}throw Error(u(156,\nb.tag));}function zi(a){switch(a.tag){case 1:L(a.type)&&Df();var b=a.effectTag;return b&4096?(a.effectTag=b&-4097|64,a):null;case 3:eh();H(K);H(J);b=a.effectTag;if(0!==(b&64))throw Error(u(285));a.effectTag=b&-4097|64;return a;case 5:return gh(a),null;case 13:return H(M),b=a.effectTag,b&4096?(a.effectTag=b&-4097|64,a):null;case 19:return H(M),null;case 4:return eh(),null;case 10:return og(a),null;default:return null}}function Ai(a,b){return{value:a,source:b,stack:qb(b)}}\nvar Bi=\"function\"===typeof WeakSet?WeakSet:Set;function Ci(a,b){var c=b.source,d=b.stack;null===d&&null!==c&&(d=qb(c));null!==c&&pb(c.type);b=b.value;null!==a&&1===a.tag&&pb(a.type);try{console.error(b)}catch(e){setTimeout(function(){throw e;})}}function Di(a,b){try{b.props=a.memoizedProps,b.state=a.memoizedState,b.componentWillUnmount()}catch(c){Ei(a,c)}}function Fi(a){var b=a.ref;if(null!==b)if(\"function\"===typeof b)try{b(null)}catch(c){Ei(a,c)}else b.current=null}\nfunction Gi(a,b){switch(b.tag){case 0:case 11:case 15:case 22:return;case 1:if(b.effectTag&256&&null!==a){var c=a.memoizedProps,d=a.memoizedState;a=b.stateNode;b=a.getSnapshotBeforeUpdate(b.elementType===b.type?c:ig(b.type,c),d);a.__reactInternalSnapshotBeforeUpdate=b}return;case 3:case 5:case 6:case 4:case 17:return}throw Error(u(163));}\nfunction Hi(a,b){b=b.updateQueue;b=null!==b?b.lastEffect:null;if(null!==b){var c=b=b.next;do{if((c.tag&a)===a){var d=c.destroy;c.destroy=void 0;void 0!==d&&d()}c=c.next}while(c!==b)}}function Ii(a,b){b=b.updateQueue;b=null!==b?b.lastEffect:null;if(null!==b){var c=b=b.next;do{if((c.tag&a)===a){var d=c.create;c.destroy=d()}c=c.next}while(c!==b)}}\nfunction Ji(a,b,c){switch(c.tag){case 0:case 11:case 15:case 22:Ii(3,c);return;case 1:a=c.stateNode;if(c.effectTag&4)if(null===b)a.componentDidMount();else{var d=c.elementType===c.type?b.memoizedProps:ig(c.type,b.memoizedProps);a.componentDidUpdate(d,b.memoizedState,a.__reactInternalSnapshotBeforeUpdate)}b=c.updateQueue;null!==b&&Cg(c,b,a);return;case 3:b=c.updateQueue;if(null!==b){a=null;if(null!==c.child)switch(c.child.tag){case 5:a=c.child.stateNode;break;case 1:a=c.child.stateNode}Cg(c,b,a)}return;\ncase 5:a=c.stateNode;null===b&&c.effectTag&4&&Fd(c.type,c.memoizedProps)&&a.focus();return;case 6:return;case 4:return;case 12:return;case 13:null===c.memoizedState&&(c=c.alternate,null!==c&&(c=c.memoizedState,null!==c&&(c=c.dehydrated,null!==c&&Vc(c))));return;case 19:case 17:case 20:case 21:return}throw Error(u(163));}\nfunction Ki(a,b,c){\"function\"===typeof Li&&Li(b);switch(b.tag){case 0:case 11:case 14:case 15:case 22:a=b.updateQueue;if(null!==a&&(a=a.lastEffect,null!==a)){var d=a.next;cg(97<c?97:c,function(){var a=d;do{var c=a.destroy;if(void 0!==c){var g=b;try{c()}catch(h){Ei(g,h)}}a=a.next}while(a!==d)})}break;case 1:Fi(b);c=b.stateNode;\"function\"===typeof c.componentWillUnmount&&Di(b,c);break;case 5:Fi(b);break;case 4:Mi(a,b,c)}}\nfunction Ni(a){var b=a.alternate;a.return=null;a.child=null;a.memoizedState=null;a.updateQueue=null;a.dependencies=null;a.alternate=null;a.firstEffect=null;a.lastEffect=null;a.pendingProps=null;a.memoizedProps=null;a.stateNode=null;null!==b&&Ni(b)}function Oi(a){return 5===a.tag||3===a.tag||4===a.tag}\nfunction Pi(a){a:{for(var b=a.return;null!==b;){if(Oi(b)){var c=b;break a}b=b.return}throw Error(u(160));}b=c.stateNode;switch(c.tag){case 5:var d=!1;break;case 3:b=b.containerInfo;d=!0;break;case 4:b=b.containerInfo;d=!0;break;default:throw Error(u(161));}c.effectTag&16&&(Rb(b,\"\"),c.effectTag&=-17);a:b:for(c=a;;){for(;null===c.sibling;){if(null===c.return||Oi(c.return)){c=null;break a}c=c.return}c.sibling.return=c.return;for(c=c.sibling;5!==c.tag&&6!==c.tag&&18!==c.tag;){if(c.effectTag&2)continue b;\nif(null===c.child||4===c.tag)continue b;else c.child.return=c,c=c.child}if(!(c.effectTag&2)){c=c.stateNode;break a}}d?Qi(a,c,b):Ri(a,c,b)}\nfunction Qi(a,b,c){var d=a.tag,e=5===d||6===d;if(e)a=e?a.stateNode:a.stateNode.instance,b?8===c.nodeType?c.parentNode.insertBefore(a,b):c.insertBefore(a,b):(8===c.nodeType?(b=c.parentNode,b.insertBefore(a,c)):(b=c,b.appendChild(a)),c=c._reactRootContainer,null!==c&&void 0!==c||null!==b.onclick||(b.onclick=sd));else if(4!==d&&(a=a.child,null!==a))for(Qi(a,b,c),a=a.sibling;null!==a;)Qi(a,b,c),a=a.sibling}\nfunction Ri(a,b,c){var d=a.tag,e=5===d||6===d;if(e)a=e?a.stateNode:a.stateNode.instance,b?c.insertBefore(a,b):c.appendChild(a);else if(4!==d&&(a=a.child,null!==a))for(Ri(a,b,c),a=a.sibling;null!==a;)Ri(a,b,c),a=a.sibling}\nfunction Mi(a,b,c){for(var d=b,e=!1,f,g;;){if(!e){e=d.return;a:for(;;){if(null===e)throw Error(u(160));f=e.stateNode;switch(e.tag){case 5:g=!1;break a;case 3:f=f.containerInfo;g=!0;break a;case 4:f=f.containerInfo;g=!0;break a}e=e.return}e=!0}if(5===d.tag||6===d.tag){a:for(var h=a,k=d,l=c,m=k;;)if(Ki(h,m,l),null!==m.child&&4!==m.tag)m.child.return=m,m=m.child;else{if(m===k)break a;for(;null===m.sibling;){if(null===m.return||m.return===k)break a;m=m.return}m.sibling.return=m.return;m=m.sibling}g?(h=\nf,k=d.stateNode,8===h.nodeType?h.parentNode.removeChild(k):h.removeChild(k)):f.removeChild(d.stateNode)}else if(4===d.tag){if(null!==d.child){f=d.stateNode.containerInfo;g=!0;d.child.return=d;d=d.child;continue}}else if(Ki(a,d,c),null!==d.child){d.child.return=d;d=d.child;continue}if(d===b)break;for(;null===d.sibling;){if(null===d.return||d.return===b)return;d=d.return;4===d.tag&&(e=!1)}d.sibling.return=d.return;d=d.sibling}}\nfunction Si(a,b){switch(b.tag){case 0:case 11:case 14:case 15:case 22:Hi(3,b);return;case 1:return;case 5:var c=b.stateNode;if(null!=c){var d=b.memoizedProps,e=null!==a?a.memoizedProps:d;a=b.type;var f=b.updateQueue;b.updateQueue=null;if(null!==f){c[Nd]=d;\"input\"===a&&\"radio\"===d.type&&null!=d.name&&Bb(c,d);pd(a,e);b=pd(a,d);for(e=0;e<f.length;e+=2){var g=f[e],h=f[e+1];\"style\"===g?md(c,h):\"dangerouslySetInnerHTML\"===g?Qb(c,h):\"children\"===g?Rb(c,h):Xa(c,g,h,b)}switch(a){case \"input\":Cb(c,d);break;\ncase \"textarea\":Kb(c,d);break;case \"select\":b=c._wrapperState.wasMultiple,c._wrapperState.wasMultiple=!!d.multiple,a=d.value,null!=a?Hb(c,!!d.multiple,a,!1):b!==!!d.multiple&&(null!=d.defaultValue?Hb(c,!!d.multiple,d.defaultValue,!0):Hb(c,!!d.multiple,d.multiple?[]:\"\",!1))}}}return;case 6:if(null===b.stateNode)throw Error(u(162));b.stateNode.nodeValue=b.memoizedProps;return;case 3:b=b.stateNode;b.hydrate&&(b.hydrate=!1,Vc(b.containerInfo));return;case 12:return;case 13:c=b;null===b.memoizedState?\nd=!1:(d=!0,c=b.child,Ti=$f());if(null!==c)a:for(a=c;;){if(5===a.tag)f=a.stateNode,d?(f=f.style,\"function\"===typeof f.setProperty?f.setProperty(\"display\",\"none\",\"important\"):f.display=\"none\"):(f=a.stateNode,e=a.memoizedProps.style,e=void 0!==e&&null!==e&&e.hasOwnProperty(\"display\")?e.display:null,f.style.display=ld(\"display\",e));else if(6===a.tag)a.stateNode.nodeValue=d?\"\":a.memoizedProps;else if(13===a.tag&&null!==a.memoizedState&&null===a.memoizedState.dehydrated){f=a.child.sibling;f.return=a;a=\nf;continue}else if(null!==a.child){a.child.return=a;a=a.child;continue}if(a===c)break;for(;null===a.sibling;){if(null===a.return||a.return===c)break a;a=a.return}a.sibling.return=a.return;a=a.sibling}Ui(b);return;case 19:Ui(b);return;case 17:return}throw Error(u(163));}function Ui(a){var b=a.updateQueue;if(null!==b){a.updateQueue=null;var c=a.stateNode;null===c&&(c=a.stateNode=new Bi);b.forEach(function(b){var d=Vi.bind(null,a,b);c.has(b)||(c.add(b),b.then(d,d))})}}\nvar Wi=\"function\"===typeof WeakMap?WeakMap:Map;function Xi(a,b,c){c=wg(c,null);c.tag=3;c.payload={element:null};var d=b.value;c.callback=function(){Yi||(Yi=!0,Zi=d);Ci(a,b)};return c}\nfunction $i(a,b,c){c=wg(c,null);c.tag=3;var d=a.type.getDerivedStateFromError;if(\"function\"===typeof d){var e=b.value;c.payload=function(){Ci(a,b);return d(e)}}var f=a.stateNode;null!==f&&\"function\"===typeof f.componentDidCatch&&(c.callback=function(){\"function\"!==typeof d&&(null===aj?aj=new Set([this]):aj.add(this),Ci(a,b));var c=b.stack;this.componentDidCatch(b.value,{componentStack:null!==c?c:\"\"})});return c}\nvar bj=Math.ceil,cj=Wa.ReactCurrentDispatcher,dj=Wa.ReactCurrentOwner,V=0,ej=8,fj=16,gj=32,ti=0,hj=1,ij=2,ui=3,vi=4,jj=5,W=V,T=null,X=null,U=0,S=ti,kj=null,lj=1073741823,mj=1073741823,nj=null,wi=0,oj=!1,Ti=0,pj=500,Y=null,Yi=!1,Zi=null,aj=null,qj=!1,rj=null,sj=90,tj=null,uj=0,vj=null,wj=0;function Gg(){return(W&(fj|gj))!==V?1073741821-($f()/10|0):0!==wj?wj:wj=1073741821-($f()/10|0)}\nfunction Hg(a,b,c){b=b.mode;if(0===(b&2))return 1073741823;var d=ag();if(0===(b&4))return 99===d?1073741823:1073741822;if((W&fj)!==V)return U;if(null!==c)a=hg(a,c.timeoutMs|0||5E3,250);else switch(d){case 99:a=1073741823;break;case 98:a=hg(a,150,100);break;case 97:case 96:a=hg(a,5E3,250);break;case 95:a=2;break;default:throw Error(u(326));}null!==T&&a===U&&--a;return a}\nfunction Ig(a,b){if(50<uj)throw uj=0,vj=null,Error(u(185));a=xj(a,b);if(null!==a){var c=ag();1073741823===b?(W&ej)!==V&&(W&(fj|gj))===V?yj(a):(Z(a),W===V&&gg()):Z(a);(W&4)===V||98!==c&&99!==c||(null===tj?tj=new Map([[a,b]]):(c=tj.get(a),(void 0===c||c>b)&&tj.set(a,b)))}}\nfunction xj(a,b){a.expirationTime<b&&(a.expirationTime=b);var c=a.alternate;null!==c&&c.expirationTime<b&&(c.expirationTime=b);var d=a.return,e=null;if(null===d&&3===a.tag)e=a.stateNode;else for(;null!==d;){c=d.alternate;d.childExpirationTime<b&&(d.childExpirationTime=b);null!==c&&c.childExpirationTime<b&&(c.childExpirationTime=b);if(null===d.return&&3===d.tag){e=d.stateNode;break}d=d.return}null!==e&&(T===e&&(Bg(b),S===vi&&xi(e,U)),yi(e,b));return e}\nfunction zj(a){var b=a.lastExpiredTime;if(0!==b)return b;b=a.firstPendingTime;if(!Aj(a,b))return b;var c=a.lastPingedTime;a=a.nextKnownPendingLevel;a=c>a?c:a;return 2>=a&&b!==a?0:a}\nfunction Z(a){if(0!==a.lastExpiredTime)a.callbackExpirationTime=1073741823,a.callbackPriority=99,a.callbackNode=eg(yj.bind(null,a));else{var b=zj(a),c=a.callbackNode;if(0===b)null!==c&&(a.callbackNode=null,a.callbackExpirationTime=0,a.callbackPriority=90);else{var d=Gg();1073741823===b?d=99:1===b||2===b?d=95:(d=10*(1073741821-b)-10*(1073741821-d),d=0>=d?99:250>=d?98:5250>=d?97:95);if(null!==c){var e=a.callbackPriority;if(a.callbackExpirationTime===b&&e>=d)return;c!==Tf&&Kf(c)}a.callbackExpirationTime=\nb;a.callbackPriority=d;b=1073741823===b?eg(yj.bind(null,a)):dg(d,Bj.bind(null,a),{timeout:10*(1073741821-b)-$f()});a.callbackNode=b}}}\nfunction Bj(a,b){wj=0;if(b)return b=Gg(),Cj(a,b),Z(a),null;var c=zj(a);if(0!==c){b=a.callbackNode;if((W&(fj|gj))!==V)throw Error(u(327));Dj();a===T&&c===U||Ej(a,c);if(null!==X){var d=W;W|=fj;var e=Fj();do try{Gj();break}catch(h){Hj(a,h)}while(1);ng();W=d;cj.current=e;if(S===hj)throw b=kj,Ej(a,c),xi(a,c),Z(a),b;if(null===X)switch(e=a.finishedWork=a.current.alternate,a.finishedExpirationTime=c,d=S,T=null,d){case ti:case hj:throw Error(u(345));case ij:Cj(a,2<c?2:c);break;case ui:xi(a,c);d=a.lastSuspendedTime;\nc===d&&(a.nextKnownPendingLevel=Ij(e));if(1073741823===lj&&(e=Ti+pj-$f(),10<e)){if(oj){var f=a.lastPingedTime;if(0===f||f>=c){a.lastPingedTime=c;Ej(a,c);break}}f=zj(a);if(0!==f&&f!==c)break;if(0!==d&&d!==c){a.lastPingedTime=d;break}a.timeoutHandle=Hd(Jj.bind(null,a),e);break}Jj(a);break;case vi:xi(a,c);d=a.lastSuspendedTime;c===d&&(a.nextKnownPendingLevel=Ij(e));if(oj&&(e=a.lastPingedTime,0===e||e>=c)){a.lastPingedTime=c;Ej(a,c);break}e=zj(a);if(0!==e&&e!==c)break;if(0!==d&&d!==c){a.lastPingedTime=\nd;break}1073741823!==mj?d=10*(1073741821-mj)-$f():1073741823===lj?d=0:(d=10*(1073741821-lj)-5E3,e=$f(),c=10*(1073741821-c)-e,d=e-d,0>d&&(d=0),d=(120>d?120:480>d?480:1080>d?1080:1920>d?1920:3E3>d?3E3:4320>d?4320:1960*bj(d/1960))-d,c<d&&(d=c));if(10<d){a.timeoutHandle=Hd(Jj.bind(null,a),d);break}Jj(a);break;case jj:if(1073741823!==lj&&null!==nj){f=lj;var g=nj;d=g.busyMinDurationMs|0;0>=d?d=0:(e=g.busyDelayMs|0,f=$f()-(10*(1073741821-f)-(g.timeoutMs|0||5E3)),d=f<=e?0:e+d-f);if(10<d){xi(a,c);a.timeoutHandle=\nHd(Jj.bind(null,a),d);break}}Jj(a);break;default:throw Error(u(329));}Z(a);if(a.callbackNode===b)return Bj.bind(null,a)}}return null}\nfunction yj(a){var b=a.lastExpiredTime;b=0!==b?b:1073741823;if((W&(fj|gj))!==V)throw Error(u(327));Dj();a===T&&b===U||Ej(a,b);if(null!==X){var c=W;W|=fj;var d=Fj();do try{Kj();break}catch(e){Hj(a,e)}while(1);ng();W=c;cj.current=d;if(S===hj)throw c=kj,Ej(a,b),xi(a,b),Z(a),c;if(null!==X)throw Error(u(261));a.finishedWork=a.current.alternate;a.finishedExpirationTime=b;T=null;Jj(a);Z(a)}return null}function Lj(){if(null!==tj){var a=tj;tj=null;a.forEach(function(a,c){Cj(c,a);Z(c)});gg()}}\nfunction Mj(a,b){var c=W;W|=1;try{return a(b)}finally{W=c,W===V&&gg()}}function Nj(a,b){var c=W;W&=-2;W|=ej;try{return a(b)}finally{W=c,W===V&&gg()}}\nfunction Ej(a,b){a.finishedWork=null;a.finishedExpirationTime=0;var c=a.timeoutHandle;-1!==c&&(a.timeoutHandle=-1,Id(c));if(null!==X)for(c=X.return;null!==c;){var d=c;switch(d.tag){case 1:d=d.type.childContextTypes;null!==d&&void 0!==d&&Df();break;case 3:eh();H(K);H(J);break;case 5:gh(d);break;case 4:eh();break;case 13:H(M);break;case 19:H(M);break;case 10:og(d)}c=c.return}T=a;X=Sg(a.current,null);U=b;S=ti;kj=null;mj=lj=1073741823;nj=null;wi=0;oj=!1}\nfunction Hj(a,b){do{try{ng();jh.current=sh;if(mh)for(var c=N.memoizedState;null!==c;){var d=c.queue;null!==d&&(d.pending=null);c=c.next}lh=0;P=O=N=null;mh=!1;if(null===X||null===X.return)return S=hj,kj=b,X=null;a:{var e=a,f=X.return,g=X,h=b;b=U;g.effectTag|=2048;g.firstEffect=g.lastEffect=null;if(null!==h&&\"object\"===typeof h&&\"function\"===typeof h.then){var k=h;if(0===(g.mode&2)){var l=g.alternate;l?(g.updateQueue=l.updateQueue,g.memoizedState=l.memoizedState,g.expirationTime=l.expirationTime):(g.updateQueue=\nnull,g.memoizedState=null)}var m=0!==(M.current&1),p=f;do{var x;if(x=13===p.tag){var z=p.memoizedState;if(null!==z)x=null!==z.dehydrated?!0:!1;else{var ca=p.memoizedProps;x=void 0===ca.fallback?!1:!0!==ca.unstable_avoidThisFallback?!0:m?!1:!0}}if(x){var D=p.updateQueue;if(null===D){var t=new Set;t.add(k);p.updateQueue=t}else D.add(k);if(0===(p.mode&2)){p.effectTag|=64;g.effectTag&=-2981;if(1===g.tag)if(null===g.alternate)g.tag=17;else{var y=wg(1073741823,null);y.tag=2;xg(g,y)}g.expirationTime=1073741823;\nbreak a}h=void 0;g=b;var A=e.pingCache;null===A?(A=e.pingCache=new Wi,h=new Set,A.set(k,h)):(h=A.get(k),void 0===h&&(h=new Set,A.set(k,h)));if(!h.has(g)){h.add(g);var q=Oj.bind(null,e,k,g);k.then(q,q)}p.effectTag|=4096;p.expirationTime=b;break a}p=p.return}while(null!==p);h=Error((pb(g.type)||\"A React component\")+\" suspended while rendering, but no fallback UI was specified.\\n\\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display.\"+qb(g))}S!==\njj&&(S=ij);h=Ai(h,g);p=f;do{switch(p.tag){case 3:k=h;p.effectTag|=4096;p.expirationTime=b;var B=Xi(p,k,b);yg(p,B);break a;case 1:k=h;var w=p.type,ub=p.stateNode;if(0===(p.effectTag&64)&&(\"function\"===typeof w.getDerivedStateFromError||null!==ub&&\"function\"===typeof ub.componentDidCatch&&(null===aj||!aj.has(ub)))){p.effectTag|=4096;p.expirationTime=b;var vb=$i(p,k,b);yg(p,vb);break a}}p=p.return}while(null!==p)}X=Pj(X)}catch(Xc){b=Xc;continue}break}while(1)}\nfunction Fj(){var a=cj.current;cj.current=sh;return null===a?sh:a}function Ag(a,b){a<lj&&2<a&&(lj=a);null!==b&&a<mj&&2<a&&(mj=a,nj=b)}function Bg(a){a>wi&&(wi=a)}function Kj(){for(;null!==X;)X=Qj(X)}function Gj(){for(;null!==X&&!Uf();)X=Qj(X)}function Qj(a){var b=Rj(a.alternate,a,U);a.memoizedProps=a.pendingProps;null===b&&(b=Pj(a));dj.current=null;return b}\nfunction Pj(a){X=a;do{var b=X.alternate;a=X.return;if(0===(X.effectTag&2048)){b=si(b,X,U);if(1===U||1!==X.childExpirationTime){for(var c=0,d=X.child;null!==d;){var e=d.expirationTime,f=d.childExpirationTime;e>c&&(c=e);f>c&&(c=f);d=d.sibling}X.childExpirationTime=c}if(null!==b)return b;null!==a&&0===(a.effectTag&2048)&&(null===a.firstEffect&&(a.firstEffect=X.firstEffect),null!==X.lastEffect&&(null!==a.lastEffect&&(a.lastEffect.nextEffect=X.firstEffect),a.lastEffect=X.lastEffect),1<X.effectTag&&(null!==\na.lastEffect?a.lastEffect.nextEffect=X:a.firstEffect=X,a.lastEffect=X))}else{b=zi(X);if(null!==b)return b.effectTag&=2047,b;null!==a&&(a.firstEffect=a.lastEffect=null,a.effectTag|=2048)}b=X.sibling;if(null!==b)return b;X=a}while(null!==X);S===ti&&(S=jj);return null}function Ij(a){var b=a.expirationTime;a=a.childExpirationTime;return b>a?b:a}function Jj(a){var b=ag();cg(99,Sj.bind(null,a,b));return null}\nfunction Sj(a,b){do Dj();while(null!==rj);if((W&(fj|gj))!==V)throw Error(u(327));var c=a.finishedWork,d=a.finishedExpirationTime;if(null===c)return null;a.finishedWork=null;a.finishedExpirationTime=0;if(c===a.current)throw Error(u(177));a.callbackNode=null;a.callbackExpirationTime=0;a.callbackPriority=90;a.nextKnownPendingLevel=0;var e=Ij(c);a.firstPendingTime=e;d<=a.lastSuspendedTime?a.firstSuspendedTime=a.lastSuspendedTime=a.nextKnownPendingLevel=0:d<=a.firstSuspendedTime&&(a.firstSuspendedTime=\nd-1);d<=a.lastPingedTime&&(a.lastPingedTime=0);d<=a.lastExpiredTime&&(a.lastExpiredTime=0);a===T&&(X=T=null,U=0);1<c.effectTag?null!==c.lastEffect?(c.lastEffect.nextEffect=c,e=c.firstEffect):e=c:e=c.firstEffect;if(null!==e){var f=W;W|=gj;dj.current=null;Dd=fd;var g=xd();if(yd(g)){if(\"selectionStart\"in g)var h={start:g.selectionStart,end:g.selectionEnd};else a:{h=(h=g.ownerDocument)&&h.defaultView||window;var k=h.getSelection&&h.getSelection();if(k&&0!==k.rangeCount){h=k.anchorNode;var l=k.anchorOffset,\nm=k.focusNode;k=k.focusOffset;try{h.nodeType,m.nodeType}catch(wb){h=null;break a}var p=0,x=-1,z=-1,ca=0,D=0,t=g,y=null;b:for(;;){for(var A;;){t!==h||0!==l&&3!==t.nodeType||(x=p+l);t!==m||0!==k&&3!==t.nodeType||(z=p+k);3===t.nodeType&&(p+=t.nodeValue.length);if(null===(A=t.firstChild))break;y=t;t=A}for(;;){if(t===g)break b;y===h&&++ca===l&&(x=p);y===m&&++D===k&&(z=p);if(null!==(A=t.nextSibling))break;t=y;y=t.parentNode}t=A}h=-1===x||-1===z?null:{start:x,end:z}}else h=null}h=h||{start:0,end:0}}else h=\nnull;Ed={activeElementDetached:null,focusedElem:g,selectionRange:h};fd=!1;Y=e;do try{Tj()}catch(wb){if(null===Y)throw Error(u(330));Ei(Y,wb);Y=Y.nextEffect}while(null!==Y);Y=e;do try{for(g=a,h=b;null!==Y;){var q=Y.effectTag;q&16&&Rb(Y.stateNode,\"\");if(q&128){var B=Y.alternate;if(null!==B){var w=B.ref;null!==w&&(\"function\"===typeof w?w(null):w.current=null)}}switch(q&1038){case 2:Pi(Y);Y.effectTag&=-3;break;case 6:Pi(Y);Y.effectTag&=-3;Si(Y.alternate,Y);break;case 1024:Y.effectTag&=-1025;break;case 1028:Y.effectTag&=\n-1025;Si(Y.alternate,Y);break;case 4:Si(Y.alternate,Y);break;case 8:l=Y,Mi(g,l,h),Ni(l)}Y=Y.nextEffect}}catch(wb){if(null===Y)throw Error(u(330));Ei(Y,wb);Y=Y.nextEffect}while(null!==Y);w=Ed;B=xd();q=w.focusedElem;h=w.selectionRange;if(B!==q&&q&&q.ownerDocument&&wd(q.ownerDocument.documentElement,q)){null!==h&&yd(q)&&(B=h.start,w=h.end,void 0===w&&(w=B),\"selectionStart\"in q?(q.selectionStart=B,q.selectionEnd=Math.min(w,q.value.length)):(w=(B=q.ownerDocument||document)&&B.defaultView||window,w.getSelection&&\n(w=w.getSelection(),l=q.textContent.length,g=Math.min(h.start,l),h=void 0===h.end?g:Math.min(h.end,l),!w.extend&&g>h&&(l=h,h=g,g=l),l=vd(q,g),m=vd(q,h),l&&m&&(1!==w.rangeCount||w.anchorNode!==l.node||w.anchorOffset!==l.offset||w.focusNode!==m.node||w.focusOffset!==m.offset)&&(B=B.createRange(),B.setStart(l.node,l.offset),w.removeAllRanges(),g>h?(w.addRange(B),w.extend(m.node,m.offset)):(B.setEnd(m.node,m.offset),w.addRange(B))))));B=[];for(w=q;w=w.parentNode;)1===w.nodeType&&B.push({element:w,left:w.scrollLeft,\ntop:w.scrollTop});\"function\"===typeof q.focus&&q.focus();for(q=0;q<B.length;q++)w=B[q],w.element.scrollLeft=w.left,w.element.scrollTop=w.top}fd=!!Dd;Ed=Dd=null;a.current=c;Y=e;do try{for(q=a;null!==Y;){var ub=Y.effectTag;ub&36&&Ji(q,Y.alternate,Y);if(ub&128){B=void 0;var vb=Y.ref;if(null!==vb){var Xc=Y.stateNode;switch(Y.tag){case 5:B=Xc;break;default:B=Xc}\"function\"===typeof vb?vb(B):vb.current=B}}Y=Y.nextEffect}}catch(wb){if(null===Y)throw Error(u(330));Ei(Y,wb);Y=Y.nextEffect}while(null!==Y);Y=\nnull;Vf();W=f}else a.current=c;if(qj)qj=!1,rj=a,sj=b;else for(Y=e;null!==Y;)b=Y.nextEffect,Y.nextEffect=null,Y=b;b=a.firstPendingTime;0===b&&(aj=null);1073741823===b?a===vj?uj++:(uj=0,vj=a):uj=0;\"function\"===typeof Uj&&Uj(c.stateNode,d);Z(a);if(Yi)throw Yi=!1,a=Zi,Zi=null,a;if((W&ej)!==V)return null;gg();return null}function Tj(){for(;null!==Y;){var a=Y.effectTag;0!==(a&256)&&Gi(Y.alternate,Y);0===(a&512)||qj||(qj=!0,dg(97,function(){Dj();return null}));Y=Y.nextEffect}}\nfunction Dj(){if(90!==sj){var a=97<sj?97:sj;sj=90;return cg(a,Vj)}}function Vj(){if(null===rj)return!1;var a=rj;rj=null;if((W&(fj|gj))!==V)throw Error(u(331));var b=W;W|=gj;for(a=a.current.firstEffect;null!==a;){try{var c=a;if(0!==(c.effectTag&512))switch(c.tag){case 0:case 11:case 15:case 22:Hi(5,c),Ii(5,c)}}catch(d){if(null===a)throw Error(u(330));Ei(a,d)}c=a.nextEffect;a.nextEffect=null;a=c}W=b;gg();return!0}\nfunction Wj(a,b,c){b=Ai(c,b);b=Xi(a,b,1073741823);xg(a,b);a=xj(a,1073741823);null!==a&&Z(a)}function Ei(a,b){if(3===a.tag)Wj(a,a,b);else for(var c=a.return;null!==c;){if(3===c.tag){Wj(c,a,b);break}else if(1===c.tag){var d=c.stateNode;if(\"function\"===typeof c.type.getDerivedStateFromError||\"function\"===typeof d.componentDidCatch&&(null===aj||!aj.has(d))){a=Ai(b,a);a=$i(c,a,1073741823);xg(c,a);c=xj(c,1073741823);null!==c&&Z(c);break}}c=c.return}}\nfunction Oj(a,b,c){var d=a.pingCache;null!==d&&d.delete(b);T===a&&U===c?S===vi||S===ui&&1073741823===lj&&$f()-Ti<pj?Ej(a,U):oj=!0:Aj(a,c)&&(b=a.lastPingedTime,0!==b&&b<c||(a.lastPingedTime=c,Z(a)))}function Vi(a,b){var c=a.stateNode;null!==c&&c.delete(b);b=0;0===b&&(b=Gg(),b=Hg(b,a,null));a=xj(a,b);null!==a&&Z(a)}var Rj;\nRj=function(a,b,c){var d=b.expirationTime;if(null!==a){var e=b.pendingProps;if(a.memoizedProps!==e||K.current)rg=!0;else{if(d<c){rg=!1;switch(b.tag){case 3:hi(b);Xh();break;case 5:fh(b);if(b.mode&4&&1!==c&&e.hidden)return b.expirationTime=b.childExpirationTime=1,null;break;case 1:L(b.type)&&Gf(b);break;case 4:dh(b,b.stateNode.containerInfo);break;case 10:d=b.memoizedProps.value;e=b.type._context;I(jg,e._currentValue);e._currentValue=d;break;case 13:if(null!==b.memoizedState){d=b.child.childExpirationTime;\nif(0!==d&&d>=c)return ji(a,b,c);I(M,M.current&1);b=$h(a,b,c);return null!==b?b.sibling:null}I(M,M.current&1);break;case 19:d=b.childExpirationTime>=c;if(0!==(a.effectTag&64)){if(d)return mi(a,b,c);b.effectTag|=64}e=b.memoizedState;null!==e&&(e.rendering=null,e.tail=null);I(M,M.current);if(!d)return null}return $h(a,b,c)}rg=!1}}else rg=!1;b.expirationTime=0;switch(b.tag){case 2:d=b.type;null!==a&&(a.alternate=null,b.alternate=null,b.effectTag|=2);a=b.pendingProps;e=Cf(b,J.current);qg(b,c);e=oh(null,\nb,d,a,e,c);b.effectTag|=1;if(\"object\"===typeof e&&null!==e&&\"function\"===typeof e.render&&void 0===e.$$typeof){b.tag=1;b.memoizedState=null;b.updateQueue=null;if(L(d)){var f=!0;Gf(b)}else f=!1;b.memoizedState=null!==e.state&&void 0!==e.state?e.state:null;ug(b);var g=d.getDerivedStateFromProps;\"function\"===typeof g&&Fg(b,d,g,a);e.updater=Jg;b.stateNode=e;e._reactInternalFiber=b;Ng(b,d,a,c);b=gi(null,b,d,!0,f,c)}else b.tag=0,R(null,b,e,c),b=b.child;return b;case 16:a:{e=b.elementType;null!==a&&(a.alternate=\nnull,b.alternate=null,b.effectTag|=2);a=b.pendingProps;ob(e);if(1!==e._status)throw e._result;e=e._result;b.type=e;f=b.tag=Xj(e);a=ig(e,a);switch(f){case 0:b=di(null,b,e,a,c);break a;case 1:b=fi(null,b,e,a,c);break a;case 11:b=Zh(null,b,e,a,c);break a;case 14:b=ai(null,b,e,ig(e.type,a),d,c);break a}throw Error(u(306,e,\"\"));}return b;case 0:return d=b.type,e=b.pendingProps,e=b.elementType===d?e:ig(d,e),di(a,b,d,e,c);case 1:return d=b.type,e=b.pendingProps,e=b.elementType===d?e:ig(d,e),fi(a,b,d,e,c);\ncase 3:hi(b);d=b.updateQueue;if(null===a||null===d)throw Error(u(282));d=b.pendingProps;e=b.memoizedState;e=null!==e?e.element:null;vg(a,b);zg(b,d,null,c);d=b.memoizedState.element;if(d===e)Xh(),b=$h(a,b,c);else{if(e=b.stateNode.hydrate)Ph=Jd(b.stateNode.containerInfo.firstChild),Oh=b,e=Qh=!0;if(e)for(c=Yg(b,null,d,c),b.child=c;c;)c.effectTag=c.effectTag&-3|1024,c=c.sibling;else R(a,b,d,c),Xh();b=b.child}return b;case 5:return fh(b),null===a&&Uh(b),d=b.type,e=b.pendingProps,f=null!==a?a.memoizedProps:\nnull,g=e.children,Gd(d,e)?g=null:null!==f&&Gd(d,f)&&(b.effectTag|=16),ei(a,b),b.mode&4&&1!==c&&e.hidden?(b.expirationTime=b.childExpirationTime=1,b=null):(R(a,b,g,c),b=b.child),b;case 6:return null===a&&Uh(b),null;case 13:return ji(a,b,c);case 4:return dh(b,b.stateNode.containerInfo),d=b.pendingProps,null===a?b.child=Xg(b,null,d,c):R(a,b,d,c),b.child;case 11:return d=b.type,e=b.pendingProps,e=b.elementType===d?e:ig(d,e),Zh(a,b,d,e,c);case 7:return R(a,b,b.pendingProps,c),b.child;case 8:return R(a,\nb,b.pendingProps.children,c),b.child;case 12:return R(a,b,b.pendingProps.children,c),b.child;case 10:a:{d=b.type._context;e=b.pendingProps;g=b.memoizedProps;f=e.value;var h=b.type._context;I(jg,h._currentValue);h._currentValue=f;if(null!==g)if(h=g.value,f=$e(h,f)?0:(\"function\"===typeof d._calculateChangedBits?d._calculateChangedBits(h,f):1073741823)|0,0===f){if(g.children===e.children&&!K.current){b=$h(a,b,c);break a}}else for(h=b.child,null!==h&&(h.return=b);null!==h;){var k=h.dependencies;if(null!==\nk){g=h.child;for(var l=k.firstContext;null!==l;){if(l.context===d&&0!==(l.observedBits&f)){1===h.tag&&(l=wg(c,null),l.tag=2,xg(h,l));h.expirationTime<c&&(h.expirationTime=c);l=h.alternate;null!==l&&l.expirationTime<c&&(l.expirationTime=c);pg(h.return,c);k.expirationTime<c&&(k.expirationTime=c);break}l=l.next}}else g=10===h.tag?h.type===b.type?null:h.child:h.child;if(null!==g)g.return=h;else for(g=h;null!==g;){if(g===b){g=null;break}h=g.sibling;if(null!==h){h.return=g.return;g=h;break}g=g.return}h=\ng}R(a,b,e.children,c);b=b.child}return b;case 9:return e=b.type,f=b.pendingProps,d=f.children,qg(b,c),e=sg(e,f.unstable_observedBits),d=d(e),b.effectTag|=1,R(a,b,d,c),b.child;case 14:return e=b.type,f=ig(e,b.pendingProps),f=ig(e.type,f),ai(a,b,e,f,d,c);case 15:return ci(a,b,b.type,b.pendingProps,d,c);case 17:return d=b.type,e=b.pendingProps,e=b.elementType===d?e:ig(d,e),null!==a&&(a.alternate=null,b.alternate=null,b.effectTag|=2),b.tag=1,L(d)?(a=!0,Gf(b)):a=!1,qg(b,c),Lg(b,d,e),Ng(b,d,e,c),gi(null,\nb,d,!0,a,c);case 19:return mi(a,b,c)}throw Error(u(156,b.tag));};var Uj=null,Li=null;function Yj(a){if(\"undefined\"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__)return!1;var b=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(b.isDisabled||!b.supportsFiber)return!0;try{var c=b.inject(a);Uj=function(a){try{b.onCommitFiberRoot(c,a,void 0,64===(a.current.effectTag&64))}catch(e){}};Li=function(a){try{b.onCommitFiberUnmount(c,a)}catch(e){}}}catch(d){}return!0}\nfunction Zj(a,b,c,d){this.tag=a;this.key=c;this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null;this.index=0;this.ref=null;this.pendingProps=b;this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null;this.mode=d;this.effectTag=0;this.lastEffect=this.firstEffect=this.nextEffect=null;this.childExpirationTime=this.expirationTime=0;this.alternate=null}function Sh(a,b,c,d){return new Zj(a,b,c,d)}\nfunction bi(a){a=a.prototype;return!(!a||!a.isReactComponent)}function Xj(a){if(\"function\"===typeof a)return bi(a)?1:0;if(void 0!==a&&null!==a){a=a.$$typeof;if(a===gb)return 11;if(a===jb)return 14}return 2}\nfunction Sg(a,b){var c=a.alternate;null===c?(c=Sh(a.tag,b,a.key,a.mode),c.elementType=a.elementType,c.type=a.type,c.stateNode=a.stateNode,c.alternate=a,a.alternate=c):(c.pendingProps=b,c.effectTag=0,c.nextEffect=null,c.firstEffect=null,c.lastEffect=null);c.childExpirationTime=a.childExpirationTime;c.expirationTime=a.expirationTime;c.child=a.child;c.memoizedProps=a.memoizedProps;c.memoizedState=a.memoizedState;c.updateQueue=a.updateQueue;b=a.dependencies;c.dependencies=null===b?null:{expirationTime:b.expirationTime,\nfirstContext:b.firstContext,responders:b.responders};c.sibling=a.sibling;c.index=a.index;c.ref=a.ref;return c}\nfunction Ug(a,b,c,d,e,f){var g=2;d=a;if(\"function\"===typeof a)bi(a)&&(g=1);else if(\"string\"===typeof a)g=5;else a:switch(a){case ab:return Wg(c.children,e,f,b);case fb:g=8;e|=7;break;case bb:g=8;e|=1;break;case cb:return a=Sh(12,c,b,e|8),a.elementType=cb,a.type=cb,a.expirationTime=f,a;case hb:return a=Sh(13,c,b,e),a.type=hb,a.elementType=hb,a.expirationTime=f,a;case ib:return a=Sh(19,c,b,e),a.elementType=ib,a.expirationTime=f,a;default:if(\"object\"===typeof a&&null!==a)switch(a.$$typeof){case db:g=\n10;break a;case eb:g=9;break a;case gb:g=11;break a;case jb:g=14;break a;case kb:g=16;d=null;break a;case lb:g=22;break a}throw Error(u(130,null==a?a:typeof a,\"\"));}b=Sh(g,c,b,e);b.elementType=a;b.type=d;b.expirationTime=f;return b}function Wg(a,b,c,d){a=Sh(7,a,d,b);a.expirationTime=c;return a}function Tg(a,b,c){a=Sh(6,a,null,b);a.expirationTime=c;return a}\nfunction Vg(a,b,c){b=Sh(4,null!==a.children?a.children:[],a.key,b);b.expirationTime=c;b.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation};return b}\nfunction ak(a,b,c){this.tag=b;this.current=null;this.containerInfo=a;this.pingCache=this.pendingChildren=null;this.finishedExpirationTime=0;this.finishedWork=null;this.timeoutHandle=-1;this.pendingContext=this.context=null;this.hydrate=c;this.callbackNode=null;this.callbackPriority=90;this.lastExpiredTime=this.lastPingedTime=this.nextKnownPendingLevel=this.lastSuspendedTime=this.firstSuspendedTime=this.firstPendingTime=0}\nfunction Aj(a,b){var c=a.firstSuspendedTime;a=a.lastSuspendedTime;return 0!==c&&c>=b&&a<=b}function xi(a,b){var c=a.firstSuspendedTime,d=a.lastSuspendedTime;c<b&&(a.firstSuspendedTime=b);if(d>b||0===c)a.lastSuspendedTime=b;b<=a.lastPingedTime&&(a.lastPingedTime=0);b<=a.lastExpiredTime&&(a.lastExpiredTime=0)}\nfunction yi(a,b){b>a.firstPendingTime&&(a.firstPendingTime=b);var c=a.firstSuspendedTime;0!==c&&(b>=c?a.firstSuspendedTime=a.lastSuspendedTime=a.nextKnownPendingLevel=0:b>=a.lastSuspendedTime&&(a.lastSuspendedTime=b+1),b>a.nextKnownPendingLevel&&(a.nextKnownPendingLevel=b))}function Cj(a,b){var c=a.lastExpiredTime;if(0===c||c>b)a.lastExpiredTime=b}\nfunction bk(a,b,c,d){var e=b.current,f=Gg(),g=Dg.suspense;f=Hg(f,e,g);a:if(c){c=c._reactInternalFiber;b:{if(dc(c)!==c||1!==c.tag)throw Error(u(170));var h=c;do{switch(h.tag){case 3:h=h.stateNode.context;break b;case 1:if(L(h.type)){h=h.stateNode.__reactInternalMemoizedMergedChildContext;break b}}h=h.return}while(null!==h);throw Error(u(171));}if(1===c.tag){var k=c.type;if(L(k)){c=Ff(c,k,h);break a}}c=h}else c=Af;null===b.context?b.context=c:b.pendingContext=c;b=wg(f,g);b.payload={element:a};d=void 0===\nd?null:d;null!==d&&(b.callback=d);xg(e,b);Ig(e,f);return f}function ck(a){a=a.current;if(!a.child)return null;switch(a.child.tag){case 5:return a.child.stateNode;default:return a.child.stateNode}}function dk(a,b){a=a.memoizedState;null!==a&&null!==a.dehydrated&&a.retryTime<b&&(a.retryTime=b)}function ek(a,b){dk(a,b);(a=a.alternate)&&dk(a,b)}\nfunction fk(a,b,c){c=null!=c&&!0===c.hydrate;var d=new ak(a,b,c),e=Sh(3,null,null,2===b?7:1===b?3:0);d.current=e;e.stateNode=d;ug(e);a[Od]=d.current;c&&0!==b&&Jc(a,9===a.nodeType?a:a.ownerDocument);this._internalRoot=d}fk.prototype.render=function(a){bk(a,this._internalRoot,null,null)};fk.prototype.unmount=function(){var a=this._internalRoot,b=a.containerInfo;bk(null,a,null,function(){b[Od]=null})};\nfunction gk(a){return!(!a||1!==a.nodeType&&9!==a.nodeType&&11!==a.nodeType&&(8!==a.nodeType||\" react-mount-point-unstable \"!==a.nodeValue))}function hk(a,b){b||(b=a?9===a.nodeType?a.documentElement:a.firstChild:null,b=!(!b||1!==b.nodeType||!b.hasAttribute(\"data-reactroot\")));if(!b)for(var c;c=a.lastChild;)a.removeChild(c);return new fk(a,0,b?{hydrate:!0}:void 0)}\nfunction ik(a,b,c,d,e){var f=c._reactRootContainer;if(f){var g=f._internalRoot;if(\"function\"===typeof e){var h=e;e=function(){var a=ck(g);h.call(a)}}bk(b,g,a,e)}else{f=c._reactRootContainer=hk(c,d);g=f._internalRoot;if(\"function\"===typeof e){var k=e;e=function(){var a=ck(g);k.call(a)}}Nj(function(){bk(b,g,a,e)})}return ck(g)}function jk(a,b,c){var d=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:$a,key:null==d?null:\"\"+d,children:a,containerInfo:b,implementation:c}}\nwc=function(a){if(13===a.tag){var b=hg(Gg(),150,100);Ig(a,b);ek(a,b)}};xc=function(a){13===a.tag&&(Ig(a,3),ek(a,3))};yc=function(a){if(13===a.tag){var b=Gg();b=Hg(b,a,null);Ig(a,b);ek(a,b)}};\nza=function(a,b,c){switch(b){case \"input\":Cb(a,c);b=c.name;if(\"radio\"===c.type&&null!=b){for(c=a;c.parentNode;)c=c.parentNode;c=c.querySelectorAll(\"input[name=\"+JSON.stringify(\"\"+b)+'][type=\"radio\"]');for(b=0;b<c.length;b++){var d=c[b];if(d!==a&&d.form===a.form){var e=Qd(d);if(!e)throw Error(u(90));yb(d);Cb(d,e)}}}break;case \"textarea\":Kb(a,c);break;case \"select\":b=c.value,null!=b&&Hb(a,!!c.multiple,b,!1)}};Fa=Mj;\nGa=function(a,b,c,d,e){var f=W;W|=4;try{return cg(98,a.bind(null,b,c,d,e))}finally{W=f,W===V&&gg()}};Ha=function(){(W&(1|fj|gj))===V&&(Lj(),Dj())};Ia=function(a,b){var c=W;W|=2;try{return a(b)}finally{W=c,W===V&&gg()}};function kk(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!gk(b))throw Error(u(200));return jk(a,b,null,c)}var lk={Events:[Nc,Pd,Qd,xa,ta,Xd,function(a){jc(a,Wd)},Da,Ea,id,mc,Dj,{current:!1}]};\n(function(a){var b=a.findFiberByHostInstance;return Yj(n({},a,{overrideHookState:null,overrideProps:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Wa.ReactCurrentDispatcher,findHostInstanceByFiber:function(a){a=hc(a);return null===a?null:a.stateNode},findFiberByHostInstance:function(a){return b?b(a):null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null}))})({findFiberByHostInstance:tc,bundleType:0,version:\"16.14.0\",\nrendererPackageName:\"react-dom\"});exports.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=lk;exports.createPortal=kk;exports.findDOMNode=function(a){if(null==a)return null;if(1===a.nodeType)return a;var b=a._reactInternalFiber;if(void 0===b){if(\"function\"===typeof a.render)throw Error(u(188));throw Error(u(268,Object.keys(a)));}a=hc(b);a=null===a?null:a.stateNode;return a};\nexports.flushSync=function(a,b){if((W&(fj|gj))!==V)throw Error(u(187));var c=W;W|=1;try{return cg(99,a.bind(null,b))}finally{W=c,gg()}};exports.hydrate=function(a,b,c){if(!gk(b))throw Error(u(200));return ik(null,a,b,!0,c)};exports.render=function(a,b,c){if(!gk(b))throw Error(u(200));return ik(null,a,b,!1,c)};\nexports.unmountComponentAtNode=function(a){if(!gk(a))throw Error(u(40));return a._reactRootContainer?(Nj(function(){ik(null,null,a,!1,function(){a._reactRootContainer=null;a[Od]=null})}),!0):!1};exports.unstable_batchedUpdates=Mj;exports.unstable_createPortal=function(a,b){return kk(a,b,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null)};\nexports.unstable_renderSubtreeIntoContainer=function(a,b,c,d){if(!gk(c))throw Error(u(200));if(null==a||void 0===a._reactInternalFiber)throw Error(u(38));return ik(a,b,c,!1,d)};exports.version=\"16.14.0\";\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/react-dom/cjs/react-dom.production.min.js\n// module id = 22\n// module chunks = 0","'use strict';\n\nfunction checkDCE() {\n  /* global __REACT_DEVTOOLS_GLOBAL_HOOK__ */\n  if (\n    typeof __REACT_DEVTOOLS_GLOBAL_HOOK__ === 'undefined' ||\n    typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE !== 'function'\n  ) {\n    return;\n  }\n  if (process.env.NODE_ENV !== 'production') {\n    // This branch is unreachable because this function is only called\n    // in production, but the condition is true only in development.\n    // Therefore if the branch is still here, dead code elimination wasn't\n    // properly applied.\n    // Don't change the message. React DevTools relies on it. Also make sure\n    // this message doesn't occur elsewhere in this function, or it will cause\n    // a false positive.\n    throw new Error('^_^');\n  }\n  try {\n    // Verify that the code above has been dead code eliminated (DCE'd).\n    __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(checkDCE);\n  } catch (err) {\n    // DevTools shouldn't crash React, no matter what.\n    // We should still report in case we break this code.\n    console.error(err);\n  }\n}\n\nif (process.env.NODE_ENV === 'production') {\n  // DCE check should happen before ReactDOM bundle executes so that\n  // DevTools can report bad minification during injection.\n  checkDCE();\n  module.exports = require('./cjs/react-dom.production.min.js');\n} else {\n  module.exports = require('./cjs/react-dom.development.js');\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/react-dom/index.js\n// module id = 23\n// module chunks = 0","// @remove-on-eject-begin\n/**\n * Copyright (c) 2015-present, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * LICENSE file in the root directory of this source tree. An additional grant\n * of patent rights can be found in the PATENTS file in the same directory.\n */\n// @remove-on-eject-end\n'use strict';\n\nif (typeof Promise === 'undefined') {\n  // Rejection tracking prevents a common issue where React gets into an\n  // inconsistent state due to an error, but it gets swallowed by a Promise,\n  // and the user has no idea what causes React's erratic future behavior.\n  require('promise/lib/rejection-tracking').enable();\n  window.Promise = require('promise/lib/es6-extensions.js');\n}\n\n// fetch() polyfill for making API calls.\nrequire('whatwg-fetch');\n\n// Object.assign() is commonly used with React.\n// It will use the native implementation if it's present and isn't buggy.\nObject.assign = require('object-assign');\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/react-scripts/config/polyfills.js\n// module id = 24\n// module chunks = 0","(function(self) {\n  'use strict';\n\n  if (self.fetch) {\n    return\n  }\n\n  var support = {\n    searchParams: 'URLSearchParams' in self,\n    iterable: 'Symbol' in self && 'iterator' in Symbol,\n    blob: 'FileReader' in self && 'Blob' in self && (function() {\n      try {\n        new Blob()\n        return true\n      } catch(e) {\n        return false\n      }\n    })(),\n    formData: 'FormData' in self,\n    arrayBuffer: 'ArrayBuffer' in self\n  }\n\n  if (support.arrayBuffer) {\n    var viewClasses = [\n      '[object Int8Array]',\n      '[object Uint8Array]',\n      '[object Uint8ClampedArray]',\n      '[object Int16Array]',\n      '[object Uint16Array]',\n      '[object Int32Array]',\n      '[object Uint32Array]',\n      '[object Float32Array]',\n      '[object Float64Array]'\n    ]\n\n    var isDataView = function(obj) {\n      return obj && DataView.prototype.isPrototypeOf(obj)\n    }\n\n    var isArrayBufferView = ArrayBuffer.isView || function(obj) {\n      return obj && viewClasses.indexOf(Object.prototype.toString.call(obj)) > -1\n    }\n  }\n\n  function normalizeName(name) {\n    if (typeof name !== 'string') {\n      name = String(name)\n    }\n    if (/[^a-z0-9\\-#$%&'*+.\\^_`|~]/i.test(name)) {\n      throw new TypeError('Invalid character in header field name')\n    }\n    return name.toLowerCase()\n  }\n\n  function normalizeValue(value) {\n    if (typeof value !== 'string') {\n      value = String(value)\n    }\n    return value\n  }\n\n  // Build a destructive iterator for the value list\n  function iteratorFor(items) {\n    var iterator = {\n      next: function() {\n        var value = items.shift()\n        return {done: value === undefined, value: value}\n      }\n    }\n\n    if (support.iterable) {\n      iterator[Symbol.iterator] = function() {\n        return iterator\n      }\n    }\n\n    return iterator\n  }\n\n  function Headers(headers) {\n    this.map = {}\n\n    if (headers instanceof Headers) {\n      headers.forEach(function(value, name) {\n        this.append(name, value)\n      }, this)\n\n    } else if (headers) {\n      Object.getOwnPropertyNames(headers).forEach(function(name) {\n        this.append(name, headers[name])\n      }, this)\n    }\n  }\n\n  Headers.prototype.append = function(name, value) {\n    name = normalizeName(name)\n    value = normalizeValue(value)\n    var oldValue = this.map[name]\n    this.map[name] = oldValue ? oldValue+','+value : value\n  }\n\n  Headers.prototype['delete'] = function(name) {\n    delete this.map[normalizeName(name)]\n  }\n\n  Headers.prototype.get = function(name) {\n    name = normalizeName(name)\n    return this.has(name) ? this.map[name] : null\n  }\n\n  Headers.prototype.has = function(name) {\n    return this.map.hasOwnProperty(normalizeName(name))\n  }\n\n  Headers.prototype.set = function(name, value) {\n    this.map[normalizeName(name)] = normalizeValue(value)\n  }\n\n  Headers.prototype.forEach = function(callback, thisArg) {\n    for (var name in this.map) {\n      if (this.map.hasOwnProperty(name)) {\n        callback.call(thisArg, this.map[name], name, this)\n      }\n    }\n  }\n\n  Headers.prototype.keys = function() {\n    var items = []\n    this.forEach(function(value, name) { items.push(name) })\n    return iteratorFor(items)\n  }\n\n  Headers.prototype.values = function() {\n    var items = []\n    this.forEach(function(value) { items.push(value) })\n    return iteratorFor(items)\n  }\n\n  Headers.prototype.entries = function() {\n    var items = []\n    this.forEach(function(value, name) { items.push([name, value]) })\n    return iteratorFor(items)\n  }\n\n  if (support.iterable) {\n    Headers.prototype[Symbol.iterator] = Headers.prototype.entries\n  }\n\n  function consumed(body) {\n    if (body.bodyUsed) {\n      return Promise.reject(new TypeError('Already read'))\n    }\n    body.bodyUsed = true\n  }\n\n  function fileReaderReady(reader) {\n    return new Promise(function(resolve, reject) {\n      reader.onload = function() {\n        resolve(reader.result)\n      }\n      reader.onerror = function() {\n        reject(reader.error)\n      }\n    })\n  }\n\n  function readBlobAsArrayBuffer(blob) {\n    var reader = new FileReader()\n    var promise = fileReaderReady(reader)\n    reader.readAsArrayBuffer(blob)\n    return promise\n  }\n\n  function readBlobAsText(blob) {\n    var reader = new FileReader()\n    var promise = fileReaderReady(reader)\n    reader.readAsText(blob)\n    return promise\n  }\n\n  function readArrayBufferAsText(buf) {\n    var view = new Uint8Array(buf)\n    var chars = new Array(view.length)\n\n    for (var i = 0; i < view.length; i++) {\n      chars[i] = String.fromCharCode(view[i])\n    }\n    return chars.join('')\n  }\n\n  function bufferClone(buf) {\n    if (buf.slice) {\n      return buf.slice(0)\n    } else {\n      var view = new Uint8Array(buf.byteLength)\n      view.set(new Uint8Array(buf))\n      return view.buffer\n    }\n  }\n\n  function Body() {\n    this.bodyUsed = false\n\n    this._initBody = function(body) {\n      this._bodyInit = body\n      if (!body) {\n        this._bodyText = ''\n      } else if (typeof body === 'string') {\n        this._bodyText = body\n      } else if (support.blob && Blob.prototype.isPrototypeOf(body)) {\n        this._bodyBlob = body\n      } else if (support.formData && FormData.prototype.isPrototypeOf(body)) {\n        this._bodyFormData = body\n      } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {\n        this._bodyText = body.toString()\n      } else if (support.arrayBuffer && support.blob && isDataView(body)) {\n        this._bodyArrayBuffer = bufferClone(body.buffer)\n        // IE 10-11 can't handle a DataView body.\n        this._bodyInit = new Blob([this._bodyArrayBuffer])\n      } else if (support.arrayBuffer && (ArrayBuffer.prototype.isPrototypeOf(body) || isArrayBufferView(body))) {\n        this._bodyArrayBuffer = bufferClone(body)\n      } else {\n        throw new Error('unsupported BodyInit type')\n      }\n\n      if (!this.headers.get('content-type')) {\n        if (typeof body === 'string') {\n          this.headers.set('content-type', 'text/plain;charset=UTF-8')\n        } else if (this._bodyBlob && this._bodyBlob.type) {\n          this.headers.set('content-type', this._bodyBlob.type)\n        } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {\n          this.headers.set('content-type', 'application/x-www-form-urlencoded;charset=UTF-8')\n        }\n      }\n    }\n\n    if (support.blob) {\n      this.blob = function() {\n        var rejected = consumed(this)\n        if (rejected) {\n          return rejected\n        }\n\n        if (this._bodyBlob) {\n          return Promise.resolve(this._bodyBlob)\n        } else if (this._bodyArrayBuffer) {\n          return Promise.resolve(new Blob([this._bodyArrayBuffer]))\n        } else if (this._bodyFormData) {\n          throw new Error('could not read FormData body as blob')\n        } else {\n          return Promise.resolve(new Blob([this._bodyText]))\n        }\n      }\n\n      this.arrayBuffer = function() {\n        if (this._bodyArrayBuffer) {\n          return consumed(this) || Promise.resolve(this._bodyArrayBuffer)\n        } else {\n          return this.blob().then(readBlobAsArrayBuffer)\n        }\n      }\n    }\n\n    this.text = function() {\n      var rejected = consumed(this)\n      if (rejected) {\n        return rejected\n      }\n\n      if (this._bodyBlob) {\n        return readBlobAsText(this._bodyBlob)\n      } else if (this._bodyArrayBuffer) {\n        return Promise.resolve(readArrayBufferAsText(this._bodyArrayBuffer))\n      } else if (this._bodyFormData) {\n        throw new Error('could not read FormData body as text')\n      } else {\n        return Promise.resolve(this._bodyText)\n      }\n    }\n\n    if (support.formData) {\n      this.formData = function() {\n        return this.text().then(decode)\n      }\n    }\n\n    this.json = function() {\n      return this.text().then(JSON.parse)\n    }\n\n    return this\n  }\n\n  // HTTP methods whose capitalization should be normalized\n  var methods = ['DELETE', 'GET', 'HEAD', 'OPTIONS', 'POST', 'PUT']\n\n  function normalizeMethod(method) {\n    var upcased = method.toUpperCase()\n    return (methods.indexOf(upcased) > -1) ? upcased : method\n  }\n\n  function Request(input, options) {\n    options = options || {}\n    var body = options.body\n\n    if (input instanceof Request) {\n      if (input.bodyUsed) {\n        throw new TypeError('Already read')\n      }\n      this.url = input.url\n      this.credentials = input.credentials\n      if (!options.headers) {\n        this.headers = new Headers(input.headers)\n      }\n      this.method = input.method\n      this.mode = input.mode\n      if (!body && input._bodyInit != null) {\n        body = input._bodyInit\n        input.bodyUsed = true\n      }\n    } else {\n      this.url = String(input)\n    }\n\n    this.credentials = options.credentials || this.credentials || 'omit'\n    if (options.headers || !this.headers) {\n      this.headers = new Headers(options.headers)\n    }\n    this.method = normalizeMethod(options.method || this.method || 'GET')\n    this.mode = options.mode || this.mode || null\n    this.referrer = null\n\n    if ((this.method === 'GET' || this.method === 'HEAD') && body) {\n      throw new TypeError('Body not allowed for GET or HEAD requests')\n    }\n    this._initBody(body)\n  }\n\n  Request.prototype.clone = function() {\n    return new Request(this, { body: this._bodyInit })\n  }\n\n  function decode(body) {\n    var form = new FormData()\n    body.trim().split('&').forEach(function(bytes) {\n      if (bytes) {\n        var split = bytes.split('=')\n        var name = split.shift().replace(/\\+/g, ' ')\n        var value = split.join('=').replace(/\\+/g, ' ')\n        form.append(decodeURIComponent(name), decodeURIComponent(value))\n      }\n    })\n    return form\n  }\n\n  function parseHeaders(rawHeaders) {\n    var headers = new Headers()\n    rawHeaders.split(/\\r?\\n/).forEach(function(line) {\n      var parts = line.split(':')\n      var key = parts.shift().trim()\n      if (key) {\n        var value = parts.join(':').trim()\n        headers.append(key, value)\n      }\n    })\n    return headers\n  }\n\n  Body.call(Request.prototype)\n\n  function Response(bodyInit, options) {\n    if (!options) {\n      options = {}\n    }\n\n    this.type = 'default'\n    this.status = 'status' in options ? options.status : 200\n    this.ok = this.status >= 200 && this.status < 300\n    this.statusText = 'statusText' in options ? options.statusText : 'OK'\n    this.headers = new Headers(options.headers)\n    this.url = options.url || ''\n    this._initBody(bodyInit)\n  }\n\n  Body.call(Response.prototype)\n\n  Response.prototype.clone = function() {\n    return new Response(this._bodyInit, {\n      status: this.status,\n      statusText: this.statusText,\n      headers: new Headers(this.headers),\n      url: this.url\n    })\n  }\n\n  Response.error = function() {\n    var response = new Response(null, {status: 0, statusText: ''})\n    response.type = 'error'\n    return response\n  }\n\n  var redirectStatuses = [301, 302, 303, 307, 308]\n\n  Response.redirect = function(url, status) {\n    if (redirectStatuses.indexOf(status) === -1) {\n      throw new RangeError('Invalid status code')\n    }\n\n    return new Response(null, {status: status, headers: {location: url}})\n  }\n\n  self.Headers = Headers\n  self.Request = Request\n  self.Response = Response\n\n  self.fetch = function(input, init) {\n    return new Promise(function(resolve, reject) {\n      var request = new Request(input, init)\n      var xhr = new XMLHttpRequest()\n\n      xhr.onload = function() {\n        var options = {\n          status: xhr.status,\n          statusText: xhr.statusText,\n          headers: parseHeaders(xhr.getAllResponseHeaders() || '')\n        }\n        options.url = 'responseURL' in xhr ? xhr.responseURL : options.headers.get('X-Request-URL')\n        var body = 'response' in xhr ? xhr.response : xhr.responseText\n        resolve(new Response(body, options))\n      }\n\n      xhr.onerror = function() {\n        reject(new TypeError('Network request failed'))\n      }\n\n      xhr.ontimeout = function() {\n        reject(new TypeError('Network request failed'))\n      }\n\n      xhr.open(request.method, request.url, true)\n\n      if (request.credentials === 'include') {\n        xhr.withCredentials = true\n      }\n\n      if ('responseType' in xhr && support.blob) {\n        xhr.responseType = 'blob'\n      }\n\n      request.headers.forEach(function(value, name) {\n        xhr.setRequestHeader(name, value)\n      })\n\n      xhr.send(typeof request._bodyInit === 'undefined' ? null : request._bodyInit)\n    })\n  }\n  self.fetch.polyfill = true\n})(typeof self !== 'undefined' ? self : this);\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/react-scripts/~/whatwg-fetch/fetch.js\n// module id = 25\n// module chunks = 0","/** @license React v16.14.0\n * react.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';var l=require(\"object-assign\"),n=\"function\"===typeof Symbol&&Symbol.for,p=n?Symbol.for(\"react.element\"):60103,q=n?Symbol.for(\"react.portal\"):60106,r=n?Symbol.for(\"react.fragment\"):60107,t=n?Symbol.for(\"react.strict_mode\"):60108,u=n?Symbol.for(\"react.profiler\"):60114,v=n?Symbol.for(\"react.provider\"):60109,w=n?Symbol.for(\"react.context\"):60110,x=n?Symbol.for(\"react.forward_ref\"):60112,y=n?Symbol.for(\"react.suspense\"):60113,z=n?Symbol.for(\"react.memo\"):60115,A=n?Symbol.for(\"react.lazy\"):\n60116,B=\"function\"===typeof Symbol&&Symbol.iterator;function C(a){for(var b=\"https://reactjs.org/docs/error-decoder.html?invariant=\"+a,c=1;c<arguments.length;c++)b+=\"&args[]=\"+encodeURIComponent(arguments[c]);return\"Minified React error #\"+a+\"; visit \"+b+\" for the full message or use the non-minified dev environment for full errors and additional helpful warnings.\"}\nvar D={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},E={};function F(a,b,c){this.props=a;this.context=b;this.refs=E;this.updater=c||D}F.prototype.isReactComponent={};F.prototype.setState=function(a,b){if(\"object\"!==typeof a&&\"function\"!==typeof a&&null!=a)throw Error(C(85));this.updater.enqueueSetState(this,a,b,\"setState\")};F.prototype.forceUpdate=function(a){this.updater.enqueueForceUpdate(this,a,\"forceUpdate\")};\nfunction G(){}G.prototype=F.prototype;function H(a,b,c){this.props=a;this.context=b;this.refs=E;this.updater=c||D}var I=H.prototype=new G;I.constructor=H;l(I,F.prototype);I.isPureReactComponent=!0;var J={current:null},K=Object.prototype.hasOwnProperty,L={key:!0,ref:!0,__self:!0,__source:!0};\nfunction M(a,b,c){var e,d={},g=null,k=null;if(null!=b)for(e in void 0!==b.ref&&(k=b.ref),void 0!==b.key&&(g=\"\"+b.key),b)K.call(b,e)&&!L.hasOwnProperty(e)&&(d[e]=b[e]);var f=arguments.length-2;if(1===f)d.children=c;else if(1<f){for(var h=Array(f),m=0;m<f;m++)h[m]=arguments[m+2];d.children=h}if(a&&a.defaultProps)for(e in f=a.defaultProps,f)void 0===d[e]&&(d[e]=f[e]);return{$$typeof:p,type:a,key:g,ref:k,props:d,_owner:J.current}}\nfunction N(a,b){return{$$typeof:p,type:a.type,key:b,ref:a.ref,props:a.props,_owner:a._owner}}function O(a){return\"object\"===typeof a&&null!==a&&a.$$typeof===p}function escape(a){var b={\"=\":\"=0\",\":\":\"=2\"};return\"$\"+(\"\"+a).replace(/[=:]/g,function(a){return b[a]})}var P=/\\/+/g,Q=[];function R(a,b,c,e){if(Q.length){var d=Q.pop();d.result=a;d.keyPrefix=b;d.func=c;d.context=e;d.count=0;return d}return{result:a,keyPrefix:b,func:c,context:e,count:0}}\nfunction S(a){a.result=null;a.keyPrefix=null;a.func=null;a.context=null;a.count=0;10>Q.length&&Q.push(a)}\nfunction T(a,b,c,e){var d=typeof a;if(\"undefined\"===d||\"boolean\"===d)a=null;var g=!1;if(null===a)g=!0;else switch(d){case \"string\":case \"number\":g=!0;break;case \"object\":switch(a.$$typeof){case p:case q:g=!0}}if(g)return c(e,a,\"\"===b?\".\"+U(a,0):b),1;g=0;b=\"\"===b?\".\":b+\":\";if(Array.isArray(a))for(var k=0;k<a.length;k++){d=a[k];var f=b+U(d,k);g+=T(d,f,c,e)}else if(null===a||\"object\"!==typeof a?f=null:(f=B&&a[B]||a[\"@@iterator\"],f=\"function\"===typeof f?f:null),\"function\"===typeof f)for(a=f.call(a),k=\n0;!(d=a.next()).done;)d=d.value,f=b+U(d,k++),g+=T(d,f,c,e);else if(\"object\"===d)throw c=\"\"+a,Error(C(31,\"[object Object]\"===c?\"object with keys {\"+Object.keys(a).join(\", \")+\"}\":c,\"\"));return g}function V(a,b,c){return null==a?0:T(a,\"\",b,c)}function U(a,b){return\"object\"===typeof a&&null!==a&&null!=a.key?escape(a.key):b.toString(36)}function W(a,b){a.func.call(a.context,b,a.count++)}\nfunction aa(a,b,c){var e=a.result,d=a.keyPrefix;a=a.func.call(a.context,b,a.count++);Array.isArray(a)?X(a,e,c,function(a){return a}):null!=a&&(O(a)&&(a=N(a,d+(!a.key||b&&b.key===a.key?\"\":(\"\"+a.key).replace(P,\"$&/\")+\"/\")+c)),e.push(a))}function X(a,b,c,e,d){var g=\"\";null!=c&&(g=(\"\"+c).replace(P,\"$&/\")+\"/\");b=R(b,g,e,d);V(a,aa,b);S(b)}var Y={current:null};function Z(){var a=Y.current;if(null===a)throw Error(C(321));return a}\nvar ba={ReactCurrentDispatcher:Y,ReactCurrentBatchConfig:{suspense:null},ReactCurrentOwner:J,IsSomeRendererActing:{current:!1},assign:l};exports.Children={map:function(a,b,c){if(null==a)return a;var e=[];X(a,e,null,b,c);return e},forEach:function(a,b,c){if(null==a)return a;b=R(null,null,b,c);V(a,W,b);S(b)},count:function(a){return V(a,function(){return null},null)},toArray:function(a){var b=[];X(a,b,null,function(a){return a});return b},only:function(a){if(!O(a))throw Error(C(143));return a}};\nexports.Component=F;exports.Fragment=r;exports.Profiler=u;exports.PureComponent=H;exports.StrictMode=t;exports.Suspense=y;exports.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ba;\nexports.cloneElement=function(a,b,c){if(null===a||void 0===a)throw Error(C(267,a));var e=l({},a.props),d=a.key,g=a.ref,k=a._owner;if(null!=b){void 0!==b.ref&&(g=b.ref,k=J.current);void 0!==b.key&&(d=\"\"+b.key);if(a.type&&a.type.defaultProps)var f=a.type.defaultProps;for(h in b)K.call(b,h)&&!L.hasOwnProperty(h)&&(e[h]=void 0===b[h]&&void 0!==f?f[h]:b[h])}var h=arguments.length-2;if(1===h)e.children=c;else if(1<h){f=Array(h);for(var m=0;m<h;m++)f[m]=arguments[m+2];e.children=f}return{$$typeof:p,type:a.type,\nkey:d,ref:g,props:e,_owner:k}};exports.createContext=function(a,b){void 0===b&&(b=null);a={$$typeof:w,_calculateChangedBits:b,_currentValue:a,_currentValue2:a,_threadCount:0,Provider:null,Consumer:null};a.Provider={$$typeof:v,_context:a};return a.Consumer=a};exports.createElement=M;exports.createFactory=function(a){var b=M.bind(null,a);b.type=a;return b};exports.createRef=function(){return{current:null}};exports.forwardRef=function(a){return{$$typeof:x,render:a}};exports.isValidElement=O;\nexports.lazy=function(a){return{$$typeof:A,_ctor:a,_status:-1,_result:null}};exports.memo=function(a,b){return{$$typeof:z,type:a,compare:void 0===b?null:b}};exports.useCallback=function(a,b){return Z().useCallback(a,b)};exports.useContext=function(a,b){return Z().useContext(a,b)};exports.useDebugValue=function(){};exports.useEffect=function(a,b){return Z().useEffect(a,b)};exports.useImperativeHandle=function(a,b,c){return Z().useImperativeHandle(a,b,c)};\nexports.useLayoutEffect=function(a,b){return Z().useLayoutEffect(a,b)};exports.useMemo=function(a,b){return Z().useMemo(a,b)};exports.useReducer=function(a,b,c){return Z().useReducer(a,b,c)};exports.useRef=function(a){return Z().useRef(a)};exports.useState=function(a){return Z().useState(a)};exports.version=\"16.14.0\";\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/react/cjs/react.production.min.js\n// module id = 26\n// module chunks = 0","/** @license React v0.19.1\n * scheduler.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';var f,g,h,k,l;\nif(\"undefined\"===typeof window||\"function\"!==typeof MessageChannel){var p=null,q=null,t=function(){if(null!==p)try{var a=exports.unstable_now();p(!0,a);p=null}catch(b){throw setTimeout(t,0),b;}},u=Date.now();exports.unstable_now=function(){return Date.now()-u};f=function(a){null!==p?setTimeout(f,0,a):(p=a,setTimeout(t,0))};g=function(a,b){q=setTimeout(a,b)};h=function(){clearTimeout(q)};k=function(){return!1};l=exports.unstable_forceFrameRate=function(){}}else{var w=window.performance,x=window.Date,\ny=window.setTimeout,z=window.clearTimeout;if(\"undefined\"!==typeof console){var A=window.cancelAnimationFrame;\"function\"!==typeof window.requestAnimationFrame&&console.error(\"This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills\");\"function\"!==typeof A&&console.error(\"This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills\")}if(\"object\"===\ntypeof w&&\"function\"===typeof w.now)exports.unstable_now=function(){return w.now()};else{var B=x.now();exports.unstable_now=function(){return x.now()-B}}var C=!1,D=null,E=-1,F=5,G=0;k=function(){return exports.unstable_now()>=G};l=function(){};exports.unstable_forceFrameRate=function(a){0>a||125<a?console.error(\"forceFrameRate takes a positive int between 0 and 125, forcing framerates higher than 125 fps is not unsupported\"):F=0<a?Math.floor(1E3/a):5};var H=new MessageChannel,I=H.port2;H.port1.onmessage=\nfunction(){if(null!==D){var a=exports.unstable_now();G=a+F;try{D(!0,a)?I.postMessage(null):(C=!1,D=null)}catch(b){throw I.postMessage(null),b;}}else C=!1};f=function(a){D=a;C||(C=!0,I.postMessage(null))};g=function(a,b){E=y(function(){a(exports.unstable_now())},b)};h=function(){z(E);E=-1}}function J(a,b){var c=a.length;a.push(b);a:for(;;){var d=c-1>>>1,e=a[d];if(void 0!==e&&0<K(e,b))a[d]=b,a[c]=e,c=d;else break a}}function L(a){a=a[0];return void 0===a?null:a}\nfunction M(a){var b=a[0];if(void 0!==b){var c=a.pop();if(c!==b){a[0]=c;a:for(var d=0,e=a.length;d<e;){var m=2*(d+1)-1,n=a[m],v=m+1,r=a[v];if(void 0!==n&&0>K(n,c))void 0!==r&&0>K(r,n)?(a[d]=r,a[v]=c,d=v):(a[d]=n,a[m]=c,d=m);else if(void 0!==r&&0>K(r,c))a[d]=r,a[v]=c,d=v;else break a}}return b}return null}function K(a,b){var c=a.sortIndex-b.sortIndex;return 0!==c?c:a.id-b.id}var N=[],O=[],P=1,Q=null,R=3,S=!1,T=!1,U=!1;\nfunction V(a){for(var b=L(O);null!==b;){if(null===b.callback)M(O);else if(b.startTime<=a)M(O),b.sortIndex=b.expirationTime,J(N,b);else break;b=L(O)}}function W(a){U=!1;V(a);if(!T)if(null!==L(N))T=!0,f(X);else{var b=L(O);null!==b&&g(W,b.startTime-a)}}\nfunction X(a,b){T=!1;U&&(U=!1,h());S=!0;var c=R;try{V(b);for(Q=L(N);null!==Q&&(!(Q.expirationTime>b)||a&&!k());){var d=Q.callback;if(null!==d){Q.callback=null;R=Q.priorityLevel;var e=d(Q.expirationTime<=b);b=exports.unstable_now();\"function\"===typeof e?Q.callback=e:Q===L(N)&&M(N);V(b)}else M(N);Q=L(N)}if(null!==Q)var m=!0;else{var n=L(O);null!==n&&g(W,n.startTime-b);m=!1}return m}finally{Q=null,R=c,S=!1}}\nfunction Y(a){switch(a){case 1:return-1;case 2:return 250;case 5:return 1073741823;case 4:return 1E4;default:return 5E3}}var Z=l;exports.unstable_IdlePriority=5;exports.unstable_ImmediatePriority=1;exports.unstable_LowPriority=4;exports.unstable_NormalPriority=3;exports.unstable_Profiling=null;exports.unstable_UserBlockingPriority=2;exports.unstable_cancelCallback=function(a){a.callback=null};exports.unstable_continueExecution=function(){T||S||(T=!0,f(X))};\nexports.unstable_getCurrentPriorityLevel=function(){return R};exports.unstable_getFirstCallbackNode=function(){return L(N)};exports.unstable_next=function(a){switch(R){case 1:case 2:case 3:var b=3;break;default:b=R}var c=R;R=b;try{return a()}finally{R=c}};exports.unstable_pauseExecution=function(){};exports.unstable_requestPaint=Z;exports.unstable_runWithPriority=function(a,b){switch(a){case 1:case 2:case 3:case 4:case 5:break;default:a=3}var c=R;R=a;try{return b()}finally{R=c}};\nexports.unstable_scheduleCallback=function(a,b,c){var d=exports.unstable_now();if(\"object\"===typeof c&&null!==c){var e=c.delay;e=\"number\"===typeof e&&0<e?d+e:d;c=\"number\"===typeof c.timeout?c.timeout:Y(a)}else c=Y(a),e=d;c=e+c;a={id:P++,callback:b,priorityLevel:a,startTime:e,expirationTime:c,sortIndex:-1};e>d?(a.sortIndex=e,J(O,a),null===L(N)&&a===L(O)&&(U?h():U=!0,g(W,e-d))):(a.sortIndex=c,J(N,a),T||S||(T=!0,f(X)));return a};\nexports.unstable_shouldYield=function(){var a=exports.unstable_now();V(a);var b=L(N);return b!==Q&&null!==Q&&null!==b&&null!==b.callback&&b.startTime<=a&&b.expirationTime<Q.expirationTime||k()};exports.unstable_wrapCallback=function(a){var b=R;return function(){var c=R;R=b;try{return a.apply(this,arguments)}finally{R=c}}};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/scheduler/cjs/scheduler.production.min.js\n// module id = 27\n// module chunks = 0","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('./cjs/scheduler.production.min.js');\n} else {\n  module.exports = require('./cjs/scheduler.development.js');\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/scheduler/index.js\n// module id = 28\n// module chunks = 0","(function(self) {\n  'use strict';\n\n  if (self.fetch) {\n    return\n  }\n\n  var support = {\n    searchParams: 'URLSearchParams' in self,\n    iterable: 'Symbol' in self && 'iterator' in Symbol,\n    blob: 'FileReader' in self && 'Blob' in self && (function() {\n      try {\n        new Blob()\n        return true\n      } catch(e) {\n        return false\n      }\n    })(),\n    formData: 'FormData' in self,\n    arrayBuffer: 'ArrayBuffer' in self\n  }\n\n  if (support.arrayBuffer) {\n    var viewClasses = [\n      '[object Int8Array]',\n      '[object Uint8Array]',\n      '[object Uint8ClampedArray]',\n      '[object Int16Array]',\n      '[object Uint16Array]',\n      '[object Int32Array]',\n      '[object Uint32Array]',\n      '[object Float32Array]',\n      '[object Float64Array]'\n    ]\n\n    var isDataView = function(obj) {\n      return obj && DataView.prototype.isPrototypeOf(obj)\n    }\n\n    var isArrayBufferView = ArrayBuffer.isView || function(obj) {\n      return obj && viewClasses.indexOf(Object.prototype.toString.call(obj)) > -1\n    }\n  }\n\n  function normalizeName(name) {\n    if (typeof name !== 'string') {\n      name = String(name)\n    }\n    if (/[^a-z0-9\\-#$%&'*+.\\^_`|~]/i.test(name)) {\n      throw new TypeError('Invalid character in header field name')\n    }\n    return name.toLowerCase()\n  }\n\n  function normalizeValue(value) {\n    if (typeof value !== 'string') {\n      value = String(value)\n    }\n    return value\n  }\n\n  // Build a destructive iterator for the value list\n  function iteratorFor(items) {\n    var iterator = {\n      next: function() {\n        var value = items.shift()\n        return {done: value === undefined, value: value}\n      }\n    }\n\n    if (support.iterable) {\n      iterator[Symbol.iterator] = function() {\n        return iterator\n      }\n    }\n\n    return iterator\n  }\n\n  function Headers(headers) {\n    this.map = {}\n\n    if (headers instanceof Headers) {\n      headers.forEach(function(value, name) {\n        this.append(name, value)\n      }, this)\n    } else if (Array.isArray(headers)) {\n      headers.forEach(function(header) {\n        this.append(header[0], header[1])\n      }, this)\n    } else if (headers) {\n      Object.getOwnPropertyNames(headers).forEach(function(name) {\n        this.append(name, headers[name])\n      }, this)\n    }\n  }\n\n  Headers.prototype.append = function(name, value) {\n    name = normalizeName(name)\n    value = normalizeValue(value)\n    var oldValue = this.map[name]\n    this.map[name] = oldValue ? oldValue+','+value : value\n  }\n\n  Headers.prototype['delete'] = function(name) {\n    delete this.map[normalizeName(name)]\n  }\n\n  Headers.prototype.get = function(name) {\n    name = normalizeName(name)\n    return this.has(name) ? this.map[name] : null\n  }\n\n  Headers.prototype.has = function(name) {\n    return this.map.hasOwnProperty(normalizeName(name))\n  }\n\n  Headers.prototype.set = function(name, value) {\n    this.map[normalizeName(name)] = normalizeValue(value)\n  }\n\n  Headers.prototype.forEach = function(callback, thisArg) {\n    for (var name in this.map) {\n      if (this.map.hasOwnProperty(name)) {\n        callback.call(thisArg, this.map[name], name, this)\n      }\n    }\n  }\n\n  Headers.prototype.keys = function() {\n    var items = []\n    this.forEach(function(value, name) { items.push(name) })\n    return iteratorFor(items)\n  }\n\n  Headers.prototype.values = function() {\n    var items = []\n    this.forEach(function(value) { items.push(value) })\n    return iteratorFor(items)\n  }\n\n  Headers.prototype.entries = function() {\n    var items = []\n    this.forEach(function(value, name) { items.push([name, value]) })\n    return iteratorFor(items)\n  }\n\n  if (support.iterable) {\n    Headers.prototype[Symbol.iterator] = Headers.prototype.entries\n  }\n\n  function consumed(body) {\n    if (body.bodyUsed) {\n      return Promise.reject(new TypeError('Already read'))\n    }\n    body.bodyUsed = true\n  }\n\n  function fileReaderReady(reader) {\n    return new Promise(function(resolve, reject) {\n      reader.onload = function() {\n        resolve(reader.result)\n      }\n      reader.onerror = function() {\n        reject(reader.error)\n      }\n    })\n  }\n\n  function readBlobAsArrayBuffer(blob) {\n    var reader = new FileReader()\n    var promise = fileReaderReady(reader)\n    reader.readAsArrayBuffer(blob)\n    return promise\n  }\n\n  function readBlobAsText(blob) {\n    var reader = new FileReader()\n    var promise = fileReaderReady(reader)\n    reader.readAsText(blob)\n    return promise\n  }\n\n  function readArrayBufferAsText(buf) {\n    var view = new Uint8Array(buf)\n    var chars = new Array(view.length)\n\n    for (var i = 0; i < view.length; i++) {\n      chars[i] = String.fromCharCode(view[i])\n    }\n    return chars.join('')\n  }\n\n  function bufferClone(buf) {\n    if (buf.slice) {\n      return buf.slice(0)\n    } else {\n      var view = new Uint8Array(buf.byteLength)\n      view.set(new Uint8Array(buf))\n      return view.buffer\n    }\n  }\n\n  function Body() {\n    this.bodyUsed = false\n\n    this._initBody = function(body) {\n      this._bodyInit = body\n      if (!body) {\n        this._bodyText = ''\n      } else if (typeof body === 'string') {\n        this._bodyText = body\n      } else if (support.blob && Blob.prototype.isPrototypeOf(body)) {\n        this._bodyBlob = body\n      } else if (support.formData && FormData.prototype.isPrototypeOf(body)) {\n        this._bodyFormData = body\n      } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {\n        this._bodyText = body.toString()\n      } else if (support.arrayBuffer && support.blob && isDataView(body)) {\n        this._bodyArrayBuffer = bufferClone(body.buffer)\n        // IE 10-11 can't handle a DataView body.\n        this._bodyInit = new Blob([this._bodyArrayBuffer])\n      } else if (support.arrayBuffer && (ArrayBuffer.prototype.isPrototypeOf(body) || isArrayBufferView(body))) {\n        this._bodyArrayBuffer = bufferClone(body)\n      } else {\n        throw new Error('unsupported BodyInit type')\n      }\n\n      if (!this.headers.get('content-type')) {\n        if (typeof body === 'string') {\n          this.headers.set('content-type', 'text/plain;charset=UTF-8')\n        } else if (this._bodyBlob && this._bodyBlob.type) {\n          this.headers.set('content-type', this._bodyBlob.type)\n        } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {\n          this.headers.set('content-type', 'application/x-www-form-urlencoded;charset=UTF-8')\n        }\n      }\n    }\n\n    if (support.blob) {\n      this.blob = function() {\n        var rejected = consumed(this)\n        if (rejected) {\n          return rejected\n        }\n\n        if (this._bodyBlob) {\n          return Promise.resolve(this._bodyBlob)\n        } else if (this._bodyArrayBuffer) {\n          return Promise.resolve(new Blob([this._bodyArrayBuffer]))\n        } else if (this._bodyFormData) {\n          throw new Error('could not read FormData body as blob')\n        } else {\n          return Promise.resolve(new Blob([this._bodyText]))\n        }\n      }\n\n      this.arrayBuffer = function() {\n        if (this._bodyArrayBuffer) {\n          return consumed(this) || Promise.resolve(this._bodyArrayBuffer)\n        } else {\n          return this.blob().then(readBlobAsArrayBuffer)\n        }\n      }\n    }\n\n    this.text = function() {\n      var rejected = consumed(this)\n      if (rejected) {\n        return rejected\n      }\n\n      if (this._bodyBlob) {\n        return readBlobAsText(this._bodyBlob)\n      } else if (this._bodyArrayBuffer) {\n        return Promise.resolve(readArrayBufferAsText(this._bodyArrayBuffer))\n      } else if (this._bodyFormData) {\n        throw new Error('could not read FormData body as text')\n      } else {\n        return Promise.resolve(this._bodyText)\n      }\n    }\n\n    if (support.formData) {\n      this.formData = function() {\n        return this.text().then(decode)\n      }\n    }\n\n    this.json = function() {\n      return this.text().then(JSON.parse)\n    }\n\n    return this\n  }\n\n  // HTTP methods whose capitalization should be normalized\n  var methods = ['DELETE', 'GET', 'HEAD', 'OPTIONS', 'POST', 'PUT']\n\n  function normalizeMethod(method) {\n    var upcased = method.toUpperCase()\n    return (methods.indexOf(upcased) > -1) ? upcased : method\n  }\n\n  function Request(input, options) {\n    options = options || {}\n    var body = options.body\n\n    if (input instanceof Request) {\n      if (input.bodyUsed) {\n        throw new TypeError('Already read')\n      }\n      this.url = input.url\n      this.credentials = input.credentials\n      if (!options.headers) {\n        this.headers = new Headers(input.headers)\n      }\n      this.method = input.method\n      this.mode = input.mode\n      if (!body && input._bodyInit != null) {\n        body = input._bodyInit\n        input.bodyUsed = true\n      }\n    } else {\n      this.url = String(input)\n    }\n\n    this.credentials = options.credentials || this.credentials || 'omit'\n    if (options.headers || !this.headers) {\n      this.headers = new Headers(options.headers)\n    }\n    this.method = normalizeMethod(options.method || this.method || 'GET')\n    this.mode = options.mode || this.mode || null\n    this.referrer = null\n\n    if ((this.method === 'GET' || this.method === 'HEAD') && body) {\n      throw new TypeError('Body not allowed for GET or HEAD requests')\n    }\n    this._initBody(body)\n  }\n\n  Request.prototype.clone = function() {\n    return new Request(this, { body: this._bodyInit })\n  }\n\n  function decode(body) {\n    var form = new FormData()\n    body.trim().split('&').forEach(function(bytes) {\n      if (bytes) {\n        var split = bytes.split('=')\n        var name = split.shift().replace(/\\+/g, ' ')\n        var value = split.join('=').replace(/\\+/g, ' ')\n        form.append(decodeURIComponent(name), decodeURIComponent(value))\n      }\n    })\n    return form\n  }\n\n  function parseHeaders(rawHeaders) {\n    var headers = new Headers()\n    // Replace instances of \\r\\n and \\n followed by at least one space or horizontal tab with a space\n    // https://tools.ietf.org/html/rfc7230#section-3.2\n    var preProcessedHeaders = rawHeaders.replace(/\\r?\\n[\\t ]+/g, ' ')\n    preProcessedHeaders.split(/\\r?\\n/).forEach(function(line) {\n      var parts = line.split(':')\n      var key = parts.shift().trim()\n      if (key) {\n        var value = parts.join(':').trim()\n        headers.append(key, value)\n      }\n    })\n    return headers\n  }\n\n  Body.call(Request.prototype)\n\n  function Response(bodyInit, options) {\n    if (!options) {\n      options = {}\n    }\n\n    this.type = 'default'\n    this.status = options.status === undefined ? 200 : options.status\n    this.ok = this.status >= 200 && this.status < 300\n    this.statusText = 'statusText' in options ? options.statusText : 'OK'\n    this.headers = new Headers(options.headers)\n    this.url = options.url || ''\n    this._initBody(bodyInit)\n  }\n\n  Body.call(Response.prototype)\n\n  Response.prototype.clone = function() {\n    return new Response(this._bodyInit, {\n      status: this.status,\n      statusText: this.statusText,\n      headers: new Headers(this.headers),\n      url: this.url\n    })\n  }\n\n  Response.error = function() {\n    var response = new Response(null, {status: 0, statusText: ''})\n    response.type = 'error'\n    return response\n  }\n\n  var redirectStatuses = [301, 302, 303, 307, 308]\n\n  Response.redirect = function(url, status) {\n    if (redirectStatuses.indexOf(status) === -1) {\n      throw new RangeError('Invalid status code')\n    }\n\n    return new Response(null, {status: status, headers: {location: url}})\n  }\n\n  self.Headers = Headers\n  self.Request = Request\n  self.Response = Response\n\n  self.fetch = function(input, init) {\n    return new Promise(function(resolve, reject) {\n      var request = new Request(input, init)\n      var xhr = new XMLHttpRequest()\n\n      xhr.onload = function() {\n        var options = {\n          status: xhr.status,\n          statusText: xhr.statusText,\n          headers: parseHeaders(xhr.getAllResponseHeaders() || '')\n        }\n        options.url = 'responseURL' in xhr ? xhr.responseURL : options.headers.get('X-Request-URL')\n        var body = 'response' in xhr ? xhr.response : xhr.responseText\n        resolve(new Response(body, options))\n      }\n\n      xhr.onerror = function() {\n        reject(new TypeError('Network request failed'))\n      }\n\n      xhr.ontimeout = function() {\n        reject(new TypeError('Network request failed'))\n      }\n\n      xhr.open(request.method, request.url, true)\n\n      if (request.credentials === 'include') {\n        xhr.withCredentials = true\n      } else if (request.credentials === 'omit') {\n        xhr.withCredentials = false\n      }\n\n      if ('responseType' in xhr && support.blob) {\n        xhr.responseType = 'blob'\n      }\n\n      request.headers.forEach(function(value, name) {\n        xhr.setRequestHeader(name, value)\n      })\n\n      xhr.send(typeof request._bodyInit === 'undefined' ? null : request._bodyInit)\n    })\n  }\n  self.fetch.polyfill = true\n})(typeof self !== 'undefined' ? self : this);\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/whatwg-fetch/fetch.js\n// module id = 29\n// module chunks = 0"],"sourceRoot":""}